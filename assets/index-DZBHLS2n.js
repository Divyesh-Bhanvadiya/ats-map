var J9=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Fbe=J9(Er=>{function j4(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var yD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Q9(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var sM={exports:{}},z0={},aM={exports:{}},Vr={};var _D;function e7(){if(_D)return Vr;_D=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),M=Symbol.iterator;function C(Le){return Le===null||typeof Le!="object"?null:(Le=M&&Le[M]||Le["@@iterator"],typeof Le=="function"?Le:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,z={};function P(Le,lt,Ht){this.props=Le,this.context=lt,this.refs=z,this.updater=Ht||A}P.prototype.isReactComponent={},P.prototype.setState=function(Le,lt){if(typeof Le!="object"&&typeof Le!="function"&&Le!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Le,lt,"setState")},P.prototype.forceUpdate=function(Le){this.updater.enqueueForceUpdate(this,Le,"forceUpdate")};function O(){}O.prototype=P.prototype;function j(Le,lt,Ht){this.props=Le,this.context=lt,this.refs=z,this.updater=Ht||A}var U=j.prototype=new O;U.constructor=j,k(U,P.prototype),U.isPureReactComponent=!0;var X=Array.isArray,K=Object.prototype.hasOwnProperty,se={current:null},J={key:!0,ref:!0,__self:!0,__source:!0};function ue(Le,lt,Ht){var He,pt={},_t=null,ot=null;if(lt!=null)for(He in lt.ref!==void 0&&(ot=lt.ref),lt.key!==void 0&&(_t=""+lt.key),lt)K.call(lt,He)&&!J.hasOwnProperty(He)&&(pt[He]=lt[He]);var et=arguments.length-2;if(et===1)pt.children=Ht;else if(1<et){for(var Mt=Array(et),Tt=0;Tt<et;Tt++)Mt[Tt]=arguments[Tt+2];pt.children=Mt}if(Le&&Le.defaultProps)for(He in et=Le.defaultProps,et)pt[He]===void 0&&(pt[He]=et[He]);return{$$typeof:t,type:Le,key:_t,ref:ot,props:pt,_owner:se.current}}function ne(Le,lt){return{$$typeof:t,type:Le.type,key:lt,ref:Le.ref,props:Le.props,_owner:Le._owner}}function H(Le){return typeof Le=="object"&&Le!==null&&Le.$$typeof===t}function de(Le){var lt={"=":"=0",":":"=2"};return"$"+Le.replace(/[=:]/g,function(Ht){return lt[Ht]})}var Ee=/\/+/g;function Pe(Le,lt){return typeof Le=="object"&&Le!==null&&Le.key!=null?de(""+Le.key):lt.toString(36)}function Ze(Le,lt,Ht,He,pt){var _t=typeof Le;(_t==="undefined"||_t==="boolean")&&(Le=null);var ot=!1;if(Le===null)ot=!0;else switch(_t){case"string":case"number":ot=!0;break;case"object":switch(Le.$$typeof){case t:case e:ot=!0}}if(ot)return ot=Le,pt=pt(ot),Le=He===""?"."+Pe(ot,0):He,X(pt)?(Ht="",Le!=null&&(Ht=Le.replace(Ee,"$&/")+"/"),Ze(pt,lt,Ht,"",function(Tt){return Tt})):pt!=null&&(H(pt)&&(pt=ne(pt,Ht+(!pt.key||ot&&ot.key===pt.key?"":(""+pt.key).replace(Ee,"$&/")+"/")+Le)),lt.push(pt)),1;if(ot=0,He=He===""?".":He+":",X(Le))for(var et=0;et<Le.length;et++){_t=Le[et];var Mt=He+Pe(_t,et);ot+=Ze(_t,lt,Ht,Mt,pt)}else if(Mt=C(Le),typeof Mt=="function")for(Le=Mt.call(Le),et=0;!(_t=Le.next()).done;)_t=_t.value,Mt=He+Pe(_t,et++),ot+=Ze(_t,lt,Ht,Mt,pt);else if(_t==="object")throw lt=String(Le),Error("Objects are not valid as a React child (found: "+(lt==="[object Object]"?"object with keys {"+Object.keys(Le).join(", ")+"}":lt)+"). If you meant to render a collection of children, use an array instead.");return ot}function ke(Le,lt,Ht){if(Le==null)return Le;var He=[],pt=0;return Ze(Le,He,"","",function(_t){return lt.call(Ht,_t,pt++)}),He}function Te(Le){if(Le._status===-1){var lt=Le._result;lt=lt(),lt.then(function(Ht){(Le._status===0||Le._status===-1)&&(Le._status=1,Le._result=Ht)},function(Ht){(Le._status===0||Le._status===-1)&&(Le._status=2,Le._result=Ht)}),Le._status===-1&&(Le._status=0,Le._result=lt)}if(Le._status===1)return Le._result.default;throw Le._result}var Ie={current:null},Ce={transition:null},Ue={ReactCurrentDispatcher:Ie,ReactCurrentBatchConfig:Ce,ReactCurrentOwner:se};function nt(){throw Error("act(...) is not supported in production builds of React.")}return Vr.Children={map:ke,forEach:function(Le,lt,Ht){ke(Le,function(){lt.apply(this,arguments)},Ht)},count:function(Le){var lt=0;return ke(Le,function(){lt++}),lt},toArray:function(Le){return ke(Le,function(lt){return lt})||[]},only:function(Le){if(!H(Le))throw Error("React.Children.only expected to receive a single React element child.");return Le}},Vr.Component=P,Vr.Fragment=n,Vr.Profiler=a,Vr.PureComponent=j,Vr.StrictMode=r,Vr.Suspense=m,Vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ue,Vr.act=nt,Vr.cloneElement=function(Le,lt,Ht){if(Le==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Le+".");var He=k({},Le.props),pt=Le.key,_t=Le.ref,ot=Le._owner;if(lt!=null){if(lt.ref!==void 0&&(_t=lt.ref,ot=se.current),lt.key!==void 0&&(pt=""+lt.key),Le.type&&Le.type.defaultProps)var et=Le.type.defaultProps;for(Mt in lt)K.call(lt,Mt)&&!J.hasOwnProperty(Mt)&&(He[Mt]=lt[Mt]===void 0&&et!==void 0?et[Mt]:lt[Mt])}var Mt=arguments.length-2;if(Mt===1)He.children=Ht;else if(1<Mt){et=Array(Mt);for(var Tt=0;Tt<Mt;Tt++)et[Tt]=arguments[Tt+2];He.children=et}return{$$typeof:t,type:Le.type,key:pt,ref:_t,props:He,_owner:ot}},Vr.createContext=function(Le){return Le={$$typeof:u,_currentValue:Le,_currentValue2:Le,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Le.Provider={$$typeof:l,_context:Le},Le.Consumer=Le},Vr.createElement=ue,Vr.createFactory=function(Le){var lt=ue.bind(null,Le);return lt.type=Le,lt},Vr.createRef=function(){return{current:null}},Vr.forwardRef=function(Le){return{$$typeof:s,render:Le}},Vr.isValidElement=H,Vr.lazy=function(Le){return{$$typeof:b,_payload:{_status:-1,_result:Le},_init:Te}},Vr.memo=function(Le,lt){return{$$typeof:_,type:Le,compare:lt===void 0?null:lt}},Vr.startTransition=function(Le){var lt=Ce.transition;Ce.transition={};try{Le()}finally{Ce.transition=lt}},Vr.unstable_act=nt,Vr.useCallback=function(Le,lt){return Ie.current.useCallback(Le,lt)},Vr.useContext=function(Le){return Ie.current.useContext(Le)},Vr.useDebugValue=function(){},Vr.useDeferredValue=function(Le){return Ie.current.useDeferredValue(Le)},Vr.useEffect=function(Le,lt){return Ie.current.useEffect(Le,lt)},Vr.useId=function(){return Ie.current.useId()},Vr.useImperativeHandle=function(Le,lt,Ht){return Ie.current.useImperativeHandle(Le,lt,Ht)},Vr.useInsertionEffect=function(Le,lt){return Ie.current.useInsertionEffect(Le,lt)},Vr.useLayoutEffect=function(Le,lt){return Ie.current.useLayoutEffect(Le,lt)},Vr.useMemo=function(Le,lt){return Ie.current.useMemo(Le,lt)},Vr.useReducer=function(Le,lt,Ht){return Ie.current.useReducer(Le,lt,Ht)},Vr.useRef=function(Le){return Ie.current.useRef(Le)},Vr.useState=function(Le){return Ie.current.useState(Le)},Vr.useSyncExternalStore=function(Le,lt,Ht){return Ie.current.useSyncExternalStore(Le,lt,Ht)},Vr.useTransition=function(){return Ie.current.useTransition()},Vr.version="18.3.1",Vr}var xD;function RA(){return xD||(xD=1,aM.exports=e7()),aM.exports}var bD;function t7(){if(bD)return z0;bD=1;var t=RA(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(s,m,_){var b,M={},C=null,A=null;_!==void 0&&(C=""+_),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&(A=m.ref);for(b in m)r.call(m,b)&&!l.hasOwnProperty(b)&&(M[b]=m[b]);if(s&&s.defaultProps)for(b in m=s.defaultProps,m)M[b]===void 0&&(M[b]=m[b]);return{$$typeof:e,type:s,key:C,ref:A,props:M,_owner:a.current}}return z0.Fragment=n,z0.jsx=u,z0.jsxs=u,z0}var wD;function n7(){return wD||(wD=1,sM.exports=t7()),sM.exports}var ae=n7();const O0={grey:{50:"#FBFCFE",100:"#F0F4F8",200:"#DDE7EE",300:"#CDD7E1",400:"#9FA6AD",500:"#636B74",600:"#555E68",700:"#32383E",800:"#171A1C",900:"#0B0D0E"},blue:{50:"#EDF5FD",100:"#E3EFFB",200:"#C7DFF7",300:"#97C3F0",400:"#4393E4",500:"#0B6BCB",600:"#185EA5",700:"#12467B",800:"#0A2744",900:"#051423"},yellow:{50:"#FEFAF6",100:"#FDF0E1",200:"#FCE1C2",300:"#F3C896",400:"#EA9A3E",500:"#9A5B13",600:"#72430D",700:"#492B08",800:"#2E1B05",900:"#1D1002"},red:{50:"#FEF6F6",100:"#FCE4E4",200:"#F7C5C5",300:"#F09898",400:"#E47474",500:"#C41C1C",600:"#A51818",700:"#7D1212",800:"#430A0A",900:"#240505"},green:{50:"#F6FEF6",100:"#E3FBE3",200:"#C7F7C7",300:"#A1E8A1",400:"#51BC51",500:"#1F7A1F",600:"#136C13",700:"#0A470A",800:"#042F04",900:"#021D02"}},fx="$$joy";function j_(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function ye(){return ye=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ye.apply(null,arguments)}var q=RA();const p_=oS(q),mw=j4({__proto__:null,default:p_},[q]);function r7(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function i7(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var o7=function(){function t(n){var r=this;this._insertTag=function(a){var l;r.tags.length===0?r.insertionPoint?l=r.insertionPoint.nextSibling:r.prepend?l=r.container.firstChild:l=r.before:l=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,l),r.tags.push(a)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(i7(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var l=r7(a);try{l.insertRule(r,l.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},t}(),xa="-ms-",gw="-moz-",di="-webkit-",H4="comm",DA="rule",LA="decl",s7="@import",G4="@keyframes",a7="@layer",l7=Math.abs,sS=String.fromCharCode,c7=Object.assign;function u7(t,e){return Zs(t,0)^45?(((e<<2^Zs(t,0))<<2^Zs(t,1))<<2^Zs(t,2))<<2^Zs(t,3):0}function W4(t){return t.trim()}function h7(t,e){return(t=e.exec(t))?t[0]:t}function fi(t,e,n){return t.replace(e,n)}function GT(t,e){return t.indexOf(e)}function Zs(t,e){return t.charCodeAt(e)|0}function H_(t,e,n){return t.slice(e,n)}function Xh(t){return t.length}function kA(t){return t.length}function q1(t,e){return e.push(t),t}function d7(t,e){return t.map(e).join("")}var aS=1,Py=1,q4=0,Tl=0,is=0,qy="";function lS(t,e,n,r,a,l,u){return{value:t,root:e,parent:n,type:r,props:a,children:l,line:aS,column:Py,length:u,return:""}}function F0(t,e){return c7(lS("",null,null,"",null,null,0),t,{length:-t.length},e)}function f7(){return is}function p7(){return is=Tl>0?Zs(qy,--Tl):0,Py--,is===10&&(Py=1,aS--),is}function dc(){return is=Tl<q4?Zs(qy,Tl++):0,Py++,is===10&&(Py=1,aS++),is}function ed(){return Zs(qy,Tl)}function $b(){return Tl}function px(t,e){return H_(qy,t,e)}function G_(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function X4(t){return aS=Py=1,q4=Xh(qy=t),Tl=0,[]}function Z4(t){return qy="",t}function Vb(t){return W4(px(Tl-1,WT(t===91?t+2:t===40?t+1:t)))}function m7(t){for(;(is=ed())&&is<33;)dc();return G_(t)>2||G_(is)>3?"":" "}function g7(t,e){for(;--e&&dc()&&!(is<48||is>102||is>57&&is<65||is>70&&is<97););return px(t,$b()+(e<6&&ed()==32&&dc()==32))}function WT(t){for(;dc();)switch(is){case t:return Tl;case 34:case 39:t!==34&&t!==39&&WT(is);break;case 40:t===41&&WT(t);break;case 92:dc();break}return Tl}function v7(t,e){for(;dc()&&t+is!==57;)if(t+is===84&&ed()===47)break;return"/*"+px(e,Tl-1)+"*"+sS(t===47?t:dc())}function y7(t){for(;!G_(ed());)dc();return px(t,Tl)}function _7(t){return Z4(jb("",null,null,null,[""],t=X4(t),0,[0],t))}function jb(t,e,n,r,a,l,u,s,m){for(var _=0,b=0,M=u,C=0,A=0,k=0,z=1,P=1,O=1,j=0,U="",X=a,K=l,se=r,J=U;P;)switch(k=j,j=dc()){case 40:if(k!=108&&Zs(J,M-1)==58){GT(J+=fi(Vb(j),"&","&\f"),"&\f")!=-1&&(O=-1);break}case 34:case 39:case 91:J+=Vb(j);break;case 9:case 10:case 13:case 32:J+=m7(k);break;case 92:J+=g7($b()-1,7);continue;case 47:switch(ed()){case 42:case 47:q1(x7(v7(dc(),$b()),e,n),m);break;default:J+="/"}break;case 123*z:s[_++]=Xh(J)*O;case 125*z:case 59:case 0:switch(j){case 0:case 125:P=0;case 59+b:O==-1&&(J=fi(J,/\f/g,"")),A>0&&Xh(J)-M&&q1(A>32?MD(J+";",r,n,M-1):MD(fi(J," ","")+";",r,n,M-2),m);break;case 59:J+=";";default:if(q1(se=SD(J,e,n,_,b,a,s,U,X=[],K=[],M),l),j===123)if(b===0)jb(J,e,se,se,X,l,M,s,K);else switch(C===99&&Zs(J,3)===110?100:C){case 100:case 108:case 109:case 115:jb(t,se,se,r&&q1(SD(t,se,se,0,0,a,s,U,a,X=[],M),K),a,K,M,s,r?X:K);break;default:jb(J,se,se,se,[""],K,0,s,K)}}_=b=A=0,z=O=1,U=J="",M=u;break;case 58:M=1+Xh(J),A=k;default:if(z<1){if(j==123)--z;else if(j==125&&z++==0&&p7()==125)continue}switch(J+=sS(j),j*z){case 38:O=b>0?1:(J+="\f",-1);break;case 44:s[_++]=(Xh(J)-1)*O,O=1;break;case 64:ed()===45&&(J+=Vb(dc())),C=ed(),b=M=Xh(U=J+=y7($b())),j++;break;case 45:k===45&&Xh(J)==2&&(z=0)}}return l}function SD(t,e,n,r,a,l,u,s,m,_,b){for(var M=a-1,C=a===0?l:[""],A=kA(C),k=0,z=0,P=0;k<r;++k)for(var O=0,j=H_(t,M+1,M=l7(z=u[k])),U=t;O<A;++O)(U=W4(z>0?C[O]+" "+j:fi(j,/&\f/g,C[O])))&&(m[P++]=U);return lS(t,e,n,a===0?DA:s,m,_,b)}function x7(t,e,n){return lS(t,e,n,H4,sS(f7()),H_(t,2,-2),0)}function MD(t,e,n,r){return lS(t,e,n,LA,H_(t,0,r),H_(t,r+1,-1),r)}function my(t,e){for(var n="",r=kA(t),a=0;a<r;a++)n+=e(t[a],a,t,e)||"";return n}function b7(t,e,n,r){switch(t.type){case a7:if(t.children.length)break;case s7:case LA:return t.return=t.return||t.value;case H4:return"";case G4:return t.return=t.value+"{"+my(t.children,r)+"}";case DA:t.value=t.props.join(",")}return Xh(n=my(t.children,r))?t.return=t.value+"{"+n+"}":""}function w7(t){var e=kA(t);return function(n,r,a,l){for(var u="",s=0;s<e;s++)u+=t[s](n,r,a,l)||"";return u}}function S7(t){return function(e){e.root||(e=e.return)&&t(e)}}function Y4(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var M7=function(e,n,r){for(var a=0,l=0;a=l,l=ed(),a===38&&l===12&&(n[r]=1),!G_(l);)dc();return px(e,Tl)},E7=function(e,n){var r=-1,a=44;do switch(G_(a)){case 0:a===38&&ed()===12&&(n[r]=1),e[r]+=M7(Tl-1,n,r);break;case 2:e[r]+=Vb(a);break;case 4:if(a===44){e[++r]=ed()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=sS(a)}while(a=dc());return e},C7=function(e,n){return Z4(E7(X4(e),n))},ED=new WeakMap,T7=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,a=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!ED.get(r))&&!a){ED.set(e,!0);for(var l=[],u=C7(n,l),s=r.props,m=0,_=0;m<u.length;m++)for(var b=0;b<s.length;b++,_++)e.props[_]=l[m]?u[m].replace(/&\f/g,s[b]):s[b]+" "+u[m]}}},P7=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function K4(t,e){switch(u7(t,e)){case 5103:return di+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return di+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return di+t+gw+t+xa+t+t;case 6828:case 4268:return di+t+xa+t+t;case 6165:return di+t+xa+"flex-"+t+t;case 5187:return di+t+fi(t,/(\w+).+(:[^]+)/,di+"box-$1$2"+xa+"flex-$1$2")+t;case 5443:return di+t+xa+"flex-item-"+fi(t,/flex-|-self/,"")+t;case 4675:return di+t+xa+"flex-line-pack"+fi(t,/align-content|flex-|-self/,"")+t;case 5548:return di+t+xa+fi(t,"shrink","negative")+t;case 5292:return di+t+xa+fi(t,"basis","preferred-size")+t;case 6060:return di+"box-"+fi(t,"-grow","")+di+t+xa+fi(t,"grow","positive")+t;case 4554:return di+fi(t,/([^-])(transform)/g,"$1"+di+"$2")+t;case 6187:return fi(fi(fi(t,/(zoom-|grab)/,di+"$1"),/(image-set)/,di+"$1"),t,"")+t;case 5495:case 3959:return fi(t,/(image-set\([^]*)/,di+"$1$`$1");case 4968:return fi(fi(t,/(.+:)(flex-)?(.*)/,di+"box-pack:$3"+xa+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+di+t+t;case 4095:case 3583:case 4068:case 2532:return fi(t,/(.+)-inline(.+)/,di+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Xh(t)-1-e>6)switch(Zs(t,e+1)){case 109:if(Zs(t,e+4)!==45)break;case 102:return fi(t,/(.+:)(.+)-([^]+)/,"$1"+di+"$2-$3$1"+gw+(Zs(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~GT(t,"stretch")?K4(fi(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Zs(t,e+1)!==115)break;case 6444:switch(Zs(t,Xh(t)-3-(~GT(t,"!important")&&10))){case 107:return fi(t,":",":"+di)+t;case 101:return fi(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+di+(Zs(t,14)===45?"inline-":"")+"box$3$1"+di+"$2$3$1"+xa+"$2box$3")+t}break;case 5936:switch(Zs(t,e+11)){case 114:return di+t+xa+fi(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return di+t+xa+fi(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return di+t+xa+fi(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return di+t+xa+t+t}return t}var A7=function(e,n,r,a){if(e.length>-1&&!e.return)switch(e.type){case LA:e.return=K4(e.value,e.length);break;case G4:return my([F0(e,{value:fi(e.value,"@","@"+di)})],a);case DA:if(e.length)return d7(e.props,function(l){switch(h7(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return my([F0(e,{props:[fi(l,/:(read-\w+)/,":"+gw+"$1")]})],a);case"::placeholder":return my([F0(e,{props:[fi(l,/:(plac\w+)/,":"+di+"input-$1")]}),F0(e,{props:[fi(l,/:(plac\w+)/,":"+gw+"$1")]}),F0(e,{props:[fi(l,/:(plac\w+)/,xa+"input-$1")]})],a)}return""})}},I7=[A7],R7=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(z){var P=z.getAttribute("data-emotion");P.indexOf(" ")!==-1&&(document.head.appendChild(z),z.setAttribute("data-s",""))})}var a=e.stylisPlugins||I7,l={},u,s=[];u=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(z){for(var P=z.getAttribute("data-emotion").split(" "),O=1;O<P.length;O++)l[P[O]]=!0;s.push(z)});var m,_=[T7,P7];{var b,M=[b7,S7(function(z){b.insert(z)})],C=w7(_.concat(a,M)),A=function(P){return my(_7(P),C)};m=function(P,O,j,U){b=j,A(P?P+"{"+O.styles+"}":O.styles),U&&(k.inserted[O.name]=!0)}}var k={key:n,sheet:new o7({key:n,container:u,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:m};return k.sheet.hydrate(s),k},lM={exports:{}},Si={};var CD;function D7(){if(CD)return Si;CD=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,a=t?Symbol.for("react.strict_mode"):60108,l=t?Symbol.for("react.profiler"):60114,u=t?Symbol.for("react.provider"):60109,s=t?Symbol.for("react.context"):60110,m=t?Symbol.for("react.async_mode"):60111,_=t?Symbol.for("react.concurrent_mode"):60111,b=t?Symbol.for("react.forward_ref"):60112,M=t?Symbol.for("react.suspense"):60113,C=t?Symbol.for("react.suspense_list"):60120,A=t?Symbol.for("react.memo"):60115,k=t?Symbol.for("react.lazy"):60116,z=t?Symbol.for("react.block"):60121,P=t?Symbol.for("react.fundamental"):60117,O=t?Symbol.for("react.responder"):60118,j=t?Symbol.for("react.scope"):60119;function U(K){if(typeof K=="object"&&K!==null){var se=K.$$typeof;switch(se){case e:switch(K=K.type,K){case m:case _:case r:case l:case a:case M:return K;default:switch(K=K&&K.$$typeof,K){case s:case b:case k:case A:case u:return K;default:return se}}case n:return se}}}function X(K){return U(K)===_}return Si.AsyncMode=m,Si.ConcurrentMode=_,Si.ContextConsumer=s,Si.ContextProvider=u,Si.Element=e,Si.ForwardRef=b,Si.Fragment=r,Si.Lazy=k,Si.Memo=A,Si.Portal=n,Si.Profiler=l,Si.StrictMode=a,Si.Suspense=M,Si.isAsyncMode=function(K){return X(K)||U(K)===m},Si.isConcurrentMode=X,Si.isContextConsumer=function(K){return U(K)===s},Si.isContextProvider=function(K){return U(K)===u},Si.isElement=function(K){return typeof K=="object"&&K!==null&&K.$$typeof===e},Si.isForwardRef=function(K){return U(K)===b},Si.isFragment=function(K){return U(K)===r},Si.isLazy=function(K){return U(K)===k},Si.isMemo=function(K){return U(K)===A},Si.isPortal=function(K){return U(K)===n},Si.isProfiler=function(K){return U(K)===l},Si.isStrictMode=function(K){return U(K)===a},Si.isSuspense=function(K){return U(K)===M},Si.isValidElementType=function(K){return typeof K=="string"||typeof K=="function"||K===r||K===_||K===l||K===a||K===M||K===C||typeof K=="object"&&K!==null&&(K.$$typeof===k||K.$$typeof===A||K.$$typeof===u||K.$$typeof===s||K.$$typeof===b||K.$$typeof===P||K.$$typeof===O||K.$$typeof===j||K.$$typeof===z)},Si.typeOf=U,Si}var TD;function L7(){return TD||(TD=1,lM.exports=D7()),lM.exports}var cM,PD;function k7(){if(PD)return cM;PD=1;var t=L7(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};l[t.ForwardRef]=r,l[t.Memo]=a;function u(k){return t.isMemo(k)?a:l[k.$$typeof]||e}var s=Object.defineProperty,m=Object.getOwnPropertyNames,_=Object.getOwnPropertySymbols,b=Object.getOwnPropertyDescriptor,M=Object.getPrototypeOf,C=Object.prototype;function A(k,z,P){if(typeof z!="string"){if(C){var O=M(z);O&&O!==C&&A(k,O,P)}var j=m(z);_&&(j=j.concat(_(z)));for(var U=u(k),X=u(z),K=0;K<j.length;++K){var se=j[K];if(!n[se]&&!(P&&P[se])&&!(X&&X[se])&&!(U&&U[se])){var J=b(z,se);try{s(k,se,J)}catch{}}}}return k}return cM=A,cM}k7();var z7=!0;function J4(t,e,n){var r="";return n.split(" ").forEach(function(a){t[a]!==void 0?e.push(t[a]+";"):a&&(r+=a+" ")}),r}var zA=function(e,n,r){var a=e.key+"-"+n.name;(r===!1||z7===!1)&&e.registered[a]===void 0&&(e.registered[a]=n.styles)},OA=function(e,n,r){zA(e,n,r);var a=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var l=n;do e.insert(n===l?"."+a:"",l,e.sheet,!0),l=l.next;while(l!==void 0)}};function O7(t){for(var e=0,n,r=0,a=t.length;a>=4;++r,a-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(a){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var F7={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},N7=/[A-Z]|^ms/g,B7=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Q4=function(e){return e.charCodeAt(1)===45},AD=function(e){return e!=null&&typeof e!="boolean"},uM=Y4(function(t){return Q4(t)?t:t.replace(N7,"-$&").toLowerCase()}),ID=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(B7,function(r,a,l){return Zh={name:a,styles:l,next:Zh},a})}return F7[e]!==1&&!Q4(e)&&typeof n=="number"&&n!==0?n+"px":n};function W_(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var a=n;if(a.anim===1)return Zh={name:a.name,styles:a.styles,next:Zh},a.name;var l=n;if(l.styles!==void 0){var u=l.next;if(u!==void 0)for(;u!==void 0;)Zh={name:u.name,styles:u.styles,next:Zh},u=u.next;var s=l.styles+";";return s}return U7(t,e,n)}case"function":{if(t!==void 0){var m=Zh,_=n(t);return Zh=m,W_(t,e,_)}break}}var b=n;if(e==null)return b;var M=e[b];return M!==void 0?M:b}function U7(t,e,n){var r="";if(Array.isArray(n))for(var a=0;a<n.length;a++)r+=W_(t,e,n[a])+";";else for(var l in n){var u=n[l];if(typeof u!="object"){var s=u;e!=null&&e[s]!==void 0?r+=l+"{"+e[s]+"}":AD(s)&&(r+=uM(l)+":"+ID(l,s)+";")}else if(Array.isArray(u)&&typeof u[0]=="string"&&(e==null||e[u[0]]===void 0))for(var m=0;m<u.length;m++)AD(u[m])&&(r+=uM(l)+":"+ID(l,u[m])+";");else{var _=W_(t,e,u);switch(l){case"animation":case"animationName":{r+=uM(l)+":"+_+";";break}default:r+=l+"{"+_+"}"}}}return r}var RD=/label:\s*([^\s;{]+)\s*(;|$)/g,Zh;function mx(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,a="";Zh=void 0;var l=t[0];if(l==null||l.raw===void 0)r=!1,a+=W_(n,e,l);else{var u=l;a+=u[0]}for(var s=1;s<t.length;s++)if(a+=W_(n,e,t[s]),r){var m=l;a+=m[s]}RD.lastIndex=0;for(var _="",b;(b=RD.exec(a))!==null;)_+="-"+b[1];var M=O7(a)+_;return{name:M,styles:a,next:Zh}}var $7=function(e){return e()},eN=mw.useInsertionEffect?mw.useInsertionEffect:!1,tN=eN||$7,DD=eN||q.useLayoutEffect,nN=q.createContext(typeof HTMLElement<"u"?R7({key:"css"}):null);nN.Provider;var FA=function(e){return q.forwardRef(function(n,r){var a=q.useContext(nN);return e(n,a,r)})},gx=q.createContext({}),NA={}.hasOwnProperty,qT="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",V7=function(e,n){var r={};for(var a in n)NA.call(n,a)&&(r[a]=n[a]);return r[qT]=e,r},j7=function(e){var n=e.cache,r=e.serialized,a=e.isStringTag;return zA(n,r,a),tN(function(){return OA(n,r,a)}),null},H7=FA(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var a=t[qT],l=[r],u="";typeof t.className=="string"?u=J4(e.registered,l,t.className):t.className!=null&&(u=t.className+" ");var s=mx(l,void 0,q.useContext(gx));u+=e.key+"-"+s.name;var m={};for(var _ in t)NA.call(t,_)&&_!=="css"&&_!==qT&&(m[_]=t[_]);return m.className=u,n&&(m.ref=n),q.createElement(q.Fragment,null,q.createElement(j7,{cache:e,serialized:s,isStringTag:typeof a=="string"}),q.createElement(a,m))}),G7=H7,LD=function(e,n){var r=arguments;if(n==null||!NA.call(n,"css"))return q.createElement.apply(void 0,r);var a=r.length,l=new Array(a);l[0]=G7,l[1]=V7(e,n);for(var u=2;u<a;u++)l[u]=r[u];return q.createElement.apply(null,l)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(LD||(LD={}));var W7=FA(function(t,e){var n=t.styles,r=mx([n],void 0,q.useContext(gx)),a=q.useRef();return DD(function(){var l=e.key+"-global",u=new e.sheet.constructor({key:l,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),s=!1,m=document.querySelector('style[data-emotion="'+l+" "+r.name+'"]');return e.sheet.tags.length&&(u.before=e.sheet.tags[0]),m!==null&&(s=!0,m.setAttribute("data-emotion",l),u.hydrate([m])),a.current=[u,s],function(){u.flush()}},[e]),DD(function(){var l=a.current,u=l[0],s=l[1];if(s){l[1]=!1;return}if(r.next!==void 0&&OA(e,r.next,!0),u.tags.length){var m=u.tags[u.tags.length-1].nextElementSibling;u.before=m,u.flush()}e.insert("",r,u,!1)},[e,r.name]),null});function rN(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return mx(e)}function BA(){var t=rN.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var q7=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,X7=Y4(function(t){return q7.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),Z7=X7,Y7=function(e){return e!=="theme"},kD=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Z7:Y7},zD=function(e,n,r){var a;if(n){var l=n.shouldForwardProp;a=e.__emotion_forwardProp&&l?function(u){return e.__emotion_forwardProp(u)&&l(u)}:l}return typeof a!="function"&&r&&(a=e.__emotion_forwardProp),a},K7=function(e){var n=e.cache,r=e.serialized,a=e.isStringTag;return zA(n,r,a),tN(function(){return OA(n,r,a)}),null},J7=function t(e,n){var r=e.__emotion_real===e,a=r&&e.__emotion_base||e,l,u;n!==void 0&&(l=n.label,u=n.target);var s=zD(e,n,r),m=s||kD(a),_=!m("as");return function(){var b=arguments,M=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(l!==void 0&&M.push("label:"+l+";"),b[0]==null||b[0].raw===void 0)M.push.apply(M,b);else{var C=b[0];M.push(C[0]);for(var A=b.length,k=1;k<A;k++)M.push(b[k],C[k])}var z=FA(function(P,O,j){var U=_&&P.as||a,X="",K=[],se=P;if(P.theme==null){se={};for(var J in P)se[J]=P[J];se.theme=q.useContext(gx)}typeof P.className=="string"?X=J4(O.registered,K,P.className):P.className!=null&&(X=P.className+" ");var ue=mx(M.concat(K),O.registered,se);X+=O.key+"-"+ue.name,u!==void 0&&(X+=" "+u);var ne=_&&s===void 0?kD(U):m,H={};for(var de in P)_&&de==="as"||ne(de)&&(H[de]=P[de]);return H.className=X,j&&(H.ref=j),q.createElement(q.Fragment,null,q.createElement(K7,{cache:O,serialized:ue,isStringTag:typeof U=="string"}),q.createElement(U,H))});return z.displayName=l!==void 0?l:"Styled("+(typeof a=="string"?a:a.displayName||a.name||"Component")+")",z.defaultProps=e.defaultProps,z.__emotion_real=z,z.__emotion_base=a,z.__emotion_styles=M,z.__emotion_forwardProp=s,Object.defineProperty(z,"toString",{value:function(){return"."+u}}),z.withComponent=function(P,O){var j=t(P,ye({},n,O,{shouldForwardProp:zD(z,O,!0)}));return j.apply(void 0,M)},z}},Q7=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],vw=J7.bind(null);Q7.forEach(function(t){vw[t]=vw(t)});function eH(t){return t==null||Object.keys(t).length===0}function Hb(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?a=>e(eH(a)?n:a):e;return ae.jsx(W7,{styles:r})}function iN(t,e){return vw(t,e)}const tH=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))};function lr(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function zp(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function oN(t){if(q.isValidElement(t)||!zp(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=oN(t[n])}),e}function fc(t,e,n={clone:!0}){const r=n.clone?ye({},t):t;return zp(t)&&zp(e)&&Object.keys(e).forEach(a=>{q.isValidElement(e[a])?r[a]=e[a]:zp(e[a])&&Object.prototype.hasOwnProperty.call(t,a)&&zp(t[a])?r[a]=fc(t[a],e[a],n):n.clone?r[a]=zp(e[a])?oN(e[a]):e[a]:r[a]=e[a]}),r}const nH=["values","unit","step"],rH=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>ye({},n,{[r.key]:r.val}),{})};function sN(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,a=lr(t,nH),l=rH(e),u=Object.keys(l);function s(C){return`@media (min-width:${typeof e[C]=="number"?e[C]:C}${n})`}function m(C){return`@media (max-width:${(typeof e[C]=="number"?e[C]:C)-r/100}${n})`}function _(C,A){const k=u.indexOf(A);return`@media (min-width:${typeof e[C]=="number"?e[C]:C}${n}) and (max-width:${(k!==-1&&typeof e[u[k]]=="number"?e[u[k]]:A)-r/100}${n})`}function b(C){return u.indexOf(C)+1<u.length?_(C,u[u.indexOf(C)+1]):s(C)}function M(C){const A=u.indexOf(C);return A===0?s(u[1]):A===u.length-1?m(u[A]):_(C,u[u.indexOf(C)+1]).replace("@media","@media not all and")}return ye({keys:u,values:l,up:s,down:m,between:_,only:b,not:M,unit:n},a)}const iH={borderRadius:4};function m_(t,e){return e?fc(t,e,{clone:!1}):t}const UA={xs:0,sm:600,md:900,lg:1200,xl:1536},OD={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${UA[t]}px)`};function sh(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const l=r.breakpoints||OD;return e.reduce((u,s,m)=>(u[l.up(l.keys[m])]=n(e[m]),u),{})}if(typeof e=="object"){const l=r.breakpoints||OD;return Object.keys(e).reduce((u,s)=>{if(Object.keys(l.values||UA).indexOf(s)!==-1){const m=l.up(s);u[m]=n(e[s],s)}else{const m=s;u[m]=e[m]}return u},{})}return n(e)}function aN(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,a)=>{const l=t.up(a);return r[l]={},r},{}))||{}}function lN(t,e){return t.reduce((n,r)=>{const a=n[r];return(!a||Object.keys(a).length===0)&&delete n[r],n},e)}function oH(t,...e){const n=aN(t),r=[n,...e].reduce((a,l)=>fc(a,l),{});return lN(Object.keys(n),r)}function sH(t,e){if(typeof t!="object")return{};const n={},r=Object.keys(e);return Array.isArray(t)?r.forEach((a,l)=>{l<t.length&&(n[a]=!0)}):r.forEach(a=>{t[a]!=null&&(n[a]=!0)}),n}function hM({values:t,breakpoints:e,base:n}){const r=n||sH(t,e),a=Object.keys(r);if(a.length===0)return t;let l;return a.reduce((u,s,m)=>(Array.isArray(t)?(u[s]=t[m]!=null?t[m]:t[l],l=m):typeof t=="object"?(u[s]=t[s]!=null?t[s]:t[l],l=s):u[s]=t,u),{})}function Ln(t){if(typeof t!="string")throw new Error(j_(7));return t.charAt(0).toUpperCase()+t.slice(1)}function Yp(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((a,l)=>a&&a[l]?a[l]:null,t);if(r!=null)return r}return e.split(".").reduce((r,a)=>r&&r[a]!=null?r[a]:null,t)}function yw(t,e,n,r=n){let a;return typeof t=="function"?a=t(n):Array.isArray(t)?a=t[n]||r:a=Yp(t,n)||r,e&&(a=e(a,r,t)),a}function jo(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:a}=t,l=u=>{if(u[e]==null)return null;const s=u[e],m=u.theme,_=Yp(m,r)||{};return sh(u,s,M=>{let C=yw(_,a,M);return M===C&&typeof M=="string"&&(C=yw(_,a,`${e}${M==="default"?"":Ln(M)}`,M)),n===!1?C:{[n]:C}})};return l.propTypes={},l.filterProps=[e],l}function aH(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const lH={m:"margin",p:"padding"},cH={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},FD={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},uH=aH(t=>{if(t.length>2)if(FD[t])t=FD[t];else return[t];const[e,n]=t.split(""),r=lH[e],a=cH[n]||"";return Array.isArray(a)?a.map(l=>r+l):[r+a]}),$A=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],VA=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...$A,...VA];function vx(t,e,n,r){var a;const l=(a=Yp(t,e,!1))!=null?a:n;return typeof l=="number"?u=>typeof u=="string"?u:l*u:Array.isArray(l)?u=>typeof u=="string"?u:l[u]:typeof l=="function"?l:()=>{}}function jA(t){return vx(t,"spacing",8)}function Pg(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function hH(t,e){return n=>t.reduce((r,a)=>(r[a]=Pg(e,n),r),{})}function dH(t,e,n,r){if(e.indexOf(n)===-1)return null;const a=uH(n),l=hH(a,r),u=t[n];return sh(t,u,l)}function cN(t,e){const n=jA(t.theme);return Object.keys(t).map(r=>dH(t,e,r,n)).reduce(m_,{})}function Ro(t){return cN(t,$A)}Ro.propTypes={};Ro.filterProps=$A;function Do(t){return cN(t,VA)}Do.propTypes={};Do.filterProps=VA;function uN(t=8){if(t.mui)return t;const e=jA({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(l=>{const u=e(l);return typeof u=="number"?`${u}px`:u}).join(" ");return n.mui=!0,n}function cS(...t){const e=t.reduce((r,a)=>(a.filterProps.forEach(l=>{r[l]=a}),r),{}),n=r=>Object.keys(r).reduce((a,l)=>e[l]?m_(a,e[l](r)):a,{});return n.propTypes={},n.filterProps=t.reduce((r,a)=>r.concat(a.filterProps),[]),n}function Jc(t){return typeof t!="number"?t:`${t}px solid`}function iu(t,e){return jo({prop:t,themeKey:"borders",transform:e})}const fH=iu("border",Jc),pH=iu("borderTop",Jc),mH=iu("borderRight",Jc),gH=iu("borderBottom",Jc),vH=iu("borderLeft",Jc),yH=iu("borderColor"),_H=iu("borderTopColor"),xH=iu("borderRightColor"),bH=iu("borderBottomColor"),wH=iu("borderLeftColor"),SH=iu("outline",Jc),MH=iu("outlineColor"),uS=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=vx(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Pg(e,r)});return sh(t,t.borderRadius,n)}return null};uS.propTypes={};uS.filterProps=["borderRadius"];cS(fH,pH,mH,gH,vH,yH,_H,xH,bH,wH,uS,SH,MH);const hS=t=>{if(t.gap!==void 0&&t.gap!==null){const e=vx(t.theme,"spacing",8),n=r=>({gap:Pg(e,r)});return sh(t,t.gap,n)}return null};hS.propTypes={};hS.filterProps=["gap"];const dS=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=vx(t.theme,"spacing",8),n=r=>({columnGap:Pg(e,r)});return sh(t,t.columnGap,n)}return null};dS.propTypes={};dS.filterProps=["columnGap"];const fS=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=vx(t.theme,"spacing",8),n=r=>({rowGap:Pg(e,r)});return sh(t,t.rowGap,n)}return null};fS.propTypes={};fS.filterProps=["rowGap"];const EH=jo({prop:"gridColumn"}),CH=jo({prop:"gridRow"}),TH=jo({prop:"gridAutoFlow"}),PH=jo({prop:"gridAutoColumns"}),AH=jo({prop:"gridAutoRows"}),IH=jo({prop:"gridTemplateColumns"}),RH=jo({prop:"gridTemplateRows"}),DH=jo({prop:"gridTemplateAreas"}),LH=jo({prop:"gridArea"});cS(hS,dS,fS,EH,CH,TH,PH,AH,IH,RH,DH,LH);function gy(t,e){return e==="grey"?e:t}const kH=jo({prop:"color",themeKey:"palette",transform:gy}),zH=jo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:gy}),OH=jo({prop:"backgroundColor",themeKey:"palette",transform:gy});cS(kH,zH,OH);function lc(t){return t<=1&&t!==0?`${t*100}%`:t}const FH=jo({prop:"width",transform:lc}),HA=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,a;const l=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||UA[n];return l?((a=t.theme)==null||(a=a.breakpoints)==null?void 0:a.unit)!=="px"?{maxWidth:`${l}${t.theme.breakpoints.unit}`}:{maxWidth:l}:{maxWidth:lc(n)}};return sh(t,t.maxWidth,e)}return null};HA.filterProps=["maxWidth"];const NH=jo({prop:"minWidth",transform:lc}),BH=jo({prop:"height",transform:lc}),UH=jo({prop:"maxHeight",transform:lc}),$H=jo({prop:"minHeight",transform:lc});jo({prop:"size",cssProperty:"width",transform:lc});jo({prop:"size",cssProperty:"height",transform:lc});const VH=jo({prop:"boxSizing"});cS(FH,HA,NH,BH,UH,$H,VH);const pS={border:{themeKey:"borders",transform:Jc},borderTop:{themeKey:"borders",transform:Jc},borderRight:{themeKey:"borders",transform:Jc},borderBottom:{themeKey:"borders",transform:Jc},borderLeft:{themeKey:"borders",transform:Jc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Jc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:uS},color:{themeKey:"palette",transform:gy},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:gy},backgroundColor:{themeKey:"palette",transform:gy},p:{style:Do},pt:{style:Do},pr:{style:Do},pb:{style:Do},pl:{style:Do},px:{style:Do},py:{style:Do},padding:{style:Do},paddingTop:{style:Do},paddingRight:{style:Do},paddingBottom:{style:Do},paddingLeft:{style:Do},paddingX:{style:Do},paddingY:{style:Do},paddingInline:{style:Do},paddingInlineStart:{style:Do},paddingInlineEnd:{style:Do},paddingBlock:{style:Do},paddingBlockStart:{style:Do},paddingBlockEnd:{style:Do},m:{style:Ro},mt:{style:Ro},mr:{style:Ro},mb:{style:Ro},ml:{style:Ro},mx:{style:Ro},my:{style:Ro},margin:{style:Ro},marginTop:{style:Ro},marginRight:{style:Ro},marginBottom:{style:Ro},marginLeft:{style:Ro},marginX:{style:Ro},marginY:{style:Ro},marginInline:{style:Ro},marginInlineStart:{style:Ro},marginInlineEnd:{style:Ro},marginBlock:{style:Ro},marginBlockStart:{style:Ro},marginBlockEnd:{style:Ro},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:hS},rowGap:{style:fS},columnGap:{style:dS},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:lc},maxWidth:{style:HA},minWidth:{transform:lc},height:{transform:lc},maxHeight:{transform:lc},minHeight:{transform:lc},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function jH(...t){const e=t.reduce((r,a)=>r.concat(Object.keys(a)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function HH(t,e){return typeof t=="function"?t(e):t}function GH(){function t(n,r,a,l){const u={[n]:r,theme:a},s=l[n];if(!s)return{[n]:r};const{cssProperty:m=n,themeKey:_,transform:b,style:M}=s;if(r==null)return null;if(_==="typography"&&r==="inherit")return{[n]:r};const C=Yp(a,_)||{};return M?M(u):sh(u,r,k=>{let z=yw(C,b,k);return k===z&&typeof k=="string"&&(z=yw(C,b,`${n}${k==="default"?"":Ln(k)}`,k)),m===!1?z:{[m]:z}})}function e(n){var r;const{sx:a,theme:l={}}=n||{};if(!a)return null;const u=(r=l.unstable_sxConfig)!=null?r:pS;function s(m){let _=m;if(typeof m=="function")_=m(l);else if(typeof m!="object")return m;if(!_)return null;const b=aN(l.breakpoints),M=Object.keys(b);let C=b;return Object.keys(_).forEach(A=>{const k=HH(_[A],l);if(k!=null)if(typeof k=="object")if(u[A])C=m_(C,t(A,k,l,u));else{const z=sh({theme:l},k,P=>({[A]:P}));jH(z,k)?C[A]=e({sx:k,theme:l}):C=m_(C,z)}else C=m_(C,t(A,k,l,u))}),lN(M,C)}return Array.isArray(a)?a.map(s):s(a)}return e}const yx=GH();yx.filterProps=["sx"];function hN(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const WH=["breakpoints","palette","spacing","shape"];function GA(t={},...e){const{breakpoints:n={},palette:r={},spacing:a,shape:l={}}=t,u=lr(t,WH),s=sN(n),m=uN(a);let _=fc({breakpoints:s,direction:"ltr",components:{},palette:ye({mode:"light"},r),spacing:m,shape:ye({},iH,l)},u);return _.applyStyles=hN,_=e.reduce((b,M)=>fc(b,M),_),_.unstable_sxConfig=ye({},pS,u?.unstable_sxConfig),_.unstable_sx=function(M){return yx({sx:M,theme:this})},_}function qH(t){return Object.keys(t).length===0}function dN(t=null){const e=q.useContext(gx);return!e||qH(e)?t:e}const XH=GA();function WA(t=XH){return dN(t)}function ZH({styles:t,themeId:e,defaultTheme:n={}}){const r=WA(n),a=typeof t=="function"?t(e&&r[e]||r):t;return ae.jsx(Hb,{styles:a})}const YH=["sx"],KH=t=>{var e,n;const r={systemProps:{},otherProps:{}},a=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:pS;return Object.keys(t).forEach(l=>{a[l]?r.systemProps[l]=t[l]:r.otherProps[l]=t[l]}),r};function mS(t){const{sx:e}=t,n=lr(t,YH),{systemProps:r,otherProps:a}=KH(n);let l;return Array.isArray(e)?l=[r,...e]:typeof e=="function"?l=(...u)=>{const s=e(...u);return zp(s)?ye({},r,s):r}:l=ye({},r,e),ye({},a,{sx:l})}const ND=t=>t,JH=()=>{let t=ND;return{configure(e){t=e},generate(e){return t(e)},reset(){t=ND}}},fN=JH();function pN(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=pN(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function yo(){for(var t,e,n=0,r="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=pN(t))&&(r&&(r+=" "),r+=e);return r}const QH=["className","component"];function eG(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:a}=t,l=iN("div",{shouldForwardProp:s=>s!=="theme"&&s!=="sx"&&s!=="as"})(yx);return q.forwardRef(function(m,_){const b=WA(n),M=mS(m),{className:C,component:A="div"}=M,k=lr(M,QH);return ae.jsx(l,ye({as:A,ref:_,className:yo(C,a?a(r):r),theme:e&&b[e]||b},k))})}const mN={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function qA(t,e,n="Mui"){const r=mN[e];return r?`${n}-${r}`:`${fN.generate(t)}-${e}`}function gN(t,e,n="Mui"){const r={};return e.forEach(a=>{r[a]=qA(t,a,n)}),r}const tG=["ownerState"],nG=["variants"],rG=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function iG(t){return Object.keys(t).length===0}function oG(t){return typeof t=="string"&&t.charCodeAt(0)>96}function dM(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const sG=GA(),aG=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function X1({defaultTheme:t,theme:e,themeId:n}){return iG(e)?t:e[n]||e}function lG(t){return t?(e,n)=>n[t]:null}function Gb(t,e){let{ownerState:n}=e,r=lr(e,tG);const a=typeof t=="function"?t(ye({ownerState:n},r)):t;if(Array.isArray(a))return a.flatMap(l=>Gb(l,ye({ownerState:n},r)));if(a&&typeof a=="object"&&Array.isArray(a.variants)){const{variants:l=[]}=a;let s=lr(a,nG);return l.forEach(m=>{let _=!0;typeof m.props=="function"?_=m.props(ye({ownerState:n},r,n)):Object.keys(m.props).forEach(b=>{n?.[b]!==m.props[b]&&r[b]!==m.props[b]&&(_=!1)}),_&&(Array.isArray(s)||(s=[s]),s.push(typeof m.style=="function"?m.style(ye({ownerState:n},r,n)):m.style))}),s}return a}function vN(t={}){const{themeId:e,defaultTheme:n=sG,rootShouldForwardProp:r=dM,slotShouldForwardProp:a=dM}=t,l=u=>yx(ye({},u,{theme:X1(ye({},u,{defaultTheme:n,themeId:e}))}));return l.__mui_systemSx=!0,(u,s={})=>{tH(u,K=>K.filter(se=>!(se!=null&&se.__mui_systemSx)));const{name:m,slot:_,skipVariantsResolver:b,skipSx:M,overridesResolver:C=lG(aG(_))}=s,A=lr(s,rG),k=b!==void 0?b:_&&_!=="Root"&&_!=="root"||!1,z=M||!1;let P,O=dM;_==="Root"||_==="root"?O=r:_?O=a:oG(u)&&(O=void 0);const j=iN(u,ye({shouldForwardProp:O,label:P},A)),U=K=>typeof K=="function"&&K.__emotion_real!==K||zp(K)?se=>Gb(K,ye({},se,{theme:X1({theme:se.theme,defaultTheme:n,themeId:e})})):K,X=(K,...se)=>{let J=U(K);const ue=se?se.map(U):[];m&&C&&ue.push(de=>{const Ee=X1(ye({},de,{defaultTheme:n,themeId:e}));if(!Ee.components||!Ee.components[m]||!Ee.components[m].styleOverrides)return null;const Pe=Ee.components[m].styleOverrides,Ze={};return Object.entries(Pe).forEach(([ke,Te])=>{Ze[ke]=Gb(Te,ye({},de,{theme:Ee}))}),C(de,Ze)}),m&&!k&&ue.push(de=>{var Ee;const Pe=X1(ye({},de,{defaultTheme:n,themeId:e})),Ze=Pe==null||(Ee=Pe.components)==null||(Ee=Ee[m])==null?void 0:Ee.variants;return Gb({variants:Ze},ye({},de,{theme:Pe}))}),z||ue.push(l);const ne=ue.length-se.length;if(Array.isArray(K)&&ne>0){const de=new Array(ne).fill("");J=[...K,...de],J.raw=[...K.raw,...de]}const H=j(J,...ue);return u.muiName&&(H.muiName=u.muiName),H};return j.withConfig&&(X.withConfig=j.withConfig),X}}const cG=vN();function yN(t,e){const n=ye({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=ye({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const a=t[r]||{},l=e[r];n[r]={},!l||!Object.keys(l)?n[r]=a:!a||!Object.keys(a)?n[r]=l:(n[r]=ye({},l),Object.keys(a).forEach(u=>{n[r][u]=yN(a[u],l[u])}))}else n[r]===void 0&&(n[r]=t[r])}),n}function uG(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:yN(e.components[n].defaultProps,r)}function _N({props:t,name:e,defaultTheme:n,themeId:r}){let a=WA(n);return r&&(a=a[r]||a),uG({theme:a,name:e,props:t})}const df=typeof window<"u"?q.useLayoutEffect:q.useEffect;function hG(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,a)=>a<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function xN(t){if(t.type)return t;if(t.charAt(0)==="#")return xN(hG(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(j_(9,t));let r=t.substring(e+1,t.length-1),a;if(n==="color"){if(r=r.split(" "),a=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(a)===-1)throw new Error(j_(10,a))}else r=r.split(",");return r=r.map(l=>parseFloat(l)),{type:n,values:r,colorSpace:a}}const sg=t=>{const e=xN(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};function BD(...t){return t.reduce((e,n)=>n==null?e:function(...a){e.apply(this,a),n.apply(this,a)},()=>{})}function gS(t,e){var n,r;return q.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function pc(t){return t&&t.ownerDocument||document}function XA(t){return pc(t).defaultView||window}function _w(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let UD=0;function dG(t){const[e,n]=q.useState(t),r=t||e;return q.useEffect(()=>{e==null&&(UD+=1,n(`mui-${UD}`))},[e]),r}const $D=mw.useId;function Pl(t){if($D!==void 0){const e=$D();return t??e}return dG(t)}function vy({controlled:t,default:e,name:n,state:r="value"}){const{current:a}=q.useRef(t!==void 0),[l,u]=q.useState(e),s=a?t:l,m=q.useCallback(_=>{a||u(_)},[]);return[s,m]}function nh(t){const e=q.useRef(t);return df(()=>{e.current=t}),q.useRef((...n)=>(0,e.current)(...n)).current}function pi(...t){return q.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{_w(n,e)})},t)}const VD={};function fG(t,e){const n=q.useRef(VD);return n.current===VD&&(n.current=t(e)),n}const pG=[];function mG(t){q.useEffect(t,pG)}class _x{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new _x}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function n_(){const t=fG(_x.create).current;return mG(t.disposeEffect),t}let vS=!0,XT=!1;const gG=new _x,vG={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function yG(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&vG[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function _G(t){t.metaKey||t.altKey||t.ctrlKey||(vS=!0)}function fM(){vS=!1}function xG(){this.visibilityState==="hidden"&&XT&&(vS=!0)}function bG(t){t.addEventListener("keydown",_G,!0),t.addEventListener("mousedown",fM,!0),t.addEventListener("pointerdown",fM,!0),t.addEventListener("touchstart",fM,!0),t.addEventListener("visibilitychange",xG,!0)}function wG(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return vS||yG(e)}function yS(){const t=q.useCallback(a=>{a!=null&&bG(a.ownerDocument)},[]),e=q.useRef(!1);function n(){return e.current?(XT=!0,gG.start(100,()=>{XT=!1}),e.current=!1,!0):!1}function r(a){return wG(a)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function SG(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const MG=t=>{const e=q.useRef({});return q.useEffect(()=>{e.current=t}),e.current},EG={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function $r(t,e,n=void 0){const r={};return Object.keys(t).forEach(a=>{r[a]=t[a].reduce((l,u)=>{if(u){const s=e(u);s!==""&&l.push(s),n&&n[u]&&l.push(n[u])}return l},[]).join(" ")}),r}function CG(t){return typeof t=="string"}function bN(t,e,n){return t===void 0||CG(t)?e:ye({},e,{ownerState:ye({},e.ownerState,n)})}function gs(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function jD(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function wN(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:a,className:l}=t;if(!e){const A=yo(n?.className,l,a?.className,r?.className),k=ye({},n?.style,a?.style,r?.style),z=ye({},n,a,r);return A.length>0&&(z.className=A),Object.keys(k).length>0&&(z.style=k),{props:z,internalRef:void 0}}const u=gs(ye({},a,r)),s=jD(r),m=jD(a),_=e(u),b=yo(_?.className,n?.className,l,a?.className,r?.className),M=ye({},_?.style,n?.style,a?.style,r?.style),C=ye({},_,n,m,s);return b.length>0&&(C.className=b),Object.keys(M).length>0&&(C.style=M),{props:C,internalRef:_.ref}}function SN(t,e,n){return typeof t=="function"?t(e,n):t}const TG=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function MN(t){var e;const{elementType:n,externalSlotProps:r,ownerState:a,skipResolvingSlotProps:l=!1}=t,u=lr(t,TG),s=l?{}:SN(r,a),{props:m,internalRef:_}=wN(ye({},u,{externalSlotProps:s})),b=pi(_,s?.ref,(e=t.additionalProps)==null?void 0:e.ref);return bN(n,ye({},m,{ref:b}),a)}function _S(t){if(parseInt(q.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return t?.ref||null}const EN=q.createContext(null);function ZA(){return q.useContext(EN)}const PG=typeof Symbol=="function"&&Symbol.for,AG=PG?Symbol.for("mui.nested"):"__THEME_NESTED__";function IG(t,e){return typeof e=="function"?e(t):ye({},t,e)}function RG(t){const{children:e,theme:n}=t,r=ZA(),a=q.useMemo(()=>{const l=r===null?n:IG(r,n);return l!=null&&(l[AG]=r!==null),l},[n,r]);return ae.jsx(EN.Provider,{value:a,children:e})}const DG=["value"],LG=q.createContext();function kG(t){let{value:e}=t,n=lr(t,DG);return ae.jsx(LG.Provider,ye({value:e??!0},n))}const zG=q.createContext(void 0);function OG({value:t,children:e}){return ae.jsx(zG.Provider,{value:t,children:e})}const HD={};function GD(t,e,n,r=!1){return q.useMemo(()=>{const a=t&&e[t]||e;if(typeof n=="function"){const l=n(a),u=t?ye({},e,{[t]:l}):l;return r?()=>u:u}return t?ye({},e,{[t]:n}):ye({},e,n)},[t,e,n,r])}function FG(t){const{children:e,theme:n,themeId:r}=t,a=dN(HD),l=ZA()||HD,u=GD(r,a,n),s=GD(r,l,n,!0),m=u.direction==="rtl";return ae.jsx(RG,{theme:s,children:ae.jsx(gx.Provider,{value:u,children:ae.jsx(kG,{value:m,children:ae.jsx(OG,{value:u?.components,children:e})})})})}const YA="mode",KA="color-scheme",CN="data-color-scheme";function NG(t){const{defaultMode:e="light",defaultLightColorScheme:n="light",defaultDarkColorScheme:r="dark",modeStorageKey:a=YA,colorSchemeStorageKey:l=KA,attribute:u=CN,colorSchemeNode:s="document.documentElement",nonce:m}=t||{};return ae.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?m:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  var mode = localStorage.getItem('${a}') || '${e}';
  var colorScheme = '';
  if (mode === 'system') {
    // handle system mode
    var mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = localStorage.getItem('${l}-dark') || '${r}';
    } else {
      colorScheme = localStorage.getItem('${l}-light') || '${n}';
    }
  }
  if (mode === 'light') {
    colorScheme = localStorage.getItem('${l}-light') || '${n}';
  }
  if (mode === 'dark') {
    colorScheme = localStorage.getItem('${l}-dark') || '${r}';
  }
  if (colorScheme) {
    ${s}.setAttribute('${u}', colorScheme);
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function WD(t){if(typeof window<"u"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function TN(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function BG(t){return TN(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function pM(t,e){if(typeof window>"u")return;let n;try{n=localStorage.getItem(t)||void 0,n||localStorage.setItem(t,e)}catch{}return n||e}function UG(t){const{defaultMode:e="light",defaultLightColorScheme:n,defaultDarkColorScheme:r,supportedColorSchemes:a=[],modeStorageKey:l=YA,colorSchemeStorageKey:u=KA,storageWindow:s=typeof window>"u"?void 0:window}=t,m=a.join(","),[_,b]=q.useState(()=>{const P=pM(l,e),O=pM(`${u}-light`,n),j=pM(`${u}-dark`,r);return{mode:P,systemMode:WD(P),lightColorScheme:O,darkColorScheme:j}}),M=BG(_),C=q.useCallback(P=>{b(O=>{if(P===O.mode)return O;const j=P??e;try{localStorage.setItem(l,j)}catch{}return ye({},O,{mode:j,systemMode:WD(j)})})},[l,e]),A=q.useCallback(P=>{P?typeof P=="string"?P&&!m.includes(P)?console.error(`\`${P}\` does not exist in \`theme.colorSchemes\`.`):b(O=>{const j=ye({},O);return TN(O,U=>{try{localStorage.setItem(`${u}-${U}`,P)}catch{}U==="light"&&(j.lightColorScheme=P),U==="dark"&&(j.darkColorScheme=P)}),j}):b(O=>{const j=ye({},O),U=P.light===null?n:P.light,X=P.dark===null?r:P.dark;if(U)if(!m.includes(U))console.error(`\`${U}\` does not exist in \`theme.colorSchemes\`.`);else{j.lightColorScheme=U;try{localStorage.setItem(`${u}-light`,U)}catch{}}if(X)if(!m.includes(X))console.error(`\`${X}\` does not exist in \`theme.colorSchemes\`.`);else{j.darkColorScheme=X;try{localStorage.setItem(`${u}-dark`,X)}catch{}}return j}):b(O=>{try{localStorage.setItem(`${u}-light`,n),localStorage.setItem(`${u}-dark`,r)}catch{}return ye({},O,{lightColorScheme:n,darkColorScheme:r})})},[m,u,n,r]),k=q.useCallback(P=>{_.mode==="system"&&b(O=>{const j=P!=null&&P.matches?"dark":"light";return O.systemMode===j?O:ye({},O,{systemMode:j})})},[_.mode]),z=q.useRef(k);return z.current=k,q.useEffect(()=>{const P=(...j)=>z.current(...j),O=window.matchMedia("(prefers-color-scheme: dark)");return O.addListener(P),P(O),()=>{O.removeListener(P)}},[]),q.useEffect(()=>{if(s){const P=O=>{const j=O.newValue;typeof O.key=="string"&&O.key.startsWith(u)&&(!j||m.match(j))&&(O.key.endsWith("light")&&A({light:j}),O.key.endsWith("dark")&&A({dark:j})),O.key===l&&(!j||["light","dark","system"].includes(j))&&C(j||e)};return s.addEventListener("storage",P),()=>{s.removeEventListener("storage",P)}}},[A,C,l,u,m,e,s]),ye({},_,{colorScheme:M,setMode:C,setColorScheme:A})}const $G=["colorSchemes","components","generateCssVars","cssVarPrefix"],VG="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function jG(t){const{themeId:e,theme:n={},attribute:r=CN,modeStorageKey:a=YA,colorSchemeStorageKey:l=KA,defaultMode:u="light",defaultColorScheme:s,disableTransitionOnChange:m=!1,resolveTheme:_,excludeVariablesFromRoot:b}=t;(!n.colorSchemes||typeof s=="string"&&!n.colorSchemes[s]||typeof s=="object"&&!n.colorSchemes[s?.light]||typeof s=="object"&&!n.colorSchemes[s?.dark])&&console.error(`MUI: \`${s}\` does not exist in \`theme.colorSchemes\`.`);const M=q.createContext(void 0),C=()=>{const O=q.useContext(M);if(!O)throw new Error(j_(19));return O};function A(O){const{children:j,theme:U=n,modeStorageKey:X=a,colorSchemeStorageKey:K=l,attribute:se=r,defaultMode:J=u,defaultColorScheme:ue=s,disableTransitionOnChange:ne=m,storageWindow:H=typeof window>"u"?void 0:window,documentNode:de=typeof document>"u"?void 0:document,colorSchemeNode:Ee=typeof document>"u"?void 0:document.documentElement,colorSchemeSelector:Pe=":root",disableNestedContext:Ze=!1,disableStyleSheetGeneration:ke=!1}=O,Te=q.useRef(!1),Ie=ZA(),Ce=q.useContext(M),Ue=!!Ce&&!Ze,nt=U[e],Le=nt||U,{colorSchemes:lt={},components:Ht={},generateCssVars:He=()=>({vars:{},css:{}}),cssVarPrefix:pt}=Le,_t=lr(Le,$G),ot=Object.keys(lt),et=typeof ue=="string"?ue:ue.light,Mt=typeof ue=="string"?ue:ue.dark,{mode:Tt,setMode:hn,systemMode:en,lightColorScheme:an,darkColorScheme:Ke,colorScheme:An,setColorScheme:Gt}=UG({supportedColorSchemes:ot,defaultLightColorScheme:et,defaultDarkColorScheme:Mt,modeStorageKey:X,colorSchemeStorageKey:K,defaultMode:J,storageWindow:H});let on=Tt,Wt=An;Ue&&(on=Ce.mode,Wt=Ce.colorScheme);const Gn=on||(J==="system"?u:J),dn=Wt||(Gn==="dark"?Mt:et),{css:Ve,vars:Se}=He(),bt=ye({},_t,{components:Ht,colorSchemes:lt,cssVarPrefix:pt,vars:Se,getColorSchemeSelector:qt=>`[${se}="${qt}"] &`}),Nt={},jt={};Object.entries(lt).forEach(([qt,Fn])=>{const{css:Be,vars:ee}=He(qt);bt.vars=fc(bt.vars,ee),qt===dn&&(Object.keys(Fn).forEach(fe=>{Fn[fe]&&typeof Fn[fe]=="object"?bt[fe]=ye({},bt[fe],Fn[fe]):bt[fe]=Fn[fe]}),bt.palette&&(bt.palette.colorScheme=qt));const oe=typeof ue=="string"?ue:J==="dark"?ue.dark:ue.light;if(qt===oe){if(b){const fe={};b(pt).forEach(he=>{fe[he]=Be[he],delete Be[he]}),Nt[`[${se}="${qt}"]`]=fe}Nt[`${Pe}, [${se}="${qt}"]`]=Be}else jt[`${Pe===":root"?"":Pe}[${se}="${qt}"]`]=Be}),bt.vars=fc(bt.vars,Se),q.useEffect(()=>{Wt&&Ee&&Ee.setAttribute(se,Wt)},[Wt,se,Ee]),q.useEffect(()=>{let qt;if(ne&&Te.current&&de){const Fn=de.createElement("style");Fn.appendChild(de.createTextNode(VG)),de.head.appendChild(Fn),window.getComputedStyle(de.body),qt=setTimeout(()=>{de.head.removeChild(Fn)},1)}return()=>{clearTimeout(qt)}},[Wt,ne,de]),q.useEffect(()=>(Te.current=!0,()=>{Te.current=!1}),[]);const Ut=q.useMemo(()=>({allColorSchemes:ot,colorScheme:Wt,darkColorScheme:Ke,lightColorScheme:an,mode:on,setColorScheme:Gt,setMode:hn,systemMode:en}),[ot,Wt,Ke,an,on,Gt,hn,en]);let yn=!0;(ke||Ue&&Ie?.cssVarPrefix===pt)&&(yn=!1);const Zt=ae.jsxs(q.Fragment,{children:[yn&&ae.jsxs(q.Fragment,{children:[ae.jsx(Hb,{styles:{[Pe]:Ve}}),ae.jsx(Hb,{styles:Nt}),ae.jsx(Hb,{styles:jt})]}),ae.jsx(FG,{themeId:nt?e:void 0,theme:_?_(bt):bt,children:j})]});return Ue?Zt:ae.jsx(M.Provider,{value:Ut,children:Zt})}const k=typeof s=="string"?s:s.light,z=typeof s=="string"?s:s.dark;return{CssVarsProvider:A,useColorScheme:C,getInitColorSchemeScript:O=>NG(ye({attribute:r,colorSchemeStorageKey:l,defaultMode:u,defaultLightColorScheme:k,defaultDarkColorScheme:z,modeStorageKey:a},O))}}function JA(t=""){function e(...r){if(!r.length)return"";const a=r[0];return typeof a=="string"&&!a.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${a}${e(...r.slice(1))})`:`, ${a}`}return(r,...a)=>`var(--${t?`${t}-`:""}${r}${e(...a)})`}const qD=(t,e,n,r=[])=>{let a=t;e.forEach((l,u)=>{u===e.length-1?Array.isArray(a)?a[Number(l)]=n:a&&typeof a=="object"&&(a[l]=n):a&&typeof a=="object"&&(a[l]||(a[l]=r.includes(l)?[]:{}),a=a[l])})},HG=(t,e,n)=>{function r(a,l=[],u=[]){Object.entries(a).forEach(([s,m])=>{(!n||n&&!n([...l,s]))&&m!=null&&(typeof m=="object"&&Object.keys(m).length>0?r(m,[...l,s],Array.isArray(m)?[...u,s]:u):e([...l,s],m,u))})}r(t)},GG=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().indexOf("opacity")>=0?e:`${e}px`:e;function mM(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},a={},l={},u={};return HG(t,(s,m,_)=>{if((typeof m=="string"||typeof m=="number")&&(!r||!r(s,m))){const b=`--${n?`${n}-`:""}${s.join("-")}`;Object.assign(a,{[b]:GG(s,m)}),qD(l,s,`var(${b})`,_),qD(u,s,`var(${b}, ${m})`,_)}},s=>s[0]==="vars"),{css:a,vars:l,varsWithDefaults:u}}function q_(t){"@babel/helpers - typeof";return q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q_(t)}function WG(t,e){if(q_(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(q_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function qG(t){var e=WG(t,"string");return q_(e)=="symbol"?e:e+""}const XG=["colorSchemes","components","defaultColorScheme"];function ZG(t,e){const{colorSchemes:n={},defaultColorScheme:r="light"}=t,a=lr(t,XG),{vars:l,css:u,varsWithDefaults:s}=mM(a,e);let m=s;const _={},{[r]:b}=n,M=lr(n,[r].map(qG));if(Object.entries(M||{}).forEach(([A,k])=>{const{vars:z,css:P,varsWithDefaults:O}=mM(k,e);m=fc(m,O),_[A]={css:P,vars:z}}),b){const{css:A,vars:k,varsWithDefaults:z}=mM(b,e);m=fc(m,z),_[r]={css:A,vars:k}}return{vars:m,generateCssVars:A=>{var k;if(!A){var z;const O=ye({},u);return{css:O,vars:l,selector:(e==null||(z=e.getSelector)==null?void 0:z.call(e,A,O))||":root"}}const P=ye({},_[A].css);return{css:P,vars:_[A].vars,selector:(e==null||(k=e.getSelector)==null?void 0:k.call(e,A,P))||":root"}}}}const YG=["component","direction","spacing","divider","children","className","useFlexGap"],KG=GA(),JG=cG("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function QG(t){return _N({props:t,name:"MuiStack",defaultTheme:KG})}function eW(t,e){const n=q.Children.toArray(t).filter(Boolean);return n.reduce((r,a,l)=>(r.push(a),l<n.length-1&&r.push(q.cloneElement(e,{key:`separator-${l}`})),r),[])}const tW=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],nW=({ownerState:t,theme:e})=>{let n=ye({display:"flex",flexDirection:"column"},sh({theme:e},hM({values:t.direction,breakpoints:e.breakpoints.values}),r=>({flexDirection:r})));if(t.spacing){const r=jA(e),a=Object.keys(e.breakpoints.values).reduce((m,_)=>((typeof t.spacing=="object"&&t.spacing[_]!=null||typeof t.direction=="object"&&t.direction[_]!=null)&&(m[_]=!0),m),{}),l=hM({values:t.direction,base:a}),u=hM({values:t.spacing,base:a});typeof l=="object"&&Object.keys(l).forEach((m,_,b)=>{if(!l[m]){const C=_>0?l[b[_-1]]:"column";l[m]=C}}),n=fc(n,sh({theme:e},u,(m,_)=>t.useFlexGap?{gap:Pg(r,m)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${tW(_?l[_]:t.direction)}`]:Pg(r,m)}}))}return n=oH(e.breakpoints,n),n};function rW(t={}){const{createStyledComponent:e=JG,useThemeProps:n=QG,componentName:r="MuiStack"}=t,a=()=>$r({root:["root"]},m=>qA(r,m),{}),l=e(nW);return q.forwardRef(function(m,_){const b=n(m),M=mS(b),{component:C="div",direction:A="column",spacing:k=0,divider:z,children:P,className:O,useFlexGap:j=!1}=M,U=lr(M,YG),X={direction:A,spacing:k,useFlexGap:j},K=a();return ae.jsx(l,ye({as:C,ownerState:X,ref:_,className:yo(K.root,O)},U,{children:z?eW(P,z):P}))})}const iW=ye({},pS,{borderRadius:{themeKey:"radius"},boxShadow:{themeKey:"shadow"},fontFamily:{themeKey:"fontFamily"},fontSize:{themeKey:"fontSize"},fontWeight:{themeKey:"fontWeight"},letterSpacing:{themeKey:"letterSpacing"},lineHeight:{themeKey:"lineHeight"}});function oW(t){var e;return!!t[0].match(/^(typography|variants|breakpoints)$/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!((e=t[1])!=null&&e.match(/^(mode)$/))||t[0]==="focus"&&t[1]!=="thickness"}const Hr=(t,e)=>qA(t,e,"Mui"),Nr=(t,e)=>gN(t,e,"Mui"),sW=t=>t&&typeof t=="object"&&Object.keys(t).some(e=>{var n;return(n=e.match)==null?void 0:n.call(e,/^(plain(Hover|Active|Disabled)?(Color|Bg)|outlined(Hover|Active|Disabled)?(Color|Border|Bg)|soft(Hover|Active|Disabled)?(Color|Bg)|solid(Hover|Active|Disabled)?(Color|Bg))$/)}),XD=(t,e,n)=>{e.includes("Color")&&(t.color=n),e.includes("Bg")&&(t.backgroundColor=n),e.includes("Border")&&(t.borderColor=n)},ZD=(t,e,n)=>{const r={};return Object.entries(e||{}).forEach(([a,l])=>{if(a.match(new RegExp(`${t}(color|bg|border)`,"i"))&&l){const u=n?n(a):l;a.includes("Disabled")&&(r.pointerEvents="none",r.cursor="default",r["--Icon-color"]="currentColor"),a.match(/(Hover|Active|Disabled)/)||(r["--variant-borderWidth"]||(r["--variant-borderWidth"]="0px"),a.includes("Border")&&(r["--variant-borderWidth"]="1px",r.border="var(--variant-borderWidth) solid")),XD(r,a,u)}}),r},va=(t,e)=>{let n={};if(e){const{getCssVar:r,palette:a}=e;Object.entries(a).forEach(l=>{const[u,s]=l;sW(s)&&typeof s=="object"&&(n=ye({},n,{[u]:ZD(t,s,m=>`var(--variant-${m}, ${r(`palette-${u}-${m}`,a[u][m])})`)}))})}return n.context=ZD(t,{plainColor:"var(--variant-plainColor)",plainHoverColor:"var(--variant-plainHoverColor)",plainHoverBg:"var(--variant-plainHoverBg)",plainActiveBg:"var(--variant-plainActiveBg)",plainDisabledColor:"var(--variant-plainDisabledColor)",outlinedColor:"var(--variant-outlinedColor)",outlinedBorder:"var(--variant-outlinedBorder)",outlinedHoverColor:"var(--variant-outlinedHoverColor)",outlinedHoverBorder:"var(--variant-outlinedHoverBorder)",outlinedHoverBg:"var(--variant-outlinedHoverBg)",outlinedActiveBg:"var(--variant-outlinedActiveBg)",outlinedDisabledColor:"var(--variant-outlinedDisabledColor)",outlinedDisabledBorder:"var(--variant-outlinedDisabledBorder)",softColor:"var(--variant-softColor)",softBg:"var(--variant-softBg)",softHoverColor:"var(--variant-softHoverColor)",softHoverBg:"var(--variant-softHoverBg)",softActiveBg:"var(--variant-softActiveBg)",softDisabledColor:"var(--variant-softDisabledColor)",softDisabledBg:"var(--variant-softDisabledBg)",solidColor:"var(--variant-solidColor)",solidBg:"var(--variant-solidBg)",solidHoverBg:"var(--variant-solidHoverBg)",solidActiveBg:"var(--variant-solidActiveBg)",solidDisabledColor:"var(--variant-solidDisabledColor)",solidDisabledBg:"var(--variant-solidDisabledBg)"}),n},aW=["cssVarPrefix","breakpoints","spacing","components","variants","shouldSkipGeneratingVar"],lW=["colorSchemes"],cW=(t="joy")=>JA(t);function PN(t){var e,n,r,a,l,u,s,m,_,b;const M=t||{},{cssVarPrefix:C="joy",breakpoints:A,spacing:k,components:z,variants:P,shouldSkipGeneratingVar:O=oW}=M,j=lr(M,aW),U=cW(C),X={primary:O0.blue,neutral:O0.grey,danger:O0.red,success:O0.green,warning:O0.yellow,common:{white:"#FFF",black:"#000"}},K=et=>{var Mt;const Tt=et.split("-"),hn=Tt[1],en=Tt[2];return U(et,(Mt=X[hn])==null?void 0:Mt[en])},se=et=>({plainColor:K(`palette-${et}-500`),plainHoverBg:K(`palette-${et}-100`),plainActiveBg:K(`palette-${et}-200`),plainDisabledColor:K("palette-neutral-400"),outlinedColor:K(`palette-${et}-500`),outlinedBorder:K(`palette-${et}-300`),outlinedHoverBg:K(`palette-${et}-100`),outlinedActiveBg:K(`palette-${et}-200`),outlinedDisabledColor:K("palette-neutral-400"),outlinedDisabledBorder:K("palette-neutral-200"),softColor:K(`palette-${et}-700`),softBg:K(`palette-${et}-100`),softHoverBg:K(`palette-${et}-200`),softActiveColor:K(`palette-${et}-800`),softActiveBg:K(`palette-${et}-300`),softDisabledColor:K("palette-neutral-400"),softDisabledBg:K("palette-neutral-50"),solidColor:K("palette-common-white"),solidBg:K(`palette-${et}-500`),solidHoverBg:K(`palette-${et}-600`),solidActiveBg:K(`palette-${et}-700`),solidDisabledColor:K("palette-neutral-400"),solidDisabledBg:K("palette-neutral-100")}),J=et=>({plainColor:K(`palette-${et}-300`),plainHoverBg:K(`palette-${et}-800`),plainActiveBg:K(`palette-${et}-700`),plainDisabledColor:K("palette-neutral-500"),outlinedColor:K(`palette-${et}-200`),outlinedBorder:K(`palette-${et}-700`),outlinedHoverBg:K(`palette-${et}-800`),outlinedActiveBg:K(`palette-${et}-700`),outlinedDisabledColor:K("palette-neutral-500"),outlinedDisabledBorder:K("palette-neutral-800"),softColor:K(`palette-${et}-200`),softBg:K(`palette-${et}-800`),softHoverBg:K(`palette-${et}-700`),softActiveColor:K(`palette-${et}-100`),softActiveBg:K(`palette-${et}-600`),softDisabledColor:K("palette-neutral-500"),softDisabledBg:K("palette-neutral-800"),solidColor:K("palette-common-white"),solidBg:K(`palette-${et}-500`),solidHoverBg:K(`palette-${et}-600`),solidActiveBg:K(`palette-${et}-700`),solidDisabledColor:K("palette-neutral-500"),solidDisabledBg:K("palette-neutral-800")}),ue={palette:{mode:"light",primary:ye({},X.primary,se("primary")),neutral:ye({},X.neutral,se("neutral"),{plainColor:K("palette-neutral-700"),plainHoverColor:K("palette-neutral-900"),outlinedColor:K("palette-neutral-700")}),danger:ye({},X.danger,se("danger")),success:ye({},X.success,se("success")),warning:ye({},X.warning,se("warning")),common:{white:"#FFF",black:"#000"},text:{primary:K("palette-neutral-800"),secondary:K("palette-neutral-700"),tertiary:K("palette-neutral-600"),icon:K("palette-neutral-500")},background:{body:K("palette-common-white"),surface:K("palette-neutral-50"),popup:K("palette-common-white"),level1:K("palette-neutral-100"),level2:K("palette-neutral-200"),level3:K("palette-neutral-300"),tooltip:K("palette-neutral-500"),backdrop:`rgba(${U("palette-neutral-darkChannel",sg(X.neutral[900]))} / 0.25)`},divider:`rgba(${U("palette-neutral-mainChannel",sg(X.neutral[500]))} / 0.2)`,focusVisible:K("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"21 21 21",shadowOpacity:"0.08"},ne={palette:{mode:"dark",primary:ye({},X.primary,J("primary")),neutral:ye({},X.neutral,J("neutral"),{plainColor:K("palette-neutral-300"),plainHoverColor:K("palette-neutral-300")}),danger:ye({},X.danger,J("danger")),success:ye({},X.success,J("success")),warning:ye({},X.warning,J("warning")),common:{white:"#FFF",black:"#000"},text:{primary:K("palette-neutral-100"),secondary:K("palette-neutral-300"),tertiary:K("palette-neutral-400"),icon:K("palette-neutral-400")},background:{body:K("palette-common-black"),surface:K("palette-neutral-900"),popup:K("palette-common-black"),level1:K("palette-neutral-800"),level2:K("palette-neutral-700"),level3:K("palette-neutral-600"),tooltip:K("palette-neutral-600"),backdrop:`rgba(${U("palette-neutral-darkChannel",sg(X.neutral[50]))} / 0.25)`},divider:`rgba(${U("palette-neutral-mainChannel",sg(X.neutral[500]))} / 0.16)`,focusVisible:K("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"0 0 0",shadowOpacity:"0.6"},H='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',de=ye({body:`"Inter", ${U(`fontFamily-fallback, ${H}`)}`,display:`"Inter", ${U(`fontFamily-fallback, ${H}`)}`,code:"Source Code Pro,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace",fallback:H},j.fontFamily),Ee=ye({sm:300,md:500,lg:600,xl:700},j.fontWeight),Pe=ye({xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem",xl2:"1.5rem",xl3:"1.875rem",xl4:"2.25rem"},j.fontSize),Ze=ye({xs:"1.33334",sm:"1.42858",md:"1.5",lg:"1.55556",xl:"1.66667"},j.lineHeight),ke=(e=(n=j.colorSchemes)==null||(n=n.light)==null?void 0:n.shadowRing)!=null?e:ue.shadowRing,Te=(r=(a=j.colorSchemes)==null||(a=a.light)==null?void 0:a.shadowChannel)!=null?r:ue.shadowChannel,Ie=(l=(u=j.colorSchemes)==null||(u=u.light)==null?void 0:u.shadowOpacity)!=null?l:ue.shadowOpacity,Ce={colorSchemes:{light:ue,dark:ne},fontSize:Pe,fontFamily:de,fontWeight:Ee,focus:{thickness:"2px",selector:`&.${Hr("","focusVisible")}, &:focus-visible`,default:{outlineOffset:`var(--focus-outline-offset, ${U("focus-thickness",(s=(m=j.focus)==null?void 0:m.thickness)!=null?s:"2px")})`,outline:`${U("focus-thickness",(_=(b=j.focus)==null?void 0:b.thickness)!=null?_:"2px")} solid ${U("palette-focusVisible",X.primary[500])}`}},lineHeight:Ze,radius:{xs:"2px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},shadow:{xs:`${U("shadowRing",ke)}, 0px 1px 2px 0px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)})`,sm:`${U("shadowRing",ke)}, 0px 1px 2px 0px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)}), 0px 2px 4px 0px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)})`,md:`${U("shadowRing",ke)}, 0px 2px 8px -2px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)}), 0px 6px 12px -2px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)})`,lg:`${U("shadowRing",ke)}, 0px 2px 8px -2px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)}), 0px 12px 16px -4px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)})`,xl:`${U("shadowRing",ke)}, 0px 2px 8px -2px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)}), 0px 20px 24px -4px rgba(${U("shadowChannel",Te)} / ${U("shadowOpacity",Ie)})`},zIndex:{badge:1,table:10,popup:1e3,modal:1300,snackbar:1400,tooltip:1500},typography:{h1:{fontFamily:U(`fontFamily-display, ${de.display}`),fontWeight:U(`fontWeight-xl, ${Ee.xl}`),fontSize:U(`fontSize-xl4, ${Pe.xl4}`),lineHeight:U(`lineHeight-xs, ${Ze.xs}`),letterSpacing:"-0.025em",color:U(`palette-text-primary, ${ue.palette.text.primary}`)},h2:{fontFamily:U(`fontFamily-display, ${de.display}`),fontWeight:U(`fontWeight-xl, ${Ee.xl}`),fontSize:U(`fontSize-xl3, ${Pe.xl3}`),lineHeight:U(`lineHeight-xs, ${Ze.xs}`),letterSpacing:"-0.025em",color:U(`palette-text-primary, ${ue.palette.text.primary}`)},h3:{fontFamily:U(`fontFamily-display, ${de.display}`),fontWeight:U(`fontWeight-lg, ${Ee.lg}`),fontSize:U(`fontSize-xl2, ${Pe.xl2}`),lineHeight:U(`lineHeight-xs, ${Ze.xs}`),letterSpacing:"-0.025em",color:U(`palette-text-primary, ${ue.palette.text.primary}`)},h4:{fontFamily:U(`fontFamily-display, ${de.display}`),fontWeight:U(`fontWeight-lg, ${Ee.lg}`),fontSize:U(`fontSize-xl, ${Pe.xl}`),lineHeight:U(`lineHeight-md, ${Ze.md}`),letterSpacing:"-0.025em",color:U(`palette-text-primary, ${ue.palette.text.primary}`)},"title-lg":{fontFamily:U(`fontFamily-body, ${de.body}`),fontWeight:U(`fontWeight-lg, ${Ee.lg}`),fontSize:U(`fontSize-lg, ${Pe.lg}`),lineHeight:U(`lineHeight-xs, ${Ze.xs}`),color:U(`palette-text-primary, ${ue.palette.text.primary}`)},"title-md":{fontFamily:U(`fontFamily-body, ${de.body}`),fontWeight:U(`fontWeight-md, ${Ee.md}`),fontSize:U(`fontSize-md, ${Pe.md}`),lineHeight:U(`lineHeight-md, ${Ze.md}`),color:U(`palette-text-primary, ${ue.palette.text.primary}`)},"title-sm":{fontFamily:U(`fontFamily-body, ${de.body}`),fontWeight:U(`fontWeight-md, ${Ee.md}`),fontSize:U(`fontSize-sm, ${Pe.sm}`),lineHeight:U(`lineHeight-sm, ${Ze.sm}`),color:U(`palette-text-primary, ${ue.palette.text.primary}`)},"body-lg":{fontFamily:U(`fontFamily-body, ${de.body}`),fontSize:U(`fontSize-lg, ${Pe.lg}`),lineHeight:U(`lineHeight-md, ${Ze.md}`),color:U(`palette-text-secondary, ${ue.palette.text.secondary}`)},"body-md":{fontFamily:U(`fontFamily-body, ${de.body}`),fontSize:U(`fontSize-md, ${Pe.md}`),lineHeight:U(`lineHeight-md, ${Ze.md}`),color:U(`palette-text-secondary, ${ue.palette.text.secondary}`)},"body-sm":{fontFamily:U(`fontFamily-body, ${de.body}`),fontSize:U(`fontSize-sm, ${Pe.sm}`),lineHeight:U(`lineHeight-md, ${Ze.md}`),color:U(`palette-text-tertiary, ${ue.palette.text.tertiary}`)},"body-xs":{fontFamily:U(`fontFamily-body, ${de.body}`),fontWeight:U(`fontWeight-md, ${Ee.md}`),fontSize:U(`fontSize-xs, ${Pe.xs}`),lineHeight:U(`lineHeight-md, ${Ze.md}`),color:U(`palette-text-tertiary, ${ue.palette.text.tertiary}`)}}},Ue=j?fc(Ce,j):Ce,{colorSchemes:nt}=Ue,Le=lr(Ue,lW),lt=ye({colorSchemes:nt},Le,{breakpoints:sN(A??{}),components:fc({MuiSvgIcon:{defaultProps:{fontSize:"xl2"},styleOverrides:{root:({ownerState:et,theme:Mt})=>{var Tt;const hn=et.instanceFontSize;return ye({margin:"var(--Icon-margin)"},et.fontSize&&et.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${Mt.vars.fontSize[et.fontSize]})`},!et.htmlColor&&ye({color:`var(--Icon-color, ${lt.vars.palette.text.icon})`},et.color&&et.color!=="inherit"&&Mt.vars.palette[et.color]&&{color:`rgba(${(Tt=Mt.vars.palette[et.color])==null?void 0:Tt.mainChannel} / 1)`}),hn&&hn!=="inherit"&&{"--Icon-fontSize":Mt.vars.fontSize[hn]})}}}},z),cssVarPrefix:C,getCssVar:U,spacing:uN(k)});function Ht(et,Mt){Object.keys(Mt).forEach(Tt=>{const hn={main:"500",light:"200",dark:"700"};et==="dark"&&(hn.main=400),!Mt[Tt].mainChannel&&Mt[Tt][hn.main]&&(Mt[Tt].mainChannel=sg(Mt[Tt][hn.main])),!Mt[Tt].lightChannel&&Mt[Tt][hn.light]&&(Mt[Tt].lightChannel=sg(Mt[Tt][hn.light])),!Mt[Tt].darkChannel&&Mt[Tt][hn.dark]&&(Mt[Tt].darkChannel=sg(Mt[Tt][hn.dark]))})}Object.entries(lt.colorSchemes).forEach(([et,Mt])=>{Ht(et,Mt.palette)});const He={prefix:C,shouldSkipGeneratingVar:O},{vars:pt,generateCssVars:_t}=ZG(ye({colorSchemes:nt},Le),He);lt.vars=pt,lt.generateCssVars=_t,lt.unstable_sxConfig=ye({},iW,t?.unstable_sxConfig),lt.unstable_sx=function(Mt){return yx({sx:Mt,theme:this})},lt.getColorSchemeSelector=et=>et==="light"?"&":`&[data-joy-color-scheme="${et}"], [data-joy-color-scheme="${et}"] &`;const ot={getCssVar:U,palette:lt.colorSchemes.light.palette};return lt.variants=fc({plain:va("plain",ot),plainHover:va("plainHover",ot),plainActive:va("plainActive",ot),plainDisabled:va("plainDisabled",ot),outlined:va("outlined",ot),outlinedHover:va("outlinedHover",ot),outlinedActive:va("outlinedActive",ot),outlinedDisabled:va("outlinedDisabled",ot),soft:va("soft",ot),softHover:va("softHover",ot),softActive:va("softActive",ot),softDisabled:va("softDisabled",ot),solid:va("solid",ot),solidHover:va("solidHover",ot),solidActive:va("solidActive",ot),solidDisabled:va("solidDisabled",ot)},P),lt.palette=ye({},lt.colorSchemes.light.palette,{colorScheme:"light"}),lt.shouldSkipGeneratingVar=O,lt.applyStyles=hN,lt}const Xy=PN(),N0={attribute:"data-joy-color-scheme",colorSchemeStorageKey:"joy-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"joy-mode"},{CssVarsProvider:uW,useColorScheme:xS}=jG({themeId:fx,theme:Xy,attribute:N0.attribute,modeStorageKey:N0.modeStorageKey,colorSchemeStorageKey:N0.colorSchemeStorageKey,defaultColorScheme:{light:N0.defaultLightColorScheme,dark:N0.defaultDarkColorScheme}}),vn=vN({defaultTheme:Xy,themeId:fx});function Gr({props:t,name:e}){return _N({props:t,name:e,defaultTheme:ye({},Xy,{components:{}}),themeId:fx})}function hW(t){return ae.jsx(ZH,ye({},t,{defaultTheme:Xy,themeId:fx}))}function YD(t,e,n=(r,a)=>r===a){return t.length===e.length&&t.every((r,a)=>n(r,e[a]))}const dW={disableDefaultClasses:!1},fW=q.createContext(dW);function pW(t){const{disableDefaultClasses:e}=q.useContext(fW);return n=>e?"":t(n)}function mW(t){const{rootElementName:e=""}=t,[n,r]=q.useState(e.toUpperCase()),a=q.useCallback(l=>{var u;r((u=l?.tagName)!=null?u:"")},[]);return[n,a]}const AN="base";function gW(t){return`${AN}--${t}`}function vW(t,e){return`${AN}-${t}-${e}`}function yW(t,e){const n=mN[e];return n?gW(n):vW(t,e)}function hd(t={}){const{disabled:e=!1,focusableWhenDisabled:n,href:r,rootRef:a,tabIndex:l,to:u,type:s,rootElementName:m}=t,_=q.useRef(null),[b,M]=q.useState(!1),{isFocusVisibleRef:C,onFocus:A,onBlur:k,ref:z}=yS(),[P,O]=q.useState(!1);e&&!n&&P&&O(!1),q.useEffect(()=>{C.current=P},[P,C]);const[j,U]=mW({rootElementName:m??(r||u?"a":void 0)}),X=ke=>Te=>{var Ie;P&&Te.preventDefault(),(Ie=ke.onMouseLeave)==null||Ie.call(ke,Te)},K=ke=>Te=>{var Ie;k(Te),C.current===!1&&O(!1),(Ie=ke.onBlur)==null||Ie.call(ke,Te)},se=ke=>Te=>{var Ie;if(_.current||(_.current=Te.currentTarget),A(Te),C.current===!0){var Ce;O(!0),(Ce=ke.onFocusVisible)==null||Ce.call(ke,Te)}(Ie=ke.onFocus)==null||Ie.call(ke,Te)},J=()=>{const ke=_.current;return j==="BUTTON"||j==="INPUT"&&["button","submit","reset"].includes(ke?.type)||j==="A"&&ke?.href},ue=ke=>Te=>{if(!e){var Ie;(Ie=ke.onClick)==null||Ie.call(ke,Te)}},ne=ke=>Te=>{var Ie;e||(M(!0),document.addEventListener("mouseup",()=>{M(!1)},{once:!0})),(Ie=ke.onMouseDown)==null||Ie.call(ke,Te)},H=ke=>Te=>{var Ie;if((Ie=ke.onKeyDown)==null||Ie.call(ke,Te),!Te.defaultMuiPrevented&&(Te.target===Te.currentTarget&&!J()&&Te.key===" "&&Te.preventDefault(),Te.target===Te.currentTarget&&Te.key===" "&&!e&&M(!0),Te.target===Te.currentTarget&&!J()&&Te.key==="Enter"&&!e)){var Ce;(Ce=ke.onClick)==null||Ce.call(ke,Te),Te.preventDefault()}},de=ke=>Te=>{var Ie;if(Te.target===Te.currentTarget&&M(!1),(Ie=ke.onKeyUp)==null||Ie.call(ke,Te),Te.target===Te.currentTarget&&!J()&&!e&&Te.key===" "&&!Te.defaultMuiPrevented){var Ce;(Ce=ke.onClick)==null||Ce.call(ke,Te)}},Ee=pi(U,a,z,_),Pe={};return l!==void 0&&(Pe.tabIndex=l),j==="BUTTON"?(Pe.type=s??"button",n?Pe["aria-disabled"]=e:Pe.disabled=e):j==="INPUT"?s&&["button","submit","reset"].includes(s)&&(n?Pe["aria-disabled"]=e:Pe.disabled=e):j!==""&&(!r&&!u&&(Pe.role="button",Pe.tabIndex=l??0),e&&(Pe["aria-disabled"]=e,Pe.tabIndex=n?l??0:-1)),{getRootProps:(ke={})=>{const Te=ye({},gs(t),gs(ke)),Ie=ye({type:s},Te,Pe,ke,{onBlur:K(Te),onClick:ue(Te),onFocus:se(Te),onKeyDown:H(Te),onKeyUp:de(Te),onMouseDown:ne(Te),onMouseLeave:X(Te),ref:Ee});return delete Ie.onFocusVisible,Ie},focusVisible:P,setFocusVisible:O,active:b,rootRef:Ee}}function KD(t){return t.substring(2).toLowerCase()}function _W(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function xW(t){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:a,touchEvent:l="onTouchEnd"}=t,u=q.useRef(!1),s=q.useRef(null),m=q.useRef(!1),_=q.useRef(!1);q.useEffect(()=>(setTimeout(()=>{m.current=!0},0),()=>{m.current=!1}),[]);const b=pi(_S(e),s),M=nh(k=>{const z=_.current;_.current=!1;const P=pc(s.current);if(!m.current||!s.current||"clientX"in k&&_W(k,P))return;if(u.current){u.current=!1;return}let O;k.composedPath?O=k.composedPath().indexOf(s.current)>-1:O=!P.documentElement.contains(k.target)||s.current.contains(k.target),!O&&(n||!z)&&a(k)}),C=k=>z=>{_.current=!0;const P=e.props[k];P&&P(z)},A={ref:b};return l!==!1&&(A[l]=C(l)),q.useEffect(()=>{if(l!==!1){const k=KD(l),z=pc(s.current),P=()=>{u.current=!0};return z.addEventListener(k,M),z.addEventListener("touchmove",P),()=>{z.removeEventListener(k,M),z.removeEventListener("touchmove",P)}}},[M,l]),r!==!1&&(A[r]=C(r)),q.useEffect(()=>{if(r!==!1){const k=KD(r),z=pc(s.current);return z.addEventListener(k,M),()=>{z.removeEventListener(k,M)}}},[M,r]),ae.jsx(q.Fragment,{children:q.cloneElement(e,A)})}const bS=q.createContext(null);function bW(t,e){return t===e}const gM={},JD=()=>{};function ZT(t,e){const n=ye({},t);return Object.keys(e).forEach(r=>{e[r]!==void 0&&(n[r]=e[r])}),n}function wW(t){const{nextState:e,initialState:n,stateComparers:r,onStateChange:a,controlledProps:l,lastActionRef:u}=t,s=q.useRef(n);q.useEffect(()=>{if(u.current===null)return;const m=ZT(s.current,l);Object.keys(e).forEach(_=>{var b;const M=(b=r[_])!=null?b:bW,C=e[_],A=m[_];if(A==null&&C!=null||A!=null&&C==null||A!=null&&C!=null&&!M(C,A)){var k,z;a?.((k=u.current.event)!=null?k:null,_,C,(z=u.current.type)!=null?z:"",e)}}),s.current=e,u.current=null},[s,e,u,a,r,l])}function IN(t){const e=q.useRef(null),{reducer:n,initialState:r,controlledProps:a=gM,stateComparers:l=gM,onStateChange:u=JD,actionContext:s,componentName:m=""}=t;q.useRef(a);const _=q.useCallback((A,k)=>{e.current=k;const z=ZT(A,a);return n(z,k)},[a,n]),[b,M]=q.useReducer(_,r),C=q.useCallback(A=>{M(ye({},A,{context:s}))},[s]);return wW({nextState:b,initialState:r,stateComparers:l??gM,onStateChange:u??JD,controlledProps:a,lastActionRef:e}),[ZT(b,a),C]}const eh={blur:"dropdown:blur",escapeKeyDown:"dropdown:escapeKeyDown",toggle:"dropdown:toggle",open:"dropdown:open",close:"dropdown:close"};function SW(t,e){switch(e.type){case eh.blur:return{open:!1,changeReason:e.event};case eh.escapeKeyDown:return{open:!1,changeReason:e.event};case eh.toggle:return{open:!t.open,changeReason:e.event};case eh.open:return{open:!0,changeReason:e.event};case eh.close:return{open:!1,changeReason:e.event};default:throw new Error("Unhandled action")}}function MW(t={}){const{defaultOpen:e,onOpenChange:n,open:r,componentName:a="useDropdown"}=t,[l,u]=q.useState(""),[s,m]=q.useState(null),_=q.useRef(null),b=q.useCallback((z,P,O,j)=>{P==="open"&&n?.(z,O),_.current=j},[n]),M=q.useMemo(()=>r!==void 0?{open:r}:{},[r]),[C,A]=IN({controlledProps:M,initialState:e?{open:!0,changeReason:null}:{open:!1,changeReason:null},onStateChange:b,reducer:SW,componentName:a});return q.useEffect(()=>{!C.open&&_.current!==null&&_.current!==eh.blur&&s?.focus()},[C.open,s]),{contextValue:{state:C,dispatch:A,popupId:l,registerPopup:u,registerTrigger:m,triggerElement:s},open:C.open}}function EW(t){const{children:e,open:n,defaultOpen:r,onOpenChange:a}=t,{contextValue:l}=MW({defaultOpen:r,onOpenChange:a,open:n});return ae.jsx(bS.Provider,{value:l,children:e})}const CW=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function TW(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function PW(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function AW(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||PW(t))}function IW(t){const e=[],n=[];return Array.from(t.querySelectorAll(CW)).forEach((r,a)=>{const l=TW(r);l===-1||!AW(r)||(l===0?e.push(r):n.push({documentOrder:a,tabIndex:l,node:r}))}),n.sort((r,a)=>r.tabIndex===a.tabIndex?r.documentOrder-a.documentOrder:r.tabIndex-a.tabIndex).map(r=>r.node).concat(e)}function RW(){return!0}function DW(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:a=!1,getTabbable:l=IW,isEnabled:u=RW,open:s}=t,m=q.useRef(!1),_=q.useRef(null),b=q.useRef(null),M=q.useRef(null),C=q.useRef(null),A=q.useRef(!1),k=q.useRef(null),z=pi(_S(e),k),P=q.useRef(null);q.useEffect(()=>{!s||!k.current||(A.current=!n)},[n,s]),q.useEffect(()=>{if(!s||!k.current)return;const U=pc(k.current);return k.current.contains(U.activeElement)||(k.current.hasAttribute("tabIndex")||k.current.setAttribute("tabIndex","-1"),A.current&&k.current.focus()),()=>{a||(M.current&&M.current.focus&&(m.current=!0,M.current.focus()),M.current=null)}},[s]),q.useEffect(()=>{if(!s||!k.current)return;const U=pc(k.current),X=J=>{P.current=J,!(r||!u()||J.key!=="Tab")&&U.activeElement===k.current&&J.shiftKey&&(m.current=!0,b.current&&b.current.focus())},K=()=>{const J=k.current;if(J===null)return;if(!U.hasFocus()||!u()||m.current){m.current=!1;return}if(J.contains(U.activeElement)||r&&U.activeElement!==_.current&&U.activeElement!==b.current)return;if(U.activeElement!==C.current)C.current=null;else if(C.current!==null)return;if(!A.current)return;let ue=[];if((U.activeElement===_.current||U.activeElement===b.current)&&(ue=l(k.current)),ue.length>0){var ne,H;const de=!!((ne=P.current)!=null&&ne.shiftKey&&((H=P.current)==null?void 0:H.key)==="Tab"),Ee=ue[0],Pe=ue[ue.length-1];typeof Ee!="string"&&typeof Pe!="string"&&(de?Pe.focus():Ee.focus())}else J.focus()};U.addEventListener("focusin",K),U.addEventListener("keydown",X,!0);const se=setInterval(()=>{U.activeElement&&U.activeElement.tagName==="BODY"&&K()},50);return()=>{clearInterval(se),U.removeEventListener("focusin",K),U.removeEventListener("keydown",X,!0)}},[n,r,a,u,s,l]);const O=U=>{M.current===null&&(M.current=U.relatedTarget),A.current=!0,C.current=U.target;const X=e.props.onFocus;X&&X(U)},j=U=>{M.current===null&&(M.current=U.relatedTarget),A.current=!0};return ae.jsxs(q.Fragment,{children:[ae.jsx("div",{tabIndex:s?0:-1,onFocus:j,ref:_,"data-testid":"sentinelStart"}),q.cloneElement(e,{ref:z,onFocus:O}),ae.jsx("div",{tabIndex:s?0:-1,onFocus:j,ref:b,"data-testid":"sentinelEnd"})]})}const LW=q.createContext(void 0);function kW(){return q.useContext(LW)}function zW(t={}){const{defaultValue:e,disabled:n=!1,error:r=!1,onBlur:a,onChange:l,onFocus:u,required:s=!1,value:m,inputRef:_}=t,b=kW();let M,C,A,k,z;if(b){var P,O,j;M=void 0,C=(P=b.disabled)!=null?P:!1,A=(O=b.error)!=null?O:!1,k=(j=b.required)!=null?j:!1,z=b.value}else M=e,C=n,A=r,k=s,z=m;const{current:U}=q.useRef(z!=null),X=q.useCallback(ke=>{},[]),K=q.useRef(null),se=pi(K,_,X),[J,ue]=q.useState(!1);q.useEffect(()=>{!b&&C&&J&&(ue(!1),a?.())},[b,C,J,a]);const ne=ke=>Te=>{var Ie;if(b!=null&&b.disabled){Te.stopPropagation();return}if((Ie=ke.onFocus)==null||Ie.call(ke,Te),b&&b.onFocus){var Ce;b==null||(Ce=b.onFocus)==null||Ce.call(b)}else ue(!0)},H=ke=>Te=>{var Ie;(Ie=ke.onBlur)==null||Ie.call(ke,Te),b&&b.onBlur?b.onBlur():ue(!1)},de=ke=>(Te,...Ie)=>{var Ce,Ue;if(!U&&(Te.target||K.current)==null)throw new Error(j_(17));b==null||(Ce=b.onChange)==null||Ce.call(b,Te),(Ue=ke.onChange)==null||Ue.call(ke,Te,...Ie)},Ee=ke=>Te=>{var Ie;K.current&&Te.currentTarget===Te.target&&K.current.focus(),(Ie=ke.onClick)==null||Ie.call(ke,Te)};return{disabled:C,error:A,focused:J,formControlContext:b,getInputProps:(ke={})=>{const Ie=ye({},{onBlur:a,onChange:l,onFocus:u},gs(ke)),Ce=ye({},Ie,{onBlur:H(Ie),onChange:de(Ie),onFocus:ne(Ie)});return ye({},Ce,{"aria-invalid":A||void 0,defaultValue:M,value:z,required:k,disabled:C},ke,{ref:se},Ce)},getRootProps:(ke={})=>{const Te=gs(t,["onBlur","onChange","onFocus"]),Ie=ye({},Te,gs(ke));return ye({},ke,Ie,{onClick:Ee(Ie)})},inputRef:se,required:k,value:z}}const Ni={blur:"list:blur",itemClick:"list:itemClick",itemHover:"list:itemHover",itemsChange:"list:itemsChange",keyDown:"list:keyDown",resetHighlight:"list:resetHighlight",highlightLast:"list:highlightLast",textNavigation:"list:textNavigation",clearSelection:"list:clearSelection"};function OW(t,e,n,r,a,l){if(n.length===0||!r&&n.every((s,m)=>a(s,m)))return-1;let u=t;for(;;){if(!l&&e==="next"&&u===n.length||!l&&e==="previous"&&u===-1)return-1;if(r?!1:a(n[u],u))u+=e==="next"?1:-1,l&&(u=(u+n.length)%n.length);else return u}}function zs(t,e,n){var r;const{items:a,isItemDisabled:l,disableListWrap:u,disabledItemsFocusable:s,itemComparer:m,focusManagement:_}=n,b=_==="DOM"?0:-1,M=a.length-1,C=t==null?-1:a.findIndex(O=>m(O,t));let A,k,z=!u;switch(e){case"reset":if(b===-1)return null;A=0,k="next",z=!1;break;case"start":A=0,k="next",z=!1;break;case"end":A=M,k="previous",z=!1;break;default:{const O=C+e;O<0?!z&&C!==-1||Math.abs(e)>1?(A=0,k="next"):(A=M,k="previous"):O>M?!z||Math.abs(e)>1?(A=M,k="previous"):(A=0,k="next"):(A=O,k=e>=0?"next":"previous")}}const P=OW(A,k,a,s,l,z);return P===-1&&t!==null&&!l(t,C)?t:(r=a[P])!=null?r:null}function FW(t,e,n,r){return n==="none"?[]:n==="single"?r(e[0],t)?e:[t]:e.some(a=>r(a,t))?e.filter(a=>!r(a,t)):[...e,t]}function QA(t,e,n){const{itemComparer:r,isItemDisabled:a,selectionMode:l,items:u}=n,{selectedValues:s}=e,m=u.findIndex(b=>r(t,b));if(a(t,m))return e;const _=FW(t,s,l,r);return ye({},e,{selectedValues:_,highlightedValue:t})}function NW(t,e,n){const r=e.highlightedValue,{orientation:a,pageSize:l}=n;switch(t){case"Home":return ye({},e,{highlightedValue:zs(r,"start",n)});case"End":return ye({},e,{highlightedValue:zs(r,"end",n)});case"PageUp":return ye({},e,{highlightedValue:zs(r,-l,n)});case"PageDown":return ye({},e,{highlightedValue:zs(r,l,n)});case"ArrowUp":if(a!=="vertical")break;return ye({},e,{highlightedValue:zs(r,-1,n)});case"ArrowDown":if(a!=="vertical")break;return ye({},e,{highlightedValue:zs(r,1,n)});case"ArrowLeft":{if(a==="vertical")break;return ye({},e,{highlightedValue:zs(r,a==="horizontal-ltr"?-1:1,n)})}case"ArrowRight":{if(a==="vertical")break;return ye({},e,{highlightedValue:zs(r,a==="horizontal-ltr"?1:-1,n)})}case"Enter":case" ":return e.highlightedValue===null?e:QA(e.highlightedValue,e,n)}return e}function BW(t,e){return e.focusManagement==="DOM"?t:ye({},t,{highlightedValue:null})}function UW(t,e,n){var r;const a=(r=n(t))==null?void 0:r.trim().toLowerCase();return!a||a.length===0?!1:a.indexOf(e)===0}function $W(t,e,n){const{items:r,isItemDisabled:a,disabledItemsFocusable:l,getItemAsString:u}=n,s=e.length>1;let m=s?t.highlightedValue:zs(t.highlightedValue,1,n);for(let _=0;_<r.length;_+=1){if(!m||!s&&t.highlightedValue===m)return t;if(UW(m,e,u)&&(!a(m,r.indexOf(m))||l))return ye({},t,{highlightedValue:m});m=zs(m,1,n)}return t}function VW(t,e,n,r){var a;const{itemComparer:l,focusManagement:u}=r;let s=null;if(n.highlightedValue!=null){var m;s=(m=t.find(M=>l(M,n.highlightedValue)))!=null?m:null}else u==="DOM"&&e.length===0&&(s=zs(null,"reset",r));const b=((a=n.selectedValues)!=null?a:[]).filter(M=>t.some(C=>l(C,M)));return ye({},n,{highlightedValue:s,selectedValues:b})}function jW(t,e){return ye({},t,{highlightedValue:zs(null,"reset",e)})}function HW(t,e){return ye({},t,{highlightedValue:zs(null,"end",e)})}function GW(t,e){return ye({},t,{selectedValues:[],highlightedValue:zs(null,"reset",e)})}function wS(t,e){const{type:n,context:r}=e;switch(n){case Ni.keyDown:return NW(e.key,t,r);case Ni.itemClick:return QA(e.item,t,r);case Ni.blur:return BW(t,r);case Ni.textNavigation:return $W(t,e.searchString,r);case Ni.itemsChange:return VW(e.items,e.previousItems,t,r);case Ni.resetHighlight:return jW(t,r);case Ni.highlightLast:return HW(t,r);case Ni.clearSelection:return GW(t,r);default:return t}}const WW=500;function qW(t){const e=q.useRef({searchString:"",lastTime:null});return q.useCallback(n=>{if(n.key.length===1&&n.key!==" "){const r=e.current,a=n.key.toLowerCase(),l=performance.now();r.searchString.length>0&&r.lastTime&&l-r.lastTime>WW?r.searchString=a:(r.searchString.length!==1||a!==r.searchString)&&(r.searchString+=a),r.lastTime=l,t(r.searchString,n)}},[t])}const QD={},XW=()=>{},ZW=(t,e)=>t===e,YW=()=>!1,KW=t=>typeof t=="string"?t:String(t),JW=()=>({highlightedValue:null,selectedValues:[]});function eI(t){const{controlledProps:e=QD,disabledItemsFocusable:n=!1,disableListWrap:r=!1,focusManagement:a="activeDescendant",getInitialState:l=JW,getItemDomElement:u,getItemId:s,isItemDisabled:m=YW,rootRef:_,onStateChange:b=XW,items:M,itemComparer:C=ZW,getItemAsString:A=KW,onChange:k,onHighlightChange:z,onItemsChange:P,orientation:O="vertical",pageSize:j=5,reducerActionContext:U=QD,selectionMode:X="single",stateReducer:K,componentName:se="useList"}=t,J=q.useRef(null),ue=pi(_,J),ne=q.useCallback((ot,et,Mt)=>{if(z?.(ot,et,Mt),a==="DOM"&&et!=null&&(Mt===Ni.itemClick||Mt===Ni.keyDown||Mt===Ni.textNavigation)){var Tt;u==null||(Tt=u(et))==null||Tt.focus()}},[u,z,a]),H=q.useMemo(()=>({highlightedValue:C,selectedValues:(ot,et)=>YD(ot,et,C)}),[C]),de=q.useCallback((ot,et,Mt,Tt,hn)=>{switch(b?.(ot,et,Mt,Tt,hn),et){case"highlightedValue":ne(ot,Mt,Tt);break;case"selectedValues":k?.(ot,Mt,Tt);break}},[ne,k,b]),Ee=q.useMemo(()=>({disabledItemsFocusable:n,disableListWrap:r,focusManagement:a,isItemDisabled:m,itemComparer:C,items:M,getItemAsString:A,onHighlightChange:ne,orientation:O,pageSize:j,selectionMode:X,stateComparers:H}),[n,r,a,m,C,M,A,ne,O,j,X,H]),Pe=l(),Ze=K??wS,ke=q.useMemo(()=>ye({},U,Ee),[U,Ee]),[Te,Ie]=IN({reducer:Ze,actionContext:ke,initialState:Pe,controlledProps:e,stateComparers:H,onStateChange:de,componentName:se}),{highlightedValue:Ce,selectedValues:Ue}=Te,nt=qW((ot,et)=>Ie({type:Ni.textNavigation,event:et,searchString:ot})),Le=q.useRef([]);q.useEffect(()=>{YD(Le.current,M,C)||(Ie({type:Ni.itemsChange,event:null,items:M,previousItems:Le.current}),Le.current=M,P?.(M))},[M,C,Ie,P]);const lt=ot=>et=>{var Mt;if((Mt=ot.onKeyDown)==null||Mt.call(ot,et),et.defaultMuiPrevented)return;const Tt=["Home","End","PageUp","PageDown"];O==="vertical"?Tt.push("ArrowUp","ArrowDown"):Tt.push("ArrowLeft","ArrowRight"),a==="activeDescendant"&&Tt.push(" ","Enter"),Tt.includes(et.key)&&et.preventDefault(),Ie({type:Ni.keyDown,key:et.key,event:et}),nt(et)},Ht=ot=>et=>{var Mt,Tt;(Mt=ot.onBlur)==null||Mt.call(ot,et),!et.defaultMuiPrevented&&((Tt=J.current)!=null&&Tt.contains(et.relatedTarget)||Ie({type:Ni.blur,event:et}))},He=(ot={})=>{const et=gs(ot);return ye({},ot,{"aria-activedescendant":a==="activeDescendant"&&Ce!=null?s(Ce):void 0,tabIndex:a==="DOM"?-1:0,ref:ue},et,{onBlur:Ht(et),onKeyDown:lt(et)})},pt=q.useCallback(ot=>{const et=(Ue??[]).some(hn=>hn!=null&&C(ot,hn)),Mt=Ce!=null&&C(ot,Ce);return{focusable:a==="DOM",highlighted:Mt,selected:et}},[C,Ue,Ce,a]),_t=q.useMemo(()=>({dispatch:Ie,getItemState:pt}),[Ie,pt]);return q.useDebugValue({state:Te}),{contextValue:_t,dispatch:Ie,getRootProps:He,rootRef:ue,state:Te}}const om=q.createContext(null);function tI(t){const{handlePointerOverEvents:e=!1,item:n}=t,r=q.useContext(om);if(!r)throw new Error("useListItem must be used within a ListProvider");const{dispatch:a,getItemState:l}=r,{highlighted:u,selected:s,focusable:m}=l(n),_=q.useCallback(A=>k=>{var z;(z=A.onClick)==null||z.call(A,k),!k.defaultPrevented&&a({type:Ni.itemClick,item:n,event:k})},[a,n]),b=q.useCallback(A=>k=>{var z;(z=A.onMouseOver)==null||z.call(A,k),!k.defaultPrevented&&a({type:Ni.itemHover,item:n,event:k})},[a,n]);let M;return m&&(M=u?0:-1),{getRootProps:(A={})=>{const k=gs(A);return ye({},A,{onClick:_(k),onPointerOver:e?b(k):void 0,tabIndex:M})},highlighted:u,selected:s}}function QW(t,e){if(e.type===Ni.itemHover)return ye({},t,{highlightedValue:e.item});const n=wS(t,e);if(n.highlightedValue===null&&e.context.items.length>0)return ye({},n,{highlightedValue:e.context.items[0]});if(e.type===Ni.keyDown&&e.event.key==="Escape")return ye({},n,{open:!1});if(e.type===Ni.blur){var r;if(!((r=e.context.listboxRef.current)!=null&&r.contains(e.event.relatedTarget))){var a,l;const u=(a=e.context.listboxRef.current)==null?void 0:a.getAttribute("id"),s=(l=e.event.relatedTarget)==null?void 0:l.getAttribute("aria-controls");return u&&s&&u===s?n:ye({},n,{open:!1,highlightedValue:e.context.items[0]})}}return n}const xx=q.createContext(null);function eq(t){const e=Array.from(t.keys()).map(n=>{const r=t.get(n);return{key:n,subitem:r}});return e.sort((n,r)=>{const a=n.subitem.ref.current,l=r.subitem.ref.current;return a===null||l===null||a===l?0:a.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_PRECEDING?1:-1}),new Map(e.map(n=>[n.key,n.subitem]))}function SS(){const[t,e]=q.useState(new Map),n=q.useRef(new Set),r=q.useCallback(function(_){n.current.delete(_),e(b=>{const M=new Map(b);return M.delete(_),M})},[]),a=q.useCallback(function(_,b){let M;return typeof _=="function"?M=_(n.current):M=_,n.current.add(M),e(C=>{const A=new Map(C);return A.set(M,b),A}),{id:M,deregister:()=>r(M)}},[r]),l=q.useMemo(()=>eq(t),[t]),u=q.useCallback(function(_){return Array.from(l.keys()).indexOf(_)},[l]);return{contextValue:q.useMemo(()=>({getItemIndex:u,registerItem:a,totalSubitemCount:t.size}),[u,a,t.size]),subitems:l}}function MS(t,e){const n=q.useContext(xx);if(n===null)throw new Error("useCompoundItem must be used within a useCompoundParent");const{registerItem:r}=n,[a,l]=q.useState(typeof t=="function"?void 0:t);return df(()=>{const{id:u,deregister:s}=r(t,e);return l(u),s},[r,e,t]),{id:a,index:a!==void 0?n.getItemIndex(a):-1,totalItemCount:n.totalSubitemCount}}function ff(t,e){return function(r={}){const a=ye({},r,t(r));return ye({},a,e(a))}}const tq={dispatch:()=>{},registerPopup:()=>{},state:{open:!0,changeReason:null},triggerElement:null};function nq(t={}){var e,n;const{listboxRef:r,onItemsChange:a,id:l,disabledItemsFocusable:u=!0,disableListWrap:s=!1,autoFocus:m=!0,componentName:_="useMenu"}=t,b=q.useRef(null),M=pi(b,r),C=(e=Pl(l))!=null?e:"",{state:{open:A,changeReason:k},dispatch:z,triggerElement:P,registerPopup:O}=(n=q.useContext(bS))!=null?n:tq,j=q.useRef(A),{subitems:U,contextValue:X}=SS(),K=q.useMemo(()=>Array.from(U.keys()),[U]),se=q.useCallback(Ue=>{var nt,Le;return Ue==null?null:(nt=(Le=U.get(Ue))==null?void 0:Le.ref.current)!=null?nt:null},[U]),J=q.useCallback(Ue=>{var nt;return(U==null||(nt=U.get(Ue))==null?void 0:nt.disabled)||!1},[U]),ue=q.useCallback(Ue=>{var nt,Le;return((nt=U.get(Ue))==null?void 0:nt.label)||((Le=U.get(Ue))==null||(Le=Le.ref.current)==null?void 0:Le.innerText)},[U]),ne=q.useMemo(()=>({listboxRef:b}),[b]),{dispatch:H,getRootProps:de,contextValue:Ee,state:{highlightedValue:Pe},rootRef:Ze}=eI({disabledItemsFocusable:u,disableListWrap:s,focusManagement:"DOM",getItemDomElement:se,getInitialState:()=>({selectedValues:[],highlightedValue:null}),isItemDisabled:J,items:K,getItemAsString:ue,rootRef:M,onItemsChange:a,reducerActionContext:ne,selectionMode:"none",stateReducer:QW,componentName:_});df(()=>{O(C)},[C,O]),df(()=>{A&&k?.type==="keydown"&&k.key==="ArrowUp"&&H({type:Ni.highlightLast,event:k})},[A,k,H]),q.useEffect(()=>{if(A&&m&&Pe&&!j.current){var Ue;(Ue=U.get(Pe))==null||(Ue=Ue.ref)==null||(Ue=Ue.current)==null||Ue.focus()}},[A,m,Pe,U,K]),q.useEffect(()=>{var Ue;if((Ue=b.current)!=null&&Ue.contains(document.activeElement)&&Pe!==null){var nt;U==null||(nt=U.get(Pe))==null||(nt=nt.ref.current)==null||nt.focus()}},[Pe,U]);const ke=Ue=>nt=>{var Le,lt;(Le=Ue.onBlur)==null||Le.call(Ue,nt),!nt.defaultMuiPrevented&&((lt=b.current)!=null&&lt.contains(nt.relatedTarget)||nt.relatedTarget===P||z({type:eh.blur,event:nt}))},Te=Ue=>nt=>{var Le;(Le=Ue.onKeyDown)==null||Le.call(Ue,nt),!nt.defaultMuiPrevented&&nt.key==="Escape"&&z({type:eh.escapeKeyDown,event:nt})},Ie=(Ue={})=>({onBlur:ke(Ue),onKeyDown:Te(Ue)}),Ce=(Ue={})=>{const nt=ff(Ie,de),Le=gs(Ue);return ye({},Ue,Le,nt(Le),{id:C,role:"menu"})};return q.useDebugValue({subitems:U,highlightedValue:Pe}),{contextValue:ye({},X,Ee),dispatch:H,getListboxProps:Ce,highlightedValue:Pe,listboxRef:Ze,menuItems:U,open:A,triggerElement:P}}function rq(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:a,getItemState:l,registerItem:u,totalSubitemCount:s}=e,m=q.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:a}),[r,a,l]),_=q.useMemo(()=>({getItemIndex:a,registerItem:u,totalSubitemCount:s}),[u,a,s]);return ae.jsx(xx.Provider,{value:_,children:ae.jsx(om.Provider,{value:m,children:n})})}var vM={exports:{}},gl={},yM={exports:{}},_M={};var eL;function iq(){return eL||(eL=1,function(t){function e(Ce,Ue){var nt=Ce.length;Ce.push(Ue);e:for(;0<nt;){var Le=nt-1>>>1,lt=Ce[Le];if(0<a(lt,Ue))Ce[Le]=Ue,Ce[nt]=lt,nt=Le;else break e}}function n(Ce){return Ce.length===0?null:Ce[0]}function r(Ce){if(Ce.length===0)return null;var Ue=Ce[0],nt=Ce.pop();if(nt!==Ue){Ce[0]=nt;e:for(var Le=0,lt=Ce.length,Ht=lt>>>1;Le<Ht;){var He=2*(Le+1)-1,pt=Ce[He],_t=He+1,ot=Ce[_t];if(0>a(pt,nt))_t<lt&&0>a(ot,pt)?(Ce[Le]=ot,Ce[_t]=nt,Le=_t):(Ce[Le]=pt,Ce[He]=nt,Le=He);else if(_t<lt&&0>a(ot,nt))Ce[Le]=ot,Ce[_t]=nt,Le=_t;else break e}}return Ue}function a(Ce,Ue){var nt=Ce.sortIndex-Ue.sortIndex;return nt!==0?nt:Ce.id-Ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}var m=[],_=[],b=1,M=null,C=3,A=!1,k=!1,z=!1,P=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Ce){for(var Ue=n(_);Ue!==null;){if(Ue.callback===null)r(_);else if(Ue.startTime<=Ce)r(_),Ue.sortIndex=Ue.expirationTime,e(m,Ue);else break;Ue=n(_)}}function X(Ce){if(z=!1,U(Ce),!k)if(n(m)!==null)k=!0,Te(K);else{var Ue=n(_);Ue!==null&&Ie(X,Ue.startTime-Ce)}}function K(Ce,Ue){k=!1,z&&(z=!1,O(ue),ue=-1),A=!0;var nt=C;try{for(U(Ue),M=n(m);M!==null&&(!(M.expirationTime>Ue)||Ce&&!de());){var Le=M.callback;if(typeof Le=="function"){M.callback=null,C=M.priorityLevel;var lt=Le(M.expirationTime<=Ue);Ue=t.unstable_now(),typeof lt=="function"?M.callback=lt:M===n(m)&&r(m),U(Ue)}else r(m);M=n(m)}if(M!==null)var Ht=!0;else{var He=n(_);He!==null&&Ie(X,He.startTime-Ue),Ht=!1}return Ht}finally{M=null,C=nt,A=!1}}var se=!1,J=null,ue=-1,ne=5,H=-1;function de(){return!(t.unstable_now()-H<ne)}function Ee(){if(J!==null){var Ce=t.unstable_now();H=Ce;var Ue=!0;try{Ue=J(!0,Ce)}finally{Ue?Pe():(se=!1,J=null)}}else se=!1}var Pe;if(typeof j=="function")Pe=function(){j(Ee)};else if(typeof MessageChannel<"u"){var Ze=new MessageChannel,ke=Ze.port2;Ze.port1.onmessage=Ee,Pe=function(){ke.postMessage(null)}}else Pe=function(){P(Ee,0)};function Te(Ce){J=Ce,se||(se=!0,Pe())}function Ie(Ce,Ue){ue=P(function(){Ce(t.unstable_now())},Ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){k||A||(k=!0,Te(K))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return C},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(Ce){switch(C){case 1:case 2:case 3:var Ue=3;break;default:Ue=C}var nt=C;C=Ue;try{return Ce()}finally{C=nt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,Ue){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var nt=C;C=Ce;try{return Ue()}finally{C=nt}},t.unstable_scheduleCallback=function(Ce,Ue,nt){var Le=t.unstable_now();switch(typeof nt=="object"&&nt!==null?(nt=nt.delay,nt=typeof nt=="number"&&0<nt?Le+nt:Le):nt=Le,Ce){case 1:var lt=-1;break;case 2:lt=250;break;case 5:lt=1073741823;break;case 4:lt=1e4;break;default:lt=5e3}return lt=nt+lt,Ce={id:b++,callback:Ue,priorityLevel:Ce,startTime:nt,expirationTime:lt,sortIndex:-1},nt>Le?(Ce.sortIndex=nt,e(_,Ce),n(m)===null&&Ce===n(_)&&(z?(O(ue),ue=-1):z=!0,Ie(X,nt-Le))):(Ce.sortIndex=lt,e(m,Ce),k||A||(k=!0,Te(K))),Ce},t.unstable_shouldYield=de,t.unstable_wrapCallback=function(Ce){var Ue=C;return function(){var nt=C;C=Ue;try{return Ce.apply(this,arguments)}finally{C=nt}}}}(_M)),_M}var tL;function oq(){return tL||(tL=1,yM.exports=iq()),yM.exports}var nL;function sq(){if(nL)return gl;nL=1;var t=RA(),e=oq();function n(p){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+p,R=1;R<arguments.length;R++)y+="&args[]="+encodeURIComponent(arguments[R]);return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function l(p,y){u(p,y),u(p+"Capture",y)}function u(p,y){for(a[p]=y,p=0;p<y.length;p++)r.add(y[p])}var s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b={},M={};function C(p){return m.call(M,p)?!0:m.call(b,p)?!1:_.test(p)?M[p]=!0:(b[p]=!0,!1)}function A(p,y,R,B){if(R!==null&&R.type===0)return!1;switch(typeof y){case"function":case"symbol":return!0;case"boolean":return B?!1:R!==null?!R.acceptsBooleans:(p=p.toLowerCase().slice(0,5),p!=="data-"&&p!=="aria-");default:return!1}}function k(p,y,R,B){if(y===null||typeof y>"u"||A(p,y,R,B))return!0;if(B)return!1;if(R!==null)switch(R.type){case 3:return!y;case 4:return y===!1;case 5:return isNaN(y);case 6:return isNaN(y)||1>y}return!1}function z(p,y,R,B,Y,re,we){this.acceptsBooleans=y===2||y===3||y===4,this.attributeName=B,this.attributeNamespace=Y,this.mustUseProperty=R,this.propertyName=p,this.type=y,this.sanitizeURL=re,this.removeEmptyString=we}var P={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(p){P[p]=new z(p,0,!1,p,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(p){var y=p[0];P[y]=new z(y,1,!1,p[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(p){P[p]=new z(p,2,!1,p.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(p){P[p]=new z(p,2,!1,p,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(p){P[p]=new z(p,3,!1,p.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(p){P[p]=new z(p,3,!0,p,null,!1,!1)}),["capture","download"].forEach(function(p){P[p]=new z(p,4,!1,p,null,!1,!1)}),["cols","rows","size","span"].forEach(function(p){P[p]=new z(p,6,!1,p,null,!1,!1)}),["rowSpan","start"].forEach(function(p){P[p]=new z(p,5,!1,p.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function j(p){return p[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(p){var y=p.replace(O,j);P[y]=new z(y,1,!1,p,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(p){var y=p.replace(O,j);P[y]=new z(y,1,!1,p,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(p){var y=p.replace(O,j);P[y]=new z(y,1,!1,p,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(p){P[p]=new z(p,1,!1,p.toLowerCase(),null,!1,!1)}),P.xlinkHref=new z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(p){P[p]=new z(p,1,!1,p.toLowerCase(),null,!0,!0)});function U(p,y,R,B){var Y=P.hasOwnProperty(y)?P[y]:null;(Y!==null?Y.type!==0:B||!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(k(y,R,Y,B)&&(R=null),B||Y===null?C(y)&&(R===null?p.removeAttribute(y):p.setAttribute(y,""+R)):Y.mustUseProperty?p[Y.propertyName]=R===null?Y.type===3?!1:"":R:(y=Y.attributeName,B=Y.attributeNamespace,R===null?p.removeAttribute(y):(Y=Y.type,R=Y===3||Y===4&&R===!0?"":""+R,B?p.setAttributeNS(B,y,R):p.setAttribute(y,R))))}var X=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,K=Symbol.for("react.element"),se=Symbol.for("react.portal"),J=Symbol.for("react.fragment"),ue=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),H=Symbol.for("react.provider"),de=Symbol.for("react.context"),Ee=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),Ze=Symbol.for("react.suspense_list"),ke=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),Ie=Symbol.for("react.offscreen"),Ce=Symbol.iterator;function Ue(p){return p===null||typeof p!="object"?null:(p=Ce&&p[Ce]||p["@@iterator"],typeof p=="function"?p:null)}var nt=Object.assign,Le;function lt(p){if(Le===void 0)try{throw Error()}catch(R){var y=R.stack.trim().match(/\n( *(at )?)/);Le=y&&y[1]||""}return`
`+Le+p}var Ht=!1;function He(p,y){if(!p||Ht)return"";Ht=!0;var R=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch($t){var B=$t}Reflect.construct(p,[],y)}else{try{y.call()}catch($t){B=$t}p.call(y.prototype)}else{try{throw Error()}catch($t){B=$t}p()}}catch($t){if($t&&B&&typeof $t.stack=="string"){for(var Y=$t.stack.split(`
`),re=B.stack.split(`
`),we=Y.length-1,at=re.length-1;1<=we&&0<=at&&Y[we]!==re[at];)at--;for(;1<=we&&0<=at;we--,at--)if(Y[we]!==re[at]){if(we!==1||at!==1)do if(we--,at--,0>at||Y[we]!==re[at]){var vt=`
`+Y[we].replace(" at new "," at ");return p.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",p.displayName)),vt}while(1<=we&&0<=at);break}}}finally{Ht=!1,Error.prepareStackTrace=R}return(p=p?p.displayName||p.name:"")?lt(p):""}function pt(p){switch(p.tag){case 5:return lt(p.type);case 16:return lt("Lazy");case 13:return lt("Suspense");case 19:return lt("SuspenseList");case 0:case 2:case 15:return p=He(p.type,!1),p;case 11:return p=He(p.type.render,!1),p;case 1:return p=He(p.type,!0),p;default:return""}}function _t(p){if(p==null)return null;if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case J:return"Fragment";case se:return"Portal";case ne:return"Profiler";case ue:return"StrictMode";case Pe:return"Suspense";case Ze:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case de:return(p.displayName||"Context")+".Consumer";case H:return(p._context.displayName||"Context")+".Provider";case Ee:var y=p.render;return p=p.displayName,p||(p=y.displayName||y.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case ke:return y=p.displayName||null,y!==null?y:_t(p.type)||"Memo";case Te:y=p._payload,p=p._init;try{return _t(p(y))}catch{}}return null}function ot(p){var y=p.type;switch(p.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return p=y.render,p=p.displayName||p.name||"",y.displayName||(p!==""?"ForwardRef("+p+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _t(y);case 8:return y===ue?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function et(p){switch(typeof p){case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function Mt(p){var y=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function Tt(p){var y=Mt(p)?"checked":"value",R=Object.getOwnPropertyDescriptor(p.constructor.prototype,y),B=""+p[y];if(!p.hasOwnProperty(y)&&typeof R<"u"&&typeof R.get=="function"&&typeof R.set=="function"){var Y=R.get,re=R.set;return Object.defineProperty(p,y,{configurable:!0,get:function(){return Y.call(this)},set:function(we){B=""+we,re.call(this,we)}}),Object.defineProperty(p,y,{enumerable:R.enumerable}),{getValue:function(){return B},setValue:function(we){B=""+we},stopTracking:function(){p._valueTracker=null,delete p[y]}}}}function hn(p){p._valueTracker||(p._valueTracker=Tt(p))}function en(p){if(!p)return!1;var y=p._valueTracker;if(!y)return!0;var R=y.getValue(),B="";return p&&(B=Mt(p)?p.checked?"true":"false":p.value),p=B,p!==R?(y.setValue(p),!0):!1}function an(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}function Ke(p,y){var R=y.checked;return nt({},y,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:R??p._wrapperState.initialChecked})}function An(p,y){var R=y.defaultValue==null?"":y.defaultValue,B=y.checked!=null?y.checked:y.defaultChecked;R=et(y.value!=null?y.value:R),p._wrapperState={initialChecked:B,initialValue:R,controlled:y.type==="checkbox"||y.type==="radio"?y.checked!=null:y.value!=null}}function Gt(p,y){y=y.checked,y!=null&&U(p,"checked",y,!1)}function on(p,y){Gt(p,y);var R=et(y.value),B=y.type;if(R!=null)B==="number"?(R===0&&p.value===""||p.value!=R)&&(p.value=""+R):p.value!==""+R&&(p.value=""+R);else if(B==="submit"||B==="reset"){p.removeAttribute("value");return}y.hasOwnProperty("value")?Gn(p,y.type,R):y.hasOwnProperty("defaultValue")&&Gn(p,y.type,et(y.defaultValue)),y.checked==null&&y.defaultChecked!=null&&(p.defaultChecked=!!y.defaultChecked)}function Wt(p,y,R){if(y.hasOwnProperty("value")||y.hasOwnProperty("defaultValue")){var B=y.type;if(!(B!=="submit"&&B!=="reset"||y.value!==void 0&&y.value!==null))return;y=""+p._wrapperState.initialValue,R||y===p.value||(p.value=y),p.defaultValue=y}R=p.name,R!==""&&(p.name=""),p.defaultChecked=!!p._wrapperState.initialChecked,R!==""&&(p.name=R)}function Gn(p,y,R){(y!=="number"||an(p.ownerDocument)!==p)&&(R==null?p.defaultValue=""+p._wrapperState.initialValue:p.defaultValue!==""+R&&(p.defaultValue=""+R))}var dn=Array.isArray;function Ve(p,y,R,B){if(p=p.options,y){y={};for(var Y=0;Y<R.length;Y++)y["$"+R[Y]]=!0;for(R=0;R<p.length;R++)Y=y.hasOwnProperty("$"+p[R].value),p[R].selected!==Y&&(p[R].selected=Y),Y&&B&&(p[R].defaultSelected=!0)}else{for(R=""+et(R),y=null,Y=0;Y<p.length;Y++){if(p[Y].value===R){p[Y].selected=!0,B&&(p[Y].defaultSelected=!0);return}y!==null||p[Y].disabled||(y=p[Y])}y!==null&&(y.selected=!0)}}function Se(p,y){if(y.dangerouslySetInnerHTML!=null)throw Error(n(91));return nt({},y,{value:void 0,defaultValue:void 0,children:""+p._wrapperState.initialValue})}function bt(p,y){var R=y.value;if(R==null){if(R=y.children,y=y.defaultValue,R!=null){if(y!=null)throw Error(n(92));if(dn(R)){if(1<R.length)throw Error(n(93));R=R[0]}y=R}y==null&&(y=""),R=y}p._wrapperState={initialValue:et(R)}}function Nt(p,y){var R=et(y.value),B=et(y.defaultValue);R!=null&&(R=""+R,R!==p.value&&(p.value=R),y.defaultValue==null&&p.defaultValue!==R&&(p.defaultValue=R)),B!=null&&(p.defaultValue=""+B)}function jt(p){var y=p.textContent;y===p._wrapperState.initialValue&&y!==""&&y!==null&&(p.value=y)}function Ut(p){switch(p){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yn(p,y){return p==null||p==="http://www.w3.org/1999/xhtml"?Ut(y):p==="http://www.w3.org/2000/svg"&&y==="foreignObject"?"http://www.w3.org/1999/xhtml":p}var Zt,qt=function(p){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(y,R,B,Y){MSApp.execUnsafeLocalFunction(function(){return p(y,R,B,Y)})}:p}(function(p,y){if(p.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in p)p.innerHTML=y;else{for(Zt=Zt||document.createElement("div"),Zt.innerHTML="<svg>"+y.valueOf().toString()+"</svg>",y=Zt.firstChild;p.firstChild;)p.removeChild(p.firstChild);for(;y.firstChild;)p.appendChild(y.firstChild)}});function Fn(p,y){if(y){var R=p.firstChild;if(R&&R===p.lastChild&&R.nodeType===3){R.nodeValue=y;return}}p.textContent=y}var Be={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ee=["Webkit","ms","Moz","O"];Object.keys(Be).forEach(function(p){ee.forEach(function(y){y=y+p.charAt(0).toUpperCase()+p.substring(1),Be[y]=Be[p]})});function oe(p,y,R){return y==null||typeof y=="boolean"||y===""?"":R||typeof y!="number"||y===0||Be.hasOwnProperty(p)&&Be[p]?(""+y).trim():y+"px"}function fe(p,y){p=p.style;for(var R in y)if(y.hasOwnProperty(R)){var B=R.indexOf("--")===0,Y=oe(R,y[R],B);R==="float"&&(R="cssFloat"),B?p.setProperty(R,Y):p[R]=Y}}var he=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(p,y){if(y){if(he[p]&&(y.children!=null||y.dangerouslySetInnerHTML!=null))throw Error(n(137,p));if(y.dangerouslySetInnerHTML!=null){if(y.children!=null)throw Error(n(60));if(typeof y.dangerouslySetInnerHTML!="object"||!("__html"in y.dangerouslySetInnerHTML))throw Error(n(61))}if(y.style!=null&&typeof y.style!="object")throw Error(n(62))}}function Ye(p,y){if(p.indexOf("-")===-1)return typeof y.is=="string";switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var st=null;function _e(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Fe=null,Ge=null,je=null;function De(p){if(p=Da(p)){if(typeof Fe!="function")throw Error(n(280));var y=p.stateNode;y&&(y=Rd(y),Fe(p.stateNode,p.type,y))}}function zt(p){Ge?je?je.push(p):je=[p]:Ge=p}function fn(){if(Ge){var p=Ge,y=je;if(je=Ge=null,De(p),y)for(p=0;p<y.length;p++)De(y[p])}}function sn(p,y){return p(y)}function Jt(){}var cn=!1;function Zn(p,y,R){if(cn)return p(y,R);cn=!0;try{return sn(p,y,R)}finally{cn=!1,(Ge!==null||je!==null)&&(Jt(),fn())}}function yr(p,y){var R=p.stateNode;if(R===null)return null;var B=Rd(R);if(B===null)return null;R=B[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(B=!B.disabled)||(p=p.type,B=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!B;break e;default:p=!1}if(p)return null;if(R&&typeof R!="function")throw Error(n(231,y,typeof R));return R}var Ar=!1;if(s)try{var Je={};Object.defineProperty(Je,"passive",{get:function(){Ar=!0}}),window.addEventListener("test",Je,Je),window.removeEventListener("test",Je,Je)}catch{Ar=!1}function gt(p,y,R,B,Y,re,we,at,vt){var $t=Array.prototype.slice.call(arguments,3);try{y.apply(R,$t)}catch(wn){this.onError(wn)}}var St=!1,ft=null,Qt=!1,Sn=null,Un={onError:function(p){St=!0,ft=p}};function kn(p,y,R,B,Y,re,we,at,vt){St=!1,ft=null,gt.apply(Un,arguments)}function Rt(p,y,R,B,Y,re,we,at,vt){if(kn.apply(this,arguments),St){if(St){var $t=ft;St=!1,ft=null}else throw Error(n(198));Qt||(Qt=!0,Sn=$t)}}function ct(p){var y=p,R=p;if(p.alternate)for(;y.return;)y=y.return;else{p=y;do y=p,(y.flags&4098)!==0&&(R=y.return),p=y.return;while(p)}return y.tag===3?R:null}function ut(p){if(p.tag===13){var y=p.memoizedState;if(y===null&&(p=p.alternate,p!==null&&(y=p.memoizedState)),y!==null)return y.dehydrated}return null}function Vt(p){if(ct(p)!==p)throw Error(n(188))}function En(p){var y=p.alternate;if(!y){if(y=ct(p),y===null)throw Error(n(188));return y!==p?null:p}for(var R=p,B=y;;){var Y=R.return;if(Y===null)break;var re=Y.alternate;if(re===null){if(B=Y.return,B!==null){R=B;continue}break}if(Y.child===re.child){for(re=Y.child;re;){if(re===R)return Vt(Y),p;if(re===B)return Vt(Y),y;re=re.sibling}throw Error(n(188))}if(R.return!==B.return)R=Y,B=re;else{for(var we=!1,at=Y.child;at;){if(at===R){we=!0,R=Y,B=re;break}if(at===B){we=!0,B=Y,R=re;break}at=at.sibling}if(!we){for(at=re.child;at;){if(at===R){we=!0,R=re,B=Y;break}if(at===B){we=!0,B=re,R=Y;break}at=at.sibling}if(!we)throw Error(n(189))}}if(R.alternate!==B)throw Error(n(190))}if(R.tag!==3)throw Error(n(188));return R.stateNode.current===R?p:y}function Bn(p){return p=En(p),p!==null?In(p):null}function In(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){var y=In(p);if(y!==null)return y;p=p.sibling}return null}var fr=e.unstable_scheduleCallback,Re=e.unstable_cancelCallback,mt=e.unstable_shouldYield,Lt=e.unstable_requestPaint,Et=e.unstable_now,wt=e.unstable_getCurrentPriorityLevel,un=e.unstable_ImmediatePriority,_n=e.unstable_UserBlockingPriority,pn=e.unstable_NormalPriority,jn=e.unstable_LowPriority,mn=e.unstable_IdlePriority,Wn=null,Pn=null;function Rn(p){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(Wn,p,void 0,(p.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:On,Ir=Math.log,wr=Math.LN2;function On(p){return p>>>=0,p===0?32:31-(Ir(p)/wr|0)|0}var or=64,gi=4194304;function Cr(p){switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return p&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return p}}function zo(p,y){var R=p.pendingLanes;if(R===0)return 0;var B=0,Y=p.suspendedLanes,re=p.pingedLanes,we=R&268435455;if(we!==0){var at=we&~Y;at!==0?B=Cr(at):(re&=we,re!==0&&(B=Cr(re)))}else we=R&~Y,we!==0?B=Cr(we):re!==0&&(B=Cr(re));if(B===0)return 0;if(y!==0&&y!==B&&(y&Y)===0&&(Y=B&-B,re=y&-y,Y>=re||Y===16&&(re&4194240)!==0))return y;if((B&4)!==0&&(B|=R&16),y=p.entangledLanes,y!==0)for(p=p.entanglements,y&=B;0<y;)R=31-Qn(y),Y=1<<R,B|=p[R],y&=~Y;return B}function Ll(p,y){switch(p){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Go(p,y){for(var R=p.suspendedLanes,B=p.pingedLanes,Y=p.expirationTimes,re=p.pendingLanes;0<re;){var we=31-Qn(re),at=1<<we,vt=Y[we];vt===-1?((at&R)===0||(at&B)!==0)&&(Y[we]=Ll(at,y)):vt<=y&&(p.expiredLanes|=at),re&=~at}}function ea(p){return p=p.pendingLanes&-1073741825,p!==0?p:p&1073741824?1073741824:0}function ei(){var p=or;return or<<=1,(or&4194240)===0&&(or=64),p}function _o(p){for(var y=[],R=0;31>R;R++)y.push(p);return y}function eo(p,y,R){p.pendingLanes|=y,y!==536870912&&(p.suspendedLanes=0,p.pingedLanes=0),p=p.eventTimes,y=31-Qn(y),p[y]=R}function uo(p,y){var R=p.pendingLanes&~y;p.pendingLanes=y,p.suspendedLanes=0,p.pingedLanes=0,p.expiredLanes&=y,p.mutableReadLanes&=y,p.entangledLanes&=y,y=p.entanglements;var B=p.eventTimes;for(p=p.expirationTimes;0<R;){var Y=31-Qn(R),re=1<<Y;y[Y]=0,B[Y]=-1,p[Y]=-1,R&=~re}}function xo(p,y){var R=p.entangledLanes|=y;for(p=p.entanglements;R;){var B=31-Qn(R),Y=1<<B;Y&y|p[B]&y&&(p[B]|=y),R&=~Y}}var kr=0;function Us(p){return p&=-p,1<p?4<p?(p&268435455)!==0?16:536870912:4:1}var gm,yc,Mf,ch,kl,_c=!1,_r=[],Za=null,xc=null,Ya=null,bo=new Map,to=new Map,Zr=[],dr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ti(p,y){switch(p){case"focusin":case"focusout":Za=null;break;case"dragenter":case"dragleave":xc=null;break;case"mouseover":case"mouseout":Ya=null;break;case"pointerover":case"pointerout":bo.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":to.delete(y.pointerId)}}function ta(p,y,R,B,Y,re){return p===null||p.nativeEvent!==re?(p={blockedOn:y,domEventName:R,eventSystemFlags:B,nativeEvent:re,targetContainers:[Y]},y!==null&&(y=Da(y),y!==null&&yc(y)),p):(p.eventSystemFlags|=B,y=p.targetContainers,Y!==null&&y.indexOf(Y)===-1&&y.push(Y),p)}function os(p,y,R,B,Y){switch(y){case"focusin":return Za=ta(Za,p,y,R,B,Y),!0;case"dragenter":return xc=ta(xc,p,y,R,B,Y),!0;case"mouseover":return Ya=ta(Ya,p,y,R,B,Y),!0;case"pointerover":var re=Y.pointerId;return bo.set(re,ta(bo.get(re)||null,p,y,R,B,Y)),!0;case"gotpointercapture":return re=Y.pointerId,to.set(re,ta(to.get(re)||null,p,y,R,B,Y)),!0}return!1}function _s(p){var y=Ra(p.target);if(y!==null){var R=ct(y);if(R!==null){if(y=R.tag,y===13){if(y=ut(R),y!==null){p.blockedOn=y,kl(p.priority,function(){Mf(R)});return}}else if(y===3&&R.stateNode.current.memoizedState.isDehydrated){p.blockedOn=R.tag===3?R.stateNode.containerInfo:null;return}}}p.blockedOn=null}function wo(p){if(p.blockedOn!==null)return!1;for(var y=p.targetContainers;0<y.length;){var R=pd(p.domEventName,p.eventSystemFlags,y[0],p.nativeEvent);if(R===null){R=p.nativeEvent;var B=new R.constructor(R.type,R);st=B,R.target.dispatchEvent(B),st=null}else return y=Da(R),y!==null&&yc(y),p.blockedOn=R,!1;y.shift()}return!0}function lu(p,y,R){wo(p)&&R.delete(y)}function bc(){_c=!1,Za!==null&&wo(Za)&&(Za=null),xc!==null&&wo(xc)&&(xc=null),Ya!==null&&wo(Ya)&&(Ya=null),bo.forEach(lu),to.forEach(lu)}function vi(p,y){p.blockedOn===y&&(p.blockedOn=null,_c||(_c=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,bc)))}function Ea(p){function y(Y){return vi(Y,p)}if(0<_r.length){vi(_r[0],p);for(var R=1;R<_r.length;R++){var B=_r[R];B.blockedOn===p&&(B.blockedOn=null)}}for(Za!==null&&vi(Za,p),xc!==null&&vi(xc,p),Ya!==null&&vi(Ya,p),bo.forEach(y),to.forEach(y),R=0;R<Zr.length;R++)B=Zr[R],B.blockedOn===p&&(B.blockedOn=null);for(;0<Zr.length&&(R=Zr[0],R.blockedOn===null);)_s(R),R.blockedOn===null&&Zr.shift()}var ss=X.ReactCurrentBatchConfig,cu=!0;function xs(p,y,R,B){var Y=kr,re=ss.transition;ss.transition=null;try{kr=1,Ca(p,y,R,B)}finally{kr=Y,ss.transition=re}}function uu(p,y,R,B){var Y=kr,re=ss.transition;ss.transition=null;try{kr=4,Ca(p,y,R,B)}finally{kr=Y,ss.transition=re}}function Ca(p,y,R,B){if(cu){var Y=pd(p,y,R,B);if(Y===null)Su(p,y,B,fd,R),ti(p,B);else if(os(Y,p,y,R,B))B.stopPropagation();else if(ti(p,B),y&4&&-1<dr.indexOf(p)){for(;Y!==null;){var re=Da(Y);if(re!==null&&gm(re),re=pd(p,y,R,B),re===null&&Su(p,y,B,fd,R),re===Y)break;Y=re}Y!==null&&B.stopPropagation()}else Su(p,y,B,null,R)}}var fd=null;function pd(p,y,R,B){if(fd=null,p=_e(B),p=Ra(p),p!==null)if(y=ct(p),y===null)p=null;else if(R=y.tag,R===13){if(p=ut(y),p!==null)return p;p=null}else if(R===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;p=null}else y!==p&&(p=null);return fd=p,null}function wc(p){switch(p){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wt()){case un:return 1;case _n:return 4;case pn:case jn:return 16;case mn:return 536870912;default:return 16}default:return 16}}var Br=null,Sc=null,Pr=null;function xr(){if(Pr)return Pr;var p,y=Sc,R=y.length,B,Y="value"in Br?Br.value:Br.textContent,re=Y.length;for(p=0;p<R&&y[p]===Y[p];p++);var we=R-p;for(B=1;B<=we&&y[R-B]===Y[re-B];B++);return Pr=Y.slice(p,1<B?1-B:void 0)}function zl(p){var y=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&y===13&&(p=13)):p=y,p===10&&(p=13),32<=p||p===13?p:0}function Rr(){return!0}function uh(){return!1}function zi(p){function y(R,B,Y,re,we){this._reactName=R,this._targetInst=Y,this.type=B,this.nativeEvent=re,this.target=we,this.currentTarget=null;for(var at in p)p.hasOwnProperty(at)&&(R=p[at],this[at]=R?R(re):re[at]);return this.isDefaultPrevented=(re.defaultPrevented!=null?re.defaultPrevented:re.returnValue===!1)?Rr:uh,this.isPropagationStopped=uh,this}return nt(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var R=this.nativeEvent;R&&(R.preventDefault?R.preventDefault():typeof R.returnValue!="unknown"&&(R.returnValue=!1),this.isDefaultPrevented=Rr)},stopPropagation:function(){var R=this.nativeEvent;R&&(R.stopPropagation?R.stopPropagation():typeof R.cancelBubble!="unknown"&&(R.cancelBubble=!0),this.isPropagationStopped=Rr)},persist:function(){},isPersistent:Rr}),y}var Ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ka=zi(Ta),hh=nt({},Ta,{view:0,detail:0}),md=zi(hh),gd,vm,dh,So=nt({},hh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mc,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==dh&&(dh&&p.type==="mousemove"?(gd=p.screenX-dh.screenX,vm=p.screenY-dh.screenY):vm=gd=0,dh=p),gd)},movementY:function(p){return"movementY"in p?p.movementY:vm}}),Pa=zi(So),Ai=nt({},So,{dataTransfer:0}),hu=zi(Ai),ym=nt({},hh,{relatedTarget:0}),du=zi(ym),Ui=nt({},Ta,{animationName:0,elapsedTime:0,pseudoElement:0}),jg=zi(Ui),_m=nt({},Ta,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),Hg=zi(_m),i0=nt({},Ta,{data:0}),fu=zi(i0),Ef={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vd(p){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(p):(p=xm[p])?!!y[p]:!1}function Mc(){return vd}var ph=nt({},hh,{key:function(p){if(p.key){var y=Ef[p.key]||p.key;if(y!=="Unidentified")return y}return p.type==="keypress"?(p=zl(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?fh[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mc,charCode:function(p){return p.type==="keypress"?zl(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?zl(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),no=zi(ph),Gg=nt({},So,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pu=zi(Gg),yd=nt({},hh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mc}),mu=zi(yd),o0=nt({},Ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cf=zi(o0),s0=nt({},So,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),mh=zi(s0),Tf=[9,13,27,32],Pf=s&&"CompositionEvent"in window,gh=null;s&&"documentMode"in document&&(gh=document.documentMode);var bm=s&&"TextEvent"in window&&!gh,Af=s&&(!Pf||gh&&8<gh&&11>=gh),If=" ",wm=!1;function Sm(p,y){switch(p){case"keyup":return Tf.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mm(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var na=!1;function Wg(p,y){switch(p){case"compositionend":return Mm(y);case"keypress":return y.which!==32?null:(wm=!0,If);case"textInput":return p=y.data,p===If&&wm?null:p;default:return null}}function Em(p,y){if(na)return p==="compositionend"||!Pf&&Sm(p,y)?(p=xr(),Pr=Sc=Br=null,na=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return Af&&y.locale!=="ko"?null:y.data;default:return null}}var vh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cm(p){var y=p&&p.nodeName&&p.nodeName.toLowerCase();return y==="input"?!!vh[p.type]:y==="textarea"}function _d(p,y,R,B){zt(B),y=wh(y,"onChange"),0<y.length&&(R=new Ka("onChange","change",null,R,B),p.push({event:R,listeners:y}))}var xd=null,bd=null;function qg(p){Qg(p,0)}function Ec(p){var y=La(p);if(en(y))return p}function Xg(p,y){if(p==="change")return y}var Rf=!1;if(s){var Df;if(s){var yh="oninput"in document;if(!yh){var ra=document.createElement("div");ra.setAttribute("oninput","return;"),yh=typeof ra.oninput=="function"}Df=yh}else Df=!1;Rf=Df&&(!document.documentMode||9<document.documentMode)}function wd(){xd&&(xd.detachEvent("onpropertychange",Lf),bd=xd=null)}function Lf(p){if(p.propertyName==="value"&&Ec(bd)){var y=[];_d(y,bd,p,_e(p)),Zn(qg,y)}}function Tm(p,y,R){p==="focusin"?(wd(),xd=y,bd=R,xd.attachEvent("onpropertychange",Lf)):p==="focusout"&&wd()}function Pm(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Ec(bd)}function kf(p,y){if(p==="click")return Ec(y)}function gu(p,y){if(p==="input"||p==="change")return Ec(y)}function Am(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var Aa=typeof Object.is=="function"?Object.is:Am;function _h(p,y){if(Aa(p,y))return!0;if(typeof p!="object"||p===null||typeof y!="object"||y===null)return!1;var R=Object.keys(p),B=Object.keys(y);if(R.length!==B.length)return!1;for(B=0;B<R.length;B++){var Y=R[B];if(!m.call(y,Y)||!Aa(p[Y],y[Y]))return!1}return!0}function Zg(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function Yg(p,y){var R=Zg(p);p=0;for(var B;R;){if(R.nodeType===3){if(B=p+R.textContent.length,p<=y&&B>=y)return{node:R,offset:y-p};p=B}e:{for(;R;){if(R.nextSibling){R=R.nextSibling;break e}R=R.parentNode}R=void 0}R=Zg(R)}}function Im(p,y){return p&&y?p===y?!0:p&&p.nodeType===3?!1:y&&y.nodeType===3?Im(p,y.parentNode):"contains"in p?p.contains(y):p.compareDocumentPosition?!!(p.compareDocumentPosition(y)&16):!1:!1}function Kg(){for(var p=window,y=an();y instanceof p.HTMLIFrameElement;){try{var R=typeof y.contentWindow.location.href=="string"}catch{R=!1}if(R)p=y.contentWindow;else break;y=an(p.document)}return y}function Ur(p){var y=p&&p.nodeName&&p.nodeName.toLowerCase();return y&&(y==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||y==="textarea"||p.contentEditable==="true")}function zf(p){var y=Kg(),R=p.focusedElem,B=p.selectionRange;if(y!==R&&R&&R.ownerDocument&&Im(R.ownerDocument.documentElement,R)){if(B!==null&&Ur(R)){if(y=B.start,p=B.end,p===void 0&&(p=y),"selectionStart"in R)R.selectionStart=y,R.selectionEnd=Math.min(p,R.value.length);else if(p=(y=R.ownerDocument||document)&&y.defaultView||window,p.getSelection){p=p.getSelection();var Y=R.textContent.length,re=Math.min(B.start,Y);B=B.end===void 0?re:Math.min(B.end,Y),!p.extend&&re>B&&(Y=B,B=re,re=Y),Y=Yg(R,re);var we=Yg(R,B);Y&&we&&(p.rangeCount!==1||p.anchorNode!==Y.node||p.anchorOffset!==Y.offset||p.focusNode!==we.node||p.focusOffset!==we.offset)&&(y=y.createRange(),y.setStart(Y.node,Y.offset),p.removeAllRanges(),re>B?(p.addRange(y),p.extend(we.node,we.offset)):(y.setEnd(we.node,we.offset),p.addRange(y)))}}for(y=[],p=R;p=p.parentNode;)p.nodeType===1&&y.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<y.length;R++)p=y[R],p.element.scrollLeft=p.left,p.element.scrollTop=p.top}}var Of=s&&"documentMode"in document&&11>=document.documentMode,Ol=null,Sd=null,Ia=null,vu=!1;function yu(p,y,R){var B=R.window===R?R.document:R.nodeType===9?R:R.ownerDocument;vu||Ol==null||Ol!==an(B)||(B=Ol,"selectionStart"in B&&Ur(B)?B={start:B.selectionStart,end:B.selectionEnd}:(B=(B.ownerDocument&&B.ownerDocument.defaultView||window).getSelection(),B={anchorNode:B.anchorNode,anchorOffset:B.anchorOffset,focusNode:B.focusNode,focusOffset:B.focusOffset}),Ia&&_h(Ia,B)||(Ia=B,B=wh(Sd,"onSelect"),0<B.length&&(y=new Ka("onSelect","select",null,y,R),p.push({event:y,listeners:B}),y.target=Ol)))}function as(p,y){var R={};return R[p.toLowerCase()]=y.toLowerCase(),R["Webkit"+p]="webkit"+y,R["Moz"+p]="moz"+y,R}var _u={animationend:as("Animation","AnimationEnd"),animationiteration:as("Animation","AnimationIteration"),animationstart:as("Animation","AnimationStart"),transitionend:as("Transition","TransitionEnd")},Ff={},Nf={};s&&(Nf=document.createElement("div").style,"AnimationEvent"in window||(delete _u.animationend.animation,delete _u.animationiteration.animation,delete _u.animationstart.animation),"TransitionEvent"in window||delete _u.transitionend.transition);function Ja(p){if(Ff[p])return Ff[p];if(!_u[p])return p;var y=_u[p],R;for(R in y)if(y.hasOwnProperty(R)&&R in Nf)return Ff[p]=y[R];return p}var Md=Ja("animationend"),Ed=Ja("animationiteration"),xh=Ja("animationstart"),Cd=Ja("transitionend"),Rm=new Map,xu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $s(p,y){Rm.set(p,y),l(y,[p])}for(var Bf=0;Bf<xu.length;Bf++){var Td=xu[Bf],Tr=Td.toLowerCase(),Uf=Td[0].toUpperCase()+Td.slice(1);$s(Tr,"on"+Uf)}$s(Md,"onAnimationEnd"),$s(Ed,"onAnimationIteration"),$s(xh,"onAnimationStart"),$s("dblclick","onDoubleClick"),$s("focusin","onFocus"),$s("focusout","onBlur"),$s(Cd,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pd));function bh(p,y,R){var B=p.type||"unknown-event";p.currentTarget=R,Rt(B,y,void 0,p),p.currentTarget=null}function Qg(p,y){y=(y&4)!==0;for(var R=0;R<p.length;R++){var B=p[R],Y=B.event;B=B.listeners;e:{var re=void 0;if(y)for(var we=B.length-1;0<=we;we--){var at=B[we],vt=at.instance,$t=at.currentTarget;if(at=at.listener,vt!==re&&Y.isPropagationStopped())break e;bh(Y,at,$t),re=vt}else for(we=0;we<B.length;we++){if(at=B[we],vt=at.instance,$t=at.currentTarget,at=at.listener,vt!==re&&Y.isPropagationStopped())break e;bh(Y,at,$t),re=vt}}}if(Qt)throw p=Sn,Qt=!1,Sn=null,p}function Ii(p,y){var R=y[Cu];R===void 0&&(R=y[Cu]=new Set);var B=p+"__bubble";R.has(B)||(wu(y,p,2,!1),R.add(B))}function $f(p,y,R){var B=0;y&&(B|=4),wu(R,p,B,y)}var Vf="_reactListening"+Math.random().toString(36).slice(2);function bu(p){if(!p[Vf]){p[Vf]=!0,r.forEach(function(R){R!=="selectionchange"&&(Jg.has(R)||$f(R,!1,p),$f(R,!0,p))});var y=p.nodeType===9?p:p.ownerDocument;y===null||y[Vf]||(y[Vf]=!0,$f("selectionchange",!1,y))}}function wu(p,y,R,B){switch(wc(y)){case 1:var Y=xs;break;case 4:Y=uu;break;default:Y=Ca}R=Y.bind(null,y,R,p),Y=void 0,!Ar||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(Y=!0),B?Y!==void 0?p.addEventListener(y,R,{capture:!0,passive:Y}):p.addEventListener(y,R,!0):Y!==void 0?p.addEventListener(y,R,{passive:Y}):p.addEventListener(y,R,!1)}function Su(p,y,R,B,Y){var re=B;if((y&1)===0&&(y&2)===0&&B!==null)e:for(;;){if(B===null)return;var we=B.tag;if(we===3||we===4){var at=B.stateNode.containerInfo;if(at===Y||at.nodeType===8&&at.parentNode===Y)break;if(we===4)for(we=B.return;we!==null;){var vt=we.tag;if((vt===3||vt===4)&&(vt=we.stateNode.containerInfo,vt===Y||vt.nodeType===8&&vt.parentNode===Y))return;we=we.return}for(;at!==null;){if(we=Ra(at),we===null)return;if(vt=we.tag,vt===5||vt===6){B=re=we;continue e}at=at.parentNode}}B=B.return}Zn(function(){var $t=re,wn=_e(R),Cn=[];e:{var bn=Rm.get(p);if(bn!==void 0){var tr=Ka,sr=p;switch(p){case"keypress":if(zl(R)===0)break e;case"keydown":case"keyup":tr=no;break;case"focusin":sr="focus",tr=du;break;case"focusout":sr="blur",tr=du;break;case"beforeblur":case"afterblur":tr=du;break;case"click":if(R.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tr=Pa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tr=hu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tr=mu;break;case Md:case Ed:case xh:tr=jg;break;case Cd:tr=Cf;break;case"scroll":tr=md;break;case"wheel":tr=mh;break;case"copy":case"cut":case"paste":tr=Hg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tr=pu}var cr=(y&4)!==0,Yi=!cr&&p==="scroll",kt=cr?bn!==null?bn+"Capture":null:bn;cr=[];for(var xt=$t,Ft;xt!==null;){Ft=xt;var zn=Ft.stateNode;if(Ft.tag===5&&zn!==null&&(Ft=zn,kt!==null&&(zn=yr(xt,kt),zn!=null&&cr.push(Cc(xt,zn,Ft)))),Yi)break;xt=xt.return}0<cr.length&&(bn=new tr(bn,sr,null,R,wn),Cn.push({event:bn,listeners:cr}))}}if((y&7)===0){e:{if(bn=p==="mouseover"||p==="pointerover",tr=p==="mouseout"||p==="pointerout",bn&&R!==st&&(sr=R.relatedTarget||R.fromElement)&&(Ra(sr)||sr[ia]))break e;if((tr||bn)&&(bn=wn.window===wn?wn:(bn=wn.ownerDocument)?bn.defaultView||bn.parentWindow:window,tr?(sr=R.relatedTarget||R.toElement,tr=$t,sr=sr?Ra(sr):null,sr!==null&&(Yi=ct(sr),sr!==Yi||sr.tag!==5&&sr.tag!==6)&&(sr=null)):(tr=null,sr=$t),tr!==sr)){if(cr=Pa,zn="onMouseLeave",kt="onMouseEnter",xt="mouse",(p==="pointerout"||p==="pointerover")&&(cr=pu,zn="onPointerLeave",kt="onPointerEnter",xt="pointer"),Yi=tr==null?bn:La(tr),Ft=sr==null?bn:La(sr),bn=new cr(zn,xt+"leave",tr,R,wn),bn.target=Yi,bn.relatedTarget=Ft,zn=null,Ra(wn)===$t&&(cr=new cr(kt,xt+"enter",sr,R,wn),cr.target=Ft,cr.relatedTarget=Yi,zn=cr),Yi=zn,tr&&sr)t:{for(cr=tr,kt=sr,xt=0,Ft=cr;Ft;Ft=Tc(Ft))xt++;for(Ft=0,zn=kt;zn;zn=Tc(zn))Ft++;for(;0<xt-Ft;)cr=Tc(cr),xt--;for(;0<Ft-xt;)kt=Tc(kt),Ft--;for(;xt--;){if(cr===kt||kt!==null&&cr===kt.alternate)break t;cr=Tc(cr),kt=Tc(kt)}cr=null}else cr=null;tr!==null&&Ad(Cn,bn,tr,cr,!1),sr!==null&&Yi!==null&&Ad(Cn,Yi,sr,cr,!0)}}e:{if(bn=$t?La($t):window,tr=bn.nodeName&&bn.nodeName.toLowerCase(),tr==="select"||tr==="input"&&bn.type==="file")var hr=Xg;else if(Cm(bn))if(Rf)hr=gu;else{hr=Pm;var mr=Tm}else(tr=bn.nodeName)&&tr.toLowerCase()==="input"&&(bn.type==="checkbox"||bn.type==="radio")&&(hr=kf);if(hr&&(hr=hr(p,$t))){_d(Cn,hr,R,wn);break e}mr&&mr(p,bn,$t),p==="focusout"&&(mr=bn._wrapperState)&&mr.controlled&&bn.type==="number"&&Gn(bn,"number",bn.value)}switch(mr=$t?La($t):window,p){case"focusin":(Cm(mr)||mr.contentEditable==="true")&&(Ol=mr,Sd=$t,Ia=null);break;case"focusout":Ia=Sd=Ol=null;break;case"mousedown":vu=!0;break;case"contextmenu":case"mouseup":case"dragend":vu=!1,yu(Cn,R,wn);break;case"selectionchange":if(Of)break;case"keydown":case"keyup":yu(Cn,R,wn)}var vr;if(Pf)e:{switch(p){case"compositionstart":var br="onCompositionStart";break e;case"compositionend":br="onCompositionEnd";break e;case"compositionupdate":br="onCompositionUpdate";break e}br=void 0}else na?Sm(p,R)&&(br="onCompositionEnd"):p==="keydown"&&R.keyCode===229&&(br="onCompositionStart");br&&(Af&&R.locale!=="ko"&&(na||br!=="onCompositionStart"?br==="onCompositionEnd"&&na&&(vr=xr()):(Br=wn,Sc="value"in Br?Br.value:Br.textContent,na=!0)),mr=wh($t,br),0<mr.length&&(br=new fu(br,p,null,R,wn),Cn.push({event:br,listeners:mr}),vr?br.data=vr:(vr=Mm(R),vr!==null&&(br.data=vr)))),(vr=bm?Wg(p,R):Em(p,R))&&($t=wh($t,"onBeforeInput"),0<$t.length&&(wn=new fu("onBeforeInput","beforeinput",null,R,wn),Cn.push({event:wn,listeners:$t}),wn.data=vr))}Qg(Cn,y)})}function Cc(p,y,R){return{instance:p,listener:y,currentTarget:R}}function wh(p,y){for(var R=y+"Capture",B=[];p!==null;){var Y=p,re=Y.stateNode;Y.tag===5&&re!==null&&(Y=re,re=yr(p,R),re!=null&&B.unshift(Cc(p,re,Y)),re=yr(p,y),re!=null&&B.push(Cc(p,re,Y))),p=p.return}return B}function Tc(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5);return p||null}function Ad(p,y,R,B,Y){for(var re=y._reactName,we=[];R!==null&&R!==B;){var at=R,vt=at.alternate,$t=at.stateNode;if(vt!==null&&vt===B)break;at.tag===5&&$t!==null&&(at=$t,Y?(vt=yr(R,re),vt!=null&&we.unshift(Cc(R,vt,at))):Y||(vt=yr(R,re),vt!=null&&we.push(Cc(R,vt,at)))),R=R.return}we.length!==0&&p.push({event:y,listeners:we})}var jf=/\r\n?/g,Pc=/\u0000|\uFFFD/g;function Ac(p){return(typeof p=="string"?p:""+p).replace(jf,`
`).replace(Pc,"")}function Sh(p,y,R){if(y=Ac(y),Ac(p)!==y&&R)throw Error(n(425))}function Hf(){}var Mu=null,Dm=null;function Gf(p,y){return p==="textarea"||p==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var Eu=typeof setTimeout=="function"?setTimeout:void 0,Wf=typeof clearTimeout=="function"?clearTimeout:void 0,Lm=typeof Promise=="function"?Promise:void 0,ev=typeof queueMicrotask=="function"?queueMicrotask:typeof Lm<"u"?function(p){return Lm.resolve(null).then(p).catch(Id)}:Eu;function Id(p){setTimeout(function(){throw p})}function Mh(p,y){var R=y,B=0;do{var Y=R.nextSibling;if(p.removeChild(R),Y&&Y.nodeType===8)if(R=Y.data,R==="/$"){if(B===0){p.removeChild(Y),Ea(y);return}B--}else R!=="$"&&R!=="$?"&&R!=="$!"||B++;R=Y}while(R);Ea(y)}function Fl(p){for(;p!=null;p=p.nextSibling){var y=p.nodeType;if(y===1||y===3)break;if(y===8){if(y=p.data,y==="$"||y==="$!"||y==="$?")break;if(y==="/$")return null}}return p}function km(p){p=p.previousSibling;for(var y=0;p;){if(p.nodeType===8){var R=p.data;if(R==="$"||R==="$!"||R==="$?"){if(y===0)return p;y--}else R==="/$"&&y++}p=p.previousSibling}return null}var li=Math.random().toString(36).slice(2),Wo="__reactFiber$"+li,Oo="__reactProps$"+li,ia="__reactContainer$"+li,Cu="__reactEvents$"+li,qf="__reactListeners$"+li,Ic="__reactHandles$"+li;function Ra(p){var y=p[Wo];if(y)return y;for(var R=p.parentNode;R;){if(y=R[ia]||R[Wo]){if(R=y.alternate,y.child!==null||R!==null&&R.child!==null)for(p=km(p);p!==null;){if(R=p[Wo])return R;p=km(p)}return y}p=R,R=p.parentNode}return null}function Da(p){return p=p[Wo]||p[ia],!p||p.tag!==5&&p.tag!==6&&p.tag!==13&&p.tag!==3?null:p}function La(p){if(p.tag===5||p.tag===6)return p.stateNode;throw Error(n(33))}function Rd(p){return p[Oo]||null}var Xf=[],Tu=-1;function Nl(p){return{current:p}}function yi(p){0>Tu||(p.current=Xf[Tu],Xf[Tu]=null,Tu--)}function Wr(p,y){Tu++,Xf[Tu]=p.current,p.current=y}var Qa={},Mo=Nl(Qa),Eo=Nl(!1),Rc=Qa;function Dc(p,y){var R=p.type.contextTypes;if(!R)return Qa;var B=p.stateNode;if(B&&B.__reactInternalMemoizedUnmaskedChildContext===y)return B.__reactInternalMemoizedMaskedChildContext;var Y={},re;for(re in R)Y[re]=y[re];return B&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=y,p.__reactInternalMemoizedMaskedChildContext=Y),Y}function qo(p){return p=p.childContextTypes,p!=null}function Dd(){yi(Eo),yi(Mo)}function Zf(p,y,R){if(Mo.current!==Qa)throw Error(n(168));Wr(Mo,y),Wr(Eo,R)}function Yf(p,y,R){var B=p.stateNode;if(y=y.childContextTypes,typeof B.getChildContext!="function")return R;B=B.getChildContext();for(var Y in B)if(!(Y in y))throw Error(n(108,ot(p)||"Unknown",Y));return nt({},R,B)}function ka(p){return p=(p=p.stateNode)&&p.__reactInternalMemoizedMergedChildContext||Qa,Rc=Mo.current,Wr(Mo,p),Wr(Eo,Eo.current),!0}function zm(p,y,R){var B=p.stateNode;if(!B)throw Error(n(169));R?(p=Yf(p,y,Rc),B.__reactInternalMemoizedMergedChildContext=p,yi(Eo),yi(Mo),Wr(Mo,p)):yi(Eo),Wr(Eo,R)}var ro=null,bs=!1,Kf=!1;function oa(p){ro===null?ro=[p]:ro.push(p)}function a0(p){bs=!0,oa(p)}function sa(){if(!Kf&&ro!==null){Kf=!0;var p=0,y=kr;try{var R=ro;for(kr=1;p<R.length;p++){var B=R[p];do B=B(!0);while(B!==null)}ro=null,bs=!1}catch(Y){throw ro!==null&&(ro=ro.slice(p+1)),fr(un,sa),Y}finally{kr=y,Kf=!1}}return null}var el=[],$i=0,Lc=null,Ld=0,aa=[],la=0,ca=null,ws=1,ho="";function Nn(p,y){el[$i++]=Ld,el[$i++]=Lc,Lc=p,Ld=y}function kd(p,y,R){aa[la++]=ws,aa[la++]=ho,aa[la++]=ca,ca=p;var B=ws;p=ho;var Y=32-Qn(B)-1;B&=~(1<<Y),R+=1;var re=32-Qn(y)+Y;if(30<re){var we=Y-Y%5;re=(B&(1<<we)-1).toString(32),B>>=we,Y-=we,ws=1<<32-Qn(y)+Y|R<<Y|B,ho=re+p}else ws=1<<re|R<<Y|B,ho=p}function zd(p){p.return!==null&&(Nn(p,1),kd(p,1,0))}function kc(p){for(;p===Lc;)Lc=el[--$i],el[$i]=null,Ld=el[--$i],el[$i]=null;for(;p===ca;)ca=aa[--la],aa[la]=null,ho=aa[--la],aa[la]=null,ws=aa[--la],aa[la]=null}var Fo=null,No=null,_i=!1,ls=null;function Jf(p,y){var R=dl(5,null,null,0);R.elementType="DELETED",R.stateNode=y,R.return=p,y=p.deletions,y===null?(p.deletions=[R],p.flags|=16):y.push(R)}function Om(p,y){switch(p.tag){case 5:var R=p.type;return y=y.nodeType!==1||R.toLowerCase()!==y.nodeName.toLowerCase()?null:y,y!==null?(p.stateNode=y,Fo=p,No=Fl(y.firstChild),!0):!1;case 6:return y=p.pendingProps===""||y.nodeType!==3?null:y,y!==null?(p.stateNode=y,Fo=p,No=null,!0):!1;case 13:return y=y.nodeType!==8?null:y,y!==null?(R=ca!==null?{id:ws,overflow:ho}:null,p.memoizedState={dehydrated:y,treeContext:R,retryLane:1073741824},R=dl(18,null,null,0),R.stateNode=y,R.return=p,p.child=R,Fo=p,No=null,!0):!1;default:return!1}}function zc(p){return(p.mode&1)!==0&&(p.flags&128)===0}function Fm(p){if(_i){var y=No;if(y){var R=y;if(!Om(p,y)){if(zc(p))throw Error(n(418));y=Fl(R.nextSibling);var B=Fo;y&&Om(p,y)?Jf(B,R):(p.flags=p.flags&-4097|2,_i=!1,Fo=p)}}else{if(zc(p))throw Error(n(418));p.flags=p.flags&-4097|2,_i=!1,Fo=p}}}function Od(p){for(p=p.return;p!==null&&p.tag!==5&&p.tag!==3&&p.tag!==13;)p=p.return;Fo=p}function Pu(p){if(p!==Fo)return!1;if(!_i)return Od(p),_i=!0,!1;var y;if((y=p.tag!==3)&&!(y=p.tag!==5)&&(y=p.type,y=y!=="head"&&y!=="body"&&!Gf(p.type,p.memoizedProps)),y&&(y=No)){if(zc(p))throw Nm(),Error(n(418));for(;y;)Jf(p,y),y=Fl(y.nextSibling)}if(Od(p),p.tag===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));e:{for(p=p.nextSibling,y=0;p;){if(p.nodeType===8){var R=p.data;if(R==="/$"){if(y===0){No=Fl(p.nextSibling);break e}y--}else R!=="$"&&R!=="$!"&&R!=="$?"||y++}p=p.nextSibling}No=null}}else No=Fo?Fl(p.stateNode.nextSibling):null;return!0}function Nm(){for(var p=No;p;)p=Fl(p.nextSibling)}function Oc(){No=Fo=null,_i=!1}function Qf(p){ls===null?ls=[p]:ls.push(p)}var Bm=X.ReactCurrentBatchConfig;function Au(p,y,R){if(p=R.ref,p!==null&&typeof p!="function"&&typeof p!="object"){if(R._owner){if(R=R._owner,R){if(R.tag!==1)throw Error(n(309));var B=R.stateNode}if(!B)throw Error(n(147,p));var Y=B,re=""+p;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===re?y.ref:(y=function(we){var at=Y.refs;we===null?delete at[re]:at[re]=we},y._stringRef=re,y)}if(typeof p!="string")throw Error(n(284));if(!R._owner)throw Error(n(290,p))}return p}function Fd(p,y){throw p=Object.prototype.toString.call(y),Error(n(31,p==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":p))}function Bl(p){var y=p._init;return y(p._payload)}function Jr(p){function y(kt,xt){if(p){var Ft=kt.deletions;Ft===null?(kt.deletions=[xt],kt.flags|=16):Ft.push(xt)}}function R(kt,xt){if(!p)return null;for(;xt!==null;)y(kt,xt),xt=xt.sibling;return null}function B(kt,xt){for(kt=new Map;xt!==null;)xt.key!==null?kt.set(xt.key,xt):kt.set(xt.index,xt),xt=xt.sibling;return kt}function Y(kt,xt){return kt=ju(kt,xt),kt.index=0,kt.sibling=null,kt}function re(kt,xt,Ft){return kt.index=Ft,p?(Ft=kt.alternate,Ft!==null?(Ft=Ft.index,Ft<xt?(kt.flags|=2,xt):Ft):(kt.flags|=2,xt)):(kt.flags|=1048576,xt)}function we(kt){return p&&kt.alternate===null&&(kt.flags|=2),kt}function at(kt,xt,Ft,zn){return xt===null||xt.tag!==6?(xt=dv(Ft,kt.mode,zn),xt.return=kt,xt):(xt=Y(xt,Ft),xt.return=kt,xt)}function vt(kt,xt,Ft,zn){var hr=Ft.type;return hr===J?wn(kt,xt,Ft.props.children,zn,Ft.key):xt!==null&&(xt.elementType===hr||typeof hr=="object"&&hr!==null&&hr.$$typeof===Te&&Bl(hr)===xt.type)?(zn=Y(xt,Ft.props),zn.ref=Au(kt,xt,Ft),zn.return=kt,zn):(zn=vp(Ft.type,Ft.key,Ft.props,null,kt.mode,zn),zn.ref=Au(kt,xt,Ft),zn.return=kt,zn)}function $t(kt,xt,Ft,zn){return xt===null||xt.tag!==4||xt.stateNode.containerInfo!==Ft.containerInfo||xt.stateNode.implementation!==Ft.implementation?(xt=M0(Ft,kt.mode,zn),xt.return=kt,xt):(xt=Y(xt,Ft.children||[]),xt.return=kt,xt)}function wn(kt,xt,Ft,zn,hr){return xt===null||xt.tag!==7?(xt=Bh(Ft,kt.mode,zn,hr),xt.return=kt,xt):(xt=Y(xt,Ft),xt.return=kt,xt)}function Cn(kt,xt,Ft){if(typeof xt=="string"&&xt!==""||typeof xt=="number")return xt=dv(""+xt,kt.mode,Ft),xt.return=kt,xt;if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case K:return Ft=vp(xt.type,xt.key,xt.props,null,kt.mode,Ft),Ft.ref=Au(kt,null,xt),Ft.return=kt,Ft;case se:return xt=M0(xt,kt.mode,Ft),xt.return=kt,xt;case Te:var zn=xt._init;return Cn(kt,zn(xt._payload),Ft)}if(dn(xt)||Ue(xt))return xt=Bh(xt,kt.mode,Ft,null),xt.return=kt,xt;Fd(kt,xt)}return null}function bn(kt,xt,Ft,zn){var hr=xt!==null?xt.key:null;if(typeof Ft=="string"&&Ft!==""||typeof Ft=="number")return hr!==null?null:at(kt,xt,""+Ft,zn);if(typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case K:return Ft.key===hr?vt(kt,xt,Ft,zn):null;case se:return Ft.key===hr?$t(kt,xt,Ft,zn):null;case Te:return hr=Ft._init,bn(kt,xt,hr(Ft._payload),zn)}if(dn(Ft)||Ue(Ft))return hr!==null?null:wn(kt,xt,Ft,zn,null);Fd(kt,Ft)}return null}function tr(kt,xt,Ft,zn,hr){if(typeof zn=="string"&&zn!==""||typeof zn=="number")return kt=kt.get(Ft)||null,at(xt,kt,""+zn,hr);if(typeof zn=="object"&&zn!==null){switch(zn.$$typeof){case K:return kt=kt.get(zn.key===null?Ft:zn.key)||null,vt(xt,kt,zn,hr);case se:return kt=kt.get(zn.key===null?Ft:zn.key)||null,$t(xt,kt,zn,hr);case Te:var mr=zn._init;return tr(kt,xt,Ft,mr(zn._payload),hr)}if(dn(zn)||Ue(zn))return kt=kt.get(Ft)||null,wn(xt,kt,zn,hr,null);Fd(xt,zn)}return null}function sr(kt,xt,Ft,zn){for(var hr=null,mr=null,vr=xt,br=xt=0,Ko=null;vr!==null&&br<Ft.length;br++){vr.index>br?(Ko=vr,vr=null):Ko=vr.sibling;var Qr=bn(kt,vr,Ft[br],zn);if(Qr===null){vr===null&&(vr=Ko);break}p&&vr&&Qr.alternate===null&&y(kt,vr),xt=re(Qr,xt,br),mr===null?hr=Qr:mr.sibling=Qr,mr=Qr,vr=Ko}if(br===Ft.length)return R(kt,vr),_i&&Nn(kt,br),hr;if(vr===null){for(;br<Ft.length;br++)vr=Cn(kt,Ft[br],zn),vr!==null&&(xt=re(vr,xt,br),mr===null?hr=vr:mr.sibling=vr,mr=vr);return _i&&Nn(kt,br),hr}for(vr=B(kt,vr);br<Ft.length;br++)Ko=tr(vr,kt,br,Ft[br],zn),Ko!==null&&(p&&Ko.alternate!==null&&vr.delete(Ko.key===null?br:Ko.key),xt=re(Ko,xt,br),mr===null?hr=Ko:mr.sibling=Ko,mr=Ko);return p&&vr.forEach(function(Uh){return y(kt,Uh)}),_i&&Nn(kt,br),hr}function cr(kt,xt,Ft,zn){var hr=Ue(Ft);if(typeof hr!="function")throw Error(n(150));if(Ft=hr.call(Ft),Ft==null)throw Error(n(151));for(var mr=hr=null,vr=xt,br=xt=0,Ko=null,Qr=Ft.next();vr!==null&&!Qr.done;br++,Qr=Ft.next()){vr.index>br?(Ko=vr,vr=null):Ko=vr.sibling;var Uh=bn(kt,vr,Qr.value,zn);if(Uh===null){vr===null&&(vr=Ko);break}p&&vr&&Uh.alternate===null&&y(kt,vr),xt=re(Uh,xt,br),mr===null?hr=Uh:mr.sibling=Uh,mr=Uh,vr=Ko}if(Qr.done)return R(kt,vr),_i&&Nn(kt,br),hr;if(vr===null){for(;!Qr.done;br++,Qr=Ft.next())Qr=Cn(kt,Qr.value,zn),Qr!==null&&(xt=re(Qr,xt,br),mr===null?hr=Qr:mr.sibling=Qr,mr=Qr);return _i&&Nn(kt,br),hr}for(vr=B(kt,vr);!Qr.done;br++,Qr=Ft.next())Qr=tr(vr,kt,br,Qr.value,zn),Qr!==null&&(p&&Qr.alternate!==null&&vr.delete(Qr.key===null?br:Qr.key),xt=re(Qr,xt,br),mr===null?hr=Qr:mr.sibling=Qr,mr=Qr);return p&&vr.forEach(function(I1){return y(kt,I1)}),_i&&Nn(kt,br),hr}function Yi(kt,xt,Ft,zn){if(typeof Ft=="object"&&Ft!==null&&Ft.type===J&&Ft.key===null&&(Ft=Ft.props.children),typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case K:e:{for(var hr=Ft.key,mr=xt;mr!==null;){if(mr.key===hr){if(hr=Ft.type,hr===J){if(mr.tag===7){R(kt,mr.sibling),xt=Y(mr,Ft.props.children),xt.return=kt,kt=xt;break e}}else if(mr.elementType===hr||typeof hr=="object"&&hr!==null&&hr.$$typeof===Te&&Bl(hr)===mr.type){R(kt,mr.sibling),xt=Y(mr,Ft.props),xt.ref=Au(kt,mr,Ft),xt.return=kt,kt=xt;break e}R(kt,mr);break}else y(kt,mr);mr=mr.sibling}Ft.type===J?(xt=Bh(Ft.props.children,kt.mode,zn,Ft.key),xt.return=kt,kt=xt):(zn=vp(Ft.type,Ft.key,Ft.props,null,kt.mode,zn),zn.ref=Au(kt,xt,Ft),zn.return=kt,kt=zn)}return we(kt);case se:e:{for(mr=Ft.key;xt!==null;){if(xt.key===mr)if(xt.tag===4&&xt.stateNode.containerInfo===Ft.containerInfo&&xt.stateNode.implementation===Ft.implementation){R(kt,xt.sibling),xt=Y(xt,Ft.children||[]),xt.return=kt,kt=xt;break e}else{R(kt,xt);break}else y(kt,xt);xt=xt.sibling}xt=M0(Ft,kt.mode,zn),xt.return=kt,kt=xt}return we(kt);case Te:return mr=Ft._init,Yi(kt,xt,mr(Ft._payload),zn)}if(dn(Ft))return sr(kt,xt,Ft,zn);if(Ue(Ft))return cr(kt,xt,Ft,zn);Fd(kt,Ft)}return typeof Ft=="string"&&Ft!==""||typeof Ft=="number"?(Ft=""+Ft,xt!==null&&xt.tag===6?(R(kt,xt.sibling),xt=Y(xt,Ft),xt.return=kt,kt=xt):(R(kt,xt),xt=dv(Ft,kt.mode,zn),xt.return=kt,kt=xt),we(kt)):R(kt,xt)}return Yi}var Eh=Jr(!0),Ch=Jr(!1),Iu=Nl(null),Ru=null,Fc=null,ep=null;function tp(){ep=Fc=Ru=null}function np(p){var y=Iu.current;yi(Iu),p._currentValue=y}function Vs(p,y,R){for(;p!==null;){var B=p.alternate;if((p.childLanes&y)!==y?(p.childLanes|=y,B!==null&&(B.childLanes|=y)):B!==null&&(B.childLanes&y)!==y&&(B.childLanes|=y),p===R)break;p=p.return}}function tl(p,y){Ru=p,ep=Fc=null,p=p.dependencies,p!==null&&p.firstContext!==null&&((p.lanes&y)!==0&&(us=!0),p.firstContext=null)}function Vn(p){var y=p._currentValue;if(ep!==p)if(p={context:p,memoizedValue:y,next:null},Fc===null){if(Ru===null)throw Error(n(308));Fc=p,Ru.dependencies={lanes:0,firstContext:p}}else Fc=Fc.next=p;return y}var rr=null;function Du(p){rr===null?rr=[p]:rr.push(p)}function Nd(p,y,R,B){var Y=y.interleaved;return Y===null?(R.next=R,Du(y)):(R.next=Y.next,Y.next=R),y.interleaved=R,ua(p,B)}function ua(p,y){p.lanes|=y;var R=p.alternate;for(R!==null&&(R.lanes|=y),R=p,p=p.return;p!==null;)p.childLanes|=y,R=p.alternate,R!==null&&(R.childLanes|=y),R=p,p=p.return;return R.tag===3?R.stateNode:null}var Wi=!1;function Ss(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rp(p,y){p=p.updateQueue,y.updateQueue===p&&(y.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,effects:p.effects})}function nl(p,y){return{eventTime:p,lane:y,tag:0,payload:null,callback:null,next:null}}function Nc(p,y,R){var B=p.updateQueue;if(B===null)return null;if(B=B.shared,(Kr&2)!==0){var Y=B.pending;return Y===null?y.next=y:(y.next=Y.next,Y.next=y),B.pending=y,ua(p,R)}return Y=B.interleaved,Y===null?(y.next=y,Du(B)):(y.next=Y.next,Y.next=y),B.interleaved=y,ua(p,R)}function ip(p,y,R){if(y=y.updateQueue,y!==null&&(y=y.shared,(R&4194240)!==0)){var B=y.lanes;B&=p.pendingLanes,R|=B,y.lanes=R,xo(p,R)}}function Th(p,y){var R=p.updateQueue,B=p.alternate;if(B!==null&&(B=B.updateQueue,R===B)){var Y=null,re=null;if(R=R.firstBaseUpdate,R!==null){do{var we={eventTime:R.eventTime,lane:R.lane,tag:R.tag,payload:R.payload,callback:R.callback,next:null};re===null?Y=re=we:re=re.next=we,R=R.next}while(R!==null);re===null?Y=re=y:re=re.next=y}else Y=re=y;R={baseState:B.baseState,firstBaseUpdate:Y,lastBaseUpdate:re,shared:B.shared,effects:B.effects},p.updateQueue=R;return}p=R.lastBaseUpdate,p===null?R.firstBaseUpdate=y:p.next=y,R.lastBaseUpdate=y}function ci(p,y,R,B){var Y=p.updateQueue;Wi=!1;var re=Y.firstBaseUpdate,we=Y.lastBaseUpdate,at=Y.shared.pending;if(at!==null){Y.shared.pending=null;var vt=at,$t=vt.next;vt.next=null,we===null?re=$t:we.next=$t,we=vt;var wn=p.alternate;wn!==null&&(wn=wn.updateQueue,at=wn.lastBaseUpdate,at!==we&&(at===null?wn.firstBaseUpdate=$t:at.next=$t,wn.lastBaseUpdate=vt))}if(re!==null){var Cn=Y.baseState;we=0,wn=$t=vt=null,at=re;do{var bn=at.lane,tr=at.eventTime;if((B&bn)===bn){wn!==null&&(wn=wn.next={eventTime:tr,lane:0,tag:at.tag,payload:at.payload,callback:at.callback,next:null});e:{var sr=p,cr=at;switch(bn=y,tr=R,cr.tag){case 1:if(sr=cr.payload,typeof sr=="function"){Cn=sr.call(tr,Cn,bn);break e}Cn=sr;break e;case 3:sr.flags=sr.flags&-65537|128;case 0:if(sr=cr.payload,bn=typeof sr=="function"?sr.call(tr,Cn,bn):sr,bn==null)break e;Cn=nt({},Cn,bn);break e;case 2:Wi=!0}}at.callback!==null&&at.lane!==0&&(p.flags|=64,bn=Y.effects,bn===null?Y.effects=[at]:bn.push(at))}else tr={eventTime:tr,lane:bn,tag:at.tag,payload:at.payload,callback:at.callback,next:null},wn===null?($t=wn=tr,vt=Cn):wn=wn.next=tr,we|=bn;if(at=at.next,at===null){if(at=Y.shared.pending,at===null)break;bn=at,at=bn.next,bn.next=null,Y.lastBaseUpdate=bn,Y.shared.pending=null}}while(!0);if(wn===null&&(vt=Cn),Y.baseState=vt,Y.firstBaseUpdate=$t,Y.lastBaseUpdate=wn,y=Y.shared.interleaved,y!==null){Y=y;do we|=Y.lane,Y=Y.next;while(Y!==y)}else re===null&&(Y.shared.lanes=0);Rh|=we,p.lanes=we,p.memoizedState=Cn}}function Vi(p,y,R){if(p=y.effects,y.effects=null,p!==null)for(y=0;y<p.length;y++){var B=p[y],Y=B.callback;if(Y!==null){if(B.callback=null,B=R,typeof Y!="function")throw Error(n(191,Y));Y.call(B)}}}var za={},Ms=Nl(za),Bc=Nl(za),Lu=Nl(za);function rl(p){if(p===za)throw Error(n(174));return p}function Bd(p,y){switch(Wr(Lu,y),Wr(Bc,p),Wr(Ms,za),p=y.nodeType,p){case 9:case 11:y=(y=y.documentElement)?y.namespaceURI:yn(null,"");break;default:p=p===8?y.parentNode:y,y=p.namespaceURI||null,p=p.tagName,y=yn(y,p)}yi(Ms),Wr(Ms,y)}function il(){yi(Ms),yi(Bc),yi(Lu)}function ol(p){rl(Lu.current);var y=rl(Ms.current),R=yn(y,p.type);y!==R&&(Wr(Bc,p),Wr(Ms,R))}function Ph(p){Bc.current===p&&(yi(Ms),yi(Bc))}var ui=Nl(0);function ku(p){for(var y=p;y!==null;){if(y.tag===13){var R=y.memoizedState;if(R!==null&&(R=R.dehydrated,R===null||R.data==="$?"||R.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var zu=[];function Ud(){for(var p=0;p<zu.length;p++)zu[p]._workInProgressVersionPrimary=null;zu.length=0}var Ul=X.ReactCurrentDispatcher,$l=X.ReactCurrentBatchConfig,Vl=0,hi=null,Ri=null,io=null,Ou=!1,Uc=!1,Fu=0,E=0;function o(){throw Error(n(321))}function d(p,y){if(y===null)return!1;for(var R=0;R<y.length&&R<p.length;R++)if(!Aa(p[R],y[R]))return!1;return!0}function g(p,y,R,B,Y,re){if(Vl=re,hi=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,Ul.current=p===null||p.memoizedState===null?Di:Co,p=R(B,Y),Uc){re=0;do{if(Uc=!1,Fu=0,25<=re)throw Error(n(301));re+=1,io=Ri=null,y.updateQueue=null,Ul.current=Xi,p=R(B,Y)}while(Uc)}if(Ul.current=wi,y=Ri!==null&&Ri.next!==null,Vl=0,io=Ri=hi=null,Ou=!1,y)throw Error(n(300));return p}function x(){var p=Fu!==0;return Fu=0,p}function T(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return io===null?hi.memoizedState=io=p:io=io.next=p,io}function D(){if(Ri===null){var p=hi.alternate;p=p!==null?p.memoizedState:null}else p=Ri.next;var y=io===null?hi.memoizedState:io.next;if(y!==null)io=y,Ri=p;else{if(p===null)throw Error(n(310));Ri=p,p={memoizedState:Ri.memoizedState,baseState:Ri.baseState,baseQueue:Ri.baseQueue,queue:Ri.queue,next:null},io===null?hi.memoizedState=io=p:io=io.next=p}return io}function N(p,y){return typeof y=="function"?y(p):y}function V(p){var y=D(),R=y.queue;if(R===null)throw Error(n(311));R.lastRenderedReducer=p;var B=Ri,Y=B.baseQueue,re=R.pending;if(re!==null){if(Y!==null){var we=Y.next;Y.next=re.next,re.next=we}B.baseQueue=Y=re,R.pending=null}if(Y!==null){re=Y.next,B=B.baseState;var at=we=null,vt=null,$t=re;do{var wn=$t.lane;if((Vl&wn)===wn)vt!==null&&(vt=vt.next={lane:0,action:$t.action,hasEagerState:$t.hasEagerState,eagerState:$t.eagerState,next:null}),B=$t.hasEagerState?$t.eagerState:p(B,$t.action);else{var Cn={lane:wn,action:$t.action,hasEagerState:$t.hasEagerState,eagerState:$t.eagerState,next:null};vt===null?(at=vt=Cn,we=B):vt=vt.next=Cn,hi.lanes|=wn,Rh|=wn}$t=$t.next}while($t!==null&&$t!==re);vt===null?we=B:vt.next=at,Aa(B,y.memoizedState)||(us=!0),y.memoizedState=B,y.baseState=we,y.baseQueue=vt,R.lastRenderedState=B}if(p=R.interleaved,p!==null){Y=p;do re=Y.lane,hi.lanes|=re,Rh|=re,Y=Y.next;while(Y!==p)}else Y===null&&(R.lanes=0);return[y.memoizedState,R.dispatch]}function Z(p){var y=D(),R=y.queue;if(R===null)throw Error(n(311));R.lastRenderedReducer=p;var B=R.dispatch,Y=R.pending,re=y.memoizedState;if(Y!==null){R.pending=null;var we=Y=Y.next;do re=p(re,we.action),we=we.next;while(we!==Y);Aa(re,y.memoizedState)||(us=!0),y.memoizedState=re,y.baseQueue===null&&(y.baseState=re),R.lastRenderedState=re}return[re,B]}function Q(){}function ce(p,y){var R=hi,B=D(),Y=y(),re=!Aa(B.memoizedState,Y);if(re&&(B.memoizedState=Y,us=!0),B=B.queue,Qe(be.bind(null,R,B,p),[p]),B.getSnapshot!==y||re||io!==null&&io.memoizedState.tag&1){if(R.flags|=2048,qe(9,ge.bind(null,R,B,Y,y),void 0,null),Yo===null)throw Error(n(349));(Vl&30)!==0||le(R,y,Y)}return Y}function le(p,y,R){p.flags|=16384,p={getSnapshot:y,value:R},y=hi.updateQueue,y===null?(y={lastEffect:null,stores:null},hi.updateQueue=y,y.stores=[p]):(R=y.stores,R===null?y.stores=[p]:R.push(p))}function ge(p,y,R,B){y.value=R,y.getSnapshot=B,ze(y)&&$e(p)}function be(p,y,R){return R(function(){ze(y)&&$e(p)})}function ze(p){var y=p.getSnapshot;p=p.value;try{var R=y();return!Aa(p,R)}catch{return!0}}function $e(p){var y=ua(p,1);y!==null&&Zl(y,p,1,-1)}function Ne(p){var y=T();return typeof p=="function"&&(p=p()),y.memoizedState=y.baseState=p,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:N,lastRenderedState:p},y.queue=p,p=p.dispatch=xi.bind(null,hi,p),[y.memoizedState,p]}function qe(p,y,R,B){return p={tag:p,create:y,destroy:R,deps:B,next:null},y=hi.updateQueue,y===null?(y={lastEffect:null,stores:null},hi.updateQueue=y,y.lastEffect=p.next=p):(R=y.lastEffect,R===null?y.lastEffect=p.next=p:(B=R.next,R.next=p,p.next=B,y.lastEffect=p)),p}function it(){return D().memoizedState}function Xe(p,y,R,B){var Y=T();hi.flags|=p,Y.memoizedState=qe(1|y,R,void 0,B===void 0?null:B)}function rt(p,y,R,B){var Y=D();B=B===void 0?null:B;var re=void 0;if(Ri!==null){var we=Ri.memoizedState;if(re=we.destroy,B!==null&&d(B,we.deps)){Y.memoizedState=qe(y,R,re,B);return}}hi.flags|=p,Y.memoizedState=qe(1|y,R,re,B)}function ht(p,y){return Xe(8390656,8,p,y)}function Qe(p,y){return rt(2048,8,p,y)}function yt(p,y){return rt(4,2,p,y)}function Ot(p,y){return rt(4,4,p,y)}function Pt(p,y){if(typeof y=="function")return p=p(),y(p),function(){y(null)};if(y!=null)return p=p(),y.current=p,function(){y.current=null}}function It(p,y,R){return R=R!=null?R.concat([p]):null,rt(4,4,Pt.bind(null,y,p),R)}function Dt(){}function gn(p,y){var R=D();y=y===void 0?null:y;var B=R.memoizedState;return B!==null&&y!==null&&d(y,B[1])?B[0]:(R.memoizedState=[p,y],p)}function xn(p,y){var R=D();y=y===void 0?null:y;var B=R.memoizedState;return B!==null&&y!==null&&d(y,B[1])?B[0]:(p=p(),R.memoizedState=[p,y],p)}function tn(p,y,R){return(Vl&21)===0?(p.baseState&&(p.baseState=!1,us=!0),p.memoizedState=R):(Aa(R,y)||(R=ei(),hi.lanes|=R,Rh|=R,p.baseState=!0),y)}function Dn(p,y){var R=kr;kr=R!==0&&4>R?R:4,p(!0);var B=$l.transition;$l.transition={};try{p(!1),y()}finally{kr=R,$l.transition=B}}function gr(){return D().memoizedState}function Yr(p,y,R){var B=fa(p);if(R={lane:B,action:R,hasEagerState:!1,eagerState:null,next:null},ni(p))bi(y,R);else if(R=Nd(p,y,R,B),R!==null){var Y=Ps();Zl(R,p,B,Y),ri(R,y,B)}}function xi(p,y,R){var B=fa(p),Y={lane:B,action:R,hasEagerState:!1,eagerState:null,next:null};if(ni(p))bi(y,Y);else{var re=p.alternate;if(p.lanes===0&&(re===null||re.lanes===0)&&(re=y.lastRenderedReducer,re!==null))try{var we=y.lastRenderedState,at=re(we,R);if(Y.hasEagerState=!0,Y.eagerState=at,Aa(at,we)){var vt=y.interleaved;vt===null?(Y.next=Y,Du(y)):(Y.next=vt.next,vt.next=Y),y.interleaved=Y;return}}catch{}finally{}R=Nd(p,y,Y,B),R!==null&&(Y=Ps(),Zl(R,p,B,Y),ri(R,y,B))}}function ni(p){var y=p.alternate;return p===hi||y!==null&&y===hi}function bi(p,y){Uc=Ou=!0;var R=p.pending;R===null?y.next=y:(y.next=R.next,R.next=y),p.pending=y}function ri(p,y,R){if((R&4194240)!==0){var B=y.lanes;B&=p.pendingLanes,R|=B,y.lanes=R,xo(p,R)}}var wi={readContext:Vn,useCallback:o,useContext:o,useEffect:o,useImperativeHandle:o,useInsertionEffect:o,useLayoutEffect:o,useMemo:o,useReducer:o,useRef:o,useState:o,useDebugValue:o,useDeferredValue:o,useTransition:o,useMutableSource:o,useSyncExternalStore:o,useId:o,unstable_isNewReconciler:!1},Di={readContext:Vn,useCallback:function(p,y){return T().memoizedState=[p,y===void 0?null:y],p},useContext:Vn,useEffect:ht,useImperativeHandle:function(p,y,R){return R=R!=null?R.concat([p]):null,Xe(4194308,4,Pt.bind(null,y,p),R)},useLayoutEffect:function(p,y){return Xe(4194308,4,p,y)},useInsertionEffect:function(p,y){return Xe(4,2,p,y)},useMemo:function(p,y){var R=T();return y=y===void 0?null:y,p=p(),R.memoizedState=[p,y],p},useReducer:function(p,y,R){var B=T();return y=R!==void 0?R(y):y,B.memoizedState=B.baseState=y,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:y},B.queue=p,p=p.dispatch=Yr.bind(null,hi,p),[B.memoizedState,p]},useRef:function(p){var y=T();return p={current:p},y.memoizedState=p},useState:Ne,useDebugValue:Dt,useDeferredValue:function(p){return T().memoizedState=p},useTransition:function(){var p=Ne(!1),y=p[0];return p=Dn.bind(null,p[1]),T().memoizedState=p,[y,p]},useMutableSource:function(){},useSyncExternalStore:function(p,y,R){var B=hi,Y=T();if(_i){if(R===void 0)throw Error(n(407));R=R()}else{if(R=y(),Yo===null)throw Error(n(349));(Vl&30)!==0||le(B,y,R)}Y.memoizedState=R;var re={value:R,getSnapshot:y};return Y.queue=re,ht(be.bind(null,B,re,p),[p]),B.flags|=2048,qe(9,ge.bind(null,B,re,R,y),void 0,null),R},useId:function(){var p=T(),y=Yo.identifierPrefix;if(_i){var R=ho,B=ws;R=(B&~(1<<32-Qn(B)-1)).toString(32)+R,y=":"+y+"R"+R,R=Fu++,0<R&&(y+="H"+R.toString(32)),y+=":"}else R=E++,y=":"+y+"r"+R.toString(32)+":";return p.memoizedState=y},unstable_isNewReconciler:!1},Co={readContext:Vn,useCallback:gn,useContext:Vn,useEffect:Qe,useImperativeHandle:It,useInsertionEffect:yt,useLayoutEffect:Ot,useMemo:xn,useReducer:V,useRef:it,useState:function(){return V(N)},useDebugValue:Dt,useDeferredValue:function(p){var y=D();return tn(y,Ri.memoizedState,p)},useTransition:function(){var p=V(N)[0],y=D().memoizedState;return[p,y]},useMutableSource:Q,useSyncExternalStore:ce,useId:gr,unstable_isNewReconciler:!1},Xi={readContext:Vn,useCallback:gn,useContext:Vn,useEffect:Qe,useImperativeHandle:It,useInsertionEffect:yt,useLayoutEffect:Ot,useMemo:xn,useReducer:Z,useRef:it,useState:function(){return Z(N)},useDebugValue:Dt,useDeferredValue:function(p){var y=D();return Ri===null?y.memoizedState=p:tn(y,Ri.memoizedState,p)},useTransition:function(){var p=Z(N)[0],y=D().memoizedState;return[p,y]},useMutableSource:Q,useSyncExternalStore:ce,useId:gr,unstable_isNewReconciler:!1};function qr(p,y){if(p&&p.defaultProps){y=nt({},y),p=p.defaultProps;for(var R in p)y[R]===void 0&&(y[R]=p[R]);return y}return y}function fo(p,y,R,B){y=p.memoizedState,R=R(B,y),R=R==null?y:nt({},y,R),p.memoizedState=R,p.lanes===0&&(p.updateQueue.baseState=R)}var Oa={isMounted:function(p){return(p=p._reactInternals)?ct(p)===p:!1},enqueueSetState:function(p,y,R){p=p._reactInternals;var B=Ps(),Y=fa(p),re=nl(B,Y);re.payload=y,R!=null&&(re.callback=R),y=Nc(p,re,Y),y!==null&&(Zl(y,p,Y,B),ip(y,p,Y))},enqueueReplaceState:function(p,y,R){p=p._reactInternals;var B=Ps(),Y=fa(p),re=nl(B,Y);re.tag=1,re.payload=y,R!=null&&(re.callback=R),y=Nc(p,re,Y),y!==null&&(Zl(y,p,Y,B),ip(y,p,Y))},enqueueForceUpdate:function(p,y){p=p._reactInternals;var R=Ps(),B=fa(p),Y=nl(R,B);Y.tag=2,y!=null&&(Y.callback=y),y=Nc(p,Y,B),y!==null&&(Zl(y,p,B,R),ip(y,p,B))}};function sl(p,y,R,B,Y,re,we){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(B,re,we):y.prototype&&y.prototype.isPureReactComponent?!_h(R,B)||!_h(Y,re):!0}function Fa(p,y,R){var B=!1,Y=Qa,re=y.contextType;return typeof re=="object"&&re!==null?re=Vn(re):(Y=qo(y)?Rc:Mo.current,B=y.contextTypes,re=(B=B!=null)?Dc(p,Y):Qa),y=new y(R,re),p.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Oa,p.stateNode=y,y._reactInternals=p,B&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=Y,p.__reactInternalMemoizedMaskedChildContext=re),y}function cs(p,y,R,B){p=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(R,B),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(R,B),y.state!==p&&Oa.enqueueReplaceState(y,y.state,null)}function jl(p,y,R,B){var Y=p.stateNode;Y.props=R,Y.state=p.memoizedState,Y.refs={},Ss(p);var re=y.contextType;typeof re=="object"&&re!==null?Y.context=Vn(re):(re=qo(y)?Rc:Mo.current,Y.context=Dc(p,re)),Y.state=p.memoizedState,re=y.getDerivedStateFromProps,typeof re=="function"&&(fo(p,y,re,R),Y.state=p.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof Y.getSnapshotBeforeUpdate=="function"||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(y=Y.state,typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount(),y!==Y.state&&Oa.enqueueReplaceState(Y,Y.state,null),ci(p,R,Y,B),Y.state=p.memoizedState),typeof Y.componentDidMount=="function"&&(p.flags|=4194308)}function al(p,y){try{var R="",B=y;do R+=pt(B),B=B.return;while(B);var Y=R}catch(re){Y=`
Error generating stack: `+re.message+`
`+re.stack}return{value:p,source:y,stack:Y,digest:null}}function Hl(p,y,R){return{value:p,source:null,stack:R??null,digest:y??null}}function Es(p,y){try{console.error(y.value)}catch(R){setTimeout(function(){throw R})}}var ll=typeof WeakMap=="function"?WeakMap:Map;function ha(p,y,R){R=nl(-1,R),R.tag=3,R.payload={element:null};var B=y.value;return R.callback=function(){Lh||(Lh=!0,av=B),Es(p,y)},R}function da(p,y,R){R=nl(-1,R),R.tag=3;var B=p.type.getDerivedStateFromError;if(typeof B=="function"){var Y=y.value;R.payload=function(){return B(Y)},R.callback=function(){Es(p,y)}}var re=p.stateNode;return re!==null&&typeof re.componentDidCatch=="function"&&(R.callback=function(){Es(p,y),typeof B!="function"&&($u===null?$u=new Set([this]):$u.add(this));var we=y.stack;this.componentDidCatch(y.value,{componentStack:we!==null?we:""})}),R}function si(p,y,R){var B=p.pingCache;if(B===null){B=p.pingCache=new ll;var Y=new Set;B.set(y,Y)}else Y=B.get(y),Y===void 0&&(Y=new Set,B.set(y,Y));Y.has(R)||(Y.add(R),p=x1.bind(null,p,y,R),y.then(p,p))}function ii(p){do{var y;if((y=p.tag===13)&&(y=p.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return p;p=p.return}while(p!==null);return null}function oo(p,y,R,B,Y){return(p.mode&1)===0?(p===y?p.flags|=65536:(p.flags|=128,R.flags|=131072,R.flags&=-52805,R.tag===1&&(R.alternate===null?R.tag=17:(y=nl(-1,1),y.tag=2,Nc(R,y,1))),R.lanes|=1),p):(p.flags|=65536,p.lanes=Y,p)}var po=X.ReactCurrentOwner,us=!1;function Xo(p,y,R,B){y.child=p===null?Ch(y,null,R,B):Eh(y,p.child,R,B)}function $c(p,y,R,B,Y){R=R.render;var re=y.ref;return tl(y,Y),B=g(p,y,R,B,re,Y),R=x(),p!==null&&!us?(y.updateQueue=p.updateQueue,y.flags&=-2053,p.lanes&=~Y,Bu(p,y,Y)):(_i&&R&&zd(y),y.flags|=1,Xo(p,y,B,Y),y.child)}function tv(p,y,R,B,Y){if(p===null){var re=R.type;return typeof re=="function"&&!S0(re)&&re.defaultProps===void 0&&R.compare===null&&R.defaultProps===void 0?(y.tag=15,y.type=re,Um(p,y,re,B,Y)):(p=vp(R.type,null,B,y,y.mode,Y),p.ref=y.ref,p.return=y,y.child=p)}if(re=p.child,(p.lanes&Y)===0){var we=re.memoizedProps;if(R=R.compare,R=R!==null?R:_h,R(we,B)&&p.ref===y.ref)return Bu(p,y,Y)}return y.flags|=1,p=ju(re,B),p.ref=y.ref,p.return=y,y.child=p}function Um(p,y,R,B,Y){if(p!==null){var re=p.memoizedProps;if(_h(re,B)&&p.ref===y.ref)if(us=!1,y.pendingProps=B=re,(p.lanes&Y)!==0)(p.flags&131072)!==0&&(us=!0);else return y.lanes=p.lanes,Bu(p,y,Y)}return cl(p,y,R,B,Y)}function op(p,y,R){var B=y.pendingProps,Y=B.children,re=p!==null?p.memoizedState:null;if(B.mode==="hidden")if((y.mode&1)===0)y.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wr(pp,Ba),Ba|=R;else{if((R&1073741824)===0)return p=re!==null?re.baseLanes|R:R,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:p,cachePool:null,transitions:null},y.updateQueue=null,Wr(pp,Ba),Ba|=p,null;y.memoizedState={baseLanes:0,cachePool:null,transitions:null},B=re!==null?re.baseLanes:R,Wr(pp,Ba),Ba|=B}else re!==null?(B=re.baseLanes|R,y.memoizedState=null):B=R,Wr(pp,Ba),Ba|=B;return Xo(p,y,Y,R),y.child}function Gl(p,y){var R=y.ref;(p===null&&R!==null||p!==null&&p.ref!==R)&&(y.flags|=512,y.flags|=2097152)}function cl(p,y,R,B,Y){var re=qo(R)?Rc:Mo.current;return re=Dc(y,re),tl(y,Y),R=g(p,y,R,B,re,Y),B=x(),p!==null&&!us?(y.updateQueue=p.updateQueue,y.flags&=-2053,p.lanes&=~Y,Bu(p,y,Y)):(_i&&B&&zd(y),y.flags|=1,Xo(p,y,R,Y),y.child)}function Wl(p,y,R,B,Y){if(qo(R)){var re=!0;ka(y)}else re=!1;if(tl(y,Y),y.stateNode===null)Nu(p,y),Fa(y,R,B),jl(y,R,B,Y),B=!0;else if(p===null){var we=y.stateNode,at=y.memoizedProps;we.props=at;var vt=we.context,$t=R.contextType;typeof $t=="object"&&$t!==null?$t=Vn($t):($t=qo(R)?Rc:Mo.current,$t=Dc(y,$t));var wn=R.getDerivedStateFromProps,Cn=typeof wn=="function"||typeof we.getSnapshotBeforeUpdate=="function";Cn||typeof we.UNSAFE_componentWillReceiveProps!="function"&&typeof we.componentWillReceiveProps!="function"||(at!==B||vt!==$t)&&cs(y,we,B,$t),Wi=!1;var bn=y.memoizedState;we.state=bn,ci(y,B,we,Y),vt=y.memoizedState,at!==B||bn!==vt||Eo.current||Wi?(typeof wn=="function"&&(fo(y,R,wn,B),vt=y.memoizedState),(at=Wi||sl(y,R,at,B,bn,vt,$t))?(Cn||typeof we.UNSAFE_componentWillMount!="function"&&typeof we.componentWillMount!="function"||(typeof we.componentWillMount=="function"&&we.componentWillMount(),typeof we.UNSAFE_componentWillMount=="function"&&we.UNSAFE_componentWillMount()),typeof we.componentDidMount=="function"&&(y.flags|=4194308)):(typeof we.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=B,y.memoizedState=vt),we.props=B,we.state=vt,we.context=$t,B=at):(typeof we.componentDidMount=="function"&&(y.flags|=4194308),B=!1)}else{we=y.stateNode,rp(p,y),at=y.memoizedProps,$t=y.type===y.elementType?at:qr(y.type,at),we.props=$t,Cn=y.pendingProps,bn=we.context,vt=R.contextType,typeof vt=="object"&&vt!==null?vt=Vn(vt):(vt=qo(R)?Rc:Mo.current,vt=Dc(y,vt));var tr=R.getDerivedStateFromProps;(wn=typeof tr=="function"||typeof we.getSnapshotBeforeUpdate=="function")||typeof we.UNSAFE_componentWillReceiveProps!="function"&&typeof we.componentWillReceiveProps!="function"||(at!==Cn||bn!==vt)&&cs(y,we,B,vt),Wi=!1,bn=y.memoizedState,we.state=bn,ci(y,B,we,Y);var sr=y.memoizedState;at!==Cn||bn!==sr||Eo.current||Wi?(typeof tr=="function"&&(fo(y,R,tr,B),sr=y.memoizedState),($t=Wi||sl(y,R,$t,B,bn,sr,vt)||!1)?(wn||typeof we.UNSAFE_componentWillUpdate!="function"&&typeof we.componentWillUpdate!="function"||(typeof we.componentWillUpdate=="function"&&we.componentWillUpdate(B,sr,vt),typeof we.UNSAFE_componentWillUpdate=="function"&&we.UNSAFE_componentWillUpdate(B,sr,vt)),typeof we.componentDidUpdate=="function"&&(y.flags|=4),typeof we.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof we.componentDidUpdate!="function"||at===p.memoizedProps&&bn===p.memoizedState||(y.flags|=4),typeof we.getSnapshotBeforeUpdate!="function"||at===p.memoizedProps&&bn===p.memoizedState||(y.flags|=1024),y.memoizedProps=B,y.memoizedState=sr),we.props=B,we.state=sr,we.context=vt,B=$t):(typeof we.componentDidUpdate!="function"||at===p.memoizedProps&&bn===p.memoizedState||(y.flags|=4),typeof we.getSnapshotBeforeUpdate!="function"||at===p.memoizedProps&&bn===p.memoizedState||(y.flags|=1024),B=!1)}return $d(p,y,R,B,re,Y)}function $d(p,y,R,B,Y,re){Gl(p,y);var we=(y.flags&128)!==0;if(!B&&!we)return Y&&zm(y,R,!1),Bu(p,y,re);B=y.stateNode,po.current=y;var at=we&&typeof R.getDerivedStateFromError!="function"?null:B.render();return y.flags|=1,p!==null&&we?(y.child=Eh(y,p.child,null,re),y.child=Eh(y,null,at,re)):Xo(p,y,at,re),y.memoizedState=B.state,Y&&zm(y,R,!0),y.child}function sp(p){var y=p.stateNode;y.pendingContext?Zf(p,y.pendingContext,y.pendingContext!==y.context):y.context&&Zf(p,y.context,!1),Bd(p,y.containerInfo)}function Vd(p,y,R,B,Y){return Oc(),Qf(Y),y.flags|=256,Xo(p,y,R,B),y.child}var Ah={dehydrated:null,treeContext:null,retryLane:0};function ap(p){return{baseLanes:p,cachePool:null,transitions:null}}function l0(p,y,R){var B=y.pendingProps,Y=ui.current,re=!1,we=(y.flags&128)!==0,at;if((at=we)||(at=p!==null&&p.memoizedState===null?!1:(Y&2)!==0),at?(re=!0,y.flags&=-129):(p===null||p.memoizedState!==null)&&(Y|=1),Wr(ui,Y&1),p===null)return Fm(y),p=y.memoizedState,p!==null&&(p=p.dehydrated,p!==null)?((y.mode&1)===0?y.lanes=1:p.data==="$!"?y.lanes=8:y.lanes=1073741824,null):(we=B.children,p=B.fallback,re?(B=y.mode,re=y.child,we={mode:"hidden",children:we},(B&1)===0&&re!==null?(re.childLanes=0,re.pendingProps=we):re=Ym(we,B,0,null),p=Bh(p,B,R,null),re.return=y,p.return=y,re.sibling=p,y.child=re,y.child.memoizedState=ap(R),y.memoizedState=Ah,p):c0(y,we));if(Y=p.memoizedState,Y!==null&&(at=Y.dehydrated,at!==null))return v2(p,y,we,B,at,Y,R);if(re){re=B.fallback,we=y.mode,Y=p.child,at=Y.sibling;var vt={mode:"hidden",children:B.children};return(we&1)===0&&y.child!==Y?(B=y.child,B.childLanes=0,B.pendingProps=vt,y.deletions=null):(B=ju(Y,vt),B.subtreeFlags=Y.subtreeFlags&14680064),at!==null?re=ju(at,re):(re=Bh(re,we,R,null),re.flags|=2),re.return=y,B.return=y,B.sibling=re,y.child=B,B=re,re=y.child,we=p.child.memoizedState,we=we===null?ap(R):{baseLanes:we.baseLanes|R,cachePool:null,transitions:we.transitions},re.memoizedState=we,re.childLanes=p.childLanes&~R,y.memoizedState=Ah,B}return re=p.child,p=re.sibling,B=ju(re,{mode:"visible",children:B.children}),(y.mode&1)===0&&(B.lanes=R),B.return=y,B.sibling=null,p!==null&&(R=y.deletions,R===null?(y.deletions=[p],y.flags|=16):R.push(p)),y.child=B,y.memoizedState=null,B}function c0(p,y){return y=Ym({mode:"visible",children:y},p.mode,0,null),y.return=p,p.child=y}function lp(p,y,R,B){return B!==null&&Qf(B),Eh(y,p.child,null,R),p=c0(y,y.pendingProps.children),p.flags|=2,y.memoizedState=null,p}function v2(p,y,R,B,Y,re,we){if(R)return y.flags&256?(y.flags&=-257,B=Hl(Error(n(422))),lp(p,y,we,B)):y.memoizedState!==null?(y.child=p.child,y.flags|=128,null):(re=B.fallback,Y=y.mode,B=Ym({mode:"visible",children:B.children},Y,0,null),re=Bh(re,Y,we,null),re.flags|=2,B.return=y,re.return=y,B.sibling=re,y.child=B,(y.mode&1)!==0&&Eh(y,p.child,null,we),y.child.memoizedState=ap(we),y.memoizedState=Ah,re);if((y.mode&1)===0)return lp(p,y,we,null);if(Y.data==="$!"){if(B=Y.nextSibling&&Y.nextSibling.dataset,B)var at=B.dgst;return B=at,re=Error(n(419)),B=Hl(re,B,void 0),lp(p,y,we,B)}if(at=(we&p.childLanes)!==0,us||at){if(B=Yo,B!==null){switch(we&-we){case 4:Y=2;break;case 16:Y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Y=32;break;case 536870912:Y=268435456;break;default:Y=0}Y=(Y&(B.suspendedLanes|we))!==0?0:Y,Y!==0&&Y!==re.retryLane&&(re.retryLane=Y,ua(p,Y),Zl(B,p,Y,-1))}return x0(),B=Hl(Error(n(421))),lp(p,y,we,B)}return Y.data==="$?"?(y.flags|=128,y.child=p.child,y=w2.bind(null,p),Y._reactRetry=y,null):(p=re.treeContext,No=Fl(Y.nextSibling),Fo=y,_i=!0,ls=null,p!==null&&(aa[la++]=ws,aa[la++]=ho,aa[la++]=ca,ws=p.id,ho=p.overflow,ca=y),y=c0(y,B.children),y.flags|=4096,y)}function nv(p,y,R){p.lanes|=y;var B=p.alternate;B!==null&&(B.lanes|=y),Vs(p.return,y,R)}function rv(p,y,R,B,Y){var re=p.memoizedState;re===null?p.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:B,tail:R,tailMode:Y}:(re.isBackwards=y,re.rendering=null,re.renderingStartTime=0,re.last=B,re.tail=R,re.tailMode=Y)}function u0(p,y,R){var B=y.pendingProps,Y=B.revealOrder,re=B.tail;if(Xo(p,y,B.children,R),B=ui.current,(B&2)!==0)B=B&1|2,y.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=y.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&nv(p,R,y);else if(p.tag===19)nv(p,R,y);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===y)break e;for(;p.sibling===null;){if(p.return===null||p.return===y)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}B&=1}if(Wr(ui,B),(y.mode&1)===0)y.memoizedState=null;else switch(Y){case"forwards":for(R=y.child,Y=null;R!==null;)p=R.alternate,p!==null&&ku(p)===null&&(Y=R),R=R.sibling;R=Y,R===null?(Y=y.child,y.child=null):(Y=R.sibling,R.sibling=null),rv(y,!1,Y,R,re);break;case"backwards":for(R=null,Y=y.child,y.child=null;Y!==null;){if(p=Y.alternate,p!==null&&ku(p)===null){y.child=Y;break}p=Y.sibling,Y.sibling=R,R=Y,Y=p}rv(y,!0,R,null,re);break;case"together":rv(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function Nu(p,y){(y.mode&1)===0&&p!==null&&(p.alternate=null,y.alternate=null,y.flags|=2)}function Bu(p,y,R){if(p!==null&&(y.dependencies=p.dependencies),Rh|=y.lanes,(R&y.childLanes)===0)return null;if(p!==null&&y.child!==p.child)throw Error(n(153));if(y.child!==null){for(p=y.child,R=ju(p,p.pendingProps),y.child=R,R.return=y;p.sibling!==null;)p=p.sibling,R=R.sibling=ju(p,p.pendingProps),R.return=y;R.sibling=null}return y.child}function cp(p,y,R){switch(y.tag){case 3:sp(y),Oc();break;case 5:ol(y);break;case 1:qo(y.type)&&ka(y);break;case 4:Bd(y,y.stateNode.containerInfo);break;case 10:var B=y.type._context,Y=y.memoizedProps.value;Wr(Iu,B._currentValue),B._currentValue=Y;break;case 13:if(B=y.memoizedState,B!==null)return B.dehydrated!==null?(Wr(ui,ui.current&1),y.flags|=128,null):(R&y.child.childLanes)!==0?l0(p,y,R):(Wr(ui,ui.current&1),p=Bu(p,y,R),p!==null?p.sibling:null);Wr(ui,ui.current&1);break;case 19:if(B=(R&y.childLanes)!==0,(p.flags&128)!==0){if(B)return u0(p,y,R);y.flags|=128}if(Y=y.memoizedState,Y!==null&&(Y.rendering=null,Y.tail=null,Y.lastEffect=null),Wr(ui,ui.current),B)break;return null;case 22:case 23:return y.lanes=0,op(p,y,R)}return Bu(p,y,R)}var $m,up,s1,a1;$m=function(p,y){for(var R=y.child;R!==null;){if(R.tag===5||R.tag===6)p.appendChild(R.stateNode);else if(R.tag!==4&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===y)break;for(;R.sibling===null;){if(R.return===null||R.return===y)return;R=R.return}R.sibling.return=R.return,R=R.sibling}},up=function(){},s1=function(p,y,R,B){var Y=p.memoizedProps;if(Y!==B){p=y.stateNode,rl(Ms.current);var re=null;switch(R){case"input":Y=Ke(p,Y),B=Ke(p,B),re=[];break;case"select":Y=nt({},Y,{value:void 0}),B=nt({},B,{value:void 0}),re=[];break;case"textarea":Y=Se(p,Y),B=Se(p,B),re=[];break;default:typeof Y.onClick!="function"&&typeof B.onClick=="function"&&(p.onclick=Hf)}xe(R,B);var we;R=null;for($t in Y)if(!B.hasOwnProperty($t)&&Y.hasOwnProperty($t)&&Y[$t]!=null)if($t==="style"){var at=Y[$t];for(we in at)at.hasOwnProperty(we)&&(R||(R={}),R[we]="")}else $t!=="dangerouslySetInnerHTML"&&$t!=="children"&&$t!=="suppressContentEditableWarning"&&$t!=="suppressHydrationWarning"&&$t!=="autoFocus"&&(a.hasOwnProperty($t)?re||(re=[]):(re=re||[]).push($t,null));for($t in B){var vt=B[$t];if(at=Y?.[$t],B.hasOwnProperty($t)&&vt!==at&&(vt!=null||at!=null))if($t==="style")if(at){for(we in at)!at.hasOwnProperty(we)||vt&&vt.hasOwnProperty(we)||(R||(R={}),R[we]="");for(we in vt)vt.hasOwnProperty(we)&&at[we]!==vt[we]&&(R||(R={}),R[we]=vt[we])}else R||(re||(re=[]),re.push($t,R)),R=vt;else $t==="dangerouslySetInnerHTML"?(vt=vt?vt.__html:void 0,at=at?at.__html:void 0,vt!=null&&at!==vt&&(re=re||[]).push($t,vt)):$t==="children"?typeof vt!="string"&&typeof vt!="number"||(re=re||[]).push($t,""+vt):$t!=="suppressContentEditableWarning"&&$t!=="suppressHydrationWarning"&&(a.hasOwnProperty($t)?(vt!=null&&$t==="onScroll"&&Ii("scroll",p),re||at===vt||(re=[])):(re=re||[]).push($t,vt))}R&&(re=re||[]).push("style",R);var $t=re;(y.updateQueue=$t)&&(y.flags|=4)}},a1=function(p,y,R,B){R!==B&&(y.flags|=4)};function Vm(p,y){if(!_i)switch(p.tailMode){case"hidden":y=p.tail;for(var R=null;y!==null;)y.alternate!==null&&(R=y),y=y.sibling;R===null?p.tail=null:R.sibling=null;break;case"collapsed":R=p.tail;for(var B=null;R!==null;)R.alternate!==null&&(B=R),R=R.sibling;B===null?y||p.tail===null?p.tail=null:p.tail.sibling=null:B.sibling=null}}function Cs(p){var y=p.alternate!==null&&p.alternate.child===p.child,R=0,B=0;if(y)for(var Y=p.child;Y!==null;)R|=Y.lanes|Y.childLanes,B|=Y.subtreeFlags&14680064,B|=Y.flags&14680064,Y.return=p,Y=Y.sibling;else for(Y=p.child;Y!==null;)R|=Y.lanes|Y.childLanes,B|=Y.subtreeFlags,B|=Y.flags,Y.return=p,Y=Y.sibling;return p.subtreeFlags|=B,p.childLanes=R,y}function y2(p,y,R){var B=y.pendingProps;switch(kc(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cs(y),null;case 1:return qo(y.type)&&Dd(),Cs(y),null;case 3:return B=y.stateNode,il(),yi(Eo),yi(Mo),Ud(),B.pendingContext&&(B.context=B.pendingContext,B.pendingContext=null),(p===null||p.child===null)&&(Pu(y)?y.flags|=4:p===null||p.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,ls!==null&&(cv(ls),ls=null))),up(p,y),Cs(y),null;case 5:Ph(y);var Y=rl(Lu.current);if(R=y.type,p!==null&&y.stateNode!=null)s1(p,y,R,B,Y),p.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!B){if(y.stateNode===null)throw Error(n(166));return Cs(y),null}if(p=rl(Ms.current),Pu(y)){B=y.stateNode,R=y.type;var re=y.memoizedProps;switch(B[Wo]=y,B[Oo]=re,p=(y.mode&1)!==0,R){case"dialog":Ii("cancel",B),Ii("close",B);break;case"iframe":case"object":case"embed":Ii("load",B);break;case"video":case"audio":for(Y=0;Y<Pd.length;Y++)Ii(Pd[Y],B);break;case"source":Ii("error",B);break;case"img":case"image":case"link":Ii("error",B),Ii("load",B);break;case"details":Ii("toggle",B);break;case"input":An(B,re),Ii("invalid",B);break;case"select":B._wrapperState={wasMultiple:!!re.multiple},Ii("invalid",B);break;case"textarea":bt(B,re),Ii("invalid",B)}xe(R,re),Y=null;for(var we in re)if(re.hasOwnProperty(we)){var at=re[we];we==="children"?typeof at=="string"?B.textContent!==at&&(re.suppressHydrationWarning!==!0&&Sh(B.textContent,at,p),Y=["children",at]):typeof at=="number"&&B.textContent!==""+at&&(re.suppressHydrationWarning!==!0&&Sh(B.textContent,at,p),Y=["children",""+at]):a.hasOwnProperty(we)&&at!=null&&we==="onScroll"&&Ii("scroll",B)}switch(R){case"input":hn(B),Wt(B,re,!0);break;case"textarea":hn(B),jt(B);break;case"select":case"option":break;default:typeof re.onClick=="function"&&(B.onclick=Hf)}B=Y,y.updateQueue=B,B!==null&&(y.flags|=4)}else{we=Y.nodeType===9?Y:Y.ownerDocument,p==="http://www.w3.org/1999/xhtml"&&(p=Ut(R)),p==="http://www.w3.org/1999/xhtml"?R==="script"?(p=we.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild)):typeof B.is=="string"?p=we.createElement(R,{is:B.is}):(p=we.createElement(R),R==="select"&&(we=p,B.multiple?we.multiple=!0:B.size&&(we.size=B.size))):p=we.createElementNS(p,R),p[Wo]=y,p[Oo]=B,$m(p,y,!1,!1),y.stateNode=p;e:{switch(we=Ye(R,B),R){case"dialog":Ii("cancel",p),Ii("close",p),Y=B;break;case"iframe":case"object":case"embed":Ii("load",p),Y=B;break;case"video":case"audio":for(Y=0;Y<Pd.length;Y++)Ii(Pd[Y],p);Y=B;break;case"source":Ii("error",p),Y=B;break;case"img":case"image":case"link":Ii("error",p),Ii("load",p),Y=B;break;case"details":Ii("toggle",p),Y=B;break;case"input":An(p,B),Y=Ke(p,B),Ii("invalid",p);break;case"option":Y=B;break;case"select":p._wrapperState={wasMultiple:!!B.multiple},Y=nt({},B,{value:void 0}),Ii("invalid",p);break;case"textarea":bt(p,B),Y=Se(p,B),Ii("invalid",p);break;default:Y=B}xe(R,Y),at=Y;for(re in at)if(at.hasOwnProperty(re)){var vt=at[re];re==="style"?fe(p,vt):re==="dangerouslySetInnerHTML"?(vt=vt?vt.__html:void 0,vt!=null&&qt(p,vt)):re==="children"?typeof vt=="string"?(R!=="textarea"||vt!=="")&&Fn(p,vt):typeof vt=="number"&&Fn(p,""+vt):re!=="suppressContentEditableWarning"&&re!=="suppressHydrationWarning"&&re!=="autoFocus"&&(a.hasOwnProperty(re)?vt!=null&&re==="onScroll"&&Ii("scroll",p):vt!=null&&U(p,re,vt,we))}switch(R){case"input":hn(p),Wt(p,B,!1);break;case"textarea":hn(p),jt(p);break;case"option":B.value!=null&&p.setAttribute("value",""+et(B.value));break;case"select":p.multiple=!!B.multiple,re=B.value,re!=null?Ve(p,!!B.multiple,re,!1):B.defaultValue!=null&&Ve(p,!!B.multiple,B.defaultValue,!0);break;default:typeof Y.onClick=="function"&&(p.onclick=Hf)}switch(R){case"button":case"input":case"select":case"textarea":B=!!B.autoFocus;break e;case"img":B=!0;break e;default:B=!1}}B&&(y.flags|=4)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return Cs(y),null;case 6:if(p&&y.stateNode!=null)a1(p,y,p.memoizedProps,B);else{if(typeof B!="string"&&y.stateNode===null)throw Error(n(166));if(R=rl(Lu.current),rl(Ms.current),Pu(y)){if(B=y.stateNode,R=y.memoizedProps,B[Wo]=y,(re=B.nodeValue!==R)&&(p=Fo,p!==null))switch(p.tag){case 3:Sh(B.nodeValue,R,(p.mode&1)!==0);break;case 5:p.memoizedProps.suppressHydrationWarning!==!0&&Sh(B.nodeValue,R,(p.mode&1)!==0)}re&&(y.flags|=4)}else B=(R.nodeType===9?R:R.ownerDocument).createTextNode(B),B[Wo]=y,y.stateNode=B}return Cs(y),null;case 13:if(yi(ui),B=y.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(_i&&No!==null&&(y.mode&1)!==0&&(y.flags&128)===0)Nm(),Oc(),y.flags|=98560,re=!1;else if(re=Pu(y),B!==null&&B.dehydrated!==null){if(p===null){if(!re)throw Error(n(318));if(re=y.memoizedState,re=re!==null?re.dehydrated:null,!re)throw Error(n(317));re[Wo]=y}else Oc(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;Cs(y),re=!1}else ls!==null&&(cv(ls),ls=null),re=!0;if(!re)return y.flags&65536?y:null}return(y.flags&128)!==0?(y.lanes=R,y):(B=B!==null,B!==(p!==null&&p.memoizedState!==null)&&B&&(y.child.flags|=8192,(y.mode&1)!==0&&(p===null||(ui.current&1)!==0?mo===0&&(mo=3):x0())),y.updateQueue!==null&&(y.flags|=4),Cs(y),null);case 4:return il(),up(p,y),p===null&&bu(y.stateNode.containerInfo),Cs(y),null;case 10:return np(y.type._context),Cs(y),null;case 17:return qo(y.type)&&Dd(),Cs(y),null;case 19:if(yi(ui),re=y.memoizedState,re===null)return Cs(y),null;if(B=(y.flags&128)!==0,we=re.rendering,we===null)if(B)Vm(re,!1);else{if(mo!==0||p!==null&&(p.flags&128)!==0)for(p=y.child;p!==null;){if(we=ku(p),we!==null){for(y.flags|=128,Vm(re,!1),B=we.updateQueue,B!==null&&(y.updateQueue=B,y.flags|=4),y.subtreeFlags=0,B=R,R=y.child;R!==null;)re=R,p=B,re.flags&=14680066,we=re.alternate,we===null?(re.childLanes=0,re.lanes=p,re.child=null,re.subtreeFlags=0,re.memoizedProps=null,re.memoizedState=null,re.updateQueue=null,re.dependencies=null,re.stateNode=null):(re.childLanes=we.childLanes,re.lanes=we.lanes,re.child=we.child,re.subtreeFlags=0,re.deletions=null,re.memoizedProps=we.memoizedProps,re.memoizedState=we.memoizedState,re.updateQueue=we.updateQueue,re.type=we.type,p=we.dependencies,re.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext}),R=R.sibling;return Wr(ui,ui.current&1|2),y.child}p=p.sibling}re.tail!==null&&Et()>Uu&&(y.flags|=128,B=!0,Vm(re,!1),y.lanes=4194304)}else{if(!B)if(p=ku(we),p!==null){if(y.flags|=128,B=!0,R=p.updateQueue,R!==null&&(y.updateQueue=R,y.flags|=4),Vm(re,!0),re.tail===null&&re.tailMode==="hidden"&&!we.alternate&&!_i)return Cs(y),null}else 2*Et()-re.renderingStartTime>Uu&&R!==1073741824&&(y.flags|=128,B=!0,Vm(re,!1),y.lanes=4194304);re.isBackwards?(we.sibling=y.child,y.child=we):(R=re.last,R!==null?R.sibling=we:y.child=we,re.last=we)}return re.tail!==null?(y=re.tail,re.rendering=y,re.tail=y.sibling,re.renderingStartTime=Et(),y.sibling=null,R=ui.current,Wr(ui,B?R&1|2:R&1),y):(Cs(y),null);case 22:case 23:return y0(),B=y.memoizedState!==null,p!==null&&p.memoizedState!==null!==B&&(y.flags|=8192),B&&(y.mode&1)!==0?(Ba&1073741824)!==0&&(Cs(y),y.subtreeFlags&6&&(y.flags|=8192)):Cs(y),null;case 24:return null;case 25:return null}throw Error(n(156,y.tag))}function l1(p,y){switch(kc(y),y.tag){case 1:return qo(y.type)&&Dd(),p=y.flags,p&65536?(y.flags=p&-65537|128,y):null;case 3:return il(),yi(Eo),yi(Mo),Ud(),p=y.flags,(p&65536)!==0&&(p&128)===0?(y.flags=p&-65537|128,y):null;case 5:return Ph(y),null;case 13:if(yi(ui),p=y.memoizedState,p!==null&&p.dehydrated!==null){if(y.alternate===null)throw Error(n(340));Oc()}return p=y.flags,p&65536?(y.flags=p&-65537|128,y):null;case 19:return yi(ui),null;case 4:return il(),null;case 10:return np(y.type._context),null;case 22:case 23:return y0(),null;case 24:return null;default:return null}}var hp=!1,hs=!1,c1=typeof WeakSet=="function"?WeakSet:Set,ir=null;function dp(p,y){var R=p.ref;if(R!==null)if(typeof R=="function")try{R(null)}catch(B){Zi(p,y,B)}else R.current=null}function iv(p,y,R){try{R()}catch(B){Zi(p,y,B)}}var h0=!1;function _2(p,y){if(Mu=cu,p=Kg(),Ur(p)){if("selectionStart"in p)var R={start:p.selectionStart,end:p.selectionEnd};else e:{R=(R=p.ownerDocument)&&R.defaultView||window;var B=R.getSelection&&R.getSelection();if(B&&B.rangeCount!==0){R=B.anchorNode;var Y=B.anchorOffset,re=B.focusNode;B=B.focusOffset;try{R.nodeType,re.nodeType}catch{R=null;break e}var we=0,at=-1,vt=-1,$t=0,wn=0,Cn=p,bn=null;t:for(;;){for(var tr;Cn!==R||Y!==0&&Cn.nodeType!==3||(at=we+Y),Cn!==re||B!==0&&Cn.nodeType!==3||(vt=we+B),Cn.nodeType===3&&(we+=Cn.nodeValue.length),(tr=Cn.firstChild)!==null;)bn=Cn,Cn=tr;for(;;){if(Cn===p)break t;if(bn===R&&++$t===Y&&(at=we),bn===re&&++wn===B&&(vt=we),(tr=Cn.nextSibling)!==null)break;Cn=bn,bn=Cn.parentNode}Cn=tr}R=at===-1||vt===-1?null:{start:at,end:vt}}else R=null}R=R||{start:0,end:0}}else R=null;for(Dm={focusedElem:p,selectionRange:R},cu=!1,ir=y;ir!==null;)if(y=ir,p=y.child,(y.subtreeFlags&1028)!==0&&p!==null)p.return=y,ir=p;else for(;ir!==null;){y=ir;try{var sr=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(sr!==null){var cr=sr.memoizedProps,Yi=sr.memoizedState,kt=y.stateNode,xt=kt.getSnapshotBeforeUpdate(y.elementType===y.type?cr:qr(y.type,cr),Yi);kt.__reactInternalSnapshotBeforeUpdate=xt}break;case 3:var Ft=y.stateNode.containerInfo;Ft.nodeType===1?Ft.textContent="":Ft.nodeType===9&&Ft.documentElement&&Ft.removeChild(Ft.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(zn){Zi(y,y.return,zn)}if(p=y.sibling,p!==null){p.return=y.return,ir=p;break}ir=y.return}return sr=h0,h0=!1,sr}function jd(p,y,R){var B=y.updateQueue;if(B=B!==null?B.lastEffect:null,B!==null){var Y=B=B.next;do{if((Y.tag&p)===p){var re=Y.destroy;Y.destroy=void 0,re!==void 0&&iv(y,R,re)}Y=Y.next}while(Y!==B)}}function jm(p,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var R=y=y.next;do{if((R.tag&p)===p){var B=R.create;R.destroy=B()}R=R.next}while(R!==y)}}function Hm(p){var y=p.ref;if(y!==null){var R=p.stateNode;switch(p.tag){case 5:p=R;break;default:p=R}typeof y=="function"?y(p):y.current=p}}function fp(p){var y=p.alternate;y!==null&&(p.alternate=null,fp(y)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(y=p.stateNode,y!==null&&(delete y[Wo],delete y[Oo],delete y[Cu],delete y[qf],delete y[Ic])),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function Ts(p){return p.tag===5||p.tag===3||p.tag===4}function d0(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||Ts(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function Gm(p,y,R){var B=p.tag;if(B===5||B===6)p=p.stateNode,y?R.nodeType===8?R.parentNode.insertBefore(p,y):R.insertBefore(p,y):(R.nodeType===8?(y=R.parentNode,y.insertBefore(p,R)):(y=R,y.appendChild(p)),R=R._reactRootContainer,R!=null||y.onclick!==null||(y.onclick=Hf));else if(B!==4&&(p=p.child,p!==null))for(Gm(p,y,R),p=p.sibling;p!==null;)Gm(p,y,R),p=p.sibling}function f0(p,y,R){var B=p.tag;if(B===5||B===6)p=p.stateNode,y?R.insertBefore(p,y):R.appendChild(p);else if(B!==4&&(p=p.child,p!==null))for(f0(p,y,R),p=p.sibling;p!==null;)f0(p,y,R),p=p.sibling}var Zo=null,ql=!1;function Ih(p,y,R){for(R=R.child;R!==null;)p0(p,y,R),R=R.sibling}function p0(p,y,R){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(Wn,R)}catch{}switch(R.tag){case 5:hs||dp(R,y);case 6:var B=Zo,Y=ql;Zo=null,Ih(p,y,R),Zo=B,ql=Y,Zo!==null&&(ql?(p=Zo,R=R.stateNode,p.nodeType===8?p.parentNode.removeChild(R):p.removeChild(R)):Zo.removeChild(R.stateNode));break;case 18:Zo!==null&&(ql?(p=Zo,R=R.stateNode,p.nodeType===8?Mh(p.parentNode,R):p.nodeType===1&&Mh(p,R),Ea(p)):Mh(Zo,R.stateNode));break;case 4:B=Zo,Y=ql,Zo=R.stateNode.containerInfo,ql=!0,Ih(p,y,R),Zo=B,ql=Y;break;case 0:case 11:case 14:case 15:if(!hs&&(B=R.updateQueue,B!==null&&(B=B.lastEffect,B!==null))){Y=B=B.next;do{var re=Y,we=re.destroy;re=re.tag,we!==void 0&&((re&2)!==0||(re&4)!==0)&&iv(R,y,we),Y=Y.next}while(Y!==B)}Ih(p,y,R);break;case 1:if(!hs&&(dp(R,y),B=R.stateNode,typeof B.componentWillUnmount=="function"))try{B.props=R.memoizedProps,B.state=R.memoizedState,B.componentWillUnmount()}catch(at){Zi(R,y,at)}Ih(p,y,R);break;case 21:Ih(p,y,R);break;case 22:R.mode&1?(hs=(B=hs)||R.memoizedState!==null,Ih(p,y,R),hs=B):Ih(p,y,R);break;default:Ih(p,y,R)}}function u1(p){var y=p.updateQueue;if(y!==null){p.updateQueue=null;var R=p.stateNode;R===null&&(R=p.stateNode=new c1),y.forEach(function(B){var Y=Zm.bind(null,p,B);R.has(B)||(R.add(B),B.then(Y,Y))})}}function Na(p,y){var R=y.deletions;if(R!==null)for(var B=0;B<R.length;B++){var Y=R[B];try{var re=p,we=y,at=we;e:for(;at!==null;){switch(at.tag){case 5:Zo=at.stateNode,ql=!1;break e;case 3:Zo=at.stateNode.containerInfo,ql=!0;break e;case 4:Zo=at.stateNode.containerInfo,ql=!0;break e}at=at.return}if(Zo===null)throw Error(n(160));p0(re,we,Y),Zo=null,ql=!1;var vt=Y.alternate;vt!==null&&(vt.return=null),Y.return=null}catch($t){Zi(Y,y,$t)}}if(y.subtreeFlags&12854)for(y=y.child;y!==null;)m0(y,p),y=y.sibling}function m0(p,y){var R=p.alternate,B=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:if(Na(y,p),Xl(p),B&4){try{jd(3,p,p.return),jm(3,p)}catch(cr){Zi(p,p.return,cr)}try{jd(5,p,p.return)}catch(cr){Zi(p,p.return,cr)}}break;case 1:Na(y,p),Xl(p),B&512&&R!==null&&dp(R,R.return);break;case 5:if(Na(y,p),Xl(p),B&512&&R!==null&&dp(R,R.return),p.flags&32){var Y=p.stateNode;try{Fn(Y,"")}catch(cr){Zi(p,p.return,cr)}}if(B&4&&(Y=p.stateNode,Y!=null)){var re=p.memoizedProps,we=R!==null?R.memoizedProps:re,at=p.type,vt=p.updateQueue;if(p.updateQueue=null,vt!==null)try{at==="input"&&re.type==="radio"&&re.name!=null&&Gt(Y,re),Ye(at,we);var $t=Ye(at,re);for(we=0;we<vt.length;we+=2){var wn=vt[we],Cn=vt[we+1];wn==="style"?fe(Y,Cn):wn==="dangerouslySetInnerHTML"?qt(Y,Cn):wn==="children"?Fn(Y,Cn):U(Y,wn,Cn,$t)}switch(at){case"input":on(Y,re);break;case"textarea":Nt(Y,re);break;case"select":var bn=Y._wrapperState.wasMultiple;Y._wrapperState.wasMultiple=!!re.multiple;var tr=re.value;tr!=null?Ve(Y,!!re.multiple,tr,!1):bn!==!!re.multiple&&(re.defaultValue!=null?Ve(Y,!!re.multiple,re.defaultValue,!0):Ve(Y,!!re.multiple,re.multiple?[]:"",!1))}Y[Oo]=re}catch(cr){Zi(p,p.return,cr)}}break;case 6:if(Na(y,p),Xl(p),B&4){if(p.stateNode===null)throw Error(n(162));Y=p.stateNode,re=p.memoizedProps;try{Y.nodeValue=re}catch(cr){Zi(p,p.return,cr)}}break;case 3:if(Na(y,p),Xl(p),B&4&&R!==null&&R.memoizedState.isDehydrated)try{Ea(y.containerInfo)}catch(cr){Zi(p,p.return,cr)}break;case 4:Na(y,p),Xl(p);break;case 13:Na(y,p),Xl(p),Y=p.child,Y.flags&8192&&(re=Y.memoizedState!==null,Y.stateNode.isHidden=re,!re||Y.alternate!==null&&Y.alternate.memoizedState!==null||(sv=Et())),B&4&&u1(p);break;case 22:if(wn=R!==null&&R.memoizedState!==null,p.mode&1?(hs=($t=hs)||wn,Na(y,p),hs=$t):Na(y,p),Xl(p),B&8192){if($t=p.memoizedState!==null,(p.stateNode.isHidden=$t)&&!wn&&(p.mode&1)!==0)for(ir=p,wn=p.child;wn!==null;){for(Cn=ir=wn;ir!==null;){switch(bn=ir,tr=bn.child,bn.tag){case 0:case 11:case 14:case 15:jd(4,bn,bn.return);break;case 1:dp(bn,bn.return);var sr=bn.stateNode;if(typeof sr.componentWillUnmount=="function"){B=bn,R=bn.return;try{y=B,sr.props=y.memoizedProps,sr.state=y.memoizedState,sr.componentWillUnmount()}catch(cr){Zi(B,R,cr)}}break;case 5:dp(bn,bn.return);break;case 22:if(bn.memoizedState!==null){Wm(Cn);continue}}tr!==null?(tr.return=bn,ir=tr):Wm(Cn)}wn=wn.sibling}e:for(wn=null,Cn=p;;){if(Cn.tag===5){if(wn===null){wn=Cn;try{Y=Cn.stateNode,$t?(re=Y.style,typeof re.setProperty=="function"?re.setProperty("display","none","important"):re.display="none"):(at=Cn.stateNode,vt=Cn.memoizedProps.style,we=vt!=null&&vt.hasOwnProperty("display")?vt.display:null,at.style.display=oe("display",we))}catch(cr){Zi(p,p.return,cr)}}}else if(Cn.tag===6){if(wn===null)try{Cn.stateNode.nodeValue=$t?"":Cn.memoizedProps}catch(cr){Zi(p,p.return,cr)}}else if((Cn.tag!==22&&Cn.tag!==23||Cn.memoizedState===null||Cn===p)&&Cn.child!==null){Cn.child.return=Cn,Cn=Cn.child;continue}if(Cn===p)break e;for(;Cn.sibling===null;){if(Cn.return===null||Cn.return===p)break e;wn===Cn&&(wn=null),Cn=Cn.return}wn===Cn&&(wn=null),Cn.sibling.return=Cn.return,Cn=Cn.sibling}}break;case 19:Na(y,p),Xl(p),B&4&&u1(p);break;case 21:break;default:Na(y,p),Xl(p)}}function Xl(p){var y=p.flags;if(y&2){try{e:{for(var R=p.return;R!==null;){if(Ts(R)){var B=R;break e}R=R.return}throw Error(n(160))}switch(B.tag){case 5:var Y=B.stateNode;B.flags&32&&(Fn(Y,""),B.flags&=-33);var re=d0(p);f0(p,re,Y);break;case 3:case 4:var we=B.stateNode.containerInfo,at=d0(p);Gm(p,at,we);break;default:throw Error(n(161))}}catch(vt){Zi(p,p.return,vt)}p.flags&=-3}y&4096&&(p.flags&=-4097)}function x2(p,y,R){ir=p,h1(p)}function h1(p,y,R){for(var B=(p.mode&1)!==0;ir!==null;){var Y=ir,re=Y.child;if(Y.tag===22&&B){var we=Y.memoizedState!==null||hp;if(!we){var at=Y.alternate,vt=at!==null&&at.memoizedState!==null||hs;at=hp;var $t=hs;if(hp=we,(hs=vt)&&!$t)for(ir=Y;ir!==null;)we=ir,vt=we.child,we.tag===22&&we.memoizedState!==null?ov(Y):vt!==null?(vt.return=we,ir=vt):ov(Y);for(;re!==null;)ir=re,h1(re),re=re.sibling;ir=Y,hp=at,hs=$t}d1(p)}else(Y.subtreeFlags&8772)!==0&&re!==null?(re.return=Y,ir=re):d1(p)}}function d1(p){for(;ir!==null;){var y=ir;if((y.flags&8772)!==0){var R=y.alternate;try{if((y.flags&8772)!==0)switch(y.tag){case 0:case 11:case 15:hs||jm(5,y);break;case 1:var B=y.stateNode;if(y.flags&4&&!hs)if(R===null)B.componentDidMount();else{var Y=y.elementType===y.type?R.memoizedProps:qr(y.type,R.memoizedProps);B.componentDidUpdate(Y,R.memoizedState,B.__reactInternalSnapshotBeforeUpdate)}var re=y.updateQueue;re!==null&&Vi(y,re,B);break;case 3:var we=y.updateQueue;if(we!==null){if(R=null,y.child!==null)switch(y.child.tag){case 5:R=y.child.stateNode;break;case 1:R=y.child.stateNode}Vi(y,we,R)}break;case 5:var at=y.stateNode;if(R===null&&y.flags&4){R=at;var vt=y.memoizedProps;switch(y.type){case"button":case"input":case"select":case"textarea":vt.autoFocus&&R.focus();break;case"img":vt.src&&(R.src=vt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(y.memoizedState===null){var $t=y.alternate;if($t!==null){var wn=$t.memoizedState;if(wn!==null){var Cn=wn.dehydrated;Cn!==null&&Ea(Cn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}hs||y.flags&512&&Hm(y)}catch(bn){Zi(y,y.return,bn)}}if(y===p){ir=null;break}if(R=y.sibling,R!==null){R.return=y.return,ir=R;break}ir=y.return}}function Wm(p){for(;ir!==null;){var y=ir;if(y===p){ir=null;break}var R=y.sibling;if(R!==null){R.return=y.return,ir=R;break}ir=y.return}}function ov(p){for(;ir!==null;){var y=ir;try{switch(y.tag){case 0:case 11:case 15:var R=y.return;try{jm(4,y)}catch(vt){Zi(y,R,vt)}break;case 1:var B=y.stateNode;if(typeof B.componentDidMount=="function"){var Y=y.return;try{B.componentDidMount()}catch(vt){Zi(y,Y,vt)}}var re=y.return;try{Hm(y)}catch(vt){Zi(y,re,vt)}break;case 5:var we=y.return;try{Hm(y)}catch(vt){Zi(y,we,vt)}}}catch(vt){Zi(y,y.return,vt)}if(y===p){ir=null;break}var at=y.sibling;if(at!==null){at.return=y.return,ir=at;break}ir=y.return}}var f1=Math.ceil,Vc=X.ReactCurrentDispatcher,Hd=X.ReactCurrentOwner,ul=X.ReactCurrentBatchConfig,Kr=0,Yo=null,To=null,ds=0,Ba=0,pp=Nl(0),mo=0,qm=null,Rh=0,Dh=0,g0=0,Li=null,Bo=null,sv=0,Uu=1/0,hl=null,Lh=!1,av=null,$u=null,kh=!1,jc=null,Vu=0,zh=0,Oh=null,Fh=-1,lv=0;function Ps(){return(Kr&6)!==0?Et():Fh!==-1?Fh:Fh=Et()}function fa(p){return(p.mode&1)===0?1:(Kr&2)!==0&&ds!==0?ds&-ds:Bm.transition!==null?(lv===0&&(lv=ei()),lv):(p=kr,p!==0||(p=window.event,p=p===void 0?16:wc(p.type)),p)}function Zl(p,y,R,B){if(50<zh)throw zh=0,Oh=null,Error(n(185));eo(p,R,B),((Kr&2)===0||p!==Yo)&&(p===Yo&&((Kr&2)===0&&(Dh|=R),mo===4&&Nh(p,ds)),js(p,B),R===1&&Kr===0&&(y.mode&1)===0&&(Uu=Et()+500,bs&&sa()))}function js(p,y){var R=p.callbackNode;Go(p,y);var B=zo(p,p===Yo?ds:0);if(B===0)R!==null&&Re(R),p.callbackNode=null,p.callbackPriority=0;else if(y=B&-B,p.callbackPriority!==y){if(R!=null&&Re(R),y===1)p.tag===0?a0(m1.bind(null,p)):oa(m1.bind(null,p)),ev(function(){(Kr&6)===0&&sa()}),R=null;else{switch(Us(B)){case 1:R=un;break;case 4:R=_n;break;case 16:R=pn;break;case 536870912:R=mn;break;default:R=pn}R=w1(R,mp.bind(null,p))}p.callbackPriority=y,p.callbackNode=R}}function mp(p,y){if(Fh=-1,lv=0,(Kr&6)!==0)throw Error(n(327));var R=p.callbackNode;if(gp()&&p.callbackNode!==R)return null;var B=zo(p,p===Yo?ds:0);if(B===0)return null;if((B&30)!==0||(B&p.expiredLanes)!==0||y)y=uv(p,B);else{y=B;var Y=Kr;Kr|=2;var re=_0();(Yo!==p||ds!==y)&&(hl=null,Uu=Et()+500,Yl(p,y));do try{v1();break}catch(at){g1(p,at)}while(!0);tp(),Vc.current=re,Kr=Y,To!==null?y=0:(Yo=null,ds=0,y=mo)}if(y!==0){if(y===2&&(Y=ea(p),Y!==0&&(B=Y,y=Xm(p,Y))),y===1)throw R=qm,Yl(p,0),Nh(p,B),js(p,Et()),R;if(y===6)Nh(p,B);else{if(Y=p.current.alternate,(B&30)===0&&!p1(Y)&&(y=uv(p,B),y===2&&(re=ea(p),re!==0&&(B=re,y=Xm(p,re))),y===1))throw R=qm,Yl(p,0),Nh(p,B),js(p,Et()),R;switch(p.finishedWork=Y,p.finishedLanes=B,y){case 0:case 1:throw Error(n(345));case 2:Kl(p,Bo,hl);break;case 3:if(Nh(p,B),(B&130023424)===B&&(y=sv+500-Et(),10<y)){if(zo(p,0)!==0)break;if(Y=p.suspendedLanes,(Y&B)!==B){Ps(),p.pingedLanes|=p.suspendedLanes&Y;break}p.timeoutHandle=Eu(Kl.bind(null,p,Bo,hl),y);break}Kl(p,Bo,hl);break;case 4:if(Nh(p,B),(B&4194240)===B)break;for(y=p.eventTimes,Y=-1;0<B;){var we=31-Qn(B);re=1<<we,we=y[we],we>Y&&(Y=we),B&=~re}if(B=Y,B=Et()-B,B=(120>B?120:480>B?480:1080>B?1080:1920>B?1920:3e3>B?3e3:4320>B?4320:1960*f1(B/1960))-B,10<B){p.timeoutHandle=Eu(Kl.bind(null,p,Bo,hl),B);break}Kl(p,Bo,hl);break;case 5:Kl(p,Bo,hl);break;default:throw Error(n(329))}}}return js(p,Et()),p.callbackNode===R?mp.bind(null,p):null}function Xm(p,y){var R=Li;return p.current.memoizedState.isDehydrated&&(Yl(p,y).flags|=256),p=uv(p,y),p!==2&&(y=Bo,Bo=R,y!==null&&cv(y)),p}function cv(p){Bo===null?Bo=p:Bo.push.apply(Bo,p)}function p1(p){for(var y=p;;){if(y.flags&16384){var R=y.updateQueue;if(R!==null&&(R=R.stores,R!==null))for(var B=0;B<R.length;B++){var Y=R[B],re=Y.getSnapshot;Y=Y.value;try{if(!Aa(re(),Y))return!1}catch{return!1}}}if(R=y.child,y.subtreeFlags&16384&&R!==null)R.return=y,y=R;else{if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function Nh(p,y){for(y&=~g0,y&=~Dh,p.suspendedLanes|=y,p.pingedLanes&=~y,p=p.expirationTimes;0<y;){var R=31-Qn(y),B=1<<R;p[R]=-1,y&=~B}}function m1(p){if((Kr&6)!==0)throw Error(n(327));gp();var y=zo(p,0);if((y&1)===0)return js(p,Et()),null;var R=uv(p,y);if(p.tag!==0&&R===2){var B=ea(p);B!==0&&(y=B,R=Xm(p,B))}if(R===1)throw R=qm,Yl(p,0),Nh(p,y),js(p,Et()),R;if(R===6)throw Error(n(345));return p.finishedWork=p.current.alternate,p.finishedLanes=y,Kl(p,Bo,hl),js(p,Et()),null}function v0(p,y){var R=Kr;Kr|=1;try{return p(y)}finally{Kr=R,Kr===0&&(Uu=Et()+500,bs&&sa())}}function Gd(p){jc!==null&&jc.tag===0&&(Kr&6)===0&&gp();var y=Kr;Kr|=1;var R=ul.transition,B=kr;try{if(ul.transition=null,kr=1,p)return p()}finally{kr=B,ul.transition=R,Kr=y,(Kr&6)===0&&sa()}}function y0(){Ba=pp.current,yi(pp)}function Yl(p,y){p.finishedWork=null,p.finishedLanes=0;var R=p.timeoutHandle;if(R!==-1&&(p.timeoutHandle=-1,Wf(R)),To!==null)for(R=To.return;R!==null;){var B=R;switch(kc(B),B.tag){case 1:B=B.type.childContextTypes,B!=null&&Dd();break;case 3:il(),yi(Eo),yi(Mo),Ud();break;case 5:Ph(B);break;case 4:il();break;case 13:yi(ui);break;case 19:yi(ui);break;case 10:np(B.type._context);break;case 22:case 23:y0()}R=R.return}if(Yo=p,To=p=ju(p.current,null),ds=Ba=y,mo=0,qm=null,g0=Dh=Rh=0,Bo=Li=null,rr!==null){for(y=0;y<rr.length;y++)if(R=rr[y],B=R.interleaved,B!==null){R.interleaved=null;var Y=B.next,re=R.pending;if(re!==null){var we=re.next;re.next=Y,B.next=we}R.pending=B}rr=null}return p}function g1(p,y){do{var R=To;try{if(tp(),Ul.current=wi,Ou){for(var B=hi.memoizedState;B!==null;){var Y=B.queue;Y!==null&&(Y.pending=null),B=B.next}Ou=!1}if(Vl=0,io=Ri=hi=null,Uc=!1,Fu=0,Hd.current=null,R===null||R.return===null){mo=1,qm=y,To=null;break}e:{var re=p,we=R.return,at=R,vt=y;if(y=ds,at.flags|=32768,vt!==null&&typeof vt=="object"&&typeof vt.then=="function"){var $t=vt,wn=at,Cn=wn.tag;if((wn.mode&1)===0&&(Cn===0||Cn===11||Cn===15)){var bn=wn.alternate;bn?(wn.updateQueue=bn.updateQueue,wn.memoizedState=bn.memoizedState,wn.lanes=bn.lanes):(wn.updateQueue=null,wn.memoizedState=null)}var tr=ii(we);if(tr!==null){tr.flags&=-257,oo(tr,we,at,re,y),tr.mode&1&&si(re,$t,y),y=tr,vt=$t;var sr=y.updateQueue;if(sr===null){var cr=new Set;cr.add(vt),y.updateQueue=cr}else sr.add(vt);break e}else{if((y&1)===0){si(re,$t,y),x0();break e}vt=Error(n(426))}}else if(_i&&at.mode&1){var Yi=ii(we);if(Yi!==null){(Yi.flags&65536)===0&&(Yi.flags|=256),oo(Yi,we,at,re,y),Qf(al(vt,at));break e}}re=vt=al(vt,at),mo!==4&&(mo=2),Li===null?Li=[re]:Li.push(re),re=we;do{switch(re.tag){case 3:re.flags|=65536,y&=-y,re.lanes|=y;var kt=ha(re,vt,y);Th(re,kt);break e;case 1:at=vt;var xt=re.type,Ft=re.stateNode;if((re.flags&128)===0&&(typeof xt.getDerivedStateFromError=="function"||Ft!==null&&typeof Ft.componentDidCatch=="function"&&($u===null||!$u.has(Ft)))){re.flags|=65536,y&=-y,re.lanes|=y;var zn=da(re,at,y);Th(re,zn);break e}}re=re.return}while(re!==null)}hv(R)}catch(hr){y=hr,To===R&&R!==null&&(To=R=R.return);continue}break}while(!0)}function _0(){var p=Vc.current;return Vc.current=wi,p===null?wi:p}function x0(){(mo===0||mo===3||mo===2)&&(mo=4),Yo===null||(Rh&268435455)===0&&(Dh&268435455)===0||Nh(Yo,ds)}function uv(p,y){var R=Kr;Kr|=2;var B=_0();(Yo!==p||ds!==y)&&(hl=null,Yl(p,y));do try{b2();break}catch(Y){g1(p,Y)}while(!0);if(tp(),Kr=R,Vc.current=B,To!==null)throw Error(n(261));return Yo=null,ds=0,mo}function b2(){for(;To!==null;)y1(To)}function v1(){for(;To!==null&&!mt();)y1(To)}function y1(p){var y=w0(p.alternate,p,Ba);p.memoizedProps=p.pendingProps,y===null?hv(p):To=y,Hd.current=null}function hv(p){var y=p;do{var R=y.alternate;if(p=y.return,(y.flags&32768)===0){if(R=y2(R,y,Ba),R!==null){To=R;return}}else{if(R=l1(R,y),R!==null){R.flags&=32767,To=R;return}if(p!==null)p.flags|=32768,p.subtreeFlags=0,p.deletions=null;else{mo=6,To=null;return}}if(y=y.sibling,y!==null){To=y;return}To=y=p}while(y!==null);mo===0&&(mo=5)}function Kl(p,y,R){var B=kr,Y=ul.transition;try{ul.transition=null,kr=1,b0(p,y,R,B)}finally{ul.transition=Y,kr=B}return null}function b0(p,y,R,B){do gp();while(jc!==null);if((Kr&6)!==0)throw Error(n(327));R=p.finishedWork;var Y=p.finishedLanes;if(R===null)return null;if(p.finishedWork=null,p.finishedLanes=0,R===p.current)throw Error(n(177));p.callbackNode=null,p.callbackPriority=0;var re=R.lanes|R.childLanes;if(uo(p,re),p===Yo&&(To=Yo=null,ds=0),(R.subtreeFlags&2064)===0&&(R.flags&2064)===0||kh||(kh=!0,w1(pn,function(){return gp(),null})),re=(R.flags&15990)!==0,(R.subtreeFlags&15990)!==0||re){re=ul.transition,ul.transition=null;var we=kr;kr=1;var at=Kr;Kr|=4,Hd.current=null,_2(p,R),m0(R,p),zf(Dm),cu=!!Mu,Dm=Mu=null,p.current=R,x2(R),Lt(),Kr=at,kr=we,ul.transition=re}else p.current=R;if(kh&&(kh=!1,jc=p,Vu=Y),re=p.pendingLanes,re===0&&($u=null),Rn(R.stateNode),js(p,Et()),y!==null)for(B=p.onRecoverableError,R=0;R<y.length;R++)Y=y[R],B(Y.value,{componentStack:Y.stack,digest:Y.digest});if(Lh)throw Lh=!1,p=av,av=null,p;return(Vu&1)!==0&&p.tag!==0&&gp(),re=p.pendingLanes,(re&1)!==0?p===Oh?zh++:(zh=0,Oh=p):zh=0,sa(),null}function gp(){if(jc!==null){var p=Us(Vu),y=ul.transition,R=kr;try{if(ul.transition=null,kr=16>p?16:p,jc===null)var B=!1;else{if(p=jc,jc=null,Vu=0,(Kr&6)!==0)throw Error(n(331));var Y=Kr;for(Kr|=4,ir=p.current;ir!==null;){var re=ir,we=re.child;if((ir.flags&16)!==0){var at=re.deletions;if(at!==null){for(var vt=0;vt<at.length;vt++){var $t=at[vt];for(ir=$t;ir!==null;){var wn=ir;switch(wn.tag){case 0:case 11:case 15:jd(8,wn,re)}var Cn=wn.child;if(Cn!==null)Cn.return=wn,ir=Cn;else for(;ir!==null;){wn=ir;var bn=wn.sibling,tr=wn.return;if(fp(wn),wn===$t){ir=null;break}if(bn!==null){bn.return=tr,ir=bn;break}ir=tr}}}var sr=re.alternate;if(sr!==null){var cr=sr.child;if(cr!==null){sr.child=null;do{var Yi=cr.sibling;cr.sibling=null,cr=Yi}while(cr!==null)}}ir=re}}if((re.subtreeFlags&2064)!==0&&we!==null)we.return=re,ir=we;else e:for(;ir!==null;){if(re=ir,(re.flags&2048)!==0)switch(re.tag){case 0:case 11:case 15:jd(9,re,re.return)}var kt=re.sibling;if(kt!==null){kt.return=re.return,ir=kt;break e}ir=re.return}}var xt=p.current;for(ir=xt;ir!==null;){we=ir;var Ft=we.child;if((we.subtreeFlags&2064)!==0&&Ft!==null)Ft.return=we,ir=Ft;else e:for(we=xt;ir!==null;){if(at=ir,(at.flags&2048)!==0)try{switch(at.tag){case 0:case 11:case 15:jm(9,at)}}catch(hr){Zi(at,at.return,hr)}if(at===we){ir=null;break e}var zn=at.sibling;if(zn!==null){zn.return=at.return,ir=zn;break e}ir=at.return}}if(Kr=Y,sa(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(Wn,p)}catch{}B=!0}return B}finally{kr=R,ul.transition=y}}return!1}function _1(p,y,R){y=al(R,y),y=ha(p,y,1),p=Nc(p,y,1),y=Ps(),p!==null&&(eo(p,1,y),js(p,y))}function Zi(p,y,R){if(p.tag===3)_1(p,p,R);else for(;y!==null;){if(y.tag===3){_1(y,p,R);break}else if(y.tag===1){var B=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof B.componentDidCatch=="function"&&($u===null||!$u.has(B))){p=al(R,p),p=da(y,p,1),y=Nc(y,p,1),p=Ps(),y!==null&&(eo(y,1,p),js(y,p));break}}y=y.return}}function x1(p,y,R){var B=p.pingCache;B!==null&&B.delete(y),y=Ps(),p.pingedLanes|=p.suspendedLanes&R,Yo===p&&(ds&R)===R&&(mo===4||mo===3&&(ds&130023424)===ds&&500>Et()-sv?Yl(p,0):g0|=R),js(p,y)}function b1(p,y){y===0&&((p.mode&1)===0?y=1:(y=gi,gi<<=1,(gi&130023424)===0&&(gi=4194304)));var R=Ps();p=ua(p,y),p!==null&&(eo(p,y,R),js(p,R))}function w2(p){var y=p.memoizedState,R=0;y!==null&&(R=y.retryLane),b1(p,R)}function Zm(p,y){var R=0;switch(p.tag){case 13:var B=p.stateNode,Y=p.memoizedState;Y!==null&&(R=Y.retryLane);break;case 19:B=p.stateNode;break;default:throw Error(n(314))}B!==null&&B.delete(y),b1(p,R)}var w0;w0=function(p,y,R){if(p!==null)if(p.memoizedProps!==y.pendingProps||Eo.current)us=!0;else{if((p.lanes&R)===0&&(y.flags&128)===0)return us=!1,cp(p,y,R);us=(p.flags&131072)!==0}else us=!1,_i&&(y.flags&1048576)!==0&&kd(y,Ld,y.index);switch(y.lanes=0,y.tag){case 2:var B=y.type;Nu(p,y),p=y.pendingProps;var Y=Dc(y,Mo.current);tl(y,R),Y=g(null,y,B,p,Y,R);var re=x();return y.flags|=1,typeof Y=="object"&&Y!==null&&typeof Y.render=="function"&&Y.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,qo(B)?(re=!0,ka(y)):re=!1,y.memoizedState=Y.state!==null&&Y.state!==void 0?Y.state:null,Ss(y),Y.updater=Oa,y.stateNode=Y,Y._reactInternals=y,jl(y,B,p,R),y=$d(null,y,B,!0,re,R)):(y.tag=0,_i&&re&&zd(y),Xo(null,y,Y,R),y=y.child),y;case 16:B=y.elementType;e:{switch(Nu(p,y),p=y.pendingProps,Y=B._init,B=Y(B._payload),y.type=B,Y=y.tag=M2(B),p=qr(B,p),Y){case 0:y=cl(null,y,B,p,R);break e;case 1:y=Wl(null,y,B,p,R);break e;case 11:y=$c(null,y,B,p,R);break e;case 14:y=tv(null,y,B,qr(B.type,p),R);break e}throw Error(n(306,B,""))}return y;case 0:return B=y.type,Y=y.pendingProps,Y=y.elementType===B?Y:qr(B,Y),cl(p,y,B,Y,R);case 1:return B=y.type,Y=y.pendingProps,Y=y.elementType===B?Y:qr(B,Y),Wl(p,y,B,Y,R);case 3:e:{if(sp(y),p===null)throw Error(n(387));B=y.pendingProps,re=y.memoizedState,Y=re.element,rp(p,y),ci(y,B,null,R);var we=y.memoizedState;if(B=we.element,re.isDehydrated)if(re={element:B,isDehydrated:!1,cache:we.cache,pendingSuspenseBoundaries:we.pendingSuspenseBoundaries,transitions:we.transitions},y.updateQueue.baseState=re,y.memoizedState=re,y.flags&256){Y=al(Error(n(423)),y),y=Vd(p,y,B,R,Y);break e}else if(B!==Y){Y=al(Error(n(424)),y),y=Vd(p,y,B,R,Y);break e}else for(No=Fl(y.stateNode.containerInfo.firstChild),Fo=y,_i=!0,ls=null,R=Ch(y,null,B,R),y.child=R;R;)R.flags=R.flags&-3|4096,R=R.sibling;else{if(Oc(),B===Y){y=Bu(p,y,R);break e}Xo(p,y,B,R)}y=y.child}return y;case 5:return ol(y),p===null&&Fm(y),B=y.type,Y=y.pendingProps,re=p!==null?p.memoizedProps:null,we=Y.children,Gf(B,Y)?we=null:re!==null&&Gf(B,re)&&(y.flags|=32),Gl(p,y),Xo(p,y,we,R),y.child;case 6:return p===null&&Fm(y),null;case 13:return l0(p,y,R);case 4:return Bd(y,y.stateNode.containerInfo),B=y.pendingProps,p===null?y.child=Eh(y,null,B,R):Xo(p,y,B,R),y.child;case 11:return B=y.type,Y=y.pendingProps,Y=y.elementType===B?Y:qr(B,Y),$c(p,y,B,Y,R);case 7:return Xo(p,y,y.pendingProps,R),y.child;case 8:return Xo(p,y,y.pendingProps.children,R),y.child;case 12:return Xo(p,y,y.pendingProps.children,R),y.child;case 10:e:{if(B=y.type._context,Y=y.pendingProps,re=y.memoizedProps,we=Y.value,Wr(Iu,B._currentValue),B._currentValue=we,re!==null)if(Aa(re.value,we)){if(re.children===Y.children&&!Eo.current){y=Bu(p,y,R);break e}}else for(re=y.child,re!==null&&(re.return=y);re!==null;){var at=re.dependencies;if(at!==null){we=re.child;for(var vt=at.firstContext;vt!==null;){if(vt.context===B){if(re.tag===1){vt=nl(-1,R&-R),vt.tag=2;var $t=re.updateQueue;if($t!==null){$t=$t.shared;var wn=$t.pending;wn===null?vt.next=vt:(vt.next=wn.next,wn.next=vt),$t.pending=vt}}re.lanes|=R,vt=re.alternate,vt!==null&&(vt.lanes|=R),Vs(re.return,R,y),at.lanes|=R;break}vt=vt.next}}else if(re.tag===10)we=re.type===y.type?null:re.child;else if(re.tag===18){if(we=re.return,we===null)throw Error(n(341));we.lanes|=R,at=we.alternate,at!==null&&(at.lanes|=R),Vs(we,R,y),we=re.sibling}else we=re.child;if(we!==null)we.return=re;else for(we=re;we!==null;){if(we===y){we=null;break}if(re=we.sibling,re!==null){re.return=we.return,we=re;break}we=we.return}re=we}Xo(p,y,Y.children,R),y=y.child}return y;case 9:return Y=y.type,B=y.pendingProps.children,tl(y,R),Y=Vn(Y),B=B(Y),y.flags|=1,Xo(p,y,B,R),y.child;case 14:return B=y.type,Y=qr(B,y.pendingProps),Y=qr(B.type,Y),tv(p,y,B,Y,R);case 15:return Um(p,y,y.type,y.pendingProps,R);case 17:return B=y.type,Y=y.pendingProps,Y=y.elementType===B?Y:qr(B,Y),Nu(p,y),y.tag=1,qo(B)?(p=!0,ka(y)):p=!1,tl(y,R),Fa(y,B,Y),jl(y,B,Y,R),$d(null,y,B,!0,p,R);case 19:return u0(p,y,R);case 22:return op(p,y,R)}throw Error(n(156,y.tag))};function w1(p,y){return fr(p,y)}function S2(p,y,R,B){this.tag=p,this.key=R,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=B,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dl(p,y,R,B){return new S2(p,y,R,B)}function S0(p){return p=p.prototype,!(!p||!p.isReactComponent)}function M2(p){if(typeof p=="function")return S0(p)?1:0;if(p!=null){if(p=p.$$typeof,p===Ee)return 11;if(p===ke)return 14}return 2}function ju(p,y){var R=p.alternate;return R===null?(R=dl(p.tag,y,p.key,p.mode),R.elementType=p.elementType,R.type=p.type,R.stateNode=p.stateNode,R.alternate=p,p.alternate=R):(R.pendingProps=y,R.type=p.type,R.flags=0,R.subtreeFlags=0,R.deletions=null),R.flags=p.flags&14680064,R.childLanes=p.childLanes,R.lanes=p.lanes,R.child=p.child,R.memoizedProps=p.memoizedProps,R.memoizedState=p.memoizedState,R.updateQueue=p.updateQueue,y=p.dependencies,R.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},R.sibling=p.sibling,R.index=p.index,R.ref=p.ref,R}function vp(p,y,R,B,Y,re){var we=2;if(B=p,typeof p=="function")S0(p)&&(we=1);else if(typeof p=="string")we=5;else e:switch(p){case J:return Bh(R.children,Y,re,y);case ue:we=8,Y|=8;break;case ne:return p=dl(12,R,y,Y|2),p.elementType=ne,p.lanes=re,p;case Pe:return p=dl(13,R,y,Y),p.elementType=Pe,p.lanes=re,p;case Ze:return p=dl(19,R,y,Y),p.elementType=Ze,p.lanes=re,p;case Ie:return Ym(R,Y,re,y);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case H:we=10;break e;case de:we=9;break e;case Ee:we=11;break e;case ke:we=14;break e;case Te:we=16,B=null;break e}throw Error(n(130,p==null?p:typeof p,""))}return y=dl(we,R,y,Y),y.elementType=p,y.type=B,y.lanes=re,y}function Bh(p,y,R,B){return p=dl(7,p,B,y),p.lanes=R,p}function Ym(p,y,R,B){return p=dl(22,p,B,y),p.elementType=Ie,p.lanes=R,p.stateNode={isHidden:!1},p}function dv(p,y,R){return p=dl(6,p,null,y),p.lanes=R,p}function M0(p,y,R){return y=dl(4,p.children!==null?p.children:[],p.key,y),y.lanes=R,y.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},y}function fv(p,y,R,B,Y){this.tag=y,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_o(0),this.expirationTimes=_o(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_o(0),this.identifierPrefix=B,this.onRecoverableError=Y,this.mutableSourceEagerHydrationData=null}function E0(p,y,R,B,Y,re,we,at,vt){return p=new fv(p,y,R,at,vt),y===1?(y=1,re===!0&&(y|=8)):y=0,re=dl(3,null,null,y),p.current=re,re.stateNode=p,re.memoizedState={element:B,isDehydrated:R,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ss(re),p}function S1(p,y,R){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:B==null?null:""+B,children:p,containerInfo:y,implementation:R}}function M1(p){if(!p)return Qa;p=p._reactInternals;e:{if(ct(p)!==p||p.tag!==1)throw Error(n(170));var y=p;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(qo(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(n(171))}if(p.tag===1){var R=p.type;if(qo(R))return Yf(p,R,y)}return y}function E1(p,y,R,B,Y,re,we,at,vt){return p=E0(R,B,!0,p,Y,re,we,at,vt),p.context=M1(null),R=p.current,B=Ps(),Y=fa(R),re=nl(B,Y),re.callback=y??null,Nc(R,re,Y),p.current.lanes=Y,eo(p,Y,B),js(p,B),p}function pv(p,y,R,B){var Y=y.current,re=Ps(),we=fa(Y);return R=M1(R),y.context===null?y.context=R:y.pendingContext=R,y=nl(re,we),y.payload={element:p},B=B===void 0?null:B,B!==null&&(y.callback=B),p=Nc(Y,y,we),p!==null&&(Zl(p,Y,we,re),ip(p,Y,we)),we}function Km(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 5:return p.child.stateNode;default:return p.child.stateNode}}function C1(p,y){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var R=p.retryLane;p.retryLane=R!==0&&R<y?R:y}}function C0(p,y){C1(p,y),(p=p.alternate)&&C1(p,y)}function Po(){return null}var yp=typeof reportError=="function"?reportError:function(p){console.error(p)};function T0(p){this._internalRoot=p}mv.prototype.render=T0.prototype.render=function(p){var y=this._internalRoot;if(y===null)throw Error(n(409));pv(p,y,null,null)},mv.prototype.unmount=T0.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var y=p.containerInfo;Gd(function(){pv(null,p,null,null)}),y[ia]=null}};function mv(p){this._internalRoot=p}mv.prototype.unstable_scheduleHydration=function(p){if(p){var y=ch();p={blockedOn:null,target:p,priority:y};for(var R=0;R<Zr.length&&y!==0&&y<Zr[R].priority;R++);Zr.splice(R,0,p),R===0&&_s(p)}};function gv(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function Jm(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11&&(p.nodeType!==8||p.nodeValue!==" react-mount-point-unstable "))}function T1(){}function P1(p,y,R,B,Y){if(Y){if(typeof B=="function"){var re=B;B=function(){var $t=Km(we);re.call($t)}}var we=E1(y,B,p,0,null,!1,!1,"",T1);return p._reactRootContainer=we,p[ia]=we.current,bu(p.nodeType===8?p.parentNode:p),Gd(),we}for(;Y=p.lastChild;)p.removeChild(Y);if(typeof B=="function"){var at=B;B=function(){var $t=Km(vt);at.call($t)}}var vt=E0(p,0,!1,null,null,!1,!1,"",T1);return p._reactRootContainer=vt,p[ia]=vt.current,bu(p.nodeType===8?p.parentNode:p),Gd(function(){pv(y,vt,R,B)}),vt}function Qm(p,y,R,B,Y){var re=R._reactRootContainer;if(re){var we=re;if(typeof Y=="function"){var at=Y;Y=function(){var vt=Km(we);at.call(vt)}}pv(y,we,p,Y)}else we=P1(R,y,p,Y,B);return Km(we)}gm=function(p){switch(p.tag){case 3:var y=p.stateNode;if(y.current.memoizedState.isDehydrated){var R=Cr(y.pendingLanes);R!==0&&(xo(y,R|1),js(y,Et()),(Kr&6)===0&&(Uu=Et()+500,sa()))}break;case 13:Gd(function(){var B=ua(p,1);if(B!==null){var Y=Ps();Zl(B,p,1,Y)}}),C0(p,1)}},yc=function(p){if(p.tag===13){var y=ua(p,134217728);if(y!==null){var R=Ps();Zl(y,p,134217728,R)}C0(p,134217728)}},Mf=function(p){if(p.tag===13){var y=fa(p),R=ua(p,y);if(R!==null){var B=Ps();Zl(R,p,y,B)}C0(p,y)}},ch=function(){return kr},kl=function(p,y){var R=kr;try{return kr=p,y()}finally{kr=R}},Fe=function(p,y,R){switch(y){case"input":if(on(p,R),y=R.name,R.type==="radio"&&y!=null){for(R=p;R.parentNode;)R=R.parentNode;for(R=R.querySelectorAll("input[name="+JSON.stringify(""+y)+'][type="radio"]'),y=0;y<R.length;y++){var B=R[y];if(B!==p&&B.form===p.form){var Y=Rd(B);if(!Y)throw Error(n(90));en(B),on(B,Y)}}}break;case"textarea":Nt(p,R);break;case"select":y=R.value,y!=null&&Ve(p,!!R.multiple,y,!1)}},sn=v0,Jt=Gd;var _p={usingClientEntryPoint:!1,Events:[Da,La,Rd,zt,fn,v0]},Wd={findFiberByHostInstance:Ra,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A1={bundleType:Wd.bundleType,version:Wd.version,rendererPackageName:Wd.rendererPackageName,rendererConfig:Wd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:X.ReactCurrentDispatcher,findHostInstanceByFiber:function(p){return p=Bn(p),p===null?null:p.stateNode},findFiberByHostInstance:Wd.findFiberByHostInstance||Po,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var eg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!eg.isDisabled&&eg.supportsFiber)try{Wn=eg.inject(A1),Pn=eg}catch{}}return gl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_p,gl.createPortal=function(p,y){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gv(y))throw Error(n(200));return S1(p,y,null,R)},gl.createRoot=function(p,y){if(!gv(p))throw Error(n(299));var R=!1,B="",Y=yp;return y!=null&&(y.unstable_strictMode===!0&&(R=!0),y.identifierPrefix!==void 0&&(B=y.identifierPrefix),y.onRecoverableError!==void 0&&(Y=y.onRecoverableError)),y=E0(p,1,!1,null,null,R,!1,B,Y),p[ia]=y.current,bu(p.nodeType===8?p.parentNode:p),new T0(y)},gl.findDOMNode=function(p){if(p==null)return null;if(p.nodeType===1)return p;var y=p._reactInternals;if(y===void 0)throw typeof p.render=="function"?Error(n(188)):(p=Object.keys(p).join(","),Error(n(268,p)));return p=Bn(y),p=p===null?null:p.stateNode,p},gl.flushSync=function(p){return Gd(p)},gl.hydrate=function(p,y,R){if(!Jm(y))throw Error(n(200));return Qm(null,p,y,!0,R)},gl.hydrateRoot=function(p,y,R){if(!gv(p))throw Error(n(405));var B=R!=null&&R.hydratedSources||null,Y=!1,re="",we=yp;if(R!=null&&(R.unstable_strictMode===!0&&(Y=!0),R.identifierPrefix!==void 0&&(re=R.identifierPrefix),R.onRecoverableError!==void 0&&(we=R.onRecoverableError)),y=E1(y,null,p,1,R??null,Y,!1,re,we),p[ia]=y.current,bu(p),B)for(p=0;p<B.length;p++)R=B[p],Y=R._getVersion,Y=Y(R._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[R,Y]:y.mutableSourceEagerHydrationData.push(R,Y);return new mv(y)},gl.render=function(p,y,R){if(!Jm(y))throw Error(n(200));return Qm(null,p,y,!1,R)},gl.unmountComponentAtNode=function(p){if(!Jm(p))throw Error(n(40));return p._reactRootContainer?(Gd(function(){Qm(null,null,p,!1,function(){p._reactRootContainer=null,p[ia]=null})}),!0):!1},gl.unstable_batchedUpdates=v0,gl.unstable_renderSubtreeIntoContainer=function(p,y,R,B){if(!Jm(R))throw Error(n(200));if(p==null||p._reactInternals===void 0)throw Error(n(38));return Qm(p,y,R,!1,B)},gl.version="18.3.1-next-f1338f8080-20240426",gl}var rL;function RN(){if(rL)return vM.exports;rL=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),vM.exports=sq(),vM.exports}var ES=RN();function aq(t){return typeof t=="function"?t():t}const DN=q.forwardRef(function(e,n){const{children:r,container:a,disablePortal:l=!1}=e,[u,s]=q.useState(null),m=pi(q.isValidElement(r)?_S(r):null,n);if(df(()=>{l||s(aq(a)||document.body)},[a,l]),df(()=>{if(u&&!l)return _w(n,u),()=>{_w(n,null)}},[n,u,l]),l){if(q.isValidElement(r)){const _={ref:m};return q.cloneElement(r,_)}return ae.jsx(q.Fragment,{children:r})}return ae.jsx(q.Fragment,{children:u&&ES.createPortal(r,u)})});function lq(t={}){const{disabled:e=!1,focusableWhenDisabled:n,rootRef:r}=t,a=q.useContext(bS);if(a===null)throw new Error("useMenuButton: no menu context available.");const{state:l,dispatch:u,registerTrigger:s,popupId:m}=a,{getRootProps:_,rootRef:b,active:M}=hd({disabled:e,focusableWhenDisabled:n,rootRef:r}),C=pi(b,s),A=O=>j=>{var U;(U=O.onClick)==null||U.call(O,j),!j.defaultMuiPrevented&&u({type:eh.toggle,event:j})},k=O=>j=>{var U;(U=O.onKeyDown)==null||U.call(O,j),!j.defaultMuiPrevented&&(j.key==="ArrowDown"||j.key==="ArrowUp")&&(j.preventDefault(),u({type:eh.open,event:j}))},z=(O={})=>({onClick:A(O),onKeyDown:k(O)});return{active:M,getRootProps:(O={})=>{const j=gs(O),U=ff(z,_);return ye({"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":m},O,j,U(j),{tabIndex:0,ref:C})},open:l.open,rootRef:C}}function cq(t){return`menu-item-${t.size}`}const uq={dispatch:()=>{}};function hq(t){var e;const{disabled:n=!1,id:r,rootRef:a,label:l,disableFocusOnHover:u=!1}=t,s=Pl(r),m=q.useRef(null),_=q.useMemo(()=>({disabled:n,id:s??"",label:l,ref:m}),[n,s,l]),{dispatch:b}=(e=q.useContext(bS))!=null?e:uq,{getRootProps:M,highlighted:C}=tI({item:s,handlePointerOverEvents:!u}),{index:A,totalItemCount:k}=MS(s??cq,_),{getRootProps:z,focusVisible:P,rootRef:O}=hd({disabled:n,focusableWhenDisabled:!0}),j=pi(O,a,m);q.useDebugValue({id:s,highlighted:C,disabled:n,label:l});const U=se=>J=>{var ue;(ue=se.onClick)==null||ue.call(se,J),!J.defaultMuiPrevented&&b({type:eh.close,event:J})},X=(se={})=>ye({},se,{onClick:U(se)});function K(se={}){const J=gs(se),ue=ff(X,ff(z,M));return ye({},se,J,ue(J),{id:s,ref:j,role:"menuitem"})}return s===void 0?{getRootProps:K,disabled:!1,focusVisible:P,highlighted:!1,index:-1,totalItemCount:0,rootRef:j}:{getRootProps:K,disabled:n,focusVisible:P,highlighted:C,index:A,totalItemCount:k,rootRef:j}}function dq(t){const e=q.useContext(om);if(!e)throw new Error("MenuItem: ListContext was not found.");const n=Pl(t),{getItemState:r,dispatch:a}=e;let l;n!=null?l=r(n):l={focusable:!0,highlighted:!1,selected:!1};const{highlighted:u,selected:s,focusable:m}=l,_=q.useCallback(M=>{if(M!==n)throw new Error(["Base UI MenuItem: Tried to access the state of another MenuItem.",`itemValue: ${M} | id: ${n}`,"This is unsupported when the MenuItem uses the MenuItemContextStabilizer as a performance optimization."].join("/n"));return{highlighted:u,selected:s,focusable:m}},[u,s,m,n]);return{contextValue:q.useMemo(()=>({dispatch:a,getItemState:_}),[a,_]),id:n}}function fq(t){const e=pc(t);return e.body===t?XA(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function g_(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function iL(t){return parseInt(XA(t).getComputedStyle(t).paddingRight,10)||0}function pq(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function oL(t,e,n,r,a){const l=[e,n,...r];[].forEach.call(t.children,u=>{const s=l.indexOf(u)===-1,m=!pq(u);s&&m&&g_(u,a)})}function xM(t,e){let n=-1;return t.some((r,a)=>e(r)?(n=a,!0):!1),n}function mq(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(fq(r)){const u=SG(pc(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${iL(r)+u}px`;const s=pc(r).querySelectorAll(".mui-fixed");[].forEach.call(s,m=>{n.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${iL(m)+u}px`})}let l;if(r.parentNode instanceof DocumentFragment)l=pc(r).body;else{const u=r.parentElement,s=XA(r);l=u?.nodeName==="HTML"&&s.getComputedStyle(u).overflowY==="scroll"?u:r}n.push({value:l.style.overflow,property:"overflow",el:l},{value:l.style.overflowX,property:"overflow-x",el:l},{value:l.style.overflowY,property:"overflow-y",el:l}),l.style.overflow="hidden"}return()=>{n.forEach(({value:l,el:u,property:s})=>{l?u.style.setProperty(s,l):u.style.removeProperty(s)})}}function gq(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class vq{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&g_(e.modalRef,!1);const a=gq(n);oL(n,e.mount,e.modalRef,a,!0);const l=xM(this.containers,u=>u.container===n);return l!==-1?(this.containers[l].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:a}),r)}mount(e,n){const r=xM(this.containers,l=>l.modals.indexOf(e)!==-1),a=this.containers[r];a.restore||(a.restore=mq(a,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const a=xM(this.containers,u=>u.modals.indexOf(e)!==-1),l=this.containers[a];if(l.modals.splice(l.modals.indexOf(e),1),this.modals.splice(r,1),l.modals.length===0)l.restore&&l.restore(),e.modalRef&&g_(e.modalRef,n),oL(l.container,e.mount,e.modalRef,l.hiddenSiblings,!1),this.containers.splice(a,1);else{const u=l.modals[l.modals.length-1];u.modalRef&&g_(u.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function yq(t){return typeof t=="function"?t():t}function _q(t){return t?t.props.hasOwnProperty("in"):!1}const xq=new vq;function bq(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:a=xq,closeAfterTransition:l=!1,onTransitionEnter:u,onTransitionExited:s,children:m,onClose:_,open:b,rootRef:M}=t,C=q.useRef({}),A=q.useRef(null),k=q.useRef(null),z=pi(k,M),[P,O]=q.useState(!b),j=_q(m);let U=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(U=!1);const X=()=>pc(A.current),K=()=>(C.current.modalRef=k.current,C.current.mount=A.current,C.current),se=()=>{a.mount(K(),{disableScrollLock:r}),k.current&&(k.current.scrollTop=0)},J=nh(()=>{const Te=yq(e)||X().body;a.add(K(),Te),k.current&&se()}),ue=q.useCallback(()=>a.isTopModal(K()),[a]),ne=nh(Te=>{A.current=Te,Te&&(b&&ue()?se():k.current&&g_(k.current,U))}),H=q.useCallback(()=>{a.remove(K(),U)},[U,a]);q.useEffect(()=>()=>{H()},[H]),q.useEffect(()=>{b?J():(!j||!l)&&H()},[b,H,j,l,J]);const de=Te=>Ie=>{var Ce;(Ce=Te.onKeyDown)==null||Ce.call(Te,Ie),!(Ie.key!=="Escape"||Ie.which===229||!ue())&&(n||(Ie.stopPropagation(),_&&_(Ie,"escapeKeyDown")))},Ee=Te=>Ie=>{var Ce;(Ce=Te.onClick)==null||Ce.call(Te,Ie),Ie.target===Ie.currentTarget&&_&&_(Ie,"backdropClick")};return{getRootProps:(Te={})=>{const Ie=gs(t);delete Ie.onTransitionEnter,delete Ie.onTransitionExited;const Ce=ye({},Ie,Te);return ye({role:"presentation"},Ce,{onKeyDown:de(Ce),ref:z})},getBackdropProps:(Te={})=>{const Ie=Te;return ye({"aria-hidden":!0},Ie,{onClick:Ee(Ie),open:b})},getTransitionProps:()=>{const Te=()=>{O(!1),u&&u()},Ie=()=>{O(!0),s&&s(),l&&H()};return{onEnter:BD(Te,m?.props.onEnter),onExited:BD(Ie,m?.props.onExited)}},rootRef:z,portalRef:ne,isTopModal:ue,exited:P,hasTransition:j}}function wq(t){const{value:e,label:n,disabled:r,rootRef:a,id:l}=t,{getRootProps:u,highlighted:s,selected:m}=tI({item:e}),{getRootProps:_,rootRef:b}=hd({disabled:r,focusableWhenDisabled:!0}),M=Pl(l),C=q.useRef(null),A=q.useMemo(()=>({disabled:r,label:n,value:e,ref:C,id:M}),[r,n,e,M]),{index:k}=MS(e,A),z=pi(a,C,b),P=j=>U=>{var X;(X=j.onKeyDown)==null||X.call(j,U),!U.defaultMuiPrevented&&[" ","Enter"].includes(U.key)&&(U.defaultMuiPrevented=!0)},O=(j={})=>({onKeyDown:P(j)});return{getRootProps:(j={})=>{const U=gs(j),X=ff(u,ff(_,O));return ye({},j,U,X(U),{id:M,ref:z,role:"option","aria-selected":m})},highlighted:s,index:k,selected:m,rootRef:z}}function Sq(t){const e=q.useContext(om);if(!e)throw new Error("Option: ListContext was not found.");const{getItemState:n,dispatch:r}=e,{highlighted:a,selected:l,focusable:u}=n(t),s=q.useCallback(_=>{if(_!==t)throw new Error(["Base UI Option: Tried to access the state of another Option.","This is unsupported when the Option uses the OptionContextStabilizer as a performance optimization."].join("/n"));return{highlighted:a,selected:l,focusable:u}},[a,l,u,t]);return{contextValue:q.useMemo(()=>({dispatch:r,getItemState:s}),[r,s])}}var Sl="top",tu="bottom",nu="right",Ml="left",nI="auto",bx=[Sl,tu,nu,Ml],Ay="start",X_="end",Mq="clippingParents",LN="viewport",B0="popper",Eq="reference",sL=bx.reduce(function(t,e){return t.concat([e+"-"+Ay,e+"-"+X_])},[]),kN=[].concat(bx,[nI]).reduce(function(t,e){return t.concat([e,e+"-"+Ay,e+"-"+X_])},[]),Cq="beforeRead",Tq="read",Pq="afterRead",Aq="beforeMain",Iq="main",Rq="afterMain",Dq="beforeWrite",Lq="write",kq="afterWrite",zq=[Cq,Tq,Pq,Aq,Iq,Rq,Dq,Lq,kq];function od(t){return t?(t.nodeName||"").toLowerCase():null}function vc(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ag(t){var e=vc(t).Element;return t instanceof e||t instanceof Element}function eu(t){var e=vc(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function rI(t){if(typeof ShadowRoot>"u")return!1;var e=vc(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Oq(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},a=e.attributes[n]||{},l=e.elements[n];!eu(l)||!od(l)||(Object.assign(l.style,r),Object.keys(a).forEach(function(u){var s=a[u];s===!1?l.removeAttribute(u):l.setAttribute(u,s===!0?"":s)}))})}function Fq(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var a=e.elements[r],l=e.attributes[r]||{},u=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),s=u.reduce(function(m,_){return m[_]="",m},{});!eu(a)||!od(a)||(Object.assign(a.style,s),Object.keys(l).forEach(function(m){a.removeAttribute(m)}))})}}const Nq={name:"applyStyles",enabled:!0,phase:"write",fn:Oq,effect:Fq,requires:["computeStyles"]};function td(t){return t.split("-")[0]}var Eg=Math.max,xw=Math.min,Iy=Math.round;function YT(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function zN(){return!/^((?!chrome|android).)*safari/i.test(YT())}function Ry(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),a=1,l=1;e&&eu(t)&&(a=t.offsetWidth>0&&Iy(r.width)/t.offsetWidth||1,l=t.offsetHeight>0&&Iy(r.height)/t.offsetHeight||1);var u=Ag(t)?vc(t):window,s=u.visualViewport,m=!zN()&&n,_=(r.left+(m&&s?s.offsetLeft:0))/a,b=(r.top+(m&&s?s.offsetTop:0))/l,M=r.width/a,C=r.height/l;return{width:M,height:C,top:b,right:_+M,bottom:b+C,left:_,x:_,y:b}}function iI(t){var e=Ry(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function ON(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&rI(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function pf(t){return vc(t).getComputedStyle(t)}function Bq(t){return["table","td","th"].indexOf(od(t))>=0}function sm(t){return((Ag(t)?t.ownerDocument:t.document)||window.document).documentElement}function CS(t){return od(t)==="html"?t:t.assignedSlot||t.parentNode||(rI(t)?t.host:null)||sm(t)}function aL(t){return!eu(t)||pf(t).position==="fixed"?null:t.offsetParent}function Uq(t){var e=/firefox/i.test(YT()),n=/Trident/i.test(YT());if(n&&eu(t)){var r=pf(t);if(r.position==="fixed")return null}var a=CS(t);for(rI(a)&&(a=a.host);eu(a)&&["html","body"].indexOf(od(a))<0;){var l=pf(a);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return a;a=a.parentNode}return null}function wx(t){for(var e=vc(t),n=aL(t);n&&Bq(n)&&pf(n).position==="static";)n=aL(n);return n&&(od(n)==="html"||od(n)==="body"&&pf(n).position==="static")?e:n||Uq(t)||e}function oI(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function v_(t,e,n){return Eg(t,xw(e,n))}function $q(t,e,n){var r=v_(t,e,n);return r>n?n:r}function FN(){return{top:0,right:0,bottom:0,left:0}}function NN(t){return Object.assign({},FN(),t)}function BN(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var Vq=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,NN(typeof e!="number"?e:BN(e,bx))};function jq(t){var e,n=t.state,r=t.name,a=t.options,l=n.elements.arrow,u=n.modifiersData.popperOffsets,s=td(n.placement),m=oI(s),_=[Ml,nu].indexOf(s)>=0,b=_?"height":"width";if(!(!l||!u)){var M=Vq(a.padding,n),C=iI(l),A=m==="y"?Sl:Ml,k=m==="y"?tu:nu,z=n.rects.reference[b]+n.rects.reference[m]-u[m]-n.rects.popper[b],P=u[m]-n.rects.reference[m],O=wx(l),j=O?m==="y"?O.clientHeight||0:O.clientWidth||0:0,U=z/2-P/2,X=M[A],K=j-C[b]-M[k],se=j/2-C[b]/2+U,J=v_(X,se,K),ue=m;n.modifiersData[r]=(e={},e[ue]=J,e.centerOffset=J-se,e)}}function Hq(t){var e=t.state,n=t.options,r=n.element,a=r===void 0?"[data-popper-arrow]":r;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||ON(e.elements.popper,a)&&(e.elements.arrow=a))}const Gq={name:"arrow",enabled:!0,phase:"main",fn:jq,effect:Hq,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Dy(t){return t.split("-")[1]}var Wq={top:"auto",right:"auto",bottom:"auto",left:"auto"};function qq(t,e){var n=t.x,r=t.y,a=e.devicePixelRatio||1;return{x:Iy(n*a)/a||0,y:Iy(r*a)/a||0}}function lL(t){var e,n=t.popper,r=t.popperRect,a=t.placement,l=t.variation,u=t.offsets,s=t.position,m=t.gpuAcceleration,_=t.adaptive,b=t.roundOffsets,M=t.isFixed,C=u.x,A=C===void 0?0:C,k=u.y,z=k===void 0?0:k,P=typeof b=="function"?b({x:A,y:z}):{x:A,y:z};A=P.x,z=P.y;var O=u.hasOwnProperty("x"),j=u.hasOwnProperty("y"),U=Ml,X=Sl,K=window;if(_){var se=wx(n),J="clientHeight",ue="clientWidth";if(se===vc(n)&&(se=sm(n),pf(se).position!=="static"&&s==="absolute"&&(J="scrollHeight",ue="scrollWidth")),se=se,a===Sl||(a===Ml||a===nu)&&l===X_){X=tu;var ne=M&&se===K&&K.visualViewport?K.visualViewport.height:se[J];z-=ne-r.height,z*=m?1:-1}if(a===Ml||(a===Sl||a===tu)&&l===X_){U=nu;var H=M&&se===K&&K.visualViewport?K.visualViewport.width:se[ue];A-=H-r.width,A*=m?1:-1}}var de=Object.assign({position:s},_&&Wq),Ee=b===!0?qq({x:A,y:z},vc(n)):{x:A,y:z};if(A=Ee.x,z=Ee.y,m){var Pe;return Object.assign({},de,(Pe={},Pe[X]=j?"0":"",Pe[U]=O?"0":"",Pe.transform=(K.devicePixelRatio||1)<=1?"translate("+A+"px, "+z+"px)":"translate3d("+A+"px, "+z+"px, 0)",Pe))}return Object.assign({},de,(e={},e[X]=j?z+"px":"",e[U]=O?A+"px":"",e.transform="",e))}function Xq(t){var e=t.state,n=t.options,r=n.gpuAcceleration,a=r===void 0?!0:r,l=n.adaptive,u=l===void 0?!0:l,s=n.roundOffsets,m=s===void 0?!0:s,_={placement:td(e.placement),variation:Dy(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,lL(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:u,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,lL(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Zq={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Xq,data:{}};var Z1={passive:!0};function Yq(t){var e=t.state,n=t.instance,r=t.options,a=r.scroll,l=a===void 0?!0:a,u=r.resize,s=u===void 0?!0:u,m=vc(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&_.forEach(function(b){b.addEventListener("scroll",n.update,Z1)}),s&&m.addEventListener("resize",n.update,Z1),function(){l&&_.forEach(function(b){b.removeEventListener("scroll",n.update,Z1)}),s&&m.removeEventListener("resize",n.update,Z1)}}const Kq={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Yq,data:{}};var Jq={left:"right",right:"left",bottom:"top",top:"bottom"};function Wb(t){return t.replace(/left|right|bottom|top/g,function(e){return Jq[e]})}var Qq={start:"end",end:"start"};function cL(t){return t.replace(/start|end/g,function(e){return Qq[e]})}function sI(t){var e=vc(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function aI(t){return Ry(sm(t)).left+sI(t).scrollLeft}function eX(t,e){var n=vc(t),r=sm(t),a=n.visualViewport,l=r.clientWidth,u=r.clientHeight,s=0,m=0;if(a){l=a.width,u=a.height;var _=zN();(_||!_&&e==="fixed")&&(s=a.offsetLeft,m=a.offsetTop)}return{width:l,height:u,x:s+aI(t),y:m}}function tX(t){var e,n=sm(t),r=sI(t),a=(e=t.ownerDocument)==null?void 0:e.body,l=Eg(n.scrollWidth,n.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),u=Eg(n.scrollHeight,n.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),s=-r.scrollLeft+aI(t),m=-r.scrollTop;return pf(a||n).direction==="rtl"&&(s+=Eg(n.clientWidth,a?a.clientWidth:0)-l),{width:l,height:u,x:s,y:m}}function lI(t){var e=pf(t),n=e.overflow,r=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+a+r)}function UN(t){return["html","body","#document"].indexOf(od(t))>=0?t.ownerDocument.body:eu(t)&&lI(t)?t:UN(CS(t))}function y_(t,e){var n;e===void 0&&(e=[]);var r=UN(t),a=r===((n=t.ownerDocument)==null?void 0:n.body),l=vc(r),u=a?[l].concat(l.visualViewport||[],lI(r)?r:[]):r,s=e.concat(u);return a?s:s.concat(y_(CS(u)))}function KT(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function nX(t,e){var n=Ry(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function uL(t,e,n){return e===LN?KT(eX(t,n)):Ag(e)?nX(e,n):KT(tX(sm(t)))}function rX(t){var e=y_(CS(t)),n=["absolute","fixed"].indexOf(pf(t).position)>=0,r=n&&eu(t)?wx(t):t;return Ag(r)?e.filter(function(a){return Ag(a)&&ON(a,r)&&od(a)!=="body"}):[]}function iX(t,e,n,r){var a=e==="clippingParents"?rX(t):[].concat(e),l=[].concat(a,[n]),u=l[0],s=l.reduce(function(m,_){var b=uL(t,_,r);return m.top=Eg(b.top,m.top),m.right=xw(b.right,m.right),m.bottom=xw(b.bottom,m.bottom),m.left=Eg(b.left,m.left),m},uL(t,u,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function $N(t){var e=t.reference,n=t.element,r=t.placement,a=r?td(r):null,l=r?Dy(r):null,u=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,m;switch(a){case Sl:m={x:u,y:e.y-n.height};break;case tu:m={x:u,y:e.y+e.height};break;case nu:m={x:e.x+e.width,y:s};break;case Ml:m={x:e.x-n.width,y:s};break;default:m={x:e.x,y:e.y}}var _=a?oI(a):null;if(_!=null){var b=_==="y"?"height":"width";switch(l){case Ay:m[_]=m[_]-(e[b]/2-n[b]/2);break;case X_:m[_]=m[_]+(e[b]/2-n[b]/2);break}}return m}function Z_(t,e){e===void 0&&(e={});var n=e,r=n.placement,a=r===void 0?t.placement:r,l=n.strategy,u=l===void 0?t.strategy:l,s=n.boundary,m=s===void 0?Mq:s,_=n.rootBoundary,b=_===void 0?LN:_,M=n.elementContext,C=M===void 0?B0:M,A=n.altBoundary,k=A===void 0?!1:A,z=n.padding,P=z===void 0?0:z,O=NN(typeof P!="number"?P:BN(P,bx)),j=C===B0?Eq:B0,U=t.rects.popper,X=t.elements[k?j:C],K=iX(Ag(X)?X:X.contextElement||sm(t.elements.popper),m,b,u),se=Ry(t.elements.reference),J=$N({reference:se,element:U,placement:a}),ue=KT(Object.assign({},U,J)),ne=C===B0?ue:se,H={top:K.top-ne.top+O.top,bottom:ne.bottom-K.bottom+O.bottom,left:K.left-ne.left+O.left,right:ne.right-K.right+O.right},de=t.modifiersData.offset;if(C===B0&&de){var Ee=de[a];Object.keys(H).forEach(function(Pe){var Ze=[nu,tu].indexOf(Pe)>=0?1:-1,ke=[Sl,tu].indexOf(Pe)>=0?"y":"x";H[Pe]+=Ee[ke]*Ze})}return H}function oX(t,e){e===void 0&&(e={});var n=e,r=n.placement,a=n.boundary,l=n.rootBoundary,u=n.padding,s=n.flipVariations,m=n.allowedAutoPlacements,_=m===void 0?kN:m,b=Dy(r),M=b?s?sL:sL.filter(function(k){return Dy(k)===b}):bx,C=M.filter(function(k){return _.indexOf(k)>=0});C.length===0&&(C=M);var A=C.reduce(function(k,z){return k[z]=Z_(t,{placement:z,boundary:a,rootBoundary:l,padding:u})[td(z)],k},{});return Object.keys(A).sort(function(k,z){return A[k]-A[z]})}function sX(t){if(td(t)===nI)return[];var e=Wb(t);return[cL(t),e,cL(e)]}function aX(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var a=n.mainAxis,l=a===void 0?!0:a,u=n.altAxis,s=u===void 0?!0:u,m=n.fallbackPlacements,_=n.padding,b=n.boundary,M=n.rootBoundary,C=n.altBoundary,A=n.flipVariations,k=A===void 0?!0:A,z=n.allowedAutoPlacements,P=e.options.placement,O=td(P),j=O===P,U=m||(j||!k?[Wb(P)]:sX(P)),X=[P].concat(U).reduce(function(He,pt){return He.concat(td(pt)===nI?oX(e,{placement:pt,boundary:b,rootBoundary:M,padding:_,flipVariations:k,allowedAutoPlacements:z}):pt)},[]),K=e.rects.reference,se=e.rects.popper,J=new Map,ue=!0,ne=X[0],H=0;H<X.length;H++){var de=X[H],Ee=td(de),Pe=Dy(de)===Ay,Ze=[Sl,tu].indexOf(Ee)>=0,ke=Ze?"width":"height",Te=Z_(e,{placement:de,boundary:b,rootBoundary:M,altBoundary:C,padding:_}),Ie=Ze?Pe?nu:Ml:Pe?tu:Sl;K[ke]>se[ke]&&(Ie=Wb(Ie));var Ce=Wb(Ie),Ue=[];if(l&&Ue.push(Te[Ee]<=0),s&&Ue.push(Te[Ie]<=0,Te[Ce]<=0),Ue.every(function(He){return He})){ne=de,ue=!1;break}J.set(de,Ue)}if(ue)for(var nt=k?3:1,Le=function(pt){var _t=X.find(function(ot){var et=J.get(ot);if(et)return et.slice(0,pt).every(function(Mt){return Mt})});if(_t)return ne=_t,"break"},lt=nt;lt>0;lt--){var Ht=Le(lt);if(Ht==="break")break}e.placement!==ne&&(e.modifiersData[r]._skip=!0,e.placement=ne,e.reset=!0)}}const lX={name:"flip",enabled:!0,phase:"main",fn:aX,requiresIfExists:["offset"],data:{_skip:!1}};function hL(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function dL(t){return[Sl,nu,tu,Ml].some(function(e){return t[e]>=0})}function cX(t){var e=t.state,n=t.name,r=e.rects.reference,a=e.rects.popper,l=e.modifiersData.preventOverflow,u=Z_(e,{elementContext:"reference"}),s=Z_(e,{altBoundary:!0}),m=hL(u,r),_=hL(s,a,l),b=dL(m),M=dL(_);e.modifiersData[n]={referenceClippingOffsets:m,popperEscapeOffsets:_,isReferenceHidden:b,hasPopperEscaped:M},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":b,"data-popper-escaped":M})}const uX={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:cX};function hX(t,e,n){var r=td(t),a=[Ml,Sl].indexOf(r)>=0?-1:1,l=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,u=l[0],s=l[1];return u=u||0,s=(s||0)*a,[Ml,nu].indexOf(r)>=0?{x:s,y:u}:{x:u,y:s}}function dX(t){var e=t.state,n=t.options,r=t.name,a=n.offset,l=a===void 0?[0,0]:a,u=kN.reduce(function(b,M){return b[M]=hX(M,e.rects,l),b},{}),s=u[e.placement],m=s.x,_=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=_),e.modifiersData[r]=u}const fX={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:dX};function pX(t){var e=t.state,n=t.name;e.modifiersData[n]=$N({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const mX={name:"popperOffsets",enabled:!0,phase:"read",fn:pX,data:{}};function gX(t){return t==="x"?"y":"x"}function vX(t){var e=t.state,n=t.options,r=t.name,a=n.mainAxis,l=a===void 0?!0:a,u=n.altAxis,s=u===void 0?!1:u,m=n.boundary,_=n.rootBoundary,b=n.altBoundary,M=n.padding,C=n.tether,A=C===void 0?!0:C,k=n.tetherOffset,z=k===void 0?0:k,P=Z_(e,{boundary:m,rootBoundary:_,padding:M,altBoundary:b}),O=td(e.placement),j=Dy(e.placement),U=!j,X=oI(O),K=gX(X),se=e.modifiersData.popperOffsets,J=e.rects.reference,ue=e.rects.popper,ne=typeof z=="function"?z(Object.assign({},e.rects,{placement:e.placement})):z,H=typeof ne=="number"?{mainAxis:ne,altAxis:ne}:Object.assign({mainAxis:0,altAxis:0},ne),de=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ee={x:0,y:0};if(se){if(l){var Pe,Ze=X==="y"?Sl:Ml,ke=X==="y"?tu:nu,Te=X==="y"?"height":"width",Ie=se[X],Ce=Ie+P[Ze],Ue=Ie-P[ke],nt=A?-ue[Te]/2:0,Le=j===Ay?J[Te]:ue[Te],lt=j===Ay?-ue[Te]:-J[Te],Ht=e.elements.arrow,He=A&&Ht?iI(Ht):{width:0,height:0},pt=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:FN(),_t=pt[Ze],ot=pt[ke],et=v_(0,J[Te],He[Te]),Mt=U?J[Te]/2-nt-et-_t-H.mainAxis:Le-et-_t-H.mainAxis,Tt=U?-J[Te]/2+nt+et+ot+H.mainAxis:lt+et+ot+H.mainAxis,hn=e.elements.arrow&&wx(e.elements.arrow),en=hn?X==="y"?hn.clientTop||0:hn.clientLeft||0:0,an=(Pe=de?.[X])!=null?Pe:0,Ke=Ie+Mt-an-en,An=Ie+Tt-an,Gt=v_(A?xw(Ce,Ke):Ce,Ie,A?Eg(Ue,An):Ue);se[X]=Gt,Ee[X]=Gt-Ie}if(s){var on,Wt=X==="x"?Sl:Ml,Gn=X==="x"?tu:nu,dn=se[K],Ve=K==="y"?"height":"width",Se=dn+P[Wt],bt=dn-P[Gn],Nt=[Sl,Ml].indexOf(O)!==-1,jt=(on=de?.[K])!=null?on:0,Ut=Nt?Se:dn-J[Ve]-ue[Ve]-jt+H.altAxis,yn=Nt?dn+J[Ve]+ue[Ve]-jt-H.altAxis:bt,Zt=A&&Nt?$q(Ut,dn,yn):v_(A?Ut:Se,dn,A?yn:bt);se[K]=Zt,Ee[K]=Zt-dn}e.modifiersData[r]=Ee}}const yX={name:"preventOverflow",enabled:!0,phase:"main",fn:vX,requiresIfExists:["offset"]};function _X(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function xX(t){return t===vc(t)||!eu(t)?sI(t):_X(t)}function bX(t){var e=t.getBoundingClientRect(),n=Iy(e.width)/t.offsetWidth||1,r=Iy(e.height)/t.offsetHeight||1;return n!==1||r!==1}function wX(t,e,n){n===void 0&&(n=!1);var r=eu(e),a=eu(e)&&bX(e),l=sm(e),u=Ry(t,a,n),s={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(r||!r&&!n)&&((od(e)!=="body"||lI(l))&&(s=xX(e)),eu(e)?(m=Ry(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):l&&(m.x=aI(l))),{x:u.left+s.scrollLeft-m.x,y:u.top+s.scrollTop-m.y,width:u.width,height:u.height}}function SX(t){var e=new Map,n=new Set,r=[];t.forEach(function(l){e.set(l.name,l)});function a(l){n.add(l.name);var u=[].concat(l.requires||[],l.requiresIfExists||[]);u.forEach(function(s){if(!n.has(s)){var m=e.get(s);m&&a(m)}}),r.push(l)}return t.forEach(function(l){n.has(l.name)||a(l)}),r}function MX(t){var e=SX(t);return zq.reduce(function(n,r){return n.concat(e.filter(function(a){return a.phase===r}))},[])}function EX(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function CX(t){var e=t.reduce(function(n,r){var a=n[r.name];return n[r.name]=a?Object.assign({},a,r,{options:Object.assign({},a.options,r.options),data:Object.assign({},a.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var fL={placement:"bottom",modifiers:[],strategy:"absolute"};function pL(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function TX(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,a=e.defaultOptions,l=a===void 0?fL:a;return function(s,m,_){_===void 0&&(_=l);var b={placement:"bottom",orderedModifiers:[],options:Object.assign({},fL,l),modifiersData:{},elements:{reference:s,popper:m},attributes:{},styles:{}},M=[],C=!1,A={state:b,setOptions:function(O){var j=typeof O=="function"?O(b.options):O;z(),b.options=Object.assign({},l,b.options,j),b.scrollParents={reference:Ag(s)?y_(s):s.contextElement?y_(s.contextElement):[],popper:y_(m)};var U=MX(CX([].concat(r,b.options.modifiers)));return b.orderedModifiers=U.filter(function(X){return X.enabled}),k(),A.update()},forceUpdate:function(){if(!C){var O=b.elements,j=O.reference,U=O.popper;if(pL(j,U)){b.rects={reference:wX(j,wx(U),b.options.strategy==="fixed"),popper:iI(U)},b.reset=!1,b.placement=b.options.placement,b.orderedModifiers.forEach(function(H){return b.modifiersData[H.name]=Object.assign({},H.data)});for(var X=0;X<b.orderedModifiers.length;X++){if(b.reset===!0){b.reset=!1,X=-1;continue}var K=b.orderedModifiers[X],se=K.fn,J=K.options,ue=J===void 0?{}:J,ne=K.name;typeof se=="function"&&(b=se({state:b,options:ue,name:ne,instance:A})||b)}}}},update:EX(function(){return new Promise(function(P){A.forceUpdate(),P(b)})}),destroy:function(){z(),C=!0}};if(!pL(s,m))return A;A.setOptions(_).then(function(P){!C&&_.onFirstUpdate&&_.onFirstUpdate(P)});function k(){b.orderedModifiers.forEach(function(P){var O=P.name,j=P.options,U=j===void 0?{}:j,X=P.effect;if(typeof X=="function"){var K=X({state:b,name:O,instance:A,options:U}),se=function(){};M.push(K||se)}})}function z(){M.forEach(function(P){return P()}),M=[]}return A}}var PX=[Kq,mX,Zq,Nq,fX,lX,yX,Gq,uX],AX=TX({defaultModifiers:PX});const IX="Popper";function RX(t){return yW(IX,t)}const DX=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],LX=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function kX(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function JT(t){return typeof t=="function"?t():t}function zX(t){return t.nodeType!==void 0}const OX=()=>$r({root:["root"]},pW(RX)),FX={},NX=q.forwardRef(function(e,n){var r;const{anchorEl:a,children:l,direction:u,disablePortal:s,modifiers:m,open:_,placement:b,popperOptions:M,popperRef:C,slotProps:A={},slots:k={},TransitionProps:z}=e,P=lr(e,DX),O=q.useRef(null),j=pi(O,n),U=q.useRef(null),X=pi(U,C),K=q.useRef(X);df(()=>{K.current=X},[X]),q.useImperativeHandle(C,()=>U.current,[]);const se=kX(b,u),[J,ue]=q.useState(se),[ne,H]=q.useState(JT(a));q.useEffect(()=>{U.current&&U.current.forceUpdate()}),q.useEffect(()=>{a&&H(JT(a))},[a]),df(()=>{if(!ne||!_)return;const ke=Ce=>{ue(Ce.placement)};let Te=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Ce})=>{ke(Ce)}}];m!=null&&(Te=Te.concat(m)),M&&M.modifiers!=null&&(Te=Te.concat(M.modifiers));const Ie=AX(ne,O.current,ye({placement:se},M,{modifiers:Te}));return K.current(Ie),()=>{Ie.destroy(),K.current(null)}},[ne,s,m,_,M,se]);const de={placement:J};z!==null&&(de.TransitionProps=z);const Ee=OX(),Pe=(r=k.root)!=null?r:"div",Ze=MN({elementType:Pe,externalSlotProps:A.root,externalForwardedProps:P,additionalProps:{role:"tooltip",ref:j},ownerState:e,className:Ee.root});return ae.jsx(Pe,ye({},Ze,{children:typeof l=="function"?l(de):l}))}),TS=q.forwardRef(function(e,n){const{anchorEl:r,children:a,container:l,direction:u="ltr",disablePortal:s=!1,keepMounted:m=!1,modifiers:_,open:b,placement:M="bottom",popperOptions:C=FX,popperRef:A,style:k,transition:z=!1,slotProps:P={},slots:O={}}=e,j=lr(e,LX),[U,X]=q.useState(!0),K=()=>{X(!1)},se=()=>{X(!0)};if(!m&&!b&&(!z||U))return null;let J;if(l)J=l;else if(r){const H=JT(r);J=H&&zX(H)?pc(H).body:pc(null).body}const ue=!b&&m&&(!z||U)?"none":void 0,ne=z?{in:b,onEnter:K,onExited:se}:void 0;return ae.jsx(DN,{disablePortal:s,container:J,children:ae.jsx(NX,ye({anchorEl:r,direction:u,disablePortal:s,modifiers:_,ref:n,open:z?!U:b,placement:M,popperOptions:C,popperRef:A,slotProps:P,slots:O},j,{style:ye({position:"fixed",top:0,left:0,display:ue},k),TransitionProps:ne,children:a}))})}),bw={buttonClick:"buttonClick",browserAutoFill:"browserAutoFill"},BX=t=>{const{label:e,value:n}=t;return typeof e=="string"?e:typeof n=="string"?n:String(t)};function UX(t,e){const{open:n}=t,{context:{selectionMode:r}}=e;if(e.type===bw.buttonClick){var a;const m=(a=t.selectedValues[0])!=null?a:zs(null,"start",e.context);return ye({},t,{open:!n,highlightedValue:n?null:m})}if(e.type===bw.browserAutoFill)return QA(e.item,t,e.context);const l=wS(t,e);switch(e.type){case Ni.keyDown:if(t.open){if(e.event.key==="Escape")return ye({},l,{open:!1})}else{if(e.event.key==="ArrowDown"){var u;return ye({},t,{open:!0,highlightedValue:(u=t.selectedValues[0])!=null?u:zs(null,"start",e.context)})}if(e.event.key==="ArrowUp"){var s;return ye({},t,{open:!0,highlightedValue:(s=t.selectedValues[0])!=null?s:zs(null,"end",e.context)})}}break;case Ni.itemClick:if(r==="single")return ye({},l,{open:!1});break;case Ni.blur:return ye({},l,{open:!1});default:return l}return l}function $X(t){return Array.isArray(t)?t.length===0?"":JSON.stringify(t.map(e=>e.value)):t?.value==null?"":typeof t.value=="string"||typeof t.value=="number"?t.value:JSON.stringify(t.value)}function VX(t){const{areOptionsEqual:e,buttonRef:n,defaultOpen:r=!1,defaultValue:a,disabled:l=!1,listboxId:u,listboxRef:s,multiple:m=!1,name:_,required:b,onChange:M,onHighlightChange:C,onOpenChange:A,open:k,options:z,getOptionAsString:P=BX,getSerializedValue:O=$X,value:j,componentName:U="useSelect"}=t,X=q.useRef(null),K=pi(n,X),se=q.useRef(null),J=Pl(u);let ue;j===void 0&&a===void 0?ue=[]:a!==void 0&&(m?ue=a:ue=a==null?[]:[a]);const ne=q.useMemo(()=>{if(j!==void 0)return m?j:j==null?[]:[j]},[j,m]),{subitems:H,contextValue:de}=SS(),Ee=q.useMemo(()=>z!=null?new Map(z.map((ee,oe)=>[ee.value,{value:ee.value,label:ee.label,disabled:ee.disabled,ref:q.createRef(),id:`${J}_${oe}`}])):H,[z,H,J]),Pe=pi(s,se),{getRootProps:Ze,active:ke,focusVisible:Te,rootRef:Ie}=hd({disabled:l,rootRef:K}),Ce=q.useMemo(()=>Array.from(Ee.keys()),[Ee]),Ue=q.useCallback(ee=>{if(e!==void 0){const oe=Ce.find(fe=>e(fe,ee));return Ee.get(oe)}return Ee.get(ee)},[Ee,e,Ce]),nt=q.useCallback(ee=>{var oe;const fe=Ue(ee);return(oe=fe?.disabled)!=null?oe:!1},[Ue]),Le=q.useCallback(ee=>{const oe=Ue(ee);return oe?P(oe):""},[Ue,P]),lt=q.useMemo(()=>({selectedValues:ne,open:k}),[ne,k]),Ht=q.useCallback(ee=>{var oe;return(oe=Ee.get(ee))==null?void 0:oe.id},[Ee]),He=q.useCallback((ee,oe)=>{if(m)M?.(ee,oe);else{var fe;M?.(ee,(fe=oe[0])!=null?fe:null)}},[m,M]),pt=q.useCallback((ee,oe)=>{C?.(ee,oe??null)},[C]),_t=q.useCallback((ee,oe,fe)=>{if(oe==="open"&&(A?.(fe),fe===!1&&ee?.type!=="blur")){var he;(he=X.current)==null||he.focus()}},[A]),ot=q.useCallback(ee=>{var oe,fe;return ee==null?null:(oe=(fe=H.get(ee))==null?void 0:fe.ref.current)!=null?oe:null},[H]),et={getInitialState:()=>{var ee;return{highlightedValue:null,selectedValues:(ee=ue)!=null?ee:[],open:r}},getItemId:Ht,controlledProps:lt,focusManagement:"DOM",getItemDomElement:ot,itemComparer:e,isItemDisabled:nt,rootRef:Pe,onChange:He,onHighlightChange:pt,onStateChange:_t,reducerActionContext:q.useMemo(()=>({multiple:m}),[m]),items:Ce,getItemAsString:Le,selectionMode:m?"multiple":"single",stateReducer:UX,componentName:U},{dispatch:Mt,getRootProps:Tt,contextValue:hn,state:{open:en,highlightedValue:an,selectedValues:Ke},rootRef:An}=eI(et),Gt=q.useRef(en);df(()=>{if(en&&an!==null){var ee;const oe=(ee=Ue(an))==null?void 0:ee.ref;if(!se.current||!(oe!=null&&oe.current))return;Gt.current||oe.current.focus({preventScroll:!0});const fe=se.current.getBoundingClientRect(),he=oe.current.getBoundingClientRect();he.top<fe.top?se.current.scrollTop-=fe.top-he.top:he.bottom>fe.bottom&&(se.current.scrollTop+=he.bottom-fe.bottom)}},[en,an,Ue]);const on=q.useCallback(ee=>Ue(ee),[Ue]),Wt=ee=>oe=>{var fe;if(ee==null||(fe=ee.onClick)==null||fe.call(ee,oe),!oe.defaultMuiPrevented){const he={type:bw.buttonClick,event:oe};Mt(he)}},Gn=ee=>oe=>{var fe;(fe=ee.onKeyDown)==null||fe.call(ee,oe),!oe.defaultMuiPrevented&&(oe.key==="ArrowDown"||oe.key==="ArrowUp")&&(oe.preventDefault(),Mt({type:Ni.keyDown,key:oe.key,event:oe}))},dn=(ee={})=>({onClick:Wt(ee),onKeyDown:Gn(ee)}),Ve=(ee={})=>ye({},ee,dn(ee),{role:"combobox","aria-expanded":en,"aria-controls":J}),Se=(ee={})=>{const oe=gs(ee),fe=ff(Ve,Ze);return ye({},ee,fe(oe))},bt=ee=>oe=>{var fe,he;(fe=ee.onBlur)==null||fe.call(ee,oe),!oe.defaultMuiPrevented&&((he=se.current)!=null&&he.contains(oe.relatedTarget)||oe.relatedTarget===X.current)&&(oe.defaultMuiPrevented=!0)},Nt=(ee={})=>({onBlur:bt(ee)}),jt=(ee={})=>{const oe=gs(ee),fe=ff(Nt,Tt);return ye({id:J,role:"listbox","aria-multiselectable":m?"true":void 0},ee,fe(oe))};q.useDebugValue({selectedOptions:Ke,highlightedOption:an,open:en});const Ut=q.useMemo(()=>ye({},hn,de),[hn,de]);let yn;t.multiple?yn=Ke:yn=Ke.length>0?Ke[0]:null;let Zt;if(m)Zt=yn.map(ee=>on(ee)).filter(ee=>ee!==void 0);else{var qt;Zt=(qt=on(yn))!=null?qt:null}const Fn=ee=>oe=>{var fe;if(ee==null||(fe=ee.onChange)==null||fe.call(ee,oe),oe.defaultMuiPrevented)return;const he=Ee.get(oe.target.value);oe.target.value===""?Mt({type:Ni.clearSelection}):he!==void 0&&Mt({type:bw.browserAutoFill,item:he.value,event:oe})};return{buttonActive:ke,buttonFocusVisible:Te,buttonRef:Ie,contextValue:Ut,disabled:l,dispatch:Mt,getButtonProps:Se,getHiddenInputProps:(ee={})=>{const oe=gs(ee);return ye({name:_,tabIndex:-1,"aria-hidden":!0,required:b?!0:void 0,value:O(Zt),style:EG},ee,{onChange:Fn(oe)})},getListboxProps:jt,getOptionMetadata:on,listboxRef:An,open:en,options:Ce,value:yn,highlightedOption:an}}function jX(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:a,getItemState:l,registerItem:u,totalSubitemCount:s}=e,m=q.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:a}),[r,a,l]),_=q.useMemo(()=>({getItemIndex:a,registerItem:u,totalSubitemCount:s}),[u,a,s]);return ae.jsx(xx.Provider,{value:_,children:ae.jsx(om.Provider,{value:m,children:n})})}function HX(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:a,resumeHideDuration:l}=t,u=n_();q.useEffect(()=>{if(!a)return;function O(j){j.defaultPrevented||(j.key==="Escape"||j.key==="Esc")&&r?.(j,"escapeKeyDown")}return document.addEventListener("keydown",O),()=>{document.removeEventListener("keydown",O)}},[a,r]);const s=nh((O,j)=>{r?.(O,j)}),m=nh(O=>{!r||O==null||u.start(O,()=>{s(null,"timeout")})});q.useEffect(()=>(a&&m(e),u.clear),[a,e,m,u]);const _=O=>{r?.(O,"clickaway")},b=u.clear,M=q.useCallback(()=>{e!=null&&m(l??e*.5)},[e,l,m]),C=O=>j=>{const U=O.onBlur;U?.(j),M()},A=O=>j=>{const U=O.onFocus;U?.(j),b()},k=O=>j=>{const U=O.onMouseEnter;U?.(j),b()},z=O=>j=>{const U=O.onMouseLeave;U?.(j),M()};return q.useEffect(()=>{if(!n&&a)return window.addEventListener("focus",M),window.addEventListener("blur",b),()=>{window.removeEventListener("focus",M),window.removeEventListener("blur",b)}},[n,a,M,b]),{getRootProps:(O={})=>{const j=ye({},gs(t),gs(O));return ye({role:"presentation"},O,j,{onBlur:C(j),onFocus:A(j),onMouseEnter:k(j),onMouseLeave:z(j)})},onClickAway:_}}function GX(t){const{checked:e,defaultChecked:n,disabled:r,onBlur:a,onChange:l,onFocus:u,onFocusVisible:s,readOnly:m,required:_}=t,[b,M]=vy({controlled:e,default:!!n,name:"Switch",state:"checked"}),C=ue=>ne=>{var H;ne.nativeEvent.defaultPrevented||(M(ne.target.checked),l?.(ne),(H=ue.onChange)==null||H.call(ue,ne))},{isFocusVisibleRef:A,onBlur:k,onFocus:z,ref:P}=yS(),[O,j]=q.useState(!1);r&&O&&j(!1),q.useEffect(()=>{A.current=O},[O,A]);const U=q.useRef(null),X=ue=>ne=>{var H;U.current||(U.current=ne.currentTarget),z(ne),A.current===!0&&(j(!0),s?.(ne)),u?.(ne),(H=ue.onFocus)==null||H.call(ue,ne)},K=ue=>ne=>{var H;k(ne),A.current===!1&&j(!1),a?.(ne),(H=ue.onBlur)==null||H.call(ue,ne)},se=pi(P,U);return{checked:b,disabled:!!r,focusVisible:O,getInputProps:(ue={})=>ye({checked:e,defaultChecked:n,disabled:r,readOnly:m,ref:se,required:_,type:"checkbox",role:"switch","aria-checked":e},ue,{onChange:C(ue),onFocus:X(ue),onBlur:K(ue)}),inputRef:se,readOnly:!!m}}function WX(t){const{value:e,defaultValue:n,onChange:r,orientation:a="horizontal",direction:l="ltr",selectionFollowsFocus:u=!1}=t,[s,m]=vy({controlled:e,default:n,name:"Tabs",state:"value"}),_=q.useCallback((P,O)=>{m(O),r?.(P,O)},[r,m]),{subitems:b,contextValue:M}=SS(),C=q.useRef(()=>{}),A=q.useCallback(P=>{var O;return(O=b.get(P))==null?void 0:O.id},[b]),k=q.useCallback(P=>C.current(P),[]),z=q.useCallback(P=>{C.current=P},[]);return{contextValue:ye({direction:l,getTabId:k,getTabPanelId:A,onSelected:_,orientation:a,registerTabIdLookup:z,selectionFollowsFocus:u,value:s},M)}}const VN=q.createContext(null);function PS(){const t=q.useContext(VN);if(t==null)throw new Error("No TabsContext provided");return t}function qX(t){const{value:e,children:n}=t,{direction:r,getItemIndex:a,onSelected:l,orientation:u,registerItem:s,registerTabIdLookup:m,selectionFollowsFocus:_,totalSubitemCount:b,value:M,getTabId:C,getTabPanelId:A}=e,k=q.useMemo(()=>({getItemIndex:a,registerItem:s,totalSubitemCount:b}),[s,a,b]),z=q.useMemo(()=>({direction:r,getTabId:C,getTabPanelId:A,onSelected:l,orientation:u,registerTabIdLookup:m,selectionFollowsFocus:_,value:M}),[r,C,A,l,u,m,_,M]);return ae.jsx(xx.Provider,{value:k,children:ae.jsx(VN.Provider,{value:z,children:n})})}function XX(t){return t.size}function ZX(t){const{value:e,id:n,rootRef:r}=t,a=PS();if(a===null)throw new Error("No TabContext provided");const{value:l,getTabId:u}=a,s=Pl(n),m=q.useRef(null),_=pi(m,r),b=q.useMemo(()=>({id:s,ref:m}),[s]),{id:M}=MS(e??XX,b),C=M!==l,A=M!==void 0?u(M):void 0;return{hidden:C,getRootProps:(z={})=>ye({"aria-labelledby":A??void 0,hidden:C,id:s??void 0},z,{ref:_}),rootRef:_}}const jN={valueChange:"valueChange"};function YX(t,e){if(e.type===jN.valueChange)return ye({},t,{highlightedValue:e.value});const n=wS(t,e),{context:{selectionFollowsFocus:r}}=e;if(e.type===Ni.itemsChange){if(n.selectedValues.length>0)return ye({},n,{highlightedValue:n.selectedValues[0]});zs(null,"reset",e.context)}return r&&n.highlightedValue!=null?ye({},n,{selectedValues:[n.highlightedValue]}):n}function KX(t){var e;const{rootRef:n}=t,{direction:r="ltr",onSelected:a,orientation:l="horizontal",value:u,registerTabIdLookup:s,selectionFollowsFocus:m}=PS(),{subitems:_,contextValue:b}=SS(),M=q.useCallback(de=>{var Ee;return(Ee=_.get(de))==null?void 0:Ee.id},[_]);s(M);const C=q.useMemo(()=>Array.from(_.keys()),[_]),A=q.useCallback(de=>{var Ee,Pe;return de==null?null:(Ee=(Pe=_.get(de))==null?void 0:Pe.ref.current)!=null?Ee:null},[_]),k=r==="rtl";let z;l==="vertical"?z="vertical":z=k?"horizontal-rtl":"horizontal-ltr";const P=q.useCallback((de,Ee)=>{var Pe;a(de,(Pe=Ee[0])!=null?Pe:null)},[a]),O=q.useMemo(()=>u===void 0?{}:u!=null?{selectedValues:[u]}:{selectedValues:[]},[u]),j=q.useCallback(de=>{var Ee,Pe;return(Ee=(Pe=_.get(de))==null?void 0:Pe.disabled)!=null?Ee:!1},[_]),{contextValue:U,dispatch:X,getRootProps:K,state:{highlightedValue:se,selectedValues:J},rootRef:ue}=eI({controlledProps:O,disabledItemsFocusable:!m,focusManagement:"DOM",getItemDomElement:A,isItemDisabled:j,items:C,rootRef:n,onChange:P,orientation:z,reducerActionContext:q.useMemo(()=>({selectionFollowsFocus:m||!1}),[m]),selectionMode:"single",stateReducer:YX});q.useEffect(()=>{u!==void 0&&u!=null&&X({type:jN.valueChange,value:u})},[X,u]);const ne=(de={})=>ye({},de,K(de),{"aria-orientation":l==="vertical"?"vertical":void 0,role:"tablist"});return{contextValue:q.useMemo(()=>ye({},b,U),[b,U]),dispatch:X,getRootProps:ne,highlightedValue:se,isRtl:k,orientation:l,rootRef:ue,selectedValue:(e=J[0])!=null?e:null}}function JX(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:a,getItemState:l,registerItem:u,totalSubitemCount:s}=e,m=q.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:a}),[r,a,l]),_=q.useMemo(()=>({getItemIndex:a,registerItem:u,totalSubitemCount:s}),[u,a,s]);return ae.jsx(xx.Provider,{value:_,children:ae.jsx(om.Provider,{value:m,children:n})})}function QX(t){return t.size}function eZ(t){const{value:e,rootRef:n,disabled:r=!1,id:a}=t,l=q.useRef(null),u=Pl(a),{value:s,selectionFollowsFocus:m,getTabPanelId:_}=PS(),b=q.useMemo(()=>({disabled:r,ref:l,id:u}),[r,l,u]),{id:M,index:C,totalItemCount:A}=MS(e??QX,b),{getRootProps:k,highlighted:z,selected:P}=tI({item:M}),{getRootProps:O,rootRef:j,active:U,focusVisible:X,setFocusVisible:K}=hd({disabled:r,focusableWhenDisabled:!m,type:"button"}),se=pi(l,n,j),J=M!==void 0?_(M):void 0;return{getRootProps:(ne={})=>{const H=gs(ne),de=ff(k,O);return ye({},ne,de(H),{role:"tab","aria-controls":J,"aria-selected":P,id:u,ref:se})},active:U,focusVisible:X,highlighted:z,index:C,rootRef:se,selected:P||M===s,setFocusVisible:K,totalTabsCount:A}}function mL(t){return typeof t.normalize<"u"?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):t}function HN(t={}){const{ignoreAccents:e=!0,ignoreCase:n=!0,limit:r,matchFrom:a="any",stringify:l,trim:u=!1}=t;return(s,{inputValue:m,getOptionLabel:_})=>{let b=u?m.trim():m;n&&(b=b.toLowerCase()),e&&(b=mL(b));const M=b?s.filter(C=>{let A=(l||_)(C);return n&&(A=A.toLowerCase()),e&&(A=mL(A)),a==="start"?A.indexOf(b)===0:A.indexOf(b)>-1}):s;return typeof r=="number"?M.slice(0,r):M}}function Y1(t,e){for(let n=0;n<t.length;n+=1)if(e(t[n]))return n;return-1}const tZ=HN(),gL=5,nZ=t=>{var e;return t.current!==null&&((e=t.current.parentElement)==null?void 0:e.contains(document.activeElement))},rZ=[];function iZ(t){const{unstable_isActiveElementInListbox:e=nZ,unstable_classNamePrefix:n="Mui",autoComplete:r=!1,autoHighlight:a=!1,autoSelect:l=!1,blurOnSelect:u=!1,clearOnBlur:s=!t.freeSolo,clearOnEscape:m=!1,componentName:_="useAutocomplete",defaultValue:b=t.multiple?rZ:null,disableClearable:M=!1,disableCloseOnSelect:C=!1,disabled:A,disabledItemsFocusable:k=!1,disableListWrap:z=!1,filterOptions:P=tZ,filterSelectedOptions:O=!1,freeSolo:j=!1,getOptionDisabled:U,getOptionKey:X,getOptionLabel:K=ct=>{var ut;return(ut=ct.label)!=null?ut:ct},groupBy:se,handleHomeEndKeys:J=!t.freeSolo,id:ue,includeInputInList:ne=!1,inputValue:H,isOptionEqualToValue:de=(ct,ut)=>ct===ut,multiple:Ee=!1,onChange:Pe,onClose:Ze,onHighlightChange:ke,onInputChange:Te,onOpen:Ie,open:Ce,openOnFocus:Ue=!1,options:nt,readOnly:Le=!1,selectOnFocus:lt=!t.freeSolo,value:Ht}=t,He=Pl(ue);let pt=K;pt=ct=>{const ut=K(ct);return typeof ut!="string"?String(ut):ut};const _t=q.useRef(!1),ot=q.useRef(!0),et=q.useRef(null),Mt=q.useRef(null),[Tt,hn]=q.useState(null),[en,an]=q.useState(-1),Ke=a?0:-1,An=q.useRef(Ke),[Gt,on]=vy({controlled:Ht,default:b,name:_}),[Wt,Gn]=vy({controlled:H,default:"",name:_,state:"inputValue"}),[dn,Ve]=q.useState(!1),Se=q.useCallback((ct,ut)=>{if(!(Ee?Gt.length<ut.length:ut!==null)&&!s)return;let En;if(Ee)En="";else if(ut==null)En="";else{const Bn=pt(ut);En=typeof Bn=="string"?Bn:""}Wt!==En&&(Gn(En),Te&&Te(ct,En,"reset"))},[pt,Wt,Ee,Te,Gn,s,Gt]),[bt,Nt]=vy({controlled:Ce,default:!1,name:_,state:"open"}),[jt,Ut]=q.useState(!0),yn=!Ee&&Gt!=null&&Wt===pt(Gt),Zt=bt&&!Le,qt=Zt?P(nt.filter(ct=>!(O&&(Ee?Gt:[Gt]).some(ut=>ut!==null&&de(ct,ut)))),{inputValue:yn&&jt?"":Wt,getOptionLabel:pt}):[],Fn=MG({filteredOptions:qt,value:Gt,inputValue:Wt});q.useEffect(()=>{const ct=Gt!==Fn.value;dn&&!ct||j&&!ct||Se(null,Gt)},[Gt,Se,dn,Fn.value,j]);const Be=bt&&qt.length>0&&!Le,ee=nh(ct=>{ct===-1?et.current.focus():Tt.querySelector(`[data-tag-index="${ct}"]`).focus()});q.useEffect(()=>{Ee&&en>Gt.length-1&&(an(-1),ee(-1))},[Gt,Ee,en,ee]);function oe(ct,ut){if(!Mt.current||ct<0||ct>=qt.length)return-1;let Vt=ct;for(;;){const En=Mt.current.querySelector(`[data-option-index="${Vt}"]`),Bn=k?!1:!En||En.disabled||En.getAttribute("aria-disabled")==="true";if(En&&En.hasAttribute("tabindex")&&!Bn)return Vt;if(ut==="next"?Vt=(Vt+1)%qt.length:Vt=(Vt-1+qt.length)%qt.length,Vt===ct)return-1}}const fe=nh(({event:ct,index:ut,reason:Vt="auto"})=>{if(An.current=ut,ut===-1?et.current.removeAttribute("aria-activedescendant"):et.current.setAttribute("aria-activedescendant",`${He}-option-${ut}`),ke&&ke(ct,ut===-1?null:qt[ut],Vt),!Mt.current)return;const En=Mt.current.querySelector(`[role="option"].${n}-focused`);En&&(En.classList.remove(`${n}-focused`),En.classList.remove(`${n}-focusVisible`));let Bn=Mt.current;if(Mt.current.getAttribute("role")!=="listbox"&&(Bn=Mt.current.parentElement.querySelector('[role="listbox"]')),!Bn)return;if(ut===-1){Bn.scrollTop=0;return}const In=Mt.current.querySelector(`[data-option-index="${ut}"]`);if(In&&(In.classList.add(`${n}-focused`),Vt==="keyboard"&&In.classList.add(`${n}-focusVisible`),Bn.scrollHeight>Bn.clientHeight&&Vt!=="mouse"&&Vt!=="touch")){const fr=In,Re=Bn.clientHeight+Bn.scrollTop,mt=fr.offsetTop+fr.offsetHeight;mt>Re?Bn.scrollTop=mt-Bn.clientHeight:fr.offsetTop-fr.offsetHeight*(se?1.3:0)<Bn.scrollTop&&(Bn.scrollTop=fr.offsetTop-fr.offsetHeight*(se?1.3:0))}}),he=nh(({event:ct,diff:ut,direction:Vt="next",reason:En="auto"})=>{if(!Zt)return;const In=oe((()=>{const fr=qt.length-1;if(ut==="reset")return Ke;if(ut==="start")return 0;if(ut==="end")return fr;const Re=An.current+ut;return Re<0?Re===-1&&ne?-1:z&&An.current!==-1||Math.abs(ut)>1?0:fr:Re>fr?Re===fr+1&&ne?-1:z||Math.abs(ut)>1?fr:0:Re})(),Vt);if(fe({index:In,reason:En,event:ct}),r&&ut!=="reset")if(In===-1)et.current.value=Wt;else{const fr=pt(qt[In]);et.current.value=fr,fr.toLowerCase().indexOf(Wt.toLowerCase())===0&&Wt.length>0&&et.current.setSelectionRange(Wt.length,fr.length)}}),xe=()=>{const ct=(ut,Vt)=>{const En=ut?pt(ut):"",Bn=Vt?pt(Vt):"";return En===Bn};if(An.current!==-1&&Fn.filteredOptions&&Fn.filteredOptions.length!==qt.length&&Fn.inputValue===Wt&&(Ee?Gt.length===Fn.value.length&&Fn.value.every((ut,Vt)=>pt(Gt[Vt])===pt(ut)):ct(Fn.value,Gt))){const ut=Fn.filteredOptions[An.current];if(ut)return Y1(qt,Vt=>pt(Vt)===pt(ut))}return-1},Ye=q.useCallback(()=>{if(!Zt)return;const ct=xe();if(ct!==-1){An.current=ct;return}const ut=Ee?Gt[0]:Gt;if(qt.length===0||ut==null){he({diff:"reset"});return}if(Mt.current){if(ut!=null){const Vt=qt[An.current];if(Ee&&Vt&&Y1(Gt,Bn=>de(Vt,Bn))!==-1)return;const En=Y1(qt,Bn=>de(Bn,ut));En===-1?he({diff:"reset"}):fe({index:En});return}if(An.current>=qt.length-1){fe({index:qt.length-1});return}fe({index:An.current})}},[qt.length,Ee?!1:Gt,O,he,fe,Zt,Wt,Ee]),st=nh(ct=>{_w(Mt,ct),ct&&Ye()});q.useEffect(()=>{Ye()},[Ye]);const _e=ct=>{bt||(Nt(!0),Ut(!0),Ie&&Ie(ct))},Fe=(ct,ut)=>{bt&&(Nt(!1),Ze&&Ze(ct,ut))},Ge=(ct,ut,Vt,En)=>{if(Ee){if(Gt.length===ut.length&&Gt.every((Bn,In)=>Bn===ut[In]))return}else if(Gt===ut)return;Pe&&Pe(ct,ut,Vt,En),on(ut)},je=q.useRef(!1),De=(ct,ut,Vt="selectOption",En="options")=>{let Bn=Vt,In=ut;if(Ee){In=Array.isArray(Gt)?Gt.slice():[];const fr=Y1(In,Re=>de(ut,Re));fr===-1?In.push(ut):En!=="freeSolo"&&(In.splice(fr,1),Bn="removeOption")}Se(ct,In),Ge(ct,In,Bn,{option:ut}),!C&&(!ct||!ct.ctrlKey&&!ct.metaKey)&&Fe(ct,Bn),(u===!0||u==="touch"&&je.current||u==="mouse"&&!je.current)&&et.current.blur()};function zt(ct,ut){if(ct===-1)return-1;let Vt=ct;for(;;){if(ut==="next"&&Vt===Gt.length||ut==="previous"&&Vt===-1)return-1;const En=Tt.querySelector(`[data-tag-index="${Vt}"]`);if(!En||!En.hasAttribute("tabindex")||En.disabled||En.getAttribute("aria-disabled")==="true")Vt+=ut==="next"?1:-1;else return Vt}}const fn=(ct,ut)=>{if(!Ee)return;Wt===""&&Fe(ct,"toggleInput");let Vt=en;en===-1?Wt===""&&ut==="previous"&&(Vt=Gt.length-1):(Vt+=ut==="next"?1:-1,Vt<0&&(Vt=0),Vt===Gt.length&&(Vt=-1)),Vt=zt(Vt,ut),an(Vt),ee(Vt)},sn=ct=>{_t.current=!0,Gn(""),Te&&Te(ct,"","clear"),Ge(ct,Ee?[]:null,"clear")},Jt=ct=>ut=>{if(ct.onKeyDown&&ct.onKeyDown(ut),!ut.defaultMuiPrevented&&(en!==-1&&["ArrowLeft","ArrowRight"].indexOf(ut.key)===-1&&(an(-1),ee(-1)),ut.which!==229))switch(ut.key){case"Home":Zt&&J&&(ut.preventDefault(),he({diff:"start",direction:"next",reason:"keyboard",event:ut}));break;case"End":Zt&&J&&(ut.preventDefault(),he({diff:"end",direction:"previous",reason:"keyboard",event:ut}));break;case"PageUp":ut.preventDefault(),he({diff:-gL,direction:"previous",reason:"keyboard",event:ut}),_e(ut);break;case"PageDown":ut.preventDefault(),he({diff:gL,direction:"next",reason:"keyboard",event:ut}),_e(ut);break;case"ArrowDown":ut.preventDefault(),he({diff:1,direction:"next",reason:"keyboard",event:ut}),_e(ut);break;case"ArrowUp":ut.preventDefault(),he({diff:-1,direction:"previous",reason:"keyboard",event:ut}),_e(ut);break;case"ArrowLeft":fn(ut,"previous");break;case"ArrowRight":fn(ut,"next");break;case"Enter":if(An.current!==-1&&Zt){const Vt=qt[An.current],En=U?U(Vt):!1;if(ut.preventDefault(),En)return;De(ut,Vt,"selectOption"),r&&et.current.setSelectionRange(et.current.value.length,et.current.value.length)}else j&&Wt!==""&&yn===!1&&(Ee&&ut.preventDefault(),De(ut,Wt,"createOption","freeSolo"));break;case"Escape":Zt?(ut.preventDefault(),ut.stopPropagation(),Fe(ut,"escape")):m&&(Wt!==""||Ee&&Gt.length>0)&&(ut.preventDefault(),ut.stopPropagation(),sn(ut));break;case"Backspace":if(Ee&&!Le&&Wt===""&&Gt.length>0){const Vt=en===-1?Gt.length-1:en,En=Gt.slice();En.splice(Vt,1),Ge(ut,En,"removeOption",{option:Gt[Vt]})}break;case"Delete":if(Ee&&!Le&&Wt===""&&Gt.length>0&&en!==-1){const Vt=en,En=Gt.slice();En.splice(Vt,1),Ge(ut,En,"removeOption",{option:Gt[Vt]})}break}},cn=ct=>{Ve(!0),Ue&&!_t.current&&_e(ct)},Zn=ct=>{if(e(Mt)){et.current.focus();return}Ve(!1),ot.current=!0,_t.current=!1,l&&An.current!==-1&&Zt?De(ct,qt[An.current],"blur"):l&&j&&Wt!==""?De(ct,Wt,"blur","freeSolo"):s&&Se(ct,Gt),Fe(ct,"blur")},yr=ct=>{const ut=ct.target.value;Wt!==ut&&(Gn(ut),Ut(!1),Te&&Te(ct,ut,"input")),ut===""?!M&&!Ee&&Ge(ct,null,"clear"):_e(ct)},Ar=ct=>{const ut=Number(ct.currentTarget.getAttribute("data-option-index"));An.current!==ut&&fe({event:ct,index:ut,reason:"mouse"})},Je=ct=>{fe({event:ct,index:Number(ct.currentTarget.getAttribute("data-option-index")),reason:"touch"}),je.current=!0},gt=ct=>{const ut=Number(ct.currentTarget.getAttribute("data-option-index"));De(ct,qt[ut],"selectOption"),je.current=!1},St=ct=>ut=>{const Vt=Gt.slice();Vt.splice(ct,1),Ge(ut,Vt,"removeOption",{option:Gt[ct]})},ft=ct=>{bt?Fe(ct,"toggleInput"):_e(ct)},Qt=ct=>{ct.currentTarget.contains(ct.target)&&ct.target.getAttribute("id")!==He&&ct.preventDefault()},Sn=ct=>{ct.currentTarget.contains(ct.target)&&(et.current.focus(),lt&&ot.current&&et.current.selectionEnd-et.current.selectionStart===0&&et.current.select(),ot.current=!1)},Un=ct=>{!A&&(Wt===""||!bt)&&ft(ct)};let kn=j&&Wt.length>0;kn=kn||(Ee?Gt.length>0:Gt!==null);let Rt=qt;return se&&(Rt=qt.reduce((ct,ut,Vt)=>{const En=se(ut);return ct.length>0&&ct[ct.length-1].group===En?ct[ct.length-1].options.push(ut):ct.push({key:Vt,index:Vt,group:En,options:[ut]}),ct},[])),A&&dn&&Zn(),{getRootProps:(ct={})=>ye({"aria-owns":Be?`${He}-listbox`:null},ct,{onKeyDown:Jt(ct),onMouseDown:Qt,onClick:Sn}),getInputLabelProps:()=>({id:`${He}-label`,htmlFor:He}),getInputProps:()=>({id:He,value:Wt,onBlur:Zn,onFocus:cn,onChange:yr,onMouseDown:Un,"aria-activedescendant":Zt?"":null,"aria-autocomplete":r?"both":"list","aria-controls":Be?`${He}-listbox`:void 0,"aria-expanded":Be,autoComplete:"off",ref:et,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:A}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:sn}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:ft}),getTagProps:({index:ct})=>ye({key:ct,"data-tag-index":ct,tabIndex:-1},!Le&&{onDelete:St(ct)}),getListboxProps:()=>({role:"listbox",id:`${He}-listbox`,"aria-labelledby":`${He}-label`,ref:st,onMouseDown:ct=>{ct.preventDefault()}}),getOptionProps:({index:ct,option:ut})=>{var Vt;const En=(Ee?Gt:[Gt]).some(In=>In!=null&&de(ut,In)),Bn=U?U(ut):!1;return{key:(Vt=X?.(ut))!=null?Vt:pt(ut),tabIndex:-1,role:"option",id:`${He}-option-${ct}`,onMouseMove:Ar,onClick:gt,onTouchStart:Je,"data-option-index":ct,"aria-disabled":Bn,"aria-selected":En}},id:He,inputValue:Wt,value:Gt,dirty:kn,expanded:Zt&&Tt,popupOpen:Zt,focused:dn||en!==-1,anchorEl:Tt,setAnchorEl:hn,focusedTag:en,groupedOptions:Rt}}const oZ=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],sZ=["component","slots","slotProps"],aZ=["component"];function $n(t,e){const{className:n,elementType:r,ownerState:a,externalForwardedProps:l,getSlotOwnerState:u,internalForwardedProps:s}=e,m=lr(e,oZ),{component:_,slots:b={[t]:void 0},slotProps:M={[t]:void 0}}=l,C=lr(l,sZ),A=b[t]||r,k=SN(M[t],a),z=wN(ye({className:n},m,{externalForwardedProps:t==="root"?C:void 0,externalSlotProps:k})),{props:{component:P},internalRef:O}=z,j=lr(z.props,aZ),U=pi(O,k?.ref,e.ref),X=u?u(j):{},K=ye({},a,X),se=t==="root"?P||_:P,J=bN(A,ye({},t==="root"&&!_&&!b[t]&&s,t!=="root"&&!b[t]&&s,j,se&&{as:se},{ref:U}),K);return Object.keys(X).forEach(ue=>{delete J[ue]}),[A,J]}function lZ(t){return Hr("MuiListItem",t)}const ww=Nr("MuiListItem",["root","startAction","endAction","nested","nesting","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]),Sw=q.createContext(!1),Zy=q.createContext(!1),GN=q.createContext(!1),cI=q.createContext(void 0),WN=q.createContext(void 0),AS=q.createContext(void 0),cZ=["component","className","children","nested","sticky","variant","color","startAction","endAction","role","slots","slotProps"],uZ=t=>{const{sticky:e,nested:n,nesting:r,variant:a,color:l}=t,u={root:["root",n&&"nested",r&&"nesting",e&&"sticky",l&&`color${Ln(l)}`,a&&`variant${Ln(a)}`],startAction:["startAction"],endAction:["endAction"]};return $r(u,lZ,{})},hZ=vn("li")(({theme:t,ownerState:e})=>{var n;return[!e.nested&&{"--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItemButton-marginBlock":"calc(-1 * var(--ListItem-paddingY))",alignItems:"center",gap:"var(--ListItem-gap)",marginInline:"var(--ListItem-marginInline)"},e.nested&&{"--NestedList-marginRight":"calc(-1 * var(--ListItem-paddingRight))","--NestedList-marginLeft":"calc(-1 * var(--ListItem-paddingLeft))","--NestedListItem-paddingLeft":"calc(var(--ListItem-paddingLeft) + var(--List-nestedInsetStart))","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItem-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))",flexDirection:"column"},ye({"--unstable_actionRadius":"calc(var(--ListItem-radius) - var(--variant-borderWidth, 0px))"},e.startAction&&{"--unstable_startActionWidth":"2rem"},e.endAction&&{"--unstable_endActionWidth":"2.5rem"},{boxSizing:"border-box",borderRadius:"var(--ListItem-radius)",display:"var(--_ListItem-display)","&:not([hidden])":{"--_ListItem-display":"var(--_List-markerDisplay, flex)"},flex:"none",listStyleType:"var(--_List-markerType, disc)",position:"relative",paddingBlockStart:e.nested?0:"var(--ListItem-paddingY)",paddingBlockEnd:e.nested?0:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)"},e["data-first-child"]===void 0&&ye({},e.row?{marginInlineStart:"var(--List-gap)"}:{marginBlockStart:"var(--List-gap)"}),e.row&&e.wrap&&{marginInlineStart:"var(--List-gap)",marginBlockStart:"var(--List-gap)"},{minBlockSize:"var(--ListItem-minHeight)"},e.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:`var(--ListItem-stickyBackground, ${t.vars.palette.background.body})`},{[`.${ww.nested} > &`]:{"--_ListItem-display":"flex"}}),(n=t.variants[e.variant])==null?void 0:n[e.color]]}),dZ=vn(hZ,{name:"JoyListItem",slot:"Root",overridesResolver:(t,e)=>e.root})({}),fZ=vn("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(t,e)=>e.startAction})(({ownerState:t})=>({display:"inherit",position:"absolute",top:t.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",left:0,transform:"translate(var(--ListItem-startActionTranslateX), -50%)",zIndex:1})),pZ=vn("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(t,e)=>e.startAction})(({ownerState:t})=>({display:"inherit",position:"absolute",top:t.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",right:0,transform:"translate(var(--ListItem-endActionTranslateX), -50%)"})),am=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyListItem"}),a=q.useContext(AS),l=q.useContext(cI),u=q.useContext(Zy),s=q.useContext(GN),m=q.useContext(Sw),{component:_,className:b,children:M,nested:C=!1,sticky:A=!1,variant:k="plain",color:z="neutral",startAction:P,endAction:O,role:j,slots:U={},slotProps:X={}}=r,K=lr(r,cZ),[se,J]=q.useState(""),[ue,ne]=l?.split(":")||["",""],H=_||(ue&&!ue.match(/^(ul|ol|menu)$/)?"div":void 0);let de=a==="menu"?"none":void 0;l&&(de={menu:"none",menubar:"none",group:"presentation"}[ne]),j&&(de=j);const Ee=ye({},r,{sticky:A,startAction:P,endAction:O,row:u,wrap:s,variant:k,color:z,nesting:m,nested:C,component:H,role:de}),Pe=uZ(Ee),Ze=ye({},K,{component:H,slots:U,slotProps:X}),[ke,Te]=$n("root",{additionalProps:{role:de},ref:n,className:yo(Pe.root,b),elementType:dZ,externalForwardedProps:Ze,ownerState:Ee}),[Ie,Ce]=$n("startAction",{className:Pe.startAction,elementType:fZ,externalForwardedProps:Ze,ownerState:Ee}),[Ue,nt]=$n("endAction",{className:Pe.endAction,elementType:pZ,externalForwardedProps:Ze,ownerState:Ee});return ae.jsx(WN.Provider,{value:J,children:ae.jsx(Sw.Provider,{value:C?se||!0:!1,children:ae.jsxs(ke,ye({},Te,{children:[P&&ae.jsx(Ie,ye({},Ce,{children:P})),q.Children.map(M,(Le,lt)=>{var Ht;return q.isValidElement(Le)?q.cloneElement(Le,ye({},lt===0&&{"data-first-child":""},gS(Le,["ListItem"])&&{component:((Ht=Le.props)==null?void 0:Ht.component)||"div"})):Le}),O&&ae.jsx(Ue,ye({},nt,{children:O}))]}))})})});am.muiName="ListItem";const IS={"--NestedList-marginRight":"0px","--NestedList-marginLeft":"0px","--NestedListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px"};function Sx(t){const{children:e,nested:n,row:r=!1,wrap:a=!1}=t,l=ae.jsx(Zy.Provider,{value:r,children:ae.jsx(GN.Provider,{value:a,children:q.Children.map(e,(u,s)=>q.isValidElement(u)?q.cloneElement(u,ye({},s===0&&{"data-first-child":""},s===q.Children.count(e)-1&&{"data-last-child":""})):u)})});return n===void 0?l:ae.jsx(Sw.Provider,{value:n,children:l})}const Fg=({theme:t,ownerState:e},n)=>{let r={};function a(l){if(typeof l=="function"){const u=l(t);a(u)}else Array.isArray(l)?l.forEach(u=>{typeof u!="boolean"&&a(u)}):typeof l=="object"&&(r=ye({},r,l))}return e.sx&&(a(e.sx),n.forEach(l=>{const u=r[l];if(typeof u=="string"||typeof u=="number")if(l==="borderRadius")if(typeof u=="number")r[l]=`${u}px`;else{var s;r[l]=((s=t.vars)==null?void 0:s.radius[u])||u}else["p","padding","m","margin"].indexOf(l)!==-1&&typeof u=="number"?r[l]=t.spacing(u):r[l]=u;else typeof u=="function"?r[l]=u(t):r[l]=void 0})),r};function mZ(t){return Hr("MuiList",t)}const gZ=Nr("MuiList",["root","nesting","scoped","sizeSm","sizeMd","sizeLg","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","horizontal","vertical"]),vZ=q.createContext(void 0),yZ=["component","className","children","size","orientation","wrap","variant","color","role","slots","slotProps"],_Z=t=>{const{variant:e,color:n,size:r,nesting:a,orientation:l,instanceSize:u}=t,s={root:["root",l,e&&`variant${Ln(e)}`,n&&`color${Ln(n)}`,!u&&!a&&r&&`size${Ln(r)}`,u&&`size${Ln(u)}`,a&&"nesting"]};return $r(s,mZ,{})},Mx=vn("ul")(({theme:t,ownerState:e})=>{var n;const{p:r,padding:a,borderRadius:l}=Fg({theme:t,ownerState:e},["p","padding","borderRadius"]);function u(s){return s==="sm"?{"--ListDivider-gap":"0.25rem","--ListItem-minHeight":"2rem","--ListItem-paddingY":"3px","--ListItem-paddingX":e.marker?"3px":"0.5rem","--ListItem-gap":"0.5rem","--ListItemDecorator-size":e.orientation==="horizontal"?"1.5rem":"2rem","--Icon-fontSize":t.vars.fontSize.lg}:s==="md"?{"--ListDivider-gap":"0.375rem","--ListItem-minHeight":"2.25rem","--ListItem-paddingY":"0.25rem","--ListItem-paddingX":e.marker?"0.25rem":"0.75rem","--ListItem-gap":"0.625rem","--ListItemDecorator-size":e.orientation==="horizontal"?"1.75rem":"2.5rem","--Icon-fontSize":t.vars.fontSize.xl}:s==="lg"?{"--ListDivider-gap":"0.5rem","--ListItem-minHeight":"2.75rem","--ListItem-paddingY":"0.375rem","--ListItem-paddingX":e.marker?"0.5rem":"1rem","--ListItem-gap":"0.75rem","--ListItemDecorator-size":e.orientation==="horizontal"?"2.25rem":"3rem","--Icon-fontSize":t.vars.fontSize.xl2}:{}}return[e.nesting&&ye({},u(e.instanceSize),{"--ListItem-paddingRight":"var(--ListItem-paddingX)","--ListItem-paddingLeft":"var(--NestedListItem-paddingLeft)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px",padding:0},e.marker&&{paddingInlineStart:"calc(3ch - var(--_List-markerDeduct, 0px))"},{marginInlineStart:"var(--NestedList-marginLeft)",marginInlineEnd:"var(--NestedList-marginRight)",marginBlockStart:"var(--List-gap)",marginBlockEnd:"initial"}),!e.nesting&&ye({},u(e.size),{"--List-gap":"0px","--List-nestedInsetStart":"0px","--ListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItem-paddingRight":"var(--ListItem-paddingX)"},e.marker&&{"--_List-markerDeduct":"1ch"},{"--unstable_List-childRadius":"calc(max(var(--List-radius) - var(--List-padding), min(var(--List-padding) / 2, var(--List-radius) / 2)) - var(--variant-borderWidth, 0px))","--ListItem-radius":"var(--unstable_List-childRadius)","--ListItem-startActionTranslateX":"calc(0.5 * var(--ListItem-paddingLeft))","--ListItem-endActionTranslateX":"calc(-0.5 * var(--ListItem-paddingRight))",margin:"initial"},t.typography[`body-${e.size}`],e.orientation==="horizontal"?ye({},e.wrap?{padding:"var(--List-padding)",marginInlineStart:"calc(-1 * var(--List-gap))",marginBlockStart:"calc(-1 * var(--List-gap))"}:{paddingInline:"var(--List-padding, var(--ListDivider-gap))",paddingBlock:"var(--List-padding)"}):{paddingBlock:"var(--List-padding, var(--ListDivider-gap))",paddingInline:"var(--List-padding)"},e.marker&&{paddingInlineStart:"3ch"}),ye({boxSizing:"border-box",borderRadius:"var(--List-radius)",listStyle:"none",display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column"},e.wrap&&{flexWrap:"wrap"},e.marker&&{"--_List-markerDisplay":"list-item","--_List-markerType":e.marker,lineHeight:"calc(var(--ListItem-minHeight) - 2 * var(--ListItem-paddingY))"},{flexGrow:1,position:"relative"},(n=t.variants[e.variant])==null?void 0:n[e.color],{"--unstable_List-borderWidth":"var(--variant-borderWidth, 0px)"},l!==void 0&&{"--List-radius":l},r!==void 0&&{"--List-padding":r},a!==void 0&&{"--List-padding":a})]}),xZ=vn(Mx,{name:"JoyList",slot:"Root",overridesResolver:(t,e)=>e.root})({}),RS=q.forwardRef(function(e,n){var r;const a=q.useContext(Sw),l=q.useContext(AS),u=q.useContext(vZ),s=Gr({props:e,name:"JoyList"}),{component:m,className:_,children:b,size:M,orientation:C="vertical",wrap:A=!1,variant:k="plain",color:z="neutral",role:P,slots:O={},slotProps:j={}}=s,U=lr(s,yZ),X=M||((r=e.size)!=null?r:"md");let K;l&&(K="group"),u&&(K="presentation"),P&&(K=P);const se=ye({},s,{instanceSize:e.size,size:X,nesting:a,orientation:C,wrap:A,variant:k,color:z,role:K}),J=_Z(se),ue=ye({},U,{component:m,slots:O,slotProps:j}),[ne,H]=$n("root",{ref:n,className:yo(J.root,_),elementType:xZ,externalForwardedProps:ue,ownerState:se,additionalProps:{as:m,role:K,"aria-labelledby":typeof a=="string"?a:void 0}});return ae.jsx(ne,ye({},H,{children:ae.jsx(cI.Provider,{value:`${typeof m=="string"?m:""}:${K||""}`,children:ae.jsx(Sx,{row:C==="horizontal",wrap:A,children:b})})}))}),qb=Nr("MuiListItemButton",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","variantPlain","variantSoft","variantOutlined","variantSolid"]),uI=q.createContext("horizontal"),Ex=vn("div")(({theme:t,ownerState:e})=>{var n,r,a,l,u,s;return ye({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",font:"inherit",display:"flex",flexDirection:"row",alignItems:"center",alignSelf:"stretch",gap:"var(--ListItem-gap)"},e.orientation==="vertical"&&{flexDirection:"column",justifyContent:"center"},{textAlign:"initial",textDecoration:"initial",backgroundColor:"initial",cursor:"pointer",marginInline:"var(--ListItemButton-marginInline)",marginBlock:"var(--ListItemButton-marginBlock)"},e["data-first-child"]===void 0&&{marginInlineStart:e.row?"var(--List-gap)":void 0,marginBlockStart:e.row?void 0:"var(--List-gap)"},{paddingBlock:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px))",paddingInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItem-startActionWidth, var(--unstable_startActionWidth, 0px)))",paddingInlineEnd:"calc(var(--ListItem-paddingRight) + var(--ListItem-endActionWidth, var(--unstable_endActionWidth, 0px)))",minBlockSize:"var(--ListItem-minHeight)",border:"1px solid transparent",borderRadius:"var(--ListItem-radius)",flex:"var(--unstable_ListItem-flex, none)",fontSize:"inherit",lineHeight:"inherit",minInlineSize:0,[t.focus.selector]:ye({},t.focus.default,{zIndex:1})},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:active":(r=t.variants[`${e.variant}Active`])==null?void 0:r[e.color],[`.${ww.root} > &`]:{"--unstable_ListItem-flex":"1 0 0%"},[`&.${qb.selected}`]:ye({},(a=t.variants[`${e.variant}Active`])==null?void 0:a[e.color],{"--Icon-color":"currentColor"}),[`&:not(.${qb.selected}, [aria-selected="true"])`]:{"&:hover":(l=t.variants[`${e.variant}Hover`])==null?void 0:l[e.color],"&:active":(u=t.variants[`${e.variant}Active`])==null?void 0:u[e.color]},[`&.${qb.disabled}`]:ye({},(s=t.variants[`${e.variant}Disabled`])==null?void 0:s[e.color])})});vn(Ex,{name:"JoyListItemButton",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>ye({},!t.row&&{[`&.${qb.selected}`]:{fontWeight:e.vars.fontWeight.md}}));function bZ(t){return Hr("MuiSvgIcon",t)}Nr("MuiSvgIcon",["root","colorInherit","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","fontSizeInherit","fontSizeXs","fontSizeSm","fontSizeMd","fontSizeLg","fontSizeXl","fontSizeXl2","fontSizeXl3","fontSizeXl4","sizeSm","sizeMd","sizeLg"]);const wZ=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox","size","slots","slotProps"],SZ=t=>{const{color:e,size:n,fontSize:r}=t,a={root:["root",e&&e!=="inherit"&&`color${Ln(e)}`,n&&`size${Ln(n)}`,r&&`fontSize${Ln(r)}`]};return $r(a,bZ,{})},vL={sm:"xl",md:"xl2",lg:"xl3"},MZ=vn("svg",{name:"JoySvgIcon",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return ye({},e.instanceSize&&{"--Icon-fontSize":t.vars.fontSize[vL[e.instanceSize]]},e.instanceFontSize&&e.instanceFontSize!=="inherit"&&{"--Icon-fontSize":t.vars.fontSize[e.instanceFontSize]},{userSelect:"none",margin:"var(--Icon-margin)",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,fontSize:`var(--Icon-fontSize, ${t.vars.fontSize[vL[e.size]]||"unset"})`},e.fontSize&&e.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${t.fontSize[e.fontSize]})`},!e.htmlColor&&ye({color:`var(--Icon-color, ${t.vars.palette.text.icon})`},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&t.vars.palette[e.color]&&{color:`rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / 1)`}))}),yL=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoySvgIcon"}),{children:a,className:l,color:u,component:s="svg",fontSize:m,htmlColor:_,inheritViewBox:b=!1,titleAccess:M,viewBox:C="0 0 24 24",size:A="md",slots:k={},slotProps:z={}}=r,P=lr(r,wZ),O=q.isValidElement(a)&&a.type==="svg",j=ye({},r,{color:u,component:s,size:A,instanceSize:e.size,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:b,viewBox:C,hasSvgAsChild:O}),U=SZ(j),X=ye({},P,{component:s,slots:k,slotProps:z}),[K,se]=$n("root",{ref:n,className:yo(U.root,l),elementType:MZ,externalForwardedProps:X,ownerState:j,additionalProps:ye({color:_,focusable:!1},M&&{role:"img"},!M&&{"aria-hidden":!0},!b&&{viewBox:C},O&&a.props)});return ae.jsxs(K,ye({},se,{children:[O?a.props.children:a,M?ae.jsx("title",{children:M}):null]}))});function Ng(t,e){function n(r,a){return ae.jsx(yL,ye({"data-testid":`${e}Icon`,ref:a},r,{children:t}))}return n.muiName=yL.muiName,q.memo(q.forwardRef(n))}const hI=t=>e=>`--${t?`${t}-`:""}${e.replace(/^--/,"")}`,Ly="data-skip-inverted-colors",qN=`& :not([${Ly}], [${Ly}] *)`,XN=t=>{var e,n,r,a,l,u,s,m,_,b,M,C,A,k,z,P,O,j,U,X,K,se;const J=hI(t.cssVarPrefix);return{"--variant-plainColor":"var(--variant-plainColor) !important","--variant-plainHoverColor":"var(--variant-plainHoverColor) !important","--variant-plainHoverBg":"var(--variant-plainHoverBg) !important","--variant-plainActiveBg":"var(--variant-plainActiveBg) !important","--variant-plainDisabledColor":"var(--variant-plainDisabledColor) !important","--variant-outlinedColor":"var(--variant-outlinedColor) !important","--variant-outlinedBorder":"var(--variant-outlinedBorder) !important","--variant-outlinedHoverColor":"var(--variant-outlinedHoverColor) !important","--variant-outlinedHoverBorder":"var(--variant-outlinedHoverBorder) !important","--variant-outlinedHoverBg":"var(--variant-outlinedHoverBg) !important","--variant-outlinedActiveBg":"var(--variant-outlinedActiveBg) !important","--variant-outlinedDisabledColor":"var(--variant-outlinedDisabledColor) !important","--variant-outlinedDisabledBorder":"var(--variant-outlinedDisabledBorder) !important","--variant-softColor":"var(--variant-softColor) !important","--variant-softHoverColor":"var(--variant-softHoverColor) !important","--variant-softBg":"var(--variant-softBg) !important","--variant-softHoverBg":"var(--variant-softHoverBg) !important","--variant-softActiveBg":"var(--variant-softActiveBg) !important","--variant-softActiveColor":"var(--variant-softActiveColor) !important","--variant-softDisabledColor":"var(--variant-softDisabledColor) !important","--variant-softDisabledBg":"var(--variant-softDisabledBg) !important","--variant-solidColor":"var(--variant-solidColor) !important","--variant-solidBg":"var(--variant-solidBg) !important","--variant-solidHoverBg":"var(--variant-solidHoverBg) !important","--variant-solidActiveBg":"var(--variant-solidActiveBg) !important","--variant-solidDisabledColor":"var(--variant-solidDisabledColor) !important","--variant-solidDisabledBg":"var(--variant-solidDisabledBg) !important","--Badge-ringColor":"var(--Badge-ringColor) !important",colorScheme:"unset",[t.getColorSchemeSelector("light")]:{[J("--palette-focusVisible")]:`${(e=t.colorSchemes.light)==null?void 0:e.palette.focusVisible} !important`,[J("--palette-background-body")]:`${(n=t.colorSchemes.light)==null?void 0:n.palette.background.body} !important`,[J("--palette-background-surface")]:`${(r=t.colorSchemes.light)==null?void 0:r.palette.background.surface} !important`,[J("--palette-background-popup")]:`${(a=t.colorSchemes.light)==null?void 0:a.palette.background.popup} !important`,[J("--palette-background-level1")]:`${(l=t.colorSchemes.light)==null?void 0:l.palette.background.level1} !important`,[J("--palette-background-level2")]:`${(u=t.colorSchemes.light)==null?void 0:u.palette.background.level2} !important`,[J("--palette-background-level3")]:`${(s=t.colorSchemes.light)==null?void 0:s.palette.background.level3} !important`,[J("--palette-text-primary")]:`${(m=t.colorSchemes.light)==null?void 0:m.palette.text.primary} !important`,[J("--palette-text-secondary")]:`${(_=t.colorSchemes.light)==null?void 0:_.palette.text.secondary} !important`,[J("--palette-text-tertiary")]:`${(b=t.colorSchemes.light)==null?void 0:b.palette.text.tertiary} !important`,[J("--palette-divider")]:`${(M=t.colorSchemes.light)==null?void 0:M.palette.divider} !important`},[t.getColorSchemeSelector("dark")]:{[J("--palette-focusVisible")]:`${(C=t.colorSchemes.dark)==null?void 0:C.palette.focusVisible} !important`,[J("--palette-background-body")]:`${(A=t.colorSchemes.dark)==null?void 0:A.palette.background.body} !important`,[J("--palette-background-surface")]:`${(k=t.colorSchemes.dark)==null?void 0:k.palette.background.surface} !important`,[J("--palette-background-popup")]:`${(z=t.colorSchemes.dark)==null?void 0:z.palette.background.popup} !important`,[J("--palette-background-level1")]:`${(P=t.colorSchemes.dark)==null?void 0:P.palette.background.level1} !important`,[J("--palette-background-level2")]:`${(O=t.colorSchemes.dark)==null?void 0:O.palette.background.level2} !important`,[J("--palette-background-level3")]:`${(j=t.colorSchemes.dark)==null?void 0:j.palette.background.level3} !important`,[J("--palette-text-primary")]:`${(U=t.colorSchemes.dark)==null?void 0:U.palette.text.primary} !important`,[J("--palette-text-secondary")]:`${(X=t.colorSchemes.dark)==null?void 0:X.palette.text.secondary} !important`,[J("--palette-text-tertiary")]:`${(K=t.colorSchemes.dark)==null?void 0:K.palette.text.tertiary} !important`,[J("--palette-divider")]:`${(se=t.colorSchemes.dark)==null?void 0:se.palette.divider} !important`}}};function EZ(t){return t.theme!==void 0}const Cx=t=>e=>{const n=EZ(e)?e.theme:e,r=JA(n.cssVarPrefix),a=hI(n.cssVarPrefix),l=u=>{const s=u.split("-");return r(u,n.palette[s[1]][s[2]])};return{[qN]:{"--Badge-ringColor":l(`palette-${t}-solidBg`),"--Icon-color":"currentColor",[`${n.getColorSchemeSelector("light")}, ${n.getColorSchemeSelector("dark")}`]:{colorScheme:"dark",[a("--palette-focusVisible")]:l(`palette-${t}-200`),[a("--palette-background-body")]:"rgba(0 0 0 / 0.1)",[a("--palette-background-surface")]:"rgba(0 0 0 / 0.06)",[a("--palette-background-popup")]:l(`palette-${t}-700`),[a("--palette-background-level1")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.2)`,[a("--palette-background-level2")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.36)`,[a("--palette-background-level3")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.6)`,[a("--palette-text-primary")]:l("palette-common-white"),[a("--palette-text-secondary")]:l(`palette-${t}-200`),[a("--palette-text-tertiary")]:l(`palette-${t}-300`),[a("--palette-text-icon")]:l(`palette-${t}-200`),[a("--palette-divider")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-plainColor":l(`palette-${t}-50`),"--variant-plainHoverColor":"#fff","--variant-plainHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-outlinedColor":l(`palette-${t}-50`),"--variant-outlinedBorder":`rgba(${l(`palette-${t}-lightChannel`)} / 0.5)`,"--variant-outlinedHoverColor":"#fff","--variant-outlinedHoverBorder":l(`palette-${t}-300`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":"rgba(255 255 255 / 0.2)","--variant-softColor":l("palette-common-white"),"--variant-softHoverColor":l("palette-common-white"),"--variant-softBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.24)`,"--variant-softHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.36)`,"--variant-softActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.16)`,"--variant-softActiveColor":"#fff","--variant-softDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.1)`,"--variant-solidColor":l(`palette-${t}-${t==="neutral"?"600":"500"}`),"--variant-solidBg":l("palette-common-white"),"--variant-solidHoverBg":l("palette-common-white"),"--variant-solidActiveBg":l(`palette-${t}-100`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.1)`}},[`&, & [${Ly}]`]:XN(n)}},Tx=t=>e=>{const{theme:n=e}=e,r=JA(n.cssVarPrefix),a=hI(n.cssVarPrefix),l=u=>{const s=u.split("-");return r(u,n.palette[s[1]][s[2]])};return{[qN]:{"--Badge-ringColor":l(`palette-${t}-softBg`),"--Icon-color":"currentColor",[n.getColorSchemeSelector("dark")]:{[a("--palette-focusVisible")]:l(`palette-${t}-300`),[a("--palette-background-body")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.1)`,[a("--palette-background-surface")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,[a("--palette-background-level1")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,[a("--palette-background-level2")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,[a("--palette-background-level3")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,[a("--palette-text-primary")]:l(`palette-${t}-100`),[a("--palette-text-secondary")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,[a("--palette-text-tertiary")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.6)`,[a("--palette-text-icon")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.6)`,[a("--palette-divider")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.2)`,"--variant-plainColor":`rgba(${l(`palette-${t}-lightChannel`)} / 1)`,"--variant-plainHoverColor":l(`palette-${t}-50`),"--variant-plainHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.16)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-outlinedColor":`rgba(${l(`palette-${t}-lightChannel`)} / 1)`,"--variant-outlinedHoverColor":l(`palette-${t}-50`),"--variant-outlinedBg":"initial","--variant-outlinedBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverBorder":l(`palette-${t}-600`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.16)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,"--variant-softColor":l(`palette-${t}-200`),"--variant-softBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-softHoverColor":"#fff","--variant-softHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-softActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.48)`,"--variant-softDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-solidColor":"#fff","--variant-solidBg":l(`palette-${t}-500`),"--variant-solidHoverColor":"#fff","--variant-solidHoverBg":l(`palette-${t}-600`),"--variant-solidActiveBg":l(`palette-${t}-600`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`},[n.getColorSchemeSelector("light")]:{[a("--palette-focusVisible")]:l(`palette-${t}-500`),[a("--palette-background-body")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.1)`,[a("--palette-background-surface")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,[a("--palette-background-level1")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,[a("--palette-background-level2")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,[a("--palette-background-level3")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.48)`,[a("--palette-text-primary")]:l(`palette-${t}-700`),[a("--palette-text-secondary")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.8)`,[a("--palette-text-tertiary")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.68)`,[a("--palette-text-icon")]:l(`palette-${t}-500`),[a("--palette-divider")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-plainColor":`rgba(${l(`palette-${t}-darkChannel`)} / 0.8)`,"--variant-plainHoverColor":`rgba(${l(`palette-${t}-darkChannel`)} / 1)`,"--variant-plainHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-outlinedColor":`rgba(${l(`palette-${t}-mainChannel`)} / 1)`,"--variant-outlinedBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverColor":l(`palette-${t}-600`),"--variant-outlinedHoverBorder":l(`palette-${t}-300`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-outlinedDisabledBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-softColor":l(`palette-${t}-600`),"--variant-softBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.8)`,"--variant-softHoverColor":l(`palette-${t}-700`),"--variant-softHoverBg":l(`palette-${t}-200`),"--variant-softActiveBg":l(`palette-${t}-300`),"--variant-softDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,"--variant-solidColor":l("palette-common-white"),"--variant-solidBg":l(`palette-${t}-${t==="neutral"?"700":"500"}`),"--variant-solidHoverColor":l("palette-common-white"),"--variant-solidHoverBg":l(`palette-${t}-600`),"--variant-solidActiveBg":l(`palette-${t}-600`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`}},[`&, & [${Ly}]`]:XN(n)}},ZN=Ng(ae.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),CZ=Ng(ae.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),YN=q.createContext(void 0);function pg(t,e){let n=e,r=t;return t==="outlined"&&(n="neutral",r="plain"),t==="plain"&&(n="neutral"),{variant:r,color:n}}function DS(t,e,n=!1){const r=q.useContext(YN),[a,l]=typeof r=="string"?r.split(":"):[],u=pg(a||void 0,l||void 0);return u.variant=t||u.variant,u.color=e||(n?l:u.color),u}function LS({children:t,color:e,variant:n}){return ae.jsx(YN.Provider,{value:`${n||""}:${e||""}`,children:t})}function TZ(t){return Hr("MuiIconButton",t)}Nr("MuiIconButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","loading","loadingIndicator"]);const dI=q.createContext({}),KN=q.createContext(void 0);function PZ(t){return Hr("MuiCircularProgress",t)}Nr("MuiCircularProgress",["root","determinate","svg","track","progress","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);let AZ=t=>t,_L;const IZ=["color","backgroundColor"],RZ=["children","className","color","size","variant","thickness","determinate","value","component","slots","slotProps"],DZ=BA({"0%":{transform:"rotate(-90deg)"},"100%":{transform:"rotate(270deg)"}}),LZ=t=>{const{determinate:e,color:n,variant:r,size:a}=t,l={root:["root",e&&"determinate",n&&`color${Ln(n)}`,r&&`variant${Ln(r)}`,a&&`size${Ln(a)}`],svg:["svg"],track:["track"],progress:["progress"]};return $r(l,PZ,{})};function Tv(t,e){return`var(--CircularProgress-${t}Thickness, var(--CircularProgress-thickness, ${e}))`}const kZ=vn("span",{name:"JoyCircularProgress",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,a,l;const u=((n=e.variants[t.variant])==null?void 0:n[t.color])||{},{color:s,backgroundColor:m}=u,_=lr(u,IZ);return ye({"--Icon-fontSize":"calc(0.4 * var(--_root-size))","--CircularProgress-trackColor":m,"--CircularProgress-progressColor":s,"--CircularProgress-percent":t.value,"--CircularProgress-linecap":"round"},t.size==="sm"&&{"--_root-size":"var(--CircularProgress-size, 24px)","--_track-thickness":Tv("track","3px"),"--_progress-thickness":Tv("progress","3px")},t.instanceSize==="sm"&&{"--CircularProgress-size":"24px"},t.size==="md"&&{"--_track-thickness":Tv("track","6px"),"--_progress-thickness":Tv("progress","6px"),"--_root-size":"var(--CircularProgress-size, 40px)"},t.instanceSize==="md"&&{"--CircularProgress-size":"40px"},t.size==="lg"&&{"--_track-thickness":Tv("track","8px"),"--_progress-thickness":Tv("progress","8px"),"--_root-size":"var(--CircularProgress-size, 64px)"},t.instanceSize==="lg"&&{"--CircularProgress-size":"64px"},t.thickness&&{"--_track-thickness":`${t.thickness}px`,"--_progress-thickness":`${t.thickness}px`},{"--_thickness-diff":"calc(var(--_track-thickness) - var(--_progress-thickness))","--_inner-size":"calc(var(--_root-size) - 2 * var(--variant-borderWidth, 0px))","--_outlined-inset":"max(var(--_track-thickness), var(--_progress-thickness))",width:"var(--_root-size)",height:"var(--_root-size)",borderRadius:"var(--_root-size)",margin:"var(--CircularProgress-margin)",boxSizing:"border-box",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",color:s},t.children&&{fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.md,fontSize:"calc(0.2 * var(--_root-size))"},_,t.variant==="outlined"&&{"&::before":ye({content:'""',display:"block",position:"absolute",borderRadius:"inherit",top:"var(--_outlined-inset)",left:"var(--_outlined-inset)",right:"var(--_outlined-inset)",bottom:"var(--_outlined-inset)"},_)},t.variant==="soft"&&{"--CircularProgress-trackColor":e.variants.soft.neutral.backgroundColor,"--CircularProgress-progressColor":(r=e.variants.solid)==null?void 0:r[t.color].backgroundColor},t.variant==="solid"&&{"--CircularProgress-trackColor":(a=e.variants.softHover)==null?void 0:a[t.color].backgroundColor,"--CircularProgress-progressColor":(l=e.variants.solid)==null?void 0:l[t.color].backgroundColor})}),zZ=vn("svg",{name:"JoyCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({width:"inherit",height:"inherit",display:"inherit",boxSizing:"inherit",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))"}),OZ=vn("circle",{name:"JoyCircularProgress",slot:"track",overridesResolver:(t,e)=>e.track})({cx:"50%",cy:"50%",r:"calc(var(--_inner-size) / 2 - var(--_track-thickness) / 2 + min(0px, var(--_thickness-diff) / 2))",fill:"transparent",strokeWidth:"var(--_track-thickness)",stroke:"var(--CircularProgress-trackColor)"}),FZ=vn("circle",{name:"JoyCircularProgress",slot:"progress",overridesResolver:(t,e)=>e.progress})({"--_progress-radius":"calc(var(--_inner-size) / 2 - var(--_progress-thickness) / 2 - max(0px, var(--_thickness-diff) / 2))","--_progress-length":"calc(2 * 3.1415926535 * var(--_progress-radius))",cx:"50%",cy:"50%",r:"var(--_progress-radius)",fill:"transparent",strokeWidth:"var(--_progress-thickness)",stroke:"var(--CircularProgress-progressColor)",strokeLinecap:"var(--CircularProgress-linecap, round)",strokeDasharray:"var(--_progress-length)",strokeDashoffset:"calc(var(--_progress-length) - var(--CircularProgress-percent) * var(--_progress-length) / 100)",transformOrigin:"center",transform:"rotate(-90deg)"},({ownerState:t})=>!t.determinate&&rN(_L||(_L=AZ`
      animation: var(--CircularProgress-circulation, 0.8s linear 0s infinite normal none running)
        ${0};
    `),DZ)),fI=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyCircularProgress"}),{children:a,className:l,color:u="primary",size:s="md",variant:m="soft",thickness:_,determinate:b=!1,value:M=b?0:25,component:C,slots:A={},slotProps:k={}}=r,z=lr(r,RZ),P=ye({},r,{color:u,size:s,variant:m,thickness:_,value:M,determinate:b,instanceSize:e.size}),O=LZ(P),j=ye({},z,{component:C,slots:A,slotProps:k}),[U,X]=$n("root",{ref:n,className:yo(O.root,l),elementType:kZ,externalForwardedProps:j,ownerState:P,additionalProps:ye({role:"progressbar",style:{"--CircularProgress-percent":M}},M&&b&&{"aria-valuenow":Math.round(typeof M=="number"?M:Number(M||0))})}),[K,se]=$n("svg",{className:O.svg,elementType:zZ,externalForwardedProps:j,ownerState:P}),[J,ue]=$n("track",{className:O.track,elementType:OZ,externalForwardedProps:j,ownerState:P}),[ne,H]=$n("progress",{className:O.progress,elementType:FZ,externalForwardedProps:j,ownerState:P});return ae.jsxs(U,ye({},X,{children:[ae.jsxs(K,ye({},se,{children:[ae.jsx(J,ye({},ue)),ae.jsx(ne,ye({},H))]})),a]}))}),NZ=["children","action","component","color","disabled","variant","loading","loadingIndicator","size","slots","slotProps"],BZ=t=>{const{color:e,disabled:n,focusVisible:r,focusVisibleClassName:a,size:l,variant:u,loading:s}=t,m={root:["root",n&&"disabled",r&&"focusVisible",u&&`variant${Ln(u)}`,e&&`color${Ln(e)}`,l&&`size${Ln(l)}`,s&&"loading"],loadingIndicator:["loadingIndicator"]},_=$r(m,TZ,{});return r&&a&&(_.root+=` ${a}`),_},Px=vn("button")(({theme:t,ownerState:e})=>{var n,r,a,l;return[ye({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},e.instanceSize&&{"--IconButton-size":{sm:"2rem",md:"2.25rem",lg:"2.75rem"}[e.instanceSize]},e.size==="sm"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.6)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:t.vars.fontSize.sm,paddingInline:"2px"},e.size==="md"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.25rem) / 1.5)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2.25rem)",minHeight:"var(--IconButton-size, 2.25rem)",fontSize:t.vars.fontSize.md,paddingInline:"0.25rem"},e.size==="lg"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.75rem) / 1.571)","--CircularProgress-size":"28px","--CircularProgress-thickness":"4px",minWidth:"var(--IconButton-size, 2.75rem)",minHeight:"var(--IconButton-size, 2.75rem)",fontSize:t.vars.fontSize.lg,paddingInline:"0.375rem"},{WebkitTapHighlightColor:"transparent",paddingBlock:0,fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.md,margin:"var(--IconButton-margin)",borderRadius:`var(--IconButton-radius, ${t.vars.radius.sm})`,border:"none",boxSizing:"border-box",backgroundColor:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",[t.focus.selector]:ye({"--Icon-color":"currentColor"},t.focus.default)}),ye({},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":{"@media (hover: hover)":ye({"--Icon-color":"currentColor"},(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color])},'&:active, &[aria-pressed="true"]':ye({"--Icon-color":"currentColor"},(a=t.variants[`${e.variant}Active`])==null?void 0:a[e.color]),"&:disabled":(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]})]}),UZ=vn(Px,{name:"JoyIconButton",slot:"Root",overridesResolver:(t,e)=>e.root})({}),$Z=vn("span",{name:"JoyIconButton",slot:"LoadingIndicator",overridesResolver:(t,e)=>e.loadingIndicator})(({theme:t,ownerState:e})=>{var n,r;return ye({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),sd=q.forwardRef(function(e,n){var r;const a=Gr({props:e,name:"JoyIconButton"}),{children:l,action:u,component:s="button",color:m="neutral",disabled:_,variant:b="plain",loading:M=!1,loadingIndicator:C,size:A="md",slots:k={},slotProps:z={}}=a,P=lr(a,NZ),O=q.useContext(dI),j=q.useContext(KN),U=e.variant||O.variant||b,X=e.size||O.size||A,K=e.color||O.color||m,se=(r=e.loading||e.disabled)!=null?r:O.disabled||M||_,J=q.useRef(null),ue=pi(J,n),{focusVisible:ne,setFocusVisible:H,getRootProps:de}=hd(ye({},a,{disabled:se,rootRef:ue})),Ee=C??ae.jsx(fI,{color:K,thickness:{sm:2,md:3,lg:4}[X]||3});q.useImperativeHandle(u,()=>({focusVisible:()=>{var lt;H(!0),(lt=J.current)==null||lt.focus()}}),[H]);const Pe=ye({},a,{component:s,color:K,disabled:se,variant:U,loading:M,size:X,focusVisible:ne,instanceSize:e.size}),Ze=BZ(Pe),ke=lt=>{var Ht;let He=a.onClick;if(typeof z.root=="function"?He=z.root(Pe).onClick:z.root&&(He=z.root.onClick),(Ht=He)==null||Ht(lt),j){var pt;(pt=j.onClick)==null||pt.call(j,lt,a.value)}};let Te=a["aria-pressed"];typeof z.root=="function"?Te=z.root(Pe)["aria-pressed"]:z.root&&(Te=z.root["aria-pressed"]),j!=null&&j.value&&(Array.isArray(j.value)?Te=j.value.indexOf(a.value)!==-1:Te=j.value===a.value);const Ie=ye({},P,{component:s,slots:k,slotProps:z}),[Ce,Ue]=$n("root",{ref:n,className:Ze.root,elementType:UZ,getSlotProps:de,externalForwardedProps:Ie,ownerState:Pe,additionalProps:{onClick:ke,"aria-pressed":Te}}),[nt,Le]=$n("loadingIndicator",{className:Ze.loadingIndicator,elementType:$Z,externalForwardedProps:Ie,ownerState:Pe});return ae.jsx(Ce,ye({},Ue,{children:M?ae.jsx(nt,ye({},Le,{children:Ee})):l}))});sd.muiName="IconButton";function VZ(t){return Hr("MuiChip",t)}const QT=Nr("MuiChip",["root","clickable","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","disabled","endDecorator","focusVisible","label","labelSm","labelMd","labelLg","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantSolid","variantSoft","variantOutlined"]),JN=q.createContext({disabled:void 0,variant:void 0,color:void 0}),jZ=["children","className","color","onClick","disabled","size","variant","startDecorator","endDecorator","component","slots","slotProps"],HZ=t=>{const{disabled:e,size:n,color:r,clickable:a,variant:l,focusVisible:u}=t,s={root:["root",e&&"disabled",r&&`color${Ln(r)}`,n&&`size${Ln(n)}`,l&&`variant${Ln(l)}`,a&&"clickable"],action:["action",e&&"disabled",u&&"focusVisible"],label:["label",n&&`label${Ln(n)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return $r(s,VZ,{})},GZ=vn("div",{name:"JoyChip",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,a;const l=(n=t.variants[e.variant])==null?void 0:n[e.color],{borderRadius:u}=Fg({theme:t,ownerState:e},["borderRadius"]);return[ye({"--Chip-decoratorChildOffset":"min(calc(var(--Chip-paddingInline) - (var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2), var(--Chip-paddingInline))","--Chip-decoratorChildRadius":"max(var(--_Chip-radius) - var(--variant-borderWidth, 0px) - var(--_Chip-paddingBlock), min(var(--_Chip-paddingBlock) + var(--variant-borderWidth, 0px), var(--_Chip-radius) / 2))","--Chip-deleteRadius":"var(--Chip-decoratorChildRadius)","--Chip-deleteSize":"var(--Chip-decoratorChildHeight)","--Avatar-radius":"var(--Chip-decoratorChildRadius)","--Avatar-size":"var(--Chip-decoratorChildHeight)","--Icon-margin":"initial","--Icon-color":"currentColor","--unstable_actionRadius":"var(--_Chip-radius)"},e.size==="sm"&&{"--Chip-paddingInline":"0.375rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.sm,"--_Chip-minHeight":"var(--Chip-minHeight, 1.25rem)",gap:"3px"},e.size==="md"&&{"--Chip-paddingInline":"0.5rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.25rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.md,"--_Chip-minHeight":"var(--Chip-minHeight, 1.5rem)",gap:"0.25rem"},e.size==="lg"&&{"--Chip-paddingInline":"0.75rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.375rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.lg,"--_Chip-minHeight":"var(--Chip-minHeight, 1.75rem)",gap:"0.375rem"},{"--_Chip-radius":"var(--Chip-radius, 1.5rem)","--_Chip-paddingBlock":"max((var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2, 0px)",minHeight:"var(--_Chip-minHeight)",maxWidth:"max-content",paddingInline:"var(--Chip-paddingInline)",borderRadius:"var(--_Chip-radius)",position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",textDecoration:"none",verticalAlign:"middle",boxSizing:"border-box"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],{fontWeight:t.vars.fontWeight.md,[`&.${QT.disabled}`]:{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color}}),...e.clickable?[{"--variant-borderWidth":"0px",color:l?.color}]:[ye({backgroundColor:t.vars.palette.background.surface},l,{[`&.${QT.disabled}`]:(a=t.variants[`${e.variant}Disabled`])==null?void 0:a[e.color]})],u!==void 0&&{"--_Chip-radius":u}]}),WZ=vn("span",{name:"JoyChip",slot:"Label",overridesResolver:(t,e)=>e.label})(({ownerState:t})=>ye({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",order:1,minInlineSize:0,flexGrow:1},t.clickable&&{zIndex:1,pointerEvents:"none"})),qZ=vn("button",{name:"JoyChip",slot:"Action",overridesResolver:(t,e)=>e.action})(({theme:t,ownerState:e})=>{var n,r,a,l;return[{"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,position:"absolute",zIndex:0,top:0,left:0,bottom:0,right:0,width:"100%",border:"none",cursor:"pointer",padding:"initial",margin:"initial",backgroundColor:"initial",textDecoration:"none",borderRadius:"inherit",[t.focus.selector]:t.focus.default},ye({backgroundColor:t.vars.palette.background.surface},(n=t.variants[e.variant])==null?void 0:n[e.color]),{"&:hover":{"@media (hover: hover)":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]}},{"&:active":(a=t.variants[`${e.variant}Active`])==null?void 0:a[e.color]},{[`&.${QT.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]}]}),XZ=vn("span",{name:"JoyChip",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Avatar-marginInlineStart":"calc(var(--Chip-decoratorChildOffset) * -1)","--IconButton-margin":"0 calc(-1 * var(--Chip-paddingInline) / 3) 0 calc(var(--Chip-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Chip-paddingInline) / -4)",display:"inherit",order:0,zIndex:1,pointerEvents:"none"}),ZZ=vn("span",{name:"JoyChip",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--IconButton-margin":"0 calc(var(--Chip-decoratorChildOffset) * -1) 0 calc(-1 * var(--Chip-paddingInline) / 3)","--Icon-margin":"0 calc(var(--Chip-paddingInline) / -4) 0 0",display:"inherit",order:2,zIndex:1,pointerEvents:"none"}),QN=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyChip"}),{children:a,className:l,color:u="neutral",onClick:s,disabled:m=!1,size:_="md",variant:b="soft",startDecorator:M,endDecorator:C,component:A,slots:k={},slotProps:z={}}=r,P=lr(r,jZ),O=!!s||!!z.action,j=ye({},r,{disabled:m,size:_,color:u,variant:b,clickable:O,focusVisible:!1}),U=typeof z.action=="function"?z.action(j):z.action,X=q.useRef(null),{focusVisible:K,getRootProps:se}=hd(ye({},U,{disabled:m,rootRef:X}));j.focusVisible=K;const J=HZ(j),ue=ye({},P,{component:A,slots:k,slotProps:z}),[ne,H]=$n("root",{ref:n,className:yo(J.root,l),elementType:GZ,externalForwardedProps:ue,ownerState:j}),[de,Ee]=$n("label",{className:J.label,elementType:WZ,externalForwardedProps:ue,ownerState:j}),Pe=Pl(Ee.id),[Ze,ke]=$n("action",{className:J.action,elementType:qZ,externalForwardedProps:ue,ownerState:j,getSlotProps:se,additionalProps:{"aria-labelledby":Pe,as:U?.component,onClick:s}}),[Te,Ie]=$n("startDecorator",{className:J.startDecorator,elementType:XZ,externalForwardedProps:ue,ownerState:j}),[Ce,Ue]=$n("endDecorator",{className:J.endDecorator,elementType:ZZ,externalForwardedProps:ue,ownerState:j}),nt=q.useMemo(()=>({disabled:m}),[m]);return ae.jsx(JN.Provider,{value:nt,children:ae.jsx(LS,{variant:b,color:u,children:ae.jsxs(ne,ye({},H,{children:[O&&ae.jsx(Ze,ye({},ke)),ae.jsx(de,ye({},Ee,{id:Pe,children:a})),M&&ae.jsx(Te,ye({},Ie,{children:M})),C&&ae.jsx(Ce,ye({},Ue,{children:C}))]}))})})}),YZ=Ng(ae.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Cancel");function KZ(t){return Hr("MuiChipDelete",t)}Nr("MuiChipDelete",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSolid","variantSoft","variantOutlined"]);var xL;const JZ=["children","variant","color","disabled","onKeyDown","onDelete","onClick","component","slots","slotProps"],QZ=["onDelete"],eY=t=>{const{focusVisible:e,variant:n,color:r,disabled:a}=t,l={root:["root",a&&"disabled",e&&"focusVisible",n&&`variant${Ln(n)}`,r&&`color${Ln(r)}`]};return $r(l,KZ,{})},tY=vn(Px,{name:"JoyChipDelete",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({"--IconButton-size":"var(--Chip-deleteSize, 2rem)","--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.3)",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:t.vars.fontSize.sm,paddingInline:"2px",pointerEvents:"visible",borderRadius:"var(--Chip-deleteRadius, 50%)",zIndex:1,padding:0})),nY=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyChipDelete"}),{children:a,variant:l="plain",color:u="neutral",disabled:s,onKeyDown:m,onDelete:_,onClick:b,component:M,slots:C={},slotProps:A={}}=r,k=lr(r,JZ),z=q.useContext(JN),{variant:P=l,color:O=u}=DS(e.variant,e.color,!0),j=e.color||O,U=s??z.disabled,X=q.useRef(null),K=pi(X,n),{focusVisible:se,getRootProps:J}=hd(ye({},r,{disabled:U,rootRef:K})),ue=ye({},r,{disabled:U,variant:P,color:j,focusVisible:se}),ne=eY(ue),H=ye({},k,{component:M,slots:C,slotProps:A}),de=Te=>{!U&&_&&_(Te),b&&b(Te)},Ee=Te=>{["Backspace","Enter","Delete"].includes(Te.key)&&(Te.preventDefault(),!U&&_&&_(Te)),m&&m(Te)},[Pe,Ze]=$n("root",{ref:n,elementType:tY,getSlotProps:J,externalForwardedProps:H,ownerState:ue,additionalProps:{as:M,onKeyDown:Ee,onClick:de},className:ne.root}),ke=lr(Ze,QZ);return ae.jsx(Pe,ye({},ke,{children:a??(xL||(xL=ae.jsx(YZ,{})))}))});function rY(t){return Hr("MuiInput",t)}const eB=Nr("MuiInput",["root","input","formControl","focused","disabled","error","adornedStart","adornedEnd","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid","fullWidth","startDecorator","endDecorator"]),kS=q.createContext(void 0),iY=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoFocus","className","defaultValue","disabled","disabledInProp","error","id","name","onClick","onChange","onKeyDown","onKeyUp","onFocus","onBlur","placeholder","readOnly","required","type","value"];function oY(t,e){var n;const r=q.useContext(kS),{"aria-describedby":a,"aria-label":l,"aria-labelledby":u,autoComplete:s,autoFocus:m,className:_,defaultValue:b,disabled:M,disabledInProp:C,error:A,id:k,name:z,onClick:P,onChange:O,onKeyDown:j,onKeyUp:U,onFocus:X,onBlur:K,placeholder:se,readOnly:J,required:ue,type:ne,value:H}=t,de=lr(t,iY),{getRootProps:Ee,getInputProps:Pe,focused:Ze,error:ke,disabled:Te}=zW({disabled:(n=C??r?.disabled)!=null?n:M,defaultValue:b,error:A,onBlur:K,onClick:P,onChange:O,onFocus:X,required:ue??r?.required,value:H}),Ie={[e.disabled]:Te,[e.error]:ke,[e.focused]:Ze,[e.formControl]:!!r,[_]:_},Ce={[e.disabled]:Te};return ye({formControl:r,propsToForward:{"aria-describedby":a,"aria-label":l,"aria-labelledby":u,autoComplete:s,autoFocus:m,disabled:Te,id:k,onKeyDown:j,onKeyUp:U,name:z,placeholder:se,readOnly:J,type:ne},rootStateClasses:Ie,inputStateClasses:Ce,getRootProps:Ee,getInputProps:Pe,focused:Ze,error:ke,disabled:Te},de)}const sY=["propsToForward","rootStateClasses","inputStateClasses","getRootProps","getInputProps","formControl","focused","error","disabled","fullWidth","size","color","variant","startDecorator","endDecorator","component","slots","slotProps"],aY=t=>{const{disabled:e,fullWidth:n,variant:r,color:a,size:l}=t,u={root:["root",e&&"disabled",n&&"fullWidth",r&&`variant${Ln(r)}`,a&&`color${Ln(a)}`,l&&`size${Ln(l)}`],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return $r(u,rY,{})},tB=vn("div")(({theme:t,ownerState:e})=>{var n,r,a,l,u,s;const m=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color];return[ye({"--Input-radius":t.vars.radius.sm,"--Input-gap":"0.5rem","--Input-placeholderColor":"inherit","--Input-placeholderOpacity":.64,"--Input-decoratorColor":t.vars.palette.text.icon,"--Input-focused":"0","--Input-focusedThickness":t.vars.focus.thickness,"--Input-focusedHighlight":(r=t.vars.palette[e.color==="neutral"?"primary":e.color])==null?void 0:r[500],[`&:not([${Ly}])`]:ye({},e.instanceColor&&{"--_Input-focusedHighlight":(a=t.vars.palette[e.instanceColor==="neutral"?"primary":e.instanceColor])==null?void 0:a[500]},{"--Input-focusedHighlight":`var(--_Input-focusedHighlight, ${t.vars.palette.focusVisible})`})},e.size==="sm"&&{"--Input-minHeight":"2rem","--Input-paddingInline":"0.5rem","--Input-decoratorChildHeight":"min(1.5rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl},e.size==="md"&&{"--Input-minHeight":"2.25rem","--Input-paddingInline":"0.75rem","--Input-decoratorChildHeight":"min(1.75rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},e.size==="lg"&&{"--Input-minHeight":"2.75rem","--Input-paddingInline":"1rem","--Input-gap":"0.75rem","--Input-decoratorChildHeight":"min(2.25rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},{"--Input-decoratorChildOffset":"min(calc(var(--Input-paddingInline) - (var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2), var(--Input-paddingInline))","--_Input-paddingBlock":"max((var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2, 0px)","--Input-decoratorChildRadius":"max(var(--Input-radius) - var(--variant-borderWidth, 0px) - var(--_Input-paddingBlock), min(var(--_Input-paddingBlock) + var(--variant-borderWidth, 0px), var(--Input-radius) / 2))","--Button-minHeight":"var(--Input-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Input-decoratorChildHeight)","--Button-radius":"var(--Input-decoratorChildRadius)","--IconButton-radius":"var(--Input-decoratorChildRadius)",boxSizing:"border-box"},e.variant!=="plain"&&{boxShadow:t.shadow.xs},{minWidth:0,minHeight:"var(--Input-minHeight)"},e.fullWidth&&{width:"100%"},{cursor:"text",position:"relative",display:"flex",paddingInline:"var(--Input-paddingInline)",borderRadius:"var(--Input-radius)"},t.typography[`body-${e.size}`],m,{backgroundColor:(l=m?.backgroundColor)!=null?l:t.vars.palette.background.surface,"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)",boxShadow:"var(--Input-focusedInset, inset) 0 0 0 calc(var(--Input-focused) * var(--Input-focusedThickness)) var(--Input-focusedHighlight)"}}),{"&:hover":ye({},(u=t.variants[`${e.variant}Hover`])==null?void 0:u[e.color],{backgroundColor:null}),[`&.${eB.disabled}`]:(s=t.variants[`${e.variant}Disabled`])==null?void 0:s[e.color],"&:focus-within::before":{"--Input-focused":"1"}}]}),nB=vn("input")(({ownerState:t})=>({border:"none",minWidth:0,outline:0,padding:0,flex:1,color:"inherit",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"inherit",textOverflow:"ellipsis","&:-webkit-autofill":ye({paddingInline:"var(--Input-paddingInline)"},!t.startDecorator&&{marginInlineStart:"calc(-1 * var(--Input-paddingInline))",paddingInlineStart:"var(--Input-paddingInline)",borderTopLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"},!t.endDecorator&&{marginInlineEnd:"calc(-1 * var(--Input-paddingInline))",paddingInlineEnd:"var(--Input-paddingInline)",borderTopRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"}),"&::-webkit-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-moz-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&:-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"}})),rB=vn("div")({"--Button-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Input-paddingInline) / -4)",display:"inherit",alignItems:"center",paddingBlock:"var(--unstable_InputPaddingBlock)",flexWrap:"wrap",marginInlineEnd:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),iB=vn("div")({"--Button-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Input-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",marginInlineStart:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),lY=vn(tB,{name:"JoyInput",slot:"Root",overridesResolver:(t,e)=>e.root})({}),cY=vn(nB,{name:"JoyInput",slot:"Input",overridesResolver:(t,e)=>e.input})({}),uY=vn(rB,{name:"JoyInput",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({}),hY=vn(iB,{name:"JoyInput",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({}),dY=q.forwardRef(function(e,n){var r,a,l,u,s,m;const _=Gr({props:e,name:"JoyInput"}),b=oY(ye({},_,{disabledInProp:e.disabled}),eB),{propsToForward:M,rootStateClasses:C,inputStateClasses:A,getRootProps:k,getInputProps:z,formControl:P,focused:O,error:j=!1,disabled:U,fullWidth:X=!1,size:K="md",color:se="neutral",variant:J="outlined",startDecorator:ue,endDecorator:ne,component:H,slots:de={},slotProps:Ee={}}=b,Pe=lr(b,sY),Ze=(r=(a=e.error)!=null?a:P?.error)!=null?r:j,ke=(l=(u=e.size)!=null?u:P?.size)!=null?l:K,Te=(s=e.color)!=null?s:Ze?"danger":(m=P?.color)!=null?m:se,Ie=ye({instanceColor:Ze?"danger":e.color},_,{fullWidth:X,color:Te,disabled:U,error:Ze,focused:O,size:ke,variant:J}),Ce=aY(Ie),Ue=ye({},Pe,{component:H,slots:de,slotProps:Ee}),[nt,Le]=$n("root",{ref:n,className:[Ce.root,C],elementType:lY,getSlotProps:k,externalForwardedProps:Ue,ownerState:Ie}),[lt,Ht]=$n("input",ye({},P&&{additionalProps:{id:P.htmlFor,"aria-describedby":P["aria-describedby"]}},{className:[Ce.input,A],elementType:cY,getSlotProps:z,internalForwardedProps:M,externalForwardedProps:Ue,ownerState:Ie})),[He,pt]=$n("startDecorator",{className:Ce.startDecorator,elementType:uY,externalForwardedProps:Ue,ownerState:Ie}),[_t,ot]=$n("endDecorator",{className:Ce.endDecorator,elementType:hY,externalForwardedProps:Ue,ownerState:Ie});return ae.jsxs(nt,ye({},Le,{children:[ue&&ae.jsx(He,ye({},pt,{children:ue})),ae.jsx(lt,ye({},Ht)),ne&&ae.jsx(_t,ye({},ot,{children:ne}))]}))});function fY(t){return Hr("MuiListSubheader",t)}Nr("MuiListSubheader",["root","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const pY=["component","className","children","id","sticky","variant","color","slots","slotProps"],mY=t=>{const{variant:e,color:n,sticky:r}=t,a={root:["root",r&&"sticky",n&&`color${Ln(n)}`,e&&`variant${Ln(e)}`]};return $r(a,fY,{})},gY=vn("div",{name:"JoyListSubheader",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;return ye({boxSizing:"border-box",display:"flex",alignItems:"center",marginInline:"var(--ListItem-marginInline)",paddingBlock:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)",minBlockSize:"var(--ListItem-minHeight)"},t.typography["body-xs"],{fontSize:"max(0.75em, 0.625rem)",textTransform:"uppercase",letterSpacing:"0.1em"},e.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:"var(--ListItem-stickyBackground)"},{color:e.color?`var(--_Link-color, rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / 1))`:t.vars.palette.text.tertiary},e.instanceColor&&{[`&:not([${Ly}])`]:{"--_Link-color":t.vars.palette.text.secondary}},(r=t.variants[e.variant])==null?void 0:r[e.color])}),vY=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyListSubheader"}),{component:a,className:l,children:u,id:s,sticky:m=!1,variant:_,color:b,slots:M={},slotProps:C={}}=r,A=lr(r,pY),k=Pl(s),z=q.useContext(WN);q.useEffect(()=>{z&&z(k||"")},[z,k]);const P=ye({instanceColor:e.color},r,{id:k,sticky:m,variant:_,color:_?b??"neutral":b}),O=mY(P),j=ye({},A,{component:a,slots:M,slotProps:C}),[U,X]=$n("root",{ref:n,className:yo(O.root,l),elementType:gY,externalForwardedProps:j,ownerState:P,additionalProps:{as:a,id:k}});return ae.jsx(U,ye({},X,{children:u}))});function yY(t){return Hr("MuiAutocomplete",t)}const Op=Nr("MuiAutocomplete",["root","wrapper","input","startDecorator","endDecorator","formControl","focused","disabled","error","multiple","limitTag","hasPopupIcon","hasClearIcon","clearIndicator","popupIndicator","popupIndicatorOpen","listbox","option","loading","noOptions","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]),oB=vn(Mx)(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return ye({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":r?.backgroundColor||r?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},IS,{boxShadow:t.shadow.md,borderRadius:`var(--List-radius, ${t.vars.radius.sm})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup},{zIndex:t.vars.zIndex.popup,overflow:"auto",maxHeight:"40vh",position:"relative","&:empty":{visibility:"hidden"},[`& .${ww.nested}, & .${ww.nested} .${gZ.root}`]:{position:"initial"}})});vn(oB,{name:"JoyAutocompleteListbox",slot:"Root",overridesResolver:(t,e)=>e.root})({});function _Y(t){return Hr("MuiAutocompleteOption",t)}Nr("MuiAutocompleteOption",["root","focused","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const xY=["children","component","color","variant","className","slots","slotProps"],bY=t=>{const{color:e,variant:n}=t,r={root:["root",e&&`color${Ln(e)}`,n&&`variant${Ln(n)}`]};return $r(r,_Y,{})},sB=vn(Ex)(({theme:t,ownerState:e})=>{var n,r;return{'&[aria-disabled="true"]':(n=t.variants[`${e.variant}Disabled`])==null?void 0:n[e.color],'&[aria-selected="true"]':ye({},(r=t.variants[`${e.variant}Active`])==null?void 0:r[e.color],{fontWeight:t.vars.fontWeight.md})}}),wY=vn(sB,{name:"JoyAutocompleteOption",slot:"Root",overridesResolver:(t,e)=>e.root})({}),aB=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyAutocompleteOption"}),{children:a,component:l="li",color:u="neutral",variant:s="plain",className:m,slots:_={},slotProps:b={}}=r,M=lr(r,xY),{variant:C=s,color:A=u}=DS(e.variant,e.color),k=ye({},r,{component:l,color:A,variant:C}),z=bY(k),P=ye({},M,{component:l,slots:_,slotProps:b}),[O,j]=$n("root",{ref:n,className:yo(z.root,m),elementType:wY,externalForwardedProps:P,ownerState:k,additionalProps:{as:l,role:"option"}});return ae.jsx(O,ye({},j,{children:a}))});var bL,wL;const SY=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoHighlight","autoSelect","autoFocus","blurOnSelect","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","defaultValue","disableCloseOnSelect","disabledItemsFocusable","disableListWrap","disableClearable","disabled","endDecorator","error","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","handleHomeEndKeys","includeInputInList","isOptionEqualToValue","groupBy","id","inputValue","limitTags","loading","loadingText","multiple","name","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","placeholder","popupIcon","readOnly","renderGroup","renderOption","renderTags","required","type","startDecorator","size","color","variant","value","component","selectOnFocus","slots","slotProps"],MY=["onDelete"],EY=["key"],CY=["onBlur","onFocus","onMouseDown"],TY=["key"],PY=t=>t.current!==null&&t.current.contains(document.activeElement),AY=t=>{var e;return(e=t.label)!=null?e:t},IY=t=>`+${t}`,RY=t=>ae.jsxs(am,{nested:!0,children:[ae.jsx(vY,{sticky:!0,children:t.group}),ae.jsx(RS,{children:t.children})]},t.key),DY=t=>{const{disabled:e,focused:n,hasClearIcon:r,hasPopupIcon:a,popupOpen:l,variant:u,color:s,size:m,multiple:_}=t,b={root:["root",n&&"focused",r&&"hasClearIcon",a&&"hasPopupIcon",u&&`variant${Ln(u)}`,s&&`color${Ln(s)}`,m&&`size${Ln(m)}`],wrapper:["wrapper",_&&"multiple"],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",l&&"popupIndicatorOpen",e&&"disabled"],listbox:["listbox"],option:["option"],loading:["loading"],noOptions:["noOptions"],limitTag:["limitTag"]};return $r(b,yY,{})},LY=vn(tB,{name:"JoyAutocomplete",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ye({},t.size==="sm"&&{"--Autocomplete-wrapperGap":"3px"},t.size==="md"&&{"--Autocomplete-wrapperGap":"3px"},t.size==="lg"&&{"--Autocomplete-wrapperGap":"4px"},{"@media (pointer: fine)":{[`&:hover .${Op.clearIndicator}`]:{visibility:"visible"}}},t.multiple&&!t.startDecorator&&{paddingInlineStart:0})),kY=vn("div",{name:"JoyAutocomplete",slot:"Wrapper",overridesResolver:(t,e)=>e.wrapper})(({ownerState:t})=>({flex:1,minWidth:0,display:"flex",alignItems:"center",flexWrap:"wrap",gap:"var(--Autocomplete-wrapperGap)",[`&.${Op.multiple}`]:ye({paddingBlock:"var(--Autocomplete-wrapperGap)"},!t.startDecorator&&{paddingInlineStart:"var(--Autocomplete-wrapperGap)"},!t.endDecorator&&{paddingInlineEnd:"var(--Autocomplete-wrapperGap)"})})),zY=vn(nB,{name:"JoyAutocomplete",slot:"Input",overridesResolver:(t,e)=>e.input})(({ownerState:t})=>ye({minWidth:30,minHeight:"var(--Chip-minHeight)"},t.multiple&&{marginInlineStart:"calc(var(--Autocomplete-wrapperGap) * 2.5)"})),OY=vn(rB,{name:"JoyAutocomplete",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({}),FY=vn(iB,{name:"JoyAutocomplete",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})(({ownerState:t})=>ye({},(t.hasClearIcon||t.hasPopupIcon)&&{"--Button-margin":"0px","--IconButton-margin":"0px","--Icon-margin":"0px"})),NY=vn(Px,{name:"JoyAutocomplete",slot:"ClearIndicator",overridesResolver:(t,e)=>e.clearIndicator})(({ownerState:t})=>ye({alignSelf:"center"},!t.hasPopupIcon&&{marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)"},{marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",visibility:t.focused?"visible":"hidden"})),BY=vn(Px,{name:"JoyAutocomplete",slot:"PopupIndicator",overridesResolver:(t,e)=>e.popupIndicator})({alignSelf:"center",marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)",[`&.${Op.popupIndicatorOpen}`]:{transform:"rotate(180deg)","--Icon-color":"currentColor"}}),UY=vn(oB,{name:"JoyAutocomplete",slot:"Listbox",overridesResolver:(t,e)=>e.listbox})(({theme:t})=>({zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`})),$Y=vn(sB,{name:"JoyAutocomplete",slot:"Option",overridesResolver:(t,e)=>e.option})({}),VY=vn(am,{name:"JoyAutocomplete",slot:"Loading",overridesResolver:(t,e)=>e.loading})(({theme:t})=>({color:(t.vars||t).palette.text.secondary})),jY=vn(am,{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(t,e)=>e.noOptions})(({theme:t})=>({color:(t.vars||t).palette.text.secondary})),HY=vn("div",{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(t,e)=>e.noOptions})({marginInlineStart:"calc(var(--Input-paddingInline) / 2)",marginBlockStart:"var(--_Input-paddingBlock)"}),Mw=q.forwardRef(function(e,n){var r,a,l,u,s,m,_;const b=Gr({props:e,name:"JoyAutocomplete"}),{"aria-describedby":M,"aria-label":C,"aria-labelledby":A,autoFocus:k,clearIcon:z=bL||(bL=ae.jsx(ZN,{fontSize:"md"})),clearText:P="Clear",closeText:O="Close",disableClearable:j=!1,disabled:U,endDecorator:X,error:K=!1,forcePopupIcon:se="auto",freeSolo:J=!1,getLimitTagsText:ue=IY,getOptionLabel:ne=AY,groupBy:H,id:de,limitTags:Ee=-1,loading:Pe=!1,loadingText:Ze="Loading",multiple:ke=!1,name:Te,noOptionsText:Ie="No options",openText:Ce="Open",placeholder:Ue,popupIcon:nt=wL||(wL=ae.jsx(CZ,{})),readOnly:Le=!1,renderGroup:lt=RY,renderOption:Ht,renderTags:He,required:pt,type:_t,startDecorator:ot,size:et="md",color:Mt="neutral",variant:Tt="outlined",component:hn,slots:en={},slotProps:an={}}=b,Ke=lr(b,SY),An=q.useContext(kS),Gt=(r=(a=e.error)!=null?a:An?.error)!=null?r:K,on=(l=(u=e.size)!=null?u:An?.size)!=null?l:et,Wt=(s=e.color)!=null?s:Gt?"danger":(m=An?.color)!=null?m:Mt,Gn=(_=U??An?.disabled)!=null?_:!1,{getRootProps:dn,getInputProps:Ve,getPopupIndicatorProps:Se,getClearProps:bt,getTagProps:Nt,getListboxProps:jt,getOptionProps:Ut,value:yn,dirty:Zt,popupOpen:qt,focused:Fn,focusedTag:Be,anchorEl:ee,setAnchorEl:oe,inputValue:fe,groupedOptions:he}=iZ(ye({},b,{id:de??An?.htmlFor,componentName:"Autocomplete",unstable_classNamePrefix:"Mui",unstable_isActiveElementInListbox:PY})),{onMouseDown:xe}=Ve(),{onClick:Ye}=dn(),st=!j&&!Gn&&Zt&&!Le,_e=(!J||se===!0)&&se!==!1,Fe=ye({instanceColor:e.color},b,{value:yn,disabled:Gn,focused:Fn,getOptionLabel:ne,hasOptions:!!he.length,hasClearIcon:st,hasPopupIcon:_e,inputFocused:Be===-1,popupOpen:qt,size:on,color:Wt,variant:Tt}),Ge=DY(Fe),je=ye({},Ke,{component:hn,slots:en,slotProps:an});let De;if(ke&&yn.length>0){const mn=Wn=>{const Pn=Nt(Wn),{onDelete:Rn}=Pn,Qn=lr(Pn,MY);return ye({disabled:Gn,size:on,onClick:Rn},Qn)};He?De=He(yn,mn,Fe):De=yn.map((Wn,Pn)=>{const Rn=mn({index:Pn}),{key:Qn}=Rn,Ir=lr(Rn,EY);return ae.jsx(QN,{size:on,variant:"soft",color:"neutral",endDecorator:ae.jsx(nY,ye({},Ir),Qn),sx:{minWidth:0},children:ne(Wn)},Pn)})}const zt=pi(n,oe),fn={[Op.disabled]:Gn,[Op.error]:Gt,[Op.focused]:Fn,[Op.formControl]:!!An},[sn,Jt]=$n("root",{ref:zt,className:[Ge.root,fn],elementType:LY,externalForwardedProps:je,ownerState:Fe,getSlotProps:dn,additionalProps:{onClick:mn=>{Ye&&Ye(mn),mn.currentTarget===mn.target&&xe&&xe(mn)}}}),[cn,Zn]=$n("wrapper",{className:Ge.wrapper,elementType:kY,externalForwardedProps:je,ownerState:Fe}),yr={[Op.disabled]:Gn},[Ar,Je]=$n("input",{className:[Ge.input,yr],elementType:zY,getSlotProps:mn=>{const Wn=Ve(),{onBlur:Pn,onFocus:Rn,onMouseDown:Qn}=Wn,Ir=lr(Wn,CY);return ye({},Ir,{onBlur:wr=>{var On;Pn?.(wr),(On=mn.onBlur)==null||On.call(mn,wr)},onFocus:wr=>{var On;Rn?.(wr),(On=mn.onFocus)==null||On.call(mn,wr)},onMouseDown:wr=>{var On;Qn?.(wr),(On=mn.onMouseDown)==null||On.call(mn,wr)}})},externalForwardedProps:je,ownerState:Fe,additionalProps:{autoFocus:k,placeholder:Ue,name:Te,readOnly:Le,disabled:Gn,required:pt??An?.required,type:_t,"aria-invalid":Gt||void 0,"aria-label":C,"aria-labelledby":A,"aria-describedby":M??An?.["aria-describedby"]}}),[gt,St]=$n("startDecorator",{className:Ge.startDecorator,elementType:OY,externalForwardedProps:je,ownerState:Fe}),[ft,Qt]=$n("endDecorator",{className:Ge.endDecorator,elementType:FY,externalForwardedProps:je,ownerState:Fe}),[Sn,Un]=$n("clearIndicator",{className:Ge.clearIndicator,elementType:NY,getSlotProps:bt,externalForwardedProps:je,ownerState:Fe,getSlotOwnerState:mn=>({size:mn.size||on,variant:mn.variant||pg(Tt,Wt).variant||"plain",color:mn.color||pg(Tt,Wt).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{"aria-label":P,title:P}}),[kn,Rt]=$n("popupIndicator",{className:Ge.popupIndicator,elementType:BY,getSlotProps:Se,externalForwardedProps:je,ownerState:Fe,getSlotOwnerState:mn=>({size:mn.size||on,variant:mn.variant||pg(Tt,Wt).variant||"plain",color:mn.color||pg(Tt,Wt).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{disabled:Gn,"aria-label":qt?O:Ce,title:qt?O:Ce,type:"button"}}),[ct,ut]=$n("listbox",{className:Ge.listbox,elementType:UY,getSlotProps:jt,externalForwardedProps:je,ownerState:Fe,getSlotOwnerState:mn=>({size:mn.size||on,variant:mn.variant||Tt,color:mn.color||Wt,disableColorInversion:!mn.disablePortal}),additionalProps:{anchorEl:ee,open:qt,style:ee?{width:ee.clientWidth}:{}}}),[Vt,En]=$n("loading",{className:Ge.loading,elementType:VY,externalForwardedProps:je,ownerState:Fe}),[Bn,In]=$n("noOptions",{className:Ge.noOptions,elementType:jY,externalForwardedProps:je,ownerState:Fe,additionalProps:{role:"presentation",onMouseDown:mn=>{mn.preventDefault()}}}),[fr,Re]=$n("limitTag",{className:Ge.limitTag,elementType:HY,externalForwardedProps:je,ownerState:Fe});if(Ee>-1&&Array.isArray(De)){const mn=De.length-Ee;!Fn&&mn>0&&(De=De.splice(0,Ee),De.push(ae.jsx(fr,ye({},Re,{children:ue(mn)}),De.length)))}const[mt,Lt]=$n("option",{className:Ge.option,elementType:$Y,externalForwardedProps:je,ownerState:Fe,getSlotOwnerState:mn=>({variant:mn.variant||pg(Tt,Wt).variant||"plain",color:mn.color||pg(Tt,Wt).color||"neutral",disableColorInversion:!ut.disablePortal}),additionalProps:{as:"li"}}),wt=Ht||((mn,Wn)=>{const{key:Pn}=mn,Rn=lr(mn,TY);return ae.jsx(mt,ye({},Rn,{children:ne(Wn)}),Pn)}),un=(mn,Wn)=>{const Pn=Ut({option:mn,index:Wn});return wt(ye({},Lt,Pn),mn,{selected:!!Pn["aria-selected"],inputValue:fe,ownerState:Fe})},_n=q.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...ut.modifiers||[]],[ut.modifiers]);let pn=null;if(ee){var jn;pn=ae.jsx(LS,{variant:Tt,color:Wt,children:ae.jsx(Sx,{nested:!0,children:ae.jsxs(ct,ye({},ut,{className:yo(ut.className),modifiers:_n},!((jn=b.slots)!=null&&jn.listbox)&&{as:TS,slots:{root:ut.as||"ul"}},{children:[he.map((mn,Wn)=>{if(H){const Pn=mn;return lt({key:String(Pn.key),group:Pn.group,children:Pn.options.map((Rn,Qn)=>un(Rn,Pn.index+Qn))})}return un(mn,Wn)}),Pe&&he.length===0?ae.jsx(Vt,ye({},En,{children:Ze})):null,he.length===0&&!J&&!Pe?ae.jsx(Bn,ye({},In,{children:Ie})):null]}))})})}return ae.jsxs(q.Fragment,{children:[ae.jsxs(sn,ye({},Jt,{children:[ot&&ae.jsx(gt,ye({},St,{children:ot})),ae.jsxs(cn,ye({},Zn,{children:[De,ae.jsx(Ar,ye({},Je))]})),X&&ae.jsx(ft,ye({},Qt,{children:X})),st?ae.jsx(Sn,ye({},Un,{children:z})):null,_e?ae.jsx(kn,ye({},Rt,{children:nt})):null]})),pn]})}),GY=Ng(ae.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function WY(t){return Hr("MuiAvatar",t)}Nr("MuiAvatar",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","fallback","sizeSm","sizeMd","sizeLg","img","variantOutlined","variantSoft","variantSolid"]);const qY=q.createContext(void 0);vn("div",{name:"JoyAvatarGroup",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>ye({},t.size==="sm"&&{"--AvatarGroup-gap":"-0.375rem","--Avatar-ringSize":"2px"},t.size==="md"&&{"--AvatarGroup-gap":"-0.5rem","--Avatar-ringSize":"2px"},t.size==="lg"&&{"--AvatarGroup-gap":"-0.625rem","--Avatar-ringSize":"4px"},{"--Avatar-ring":`0 0 0 var(--Avatar-ringSize) var(--Avatar-ringColor, ${e.vars.palette.background.surface})`,"--Avatar-marginInlineStart":"var(--AvatarGroup-gap)",display:"flex",marginInlineStart:"calc(-1 * var(--AvatarGroup-gap))"}));const XY=["alt","color","size","variant","src","srcSet","children","component","slots","slotProps"],ZY=t=>{const{size:e,variant:n,color:r,src:a,srcSet:l}=t,u={root:["root",n&&`variant${Ln(n)}`,r&&`color${Ln(r)}`,e&&`size${Ln(e)}`],img:[(a||l)&&"img"],fallback:["fallback"]};return $r(u,WY,{})},YY=vn("div",{name:"JoyAvatar",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return ye({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},t.typography[`title-${e.size}`],e.size==="sm"&&{width:"var(--Avatar-size, 2rem)",height:"var(--Avatar-size, 2rem)",fontSize:"calc(var(--Avatar-size, 2rem) * 0.4375)"},e.size==="md"&&{width:"var(--Avatar-size, 2.5rem)",height:"var(--Avatar-size, 2.5rem)",fontSize:"calc(var(--Avatar-size, 2.5rem) * 0.4)"},e.size==="lg"&&{width:"var(--Avatar-size, 3rem)",height:"var(--Avatar-size, 3rem)",fontSize:"calc(var(--Avatar-size, 3rem) * 0.375)"},{marginInlineStart:"var(--Avatar-marginInlineStart)",boxShadow:"var(--Avatar-ring)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,lineHeight:1,overflow:"hidden",borderRadius:"var(--Avatar-radius, 50%)",userSelect:"none"},(n=t.variants[e.variant])==null?void 0:n[e.color])}),KY=vn("img",{name:"JoyAvatar",slot:"Img",overridesResolver:(t,e)=>e.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),JY=vn(GY,{name:"JoyAvatar",slot:"Fallback",overridesResolver:(t,e)=>e.fallback})({width:"64%",height:"64%"});function QY({crossOrigin:t,referrerPolicy:e,src:n,srcSet:r}){const[a,l]=q.useState(!1);return q.useEffect(()=>{if(!n&&!r)return;l(!1);let u=!0;const s=new Image;return s.onload=()=>{u&&l("loaded")},s.onerror=()=>{u&&l("error")},s.crossOrigin=t,s.referrerPolicy=e,n&&(s.src=n),r&&(s.srcset=r),()=>{u=!1}},[t,e,n,r]),a}const eK=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyAvatar"}),a=q.useContext(qY),{alt:l,color:u="neutral",size:s="md",variant:m="soft",src:_,srcSet:b,children:M,component:C,slots:A={},slotProps:k={}}=r,z=lr(r,XY),P=e.variant||a?.variant||m,O=e.color||a?.color||u,j=e.size||a?.size||s;let U=null;const X=ye({},r,{color:O,size:j,variant:P,grouped:!!a}),K=ZY(X),se=ye({},z,{component:C,slots:A,slotProps:k}),[J,ue]=$n("root",{ref:n,className:K.root,elementType:YY,externalForwardedProps:se,ownerState:X}),[ne,H]=$n("img",{additionalProps:{alt:l,src:_,srcSet:b},className:K.img,elementType:KY,externalForwardedProps:se,ownerState:X}),[de,Ee]=$n("fallback",{className:K.fallback,elementType:JY,externalForwardedProps:se,ownerState:X}),Pe=QY(ye({},H,{src:_,srcSet:b}));return(_||b)&&Pe!=="error"?U=ae.jsx(ne,ye({},H)):M!=null?U=M:l?U=l[0]:U=ae.jsx(de,ye({},Ee)),ae.jsx(J,ye({},ue,{children:U}))}),tK=gN("MuiBox",["root"]),zS=eG({themeId:fx,defaultTheme:Xy,defaultClassName:tK.root,generateClassName:fN.generate});function nK(t){return Hr("MuiTypography",t)}Nr("MuiTypography",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","noWrap","gutterBottom","startDecorator","endDecorator","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const rK=["color","textColor"],iK=["component","gutterBottom","noWrap","level","levelMapping","children","endDecorator","startDecorator","variant","slots","slotProps"],Y_=q.createContext(!1),lB=q.createContext(!1),oK=t=>{const{gutterBottom:e,noWrap:n,level:r,color:a,variant:l}=t,u={root:["root",r,e&&"gutterBottom",n&&"noWrap",a&&`color${Ln(a)}`,l&&`variant${Ln(l)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return $r(u,nK,{})},sK=vn("span",{name:"JoyTypography",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),aK=vn("span",{name:"JoyTypography",slot:"endDecorator",overridesResolver:(t,e)=>e.endDecorator})({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),lK=vn("span",{name:"JoyTypography",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,a,l,u;const s=e.level!=="inherit"?(n=t.typography[e.level])==null?void 0:n.lineHeight:"1";return ye({"--Icon-fontSize":`calc(1em * ${s})`},e.color&&{"--Icon-color":"currentColor"},{margin:"var(--Typography-margin, 0px)"},e.nesting?{display:"inline"}:ye({display:"block"},e.unstable_hasSkeleton&&{position:"relative"}),(e.startDecorator||e.endDecorator)&&ye({display:"flex",alignItems:"center"},e.nesting&&ye({display:"inline-flex"},e.startDecorator&&{verticalAlign:"bottom"})),e.level&&e.level!=="inherit"&&t.typography[e.level],{fontSize:`var(--Typography-fontSize, ${e.level&&e.level!=="inherit"&&(r=(a=t.typography[e.level])==null?void 0:a.fontSize)!=null?r:"inherit"})`},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.color&&{color:`var(--variant-plainColor, rgba(${(l=t.vars.palette[e.color])==null?void 0:l.mainChannel} / 1))`},e.variant&&ye({borderRadius:t.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!e.nesting&&{marginInline:"-0.25em"},(u=t.variants[e.variant])==null?void 0:u[e.color]))}),SL={h1:"h1",h2:"h2",h3:"h3",h4:"h4","title-lg":"p","title-md":"p","title-sm":"p","body-lg":"p","body-md":"p","body-sm":"p","body-xs":"span",inherit:"p"},Ci=q.forwardRef(function(e,n){var r;const a=Gr({props:e,name:"JoyTypography"}),{color:l,textColor:u}=a,s=lr(a,rK),m=q.useContext(Y_),_=q.useContext(lB),b=mS(ye({},s,{color:u})),{component:M,gutterBottom:C=!1,noWrap:A=!1,level:k="body-md",levelMapping:z=SL,children:P,endDecorator:O,startDecorator:j,variant:U,slots:X={},slotProps:K={}}=b,se=lr(b,iK),J=(r=e.color)!=null?r:U?l??"neutral":l,ue=m||_?e.level||"inherit":k,ne=gS(P,["Skeleton"]),H=M||(m?"span":z[ue]||SL[ue]||"span"),de=ye({},b,{level:ue,component:H,color:J,gutterBottom:C,noWrap:A,nesting:m,variant:U,unstable_hasSkeleton:ne}),Ee=oK(de),Pe=ye({},se,{component:H,slots:X,slotProps:K}),[Ze,ke]=$n("root",{ref:n,className:Ee.root,elementType:lK,externalForwardedProps:Pe,ownerState:de}),[Te,Ie]=$n("startDecorator",{className:Ee.startDecorator,elementType:sK,externalForwardedProps:Pe,ownerState:de}),[Ce,Ue]=$n("endDecorator",{className:Ee.endDecorator,elementType:aK,externalForwardedProps:Pe,ownerState:de});return ae.jsx(Y_.Provider,{value:!0,children:ae.jsxs(Ze,ye({},ke,{children:[j&&ae.jsx(Te,ye({},Ie,{children:j})),ne?q.cloneElement(P,{variant:P.props.variant||"inline"}):P,O&&ae.jsx(Ce,ye({},Ue,{children:O}))]}))})});Ci.muiName="Typography";function cK(t){return Hr("MuiButton",t)}const ML=Nr("MuiButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]),uK=["children","action","color","variant","size","fullWidth","startDecorator","endDecorator","loading","loadingPosition","loadingIndicator","disabled","component","slots","slotProps"],hK=t=>{const{color:e,disabled:n,focusVisible:r,focusVisibleClassName:a,fullWidth:l,size:u,variant:s,loading:m}=t,_={root:["root",n&&"disabled",r&&"focusVisible",l&&"fullWidth",s&&`variant${Ln(s)}`,e&&`color${Ln(e)}`,u&&`size${Ln(u)}`,m&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]},b=$r(_,cK,{});return r&&a&&(b.root+=` ${a}`),b},dK=vn("span",{name:"JoyButton",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),fK=vn("span",{name:"JoyButton",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),pK=vn("span",{name:"JoyButton",slot:"LoadingCenter",overridesResolver:(t,e)=>e.loadingIndicatorCenter})(({theme:t,ownerState:e})=>{var n,r;return ye({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),cB=({theme:t,ownerState:e})=>{var n,r,a,l;return[ye({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},e.size==="sm"&&{"--Icon-fontSize":t.vars.fontSize.lg,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.375rem",minHeight:"var(--Button-minHeight, 2rem)",fontSize:t.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.25rem)",paddingInline:"0.75rem"},e.size==="md"&&{"--Icon-fontSize":t.vars.fontSize.xl,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.5rem",minHeight:"var(--Button-minHeight, 2.25rem)",fontSize:t.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.375rem)",paddingInline:"1rem"},e.size==="lg"&&{"--Icon-fontSize":t.vars.fontSize.xl2,"--CircularProgress-size":"28px","--CircularProgress-thickness":"4px","--Button-gap":"0.75rem",minHeight:"var(--Button-minHeight, 2.75rem)",fontSize:t.vars.fontSize.md,paddingBlock:"var(--Button-paddingBlock, 0.5rem)",paddingInline:"1.5rem"},{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",borderRadius:`var(--Button-radius, ${t.vars.radius.sm})`,margin:"var(--Button-margin)",border:"none",backgroundColor:"transparent",cursor:"pointer",userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",textDecoration:"none",fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.lg,lineHeight:t.vars.lineHeight.md},e.fullWidth&&{width:"100%"},{[t.focus.selector]:t.focus.default}),ye({},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":{"@media (hover: hover)":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]},'&:active, &[aria-pressed="true"]':(a=t.variants[`${e.variant}Active`])==null?void 0:a[e.color],[`&.${ML.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]},e.loadingPosition==="center"&&{[`&.${ML.loading}`]:{color:"transparent"}})]},mK=vn("button",{name:"JoyButton",slot:"Root",overridesResolver:(t,e)=>e.root})(cB),uB=q.forwardRef(function(e,n){var r;const a=Gr({props:e,name:"JoyButton"}),{children:l,action:u,color:s="primary",variant:m="solid",size:_="md",fullWidth:b=!1,startDecorator:M,endDecorator:C,loading:A=!1,loadingPosition:k="center",loadingIndicator:z,disabled:P,component:O,slots:j={},slotProps:U={}}=a,X=lr(a,uK),K=q.useContext(dI),se=q.useContext(KN),J=e.variant||K.variant||m,ue=e.size||K.size||_,ne=e.color||K.color||s,H=(r=e.loading||e.disabled)!=null?r:K.disabled||A||P,de=q.useRef(null),Ee=pi(de,n),{focusVisible:Pe,setFocusVisible:Ze,getRootProps:ke}=hd(ye({},a,{disabled:H,rootRef:Ee})),Te=z??ae.jsx(fI,{color:ne,thickness:{sm:2,md:3,lg:4}[ue]||3});q.useImperativeHandle(u,()=>({focusVisible:()=>{var Tt;Ze(!0),(Tt=de.current)==null||Tt.focus()}}),[Ze]);const Ie=ye({},a,{color:ne,fullWidth:b,variant:J,size:ue,focusVisible:Pe,loading:A,loadingPosition:k,disabled:H}),Ce=hK(Ie),Ue=Tt=>{var hn;let en=a.onClick;if(typeof U.root=="function"?en=U.root(Ie).onClick:U.root&&(en=U.root.onClick),(hn=en)==null||hn(Tt),se){var an;(an=se.onClick)==null||an.call(se,Tt,a.value)}};let nt=a["aria-pressed"];typeof U.root=="function"?nt=U.root(Ie)["aria-pressed"]:U.root&&(nt=U.root["aria-pressed"]),se!=null&&se.value&&(Array.isArray(se.value)?nt=se.value.indexOf(a.value)!==-1:nt=se.value===a.value);const Le=ye({},X,{component:O,slots:j,slotProps:U}),[lt,Ht]=$n("root",{ref:n,className:Ce.root,elementType:mK,externalForwardedProps:Le,getSlotProps:ke,ownerState:Ie,additionalProps:{onClick:Ue,"aria-pressed":nt}}),[He,pt]=$n("startDecorator",{className:Ce.startDecorator,elementType:dK,externalForwardedProps:Le,ownerState:Ie}),[_t,ot]=$n("endDecorator",{className:Ce.endDecorator,elementType:fK,externalForwardedProps:Le,ownerState:Ie}),[et,Mt]=$n("loadingIndicatorCenter",{className:Ce.loadingIndicatorCenter,elementType:pK,externalForwardedProps:Le,ownerState:Ie});return ae.jsxs(lt,ye({},Ht,{children:[(M||A&&k==="start")&&ae.jsx(He,ye({},pt,{children:A&&k==="start"?Te:M})),l,A&&k==="center"&&ae.jsx(et,ye({},Mt,{children:Te})),(C||A&&k==="end")&&ae.jsx(_t,ye({},ot,{children:A&&k==="end"?Te:C}))]}))});uB.muiName="Button";function gK(t){return Hr("MuiCard",t)}Nr("MuiCard",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","horizontal","vertical"]);const vK=["className","color","component","invertedColors","size","variant","children","orientation","slots","slotProps"],yK=t=>{const{size:e,variant:n,color:r,orientation:a}=t,l={root:["root",a,n&&`variant${Ln(n)}`,r&&`color${Ln(r)}`,e&&`size${Ln(e)}`]};return $r(l,gK,{})},_K=vn("div")(({theme:t,ownerState:e})=>{var n;const{p:r,padding:a,borderRadius:l}=Fg({theme:t,ownerState:e},["p","padding","borderRadius"]);return[ye({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--Card-childRadius":"max((var(--Card-radius) - var(--variant-borderWidth, 0px)) - var(--Card-padding), min(var(--Card-padding) / 2, (var(--Card-radius) - var(--variant-borderWidth, 0px)) / 2))","--AspectRatio-radius":"var(--Card-childRadius)","--unstable_actionMargin":"calc(-1 * var(--variant-borderWidth, 0px))","--unstable_actionRadius":"var(--Card-radius)","--CardCover-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--CardOverflow-offset":"calc(-1 * var(--Card-padding))","--CardOverflow-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--Divider-inset":"calc(-1 * var(--Card-padding))"},e.size==="sm"&&{"--Card-radius":t.vars.radius.sm,"--Card-padding":"0.625rem",gap:"0.5rem"},e.size==="md"&&{"--Card-radius":t.vars.radius.md,"--Card-padding":"1rem",gap:"0.75rem 1rem"},e.size==="lg"&&{"--Card-radius":t.vars.radius.lg,"--Card-padding":"1.5rem",gap:"1rem 1.5rem"},{padding:"var(--Card-padding)",borderRadius:"var(--Card-radius)",backgroundColor:t.vars.palette.background.surface,position:"relative",display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column"},t.typography[`body-${e.size}`],e.variant==="solid"&&e.color&&e.invertedColors&&Cx(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Tx(e.color)(t),(n=t.variants[e.variant])==null?void 0:n[e.color]),r!==void 0&&{"--Card-padding":r},a!==void 0&&{"--Card-padding":a},l!==void 0&&{"--Card-radius":l}]}),xK=vn(_K,{name:"JoyCard",slot:"Root",overridesResolver:(t,e)=>e.root})({}),eP=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyCard"}),{className:a,color:l="neutral",component:u="div",invertedColors:s=!1,size:m="md",variant:_="outlined",children:b,orientation:M="vertical",slots:C={},slotProps:A={}}=r,k=lr(r,vK),z=ye({},r,{color:l,component:u,orientation:M,size:m,variant:_,invertedColors:s}),P=yK(z),O=ye({},k,{component:u,slots:C,slotProps:A}),[j,U]=$n("root",{ref:n,className:yo(P.root,a),elementType:xK,externalForwardedProps:O,ownerState:z});return ae.jsx(j,ye({},U,{children:q.Children.map(b,(X,K)=>{if(!q.isValidElement(X))return X;const se={};if(gS(X,["Divider"])){var J,ue;const ne=X.props;se.inset=(J=ne?.inset)!=null?J:"context";const H=M==="vertical"?"horizontal":"vertical";se.orientation=(ue=ne?.orientation)!=null?ue:H}return K===0&&(se["data-first-child"]=""),K===q.Children.count(b)-1&&(se["data-last-child"]=""),q.cloneElement(X,se)})}))}),hB=Nr("MuiCardOverflow",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);function bK(t){return Hr("MuiDivider",t)}Nr("MuiDivider",["root","horizontal","vertical","insetContext","insetNone"]);const dB=vn("div")(({ownerState:t})=>({display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column",flex:9999,zIndex:1,columnGap:"var(--Card-padding)",rowGap:"max(2px, calc(0.1875 * var(--Card-padding)))",padding:"var(--unstable_padding)",[`.${hB.root} > &`]:{"--unstable_padding":"calc(var(--Card-padding) * 0.75) 0px"}}));vn(dB,{name:"JoyCardContent",slot:"Root",overridesResolver:(t,e)=>e.root})({});const wK=Nr("MuiModalDialog",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","layoutCenter","layoutFullscreen"]);function SK(t){return Hr("MuiCheckbox",t)}const Cg=Nr("MuiCheckbox",["root","checkbox","action","input","label","checked","disabled","focusVisible","indeterminate","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantOutlined","variantSoft","variantSolid"]),MK=Ng(ae.jsx("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"Check"),EK=Ng(ae.jsx("path",{d:"M19 13H5c-.55 0-1-.45-1-1s.45-1 1-1h14c.55 0 1 .45 1 1s-.45 1-1 1z"}),"HorizontalRule"),CK=["checked","uncheckedIcon","checkedIcon","label","defaultChecked","disabled","disableIcon","overlay","id","indeterminate","indeterminateIcon","name","onBlur","onChange","onFocus","onFocusVisible","readOnly","required","value","color","variant","size","component","slots","slotProps"],TK=t=>{const{checked:e,disabled:n,disableIcon:r,focusVisible:a,color:l,variant:u,size:s,indeterminate:m}=t,_={root:["root",e&&"checked",n&&"disabled",a&&"focusVisible",u&&`variant${Ln(u)}`,l&&`color${Ln(l)}`,s&&`size${Ln(s)}`],checkbox:["checkbox",e&&"checked",m&&"indeterminate",n&&"disabled"],action:["action",e&&"checked",r&&n&&"disabled",a&&"focusVisible"],input:["input"],label:["label"]};return $r(_,SK,{})},PK=vn("span",{name:"JoyCheckbox",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,a;return ye({"--Icon-fontSize":"var(--Checkbox-size)"},t.size==="sm"&&{"--Checkbox-size":"1rem","& ~ *":{"--FormHelperText-margin":"0 0 0 1.5rem"},fontSize:e.vars.fontSize.sm,gap:"var(--Checkbox-gap, 0.5rem)"},t.size==="md"&&{"--Checkbox-size":"1.25rem","& ~ *":{"--FormHelperText-margin":"0.25rem 0 0 1.875rem"},fontSize:e.vars.fontSize.md,gap:"var(--Checkbox-gap, 0.625rem)"},t.size==="lg"&&{"--Checkbox-size":"1.5rem","& ~ *":{"--FormHelperText-margin":"0.375rem 0 0 2.25rem"},fontSize:e.vars.fontSize.lg,gap:"var(--Checkbox-gap, 0.75rem)"},{position:t.overlay?"initial":"relative",display:"inline-flex",fontFamily:e.vars.fontFamily.body,lineHeight:"var(--Checkbox-size)",color:e.vars.palette.text.primary,[`&.${Cg.disabled}`]:{color:(n=e.variants.plainDisabled)==null||(n=n[t.color])==null?void 0:n.color}},t.disableIcon&&{color:(r=e.variants[t.variant])==null||(r=r[t.color])==null?void 0:r.color,[`&.${Cg.disabled}`]:{color:(a=e.variants[`${t.variant}Disabled`])==null||(a=a[t.color])==null?void 0:a.color}})}),AK=vn("span",{name:"JoyCheckbox",slot:"Checkbox",overridesResolver:(t,e)=>e.checkbox})(({theme:t,ownerState:e})=>{var n,r,a,l,u;const s=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color];return[ye({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,boxSizing:"border-box",borderRadius:`min(${t.vars.radius.sm}, 0.25rem)`,width:"var(--Checkbox-size)",height:"var(--Checkbox-size)",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},e.disableIcon&&{display:"contents"},{[`&.${Cg.checked}, &.${Cg.indeterminate}`]:{"--Icon-color":"currentColor"}}),...e.disableIcon?[]:[ye({},s,{backgroundColor:(r=s?.backgroundColor)!=null?r:t.vars.palette.background.surface}),{"&:hover":{"@media (hover: hover)":(a=t.variants[`${e.variant}Hover`])==null?void 0:a[e.color]}},{"&:active":(l=t.variants[`${e.variant}Active`])==null?void 0:l[e.color]},{[`&.${Cg.disabled}`]:(u=t.variants[`${e.variant}Disabled`])==null?void 0:u[e.color]}]]}),IK=vn("span",{name:"JoyCheckbox",slot:"Action",overridesResolver:(t,e)=>e.action})(({theme:t,ownerState:e})=>{var n,r,a,l;return[{borderRadius:`var(--Checkbox-actionRadius, ${e.overlay?"var(--unstable_actionRadius, inherit)":"inherit"})`,textAlign:"left",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",zIndex:1,[t.focus.selector]:t.focus.default},...e.disableIcon?[(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]},{"&:active":(a=t.variants[`${e.variant}Active`])==null?void 0:a[e.color]},{[`&.${Cg.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]}]:[]]}),RK=vn("input",{name:"JoyCheckbox",slot:"Input",overridesResolver:(t,e)=>e.input})(()=>({margin:0,opacity:0,position:"absolute",width:"100%",height:"100%",cursor:"pointer"})),DK=vn("label",{name:"JoyCheckbox",slot:"Label",overridesResolver:(t,e)=>e.label})(({ownerState:t})=>ye({flex:1,minWidth:0},t.disableIcon&&{zIndex:1,pointerEvents:"none"})),LK=ae.jsx(MK,{}),kK=ae.jsx(EK,{}),ky=q.forwardRef(function(e,n){var r,a,l,u,s;const m=Gr({props:e,name:"JoyCheckbox"}),{checked:_,uncheckedIcon:b,checkedIcon:M=LK,label:C,defaultChecked:A,disabled:k,disableIcon:z=!1,overlay:P,id:O,indeterminate:j=!1,indeterminateIcon:U=kK,name:X,onBlur:K,onChange:se,onFocus:J,onFocusVisible:ue,readOnly:ne,required:H,value:de,color:Ee,variant:Pe,size:Ze="md",component:ke,slots:Te={},slotProps:Ie={}}=m,Ce=lr(m,CK),Ue=q.useContext(kS),nt=(r=(a=e.disabled)!=null?a:Ue?.disabled)!=null?r:k,Le=(l=(u=e.size)!=null?u:Ue?.size)!=null?l:Ze,lt=Pl(O??Ue?.htmlFor),Ht={checked:_,defaultChecked:A,disabled:nt,onBlur:K,onChange:se,onFocus:J,onFocusVisible:ue},{getInputProps:He,checked:pt,disabled:_t,focusVisible:ot}=GX(Ht),et=pt||j,hn=et?Pe||"solid":Pe||"outlined",en=e.color||(Ue!=null&&Ue.error?"danger":(s=Ue?.color)!=null?s:Ee),An=ye({},m,{checked:pt,disabled:_t,disableIcon:z,overlay:P,focusVisible:ot,color:et?en||"primary":en||"neutral",variant:hn,size:Le}),Gt=TK(An),on=ye({},Ce,{component:ke,slots:Te,slotProps:Ie}),[Wt,Gn]=$n("root",{ref:n,className:Gt.root,elementType:PK,externalForwardedProps:on,ownerState:An}),[dn,Ve]=$n("checkbox",{className:Gt.checkbox,elementType:AK,externalForwardedProps:on,ownerState:An}),[Se,bt]=$n("action",{className:Gt.action,elementType:IK,externalForwardedProps:on,ownerState:An}),[Nt,jt]=$n("input",{additionalProps:ye({id:lt,name:X,value:de,readOnly:ne,role:void 0,required:H??Ue?.required,"aria-describedby":Ue?.["aria-describedby"]},j&&{"aria-checked":"mixed"}),className:Gt.input,elementType:RK,externalForwardedProps:on,getSlotProps:He,ownerState:An}),[Ut,yn]=$n("label",{additionalProps:{htmlFor:lt},className:Gt.label,elementType:DK,externalForwardedProps:on,ownerState:An});let Zt=b;return z?Zt=null:j?Zt=U:pt&&(Zt=M),ae.jsxs(Wt,ye({},Gn,{children:[ae.jsxs(dn,ye({},Ve,{children:[ae.jsx(Se,ye({},bt,{children:ae.jsx(Nt,ye({},jt))})),Zt]})),C&&ae.jsx(Y_.Provider,{value:!0,children:ae.jsx(Ut,ye({},yn,{children:C}))})]}))});function zK(t){const{children:e,disableColorScheme:n=!1}=t;return ae.jsxs(q.Fragment,{children:[ae.jsx(hW,{styles:r=>{var a,l;const u={};n||Object.entries(r.colorSchemes).forEach(([m,_])=>{var b;u[r.getColorSchemeSelector(m).replace(/\s*&/,"")]={colorScheme:(b=_.palette)==null?void 0:b.mode}});const s=(a=(l=r.components)==null||(l=l.JoyTypography)==null||(l=l.defaultProps)==null?void 0:l.level)!=null?a:"body-md";return ye({html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:r.vars.fontWeight.lg},body:ye({margin:0,color:r.vars.palette.text.primary,fontFamily:r.vars.fontFamily.body},r.typography[s],{backgroundColor:r.vars.palette.background.body,"@media print":{backgroundColor:r.vars.palette.common.white},"&::backdrop":{backgroundColor:r.vars.palette.background.backdrop}})},u)},defaultTheme:Xy}),e]})}function OK(t){return Hr("MuiDialogContent",t)}Nr("MuiDialogContent",["root"]);const OS=q.createContext(void 0);function FK(t){return Hr("MuiDialogTitle",t)}const fB=Nr("MuiDialogTitle",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),NK=["component","children","orientation","slots","slotProps"],BK=()=>$r({root:["root"]},OK,{}),UK=vn(dB,{name:"JoyDialogContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({color:`var(--DialogContent-color, ${t.vars.palette.text.tertiary})`,overflow:"auto",margin:"var(--unstable_DialogContent-margin)",[`.${wK.root} > .${fB.root} + &`]:{"--unstable_DialogContent-margin":"-0.375em 0 0 0"}})),pB=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyDialogContent"}),a=q.useContext(OS),{component:l="div",children:u,orientation:s="vertical",slots:m={},slotProps:_={}}=r,b=lr(r,NK),M=ye({},b,{component:l,slots:m,slotProps:_}),C=ye({},r,{component:l,orientation:s}),A=BK(),[k,z]=$n("root",{ref:n,className:A.root,elementType:UK,externalForwardedProps:M,ownerState:C,additionalProps:{id:a?.describedBy}});return ae.jsx(k,ye({},z,{children:u}))}),pI=q.createContext(void 0),$K=["component","children","variant","color","level","slots","slotProps"],VK=t=>{const{level:e,color:n,variant:r}=t,a={root:["root",e,n&&`color${Ln(n)}`,r&&`variant${Ln(r)}`]};return $r(a,FK,{})},jK=vn("h2",{name:"JoyDialogTitle",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const a=e.level!=="inherit"?(n=t.typography[e.level])==null?void 0:n.lineHeight:"1";return ye({"--Icon-fontSize":`calc(1em * ${a})`},e.color&&{"--Icon-color":"currentColor"},{display:"flex",gap:"clamp(4px, 0.375em, 0.75rem)",margin:"var(--unstable_DialogTitle-margin, 0px)"},e.level&&e.level!=="inherit"&&t.typography[e.level],{color:"inherit"},e.variant&&ye({borderRadius:t.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},(r=t.variants[e.variant])==null?void 0:r[e.color]),{[`.${hB.root} > &`]:{"--unstable_DialogTitle-margin":"var(--Card-padding) 0"}})}),HK={sm:"title-md",md:"title-lg",lg:"h4"},mB=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyDialogTitle"}),a=q.useContext(pI),l=q.useContext(OS),{component:u="h2",children:s,variant:m,color:_,level:b=HK[a||"md"],slots:M={},slotProps:C={}}=r,A=lr(r,$K),k=e.color||(m?_??"neutral":_),z=ye({},A,{component:u,slots:M,slotProps:C}),P=ye({},r,{component:u,color:k,variant:m,level:b}),O=VK(P),[j,U]=$n("root",{ref:n,className:O.root,elementType:jK,externalForwardedProps:z,ownerState:P,additionalProps:{id:l?.labelledBy}});return ae.jsx(j,ye({},U,{children:s}))}),GK=["className","children","component","inset","orientation","role","slots","slotProps"],WK=t=>{const{orientation:e,inset:n}=t,r={root:["root",e,n&&`inset${Ln(n)}`]};return $r(r,bK,{})},gB=vn("hr",{name:"JoyDivider",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>ye({"--Divider-thickness":"1px","--Divider-lineColor":t.vars.palette.divider},e.inset==="none"&&{"--_Divider-inset":"0px"},e.inset==="context"&&{"--_Divider-inset":"var(--Divider-inset, 0px)"},{margin:"initial",marginInline:e.orientation==="vertical"?"initial":"var(--_Divider-inset)",marginBlock:e.orientation==="vertical"?"var(--_Divider-inset)":"initial",position:"relative",alignSelf:"stretch",flexShrink:0},e.children?ye({"--Divider-gap":t.spacing(1),"--Divider-childPosition":"50%",display:"flex",flexDirection:e.orientation==="vertical"?"column":"row",alignItems:"center",whiteSpace:"nowrap",textAlign:"center",border:0},t.typography["body-sm"],{"&::before, &::after":{position:"relative",inlineSize:e.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:e.orientation==="vertical"?"initial":"var(--Divider-thickness)",backgroundColor:"var(--Divider-lineColor)",content:'""'},"&::before":{marginInlineEnd:e.orientation==="vertical"?"initial":"min(var(--Divider-childPosition) * 999, var(--Divider-gap))",marginBlockEnd:e.orientation==="vertical"?"min(var(--Divider-childPosition) * 999, var(--Divider-gap))":"initial",flexBasis:"var(--Divider-childPosition)"},"&::after":{marginInlineStart:e.orientation==="vertical"?"initial":"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))",marginBlockStart:e.orientation==="vertical"?"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))":"initial",flexBasis:"calc(100% - var(--Divider-childPosition))"}}):{border:"none",listStyle:"none",backgroundColor:"var(--Divider-lineColor)",inlineSize:e.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:e.orientation==="vertical"?"initial":"var(--Divider-thickness)"})),Ax=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyDivider"}),{className:a,children:l,component:u=l!=null?"div":"hr",inset:s,orientation:m="horizontal",role:_=u!=="hr"?"separator":void 0,slots:b={},slotProps:M={}}=r,C=lr(r,GK),A=ye({},r,{inset:s,role:_,orientation:m,component:u}),k=WK(A),z=ye({},C,{component:u,slots:b,slotProps:M}),[P,O]=$n("root",{ref:n,className:yo(k.root,a),elementType:gB,externalForwardedProps:z,ownerState:A,additionalProps:ye({as:u,role:_},_==="separator"&&m==="vertical"&&{"aria-orientation":"vertical"})});return ae.jsx(P,ye({},O,{children:l}))});Ax.muiName="Divider";const vB=q.createContext(void 0),yB=vn("div")(({ownerState:t,theme:e})=>ye({"--unstable_popup-zIndex":`calc(${e.vars.zIndex.modal} + 1)`,'& ~ [role="listbox"]':{"--unstable_popup-zIndex":`calc(${e.vars.zIndex.modal} + 1)`},position:"fixed",zIndex:e.vars.zIndex.modal,right:0,bottom:0,top:0,left:0},!t.open&&{visibility:"hidden"}));vn(yB,{name:"JoyModal",slot:"Root",overridesResolver:(t,e)=>e.root})({});const _B=vn("div")(({theme:t})=>({zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:t.vars.palette.background.backdrop,WebkitTapHighlightColor:"transparent",backdropFilter:"blur(8px)"}));vn(_B,{name:"JoyModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({});function qK(t){return Hr("MuiDrawer",t)}Nr("MuiDrawer",["root","hidden","backdrop","content","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const XK=["children","anchor","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","color","variant","invertedColors","size","onClose","onKeyDown","open","component","slots","slotProps"],ZK=t=>{const{open:e,variant:n,color:r,size:a}=t,l={root:["root",!e&&"hidden",n&&`variant${Ln(n)}`,r&&`color${Ln(r)}`,a&&`size${Ln(a)}`],backdrop:["backdrop"],content:["content"]};return $r(l,qK,{})},YK=vn(yB,{name:"JoyDrawer",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ye({"--Drawer-transitionDuration":"0.3s","--Drawer-transitionFunction":"ease","--ModalClose-radius":"max((var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) - var(--ModalClose-inset), min(var(--ModalClose-inset) / 2, (var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) / 2))"},t.size==="sm"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(350px, 30%, 100%)","--Drawer-horizontalSize":"clamp(256px, 20%, 100%)","--Drawer-titleMargin":"0.625rem 0.75rem calc(0.625rem / 2)"},t.size==="md"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(400px, 45%, 100%)","--Drawer-horizontalSize":"clamp(300px, 30%, 100%)","--Drawer-titleMargin":"0.75rem 0.75rem calc(0.75rem / 2)"},t.size==="lg"&&{"--ModalClose-inset":"0.75rem","--Drawer-verticalSize":"clamp(500px, 60%, 100%)","--Drawer-horizontalSize":"clamp(440px, 60%, 100%)","--Drawer-titleMargin":"1rem 1rem calc(1rem / 2)"},{transitionProperty:"visibility",transitionDelay:t.open?"0s":"var(--Drawer-transitionDuration)"},!t.open&&{visibility:"hidden"})),KK=vn(_B,{name:"JoyDrawer",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})(({ownerState:t})=>({opacity:t.open?1:0,transition:"opacity var(--Drawer-transitionDuration) ease-in-out"})),JK=vn("div",{name:"JoyDrawer",slot:"Content",overridesResolver:(t,e)=>e.content})(({theme:t,ownerState:e})=>{var n;return ye({},t.typography[`body-${e.size}`],{boxShadow:t.shadow.md,backgroundColor:t.vars.palette.background.surface,outline:0,display:"flex",flexDirection:"column",position:"fixed",boxSizing:"border-box",overflow:"auto"},e.anchor==="left"&&{top:0,left:0,transform:e.open?"translateX(0)":"translateX(-100%)"},e.anchor==="right"&&{top:0,right:0,transform:e.open?"translateX(0)":"translateX(100%)"},e.anchor==="top"&&{top:0,transform:e.open?"translateY(0)":"translateY(-100%)"},e.anchor==="bottom"&&{bottom:0,transform:e.open?"translateY(0)":"translateY(100%)"},{height:e.anchor.match(/(left|right)/)?"100%":"min(100vh, var(--Drawer-verticalSize))",width:e.anchor.match(/(top|bottom)/)?"100vw":"min(100vw, var(--Drawer-horizontalSize))",transition:"transform var(--Drawer-transitionDuration) var(--Drawer-transitionFunction)"},e.variant==="solid"&&e.color&&e.invertedColors&&Cx(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Tx(e.color)(t),(n=t.variants[e.variant])==null?void 0:n[e.color],{[`& > .${fB.root}`]:{"--unstable_DialogTitle-margin":"var(--Drawer-titleMargin)"}})}),xB=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyDrawer"}),{children:a,anchor:l="left",container:u,disableAutoFocus:s=!1,disableEnforceFocus:m=!1,disableEscapeKeyDown:_=!1,disablePortal:b=!1,disableRestoreFocus:M=!1,disableScrollLock:C=!1,hideBackdrop:A=!1,color:k="neutral",variant:z="plain",invertedColors:P=!1,size:O="md",onClose:j,open:U,component:X,slots:K={},slotProps:se={}}=r,J=lr(r,XK),ue=ye({},r,{anchor:l,disableAutoFocus:s,disableEnforceFocus:m,disableEscapeKeyDown:_,disablePortal:b,disableRestoreFocus:M,disableScrollLock:C,hideBackdrop:A,invertedColors:P,color:k,variant:z,size:O}),{getRootProps:ne,getBackdropProps:H,rootRef:de,portalRef:Ee,isTopModal:Pe}=bq(ye({},ue,{rootRef:n,children:null})),Ze=ZK(ue),ke=ye({},J,{component:X,slots:K,slotProps:se}),Te=Pl(),Ie=Pl(),Ce=q.useMemo(()=>({variant:z,color:k,labelledBy:Te,describedBy:Ie}),[k,z,Te,Ie]),[Ue,nt]=$n("root",{ref:de,className:Ze.root,elementType:YK,externalForwardedProps:ke,getSlotProps:ne,ownerState:ue}),[Le,lt]=$n("backdrop",{className:Ze.backdrop,elementType:KK,externalForwardedProps:ke,getSlotProps:H,ownerState:ue}),[Ht,He]=$n("content",{className:Ze.content,elementType:JK,additionalProps:{tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":Te,"aria-describedby":Ie},externalForwardedProps:ke,ownerState:ue});return ae.jsx(vB.Provider,{value:j,children:ae.jsx(pI.Provider,{value:O,children:ae.jsx(OS.Provider,{value:Ce,children:ae.jsx(DN,{ref:Ee,container:u,disablePortal:b,children:ae.jsxs(Ue,ye({},nt,{children:[A?null:ae.jsx(Le,ye({},lt)),ae.jsx(DW,{disableEnforceFocus:m,disableAutoFocus:s,disableRestoreFocus:M,isEnabled:Pe,open:U,children:ae.jsx(Ht,ye({},He,{children:a}))})]}))})})})})});function QK(t){return Hr("MuiLink",t)}const EL=Nr("MuiLink",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","variantPlain","variantOutlined","variantSoft","variantSolid","underlineNone","underlineHover","underlineAlways","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","startDecorator","endDecorator"]),eJ=["color","textColor","variant"],tJ=["children","disabled","onBlur","onFocus","level","overlay","underline","endDecorator","startDecorator","component","slots","slotProps"],nJ=t=>{const{level:e,color:n,variant:r,underline:a,focusVisible:l,disabled:u}=t,s={root:["root",n&&`color${Ln(n)}`,u&&"disabled",l&&"focusVisible",e,a&&`underline${Ln(a)}`,r&&`variant${Ln(r)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return $r(s,QK,{})},rJ=vn("span",{name:"JoyLink",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})(({ownerState:t})=>{var e;return ye({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Link-gap, 0.375em), 0.75rem)"},typeof t.startDecorator!="string"&&(t.alignItems==="flex-start"||((e=t.sx)==null?void 0:e.alignItems)==="flex-start")&&{marginTop:"2px"})}),iJ=vn("span",{name:"JoyLink",slot:"endDecorator",overridesResolver:(t,e)=>e.endDecorator})(({ownerState:t})=>{var e;return ye({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Link-gap, 0.25em), 0.5rem)"},typeof t.startDecorator!="string"&&(t.alignItems==="flex-start"||((e=t.sx)==null?void 0:e.alignItems)==="flex-start")&&{marginTop:"2px"})}),oJ=vn("a",{name:"JoyLink",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,a,l,u,s,m;return[ye({"--Icon-fontSize":"1.25em","--Icon-color":"currentColor","--CircularProgress-size":"1.25em","--CircularProgress-thickness":"3px"},e.level&&e.level!=="inherit"&&t.typography[e.level],e.level==="inherit"&&{font:"inherit"},e.underline==="none"&&{textDecoration:"none"},e.underline==="hover"&&{textDecoration:"none","&:hover":{"@media (hover: hover)":{textDecorationLine:"underline"}}},e.underline==="always"&&{textDecoration:"underline"},e.startDecorator&&{verticalAlign:"bottom"},{textDecorationThickness:"max(0.08em, 1px)",textUnderlineOffset:"0.15em",display:"inline-flex",alignItems:"center",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:t.vars.radius.xs,padding:0,cursor:"pointer",textDecorationColor:`var(--variant-outlinedBorder, rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / var(--Link-underlineOpacity, 0.72)))`},e.variant?ye({paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!e.nesting&&{marginInline:"-0.25em"}):{color:`var(--variant-plainColor, rgba(${(r=t.vars.palette[e.color])==null?void 0:r.mainChannel} / 1))`,[`&.${EL.disabled}`]:{pointerEvents:"none",color:`var(--variant-plainDisabledColor, rgba(${(a=t.vars.palette[e.color])==null?void 0:a.mainChannel} / 0.6))`}},{userSelect:e.component==="button"?"none":void 0,MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"}},e.overlay?{position:"initial","&::after":{content:'""',display:"block",position:"absolute",top:0,left:0,bottom:0,right:0,borderRadius:"var(--unstable_actionRadius, inherit)",margin:"var(--unstable_actionMargin)"},[`${t.focus.selector}`]:{"&::after":t.focus.default}}:{position:"relative",[t.focus.selector]:t.focus.default}),e.variant&&ye({},(l=t.variants[e.variant])==null?void 0:l[e.color],{"&:hover":{"@media (hover: hover)":(u=t.variants[`${e.variant}Hover`])==null?void 0:u[e.color]},"&:active":(s=t.variants[`${e.variant}Active`])==null?void 0:s[e.color],[`&.${EL.disabled}`]:(m=t.variants[`${e.variant}Disabled`])==null?void 0:m[e.color]})]}),bB=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyLink"}),{color:a="primary",textColor:l,variant:u}=r,s=lr(r,eJ),m=q.useContext(Y_),_=q.useContext(lB),b=mS(ye({},s,{color:l})),{children:M,disabled:C=!1,onBlur:A,onFocus:k,level:z="body-md",overlay:P=!1,underline:O="hover",endDecorator:j,startDecorator:U,component:X,slots:K={},slotProps:se={}}=b,J=lr(b,tJ),ue=m||_?e.level||"inherit":z,{isFocusVisibleRef:ne,onBlur:H,onFocus:de,ref:Ee}=yS(),[Pe,Ze]=q.useState(!1),ke=pi(n,Ee),Te=ot=>{H(ot),ne.current===!1&&Ze(!1),A&&A(ot)},Ie=ot=>{de(ot),ne.current===!0&&Ze(!0),k&&k(ot)},Ce=ye({},b,{color:a,disabled:C,focusVisible:Pe,underline:O,variant:u,level:ue,overlay:P,nesting:m}),Ue=nJ(Ce),nt=ye({},J,{component:X,slots:K,slotProps:se}),[Le,lt]=$n("root",{additionalProps:{onBlur:Te,onFocus:Ie},ref:ke,className:Ue.root,elementType:oJ,externalForwardedProps:nt,ownerState:Ce}),[Ht,He]=$n("startDecorator",{className:Ue.startDecorator,elementType:rJ,externalForwardedProps:nt,ownerState:Ce}),[pt,_t]=$n("endDecorator",{className:Ue.endDecorator,elementType:iJ,externalForwardedProps:nt,ownerState:Ce});return ae.jsx(Y_.Provider,{value:!0,children:ae.jsxs(Le,ye({},lt,{children:[U&&ae.jsx(Ht,ye({},He,{children:U})),gS(M,["Skeleton"])?q.cloneElement(M,{variant:M.props.variant||"inline"}):M,j&&ae.jsx(pt,ye({},_t,{children:j}))]}))})});function sJ(t){return Hr("MuiListDivider",t)}Nr("MuiListDivider",["root","insetGutter","insetStartDecorator","insetStartContent","horizontal","vertical"]);const aJ=["component","role","className","children","inset","orientation","slots","slotProps"],lJ=t=>{const{orientation:e,inset:n}=t,r={root:["root",e,n&&n!=="context"&&`inset${Ln(n)}`]};return $r(r,sJ,{})},cJ=vn(gB,{name:"JoyListDivider",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ye({},t.inset==="context"&&{"--Divider-inset":"calc(-1 * var(--List-padding))"},t.row&&ye({marginInline:"var(--ListDivider-gap)"},t.inset==="gutter"&&{marginBlock:"var(--ListItem-paddingY)"},t["data-first-child"]===void 0&&{marginInlineStart:"calc(var(--List-gap) + var(--ListDivider-gap))"}),!t.row&&ye({},t["data-first-child"]===void 0&&{marginBlockStart:"calc(var(--List-gap) + var(--ListDivider-gap))"},{marginBlockEnd:"var(--ListDivider-gap)"},t.inset==="gutter"&&{marginInlineStart:"var(--ListItem-paddingLeft)",marginInlineEnd:"var(--ListItem-paddingRight)"},t.inset==="startDecorator"&&{marginInlineStart:"var(--ListItem-paddingLeft)"},t.inset==="startContent"&&{marginInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItemDecorator-size))"}))),tP=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyListDivider"}),a=q.useContext(Zy),l=q.useContext(cI),{component:u,role:s,className:m,children:_,inset:b="context",orientation:M,slots:C={},slotProps:A={}}=r,k=lr(r,aJ),[z]=l?.split(":")||["",""],P=u||(z&&!z.match(/^(ul|ol|menu)$/)?"div":"li"),O=s||(P==="li"?"separator":void 0),j=M||(a?"vertical":"horizontal"),U=ye({},r,{inset:b,row:a,orientation:j,component:P,role:O}),X=lJ(U),K=ye({},k,{component:P,slots:C,slotProps:A}),[se,J]=$n("root",{ref:n,className:yo(X.root,m),elementType:cJ,externalForwardedProps:K,ownerState:U,additionalProps:ye({as:P,role:O},O==="separator"&&j==="vertical"&&{"aria-orientation":"vertical"})});return ae.jsx(se,ye({},J,{children:_}))});function uJ(t){return Hr("MuiListItemContent",t)}Nr("MuiListItemContent",["root"]);const hJ=["component","className","children","slots","slotProps"],dJ=()=>$r({root:["root"]},uJ,{}),fJ=vn("div",{name:"JoyListItemContent",slot:"Root",overridesResolver:(t,e)=>e.root})({flex:"1 1 auto",minWidth:0}),K_=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyListItemContent"}),{component:a,className:l,children:u,slots:s={},slotProps:m={}}=r,_=lr(r,hJ),b=ye({},r),M=dJ(),C=ye({},_,{component:a,slots:s,slotProps:m}),[A,k]=$n("root",{ref:n,className:yo(M.root,l),elementType:fJ,externalForwardedProps:C,ownerState:b});return ae.jsx(A,ye({},k,{children:u}))});function pJ(t){return Hr("MuiListItemDecorator",t)}Nr("MuiListItemDecorator",["root"]);const mJ=["component","className","children","slots","slotProps"],gJ=()=>$r({root:["root"]},pJ,{}),vJ=vn("span",{name:"JoyListItemDecorator",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ye({boxSizing:"border-box",display:"inline-flex",alignItems:`var(--unstable_ListItemDecorator-alignItems, ${t.parentOrientation==="horizontal"?"center":"initial"})`},t.parentOrientation==="horizontal"?{minInlineSize:"var(--ListItemDecorator-size)",marginInlineEnd:"calc(-1 * var(--ListItem-gap))"}:{minBlockSize:"var(--ListItemDecorator-size)",justifyContent:"center",marginBlockEnd:"calc(-1 * var(--ListItem-gap))"})),yy=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyListItemDecorator"}),{component:a,className:l,children:u,slots:s={},slotProps:m={}}=r,_=lr(r,mJ),b=q.useContext(uI),M=ye({parentOrientation:b},r),C=gJ(),A=ye({},_,{component:a,slots:s,slotProps:m}),[k,z]=$n("root",{ref:n,className:yo(C.root,l),elementType:vJ,externalForwardedProps:A,ownerState:M});return ae.jsx(k,ye({},z,{children:u}))});function yJ(t){return Hr("MuiMenu",t)}Nr("MuiMenu",["root","listbox","expanded","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const _J=["actions","children","color","component","disablePortal","keepMounted","id","invertedColors","onItemsChange","modifiers","variant","size","slots","slotProps"],xJ=t=>{const{open:e,variant:n,color:r,size:a}=t,l={root:["root",e&&"expanded",n&&`variant${Ln(n)}`,r&&`color${Ln(r)}`,a&&`size${Ln(a)}`],listbox:["listbox"]};return $r(l,yJ,{})},CL=vn(Mx,{name:"JoyMenu",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const a=(n=t.variants[e.variant])==null?void 0:n[e.color];return[ye({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":a?.backgroundColor||a?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},IS,{borderRadius:`var(--List-radius, ${t.vars.radius.sm})`,boxShadow:t.shadow.md,overflow:"auto",zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`},!(a!=null&&a.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup},e.variant==="solid"&&e.color&&e.invertedColors&&Cx(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Tx(e.color)(t),(r=t.variants[e.variant])==null?void 0:r[e.color])]}),wB=q.forwardRef(function(e,n){var r;const a=Gr({props:e,name:"JoyMenu"}),{actions:l,children:u,color:s="neutral",component:m,disablePortal:_=!1,keepMounted:b=!1,id:M,invertedColors:C=!1,onItemsChange:A,modifiers:k,variant:z="outlined",size:P="md",slots:O={},slotProps:j={}}=a,U=lr(a,_J),{contextValue:X,getListboxProps:K,dispatch:se,open:J,triggerElement:ue}=nq({onItemsChange:A,id:M,listboxRef:n});q.useImperativeHandle(l,()=>({dispatch:se,resetHighlight:()=>se({type:Ni.resetHighlight,event:null})}),[se]);const ne=ye({},a,{disablePortal:_,invertedColors:C,color:s,variant:z,size:P,open:J,nesting:!1,row:!1}),H=xJ(ne),de=ye({},U,{component:m,slots:O,slotProps:j}),Ee=q.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...k||[]],[k]),Pe=MN({elementType:CL,getSlotProps:K,externalForwardedProps:de,externalSlotProps:{},ownerState:ne,additionalProps:{anchorEl:ue,open:J&&ue!==null,disablePortal:_,keepMounted:b,modifiers:Ee},className:H.root});return ae.jsx(CL,ye({},Pe,!((r=a.slots)!=null&&r.root)&&{as:TS,slots:{root:m||"ul"}},{children:ae.jsx(rq,{value:X,children:ae.jsx(LS,{variant:C?void 0:z,color:s,children:ae.jsx(AS.Provider,{value:"menu",children:ae.jsx(Sx,{nested:!0,children:u})})})})}))});function bJ(t){return Hr("MuiMenuButton",t)}Nr("MuiMenuButton",["root","colorPrimary","colorNeutral","colorDanger","colorInfo","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]);const wJ=["children","color","component","disabled","endDecorator","loading","loadingPosition","loadingIndicator","size","slotProps","slots","startDecorator","variant"],SJ=t=>{const{color:e,disabled:n,fullWidth:r,size:a,variant:l,loading:u}=t,s={root:["root",n&&"disabled",r&&"fullWidth",l&&`variant${Ln(l)}`,e&&`color${Ln(e)}`,a&&`size${Ln(a)}`,u&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]};return $r(s,bJ,{})},MJ=vn("button",{name:"JoyMenuButton",slot:"Root",overridesResolver:(t,e)=>e.root})(cB),EJ=vn("span",{name:"JoyMenuButton",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),CJ=vn("span",{name:"JoyMenuButton",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),TJ=vn("span",{name:"JoyMenuButton",slot:"LoadingCenter",overridesResolver:(t,e)=>e.loadingIndicatorCenter})(({theme:t,ownerState:e})=>{var n,r;return ye({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),PJ=q.forwardRef(function(e,n){var r;const a=Gr({props:e,name:"JoyMenuButton"}),{children:l,color:u="neutral",component:s,disabled:m=!1,endDecorator:_,loading:b=!1,loadingPosition:M="center",loadingIndicator:C,size:A="md",slotProps:k={},slots:z={},startDecorator:P,variant:O="outlined"}=a,j=lr(a,wJ),U=q.useContext(dI),X=e.variant||U.variant||O,K=e.size||U.size||A,se=(r=e.disabled)!=null?r:U.disabled||m||b,{getRootProps:J,open:ue,active:ne}=lq({rootRef:n,disabled:se}),H=C??ae.jsx(fI,{color:u,thickness:{sm:2,md:3,lg:4}[K]||3}),de=ye({},a,{active:ne,color:u,disabled:se,open:ue,size:K,variant:X}),Ee=SJ(de),Pe=ye({},j,{component:s,slots:z,slotProps:k}),[Ze,ke]=$n("root",{elementType:MJ,getSlotProps:J,externalForwardedProps:Pe,ref:n,ownerState:de,className:Ee.root}),[Te,Ie]=$n("startDecorator",{className:Ee.startDecorator,elementType:EJ,externalForwardedProps:Pe,ownerState:de}),[Ce,Ue]=$n("endDecorator",{className:Ee.endDecorator,elementType:CJ,externalForwardedProps:Pe,ownerState:de}),[nt,Le]=$n("loadingIndicatorCenter",{className:Ee.loadingIndicatorCenter,elementType:TJ,externalForwardedProps:Pe,ownerState:de});return ae.jsxs(Ze,ye({},ke,{children:[(P||b&&M==="start")&&ae.jsx(Te,ye({},Ie,{children:b&&M==="start"?H:P})),l,b&&M==="center"&&ae.jsx(nt,ye({},Le,{children:H})),(_||b&&M==="end")&&ae.jsx(Ce,ye({},Ue,{children:b&&M==="end"?H:_}))]}))});function AJ(t){return Hr("MuiMenuItem",t)}Nr("MuiMenuItem",["root","focusVisible","disabled","selected","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const IJ=["children","disabled","component","selected","color","orientation","variant","slots","slotProps","id"],RJ=t=>{const{focusVisible:e,disabled:n,selected:r,color:a,variant:l}=t,u={root:["root",e&&"focusVisible",n&&"disabled",r&&"selected",a&&`color${Ln(a)}`,l&&`variant${Ln(l)}`]};return $r(u,AJ,{})},DJ=vn(Ex,{name:"JoyMenuItem",slot:"Root",overridesResolver:(t,e)=>e.root})({}),LJ=q.memo(q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyMenuItem"}),a=q.useContext(Zy),{children:l,disabled:u=!1,component:s="li",selected:m=!1,color:_="neutral",orientation:b="horizontal",variant:M="plain",slots:C={},slotProps:A={},id:k}=r,z=lr(r,IJ),{variant:P=M,color:O=_}=DS(e.variant,e.color),{getRootProps:j,disabled:U,focusVisible:X}=hq({id:k,disabled:u,rootRef:n}),K=ye({},r,{component:s,color:O,disabled:U,focusVisible:X,orientation:b,selected:m,row:a,variant:P}),se=RJ(K),J=ye({},z,{component:s,slots:C,slotProps:A}),[ue,ne]=$n("root",{ref:n,elementType:DJ,getSlotProps:j,externalForwardedProps:J,className:se.root,ownerState:K});return ae.jsx(uI.Provider,{value:b,children:ae.jsx(ue,ye({},ne,{children:l}))})})),bg=q.forwardRef(function(e,n){const{contextValue:r,id:a}=dq(e.id);return ae.jsx(om.Provider,{value:r,children:ae.jsx(LJ,ye({},e,{id:a,ref:n}))})});function kJ(t){return Hr("MuiModalClose",t)}Nr("MuiModalClose",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);var TL;const zJ=["component","color","variant","size","onClick","slots","slotProps"],OJ=t=>{const{variant:e,color:n,disabled:r,focusVisible:a,size:l}=t,u={root:["root",r&&"disabled",a&&"focusVisible",e&&`variant${Ln(e)}`,n&&`color${Ln(n)}`,l&&`size${Ln(l)}`]};return $r(u,kJ,{})},FJ=vn(Px,{name:"JoyModalClose",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n;return ye({},t.size==="sm"&&{"--IconButton-size":"1.75rem"},t.size==="md"&&{"--IconButton-size":"2rem"},t.size==="lg"&&{"--IconButton-size":"2.25rem"},{position:"absolute",zIndex:1,top:"var(--ModalClose-inset, 0.625rem)",right:"var(--ModalClose-inset, 0.625rem)",borderRadius:`var(--ModalClose-radius, ${e.vars.radius.sm})`},!((n=e.variants[t.variant])!=null&&(n=n[t.color])!=null&&n.backgroundColor)&&{color:e.vars.palette.text.secondary})}),NJ={plain:"plain",outlined:"plain",soft:"soft",solid:"solid"},SB=q.forwardRef(function(e,n){var r,a,l,u,s,m;const _=Gr({props:e,name:"JoyModalClose"}),{component:b="button",color:M="neutral",variant:C="plain",size:A="md",onClick:k,slots:z={},slotProps:P={}}=_,O=lr(_,zJ),j=q.useContext(vB),U=q.useContext(OS),X=(r=(a=e.variant)!=null?a:NJ[U?.variant])!=null?r:C,K=(l=(u=e.color)!=null?u:U?.color)!=null?l:M,se=q.useContext(pI),J=(s=(m=e.size)!=null?m:se)!=null?s:A,{focusVisible:ue,getRootProps:ne}=hd(ye({},_,{rootRef:n})),H=ye({},_,{color:K,component:b,variant:X,size:J,focusVisible:ue}),de=OJ(H),[Ee,Pe]=$n("root",{ref:n,elementType:FJ,getSlotProps:ne,externalForwardedProps:ye({onClick:Ze=>{j?.(Ze,"closeClick"),k?.(Ze)}},O,{component:b,slots:z,slotProps:P}),className:de.root,ownerState:H});return ae.jsx(Ee,ye({},Pe,{children:TL||(TL=ae.jsx(ZN,{}))}))});function BJ(t){return Hr("MuiOption",t)}const UJ=Nr("MuiOption",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","highlighted","variantPlain","variantSoft","variantOutlined","variantSolid"]),$J=["component","children","disabled","value","label","variant","color","slots","slotProps"],VJ=t=>{const{disabled:e,highlighted:n,selected:r}=t;return $r({root:["root",e&&"disabled",n&&"highlighted",r&&"selected"]},BJ,{})},jJ=vn(Ex,{name:"JoyOption",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[`${e.variant}Hover`])==null?void 0:n[e.color];return{[`&.${UJ.highlighted}:not([aria-selected="true"])`]:{backgroundColor:r?.backgroundColor}}}),HJ=q.memo(q.forwardRef(function(e,n){var r;const a=Gr({props:e,name:"JoyOption"}),{component:l="li",children:u,disabled:s=!1,value:m,label:_,variant:b="plain",color:M="neutral",slots:C={},slotProps:A={}}=a,k=lr(a,$J),z=q.useContext(Zy),{variant:P=b,color:O=M}=DS(e.variant,e.color),j=q.useRef(null),U=pi(j,n),X=_??(typeof u=="string"?u:(r=j.current)==null?void 0:r.innerText),{getRootProps:K,selected:se,highlighted:J,index:ue}=wq({disabled:s,label:X,value:m,rootRef:U}),ne=ye({},a,{disabled:s,selected:se,highlighted:J,index:ue,component:l,variant:P,color:O,row:z}),H=VJ(ne),de=ye({},k,{component:l,slots:C,slotProps:A}),[Ee,Pe]=$n("root",{ref:n,getSlotProps:K,elementType:jJ,externalForwardedProps:de,className:H.root,ownerState:ne});return ae.jsx(Ee,ye({},Pe,{children:u}))})),Xb=q.forwardRef(function(e,n){const{contextValue:r}=Sq(e.value);return ae.jsx(om.Provider,{value:r,children:ae.jsx(HJ,ye({},e,{ref:n}))})}),GJ=Ng(ae.jsx("path",{d:"m12 5.83 2.46 2.46c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 3.7a.9959.9959 0 0 0-1.41 0L8.12 6.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 5.83zm0 12.34-2.46-2.46a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l3.17 3.18c.39.39 1.02.39 1.41 0l3.17-3.17c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L12 18.17z"}),"Unfold");function WJ(t){return Hr("MuiSelect",t)}const _y=Nr("MuiSelect",["root","button","indicator","startDecorator","endDecorator","popper","listbox","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","focusVisible","disabled","expanded","multiple"]);var PL;const qJ=["action","autoFocus","children","defaultValue","defaultListboxOpen","disabled","getSerializedValue","placeholder","listboxId","listboxOpen","onChange","onListboxOpenChange","onClose","renderValue","required","value","size","variant","color","startDecorator","endDecorator","indicator","aria-describedby","aria-label","aria-labelledby","id","name","multiple","slots","slotProps"];function XJ(t){var e;return Array.isArray(t)?ae.jsx(q.Fragment,{children:t.map(n=>n.label).join(", ")}):(e=t?.label)!=null?e:""}const ZJ=[{name:"offset",options:{offset:[0,4]}},{name:"equalWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`}}],YJ=t=>{const{color:e,disabled:n,focusVisible:r,size:a,variant:l,open:u,multiple:s}=t,m={root:["root",n&&"disabled",r&&"focusVisible",u&&"expanded",l&&`variant${Ln(l)}`,e&&`color${Ln(e)}`,a&&`size${Ln(a)}`,s&&"multiple"],button:["button"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],indicator:["indicator",u&&"expanded"],listbox:["listbox",u&&"expanded",n&&"disabled"]};return $r(m,WJ,{})},KJ=vn("div",{name:"JoySelect",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,a,l,u;const s=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color],{borderRadius:m}=Fg({theme:t,ownerState:e},["borderRadius"]);return[ye({"--Select-radius":t.vars.radius.sm,"--Select-gap":"0.5rem","--Select-placeholderOpacity":.64,"--Select-decoratorColor":t.vars.palette.text.icon,"--Select-focusedThickness":t.vars.focus.thickness,"--Select-focusedHighlight":(r=t.vars.palette[e.color==="neutral"?"primary":e.color])==null?void 0:r[500],'&:not([data-inverted-colors="false"])':ye({},e.instanceColor&&{"--_Select-focusedHighlight":(a=t.vars.palette[e.instanceColor==="neutral"?"primary":e.instanceColor])==null?void 0:a[500]},{"--Select-focusedHighlight":t.vars.palette.focusVisible}),"--Select-indicatorColor":s!=null&&s.backgroundColor?s?.color:t.vars.palette.text.tertiary},e.size==="sm"&&{"--Select-minHeight":"2rem","--Select-paddingInline":"0.5rem","--Select-decoratorChildHeight":"min(1.5rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl},e.size==="md"&&{"--Select-minHeight":"2.25rem","--Select-paddingInline":"0.75rem","--Select-decoratorChildHeight":"min(1.75rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},e.size==="lg"&&{"--Select-minHeight":"2.75rem","--Select-paddingInline":"1rem","--Select-decoratorChildHeight":"min(2.375rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},{"--Select-decoratorChildOffset":"min(calc(var(--Select-paddingInline) - (var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2), var(--Select-paddingInline))","--_Select-paddingBlock":"max((var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2, 0px)","--Select-decoratorChildRadius":"max(var(--Select-radius) - var(--variant-borderWidth, 0px) - var(--_Select-paddingBlock), min(var(--_Select-paddingBlock) + var(--variant-borderWidth, 0px), var(--Select-radius) / 2))","--Button-minHeight":"var(--Select-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Select-decoratorChildHeight)","--Button-radius":"var(--Select-decoratorChildRadius)","--IconButton-radius":"var(--Select-decoratorChildRadius)",boxSizing:"border-box"},e.variant!=="plain"&&{boxShadow:t.shadow.xs},{minWidth:0,minHeight:"var(--Select-minHeight)",position:"relative",display:"flex",alignItems:"center",borderRadius:"var(--Select-radius)",cursor:"pointer"},!(s!=null&&s.backgroundColor)&&{backgroundColor:t.vars.palette.background.surface},e.size&&{paddingBlock:{sm:2,md:3,lg:4}[e.size]},{paddingInline:"var(--Select-paddingInline)"},t.typography[`body-${e.size}`],s,{"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)"},[`&.${_y.focusVisible}`]:{"--Select-indicatorColor":s?.color,"&::before":{boxShadow:"inset 0 0 0 var(--Select-focusedThickness) var(--Select-focusedHighlight)"}},[`&.${_y.disabled}`]:{"--Select-indicatorColor":"inherit"}}),{"&:hover":(l=t.variants[`${e.variant}Hover`])==null?void 0:l[e.color],[`&.${_y.disabled}`]:(u=t.variants[`${e.variant}Disabled`])==null?void 0:u[e.color]},m!==void 0&&{"--Select-radius":m}]}),JJ=vn("button",{name:"JoySelect",slot:"Button",overridesResolver:(t,e)=>e.button})(({ownerState:t})=>ye({border:0,outline:0,background:"none",padding:0,fontSize:"inherit",color:"inherit",alignSelf:"stretch",display:"flex",alignItems:"center",flex:1,fontFamily:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden"},(t.value===null||t.value===void 0)&&{opacity:"var(--Select-placeholderOpacity)"},{"&::before":{content:'""',display:"block",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",borderRadius:"var(--Select-radius)"}})),QJ=vn(Mx,{name:"JoySelect",slot:"Listbox",overridesResolver:(t,e)=>e.listbox})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return ye({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":r?.backgroundColor||r?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},IS,{minWidth:"max-content",maxHeight:"44vh",overflow:"auto",outline:0,boxShadow:t.shadow.md,borderRadius:`var(--List-radius, ${t.vars.radius.sm})`,zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup})}),eQ=vn("span",{name:"JoySelect",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Button-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Select-paddingInline) / -4)",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineEnd:"var(--Select-gap)"}),tQ=vn("span",{name:"JoySelect",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Button-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Select-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineStart:"var(--Select-gap)"}),nQ=vn("span",{name:"JoySelect",slot:"Indicator"})(({ownerState:t,theme:e})=>ye({},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.lg},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.xl},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl2},{"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,display:"inherit",alignItems:"center",marginInlineStart:"var(--Select-gap)",marginInlineEnd:"calc(var(--Select-paddingInline) / -4)",[`.${_y.endDecorator} + &`]:{marginInlineStart:"calc(var(--Select-gap) / 2)"},[`&.${_y.expanded}, .${_y.disabled} > &`]:{"--Icon-color":"currentColor"}})),MB=q.forwardRef(function(e,n){var r,a,l,u,s,m,_;const b=Gr({props:e,name:"JoySelect"}),M=b,{action:C,autoFocus:A,children:k,defaultValue:z,defaultListboxOpen:P=!1,disabled:O,getSerializedValue:j,placeholder:U,listboxId:X,listboxOpen:K,onChange:se,onListboxOpenChange:J,onClose:ue,renderValue:ne,required:H=!1,value:de,size:Ee="md",variant:Pe="outlined",color:Ze="neutral",startDecorator:ke,endDecorator:Te,indicator:Ie=PL||(PL=ae.jsx(GJ,{})),"aria-describedby":Ce,"aria-label":Ue,"aria-labelledby":nt,id:Le,name:lt,multiple:Ht=!1,slots:He={},slotProps:pt={}}=M,_t=lr(M,qJ),ot=q.useContext(kS),et=(r=(a=e.disabled)!=null?a:ot?.disabled)!=null?r:O,Mt=(l=(u=e.size)!=null?u:ot?.size)!=null?l:Ee,Tt=(s=e.color)!=null?s:ot!=null&&ot.error?"danger":(m=ot?.color)!=null?m:Ze,hn=ne??XJ,[en,an]=q.useState(null),Ke=q.useRef(null),An=q.useRef(null),Gt=pi(n,Ke);q.useImperativeHandle(C,()=>({focusVisible:()=>{var sn;(sn=An.current)==null||sn.focus()}}),[]),q.useEffect(()=>{an(Ke.current)},[]),q.useEffect(()=>{A&&An.current.focus()},[A]);const on=q.useCallback(sn=>{J?.(sn),sn||ue?.()},[ue,J]),{buttonActive:Wt,buttonFocusVisible:Gn,contextValue:dn,disabled:Ve,getButtonProps:Se,getListboxProps:bt,getHiddenInputProps:Nt,getOptionMetadata:jt,open:Ut,value:yn}=VX({buttonRef:An,defaultOpen:P,defaultValue:z,disabled:et,getSerializedValue:j,listboxId:X,multiple:Ht,name:lt,required:H,onChange:se,onOpenChange:on,open:K,value:de}),Zt=ye({},b,{active:Wt,defaultListboxOpen:P,disabled:Ve,focusVisible:Gn,open:Ut,renderValue:hn,value:yn,size:Mt,variant:Pe,color:Tt}),qt=YJ(Zt),Fn=ye({},_t,{slots:He,slotProps:pt}),Be=q.useMemo(()=>{let sn;if(Ht)sn=yn.map(cn=>jt(cn)).filter(cn=>cn!==void 0);else{var Jt;sn=(Jt=jt(yn))!=null?Jt:null}return sn},[jt,yn,Ht]),[ee,oe]=$n("root",{ref:Gt,className:qt.root,elementType:KJ,externalForwardedProps:Fn,ownerState:Zt}),[fe,he]=$n("button",{additionalProps:{"aria-describedby":Ce??ot?.["aria-describedby"],"aria-label":Ue,"aria-labelledby":nt??ot?.labelId,"aria-required":H?"true":void 0,id:Le??ot?.htmlFor,name:lt},className:qt.button,elementType:JJ,externalForwardedProps:Fn,getSlotProps:Se,ownerState:Zt}),[xe,Ye]=$n("listbox",{additionalProps:{anchorEl:en,open:Ut,placement:"bottom",keepMounted:!0},className:qt.listbox,elementType:QJ,externalForwardedProps:Fn,getSlotProps:bt,ownerState:ye({},Zt,{nesting:!1,row:!1,wrap:!1}),getSlotOwnerState:sn=>({size:sn.size||Mt,variant:sn.variant||Pe,color:sn.color||(sn.disablePortal?Tt:Ze),disableColorInversion:!sn.disablePortal})}),[st,_e]=$n("startDecorator",{className:qt.startDecorator,elementType:eQ,externalForwardedProps:Fn,ownerState:Zt}),[Fe,Ge]=$n("endDecorator",{className:qt.endDecorator,elementType:tQ,externalForwardedProps:Fn,ownerState:Zt}),[je,De]=$n("indicator",{className:qt.indicator,elementType:nQ,externalForwardedProps:Fn,ownerState:Zt}),zt=q.useMemo(()=>[...ZJ,...Ye.modifiers||[]],[Ye.modifiers]);let fn=U;return(Array.isArray(Be)&&Be.length>0||!Array.isArray(Be)&&Be)&&(fn=hn(Be)),ae.jsxs(q.Fragment,{children:[ae.jsxs(ee,ye({},oe,{children:[ke&&ae.jsx(st,ye({},_e,{children:ke})),ae.jsx(fe,ye({},he,{children:fn})),Te&&ae.jsx(Fe,ye({},Ge,{children:Te})),Ie&&ae.jsx(je,ye({},De,{children:Ie})),ae.jsx("input",ye({},Nt()))]})),en&&ae.jsx(xe,ye({},Ye,{className:yo(Ye.className),modifiers:zt},!((_=b.slots)!=null&&_.listbox)&&{as:TS,slots:{root:Ye.as||"ul"}},{children:ae.jsx(jX,{value:dn,children:ae.jsx(LS,{variant:Pe,color:Ze,children:ae.jsx(AS.Provider,{value:"select",children:ae.jsx(Sx,{nested:!0,children:k})})})})}))]})});function rQ(t){return Hr("MuiSheet",t)}Nr("MuiSheet",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const iQ=["className","color","component","variant","invertedColors","slots","slotProps"],oQ=t=>{const{variant:e,color:n}=t,r={root:["root",e&&`variant${Ln(e)}`,n&&`color${Ln(n)}`]};return $r(r,rQ,{})},sQ=vn("div",{name:"JoySheet",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const a=(n=t.variants[e.variant])==null?void 0:n[e.color],{borderRadius:l,bgcolor:u,backgroundColor:s,background:m}=Fg({theme:t,ownerState:e},["borderRadius","bgcolor","backgroundColor","background"]),_=Yp(t,`palette.${u}`)||u||Yp(t,`palette.${s}`)||s||m||a?.backgroundColor||a?.background||t.vars.palette.background.surface;return[ye({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--ListItem-stickyBackground":_==="transparent"?"initial":_,"--Sheet-background":_==="transparent"?"initial":_},l!==void 0&&{"--List-radius":`calc(${l} - var(--variant-borderWidth, 0px))`,"--unstable_actionRadius":`calc(${l} - var(--variant-borderWidth, 0px))`},{backgroundColor:t.vars.palette.background.surface,position:"relative"}),ye({},t.typography["body-md"],e.variant==="solid"&&e.color&&e.invertedColors&&Cx(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Tx(e.color)(t),(r=t.variants[e.variant])==null?void 0:r[e.color],a)]}),EB=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoySheet"}),{className:a,color:l="neutral",component:u="div",variant:s="plain",invertedColors:m=!1,slots:_={},slotProps:b={}}=r,M=lr(r,iQ),C=ye({},r,{color:l,component:u,invertedColors:m,variant:s}),A=oQ(C),k=ye({},M,{component:u,slots:_,slotProps:b}),[z,P]=$n("root",{ref:n,className:yo(A.root,a),elementType:sQ,externalForwardedProps:k,ownerState:C});return ae.jsx(z,ye({},P))});function aQ(t){return Hr("MuiSnackbar",t)}Nr("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","endDecorator","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantOutlined","variantSoft","variantSolid"]);const lQ=["anchorOrigin","animationDuration","autoHideDuration","color","children","className","component","disableWindowBlurListener","endDecorator","invertedColors","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","onUnmount","open","resumeHideDuration","size","slots","slotProps","startDecorator","variant"];let CB=t=>t,AL,IL;const cQ=t=>{const{variant:e,color:n,size:r,anchorOrigin:a}=t,l={root:["root",r&&`size${Ln(r)}`,n&&`color${Ln(n)}`,e&&`variant${Ln(e)}`,`anchorOrigin${Ln(a.vertical)}${Ln(a.horizontal)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return $r(l,aQ,{})},uQ=BA(AL||(AL=CB`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
  }
`)),hQ=BA(IL||(IL=CB`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
`)),dQ=vn("div",{name:"JoySnackbar",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,a,l,u,s,m;const{p:_,padding:b,borderRadius:M}=Fg({theme:t,ownerState:e},["p","padding","borderRadius"]);return[ye({"--Snackbar-radius":t.vars.radius.sm,"--Snackbar-decoratorChildRadius":"max((var(--Snackbar-radius) - var(--variant-borderWidth, 0px)) - var(--Snackbar-padding), min(var(--Snackbar-padding) + var(--variant-borderWidth, 0px), var(--Snackbar-radius) / 2))","--Button-minHeight":"var(--Snackbar-decoratorChildHeight)","--IconButton-size":"var(--Snackbar-decoratorChildHeight)","--Button-radius":"var(--Snackbar-decoratorChildRadius)","--IconButton-radius":"var(--Snackbar-decoratorChildRadius)","--Icon-color":"currentColor"},e.size==="sm"&&{"--Snackbar-padding":"0.75rem","--Snackbar-inset":"0.5rem","--Snackbar-decoratorChildHeight":"1.5rem","--Icon-fontSize":t.vars.fontSize.xl,gap:"0.5rem"},e.size==="md"&&{"--Snackbar-padding":"1rem","--Snackbar-inset":"0.75rem","--Snackbar-decoratorChildHeight":"2rem","--Icon-fontSize":t.vars.fontSize.xl,gap:"0.625rem"},e.size==="lg"&&{"--Snackbar-padding":"1.25rem","--Snackbar-inset":"1rem","--Snackbar-decoratorChildHeight":"2.375rem","--Icon-fontSize":t.vars.fontSize.xl2,gap:"0.875rem"},{zIndex:t.vars.zIndex.snackbar,position:"fixed",display:"flex",alignItems:"center",minWidth:300,top:((n=e.anchorOrigin)==null?void 0:n.vertical)==="top"?"var(--Snackbar-inset)":void 0,left:((r=e.anchorOrigin)==null?void 0:r.horizontal)==="left"?"var(--Snackbar-inset)":void 0,bottom:((a=e.anchorOrigin)==null?void 0:a.vertical)==="bottom"?"var(--Snackbar-inset)":void 0,right:((l=e.anchorOrigin)==null?void 0:l.horizontal)==="right"?"var(--Snackbar-inset)":void 0},((u=e.anchorOrigin)==null?void 0:u.horizontal)==="center"&&{"--Snackbar-translateX":"-50%",left:"50%",transform:"translateX(var(--Snackbar-translateX))"},((s=e.anchorOrigin)==null?void 0:s.vertical)==="top"&&{"--_Snackbar-anchorBottom":"-1"},{animation:`${uQ} ${e.animationDuration}ms forwards`},!e.open&&{animationName:hQ},{boxShadow:t.vars.shadow.lg,backgroundColor:t.vars.palette.background.surface,padding:"var(--Snackbar-padding)",borderRadius:"var(--Snackbar-radius)"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],e.variant==="solid"&&e.color&&e.invertedColors&&Cx(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Tx(e.color)(t),(m=t.variants[e.variant])==null?void 0:m[e.color]),_!==void 0&&{"--Snackbar-padding":_},b!==void 0&&{"--Snackbar-padding":b},M!==void 0&&{"--Snackbar-radius":M}]}),fQ=vn("span",{name:"JoySnackbar",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({display:"inherit",flex:"none"}),pQ=vn("span",{name:"JoySnackbar",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({display:"inherit",flex:"none",marginLeft:"auto"}),mQ={vertical:"bottom",horizontal:"right"},mI=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoySnackbar"}),{anchorOrigin:a=mQ,animationDuration:l=300,autoHideDuration:u=null,color:s="neutral",children:m,className:_,component:b,disableWindowBlurListener:M=!1,endDecorator:C,invertedColors:A=!1,onUnmount:k,open:z,size:P="md",slots:O={},slotProps:j,startDecorator:U,variant:X="outlined"}=r,K=lr(r,lQ),[se,J]=q.useState(!0),[ue,ne]=q.useState(!1),H=q.useRef(k);H.current=k,q.useEffect(()=>{if(z)ne(!1),J(!1);else{ne(!0);const He=setTimeout(()=>{var pt;J(!0),ne(!1),(pt=H.current)==null||pt.call(H)},l);return()=>{clearTimeout(He)}}},[z,l]);const de=ye({},r,{anchorOrigin:a,autoHideDuration:u,color:s,animationDuration:l,disableWindowBlurListener:M,invertedColors:A,size:P,variant:X});delete de.onUnmount;const Ee=cQ(de),{getRootProps:Pe,onClickAway:Ze}=HX(de),ke=He=>{ue||Ze(He)},Te=ye({},K,{component:b,slots:O,slotProps:j}),[Ie,Ce]=$n("root",{ref:n,className:yo(Ee.root,_),elementType:dQ,externalForwardedProps:Te,getSlotProps:Pe,ownerState:de}),[Ue,nt]=$n("startDecorator",{className:Ee.startDecorator,elementType:fQ,externalForwardedProps:Te,ownerState:de}),[Le,lt]=$n("endDecorator",{className:Ee.endDecorator,elementType:pQ,externalForwardedProps:Te,ownerState:de}),Ht=O.clickAway||xW;return!z&&se?null:ae.jsx(Ht,ye({onClickAway:ke},typeof j?.clickAway=="function"?j.clickAway(de):j?.clickAway,{children:ae.jsxs(Ie,ye({},Ce,{children:[U&&ae.jsx(Ue,ye({},nt,{children:U})),m,C&&ae.jsx(Le,ye({},lt,{children:C}))]}))}))}),Sa=rW({createStyledComponent:vn("div",{name:"JoyStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>Gr({props:t,name:"JoyStack"})});function gQ(t){return Hr("MuiTab",t)}const vQ=Nr("MuiTab",["root","disabled","focusVisible","selected","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),yQ=["action","children","value","disabled","onChange","onClick","onFocus","component","orientation","variant","color","disableIndicator","indicatorPlacement","indicatorInset","slots","slotProps"],_Q=t=>{const{selected:e,disabled:n,focusVisible:r,variant:a,color:l,orientation:u}=t,s={root:["root",u,n&&"disabled",r&&"focusVisible",e&&"selected",a&&`variant${Ln(a)}`,l&&`color${Ln(l)}`]};return $r(s,gQ,{})},xQ=vn(Ex,{name:"JoyTab",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>[{flex:"initial",justifyContent:t.row?"center":"initial","--unstable_ListItemDecorator-alignItems":"center","--unstable_offset":"min(calc(-1 * var(--variant-borderWidth, 0px)), -1px)"},!t.disableIndicator&&{'&[aria-selected="true"]':{"--Tab-indicatorColor":"currentColor",zIndex:1},"&::after":{content:'""',display:"block",position:"absolute",margin:"auto",background:"var(--Tab-indicatorColor)",borderRadius:"var(--Tab-indicatorRadius)"}},!t.disableIndicator&&t.indicatorPlacement==="bottom"&&{paddingBottom:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:t.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:t.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",bottom:"calc(-1px - var(--unstable_TabList-underlineBottom, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="top"&&{paddingTop:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:t.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:t.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",top:"calc(-1px - var(--unstable_TabList-underlineTop, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="right"&&{paddingRight:"calc(var(--ListItem-paddingRight) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",right:"calc(-1px - var(--unstable_TabList-underlineRight, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="left"&&{paddingLeft:"calc(var(--ListItem-paddingLeft) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",left:"calc(-1px - var(--unstable_TabList-underlineLeft, 0px))"}}]),bM=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyTab"}),a=q.useContext(Zy),{action:l,children:u,disabled:s=!1,component:m="button",orientation:_="horizontal",variant:b="plain",color:M="neutral",disableIndicator:C=!1,indicatorPlacement:A=a?"bottom":"right",indicatorInset:k=!1,slots:z={},slotProps:P={}}=r,O=lr(r,yQ),j=q.useRef(null),U=pi(j,n),{active:X,focusVisible:K,setFocusVisible:se,selected:J,getRootProps:ue}=eZ(ye({},r,{rootRef:U}));q.useImperativeHandle(l,()=>({focusVisible:()=>{se(!0),j.current.focus()}}),[se]);const ne=ye({},r,{disableIndicator:C,indicatorPlacement:A,indicatorInset:k,orientation:_,row:a,active:X,focusVisible:K,disabled:s,selected:J,variant:b,color:M}),H=_Q(ne),de=ye({},O,{component:m,slots:z,slotProps:P}),[Ee,Pe]=$n("root",{ref:n,elementType:xQ,getSlotProps:ue,externalForwardedProps:de,ownerState:ne,className:H.root});return ae.jsx(uI.Provider,{value:_,children:ae.jsx(Ee,ye({},Pe,{children:u}))})}),gI=q.createContext("md");function bQ(t){return Hr("MuiTabList",t)}Nr("MuiTabList",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const wQ=["component","children","variant","color","size","disableUnderline","underlinePlacement","tabFlex","sticky","slots","slotProps"],SQ=t=>{const{orientation:e,size:n,variant:r,color:a}=t,l={root:["root",e,r&&`variant${Ln(r)}`,a&&`color${Ln(a)}`,n&&`size${Ln(n)}`]};return $r(l,bQ,{})},MQ=vn(Mx,{name:"JoyTabList",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return ye({"--List-gap":"0px","--ListDivider-gap":"0px","--ListItem-paddingX":"var(--Tabs-spacing)","--ListItem-gap":"0.375rem","--unstable_TabList-hasUnderline":e.disableUnderline?"var(--unknown,)":"initial"},IS,{flexGrow:"initial",flexDirection:e.orientation==="vertical"?"column":"row",borderRadius:"var(--List-radius, 0px)",padding:"var(--List-padding, 0px)",zIndex:1},e.sticky&&{position:"sticky",top:e.sticky==="top"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",bottom:e.sticky==="bottom"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",backgroundColor:r?.backgroundColor||`var(--TabList-stickyBackground, ${t.vars.palette.background.body})`},!e.disableUnderline&&ye({},e.underlinePlacement==="bottom"&&{"--unstable_TabList-underlineBottom":"1px",paddingBottom:1,boxShadow:`inset 0 -1px ${t.vars.palette.divider}`},e.underlinePlacement==="top"&&{"--unstable_TabList-underlineTop":"1px",paddingTop:1,boxShadow:`inset 0 1px ${t.vars.palette.divider}`},e.underlinePlacement==="right"&&{"--unstable_TabList-underlineRight":"1px",paddingRight:1,boxShadow:`inset -1px 0 ${t.vars.palette.divider}`},e.underlinePlacement==="left"&&{"--unstable_TabList-underlineLeft":"1px",paddingLeft:1,boxShadow:`inset 1px 0 ${t.vars.palette.divider}`}),e.tabFlex&&{[`& .${vQ.root}`]:{flex:e.tabFlex}})}),EQ=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyTabList"}),a=q.useContext(gI),{isRtl:l,orientation:u,getRootProps:s,contextValue:m}=KX({rootRef:n}),{component:_="div",children:b,variant:M="plain",color:C="neutral",size:A,disableUnderline:k=!1,underlinePlacement:z=u==="horizontal"?"bottom":"right",tabFlex:P,sticky:O,slots:j={},slotProps:U={}}=r,X=lr(r,wQ),se=ye({},r,{isRtl:l,orientation:u,variant:M,color:C,size:A??a,sticky:O,tabFlex:P,nesting:!1,disableUnderline:k,underlinePlacement:z}),J=SQ(se),ue=ye({},X,{component:_,slots:j,slotProps:U}),[ne,H]=$n("root",{ref:n,elementType:MQ,getSlotProps:s,externalForwardedProps:ue,ownerState:se,className:J.root});return ae.jsx(ne,ye({},H,{children:ae.jsx(JX,{value:m,children:ae.jsx(Sx,{row:u==="horizontal",nested:!0,children:b})})}))});function CQ(t){return Hr("MuiTabPanel",t)}Nr("MuiTabPanel",["root","hidden","sizeSm","sizeMd","sizeLg","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const TQ=["children","value","component","color","variant","size","slots","slotProps","keepMounted"],PQ=t=>{const{hidden:e,size:n,variant:r,color:a,orientation:l}=t,u={root:["root",e&&"hidden",n&&`size${Ln(n)}`,l,r&&`variant${Ln(r)}`,a&&`color${Ln(a)}`,n&&`size${Ln(n)}`]};return $r(u,CQ,{})},AQ=vn("div",{name:"JoyTabPanel",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return ye({display:e.hidden?"none":"block",padding:"var(--Tabs-spacing)",flexGrow:1,fontFamily:t.vars.fontFamily.body},t.typography[`body-${e.size}`],(n=t.variants[e.variant])==null?void 0:n[e.color])}),wM=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyTabPanel"}),{orientation:a}=PS()||{orientation:"horizontal"},l=q.useContext(gI),{children:u,value:s=0,component:m,color:_="neutral",variant:b="plain",size:M,slots:C={},slotProps:A={},keepMounted:k=!1}=r,z=lr(r,TQ),{hidden:P,getRootProps:O}=ZX(ye({},r,{value:s})),U=ye({},r,{orientation:a,hidden:P,size:M??l,color:_,variant:b}),X=PQ(U),K=ye({},z,{component:m,slots:C,slotProps:A}),[se,J]=$n("root",{ref:n,elementType:AQ,getSlotProps:O,externalForwardedProps:K,additionalProps:{role:"tabpanel",ref:n,as:m},ownerState:U,className:X.root});return k?ae.jsx(se,ye({},J,{children:u})):ae.jsx(se,ye({},J,{children:!P&&u}))});function IQ(t){return Hr("MuiTabs",t)}Nr("MuiTabs",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const RQ=["children","value","defaultValue","orientation","direction","component","onChange","selectionFollowsFocus","variant","color","size","slots","slotProps"],DQ=t=>{const{orientation:e,variant:n,color:r,size:a}=t,l={root:["root",e,n&&`variant${Ln(n)}`,r&&`color${Ln(r)}`,a&&`size${Ln(a)}`]};return $r(l,IQ,{})},LQ=vn("div",{name:"JoyTabs",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r;const a=(n=e.variants[t.variant])==null?void 0:n[t.color],{bgcolor:l,backgroundColor:u,background:s,p:m,padding:_}=Fg({theme:e,ownerState:t},["bgcolor","backgroundColor","background","p","padding"]),b=Yp(e,`palette.${l}`)||l||Yp(e,`palette.${u}`)||u||s||a?.backgroundColor||a?.background||e.vars.palette.background.surface;return ye({},t.size==="sm"&&{"--Tabs-spacing":"0.75rem"},t.size==="md"&&{"--Tabs-spacing":"1rem"},t.size==="lg"&&{"--Tabs-spacing":"1.25rem"},{"--Tab-indicatorThickness":"2px","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--TabList-stickyBackground":b==="transparent"?"initial":b,display:"flex",flexDirection:"column"},t.orientation==="vertical"&&{flexDirection:"row"},{backgroundColor:e.vars.palette.background.surface,position:"relative"},e.typography[`body-${t.size}`],(r=e.variants[t.variant])==null?void 0:r[t.color],m!==void 0&&{"--Tabs-padding":m},_!==void 0&&{"--Tabs-padding":_})}),RL=q.forwardRef(function(e,n){const r=Gr({props:e,name:"JoyTabs"}),{children:a,value:l,defaultValue:u,orientation:s="horizontal",direction:m="ltr",component:_,variant:b="plain",color:M="neutral",size:C="md",slots:A={},slotProps:k={}}=r,z=lr(r,RQ),P=u||(l===void 0?0:void 0),{contextValue:O}=WX(ye({},r,{orientation:s,defaultValue:P})),j=ye({},r,{orientation:s,direction:m,variant:b,color:M,size:C}),U=DQ(j),X=ye({},z,{component:_,slots:A,slotProps:k}),[K,se]=$n("root",{ref:n,elementType:LQ,externalForwardedProps:X,additionalProps:{ref:n,as:_},ownerState:j,className:U.root});return ae.jsx(K,ye({},se,{children:ae.jsx(qX,{value:O,children:ae.jsx(gI.Provider,{value:C,children:a})})}))});function kQ(t){return Hr("MuiTooltip",t)}Nr("MuiTooltip",["root","tooltipArrow","arrow","touch","placementLeft","placementRight","placementTop","placementBottom","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);const zQ=["children","className","component","arrow","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","disablePortal","direction","keepMounted","modifiers","placement","title","color","variant","size","slots","slotProps"],OQ=t=>{const{arrow:e,variant:n,color:r,size:a,placement:l,touch:u}=t,s={root:["root",e&&"tooltipArrow",u&&"touch",a&&`size${Ln(a)}`,r&&`color${Ln(r)}`,n&&`variant${Ln(n)}`,`tooltipPlacement${Ln(l.split("-")[0])}`],arrow:["arrow"]};return $r(s,kQ,{})},FQ=vn("div",{name:"JoyTooltip",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,a;const l=(n=e.variants[t.variant])==null?void 0:n[t.color];return ye({},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.md,"--Tooltip-arrowSize":"8px",padding:e.spacing(.25,.625)},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.lg,"--Tooltip-arrowSize":"10px",padding:e.spacing(.5,.75)},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl,"--Tooltip-arrowSize":"12px",padding:e.spacing(.75,1)},{zIndex:e.vars.zIndex.tooltip,borderRadius:e.vars.radius.sm,boxShadow:e.shadow.sm,wordWrap:"break-word",position:"relative"},t.disableInteractive&&{pointerEvents:"none"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],l,!l.backgroundColor&&{backgroundColor:e.vars.palette.background.surface},{"&::before":{content:'""',display:"block",position:"absolute",width:(r=t.placement)!=null&&r.match(/(top|bottom)/)?"100%":"calc(10px + var(--variant-borderWidth, 0px))",height:(a=t.placement)!=null&&a.match(/(top|bottom)/)?"calc(10px + var(--variant-borderWidth, 0px))":"100%"},'&[data-popper-placement*="bottom"]::before':{top:0,left:0,transform:"translateY(-100%)"},'&[data-popper-placement*="left"]::before':{top:0,right:0,transform:"translateX(100%)"},'&[data-popper-placement*="right"]::before':{top:0,left:0,transform:"translateX(-100%)"},'&[data-popper-placement*="top"]::before':{bottom:0,left:0,transform:"translateY(100%)"}})}),NQ=vn("span",{name:"JoyTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(({theme:t,ownerState:e})=>{var n,r,a;const l=(n=t.variants[e.variant])==null?void 0:n[e.color];return{"--unstable_Tooltip-arrowRotation":0,width:"var(--Tooltip-arrowSize)",height:"var(--Tooltip-arrowSize)",boxSizing:"border-box","&::before":{content:'""',display:"block",position:"absolute",width:0,height:0,border:"calc(var(--Tooltip-arrowSize) / 2) solid",borderLeftColor:"transparent",borderBottomColor:"transparent",borderTopColor:(r=l?.backgroundColor)!=null?r:t.vars.palette.background.surface,borderRightColor:(a=l?.backgroundColor)!=null?a:t.vars.palette.background.surface,borderRadius:"0px 2px 0px 0px",boxShadow:`var(--variant-borderWidth, 0px) calc(-1 * var(--variant-borderWidth, 0px)) 0px 0px ${l.borderColor}`,transformOrigin:"center center",transform:"rotate(calc(-45deg + 90deg * var(--unstable_Tooltip-arrowRotation)))"},'[data-popper-placement*="bottom"] &':{top:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="top"] &':{"--unstable_Tooltip-arrowRotation":2,bottom:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="left"] &':{"--unstable_Tooltip-arrowRotation":1,right:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="right"] &':{"--unstable_Tooltip-arrowRotation":3,left:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"}}});let K1=!1;const DL=new _x;let U0={x:0,y:0};function LL(t,e){return n=>{e&&e(n),t(n)}}function kL(t,e){return(n,...r)=>{e&&e(n,...r),t(n,...r)}}const TB=q.forwardRef(function(e,n){var r;const a=Gr({props:e,name:"JoyTooltip"}),{children:l,className:u,component:s,arrow:m=!1,describeChild:_=!1,disableFocusListener:b=!1,disableHoverListener:M=!1,disableInteractive:C=!1,disableTouchListener:A=!1,enterDelay:k=100,enterNextDelay:z=0,enterTouchDelay:P=700,followCursor:O=!1,id:j,leaveDelay:U=0,leaveTouchDelay:X=1500,onClose:K,onOpen:se,open:J,disablePortal:ue,direction:ne,keepMounted:H,modifiers:de,placement:Ee="bottom",title:Pe,color:Ze="neutral",variant:ke="solid",size:Te="md",slots:Ie={},slotProps:Ce={}}=a,Ue=lr(a,zQ),[nt,Le]=q.useState(),[lt,Ht]=q.useState(null),He=q.useRef(!1),pt=C||O,_t=n_(),ot=n_(),et=n_(),Mt=n_(),[Tt,hn]=vy({controlled:J,default:!1,name:"Tooltip",state:"open"});let en=Tt;const an=Pl(j),Ke=q.useRef(void 0),An=nh(()=>{Ke.current!==void 0&&(document.body.style.WebkitUserSelect=Ke.current,Ke.current=void 0),Mt.clear()});q.useEffect(()=>An,[An]);const Gt=Jt=>{DL.clear(),K1=!0,hn(!0),se&&!en&&se(Jt)},on=nh(Jt=>{DL.start(800+U,()=>{K1=!1}),hn(!1),K&&en&&K(Jt),_t.start(150,()=>{He.current=!1})}),Wt=Jt=>{He.current&&Jt.type!=="touchstart"||(nt&&nt.removeAttribute("title"),ot.clear(),et.clear(),k||K1&&z?ot.start(K1?z:k,()=>{Gt(Jt)}):Gt(Jt))},Gn=Jt=>{ot.clear(),et.start(U,()=>{on(Jt)})},{isFocusVisibleRef:dn,onBlur:Ve,onFocus:Se,ref:bt}=yS(),[,Nt]=q.useState(!1),jt=Jt=>{Ve(Jt),dn.current===!1&&(Nt(!1),Gn(Jt))},Ut=Jt=>{nt||Le(Jt.currentTarget),Se(Jt),dn.current===!0&&(Nt(!0),Wt(Jt))},yn=Jt=>{He.current=!0;const cn=l.props;cn.onTouchStart&&cn.onTouchStart(Jt)},Zt=Jt=>{yn(Jt),et.clear(),_t.clear(),An(),Ke.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Mt.start(P,()=>{document.body.style.WebkitUserSelect=Ke.current,Wt(Jt)})},qt=Jt=>{l.props.onTouchEnd&&l.props.onTouchEnd(Jt),An(),et.start(X,()=>{on(Jt)})};q.useEffect(()=>{if(!en)return;function Jt(cn){(cn.key==="Escape"||cn.key==="Esc")&&on(cn)}return document.addEventListener("keydown",Jt),()=>{document.removeEventListener("keydown",Jt)}},[on,en]);const Fn=pi(Le,n),Be=pi(bt,Fn),ee=pi(_S(l),Be);typeof Pe!="number"&&!Pe&&(en=!1);const oe=q.useRef(null),fe=Jt=>{const cn=l.props;cn.onMouseMove&&cn.onMouseMove(Jt),U0={x:Jt.clientX,y:Jt.clientY},oe.current&&oe.current.update()},he={},xe=typeof Pe=="string";_?(he.title=!en&&xe&&!M?Pe:null,he["aria-describedby"]=en?an:null):(he["aria-label"]=xe?Pe:null,he["aria-labelledby"]=en&&!xe?an:null);const Ye=ye({},he,Ue,{component:s},l.props,{className:yo(u,l.props.className),onTouchStart:yn,ref:ee},O?{onMouseMove:fe}:{}),st={};A||(Ye.onTouchStart=Zt,Ye.onTouchEnd=qt),M||(Ye.onMouseOver=LL(Wt,Ye.onMouseOver),Ye.onMouseLeave=LL(Gn,Ye.onMouseLeave),pt||(st.onMouseOver=Wt,st.onMouseLeave=Gn)),b||(Ye.onFocus=kL(Ut,Ye.onFocus),Ye.onBlur=kL(jt,Ye.onBlur),pt||(st.onFocus=Ut,st.onBlur=jt));const _e=ye({},a,{arrow:m,disableInteractive:pt,placement:Ee,touch:He.current,color:Ze,variant:ke,size:Te}),Fe=OQ(_e),Ge=ye({},Ue,{component:s,slots:Ie,slotProps:Ce}),je=q.useMemo(()=>[{name:"arrow",enabled:!!lt,options:{element:lt,padding:6}},{name:"offset",options:{offset:[0,10]}},...de||[]],[lt,de]),[De,zt]=$n("root",{additionalProps:ye({id:an,popperRef:oe,placement:Ee,anchorEl:O?{getBoundingClientRect:()=>({top:U0.y,left:U0.x,right:U0.x,bottom:U0.y,width:0,height:0})}:nt,open:nt?en:!1,disablePortal:ue,keepMounted:H,direction:ne,modifiers:je},st),ref:null,className:Fe.root,elementType:FQ,externalForwardedProps:Ge,ownerState:_e}),[fn,sn]=$n("arrow",{ref:Ht,className:Fe.arrow,elementType:NQ,externalForwardedProps:Ge,ownerState:_e});return ae.jsxs(q.Fragment,{children:[q.isValidElement(l)&&q.cloneElement(l,Ye),ae.jsxs(De,ye({},zt,!((r=a.slots)!=null&&r.root)&&{as:TS,slots:{root:s||"div"}},{children:[Pe,m?ae.jsx(fn,ye({},sn)):null]}))]})});var J1={},zL;function BQ(){if(zL)return J1;zL=1;var t=RN();return J1.createRoot=t.createRoot,J1.hydrateRoot=t.hydrateRoot,J1}var UQ=BQ();var PB=t=>{throw TypeError(t)},$Q=(t,e,n)=>e.has(t)||PB("Cannot "+n),SM=(t,e,n)=>($Q(t,e,"read from private field"),n?n.call(t):e.get(t)),VQ=(t,e,n)=>e.has(t)?PB("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),OL="popstate";function jQ(t={}){function e(r,a){let{pathname:l,search:u,hash:s}=r.location;return J_("",{pathname:l,search:u,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:ad(a)}return GQ(e,n,null,t)}function Or(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Vo(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function HQ(){return Math.random().toString(36).substring(2,10)}function FL(t,e){return{usr:t.state,key:t.key,idx:e}}function J_(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?lm(e):e,state:n,key:e&&e.key||r||HQ()}}function ad({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function lm(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function GQ(t,e,n,r={}){let{window:a=document.defaultView,v5Compat:l=!1}=r,u=a.history,s="POP",m=null,_=b();_==null&&(_=0,u.replaceState({...u.state,idx:_},""));function b(){return(u.state||{idx:null}).idx}function M(){s="POP";let P=b(),O=P==null?null:P-_;_=P,m&&m({action:s,location:z.location,delta:O})}function C(P,O){s="PUSH";let j=J_(z.location,P,O);_=b()+1;let U=FL(j,_),X=z.createHref(j);try{u.pushState(U,"",X)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;a.location.assign(X)}l&&m&&m({action:s,location:z.location,delta:1})}function A(P,O){s="REPLACE";let j=J_(z.location,P,O);_=b();let U=FL(j,_),X=z.createHref(j);u.replaceState(U,"",X),l&&m&&m({action:s,location:z.location,delta:0})}function k(P){return AB(P)}let z={get action(){return s},get location(){return t(a,u)},listen(P){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(OL,M),m=P,()=>{a.removeEventListener(OL,M),m=null}},createHref(P){return e(a,P)},createURL:k,encodeLocation(P){let O=k(P);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:C,replace:A,go(P){return u.go(P)}};return z}function AB(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Or(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:ad(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var r_,NL=class{constructor(t){if(VQ(this,r_,new Map),t)for(let[e,n]of t)this.set(e,n)}get(t){if(SM(this,r_).has(t))return SM(this,r_).get(t);if(t.defaultValue!==void 0)return t.defaultValue;throw new Error("No value found for context")}set(t,e){SM(this,r_).set(t,e)}};r_=new WeakMap;var WQ=new Set(["lazy","caseSensitive","path","id","index","children"]);function qQ(t){return WQ.has(t)}var XQ=new Set(["lazy","caseSensitive","path","id","index","middleware","children"]);function ZQ(t){return XQ.has(t)}function YQ(t){return t.index===!0}function Q_(t,e,n=[],r={},a=!1){return t.map((l,u)=>{let s=[...n,String(u)],m=typeof l.id=="string"?l.id:s.join("-");if(Or(l.index!==!0||!l.children,"Cannot specify children on an index route"),Or(a||!r[m],`Found a route id collision on id "${m}".  Route id's must be globally unique within Data Router usages`),YQ(l)){let _={...l,id:m};return r[m]=BL(_,e(_)),_}else{let _={...l,id:m,children:void 0};return r[m]=BL(_,e(_)),l.children&&(_.children=Q_(l.children,e,s,r,a)),_}})}function BL(t,e){return Object.assign(t,{...e,...typeof e.lazy=="object"&&e.lazy!=null?{lazy:{...t.lazy,...e.lazy}}:{}})}function Fp(t,e,n="/"){return i_(t,e,n,!1)}function i_(t,e,n,r){let a=typeof e=="string"?lm(e):e,l=ru(a.pathname||"/",n);if(l==null)return null;let u=IB(t);JQ(u);let s=null;for(let m=0;s==null&&m<u.length;++m){let _=cee(l);s=aee(u[m],_,r)}return s}function KQ(t,e){let{route:n,pathname:r,params:a}=t;return{id:n.id,pathname:r,params:a,data:e[n.id],loaderData:e[n.id],handle:n.handle}}function IB(t,e=[],n=[],r="",a=!1){let l=(u,s,m=a,_)=>{let b={relativePath:_===void 0?u.path||"":_,caseSensitive:u.caseSensitive===!0,childrenIndex:s,route:u};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(r)&&m)return;Or(b.relativePath.startsWith(r),`Absolute route path "${b.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(r.length)}let M=nd([r,b.relativePath]),C=n.concat(b);u.children&&u.children.length>0&&(Or(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${M}".`),IB(u.children,e,C,M,m)),!(u.path==null&&!u.index)&&e.push({path:M,score:oee(M,u.index),routesMeta:C})};return t.forEach((u,s)=>{if(u.path===""||!u.path?.includes("?"))l(u,s);else for(let m of RB(u.path))l(u,s,!0,m)}),e}function RB(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let u=RB(r.join("/")),s=[];return s.push(...u.map(m=>m===""?l:[l,m].join("/"))),a&&s.push(...u),s.map(m=>t.startsWith("/")&&m===""?"/":m)}function JQ(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:see(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var QQ=/^:[\w-]+$/,eee=3,tee=2,nee=1,ree=10,iee=-2,UL=t=>t==="*";function oee(t,e){let n=t.split("/"),r=n.length;return n.some(UL)&&(r+=iee),e&&(r+=tee),n.filter(a=>!UL(a)).reduce((a,l)=>a+(QQ.test(l)?eee:l===""?nee:ree),r)}function see(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function aee(t,e,n=!1){let{routesMeta:r}=t,a={},l="/",u=[];for(let s=0;s<r.length;++s){let m=r[s],_=s===r.length-1,b=l==="/"?e:e.slice(l.length)||"/",M=Ew({path:m.relativePath,caseSensitive:m.caseSensitive,end:_},b),C=m.route;if(!M&&_&&n&&!r[r.length-1].route.index&&(M=Ew({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},b)),!M)return null;Object.assign(a,M.params),u.push({params:a,pathname:nd([l,M.pathname]),pathnameBase:dee(nd([l,M.pathnameBase])),route:C}),M.pathnameBase!=="/"&&(l=nd([l,M.pathnameBase]))}return u}function Ew(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=lee(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((_,{paramName:b,isOptional:M},C)=>{if(b==="*"){let k=s[C]||"";u=l.slice(0,l.length-k.length).replace(/(.)\/+$/,"$1")}const A=s[C];return M&&!A?_[b]=void 0:_[b]=(A||"").replace(/%2F/g,"/"),_},{}),pathname:l,pathnameBase:u,pattern:t}}function lee(t,e=!1,n=!0){Vo(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,s,m)=>(r.push({paramName:s,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function cee(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Vo(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ru(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function uee({basename:t,pathname:e}){return e==="/"?t:nd([t,e])}var DB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vI=t=>DB.test(t);function hee(t,e="/"){let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?lm(t):t,l;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?l=$L(n.substring(1),"/"):l=$L(n,e)):l=e,{pathname:l,search:fee(r),hash:pee(a)}}function $L(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function MM(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function LB(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function yI(t){let e=LB(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function _I(t,e,n,r=!1){let a;typeof t=="string"?a=lm(t):(a={...t},Or(!a.pathname||!a.pathname.includes("?"),MM("?","pathname","search",a)),Or(!a.pathname||!a.pathname.includes("#"),MM("#","pathname","hash",a)),Or(!a.search||!a.search.includes("#"),MM("#","search","hash",a)));let l=t===""||a.pathname==="",u=l?"/":a.pathname,s;if(u==null)s=n;else{let M=e.length-1;if(!r&&u.startsWith("..")){let C=u.split("/");for(;C[0]==="..";)C.shift(),M-=1;a.pathname=C.join("/")}s=M>=0?e[M]:"/"}let m=hee(a,s),_=u&&u!=="/"&&u.endsWith("/"),b=(l||u===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(_||b)&&(m.pathname+="/"),m}var nd=t=>t.join("/").replace(/\/\/+/g,"/"),dee=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),fee=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,pee=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,Ix=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function ex(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function Rx(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var kB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function zB(t,e){let n=t;if(typeof n!="string"||!DB.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,a=!1;if(kB)try{let l=new URL(window.location.href),u=n.startsWith("//")?new URL(l.protocol+n):new URL(n),s=ru(u.pathname,e);u.origin===l.origin&&s!=null?n=s+u.search+u.hash:a=!0}catch{Vo(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:a,to:n}}var Up=Symbol("Uninstrumented");function mee(t,e){let n={lazy:[],"lazy.loader":[],"lazy.action":[],"lazy.middleware":[],middleware:[],loader:[],action:[]};t.forEach(a=>a({id:e.id,index:e.index,path:e.path,instrument(l){let u=Object.keys(n);for(let s of u)l[s]&&n[s].push(l[s])}}));let r={};if(typeof e.lazy=="function"&&n.lazy.length>0){let a=oy(n.lazy,e.lazy,()=>{});a&&(r.lazy=a)}if(typeof e.lazy=="object"){let a=e.lazy;["middleware","loader","action"].forEach(l=>{let u=a[l],s=n[`lazy.${l}`];if(typeof u=="function"&&s.length>0){let m=oy(s,u,()=>{});m&&(r.lazy=Object.assign(r.lazy||{},{[l]:m}))}})}return["loader","action"].forEach(a=>{let l=e[a];if(typeof l=="function"&&n[a].length>0){let u=l[Up]??l,s=oy(n[a],u,(...m)=>VL(m[0]));s&&(a==="loader"&&u.hydrate===!0&&(s.hydrate=!0),s[Up]=u,r[a]=s)}}),e.middleware&&e.middleware.length>0&&n.middleware.length>0&&(r.middleware=e.middleware.map(a=>{let l=a[Up]??a,u=oy(n.middleware,l,(...s)=>VL(s[0]));return u?(u[Up]=l,u):a})),r}function gee(t,e){let n={navigate:[],fetch:[]};if(e.forEach(r=>r({instrument(a){let l=Object.keys(a);for(let u of l)a[u]&&n[u].push(a[u])}})),n.navigate.length>0){let r=t.navigate[Up]??t.navigate,a=oy(n.navigate,r,(...l)=>{let[u,s]=l;return{to:typeof u=="number"||typeof u=="string"?u:u?ad(u):".",...jL(t,s??{})}});a&&(a[Up]=r,t.navigate=a)}if(n.fetch.length>0){let r=t.fetch[Up]??t.fetch,a=oy(n.fetch,r,(...l)=>{let[u,,s,m]=l;return{href:s??".",fetcherKey:u,...jL(t,m??{})}});a&&(a[Up]=r,t.fetch=a)}return t}function oy(t,e,n){return t.length===0?null:async(...r)=>{let a=await OB(t,n(...r),()=>e(...r),t.length-1);if(a.type==="error")throw a.value;return a.value}}async function OB(t,e,n,r){let a=t[r],l;if(a){let u,s=async()=>(u?console.error("You cannot call instrumented handlers more than once"):u=OB(t,e,n,r-1),l=await u,Or(l,"Expected a result"),l.type==="error"&&l.value instanceof Error?{status:"error",error:l.value}:{status:"success",error:void 0});try{await a(s,e)}catch(m){console.error("An instrumentation function threw an error:",m)}u||await s(),await u}else try{l={type:"success",value:await n()}}catch(u){l={type:"error",value:u}}return l||{type:"error",value:new Error("No result assigned in instrumentation chain.")}}function VL(t){let{request:e,context:n,params:r,unstable_pattern:a}=t;return{request:vee(e),params:{...r},unstable_pattern:a,context:yee(n)}}function jL(t,e){return{currentUrl:ad(t.state.location),..."formMethod"in e?{formMethod:e.formMethod}:{},..."formEncType"in e?{formEncType:e.formEncType}:{},..."formData"in e?{formData:e.formData}:{},..."body"in e?{body:e.body}:{}}}function vee(t){return{method:t.method,url:t.url,headers:{get:(...e)=>t.headers.get(...e)}}}function yee(t){if(xee(t)){let e={...t};return Object.freeze(e),e}else return{get:e=>t.get(e)}}var _ee=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function xee(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||e===null||Object.getOwnPropertyNames(e).sort().join("\0")===_ee}var FB=["POST","PUT","PATCH","DELETE"],bee=new Set(FB),wee=["GET",...FB],See=new Set(wee),NB=new Set([301,302,303,307,308]),Mee=new Set([307,308]),EM={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Eee={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},$0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Cee=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),BB="remix-router-transitions",UB=Symbol("ResetLoaderData");function Tee(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";Or(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=t.hydrationRouteProperties||[],a=t.mapRouteProperties||Cee,l=a;if(t.unstable_instrumentations){let Je=t.unstable_instrumentations;l=gt=>({...a(gt),...mee(Je.map(St=>St.route).filter(Boolean),gt)})}let u={},s=Q_(t.routes,l,void 0,u),m,_=t.basename||"/";_.startsWith("/")||(_=`/${_}`);let b=t.dataStrategy||Dee,M={...t.future},C=null,A=new Set,k=null,z=null,P=null,O=t.hydrationData!=null,j=Fp(s,t.history.location,_),U=!1,X=null,K;if(j==null&&!t.patchRoutesOnNavigation){let Je=Yc(404,{pathname:t.history.location.pathname}),{matches:gt,route:St}=Q1(s);K=!0,j=gt,X={[St.id]:Je}}else if(j&&!t.hydrationData&&Jt(j,s,t.history.location.pathname).active&&(j=null),j)if(j.some(Je=>Je.route.lazy))K=!1;else if(!j.some(Je=>xI(Je.route)))K=!0;else{let Je=t.hydrationData?t.hydrationData.loaderData:null,gt=t.hydrationData?t.hydrationData.errors:null;if(gt){let St=j.findIndex(ft=>gt[ft.route.id]!==void 0);K=j.slice(0,St+1).every(ft=>!rP(ft.route,Je,gt))}else K=j.every(St=>!rP(St.route,Je,gt))}else{K=!1,j=[];let Je=Jt(null,s,t.history.location.pathname);Je.active&&Je.matches&&(U=!0,j=Je.matches)}let se,J={historyAction:t.history.action,location:t.history.location,matches:j,initialized:K,navigation:EM,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||X,fetchers:new Map,blockers:new Map},ue="POP",ne=null,H=!1,de,Ee=!1,Pe=new Map,Ze=null,ke=!1,Te=!1,Ie=new Set,Ce=new Map,Ue=0,nt=-1,Le=new Map,lt=new Set,Ht=new Map,He=new Map,pt=new Set,_t=new Map,ot,et=null;function Mt(){if(C=t.history.listen(({action:Je,location:gt,delta:St})=>{if(ot){ot(),ot=void 0;return}Vo(_t.size===0||St!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ft=Ge({currentLocation:J.location,nextLocation:gt,historyAction:Je});if(ft&&St!=null){let Qt=new Promise(Sn=>{ot=Sn});t.history.go(St*-1),Fe(ft,{state:"blocked",location:gt,proceed(){Fe(ft,{state:"proceeding",proceed:void 0,reset:void 0,location:gt}),Qt.then(()=>t.history.go(St))},reset(){let Sn=new Map(J.blockers);Sn.set(ft,$0),en({blockers:Sn})}}),ne?.resolve(),ne=null;return}return Gt(Je,gt)}),n){Yee(e,Pe);let Je=()=>Kee(e,Pe);e.addEventListener("pagehide",Je),Ze=()=>e.removeEventListener("pagehide",Je)}return J.initialized||Gt("POP",J.location,{initialHydration:!0}),se}function Tt(){C&&C(),Ze&&Ze(),A.clear(),de&&de.abort(),J.fetchers.forEach((Je,gt)=>ee(gt)),J.blockers.forEach((Je,gt)=>_e(gt))}function hn(Je){return A.add(Je),()=>A.delete(Je)}function en(Je,gt={}){Je.matches&&(Je.matches=Je.matches.map(Qt=>{let Sn=u[Qt.route.id],Un=Qt.route;return Un.element!==Sn.element||Un.errorElement!==Sn.errorElement||Un.hydrateFallbackElement!==Sn.hydrateFallbackElement?{...Qt,route:Sn}:Qt})),J={...J,...Je};let St=[],ft=[];J.fetchers.forEach((Qt,Sn)=>{Qt.state==="idle"&&(pt.has(Sn)?St.push(Sn):ft.push(Sn))}),pt.forEach(Qt=>{!J.fetchers.has(Qt)&&!Ce.has(Qt)&&St.push(Qt)}),[...A].forEach(Qt=>Qt(J,{deletedFetchers:St,newErrors:Je.errors??null,viewTransitionOpts:gt.viewTransitionOpts,flushSync:gt.flushSync===!0})),St.forEach(Qt=>ee(Qt)),ft.forEach(Qt=>J.fetchers.delete(Qt))}function an(Je,gt,{flushSync:St}={}){let ft=J.actionData!=null&&J.navigation.formMethod!=null&&ba(J.navigation.formMethod)&&J.navigation.state==="loading"&&Je.state?._isRedirect!==!0,Qt;gt.actionData?Object.keys(gt.actionData).length>0?Qt=gt.actionData:Qt=null:ft?Qt=J.actionData:Qt=null;let Sn=gt.loaderData?QL(J.loaderData,gt.loaderData,gt.matches||[],gt.errors):J.loaderData,Un=J.blockers;Un.size>0&&(Un=new Map(Un),Un.forEach((ut,Vt)=>Un.set(Vt,$0)));let kn=ke?!1:sn(Je,gt.matches||J.matches),Rt=H===!0||J.navigation.formMethod!=null&&ba(J.navigation.formMethod)&&Je.state?._isRedirect!==!0;m&&(s=m,m=void 0),ke||ue==="POP"||(ue==="PUSH"?t.history.push(Je,Je.state):ue==="REPLACE"&&t.history.replace(Je,Je.state));let ct;if(ue==="POP"){let ut=Pe.get(J.location.pathname);ut&&ut.has(Je.pathname)?ct={currentLocation:J.location,nextLocation:Je}:Pe.has(Je.pathname)&&(ct={currentLocation:Je,nextLocation:J.location})}else if(Ee){let ut=Pe.get(J.location.pathname);ut?ut.add(Je.pathname):(ut=new Set([Je.pathname]),Pe.set(J.location.pathname,ut)),ct={currentLocation:J.location,nextLocation:Je}}en({...gt,actionData:Qt,loaderData:Sn,historyAction:ue,location:Je,initialized:!0,navigation:EM,revalidation:"idle",restoreScrollPosition:kn,preventScrollReset:Rt,blockers:Un},{viewTransitionOpts:ct,flushSync:St===!0}),ue="POP",H=!1,Ee=!1,ke=!1,Te=!1,ne?.resolve(),ne=null,et?.resolve(),et=null}async function Ke(Je,gt){if(ne?.resolve(),ne=null,typeof Je=="number"){ne||(ne=rk());let Bn=ne.promise;return t.history.go(Je),Bn}let St=nP(J.location,J.matches,_,Je,gt?.fromRouteId,gt?.relative),{path:ft,submission:Qt,error:Sn}=HL(!1,St,gt),Un=J.location,kn=J_(J.location,ft,gt&&gt.state);kn={...kn,...t.history.encodeLocation(kn)};let Rt=gt&&gt.replace!=null?gt.replace:void 0,ct="PUSH";Rt===!0?ct="REPLACE":Rt===!1||Qt!=null&&ba(Qt.formMethod)&&Qt.formAction===J.location.pathname+J.location.search&&(ct="REPLACE");let ut=gt&&"preventScrollReset"in gt?gt.preventScrollReset===!0:void 0,Vt=(gt&&gt.flushSync)===!0,En=Ge({currentLocation:Un,nextLocation:kn,historyAction:ct});if(En){Fe(En,{state:"blocked",location:kn,proceed(){Fe(En,{state:"proceeding",proceed:void 0,reset:void 0,location:kn}),Ke(Je,gt)},reset(){let Bn=new Map(J.blockers);Bn.set(En,$0),en({blockers:Bn})}});return}await Gt(ct,kn,{submission:Qt,pendingError:Sn,preventScrollReset:ut,replace:gt&&gt.replace,enableViewTransition:gt&&gt.viewTransition,flushSync:Vt,callSiteDefaultShouldRevalidate:gt&&gt.unstable_defaultShouldRevalidate})}function An(){et||(et=rk()),yn(),en({revalidation:"loading"});let Je=et.promise;return J.navigation.state==="submitting"?Je:J.navigation.state==="idle"?(Gt(J.historyAction,J.location,{startUninterruptedRevalidation:!0}),Je):(Gt(ue||J.historyAction,J.navigation.location,{overrideNavigation:J.navigation,enableViewTransition:Ee===!0}),Je)}async function Gt(Je,gt,St){de&&de.abort(),de=null,ue=Je,ke=(St&&St.startUninterruptedRevalidation)===!0,fn(J.location,J.matches),H=(St&&St.preventScrollReset)===!0,Ee=(St&&St.enableViewTransition)===!0;let ft=m||s,Qt=St&&St.overrideNavigation,Sn=St?.initialHydration&&J.matches&&J.matches.length>0&&!U?J.matches:Fp(ft,gt,_),Un=(St&&St.flushSync)===!0;if(Sn&&J.initialized&&!Te&&Uee(J.location,gt)&&!(St&&St.submission&&ba(St.submission.formMethod))){an(gt,{matches:Sn},{flushSync:Un});return}let kn=Jt(Sn,ft,gt.pathname);if(kn.active&&kn.matches&&(Sn=kn.matches),!Sn){let{error:fr,notFoundMatches:Re,route:mt}=je(gt.pathname);an(gt,{matches:Re,loaderData:{},errors:{[mt.id]:fr}},{flushSync:Un});return}de=new AbortController;let Rt=Yv(t.history,gt,de.signal,St&&St.submission),ct=t.getContext?await t.getContext():new NL,ut;if(St&&St.pendingError)ut=[Np(Sn).route.id,{type:"error",error:St.pendingError}];else if(St&&St.submission&&ba(St.submission.formMethod)){let fr=await on(Rt,gt,St.submission,Sn,ct,kn.active,St&&St.initialHydration===!0,{replace:St.replace,flushSync:Un});if(fr.shortCircuited)return;if(fr.pendingActionResult){let[Re,mt]=fr.pendingActionResult;if(oc(mt)&&ex(mt.error)&&mt.error.status===404){de=null,an(gt,{matches:fr.matches,loaderData:{},errors:{[Re]:mt.error}});return}}Sn=fr.matches||Sn,ut=fr.pendingActionResult,Qt=CM(gt,St.submission),Un=!1,kn.active=!1,Rt=Yv(t.history,Rt.url,Rt.signal)}let{shortCircuited:Vt,matches:En,loaderData:Bn,errors:In}=await Wt(Rt,gt,Sn,ct,kn.active,Qt,St&&St.submission,St&&St.fetcherSubmission,St&&St.replace,St&&St.initialHydration===!0,Un,ut,St&&St.callSiteDefaultShouldRevalidate);Vt||(de=null,an(gt,{matches:En||Sn,...ek(ut),loaderData:Bn,errors:In}))}async function on(Je,gt,St,ft,Qt,Sn,Un,kn={}){yn();let Rt=Xee(gt,St);if(en({navigation:Rt},{flushSync:kn.flushSync===!0}),Sn){let Vt=await cn(ft,gt.pathname,Je.signal);if(Vt.type==="aborted")return{shortCircuited:!0};if(Vt.type==="error"){if(Vt.partialMatches.length===0){let{matches:Bn,route:In}=Q1(s);return{matches:Bn,pendingActionResult:[In.id,{type:"error",error:Vt.error}]}}let En=Np(Vt.partialMatches).route.id;return{matches:Vt.partialMatches,pendingActionResult:[En,{type:"error",error:Vt.error}]}}else if(Vt.matches)ft=Vt.matches;else{let{notFoundMatches:En,error:Bn,route:In}=je(gt.pathname);return{matches:En,pendingActionResult:[In.id,{type:"error",error:Bn}]}}}let ct,ut=Zb(ft,gt);if(!ut.route.action&&!ut.route.lazy)ct={type:"error",error:Yc(405,{method:Je.method,pathname:gt.pathname,routeId:ut.route.id})};else{let Vt=xy(l,u,Je,ft,ut,Un?[]:r,Qt),En=await jt(Je,Vt,Qt,null);if(ct=En[ut.route.id],!ct){for(let Bn of ft)if(En[Bn.route.id]){ct=En[Bn.route.id];break}}if(Je.signal.aborted)return{shortCircuited:!0}}if(wg(ct)){let Vt;return kn&&kn.replace!=null?Vt=kn.replace:Vt=YL(ct.response.headers.get("Location"),new URL(Je.url),_,t.history)===J.location.pathname+J.location.search,await Nt(Je,ct,!0,{submission:St,replace:Vt}),{shortCircuited:!0}}if(oc(ct)){let Vt=Np(ft,ut.route.id);return(kn&&kn.replace)!==!0&&(ue="PUSH"),{matches:ft,pendingActionResult:[Vt.route.id,ct,ut.route.id]}}return{matches:ft,pendingActionResult:[ut.route.id,ct]}}async function Wt(Je,gt,St,ft,Qt,Sn,Un,kn,Rt,ct,ut,Vt,En){let Bn=Sn||CM(gt,Un),In=Un||kn||nk(Bn),fr=!ke&&!ct;if(Qt){if(fr){let Qn=Gn(Vt);en({navigation:Bn,...Qn!==void 0?{actionData:Qn}:{}},{flushSync:ut})}let Rn=await cn(St,gt.pathname,Je.signal);if(Rn.type==="aborted")return{shortCircuited:!0};if(Rn.type==="error"){if(Rn.partialMatches.length===0){let{matches:Ir,route:wr}=Q1(s);return{matches:Ir,loaderData:{},errors:{[wr.id]:Rn.error}}}let Qn=Np(Rn.partialMatches).route.id;return{matches:Rn.partialMatches,loaderData:{},errors:{[Qn]:Rn.error}}}else if(Rn.matches)St=Rn.matches;else{let{error:Qn,notFoundMatches:Ir,route:wr}=je(gt.pathname);return{matches:Ir,loaderData:{},errors:{[wr.id]:Qn}}}}let Re=m||s,{dsMatches:mt,revalidatingFetchers:Lt}=GL(Je,ft,l,u,t.history,J,St,In,gt,ct?[]:r,ct===!0,Te,Ie,pt,Ht,lt,Re,_,t.patchRoutesOnNavigation!=null,Vt,En);if(nt=++Ue,!t.dataStrategy&&!mt.some(Rn=>Rn.shouldLoad)&&!mt.some(Rn=>Rn.route.middleware&&Rn.route.middleware.length>0)&&Lt.length===0){let Rn=xe();return an(gt,{matches:St,loaderData:{},errors:Vt&&oc(Vt[1])?{[Vt[0]]:Vt[1].error}:null,...ek(Vt),...Rn?{fetchers:new Map(J.fetchers)}:{}},{flushSync:ut}),{shortCircuited:!0}}if(fr){let Rn={};if(!Qt){Rn.navigation=Bn;let Qn=Gn(Vt);Qn!==void 0&&(Rn.actionData=Qn)}Lt.length>0&&(Rn.fetchers=dn(Lt)),en(Rn,{flushSync:ut})}Lt.forEach(Rn=>{fe(Rn.key),Rn.controller&&Ce.set(Rn.key,Rn.controller)});let Et=()=>Lt.forEach(Rn=>fe(Rn.key));de&&de.signal.addEventListener("abort",Et);let{loaderResults:wt,fetcherResults:un}=await Ut(mt,Lt,Je,ft);if(Je.signal.aborted)return{shortCircuited:!0};de&&de.signal.removeEventListener("abort",Et),Lt.forEach(Rn=>Ce.delete(Rn.key));let _n=eb(wt);if(_n)return await Nt(Je,_n.result,!0,{replace:Rt}),{shortCircuited:!0};if(_n=eb(un),_n)return lt.add(_n.key),await Nt(Je,_n.result,!0,{replace:Rt}),{shortCircuited:!0};let{loaderData:pn,errors:jn}=JL(J,St,wt,Vt,Lt,un);ct&&J.errors&&(jn={...J.errors,...jn});let mn=xe(),Wn=Ye(nt),Pn=mn||Wn||Lt.length>0;return{matches:St,loaderData:pn,errors:jn,...Pn?{fetchers:new Map(J.fetchers)}:{}}}function Gn(Je){if(Je&&!oc(Je[1]))return{[Je[0]]:Je[1].data};if(J.actionData)return Object.keys(J.actionData).length===0?null:J.actionData}function dn(Je){return Je.forEach(gt=>{let St=J.fetchers.get(gt.key),ft=V0(void 0,St?St.data:void 0);J.fetchers.set(gt.key,ft)}),new Map(J.fetchers)}async function Ve(Je,gt,St,ft){fe(Je);let Qt=(ft&&ft.flushSync)===!0,Sn=m||s,Un=nP(J.location,J.matches,_,St,gt,ft?.relative),kn=Fp(Sn,Un,_),Rt=Jt(kn,Sn,Un);if(Rt.active&&Rt.matches&&(kn=Rt.matches),!kn){qt(Je,gt,Yc(404,{pathname:Un}),{flushSync:Qt});return}let{path:ct,submission:ut,error:Vt}=HL(!0,Un,ft);if(Vt){qt(Je,gt,Vt,{flushSync:Qt});return}let En=t.getContext?await t.getContext():new NL,Bn=(ft&&ft.preventScrollReset)===!0;if(ut&&ba(ut.formMethod)){await Se(Je,gt,ct,kn,En,Rt.active,Qt,Bn,ut,ft&&ft.unstable_defaultShouldRevalidate);return}Ht.set(Je,{routeId:gt,path:ct}),await bt(Je,gt,ct,kn,En,Rt.active,Qt,Bn,ut)}async function Se(Je,gt,St,ft,Qt,Sn,Un,kn,Rt,ct){yn(),Ht.delete(Je);let ut=J.fetchers.get(Je);Zt(Je,Zee(Rt,ut),{flushSync:Un});let Vt=new AbortController,En=Yv(t.history,St,Vt.signal,Rt);if(Sn){let On=await cn(ft,new URL(En.url).pathname,En.signal,Je);if(On.type==="aborted")return;if(On.type==="error"){qt(Je,gt,On.error,{flushSync:Un});return}else if(On.matches)ft=On.matches;else{qt(Je,gt,Yc(404,{pathname:St}),{flushSync:Un});return}}let Bn=Zb(ft,St);if(!Bn.route.action&&!Bn.route.lazy){let On=Yc(405,{method:Rt.formMethod,pathname:St,routeId:gt});qt(Je,gt,On,{flushSync:Un});return}Ce.set(Je,Vt);let In=Ue,fr=xy(l,u,En,ft,Bn,r,Qt),Re=await jt(En,fr,Qt,Je),mt=Re[Bn.route.id];if(!mt){for(let On of fr)if(Re[On.route.id]){mt=Re[On.route.id];break}}if(En.signal.aborted){Ce.get(Je)===Vt&&Ce.delete(Je);return}if(pt.has(Je)){if(wg(mt)||oc(mt)){Zt(Je,rf(void 0));return}}else{if(wg(mt))if(Ce.delete(Je),nt>In){Zt(Je,rf(void 0));return}else return lt.add(Je),Zt(Je,V0(Rt)),Nt(En,mt,!1,{fetcherSubmission:Rt,preventScrollReset:kn});if(oc(mt)){qt(Je,gt,mt.error);return}}let Lt=J.navigation.location||J.location,Et=Yv(t.history,Lt,Vt.signal),wt=m||s,un=J.navigation.state!=="idle"?Fp(wt,J.navigation.location,_):J.matches;Or(un,"Didn't find any matches after fetcher action");let _n=++Ue;Le.set(Je,_n);let pn=V0(Rt,mt.data);J.fetchers.set(Je,pn);let{dsMatches:jn,revalidatingFetchers:mn}=GL(Et,Qt,l,u,t.history,J,un,Rt,Lt,r,!1,Te,Ie,pt,Ht,lt,wt,_,t.patchRoutesOnNavigation!=null,[Bn.route.id,mt],ct);mn.filter(On=>On.key!==Je).forEach(On=>{let or=On.key,gi=J.fetchers.get(or),Cr=V0(void 0,gi?gi.data:void 0);J.fetchers.set(or,Cr),fe(or),On.controller&&Ce.set(or,On.controller)}),en({fetchers:new Map(J.fetchers)});let Wn=()=>mn.forEach(On=>fe(On.key));Vt.signal.addEventListener("abort",Wn);let{loaderResults:Pn,fetcherResults:Rn}=await Ut(jn,mn,Et,Qt);if(Vt.signal.aborted)return;if(Vt.signal.removeEventListener("abort",Wn),Le.delete(Je),Ce.delete(Je),mn.forEach(On=>Ce.delete(On.key)),J.fetchers.has(Je)){let On=rf(mt.data);J.fetchers.set(Je,On)}let Qn=eb(Pn);if(Qn)return Nt(Et,Qn.result,!1,{preventScrollReset:kn});if(Qn=eb(Rn),Qn)return lt.add(Qn.key),Nt(Et,Qn.result,!1,{preventScrollReset:kn});let{loaderData:Ir,errors:wr}=JL(J,un,Pn,void 0,mn,Rn);Ye(_n),J.navigation.state==="loading"&&_n>nt?(Or(ue,"Expected pending action"),de&&de.abort(),an(J.navigation.location,{matches:un,loaderData:Ir,errors:wr,fetchers:new Map(J.fetchers)})):(en({errors:wr,loaderData:QL(J.loaderData,Ir,un,wr),fetchers:new Map(J.fetchers)}),Te=!1)}async function bt(Je,gt,St,ft,Qt,Sn,Un,kn,Rt){let ct=J.fetchers.get(Je);Zt(Je,V0(Rt,ct?ct.data:void 0),{flushSync:Un});let ut=new AbortController,Vt=Yv(t.history,St,ut.signal);if(Sn){let mt=await cn(ft,new URL(Vt.url).pathname,Vt.signal,Je);if(mt.type==="aborted")return;if(mt.type==="error"){qt(Je,gt,mt.error,{flushSync:Un});return}else if(mt.matches)ft=mt.matches;else{qt(Je,gt,Yc(404,{pathname:St}),{flushSync:Un});return}}let En=Zb(ft,St);Ce.set(Je,ut);let Bn=Ue,In=xy(l,u,Vt,ft,En,r,Qt),Re=(await jt(Vt,In,Qt,Je))[En.route.id];if(Ce.get(Je)===ut&&Ce.delete(Je),!Vt.signal.aborted){if(pt.has(Je)){Zt(Je,rf(void 0));return}if(wg(Re))if(nt>Bn){Zt(Je,rf(void 0));return}else{lt.add(Je),await Nt(Vt,Re,!1,{preventScrollReset:kn});return}if(oc(Re)){qt(Je,gt,Re.error);return}Zt(Je,rf(Re.data))}}async function Nt(Je,gt,St,{submission:ft,fetcherSubmission:Qt,preventScrollReset:Sn,replace:Un}={}){St||(ne?.resolve(),ne=null),gt.response.headers.has("X-Remix-Revalidate")&&(Te=!0);let kn=gt.response.headers.get("Location");Or(kn,"Expected a Location header on the redirect Response"),kn=YL(kn,new URL(Je.url),_,t.history);let Rt=J_(J.location,kn,{_isRedirect:!0});if(n){let In=!1;if(gt.response.headers.has("X-Remix-Reload-Document"))In=!0;else if(vI(kn)){const fr=AB(kn,!0);In=fr.origin!==e.location.origin||ru(fr.pathname,_)==null}if(In){Un?e.location.replace(kn):e.location.assign(kn);return}}de=null;let ct=Un===!0||gt.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ut,formAction:Vt,formEncType:En}=J.navigation;!ft&&!Qt&&ut&&Vt&&En&&(ft=nk(J.navigation));let Bn=ft||Qt;if(Mee.has(gt.response.status)&&Bn&&ba(Bn.formMethod))await Gt(ct,Rt,{submission:{...Bn,formAction:kn},preventScrollReset:Sn||H,enableViewTransition:St?Ee:void 0});else{let In=CM(Rt,ft);await Gt(ct,Rt,{overrideNavigation:In,fetcherSubmission:Qt,preventScrollReset:Sn||H,enableViewTransition:St?Ee:void 0})}}async function jt(Je,gt,St,ft){let Qt,Sn={};try{Qt=await kee(b,Je,gt,ft,St,!1)}catch(Un){return gt.filter(kn=>kn.shouldLoad).forEach(kn=>{Sn[kn.route.id]={type:"error",error:Un}}),Sn}if(Je.signal.aborted)return Sn;if(!ba(Je.method))for(let Un of gt){if(Qt[Un.route.id]?.type==="error")break;!Qt.hasOwnProperty(Un.route.id)&&!J.loaderData.hasOwnProperty(Un.route.id)&&(!J.errors||!J.errors.hasOwnProperty(Un.route.id))&&Un.shouldCallHandler()&&(Qt[Un.route.id]={type:"error",result:new Error(`No result returned from dataStrategy for route ${Un.route.id}`)})}for(let[Un,kn]of Object.entries(Qt))if(Hee(kn)){let Rt=kn.result;Sn[Un]={type:"redirect",response:Nee(Rt,Je,Un,gt,_)}}else Sn[Un]=await Fee(kn);return Sn}async function Ut(Je,gt,St,ft){let Qt=jt(St,Je,ft,null),Sn=Promise.all(gt.map(async Rt=>{if(Rt.matches&&Rt.match&&Rt.request&&Rt.controller){let ut=(await jt(Rt.request,Rt.matches,ft,Rt.key))[Rt.match.route.id];return{[Rt.key]:ut}}else return Promise.resolve({[Rt.key]:{type:"error",error:Yc(404,{pathname:Rt.path})}})})),Un=await Qt,kn=(await Sn).reduce((Rt,ct)=>Object.assign(Rt,ct),{});return{loaderResults:Un,fetcherResults:kn}}function yn(){Te=!0,Ht.forEach((Je,gt)=>{Ce.has(gt)&&Ie.add(gt),fe(gt)})}function Zt(Je,gt,St={}){J.fetchers.set(Je,gt),en({fetchers:new Map(J.fetchers)},{flushSync:(St&&St.flushSync)===!0})}function qt(Je,gt,St,ft={}){let Qt=Np(J.matches,gt);ee(Je),en({errors:{[Qt.route.id]:St},fetchers:new Map(J.fetchers)},{flushSync:(ft&&ft.flushSync)===!0})}function Fn(Je){return He.set(Je,(He.get(Je)||0)+1),pt.has(Je)&&pt.delete(Je),J.fetchers.get(Je)||Eee}function Be(Je,gt){fe(Je,gt?.reason),Zt(Je,rf(null))}function ee(Je){let gt=J.fetchers.get(Je);Ce.has(Je)&&!(gt&&gt.state==="loading"&&Le.has(Je))&&fe(Je),Ht.delete(Je),Le.delete(Je),lt.delete(Je),pt.delete(Je),Ie.delete(Je),J.fetchers.delete(Je)}function oe(Je){let gt=(He.get(Je)||0)-1;gt<=0?(He.delete(Je),pt.add(Je)):He.set(Je,gt),en({fetchers:new Map(J.fetchers)})}function fe(Je,gt){let St=Ce.get(Je);St&&(St.abort(gt),Ce.delete(Je))}function he(Je){for(let gt of Je){let St=Fn(gt),ft=rf(St.data);J.fetchers.set(gt,ft)}}function xe(){let Je=[],gt=!1;for(let St of lt){let ft=J.fetchers.get(St);Or(ft,`Expected fetcher: ${St}`),ft.state==="loading"&&(lt.delete(St),Je.push(St),gt=!0)}return he(Je),gt}function Ye(Je){let gt=[];for(let[St,ft]of Le)if(ft<Je){let Qt=J.fetchers.get(St);Or(Qt,`Expected fetcher: ${St}`),Qt.state==="loading"&&(fe(St),Le.delete(St),gt.push(St))}return he(gt),gt.length>0}function st(Je,gt){let St=J.blockers.get(Je)||$0;return _t.get(Je)!==gt&&_t.set(Je,gt),St}function _e(Je){J.blockers.delete(Je),_t.delete(Je)}function Fe(Je,gt){let St=J.blockers.get(Je)||$0;Or(St.state==="unblocked"&&gt.state==="blocked"||St.state==="blocked"&&gt.state==="blocked"||St.state==="blocked"&&gt.state==="proceeding"||St.state==="blocked"&&gt.state==="unblocked"||St.state==="proceeding"&&gt.state==="unblocked",`Invalid blocker state transition: ${St.state} -> ${gt.state}`);let ft=new Map(J.blockers);ft.set(Je,gt),en({blockers:ft})}function Ge({currentLocation:Je,nextLocation:gt,historyAction:St}){if(_t.size===0)return;_t.size>1&&Vo(!1,"A router only supports one blocker at a time");let ft=Array.from(_t.entries()),[Qt,Sn]=ft[ft.length-1],Un=J.blockers.get(Qt);if(!(Un&&Un.state==="proceeding")&&Sn({currentLocation:Je,nextLocation:gt,historyAction:St}))return Qt}function je(Je){let gt=Yc(404,{pathname:Je}),St=m||s,{matches:ft,route:Qt}=Q1(St);return{notFoundMatches:ft,route:Qt,error:gt}}function De(Je,gt,St){if(k=Je,P=gt,z=St||null,!O&&J.navigation===EM){O=!0;let ft=sn(J.location,J.matches);ft!=null&&en({restoreScrollPosition:ft})}return()=>{k=null,P=null,z=null}}function zt(Je,gt){return z&&z(Je,gt.map(ft=>KQ(ft,J.loaderData)))||Je.key}function fn(Je,gt){if(k&&P){let St=zt(Je,gt);k[St]=P()}}function sn(Je,gt){if(k){let St=zt(Je,gt),ft=k[St];if(typeof ft=="number")return ft}return null}function Jt(Je,gt,St){if(t.patchRoutesOnNavigation)if(Je){if(Object.keys(Je[0].params).length>0)return{active:!0,matches:i_(gt,St,_,!0)}}else return{active:!0,matches:i_(gt,St,_,!0)||[]};return{active:!1,matches:null}}async function cn(Je,gt,St,ft){if(!t.patchRoutesOnNavigation)return{type:"success",matches:Je};let Qt=Je;for(;;){let Sn=m==null,Un=m||s,kn=u;try{await t.patchRoutesOnNavigation({signal:St,path:gt,matches:Qt,fetcherKey:ft,patch:(ut,Vt)=>{St.aborted||WL(ut,Vt,Un,kn,l,!1)}})}catch(ut){return{type:"error",error:ut,partialMatches:Qt}}finally{Sn&&!St.aborted&&(s=[...s])}if(St.aborted)return{type:"aborted"};let Rt=Fp(Un,gt,_),ct=null;if(Rt){if(Object.keys(Rt[0].params).length===0)return{type:"success",matches:Rt};if(ct=i_(Un,gt,_,!0),!(ct&&Qt.length<ct.length&&Zn(Qt,ct.slice(0,Qt.length))))return{type:"success",matches:Rt}}if(ct||(ct=i_(Un,gt,_,!0)),!ct||Zn(Qt,ct))return{type:"success",matches:null};Qt=ct}}function Zn(Je,gt){return Je.length===gt.length&&Je.every((St,ft)=>St.route.id===gt[ft].route.id)}function yr(Je){u={},m=Q_(Je,l,void 0,u)}function Ar(Je,gt,St=!1){let ft=m==null;WL(Je,gt,m||s,u,l,St),ft&&(s=[...s],en({}))}return se={get basename(){return _},get future(){return M},get state(){return J},get routes(){return s},get window(){return e},initialize:Mt,subscribe:hn,enableScrollRestoration:De,navigate:Ke,fetch:Ve,revalidate:An,createHref:Je=>t.history.createHref(Je),encodeLocation:Je=>t.history.encodeLocation(Je),getFetcher:Fn,resetFetcher:Be,deleteFetcher:oe,dispose:Tt,getBlocker:st,deleteBlocker:_e,patchRoutes:Ar,_internalFetchControllers:Ce,_internalSetRoutes:yr,_internalSetStateDoNotUseOrYouWillBreakYourApp(Je){en(Je)}},t.unstable_instrumentations&&(se=gee(se,t.unstable_instrumentations.map(Je=>Je.router).filter(Boolean))),se}function Pee(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function nP(t,e,n,r,a,l){let u,s;if(a){u=[];for(let _ of e)if(u.push(_),_.route.id===a){s=_;break}}else u=e,s=e[e.length-1];let m=_I(r||".",yI(u),ru(t.pathname,n)||t.pathname,l==="path");if(r==null&&(m.search=t.search,m.hash=t.hash),(r==null||r===""||r===".")&&s){let _=wI(m.search);if(s.route.index&&!_)m.search=m.search?m.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&_){let b=new URLSearchParams(m.search),M=b.getAll("index");b.delete("index"),M.filter(A=>A).forEach(A=>b.append("index",A));let C=b.toString();m.search=C?`?${C}`:""}}return n!=="/"&&(m.pathname=uee({basename:n,pathname:m.pathname})),ad(m)}function HL(t,e,n){if(!n||!Pee(n))return{path:e};if(n.formMethod&&!qee(n.formMethod))return{path:e,error:Yc(405,{method:n.formMethod})};let r=()=>({path:e,error:Yc(400,{type:"invalid-body"})}),l=(n.formMethod||"get").toUpperCase(),u=WB(e);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!ba(l))return r();let M=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((C,[A,k])=>`${C}${A}=${k}
`,""):String(n.body);return{path:e,submission:{formMethod:l,formAction:u,formEncType:n.formEncType,formData:void 0,json:void 0,text:M}}}else if(n.formEncType==="application/json"){if(!ba(l))return r();try{let M=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:e,submission:{formMethod:l,formAction:u,formEncType:n.formEncType,formData:void 0,json:M,text:void 0}}}catch{return r()}}}Or(typeof FormData=="function","FormData is not available in this environment");let s,m;if(n.formData)s=oP(n.formData),m=n.formData;else if(n.body instanceof FormData)s=oP(n.body),m=n.body;else if(n.body instanceof URLSearchParams)s=n.body,m=KL(s);else if(n.body==null)s=new URLSearchParams,m=new FormData;else try{s=new URLSearchParams(n.body),m=KL(s)}catch{return r()}let _={formMethod:l,formAction:u,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:m,json:void 0,text:void 0};if(ba(_.formMethod))return{path:e,submission:_};let b=lm(e);return t&&b.search&&wI(b.search)&&s.append("index",""),b.search=`?${s}`,{path:ad(b),submission:_}}function GL(t,e,n,r,a,l,u,s,m,_,b,M,C,A,k,z,P,O,j,U,X){let K=U?oc(U[1])?U[1].error:U[1].data:void 0,se=a.createURL(l.location),J=a.createURL(m),ue;if(b&&l.errors){let ke=Object.keys(l.errors)[0];ue=u.findIndex(Te=>Te.route.id===ke)}else if(U&&oc(U[1])){let ke=U[0];ue=u.findIndex(Te=>Te.route.id===ke)-1}let ne=U?U[1].statusCode:void 0,H=ne&&ne>=400,de={currentUrl:se,currentParams:l.matches[0]?.params||{},nextUrl:J,nextParams:u[0].params,...s,actionResult:K,actionStatus:ne},Ee=Rx(u),Pe=u.map((ke,Te)=>{let{route:Ie}=ke,Ce=null;if(ue!=null&&Te>ue?Ce=!1:Ie.lazy?Ce=!0:xI(Ie)?b?Ce=rP(Ie,l.loaderData,l.errors):Aee(l.loaderData,l.matches[Te],ke)&&(Ce=!0):Ce=!1,Ce!==null)return iP(n,r,t,Ee,ke,_,e,Ce);let Ue=!1;typeof X=="boolean"?Ue=X:H?Ue=!1:(M||se.pathname+se.search===J.pathname+J.search||se.search!==J.search||Iee(l.matches[Te],ke))&&(Ue=!0);let nt={...de,defaultShouldRevalidate:Ue},Le=__(ke,nt);return iP(n,r,t,Ee,ke,_,e,Le,nt,X)}),Ze=[];return k.forEach((ke,Te)=>{if(b||!u.some(He=>He.route.id===ke.routeId)||A.has(Te))return;let Ie=l.fetchers.get(Te),Ce=Ie&&Ie.state!=="idle"&&Ie.data===void 0,Ue=Fp(P,ke.path,O);if(!Ue){if(j&&Ce)return;Ze.push({key:Te,routeId:ke.routeId,path:ke.path,matches:null,match:null,request:null,controller:null});return}if(z.has(Te))return;let nt=Zb(Ue,ke.path),Le=new AbortController,lt=Yv(a,ke.path,Le.signal),Ht=null;if(C.has(Te))C.delete(Te),Ht=xy(n,r,lt,Ue,nt,_,e);else if(Ce)M&&(Ht=xy(n,r,lt,Ue,nt,_,e));else{let He;typeof X=="boolean"?He=X:H?He=!1:He=M;let pt={...de,defaultShouldRevalidate:He};__(nt,pt)&&(Ht=xy(n,r,lt,Ue,nt,_,e,pt))}Ht&&Ze.push({key:Te,routeId:ke.routeId,path:ke.path,matches:Ht,match:nt,request:lt,controller:Le})}),{dsMatches:Pe,revalidatingFetchers:Ze}}function xI(t){return t.loader!=null||t.middleware!=null&&t.middleware.length>0}function rP(t,e,n){if(t.lazy)return!0;if(!xI(t))return!1;let r=e!=null&&t.id in e,a=n!=null&&n[t.id]!==void 0;return!r&&a?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!a}function Aee(t,e,n){let r=!e||n.route.id!==e.route.id,a=!t.hasOwnProperty(n.route.id);return r||a}function Iee(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function __(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function WL(t,e,n,r,a,l){let u;if(t){let _=r[t];Or(_,`No route found to patch children into: routeId = ${t}`),_.children||(_.children=[]),u=_.children}else u=n;let s=[],m=[];if(e.forEach(_=>{let b=u.find(M=>$B(_,M));b?m.push({existingRoute:b,newRoute:_}):s.push(_)}),s.length>0){let _=Q_(s,a,[t||"_","patch",String(u?.length||"0")],r);u.push(..._)}if(l&&m.length>0)for(let _=0;_<m.length;_++){let{existingRoute:b,newRoute:M}=m[_],C=b,[A]=Q_([M],a,[],{},!0);Object.assign(C,{element:A.element?A.element:C.element,errorElement:A.errorElement?A.errorElement:C.errorElement,hydrateFallbackElement:A.hydrateFallbackElement?A.hydrateFallbackElement:C.hydrateFallbackElement})}}function $B(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>e.children?.some(a=>$B(n,a))):!1}var qL=new WeakMap,VB=({key:t,route:e,manifest:n,mapRouteProperties:r})=>{let a=n[e.id];if(Or(a,"No route found in manifest"),!a.lazy||typeof a.lazy!="object")return;let l=a.lazy[t];if(!l)return;let u=qL.get(a);u||(u={},qL.set(a,u));let s=u[t];if(s)return s;let m=(async()=>{let _=qQ(t),M=a[t]!==void 0&&t!=="hasErrorBoundary";if(_)Vo(!_,"Route property "+t+" is not a supported lazy route property. This property will be ignored."),u[t]=Promise.resolve();else if(M)Vo(!1,`Route "${a.id}" has a static property "${t}" defined. The lazy property will be ignored.`);else{let C=await l();C!=null&&(Object.assign(a,{[t]:C}),Object.assign(a,r(a)))}typeof a.lazy=="object"&&(a.lazy[t]=void 0,Object.values(a.lazy).every(C=>C===void 0)&&(a.lazy=void 0))})();return u[t]=m,m},XL=new WeakMap;function Ree(t,e,n,r,a){let l=n[t.id];if(Or(l,"No route found in manifest"),!t.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof t.lazy=="function"){let b=XL.get(l);if(b)return{lazyRoutePromise:b,lazyHandlerPromise:b};let M=(async()=>{Or(typeof t.lazy=="function","No lazy route function found");let C=await t.lazy(),A={};for(let k in C){let z=C[k];if(z===void 0)continue;let P=ZQ(k),j=l[k]!==void 0&&k!=="hasErrorBoundary";P?Vo(!P,"Route property "+k+" is not a supported property to be returned from a lazy route function. This property will be ignored."):j?Vo(!j,`Route "${l.id}" has a static property "${k}" defined but its lazy function is also returning a value for this property. The lazy route property "${k}" will be ignored.`):A[k]=z}Object.assign(l,A),Object.assign(l,{...r(l),lazy:void 0})})();return XL.set(l,M),M.catch(()=>{}),{lazyRoutePromise:M,lazyHandlerPromise:M}}let u=Object.keys(t.lazy),s=[],m;for(let b of u){if(a&&a.includes(b))continue;let M=VB({key:b,route:t,manifest:n,mapRouteProperties:r});M&&(s.push(M),b===e&&(m=M))}let _=s.length>0?Promise.all(s).then(()=>{}):void 0;return _?.catch(()=>{}),m?.catch(()=>{}),{lazyRoutePromise:_,lazyHandlerPromise:m}}async function ZL(t){let e=t.matches.filter(a=>a.shouldLoad),n={};return(await Promise.all(e.map(a=>a.resolve()))).forEach((a,l)=>{n[e[l].route.id]=a}),n}async function Dee(t){return t.matches.some(e=>e.route.middleware)?jB(t,()=>ZL(t)):ZL(t)}function jB(t,e){return Lee(t,e,r=>{if(Wee(r))throw r;return r},Vee,n);function n(r,a,l){if(l)return Promise.resolve(Object.assign(l.value,{[a]:{type:"error",result:r}}));{let{matches:u}=t,s=Math.min(Math.max(u.findIndex(_=>_.route.id===a),0),Math.max(u.findIndex(_=>_.shouldCallHandler()),0)),m=Np(u,u[s].route.id).route.id;return Promise.resolve({[m]:{type:"error",result:r}})}}}async function Lee(t,e,n,r,a){let{matches:l,request:u,params:s,context:m,unstable_pattern:_}=t,b=l.flatMap(C=>C.route.middleware?C.route.middleware.map(A=>[C.route.id,A]):[]);return await HB({request:u,params:s,context:m,unstable_pattern:_},b,e,n,r,a)}async function HB(t,e,n,r,a,l,u=0){let{request:s}=t;if(s.signal.aborted)throw s.signal.reason??new Error(`Request aborted: ${s.method} ${s.url}`);let m=e[u];if(!m)return await n();let[_,b]=m,M,C=async()=>{if(M)throw new Error("You may only call `next()` once per middleware");try{return M={value:await HB(t,e,n,r,a,l,u+1)},M.value}catch(A){return M={value:await l(A,_,M)},M.value}};try{let A=await b(t,C),k=A!=null?r(A):void 0;return a(k)?k:M?k??M.value:(M={value:await C()},M.value)}catch(A){return await l(A,_,M)}}function GB(t,e,n,r,a){let l=VB({key:"middleware",route:r.route,manifest:e,mapRouteProperties:t}),u=Ree(r.route,ba(n.method)?"action":"loader",e,t,a);return{middleware:l,route:u.lazyRoutePromise,handler:u.lazyHandlerPromise}}function iP(t,e,n,r,a,l,u,s,m=null,_){let b=!1,M=GB(t,e,n,a,l);return{...a,_lazyPromises:M,shouldLoad:s,shouldRevalidateArgs:m,shouldCallHandler(C){return b=!0,m?typeof _=="boolean"?__(a,{...m,defaultShouldRevalidate:_}):typeof C=="boolean"?__(a,{...m,defaultShouldRevalidate:C}):__(a,m):s},resolve(C){let{lazy:A,loader:k,middleware:z}=a.route,P=b||s||C&&!ba(n.method)&&(A||k),O=z&&z.length>0&&!k&&!A;return P&&(ba(n.method)||!O)?zee({request:n,unstable_pattern:r,match:a,lazyHandlerPromise:M?.handler,lazyRoutePromise:M?.route,handlerOverride:C,scopedContext:u}):Promise.resolve({type:"data",result:void 0})}}}function xy(t,e,n,r,a,l,u,s=null){return r.map(m=>m.route.id!==a.route.id?{...m,shouldLoad:!1,shouldRevalidateArgs:s,shouldCallHandler:()=>!1,_lazyPromises:GB(t,e,n,m,l),resolve:()=>Promise.resolve({type:"data",result:void 0})}:iP(t,e,n,Rx(r),m,l,u,!0,s))}async function kee(t,e,n,r,a,l){n.some(_=>_._lazyPromises?.middleware)&&await Promise.all(n.map(_=>_._lazyPromises?.middleware));let u={request:e,unstable_pattern:Rx(n),params:n[0].params,context:a,matches:n},m=await t({...u,fetcherKey:r,runClientMiddleware:_=>{let b=u;return jB(b,()=>_({...b,fetcherKey:r,runClientMiddleware:()=>{throw new Error("Cannot call `runClientMiddleware()` from within an `runClientMiddleware` handler")}}))}});try{await Promise.all(n.flatMap(_=>[_._lazyPromises?.handler,_._lazyPromises?.route]))}catch{}return m}async function zee({request:t,unstable_pattern:e,match:n,lazyHandlerPromise:r,lazyRoutePromise:a,handlerOverride:l,scopedContext:u}){let s,m,_=ba(t.method),b=_?"action":"loader",M=C=>{let A,k=new Promise((O,j)=>A=j);m=()=>A(),t.signal.addEventListener("abort",m);let z=O=>typeof C!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${b}" [routeId: ${n.route.id}]`)):C({request:t,unstable_pattern:e,params:n.params,context:u},...O!==void 0?[O]:[]),P=(async()=>{try{return{type:"data",result:await(l?l(j=>z(j)):z())}}catch(O){return{type:"error",result:O}}})();return Promise.race([P,k])};try{let C=_?n.route.action:n.route.loader;if(r||a)if(C){let A,[k]=await Promise.all([M(C).catch(z=>{A=z}),r,a]);if(A!==void 0)throw A;s=k}else{await r;let A=_?n.route.action:n.route.loader;if(A)[s]=await Promise.all([M(A),a]);else if(b==="action"){let k=new URL(t.url),z=k.pathname+k.search;throw Yc(405,{method:t.method,pathname:z,routeId:n.route.id})}else return{type:"data",result:void 0}}else if(C)s=await M(C);else{let A=new URL(t.url),k=A.pathname+A.search;throw Yc(404,{pathname:k})}}catch(C){return{type:"error",result:C}}finally{m&&t.signal.removeEventListener("abort",m)}return s}async function Oee(t){let e=t.headers.get("Content-Type");return e&&/\bapplication\/json\b/.test(e)?t.body==null?null:t.json():t.text()}async function Fee(t){let{result:e,type:n}=t;if(bI(e)){let r;try{r=await Oee(e)}catch(a){return{type:"error",error:a}}return n==="error"?{type:"error",error:new Ix(e.status,e.statusText,r),statusCode:e.status,headers:e.headers}:{type:"data",data:r,statusCode:e.status,headers:e.headers}}return n==="error"?tk(e)?e.data instanceof Error?{type:"error",error:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:$ee(e),statusCode:ex(e)?e.status:void 0,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:e,statusCode:ex(e)?e.status:void 0}:tk(e)?{type:"data",data:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function Nee(t,e,n,r,a){let l=t.headers.get("Location");if(Or(l,"Redirects returned/thrown from loaders/actions must have a Location header"),!vI(l)){let u=r.slice(0,r.findIndex(s=>s.route.id===n)+1);l=nP(new URL(e.url),u,a,l),t.headers.set("Location",l)}return t}function YL(t,e,n,r){let a=["about:","blob:","chrome:","chrome-untrusted:","content:","data:","devtools:","file:","filesystem:","javascript:"];if(vI(t)){let l=t,u=l.startsWith("//")?new URL(e.protocol+l):new URL(l);if(a.includes(u.protocol))throw new Error("Invalid redirect location");let s=ru(u.pathname,n)!=null;if(u.origin===e.origin&&s)return u.pathname+u.search+u.hash}try{let l=r.createURL(t);if(a.includes(l.protocol))throw new Error("Invalid redirect location")}catch{}return t}function Yv(t,e,n,r){let a=t.createURL(WB(e)).toString(),l={signal:n};if(r&&ba(r.formMethod)){let{formMethod:u,formEncType:s}=r;l.method=u.toUpperCase(),s==="application/json"?(l.headers=new Headers({"Content-Type":s}),l.body=JSON.stringify(r.json)):s==="text/plain"?l.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?l.body=oP(r.formData):l.body=r.formData}return new Request(a,l)}function oP(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function KL(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function Bee(t,e,n,r=!1,a=!1){let l={},u=null,s,m=!1,_={},b=n&&oc(n[1])?n[1].error:void 0;return t.forEach(M=>{if(!(M.route.id in e))return;let C=M.route.id,A=e[C];if(Or(!wg(A),"Cannot handle redirect results in processLoaderData"),oc(A)){let k=A.error;if(b!==void 0&&(k=b,b=void 0),u=u||{},a)u[C]=k;else{let z=Np(t,C);u[z.route.id]==null&&(u[z.route.id]=k)}r||(l[C]=UB),m||(m=!0,s=ex(A.error)?A.error.status:500),A.headers&&(_[C]=A.headers)}else l[C]=A.data,A.statusCode&&A.statusCode!==200&&!m&&(s=A.statusCode),A.headers&&(_[C]=A.headers)}),b!==void 0&&n&&(u={[n[0]]:b},n[2]&&(l[n[2]]=void 0)),{loaderData:l,errors:u,statusCode:s||200,loaderHeaders:_}}function JL(t,e,n,r,a,l){let{loaderData:u,errors:s}=Bee(e,n,r);return a.filter(m=>!m.matches||m.matches.some(_=>_.shouldLoad)).forEach(m=>{let{key:_,match:b,controller:M}=m;if(M&&M.signal.aborted)return;let C=l[_];if(Or(C,"Did not find corresponding fetcher result"),oc(C)){let A=Np(t.matches,b?.route.id);s&&s[A.route.id]||(s={...s,[A.route.id]:C.error}),t.fetchers.delete(_)}else if(wg(C))Or(!1,"Unhandled fetcher revalidation redirect");else{let A=rf(C.data);t.fetchers.set(_,A)}}),{loaderData:u,errors:s}}function QL(t,e,n,r){let a=Object.entries(e).filter(([,l])=>l!==UB).reduce((l,[u,s])=>(l[u]=s,l),{});for(let l of n){let u=l.route.id;if(!e.hasOwnProperty(u)&&t.hasOwnProperty(u)&&l.route.loader&&(a[u]=t[u]),r&&r.hasOwnProperty(u))break}return a}function ek(t){return t?oc(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Np(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function Q1(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Yc(t,{pathname:e,routeId:n,method:r,type:a,message:l}={}){let u="Unknown Server Error",s="Unknown @remix-run/router error";return t===400?(u="Bad Request",r&&e&&n?s=`You made a ${r} request to "${e}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):t===403?(u="Forbidden",s=`Route "${n}" does not match URL "${e}"`):t===404?(u="Not Found",s=`No route matches URL "${e}"`):t===405&&(u="Method Not Allowed",r&&e&&n?s=`You made a ${r.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Ix(t||500,u,new Error(s),!0)}function eb(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,a]=e[n];if(wg(a))return{key:r,result:a}}}function WB(t){let e=typeof t=="string"?lm(t):t;return ad({...e,hash:""})}function Uee(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function $ee(t){return new Ix(t.init?.status??500,t.init?.statusText??"Internal Server Error",t.data)}function Vee(t){return t!=null&&typeof t=="object"&&Object.entries(t).every(([e,n])=>typeof e=="string"&&jee(n))}function jee(t){return t!=null&&typeof t=="object"&&"type"in t&&"result"in t&&(t.type==="data"||t.type==="error")}function Hee(t){return bI(t.result)&&NB.has(t.result.status)}function oc(t){return t.type==="error"}function wg(t){return(t&&t.type)==="redirect"}function tk(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function bI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function Gee(t){return NB.has(t)}function Wee(t){return bI(t)&&Gee(t.status)&&t.headers.has("Location")}function qee(t){return See.has(t.toUpperCase())}function ba(t){return bee.has(t.toUpperCase())}function wI(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Zb(t,e){let n=typeof e=="string"?lm(e).search:e.search;if(t[t.length-1].route.index&&wI(n||""))return t[t.length-1];let r=LB(t);return r[r.length-1]}function nk(t){let{formMethod:e,formAction:n,formEncType:r,text:a,formData:l,json:u}=t;if(!(!e||!n||!r)){if(a!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(l!=null)return{formMethod:e,formAction:n,formEncType:r,formData:l,json:void 0,text:void 0};if(u!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:u,text:void 0}}}function CM(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Xee(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function V0(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function Zee(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function rf(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Yee(t,e){try{let n=t.sessionStorage.getItem(BB);if(n){let r=JSON.parse(n);for(let[a,l]of Object.entries(r||{}))l&&Array.isArray(l)&&e.set(a,new Set(l||[]))}}catch{}}function Kee(t,e){if(e.size>0){let n={};for(let[r,a]of e)n[r]=[...a];try{t.sessionStorage.setItem(BB,JSON.stringify(n))}catch(r){Vo(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function rk(){let t,e,n=new Promise((r,a)=>{t=async l=>{r(l);try{await n}catch{}},e=async l=>{a(l);try{await n}catch{}}});return{promise:n,resolve:t,reject:e}}var Bg=q.createContext(null);Bg.displayName="DataRouter";var Dx=q.createContext(null);Dx.displayName="DataRouterState";var qB=q.createContext(!1);function Jee(){return q.useContext(qB)}var SI=q.createContext({isTransitioning:!1});SI.displayName="ViewTransition";var XB=q.createContext(new Map);XB.displayName="Fetchers";var Qee=q.createContext(null);Qee.displayName="Await";var ou=q.createContext(null);ou.displayName="Navigation";var FS=q.createContext(null);FS.displayName="Location";var xf=q.createContext({outlet:null,matches:[],isDataRoute:!1});xf.displayName="Route";var MI=q.createContext(null);MI.displayName="RouteError";var ZB="REACT_ROUTER_ERROR",ete="REDIRECT",tte="ROUTE_ERROR_RESPONSE";function nte(t){if(t.startsWith(`${ZB}:${ete}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function rte(t){if(t.startsWith(`${ZB}:${tte}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Ix(e.status,e.statusText,e.data)}catch{}}function ite(t,{relative:e}={}){Or(Lx(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=q.useContext(ou),{hash:a,pathname:l,search:u}=kx(t,{relative:e}),s=l;return n!=="/"&&(s=l==="/"?n:nd([n,l])),r.createHref({pathname:s,search:u,hash:a})}function Lx(){return q.useContext(FS)!=null}function cm(){return Or(Lx(),"useLocation() may be used only in the context of a <Router> component."),q.useContext(FS).location}var YB="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function KB(t){q.useContext(ou).static||q.useLayoutEffect(t)}function JB(){let{isDataRoute:t}=q.useContext(xf);return t?vte():ote()}function ote(){Or(Lx(),"useNavigate() may be used only in the context of a <Router> component.");let t=q.useContext(Bg),{basename:e,navigator:n}=q.useContext(ou),{matches:r}=q.useContext(xf),{pathname:a}=cm(),l=JSON.stringify(yI(r)),u=q.useRef(!1);return KB(()=>{u.current=!0}),q.useCallback((m,_={})=>{if(Vo(u.current,YB),!u.current)return;if(typeof m=="number"){n.go(m);return}let b=_I(m,JSON.parse(l),a,_.relative==="path");t==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:nd([e,b.pathname])),(_.replace?n.replace:n.push)(b,_.state,_)},[e,n,l,a,t])}q.createContext(null);function kx(t,{relative:e}={}){let{matches:n}=q.useContext(xf),{pathname:r}=cm(),a=JSON.stringify(yI(n));return q.useMemo(()=>_I(t,JSON.parse(a),r,e==="path"),[t,a,r,e])}function ste(t,e,n,r,a){Or(Lx(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=q.useContext(ou),{matches:u}=q.useContext(xf),s=u[u.length-1],m=s?s.params:{},_=s?s.pathname:"/",b=s?s.pathnameBase:"/",M=s&&s.route;{let j=M&&M.path||"";e6(_,!M||j.endsWith("*")||j.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${j}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${j}"> to <Route path="${j==="/"?"*":`${j}/*`}">.`)}let C=cm(),A;A=C;let k=A.pathname||"/",z=k;if(b!=="/"){let j=b.replace(/^\//,"").split("/");z="/"+k.replace(/^\//,"").split("/").slice(j.length).join("/")}let P=Fp(t,{pathname:z});return Vo(M||P!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),Vo(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),hte(P&&P.map(j=>Object.assign({},j,{params:Object.assign({},m,j.params),pathname:nd([b,l.encodeLocation?l.encodeLocation(j.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?b:nd([b,l.encodeLocation?l.encodeLocation(j.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:j.pathnameBase])})),u,n,r,a)}function ate(){let t=gte(),e=ex(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=q.createElement(q.Fragment,null,q.createElement("p",null," Hey developer "),q.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",q.createElement("code",{style:l},"ErrorBoundary")," or"," ",q.createElement("code",{style:l},"errorElement")," prop on your route.")),q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),n?q.createElement("pre",{style:a},n):null,u)}var lte=q.createElement(ate,null),QB=class extends q.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=rte(t.digest);n&&(t=n)}let e=t!==void 0?q.createElement(xf.Provider,{value:this.props.routeContext},q.createElement(MI.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?q.createElement(cte,{error:t},e):e}};QB.contextType=qB;var TM=new WeakMap;function cte({children:t,error:e}){let{basename:n}=q.useContext(ou);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=nte(e.digest);if(r){let a=TM.get(e);if(a)throw a;let l=zB(r.location,n);if(kB&&!TM.get(e))if(l.isExternal||r.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:r.replace}));throw TM.set(e,u),u}return q.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function ute({routeContext:t,match:e,children:n}){let r=q.useContext(Bg);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),q.createElement(xf.Provider,{value:t},n)}function hte(t,e=[],n=null,r=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,u=n?.errors;if(u!=null){let b=l.findIndex(M=>M.route.id&&u?.[M.route.id]!==void 0);Or(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),l=l.slice(0,Math.min(l.length,b+1))}let s=!1,m=-1;if(n)for(let b=0;b<l.length;b++){let M=l[b];if((M.route.HydrateFallback||M.route.hydrateFallbackElement)&&(m=b),M.route.id){let{loaderData:C,errors:A}=n,k=M.route.loader&&!C.hasOwnProperty(M.route.id)&&(!A||A[M.route.id]===void 0);if(M.route.lazy||k){s=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}let _=n&&r?(b,M)=>{r(b,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:Rx(n.matches),errorInfo:M})}:void 0;return l.reduceRight((b,M,C)=>{let A,k=!1,z=null,P=null;n&&(A=u&&M.route.id?u[M.route.id]:void 0,z=M.route.errorElement||lte,s&&(m<0&&C===0?(e6("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,P=null):m===C&&(k=!0,P=M.route.hydrateFallbackElement||null)));let O=e.concat(l.slice(0,C+1)),j=()=>{let U;return A?U=z:k?U=P:M.route.Component?U=q.createElement(M.route.Component,null):M.route.element?U=M.route.element:U=b,q.createElement(ute,{match:M,routeContext:{outlet:b,matches:O,isDataRoute:n!=null},children:U})};return n&&(M.route.ErrorBoundary||M.route.errorElement||C===0)?q.createElement(QB,{location:n.location,revalidation:n.revalidation,component:z,error:A,children:j(),routeContext:{outlet:null,matches:O,isDataRoute:!0},onError:_}):j()},null)}function EI(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dte(t){let e=q.useContext(Bg);return Or(e,EI(t)),e}function fte(t){let e=q.useContext(Dx);return Or(e,EI(t)),e}function pte(t){let e=q.useContext(xf);return Or(e,EI(t)),e}function CI(t){let e=pte(t),n=e.matches[e.matches.length-1];return Or(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function mte(){return CI("useRouteId")}function gte(){let t=q.useContext(MI),e=fte("useRouteError"),n=CI("useRouteError");return t!==void 0?t:e.errors?.[n]}function vte(){let{router:t}=dte("useNavigate"),e=CI("useNavigate"),n=q.useRef(!1);return KB(()=>{n.current=!0}),q.useCallback(async(a,l={})=>{Vo(n.current,YB),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var ik={};function e6(t,e,n){!e&&!ik[t]&&(ik[t]=!0,Vo(!1,n))}var ok={};function sk(t,e){!t&&!ok[e]&&(ok[e]=!0,console.warn(e))}var yte="useOptimistic",ak=mw[yte],_te=()=>{};function xte(t){return ak?ak(t):[t,_te]}function bte(t){let e={hasErrorBoundary:t.hasErrorBoundary||t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&(t.element&&Vo(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:q.createElement(t.Component),Component:void 0})),t.HydrateFallback&&(t.hydrateFallbackElement&&Vo(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:q.createElement(t.HydrateFallback),HydrateFallback:void 0})),t.ErrorBoundary&&(t.errorElement&&Vo(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:q.createElement(t.ErrorBoundary),ErrorBoundary:void 0})),e}var wte=["HydrateFallback","hydrateFallbackElement"],Ste=class{constructor(){this.status="pending",this.promise=new Promise((t,e)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",e(n))}})}};function Mte({router:t,flushSync:e,onError:n,unstable_useTransitions:r}){r=Jee()||r;let[l,u]=q.useState(t.state),[s,m]=xte(l),[_,b]=q.useState(),[M,C]=q.useState({isTransitioning:!1}),[A,k]=q.useState(),[z,P]=q.useState(),[O,j]=q.useState(),U=q.useRef(new Map),X=q.useCallback((ue,{deletedFetchers:ne,newErrors:H,flushSync:de,viewTransitionOpts:Ee})=>{H&&n&&Object.values(H).forEach(Ze=>n(Ze,{location:ue.location,params:ue.matches[0]?.params??{},unstable_pattern:Rx(ue.matches)})),ue.fetchers.forEach((Ze,ke)=>{Ze.data!==void 0&&U.current.set(ke,Ze.data)}),ne.forEach(Ze=>U.current.delete(Ze)),sk(de===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let Pe=t.window!=null&&t.window.document!=null&&typeof t.window.document.startViewTransition=="function";if(sk(Ee==null||Pe,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!Ee||!Pe){e&&de?e(()=>u(ue)):r===!1?u(ue):q.startTransition(()=>{r===!0&&m(Ze=>lk(Ze,ue)),u(ue)});return}if(e&&de){e(()=>{z&&(A?.resolve(),z.skipTransition()),C({isTransitioning:!0,flushSync:!0,currentLocation:Ee.currentLocation,nextLocation:Ee.nextLocation})});let Ze=t.window.document.startViewTransition(()=>{e(()=>u(ue))});Ze.finished.finally(()=>{e(()=>{k(void 0),P(void 0),b(void 0),C({isTransitioning:!1})})}),e(()=>P(Ze));return}z?(A?.resolve(),z.skipTransition(),j({state:ue,currentLocation:Ee.currentLocation,nextLocation:Ee.nextLocation})):(b(ue),C({isTransitioning:!0,flushSync:!1,currentLocation:Ee.currentLocation,nextLocation:Ee.nextLocation}))},[t.window,e,z,A,r,m,n]);q.useLayoutEffect(()=>t.subscribe(X),[t,X]),q.useEffect(()=>{M.isTransitioning&&!M.flushSync&&k(new Ste)},[M]),q.useEffect(()=>{if(A&&_&&t.window){let ue=_,ne=A.promise,H=t.window.document.startViewTransition(async()=>{r===!1?u(ue):q.startTransition(()=>{r===!0&&m(de=>lk(de,ue)),u(ue)}),await ne});H.finished.finally(()=>{k(void 0),P(void 0),b(void 0),C({isTransitioning:!1})}),P(H)}},[_,A,t.window,r,m]),q.useEffect(()=>{A&&_&&s.location.key===_.location.key&&A.resolve()},[A,z,s.location,_]),q.useEffect(()=>{!M.isTransitioning&&O&&(b(O.state),C({isTransitioning:!0,flushSync:!1,currentLocation:O.currentLocation,nextLocation:O.nextLocation}),j(void 0))},[M.isTransitioning,O]);let K=q.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:ue=>t.navigate(ue),push:(ue,ne,H)=>t.navigate(ue,{state:ne,preventScrollReset:H?.preventScrollReset}),replace:(ue,ne,H)=>t.navigate(ue,{replace:!0,state:ne,preventScrollReset:H?.preventScrollReset})}),[t]),se=t.basename||"/",J=q.useMemo(()=>({router:t,navigator:K,static:!1,basename:se,onError:n}),[t,K,se,n]);return q.createElement(q.Fragment,null,q.createElement(Bg.Provider,{value:J},q.createElement(Dx.Provider,{value:s},q.createElement(XB.Provider,{value:U.current},q.createElement(SI.Provider,{value:M},q.createElement(Tte,{basename:se,location:s.location,navigationType:s.historyAction,navigator:K,unstable_useTransitions:r},q.createElement(Ete,{routes:t.routes,future:t.future,state:s,onError:n})))))),null)}function lk(t,e){return{...t,navigation:e.navigation.state!=="idle"?e.navigation:t.navigation,revalidation:e.revalidation!=="idle"?e.revalidation:t.revalidation,actionData:e.navigation.state!=="submitting"?e.actionData:t.actionData,fetchers:e.fetchers}}var Ete=q.memo(Cte);function Cte({routes:t,future:e,state:n,onError:r}){return ste(t,void 0,n,r,e)}function o_(t){Or(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Tte({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:a,static:l=!1,unstable_useTransitions:u}){Or(!Lx(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=t.replace(/^\/*/,"/"),m=q.useMemo(()=>({basename:s,navigator:a,static:l,unstable_useTransitions:u,future:{}}),[s,a,l,u]);typeof n=="string"&&(n=lm(n));let{pathname:_="/",search:b="",hash:M="",state:C=null,key:A="default"}=n,k=q.useMemo(()=>{let z=ru(_,s);return z==null?null:{location:{pathname:z,search:b,hash:M,state:C,key:A},navigationType:r}},[s,_,b,M,C,A,r]);return Vo(k!=null,`<Router basename="${s}"> is not able to match the URL "${_}${b}${M}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:q.createElement(ou.Provider,{value:m},q.createElement(FS.Provider,{children:e,value:k}))}function sP(t,e=[]){let n=[];return q.Children.forEach(t,(r,a)=>{if(!q.isValidElement(r))return;let l=[...e,a];if(r.type===q.Fragment){n.push.apply(n,sP(r.props.children,l));return}Or(r.type===o_,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Or(!r.props.index||!r.props.children,"An index route cannot have child routes.");let u={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=sP(r.props.children,l)),n.push(u)}),n}var Pte=sP,Yb="get",Kb="application/x-www-form-urlencoded";function NS(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function Ate(t){return NS(t)&&t.tagName.toLowerCase()==="button"}function Ite(t){return NS(t)&&t.tagName.toLowerCase()==="form"}function Rte(t){return NS(t)&&t.tagName.toLowerCase()==="input"}function Dte(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Lte(t,e){return t.button===0&&(!e||e==="_self")&&!Dte(t)}function aP(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function kte(t,e){let n=aP(t);return e&&e.forEach((r,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var tb=null;function zte(){if(tb===null)try{new FormData(document.createElement("form"),0),tb=!1}catch{tb=!0}return tb}var Ote=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function PM(t){return t!=null&&!Ote.has(t)?(Vo(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Kb}"`),null):t}function Fte(t,e){let n,r,a,l,u;if(Ite(t)){let s=t.getAttribute("action");r=s?ru(s,e):null,n=t.getAttribute("method")||Yb,a=PM(t.getAttribute("enctype"))||Kb,l=new FormData(t)}else if(Ate(t)||Rte(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=t.getAttribute("formaction")||s.getAttribute("action");if(r=m?ru(m,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||Yb,a=PM(t.getAttribute("formenctype"))||PM(s.getAttribute("enctype"))||Kb,l=new FormData(s,t),!zte()){let{name:_,type:b,value:M}=t;if(b==="image"){let C=_?`${_}.`:"";l.append(`${C}x`,"0"),l.append(`${C}y`,"0")}else _&&l.append(_,M)}}else{if(NS(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Yb,r=null,a=Kb,u=t}return l&&a==="text/plain"&&(u=l,l=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function TI(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Nte(t,e,n,r){let a=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${r}`:a.pathname=`${a.pathname}.${r}`:a.pathname==="/"?a.pathname=`_root.${r}`:e&&ru(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${r}`,a}async function Bte(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ute(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function $te(t,e,n){let r=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let u=await Bte(l,n);return u.links?u.links():[]}return[]}));return Gte(r.flat(1).filter(Ute).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function ck(t,e,n,r,a,l){let u=(m,_)=>n[_]?m.route.id!==n[_].route.id:!0,s=(m,_)=>n[_].pathname!==m.pathname||n[_].route.path?.endsWith("*")&&n[_].params["*"]!==m.params["*"];return l==="assets"?e.filter((m,_)=>u(m,_)||s(m,_)):l==="data"?e.filter((m,_)=>{let b=r.routes[m.route.id];if(!b||!b.hasLoader)return!1;if(u(m,_)||s(m,_))return!0;if(m.route.shouldRevalidate){let M=m.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof M=="boolean")return M}return!0}):[]}function Vte(t,e,{includeHydrateFallback:n}={}){return jte(t.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function jte(t){return[...new Set(t)]}function Hte(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function Gte(t,e){let n=new Set;return new Set(e),t.reduce((r,a)=>{let l=JSON.stringify(Hte(a));return n.has(l)||(n.add(l),r.push({key:l,link:a})),r},[])}function t6(){let t=q.useContext(Bg);return TI(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Wte(){let t=q.useContext(Dx);return TI(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var PI=q.createContext(void 0);PI.displayName="FrameworkContext";function n6(){let t=q.useContext(PI);return TI(t,"You must render this element inside a <HydratedRouter> element"),t}function qte(t,e){let n=q.useContext(PI),[r,a]=q.useState(!1),[l,u]=q.useState(!1),{onFocus:s,onBlur:m,onMouseEnter:_,onMouseLeave:b,onTouchStart:M}=e,C=q.useRef(null);q.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let z=O=>{O.forEach(j=>{u(j.isIntersecting)})},P=new IntersectionObserver(z,{threshold:.5});return C.current&&P.observe(C.current),()=>{P.disconnect()}}},[t]),q.useEffect(()=>{if(r){let z=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(z)}}},[r]);let A=()=>{a(!0)},k=()=>{a(!1),u(!1)};return n?t!=="intent"?[l,C,{}]:[l,C,{onFocus:j0(s,A),onBlur:j0(m,k),onMouseEnter:j0(_,A),onMouseLeave:j0(b,k),onTouchStart:j0(M,A)}]:[!1,C,{}]}function j0(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Xte({page:t,...e}){let{router:n}=t6(),r=q.useMemo(()=>Fp(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?q.createElement(Yte,{page:t,matches:r,...e}):null}function Zte(t){let{manifest:e,routeModules:n}=n6(),[r,a]=q.useState([]);return q.useEffect(()=>{let l=!1;return $te(t,e,n).then(u=>{l||a(u)}),()=>{l=!0}},[t,e,n]),r}function Yte({page:t,matches:e,...n}){let r=cm(),{future:a,manifest:l,routeModules:u}=n6(),{basename:s}=t6(),{loaderData:m,matches:_}=Wte(),b=q.useMemo(()=>ck(t,e,_,l,r,"data"),[t,e,_,l,r]),M=q.useMemo(()=>ck(t,e,_,l,r,"assets"),[t,e,_,l,r]),C=q.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let z=new Set,P=!1;if(e.forEach(j=>{let U=l.routes[j.route.id];!U||!U.hasLoader||(!b.some(X=>X.route.id===j.route.id)&&j.route.id in m&&u[j.route.id]?.shouldRevalidate||U.hasClientLoader?P=!0:z.add(j.route.id))}),z.size===0)return[];let O=Nte(t,s,a.unstable_trailingSlashAwareDataRequests,"data");return P&&z.size>0&&O.searchParams.set("_routes",e.filter(j=>z.has(j.route.id)).map(j=>j.route.id).join(",")),[O.pathname+O.search]},[s,a.unstable_trailingSlashAwareDataRequests,m,r,l,b,e,t,u]),A=q.useMemo(()=>Vte(M,l),[M,l]),k=Zte(M);return q.createElement(q.Fragment,null,C.map(z=>q.createElement("link",{key:z,rel:"prefetch",as:"fetch",href:z,...n})),A.map(z=>q.createElement("link",{key:z,rel:"modulepreload",href:z,...n})),k.map(({key:z,link:P})=>q.createElement("link",{key:z,nonce:n.nonce,...P,crossOrigin:P.crossOrigin??n.crossOrigin})))}function Kte(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Jte=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Jte&&(window.__reactRouterVersion="7.13.0")}catch{}function Qte(t,e){return Tee({basename:e?.basename,getContext:e?.getContext,future:e?.future,history:jQ({window:e?.window}),hydrationData:e?.hydrationData||ene(),routes:t,mapRouteProperties:bte,hydrationRouteProperties:wte,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window,unstable_instrumentations:e?.unstable_instrumentations}).initialize()}function ene(){let t=window?.__staticRouterHydrationData;return t&&t.errors&&(t={...t,errors:tne(t.errors)}),t}function tne(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,a]of e)if(a&&a.__type==="RouteErrorResponse")n[r]=new Ix(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let l=window[a.__subType];if(typeof l=="function")try{let u=new l(a.message);u.stack="",n[r]=u}catch{}}if(n[r]==null){let l=new Error(a.message);l.stack="",n[r]=l}}else n[r]=a;return n}var r6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,i6=q.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:a,reloadDocument:l,replace:u,state:s,target:m,to:_,preventScrollReset:b,viewTransition:M,unstable_defaultShouldRevalidate:C,...A},k){let{basename:z,unstable_useTransitions:P}=q.useContext(ou),O=typeof _=="string"&&r6.test(_),j=zB(_,z);_=j.to;let U=ite(_,{relative:a}),[X,K,se]=qte(r,A),J=one(_,{replace:u,state:s,target:m,preventScrollReset:b,relative:a,viewTransition:M,unstable_defaultShouldRevalidate:C,unstable_useTransitions:P});function ue(H){e&&e(H),H.defaultPrevented||J(H)}let ne=q.createElement("a",{...A,...se,href:j.absoluteURL||U,onClick:j.isExternal||l?e:ue,ref:Kte(k,K),target:m,"data-discover":!O&&n==="render"?"true":void 0});return X&&!O?q.createElement(q.Fragment,null,ne,q.createElement(Xte,{page:U})):ne});i6.displayName="Link";var nne=q.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:a=!1,style:l,to:u,viewTransition:s,children:m,..._},b){let M=kx(u,{relative:_.relative}),C=cm(),A=q.useContext(Dx),{navigator:k,basename:z}=q.useContext(ou),P=A!=null&&hne(M)&&s===!0,O=k.encodeLocation?k.encodeLocation(M).pathname:M.pathname,j=C.pathname,U=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;n||(j=j.toLowerCase(),U=U?U.toLowerCase():null,O=O.toLowerCase()),U&&z&&(U=ru(U,z)||U);const X=O!=="/"&&O.endsWith("/")?O.length-1:O.length;let K=j===O||!a&&j.startsWith(O)&&j.charAt(X)==="/",se=U!=null&&(U===O||!a&&U.startsWith(O)&&U.charAt(O.length)==="/"),J={isActive:K,isPending:se,isTransitioning:P},ue=K?e:void 0,ne;typeof r=="function"?ne=r(J):ne=[r,K?"active":null,se?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let H=typeof l=="function"?l(J):l;return q.createElement(i6,{..._,"aria-current":ue,className:ne,ref:b,style:H,to:u,viewTransition:s},typeof m=="function"?m(J):m)});nne.displayName="NavLink";var rne=q.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:a,state:l,method:u=Yb,action:s,onSubmit:m,relative:_,preventScrollReset:b,viewTransition:M,unstable_defaultShouldRevalidate:C,...A},k)=>{let{unstable_useTransitions:z}=q.useContext(ou),P=cne(),O=une(s,{relative:_}),j=u.toLowerCase()==="get"?"get":"post",U=typeof s=="string"&&r6.test(s),X=K=>{if(m&&m(K),K.defaultPrevented)return;K.preventDefault();let se=K.nativeEvent.submitter,J=se?.getAttribute("formmethod")||u,ue=()=>P(se||K.currentTarget,{fetcherKey:e,method:J,navigate:n,replace:a,state:l,relative:_,preventScrollReset:b,viewTransition:M,unstable_defaultShouldRevalidate:C});z&&n!==!1?q.startTransition(()=>ue()):ue()};return q.createElement("form",{ref:k,method:j,action:O,onSubmit:r?m:X,...A,"data-discover":!U&&t==="render"?"true":void 0})});rne.displayName="Form";function ine(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function o6(t){let e=q.useContext(Bg);return Or(e,ine(t)),e}function one(t,{target:e,replace:n,state:r,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:s,unstable_useTransitions:m}={}){let _=JB(),b=cm(),M=kx(t,{relative:l});return q.useCallback(C=>{if(Lte(C,e)){C.preventDefault();let A=n!==void 0?n:ad(b)===ad(M),k=()=>_(t,{replace:A,state:r,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:s});m?q.startTransition(()=>k()):k()}},[b,_,M,n,r,e,t,a,l,u,s,m])}function sne(t){Vo(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=q.useRef(aP(t)),n=q.useRef(!1),r=cm(),a=q.useMemo(()=>kte(r.search,n.current?null:e.current),[r.search]),l=JB(),u=q.useCallback((s,m)=>{const _=aP(typeof s=="function"?s(new URLSearchParams(a)):s);n.current=!0,l("?"+_,m)},[l,a]);return[a,u]}var ane=0,lne=()=>`__${String(++ane)}__`;function cne(){let{router:t}=o6("useSubmit"),{basename:e}=q.useContext(ou),n=mte(),r=t.fetch,a=t.navigate;return q.useCallback(async(l,u={})=>{let{action:s,method:m,encType:_,formData:b,body:M}=Fte(l,e);if(u.navigate===!1){let C=u.fetcherKey||lne();await r(C,n,u.action||s,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:M,formMethod:u.method||m,formEncType:u.encType||_,flushSync:u.flushSync})}else await a(u.action||s,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:M,formMethod:u.method||m,formEncType:u.encType||_,replace:u.replace,state:u.state,fromRouteId:n,flushSync:u.flushSync,viewTransition:u.viewTransition})},[r,a,e,n])}function une(t,{relative:e}={}){let{basename:n}=q.useContext(ou),r=q.useContext(xf);Or(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),l={...kx(t||".",{relative:e})},u=cm();if(t==null){l.search=u.search;let s=new URLSearchParams(l.search),m=s.getAll("index");if(m.some(b=>b==="")){s.delete("index"),m.filter(M=>M).forEach(M=>s.append("index",M));let b=s.toString();l.search=b?`?${b}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:nd([n,l.pathname])),ad(l)}function hne(t,{relative:e}={}){let n=q.useContext(SI);Or(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=o6("useViewTransitionState"),a=kx(t,{relative:e});if(!n.isTransitioning)return!1;let l=ru(n.currentLocation.pathname,r)||n.currentLocation.pathname,u=ru(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Ew(a.pathname,u)!=null||Ew(a.pathname,l)!=null}function dne(t){return q.createElement(Mte,{flushSync:ES.flushSync,...t})}const uk=t=>t,fne=()=>{let t=uk;return{configure(e){t=e},generate(e){return t(e)},reset(){t=uk}}},pne=fne();function Ig(t,...e){const n=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(r=>n.searchParams.append("args[]",r)),`Minified MUI error #${t}; visit ${n} for the full message.`}function zy(t){if(typeof t!="string")throw new Error(Ig(7));return t.charAt(0).toUpperCase()+t.slice(1)}function mne(t,e,n=void 0){const r={};for(const a in t){const l=t[a];let u="",s=!0;for(let m=0;m<l.length;m+=1){const _=l[m];_&&(u+=(s===!0?"":" ")+e(_),s=!1,n&&n[_]&&(u+=" "+n[_]))}r[a]=u}return r}var AM={exports:{}},Oi={};var hk;function gne(){if(hk)return Oi;hk=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),C=Symbol.for("react.view_transition"),A=Symbol.for("react.client.reference");function k(z){if(typeof z=="object"&&z!==null){var P=z.$$typeof;switch(P){case t:switch(z=z.type,z){case n:case a:case r:case m:case _:case C:return z;default:switch(z=z&&z.$$typeof,z){case u:case s:case M:case b:return z;case l:return z;default:return P}}case e:return P}}}return Oi.ContextConsumer=l,Oi.ContextProvider=u,Oi.Element=t,Oi.ForwardRef=s,Oi.Fragment=n,Oi.Lazy=M,Oi.Memo=b,Oi.Portal=e,Oi.Profiler=a,Oi.StrictMode=r,Oi.Suspense=m,Oi.SuspenseList=_,Oi.isContextConsumer=function(z){return k(z)===l},Oi.isContextProvider=function(z){return k(z)===u},Oi.isElement=function(z){return typeof z=="object"&&z!==null&&z.$$typeof===t},Oi.isForwardRef=function(z){return k(z)===s},Oi.isFragment=function(z){return k(z)===n},Oi.isLazy=function(z){return k(z)===M},Oi.isMemo=function(z){return k(z)===b},Oi.isPortal=function(z){return k(z)===e},Oi.isProfiler=function(z){return k(z)===a},Oi.isStrictMode=function(z){return k(z)===r},Oi.isSuspense=function(z){return k(z)===m},Oi.isSuspenseList=function(z){return k(z)===_},Oi.isValidElementType=function(z){return typeof z=="string"||typeof z=="function"||z===n||z===a||z===r||z===m||z===_||typeof z=="object"&&z!==null&&(z.$$typeof===M||z.$$typeof===b||z.$$typeof===u||z.$$typeof===l||z.$$typeof===s||z.$$typeof===A||z.getModuleId!==void 0)},Oi.typeOf=k,Oi}var dk;function vne(){return dk||(dk=1,AM.exports=gne()),AM.exports}var s6=vne();function sf(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function a6(t){if(q.isValidElement(t)||s6.isValidElementType(t)||!sf(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=a6(t[n])}),e}function mc(t,e,n={clone:!0}){const r=n.clone?{...t}:t;return sf(t)&&sf(e)&&Object.keys(e).forEach(a=>{q.isValidElement(e[a])||s6.isValidElementType(e[a])?r[a]=e[a]:sf(e[a])&&Object.prototype.hasOwnProperty.call(t,a)&&sf(t[a])?r[a]=mc(t[a],e[a],n):n.clone?r[a]=sf(e[a])?a6(e[a]):e[a]:r[a]=e[a]}),r}function x_(t,e){return e?mc(t,e,{clone:!1}):t}function fk(t,e){if(!t.containerQueries)return e;const n=Object.keys(e).filter(r=>r.startsWith("@container")).sort((r,a)=>{const l=/min-width:\s*([0-9.]+)/;return+(r.match(l)?.[1]||0)-+(a.match(l)?.[1]||0)});return n.length?n.reduce((r,a)=>{const l=e[a];return delete r[a],r[a]=l,r},{...e}):e}function yne(t,e){return e==="@"||e.startsWith("@")&&(t.some(n=>e.startsWith(`@${n}`))||!!e.match(/^@\d/))}function _ne(t,e){const n=e.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,a]=n,l=Number.isNaN(+r)?r||0:+r;return t.containerQueries(a).up(l)}function xne(t){const e=(l,u)=>l.replace("@media",u?`@container ${u}`:"@container");function n(l,u){l.up=(...s)=>e(t.breakpoints.up(...s),u),l.down=(...s)=>e(t.breakpoints.down(...s),u),l.between=(...s)=>e(t.breakpoints.between(...s),u),l.only=(...s)=>e(t.breakpoints.only(...s),u),l.not=(...s)=>{const m=e(t.breakpoints.not(...s),u);return m.includes("not all and")?m.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):m}}const r={},a=l=>(n(r,l),r);return n(a),{...t,containerQueries:a}}const BS={xs:0,sm:600,md:900,lg:1200,xl:1536},pk={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${BS[t]}px)`},bne={containerQueries:t=>({up:e=>{let n=typeof e=="number"?e:BS[e]||e;return typeof n=="number"&&(n=`${n}px`),t?`@container ${t} (min-width:${n})`:`@container (min-width:${n})`}})};function mf(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const l=r.breakpoints||pk;return e.reduce((u,s,m)=>(u[l.up(l.keys[m])]=n(e[m]),u),{})}if(typeof e=="object"){const l=r.breakpoints||pk;return Object.keys(e).reduce((u,s)=>{if(yne(l.keys,s)){const m=_ne(r.containerQueries?r:bne,s);m&&(u[m]=n(e[s],s))}else if(Object.keys(l.values||BS).includes(s)){const m=l.up(s);u[m]=n(e[s],s)}else{const m=s;u[m]=e[m]}return u},{})}return n(e)}function wne(t={}){return t.keys?.reduce((n,r)=>{const a=t.up(r);return n[a]={},n},{})||{}}function mk(t,e){return t.reduce((n,r)=>{const a=n[r];return(!a||Object.keys(a).length===0)&&delete n[r],n},e)}function US(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((a,l)=>a&&a[l]?a[l]:null,t);if(r!=null)return r}return e.split(".").reduce((r,a)=>r&&r[a]!=null?r[a]:null,t)}function Cw(t,e,n,r=n){let a;return typeof t=="function"?a=t(n):Array.isArray(t)?a=t[n]||r:a=US(t,n)||r,e&&(a=e(a,r,t)),a}function Ho(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:a}=t,l=u=>{if(u[e]==null)return null;const s=u[e],m=u.theme,_=US(m,r)||{};return mf(u,s,M=>{let C=Cw(_,a,M);return M===C&&typeof M=="string"&&(C=Cw(_,a,`${e}${M==="default"?"":zy(M)}`,M)),n===!1?C:{[n]:C}})};return l.propTypes={},l.filterProps=[e],l}function Sne(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const Mne={m:"margin",p:"padding"},Ene={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},gk={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Cne=Sne(t=>{if(t.length>2)if(gk[t])t=gk[t];else return[t];const[e,n]=t.split(""),r=Mne[e],a=Ene[n]||"";return Array.isArray(a)?a.map(l=>r+l):[r+a]}),AI=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],II=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...AI,...II];function zx(t,e,n,r){const a=US(t,e,!0)??n;return typeof a=="number"||typeof a=="string"?l=>typeof l=="string"?l:typeof a=="string"?a.startsWith("var(")&&l===0?0:a.startsWith("var(")&&l===1?a:`calc(${l} * ${a})`:a*l:Array.isArray(a)?l=>{if(typeof l=="string")return l;const u=Math.abs(l),s=a[u];return l>=0?s:typeof s=="number"?-s:typeof s=="string"&&s.startsWith("var(")?`calc(-1 * ${s})`:`-${s}`}:typeof a=="function"?a:()=>{}}function RI(t){return zx(t,"spacing",8)}function Ox(t,e){return typeof e=="string"||e==null?e:t(e)}function Tne(t,e){return n=>t.reduce((r,a)=>(r[a]=Ox(e,n),r),{})}function Pne(t,e,n,r){if(!e.includes(n))return null;const a=Cne(n),l=Tne(a,r),u=t[n];return mf(t,u,l)}function l6(t,e){const n=RI(t.theme);return Object.keys(t).map(r=>Pne(t,e,r,n)).reduce(x_,{})}function Lo(t){return l6(t,AI)}Lo.propTypes={};Lo.filterProps=AI;function ko(t){return l6(t,II)}ko.propTypes={};ko.filterProps=II;function $S(...t){const e=t.reduce((r,a)=>(a.filterProps.forEach(l=>{r[l]=a}),r),{}),n=r=>Object.keys(r).reduce((a,l)=>e[l]?x_(a,e[l](r)):a,{});return n.propTypes={},n.filterProps=t.reduce((r,a)=>r.concat(a.filterProps),[]),n}function Qc(t){return typeof t!="number"?t:`${t}px solid`}function su(t,e){return Ho({prop:t,themeKey:"borders",transform:e})}const Ane=su("border",Qc),Ine=su("borderTop",Qc),Rne=su("borderRight",Qc),Dne=su("borderBottom",Qc),Lne=su("borderLeft",Qc),kne=su("borderColor"),zne=su("borderTopColor"),One=su("borderRightColor"),Fne=su("borderBottomColor"),Nne=su("borderLeftColor"),Bne=su("outline",Qc),Une=su("outlineColor"),VS=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=zx(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Ox(e,r)});return mf(t,t.borderRadius,n)}return null};VS.propTypes={};VS.filterProps=["borderRadius"];$S(Ane,Ine,Rne,Dne,Lne,kne,zne,One,Fne,Nne,VS,Bne,Une);const jS=t=>{if(t.gap!==void 0&&t.gap!==null){const e=zx(t.theme,"spacing",8),n=r=>({gap:Ox(e,r)});return mf(t,t.gap,n)}return null};jS.propTypes={};jS.filterProps=["gap"];const HS=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=zx(t.theme,"spacing",8),n=r=>({columnGap:Ox(e,r)});return mf(t,t.columnGap,n)}return null};HS.propTypes={};HS.filterProps=["columnGap"];const GS=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=zx(t.theme,"spacing",8),n=r=>({rowGap:Ox(e,r)});return mf(t,t.rowGap,n)}return null};GS.propTypes={};GS.filterProps=["rowGap"];const $ne=Ho({prop:"gridColumn"}),Vne=Ho({prop:"gridRow"}),jne=Ho({prop:"gridAutoFlow"}),Hne=Ho({prop:"gridAutoColumns"}),Gne=Ho({prop:"gridAutoRows"}),Wne=Ho({prop:"gridTemplateColumns"}),qne=Ho({prop:"gridTemplateRows"}),Xne=Ho({prop:"gridTemplateAreas"}),Zne=Ho({prop:"gridArea"});$S(jS,HS,GS,$ne,Vne,jne,Hne,Gne,Wne,qne,Xne,Zne);function by(t,e){return e==="grey"?e:t}const Yne=Ho({prop:"color",themeKey:"palette",transform:by}),Kne=Ho({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:by}),Jne=Ho({prop:"backgroundColor",themeKey:"palette",transform:by});$S(Yne,Kne,Jne);function cc(t){return t<=1&&t!==0?`${t*100}%`:t}const Qne=Ho({prop:"width",transform:cc}),DI=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{const r=t.theme?.breakpoints?.values?.[n]||BS[n];return r?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${r}${t.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:cc(n)}};return mf(t,t.maxWidth,e)}return null};DI.filterProps=["maxWidth"];const ere=Ho({prop:"minWidth",transform:cc}),tre=Ho({prop:"height",transform:cc}),nre=Ho({prop:"maxHeight",transform:cc}),rre=Ho({prop:"minHeight",transform:cc});Ho({prop:"size",cssProperty:"width",transform:cc});Ho({prop:"size",cssProperty:"height",transform:cc});const ire=Ho({prop:"boxSizing"});$S(Qne,DI,ere,tre,nre,rre,ire);const WS={border:{themeKey:"borders",transform:Qc},borderTop:{themeKey:"borders",transform:Qc},borderRight:{themeKey:"borders",transform:Qc},borderBottom:{themeKey:"borders",transform:Qc},borderLeft:{themeKey:"borders",transform:Qc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Qc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:VS},color:{themeKey:"palette",transform:by},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:by},backgroundColor:{themeKey:"palette",transform:by},p:{style:ko},pt:{style:ko},pr:{style:ko},pb:{style:ko},pl:{style:ko},px:{style:ko},py:{style:ko},padding:{style:ko},paddingTop:{style:ko},paddingRight:{style:ko},paddingBottom:{style:ko},paddingLeft:{style:ko},paddingX:{style:ko},paddingY:{style:ko},paddingInline:{style:ko},paddingInlineStart:{style:ko},paddingInlineEnd:{style:ko},paddingBlock:{style:ko},paddingBlockStart:{style:ko},paddingBlockEnd:{style:ko},m:{style:Lo},mt:{style:Lo},mr:{style:Lo},mb:{style:Lo},ml:{style:Lo},mx:{style:Lo},my:{style:Lo},margin:{style:Lo},marginTop:{style:Lo},marginRight:{style:Lo},marginBottom:{style:Lo},marginLeft:{style:Lo},marginX:{style:Lo},marginY:{style:Lo},marginInline:{style:Lo},marginInlineStart:{style:Lo},marginInlineEnd:{style:Lo},marginBlock:{style:Lo},marginBlockStart:{style:Lo},marginBlockEnd:{style:Lo},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:jS},rowGap:{style:GS},columnGap:{style:HS},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:cc},maxWidth:{style:DI},minWidth:{transform:cc},height:{transform:cc},maxHeight:{transform:cc},minHeight:{transform:cc},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function ore(...t){const e=t.reduce((r,a)=>r.concat(Object.keys(a)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function sre(t,e){return typeof t=="function"?t(e):t}function are(){function t(n,r,a,l){const u={[n]:r,theme:a},s=l[n];if(!s)return{[n]:r};const{cssProperty:m=n,themeKey:_,transform:b,style:M}=s;if(r==null)return null;if(_==="typography"&&r==="inherit")return{[n]:r};const C=US(a,_)||{};return M?M(u):mf(u,r,k=>{let z=Cw(C,b,k);return k===z&&typeof k=="string"&&(z=Cw(C,b,`${n}${k==="default"?"":zy(k)}`,k)),m===!1?z:{[m]:z}})}function e(n){const{sx:r,theme:a={},nested:l}=n||{};if(!r)return null;const u=a.unstable_sxConfig??WS;function s(m){let _=m;if(typeof m=="function")_=m(a);else if(typeof m!="object")return m;if(!_)return null;const b=wne(a.breakpoints),M=Object.keys(b);let C=b;return Object.keys(_).forEach(A=>{const k=sre(_[A],a);if(k!=null)if(typeof k=="object")if(u[A])C=x_(C,t(A,k,a,u));else{const z=mf({theme:a},k,P=>({[A]:P}));ore(z,k)?C[A]=e({sx:k,theme:a,nested:!0}):C=x_(C,z)}else C=x_(C,t(A,k,a,u))}),!l&&a.modularCssLayers?{"@layer sx":fk(a,mk(M,C))}:fk(a,mk(M,C))}return Array.isArray(r)?r.map(s):s(r)}return e}const Oy=are();Oy.filterProps=["sx"];function lre(t,e){return vw(t,e)}function cre(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const vk=[];function Tg(t){return vk[0]=t,mx(vk)}const ure=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function hre(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...a}=t,l=ure(e),u=Object.keys(l);function s(C){return`@media (min-width:${typeof e[C]=="number"?e[C]:C}${n})`}function m(C){return`@media (max-width:${(typeof e[C]=="number"?e[C]:C)-r/100}${n})`}function _(C,A){const k=u.indexOf(A);return`@media (min-width:${typeof e[C]=="number"?e[C]:C}${n}) and (max-width:${(k!==-1&&typeof e[u[k]]=="number"?e[u[k]]:A)-r/100}${n})`}function b(C){return u.indexOf(C)+1<u.length?_(C,u[u.indexOf(C)+1]):s(C)}function M(C){const A=u.indexOf(C);return A===0?s(u[1]):A===u.length-1?m(u[A]):_(C,u[u.indexOf(C)+1]).replace("@media","@media not all and")}return{keys:u,values:l,up:s,down:m,between:_,only:b,not:M,unit:n,...a}}const dre={borderRadius:4};function c6(t=8,e=RI({spacing:t})){if(t.mui)return t;const n=(...r)=>(r.length===0?[1]:r).map(l=>{const u=e(l);return typeof u=="number"?`${u}px`:u}).join(" ");return n.mui=!0,n}function fre(t,e){const n=this;if(n.vars){if(!n.colorSchemes?.[t]||typeof n.getColorSchemeSelector!="function")return{};let r=n.getColorSchemeSelector(t);return r==="&"?e:((r.includes("data-")||r.includes("."))&&(r=`*:where(${r.replace(/\s*&$/,"")}) &`),{[r]:e})}return n.palette.mode===t?e:{}}function u6(t={},...e){const{breakpoints:n={},palette:r={},spacing:a,shape:l={},...u}=t,s=hre(n),m=c6(a);let _=mc({breakpoints:s,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:m,shape:{...dre,...l}},u);return _=xne(_),_.applyStyles=fre,_=e.reduce((b,M)=>mc(b,M),_),_.unstable_sxConfig={...WS,...u?.unstable_sxConfig},_.unstable_sx=function(M){return Oy({sx:M,theme:this})},_}const pre={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function h6(t,e,n="Mui"){const r=pre[e];return r?`${n}-${r}`:`${pne.generate(t)}-${e}`}function mre(t,e,n="Mui"){const r={};return e.forEach(a=>{r[a]=h6(t,a,n)}),r}function d6(t){const{variants:e,...n}=t,r={variants:e,style:Tg(n),isProcessed:!0};return r.style===n||e&&e.forEach(a=>{typeof a.style!="function"&&(a.style=Tg(a.style))}),r}const gre=u6();function IM(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Sg(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function vre(t){return t?(e,n)=>n[t]:null}function yre(t,e,n){t.theme=bre(t.theme)?n:t.theme[e]||t.theme}function Jb(t,e,n){const r=typeof e=="function"?e(t):e;if(Array.isArray(r))return r.flatMap(a=>Jb(t,a,n));if(Array.isArray(r?.variants)){let a;if(r.isProcessed)a=n?Sg(r.style,n):r.style;else{const{variants:l,...u}=r;a=n?Sg(Tg(u),n):u}return f6(t,r.variants,[a],n)}return r?.isProcessed?n?Sg(Tg(r.style),n):r.style:n?Sg(Tg(r),n):r}function f6(t,e,n=[],r=void 0){let a;e:for(let l=0;l<e.length;l+=1){const u=e[l];if(typeof u.props=="function"){if(a??={...t,...t.ownerState,ownerState:t.ownerState},!u.props(a))continue}else for(const s in u.props)if(t[s]!==u.props[s]&&t.ownerState?.[s]!==u.props[s])continue e;typeof u.style=="function"?(a??={...t,...t.ownerState,ownerState:t.ownerState},n.push(r?Sg(Tg(u.style(a)),r):u.style(a))):n.push(r?Sg(Tg(u.style),r):u.style)}return n}function _re(t={}){const{themeId:e,defaultTheme:n=gre,rootShouldForwardProp:r=IM,slotShouldForwardProp:a=IM}=t;function l(s){yre(s,e,n)}return(s,m={})=>{cre(s,se=>se.filter(J=>J!==Oy));const{name:_,slot:b,skipVariantsResolver:M,skipSx:C,overridesResolver:A=vre(Sre(b)),...k}=m,z=_&&_.startsWith("Mui")||b?"components":"custom",P=M!==void 0?M:b&&b!=="Root"&&b!=="root"||!1,O=C||!1;let j=IM;b==="Root"||b==="root"?j=r:b?j=a:wre(s)&&(j=void 0);const U=lre(s,{shouldForwardProp:j,label:xre(),...k}),X=se=>{if(se.__emotion_real===se)return se;if(typeof se=="function")return function(ue){return Jb(ue,se,ue.theme.modularCssLayers?z:void 0)};if(sf(se)){const J=d6(se);return function(ne){return J.variants?Jb(ne,J,ne.theme.modularCssLayers?z:void 0):ne.theme.modularCssLayers?Sg(J.style,z):J.style}}return se},K=(...se)=>{const J=[],ue=se.map(X),ne=[];if(J.push(l),_&&A&&ne.push(function(Pe){const ke=Pe.theme.components?.[_]?.styleOverrides;if(!ke)return null;const Te={};for(const Ie in ke)Te[Ie]=Jb(Pe,ke[Ie],Pe.theme.modularCssLayers?"theme":void 0);return A(Pe,Te)}),_&&!P&&ne.push(function(Pe){const ke=Pe.theme?.components?.[_]?.variants;return ke?f6(Pe,ke,[],Pe.theme.modularCssLayers?"theme":void 0):null}),O||ne.push(Oy),Array.isArray(ue[0])){const Ee=ue.shift(),Pe=new Array(J.length).fill(""),Ze=new Array(ne.length).fill("");let ke;ke=[...Pe,...Ee,...Ze],ke.raw=[...Pe,...Ee.raw,...Ze],J.unshift(ke)}const H=[...J,...ue,...ne],de=U(...H);return s.muiName&&(de.muiName=s.muiName),de};return U.withConfig&&(K.withConfig=U.withConfig),K}}function xre(t,e){return void 0}function bre(t){for(const e in t)return!1;return!0}function wre(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Sre(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function lP(t,e,n=!1){const r={...e};for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)){const l=a;if(l==="components"||l==="slots")r[l]={...t[l],...r[l]};else if(l==="componentsProps"||l==="slotProps"){const u=t[l],s=e[l];if(!s)r[l]=u||{};else if(!u)r[l]=s;else{r[l]={...s};for(const m in u)if(Object.prototype.hasOwnProperty.call(u,m)){const _=m;r[l][_]=lP(u[_],s[_],n)}}}else l==="className"&&n&&e.className?r.className=yo(t?.className,e?.className):l==="style"&&n&&e.style?r.style={...t?.style,...e?.style}:r[l]===void 0&&(r[l]=t[l])}return r}function Mre(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}function LI(t,e=0,n=1){return Mre(t,e,n)}function Ere(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,a)=>a<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Kp(t){if(t.type)return t;if(t.charAt(0)==="#")return Kp(Ere(t));const e=t.indexOf("("),n=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(Ig(9,t));let r=t.substring(e+1,t.length-1),a;if(n==="color"){if(r=r.split(" "),a=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(a))throw new Error(Ig(10,a))}else r=r.split(",");return r=r.map(l=>parseFloat(l)),{type:n,values:r,colorSpace:a}}const Cre=t=>{const e=Kp(t);return e.values.slice(0,3).map((n,r)=>e.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},s_=(t,e)=>{try{return Cre(t)}catch{return t}};function qS(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.includes("rgb")?r=r.map((a,l)=>l<3?parseInt(a,10):a):e.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function p6(t){t=Kp(t);const{values:e}=t,n=e[0],r=e[1]/100,a=e[2]/100,l=r*Math.min(a,1-a),u=(_,b=(_+n/30)%12)=>a-l*Math.max(Math.min(b-3,9-b,1),-1);let s="rgb";const m=[Math.round(u(0)*255),Math.round(u(8)*255),Math.round(u(4)*255)];return t.type==="hsla"&&(s+="a",m.push(e[3])),qS({type:s,values:m})}function cP(t){t=Kp(t);let e=t.type==="hsl"||t.type==="hsla"?Kp(p6(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Tre(t,e){const n=cP(t),r=cP(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Pre(t,e){return t=Kp(t),e=LI(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,qS(t)}function nb(t,e,n){try{return Pre(t,e)}catch{return t}}function kI(t,e){if(t=Kp(t),e=LI(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return qS(t)}function Hi(t,e,n){try{return kI(t,e)}catch{return t}}function zI(t,e){if(t=Kp(t),e=LI(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return qS(t)}function Gi(t,e,n){try{return zI(t,e)}catch{return t}}function Are(t,e=.15){return cP(t)>.5?kI(t,e):zI(t,e)}function rb(t,e,n){try{return Are(t,e)}catch{return t}}const Ire=q.createContext(void 0);function Rre(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const a=e.components[n];return a.defaultProps?lP(a.defaultProps,r,e.components.mergeClassNameAndStyle):!a.styleOverrides&&!a.variants?lP(a,r,e.components.mergeClassNameAndStyle):r}function Dre({props:t,name:e}){const n=q.useContext(Ire);return Rre({props:t,name:e,theme:{components:n}})}const yk={theme:void 0};function Lre(t){let e,n;return function(a){let l=e;return(l===void 0||a.theme!==n)&&(yk.theme=a.theme,l=d6(t(yk)),e=l,n=a.theme),l}}function kre(t=""){function e(...r){if(!r.length)return"";const a=r[0];return typeof a=="string"&&!a.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${a}${e(...r.slice(1))})`:`, ${a}`}return(r,...a)=>`var(--${t?`${t}-`:""}${r}${e(...a)})`}const _k=(t,e,n,r=[])=>{let a=t;e.forEach((l,u)=>{u===e.length-1?Array.isArray(a)?a[Number(l)]=n:a&&typeof a=="object"&&(a[l]=n):a&&typeof a=="object"&&(a[l]||(a[l]=r.includes(l)?[]:{}),a=a[l])})},zre=(t,e,n)=>{function r(a,l=[],u=[]){Object.entries(a).forEach(([s,m])=>{(!n||n&&!n([...l,s]))&&m!=null&&(typeof m=="object"&&Object.keys(m).length>0?r(m,[...l,s],Array.isArray(m)?[...u,s]:u):e([...l,s],m,u))})}r(t)},Ore=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function RM(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},a={},l={},u={};return zre(t,(s,m,_)=>{if((typeof m=="string"||typeof m=="number")&&(!r||!r(s,m))){const b=`--${n?`${n}-`:""}${s.join("-")}`,M=Ore(s,m);Object.assign(a,{[b]:M}),_k(l,s,`var(${b})`,_),_k(u,s,`var(${b}, ${M})`,_)}},s=>s[0]==="vars"),{css:a,vars:l,varsWithDefaults:u}}function Fre(t,e={}){const{getSelector:n=P,disableCssColorScheme:r,colorSchemeSelector:a}=e,{colorSchemes:l={},components:u,defaultColorScheme:s="light",...m}=t,{vars:_,css:b,varsWithDefaults:M}=RM(m,e);let C=M;const A={},{[s]:k,...z}=l;if(Object.entries(z||{}).forEach(([U,X])=>{const{vars:K,css:se,varsWithDefaults:J}=RM(X,e);C=mc(C,J),A[U]={css:se,vars:K}}),k){const{css:U,vars:X,varsWithDefaults:K}=RM(k,e);C=mc(C,K),A[s]={css:U,vars:X}}function P(U,X){let K=a;if(a==="class"&&(K=".%s"),a==="data"&&(K="[data-%s]"),a?.startsWith("data-")&&!a.includes("%s")&&(K=`[${a}="%s"]`),U){if(K==="media")return t.defaultColorScheme===U?":root":{[`@media (prefers-color-scheme: ${l[U]?.palette?.mode||U})`]:{":root":X}};if(K)return t.defaultColorScheme===U?`:root, ${K.replace("%s",String(U))}`:K.replace("%s",String(U))}return":root"}return{vars:C,generateThemeVars:()=>{let U={..._};return Object.entries(A).forEach(([,{vars:X}])=>{U=mc(U,X)}),U},generateStyleSheets:()=>{const U=[],X=t.defaultColorScheme||"light";function K(ue,ne){Object.keys(ne).length&&U.push(typeof ue=="string"?{[ue]:{...ne}}:ue)}K(n(void 0,{...b}),b);const{[X]:se,...J}=A;if(se){const{css:ue}=se,ne=l[X]?.palette?.mode,H=!r&&ne?{colorScheme:ne,...ue}:{...ue};K(n(X,{...H}),H)}return Object.entries(J).forEach(([ue,{css:ne}])=>{const H=l[ue]?.palette?.mode,de=!r&&H?{colorScheme:H,...ne}:{...ne};K(n(ue,{...de}),de)}),U}}}function Nre(t){return function(n){return t==="media"?`@media (prefers-color-scheme: ${n})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${n}"] &`:t==="class"?`.${n} &`:t==="data"?`[data-${n}] &`:`${t.replace("%s",n)} &`:"&"}}const tx={black:"#000",white:"#fff"},Bre={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Pv={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Av={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},H0={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Iv={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Rv={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Dv={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function m6(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:tx.white,default:tx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const Ure=m6();function g6(){return{text:{primary:tx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:tx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const xk=g6();function bk(t,e,n,r){const a=r.light||r,l=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=zI(t.main,a):e==="dark"&&(t.dark=kI(t.main,l)))}function $re(t="light"){return t==="dark"?{main:Iv[200],light:Iv[50],dark:Iv[400]}:{main:Iv[700],light:Iv[400],dark:Iv[800]}}function Vre(t="light"){return t==="dark"?{main:Pv[200],light:Pv[50],dark:Pv[400]}:{main:Pv[500],light:Pv[300],dark:Pv[700]}}function jre(t="light"){return t==="dark"?{main:Av[500],light:Av[300],dark:Av[700]}:{main:Av[700],light:Av[400],dark:Av[800]}}function Hre(t="light"){return t==="dark"?{main:Rv[400],light:Rv[300],dark:Rv[700]}:{main:Rv[700],light:Rv[500],dark:Rv[900]}}function Gre(t="light"){return t==="dark"?{main:Dv[400],light:Dv[300],dark:Dv[700]}:{main:Dv[800],light:Dv[500],dark:Dv[900]}}function Wre(t="light"){return t==="dark"?{main:H0[400],light:H0[300],dark:H0[700]}:{main:"#ed6c02",light:H0[500],dark:H0[900]}}function OI(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2,...a}=t,l=t.primary||$re(e),u=t.secondary||Vre(e),s=t.error||jre(e),m=t.info||Hre(e),_=t.success||Gre(e),b=t.warning||Wre(e);function M(z){return Tre(z,xk.text.primary)>=n?xk.text.primary:Ure.text.primary}const C=({color:z,name:P,mainShade:O=500,lightShade:j=300,darkShade:U=700})=>{if(z={...z},!z.main&&z[O]&&(z.main=z[O]),!z.hasOwnProperty("main"))throw new Error(Ig(11,P?` (${P})`:"",O));if(typeof z.main!="string")throw new Error(Ig(12,P?` (${P})`:"",JSON.stringify(z.main)));return bk(z,"light",j,r),bk(z,"dark",U,r),z.contrastText||(z.contrastText=M(z.main)),z};let A;return e==="light"?A=m6():e==="dark"&&(A=g6()),mc({common:{...tx},mode:e,primary:C({color:l,name:"primary"}),secondary:C({color:u,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:C({color:s,name:"error"}),warning:C({color:b,name:"warning"}),info:C({color:m,name:"info"}),success:C({color:_,name:"success"}),grey:Bre,contrastThreshold:n,getContrastText:M,augmentColor:C,tonalOffset:r,...A},a)}function qre(t){const e={};return Object.entries(t).forEach(r=>{const[a,l]=r;typeof l=="object"&&(e[a]=`${l.fontStyle?`${l.fontStyle} `:""}${l.fontVariant?`${l.fontVariant} `:""}${l.fontWeight?`${l.fontWeight} `:""}${l.fontStretch?`${l.fontStretch} `:""}${l.fontSize||""}${l.lineHeight?`/${l.lineHeight} `:""}${l.fontFamily||""}`)}),e}function Xre(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Zre(t){return Math.round(t*1e5)/1e5}const wk={textTransform:"uppercase"},Sk='"Roboto", "Helvetica", "Arial", sans-serif';function Yre(t,e){const{fontFamily:n=Sk,fontSize:r=14,fontWeightLight:a=300,fontWeightRegular:l=400,fontWeightMedium:u=500,fontWeightBold:s=700,htmlFontSize:m=16,allVariants:_,pxToRem:b,...M}=typeof e=="function"?e(t):e,C=r/14,A=b||(P=>`${P/m*C}rem`),k=(P,O,j,U,X)=>({fontFamily:n,fontWeight:P,fontSize:A(O),lineHeight:j,...n===Sk?{letterSpacing:`${Zre(U/O)}em`}:{},...X,..._}),z={h1:k(a,96,1.167,-1.5),h2:k(a,60,1.2,-.5),h3:k(l,48,1.167,0),h4:k(l,34,1.235,.25),h5:k(l,24,1.334,0),h6:k(u,20,1.6,.15),subtitle1:k(l,16,1.75,.15),subtitle2:k(u,14,1.57,.1),body1:k(l,16,1.5,.15),body2:k(l,14,1.43,.15),button:k(u,14,1.75,.4,wk),caption:k(l,12,1.66,.4),overline:k(l,12,2.66,1,wk),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return mc({htmlFontSize:m,pxToRem:A,fontFamily:n,fontSize:r,fontWeightLight:a,fontWeightRegular:l,fontWeightMedium:u,fontWeightBold:s,...z},M,{clone:!1})}const Kre=.2,Jre=.14,Qre=.12;function lo(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Kre})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Jre})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Qre})`].join(",")}const eie=["none",lo(0,2,1,-1,0,1,1,0,0,1,3,0),lo(0,3,1,-2,0,2,2,0,0,1,5,0),lo(0,3,3,-2,0,3,4,0,0,1,8,0),lo(0,2,4,-1,0,4,5,0,0,1,10,0),lo(0,3,5,-1,0,5,8,0,0,1,14,0),lo(0,3,5,-1,0,6,10,0,0,1,18,0),lo(0,4,5,-2,0,7,10,1,0,2,16,1),lo(0,5,5,-3,0,8,10,1,0,3,14,2),lo(0,5,6,-3,0,9,12,1,0,3,16,2),lo(0,6,6,-3,0,10,14,1,0,4,18,3),lo(0,6,7,-4,0,11,15,1,0,4,20,3),lo(0,7,8,-4,0,12,17,2,0,5,22,4),lo(0,7,8,-4,0,13,19,2,0,5,24,4),lo(0,7,9,-4,0,14,21,2,0,5,26,4),lo(0,8,9,-5,0,15,22,2,0,6,28,5),lo(0,8,10,-5,0,16,24,2,0,6,30,5),lo(0,8,11,-5,0,17,26,2,0,6,32,5),lo(0,9,11,-5,0,18,28,2,0,7,34,6),lo(0,9,12,-6,0,19,29,2,0,7,36,6),lo(0,10,13,-6,0,20,31,3,0,8,38,7),lo(0,10,13,-6,0,21,33,3,0,8,40,7),lo(0,10,14,-6,0,22,35,3,0,8,42,7),lo(0,11,14,-7,0,23,36,3,0,9,44,8),lo(0,11,15,-7,0,24,38,3,0,9,46,8)],tie={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},nie={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Mk(t){return`${Math.round(t)}ms`}function rie(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function iie(t){const e={...tie,...t.easing},n={...nie,...t.duration};return{getAutoHeightDuration:rie,create:(a=["all"],l={})=>{const{duration:u=n.standard,easing:s=e.easeInOut,delay:m=0,..._}=l;return(Array.isArray(a)?a:[a]).map(b=>`${b} ${typeof u=="string"?u:Mk(u)} ${s} ${typeof m=="string"?m:Mk(m)}`).join(",")},...t,easing:e,duration:n}}const oie={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function sie(t){return sf(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function v6(t={}){const e={...t};function n(r){const a=Object.entries(r);for(let l=0;l<a.length;l++){const[u,s]=a[l];!sie(s)||u.startsWith("unstable_")?delete r[u]:sf(s)&&(r[u]={...s},n(r[u]))}}return n(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function uP(t={},...e){const{breakpoints:n,mixins:r={},spacing:a,palette:l={},transitions:u={},typography:s={},shape:m,..._}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(Ig(20));const b=OI(l),M=u6(t);let C=mc(M,{mixins:Xre(M.breakpoints,r),palette:b,shadows:eie.slice(),typography:Yre(b,s),transitions:iie(u),zIndex:{...oie}});return C=mc(C,_),C=e.reduce((A,k)=>mc(A,k),C),C.unstable_sxConfig={...WS,..._?.unstable_sxConfig},C.unstable_sx=function(k){return Oy({sx:k,theme:this})},C.toRuntimeSource=v6,C}function aie(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const lie=[...Array(25)].map((t,e)=>{if(e===0)return"none";const n=aie(e);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function y6(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function _6(t){return t==="dark"?lie:[]}function cie(t){const{palette:e={mode:"light"},opacity:n,overlays:r,...a}=t,l=OI(e);return{palette:l,opacity:{...y6(l.mode),...n},overlays:r||_6(l.mode),...a}}function uie(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const hie=t=>[...[...Array(25)].map((e,n)=>`--${t?`${t}-`:""}overlays-${n}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],die=t=>(e,n)=>{const r=t.rootSelector||":root",a=t.colorSchemeSelector;let l=a;if(a==="class"&&(l=".%s"),a==="data"&&(l="[data-%s]"),a?.startsWith("data-")&&!a.includes("%s")&&(l=`[${a}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const u={};return hie(t.cssVarPrefix).forEach(s=>{u[s]=n[s],delete n[s]}),l==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:u}}:l?{[l.replace("%s",e)]:u,[`${r}, ${l.replace("%s",e)}`]:n}:{[r]:{...n,...u}}}if(l&&l!=="media")return`${r}, ${l.replace("%s",String(e))}`}else if(e){if(l==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[r]:n}};if(l)return l.replace("%s",String(e))}return r};function fie(t,e){e.forEach(n=>{t[n]||(t[n]={})})}function nn(t,e,n){!t[e]&&n&&(t[e]=n)}function a_(t){return typeof t!="string"||!t.startsWith("hsl")?t:p6(t)}function Yd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=s_(a_(t[e])))}function pie(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Vh=t=>{try{return t()}catch{}},mie=(t="mui")=>kre(t);function DM(t,e,n,r){if(!e)return;e=e===!0?{}:e;const a=r==="dark"?"dark":"light";if(!n){t[r]=cie({...e,palette:{mode:a,...e?.palette}});return}const{palette:l,...u}=uP({...n,palette:{mode:a,...e?.palette}});return t[r]={...e,palette:l,opacity:{...y6(a),...e?.opacity},overlays:e?.overlays||_6(a)},u}function gie(t={},...e){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:a=!1,cssVarPrefix:l="mui",shouldSkipGeneratingVar:u=uie,colorSchemeSelector:s=n.light&&n.dark?"media":void 0,rootSelector:m=":root",..._}=t,b=Object.keys(n)[0],M=r||(n.light&&b!=="light"?"light":b),C=mie(l),{[M]:A,light:k,dark:z,...P}=n,O={...P};let j=A;if((M==="dark"&&!("dark"in n)||M==="light"&&!("light"in n))&&(j=!0),!j)throw new Error(Ig(21,M));const U=DM(O,j,_,M);k&&!O.light&&DM(O,k,void 0,"light"),z&&!O.dark&&DM(O,z,void 0,"dark");let X={defaultColorScheme:M,...U,cssVarPrefix:l,colorSchemeSelector:s,rootSelector:m,getCssVar:C,colorSchemes:O,font:{...qre(U.typography),...U.font},spacing:pie(_.spacing)};Object.keys(X.colorSchemes).forEach(ne=>{const H=X.colorSchemes[ne].palette,de=Ee=>{const Pe=Ee.split("-"),Ze=Pe[1],ke=Pe[2];return C(Ee,H[Ze][ke])};if(H.mode==="light"&&(nn(H.common,"background","#fff"),nn(H.common,"onBackground","#000")),H.mode==="dark"&&(nn(H.common,"background","#000"),nn(H.common,"onBackground","#fff")),fie(H,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),H.mode==="light"){nn(H.Alert,"errorColor",Hi(H.error.light,.6)),nn(H.Alert,"infoColor",Hi(H.info.light,.6)),nn(H.Alert,"successColor",Hi(H.success.light,.6)),nn(H.Alert,"warningColor",Hi(H.warning.light,.6)),nn(H.Alert,"errorFilledBg",de("palette-error-main")),nn(H.Alert,"infoFilledBg",de("palette-info-main")),nn(H.Alert,"successFilledBg",de("palette-success-main")),nn(H.Alert,"warningFilledBg",de("palette-warning-main")),nn(H.Alert,"errorFilledColor",Vh(()=>H.getContrastText(H.error.main))),nn(H.Alert,"infoFilledColor",Vh(()=>H.getContrastText(H.info.main))),nn(H.Alert,"successFilledColor",Vh(()=>H.getContrastText(H.success.main))),nn(H.Alert,"warningFilledColor",Vh(()=>H.getContrastText(H.warning.main))),nn(H.Alert,"errorStandardBg",Gi(H.error.light,.9)),nn(H.Alert,"infoStandardBg",Gi(H.info.light,.9)),nn(H.Alert,"successStandardBg",Gi(H.success.light,.9)),nn(H.Alert,"warningStandardBg",Gi(H.warning.light,.9)),nn(H.Alert,"errorIconColor",de("palette-error-main")),nn(H.Alert,"infoIconColor",de("palette-info-main")),nn(H.Alert,"successIconColor",de("palette-success-main")),nn(H.Alert,"warningIconColor",de("palette-warning-main")),nn(H.AppBar,"defaultBg",de("palette-grey-100")),nn(H.Avatar,"defaultBg",de("palette-grey-400")),nn(H.Button,"inheritContainedBg",de("palette-grey-300")),nn(H.Button,"inheritContainedHoverBg",de("palette-grey-A100")),nn(H.Chip,"defaultBorder",de("palette-grey-400")),nn(H.Chip,"defaultAvatarColor",de("palette-grey-700")),nn(H.Chip,"defaultIconColor",de("palette-grey-700")),nn(H.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),nn(H.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),nn(H.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),nn(H.LinearProgress,"primaryBg",Gi(H.primary.main,.62)),nn(H.LinearProgress,"secondaryBg",Gi(H.secondary.main,.62)),nn(H.LinearProgress,"errorBg",Gi(H.error.main,.62)),nn(H.LinearProgress,"infoBg",Gi(H.info.main,.62)),nn(H.LinearProgress,"successBg",Gi(H.success.main,.62)),nn(H.LinearProgress,"warningBg",Gi(H.warning.main,.62)),nn(H.Skeleton,"bg",`rgba(${de("palette-text-primaryChannel")} / 0.11)`),nn(H.Slider,"primaryTrack",Gi(H.primary.main,.62)),nn(H.Slider,"secondaryTrack",Gi(H.secondary.main,.62)),nn(H.Slider,"errorTrack",Gi(H.error.main,.62)),nn(H.Slider,"infoTrack",Gi(H.info.main,.62)),nn(H.Slider,"successTrack",Gi(H.success.main,.62)),nn(H.Slider,"warningTrack",Gi(H.warning.main,.62));const Ee=rb(H.background.default,.8);nn(H.SnackbarContent,"bg",Ee),nn(H.SnackbarContent,"color",Vh(()=>H.getContrastText(Ee))),nn(H.SpeedDialAction,"fabHoverBg",rb(H.background.paper,.15)),nn(H.StepConnector,"border",de("palette-grey-400")),nn(H.StepContent,"border",de("palette-grey-400")),nn(H.Switch,"defaultColor",de("palette-common-white")),nn(H.Switch,"defaultDisabledColor",de("palette-grey-100")),nn(H.Switch,"primaryDisabledColor",Gi(H.primary.main,.62)),nn(H.Switch,"secondaryDisabledColor",Gi(H.secondary.main,.62)),nn(H.Switch,"errorDisabledColor",Gi(H.error.main,.62)),nn(H.Switch,"infoDisabledColor",Gi(H.info.main,.62)),nn(H.Switch,"successDisabledColor",Gi(H.success.main,.62)),nn(H.Switch,"warningDisabledColor",Gi(H.warning.main,.62)),nn(H.TableCell,"border",Gi(nb(H.divider,1),.88)),nn(H.Tooltip,"bg",nb(H.grey[700],.92))}if(H.mode==="dark"){nn(H.Alert,"errorColor",Gi(H.error.light,.6)),nn(H.Alert,"infoColor",Gi(H.info.light,.6)),nn(H.Alert,"successColor",Gi(H.success.light,.6)),nn(H.Alert,"warningColor",Gi(H.warning.light,.6)),nn(H.Alert,"errorFilledBg",de("palette-error-dark")),nn(H.Alert,"infoFilledBg",de("palette-info-dark")),nn(H.Alert,"successFilledBg",de("palette-success-dark")),nn(H.Alert,"warningFilledBg",de("palette-warning-dark")),nn(H.Alert,"errorFilledColor",Vh(()=>H.getContrastText(H.error.dark))),nn(H.Alert,"infoFilledColor",Vh(()=>H.getContrastText(H.info.dark))),nn(H.Alert,"successFilledColor",Vh(()=>H.getContrastText(H.success.dark))),nn(H.Alert,"warningFilledColor",Vh(()=>H.getContrastText(H.warning.dark))),nn(H.Alert,"errorStandardBg",Hi(H.error.light,.9)),nn(H.Alert,"infoStandardBg",Hi(H.info.light,.9)),nn(H.Alert,"successStandardBg",Hi(H.success.light,.9)),nn(H.Alert,"warningStandardBg",Hi(H.warning.light,.9)),nn(H.Alert,"errorIconColor",de("palette-error-main")),nn(H.Alert,"infoIconColor",de("palette-info-main")),nn(H.Alert,"successIconColor",de("palette-success-main")),nn(H.Alert,"warningIconColor",de("palette-warning-main")),nn(H.AppBar,"defaultBg",de("palette-grey-900")),nn(H.AppBar,"darkBg",de("palette-background-paper")),nn(H.AppBar,"darkColor",de("palette-text-primary")),nn(H.Avatar,"defaultBg",de("palette-grey-600")),nn(H.Button,"inheritContainedBg",de("palette-grey-800")),nn(H.Button,"inheritContainedHoverBg",de("palette-grey-700")),nn(H.Chip,"defaultBorder",de("palette-grey-700")),nn(H.Chip,"defaultAvatarColor",de("palette-grey-300")),nn(H.Chip,"defaultIconColor",de("palette-grey-300")),nn(H.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),nn(H.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),nn(H.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),nn(H.LinearProgress,"primaryBg",Hi(H.primary.main,.5)),nn(H.LinearProgress,"secondaryBg",Hi(H.secondary.main,.5)),nn(H.LinearProgress,"errorBg",Hi(H.error.main,.5)),nn(H.LinearProgress,"infoBg",Hi(H.info.main,.5)),nn(H.LinearProgress,"successBg",Hi(H.success.main,.5)),nn(H.LinearProgress,"warningBg",Hi(H.warning.main,.5)),nn(H.Skeleton,"bg",`rgba(${de("palette-text-primaryChannel")} / 0.13)`),nn(H.Slider,"primaryTrack",Hi(H.primary.main,.5)),nn(H.Slider,"secondaryTrack",Hi(H.secondary.main,.5)),nn(H.Slider,"errorTrack",Hi(H.error.main,.5)),nn(H.Slider,"infoTrack",Hi(H.info.main,.5)),nn(H.Slider,"successTrack",Hi(H.success.main,.5)),nn(H.Slider,"warningTrack",Hi(H.warning.main,.5));const Ee=rb(H.background.default,.98);nn(H.SnackbarContent,"bg",Ee),nn(H.SnackbarContent,"color",Vh(()=>H.getContrastText(Ee))),nn(H.SpeedDialAction,"fabHoverBg",rb(H.background.paper,.15)),nn(H.StepConnector,"border",de("palette-grey-600")),nn(H.StepContent,"border",de("palette-grey-600")),nn(H.Switch,"defaultColor",de("palette-grey-300")),nn(H.Switch,"defaultDisabledColor",de("palette-grey-600")),nn(H.Switch,"primaryDisabledColor",Hi(H.primary.main,.55)),nn(H.Switch,"secondaryDisabledColor",Hi(H.secondary.main,.55)),nn(H.Switch,"errorDisabledColor",Hi(H.error.main,.55)),nn(H.Switch,"infoDisabledColor",Hi(H.info.main,.55)),nn(H.Switch,"successDisabledColor",Hi(H.success.main,.55)),nn(H.Switch,"warningDisabledColor",Hi(H.warning.main,.55)),nn(H.TableCell,"border",Hi(nb(H.divider,1),.68)),nn(H.Tooltip,"bg",nb(H.grey[700],.92))}Yd(H.background,"default"),Yd(H.background,"paper"),Yd(H.common,"background"),Yd(H.common,"onBackground"),Yd(H,"divider"),Object.keys(H).forEach(Ee=>{const Pe=H[Ee];Ee!=="tonalOffset"&&Pe&&typeof Pe=="object"&&(Pe.main&&nn(H[Ee],"mainChannel",s_(a_(Pe.main))),Pe.light&&nn(H[Ee],"lightChannel",s_(a_(Pe.light))),Pe.dark&&nn(H[Ee],"darkChannel",s_(a_(Pe.dark))),Pe.contrastText&&nn(H[Ee],"contrastTextChannel",s_(a_(Pe.contrastText))),Ee==="text"&&(Yd(H[Ee],"primary"),Yd(H[Ee],"secondary")),Ee==="action"&&(Pe.active&&Yd(H[Ee],"active"),Pe.selected&&Yd(H[Ee],"selected")))})}),X=e.reduce((ne,H)=>mc(ne,H),X);const K={prefix:l,disableCssColorScheme:a,shouldSkipGeneratingVar:u,getSelector:die(X)},{vars:se,generateThemeVars:J,generateStyleSheets:ue}=Fre(X,K);return X.vars=se,Object.entries(X.colorSchemes[X.defaultColorScheme]).forEach(([ne,H])=>{X[ne]=H}),X.generateThemeVars=J,X.generateStyleSheets=ue,X.generateSpacing=function(){return c6(_.spacing,RI(this))},X.getColorSchemeSelector=Nre(s),X.spacing=X.generateSpacing(),X.shouldSkipGeneratingVar=u,X.unstable_sxConfig={...WS,..._?.unstable_sxConfig},X.unstable_sx=function(H){return Oy({sx:H,theme:this})},X.toRuntimeSource=v6,X}function Ek(t,e,n){t.colorSchemes&&n&&(t.colorSchemes[e]={...n!==!0&&n,palette:OI({...n===!0?{}:n.palette,mode:e})})}function vie(t={},...e){const{palette:n,cssVariables:r=!1,colorSchemes:a=n?void 0:{light:!0},defaultColorScheme:l=n?.mode,...u}=t,s=l||"light",m=a?.[s],_={...a,...n?{[s]:{...typeof m!="boolean"&&m,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in t))return uP(t,...e);let b=n;"palette"in t||_[s]&&(_[s]!==!0?b=_[s].palette:s==="dark"&&(b={mode:"dark"}));const M=uP({...t,palette:b},...e);return M.defaultColorScheme=s,M.colorSchemes=_,M.palette.mode==="light"&&(M.colorSchemes.light={..._.light!==!0&&_.light,palette:M.palette},Ek(M,"dark",_.dark)),M.palette.mode==="dark"&&(M.colorSchemes.dark={..._.dark!==!0&&_.dark,palette:M.palette},Ek(M,"light",_.light)),M}return!n&&!("light"in _)&&s==="light"&&(_.light=!0),gie({...u,colorSchemes:_,defaultColorScheme:s,...typeof r!="boolean"&&r},...e)}const yie=vie(),_ie="$$material";function xie(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const bie=t=>xie(t)&&t!=="classes",wie=_re({themeId:_ie,defaultTheme:yie,rootShouldForwardProp:bie}),Sie=Lre;function Mie(t){return Dre(t)}function Eie(t){return h6("MuiSvgIcon",t)}mre("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Cie=t=>{const{color:e,fontSize:n,classes:r}=t,a={root:["root",e!=="inherit"&&`color${zy(e)}`,`fontSize${zy(n)}`]};return mne(a,Eie,r)},Tie=wie("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${zy(n.color)}`],e[`fontSize${zy(n.fontSize)}`]]}})(Sie(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),hP=q.forwardRef(function(e,n){const r=Mie({props:e,name:"MuiSvgIcon"}),{children:a,className:l,color:u="inherit",component:s="svg",fontSize:m="medium",htmlColor:_,inheritViewBox:b=!1,titleAccess:M,viewBox:C="0 0 24 24",...A}=r,k=q.isValidElement(a)&&a.type==="svg",z={...r,color:u,component:s,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:b,viewBox:C,hasSvgAsChild:k},P={};b||(P.viewBox=C);const O=Cie(z);return ae.jsxs(Tie,{as:s,className:yo(O.root,l),focusable:"false",color:_,"aria-hidden":M?void 0:!0,role:M?"img":void 0,ref:n,...P,...A,...k&&a.props,ownerState:z,children:[k?a.props.children:a,M?ae.jsx("title",{children:M}):null]})});hP.muiName="SvgIcon";function Bs(t,e){function n(r,a){return ae.jsx(hP,{"data-testid":void 0,ref:a,...r,children:t})}return n.muiName=hP.muiName,q.memo(q.forwardRef(n))}const FI=Bs(ae.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function pr(t,e){if(t==null)throw new Error(e);return t}function x6(t,e){if(!t)throw new Error(`assertion failed: ${e}`)}class ah extends Error{constructor(e){super("unreachable value "+JSON.stringify(e))}}class ld{static checkArgument(e,n){if(!e)throw new Error(n)}static checkState(e,n){if(!e)throw new Error(n)}static checkExists(e,n){return pr(e,n)}}function Tw(t,e){return w6(t,e,(n,r,a,l)=>Math.sqrt(Math.pow(a-n,2)+Math.pow(l-r,2)))}function Pie(t,e){return w6(t,e,(n,r,a,l)=>[(n+a)/2,(r+l)/2])}function Ck([t,e,n,r]){return Pie([t,e],[n,r])}function b6(t){let e=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,l=!1;for(const u of t)l=!0,Array.isArray(u)?(e=Math.min(e,u[0]),r=Math.max(r,u[0]),n=Math.min(n,u[1]),a=Math.max(a,u[1])):(e=Math.min(e,u.x),r=Math.max(r,u.x),n=Math.min(n,u.y),a=Math.max(a,u.y));return ld.checkArgument(l),[e,n,r,a]}function ib(t,e){const[n,r,a,l]=t,[u,s]=Array.isArray(e)?e:[e.x,e.y];return n<=u&&u<=a&&r<=s&&s<=l}function NI(t){const e=Math.PI*2;let n=t%e;return n=(n+e)%e,n<=Math.PI?n:n-e}function Pw(t){return NI(t*Math.PI/180)}function Tk(t){return NI(t)*180/Math.PI}function Pk(t,e){let n,r;return Array.isArray(t)?(ld.checkArgument(t.length>=2),n=t[0],r=t[1]):(n=t.x,r=t.y),e(n,r)}function w6(t,e,n){const[r,a]=Pk(t,(s,m)=>[s,m]),[l,u]=Pk(e,(s,m)=>[s,m]);return n(r,a,l,u)}var ms=(t=>(t[t.Arizona=0]="Arizona",t[t.Arkansas=1]="Arkansas",t[t.Colorado=2]="Colorado",t[t.Idaho=3]="Idaho",t[t.Iowa=4]="Iowa",t[t.Kansas=5]="Kansas",t[t.Louisiana=6]="Louisiana",t[t.Missouri=7]="Missouri",t[t.Montana=8]="Montana",t[t.Nebraska=9]="Nebraska",t[t.Nevada=10]="Nevada",t[t.NewMexico=11]="NewMexico",t[t.Oklahoma=12]="Oklahoma",t[t.Oregon=13]="Oregon",t[t.Texas=14]="Texas",t[t.Utah=15]="Utah",t[t.Washington=16]="Washington",t[t.Wyoming=17]="Wyoming",t))(ms||{});const Rg=new Set([10,0,11,13,16,15,3,2,17,8,14,12,5,9,1,7,4,6]),Aie={10:"Nevada",0:"Arizona",11:"New Mexico",13:"Oregon",16:"Washington",15:"Utah",3:"Idaho",2:"Colorado",17:"Wyoming",8:"Montana",14:"Texas",12:"Oklahoma",5:"Kansas",9:"Nebraska",1:"Arkansas",7:"Missouri",4:"Iowa",6:"Louisiana"},S6={0:new Set,1:new Set([10]),2:new Set([0]),3:new Set([11]),4:new Set([13]),5:new Set([16]),6:new Set([16,13]),7:new Set([15]),8:new Set([15,11]),9:new Set([3]),10:new Set([3,13]),11:new Set([3,15]),12:new Set([3,16]),13:new Set([2]),14:new Set([2,11]),15:new Set([2,15]),16:new Set([17]),17:new Set([17,2]),18:new Set([17,3]),19:new Set([17,15]),20:new Set([14]),21:new Set([14,11]),22:new Set([8]),23:new Set([8,3]),24:new Set([8,17]),25:new Set([12]),26:new Set([12,2]),27:new Set([12,11]),28:new Set([12,14]),29:new Set([5]),30:new Set([5,2]),31:new Set([5,12]),32:new Set([9]),33:new Set([9,2]),34:new Set([9,5]),35:new Set([9,17]),36:new Set([1]),37:new Set([1,12]),38:new Set([1,14]),39:new Set([7]),40:new Set([7,1]),41:new Set([7,5]),42:new Set([7,9]),43:new Set([7,12]),44:new Set([4]),45:new Set([4,7]),46:new Set([4,9]),47:new Set([6]),48:new Set([6,1]),49:new Set([6,14])},Iie={1:0,2:1,3:2,7:13,13:9,31:3,37:4,43:20,44:7,47:5,17:29,27:22,36:25,50:16,18:32,19:36,26:39,21:44,22:47};for(const t of Object.values(Iie))t!==0&&x6(S6[t].size===1);function Fx(t){const e=new Set;for(const[n,r]of Object.entries(S6))[...r].every(a=>t.has(a))&&e.add(Number(n));return e}const Rie=new Set([0,1,2,3,4,5,6,7,11,12,9,10]),Die={0:new Set,1:new Set([0]),2:new Set([1]),3:new Set([2]),4:new Set([3]),5:new Set([3,2]),6:new Set([4]),7:new Set([4,0]),8:new Set([4,1]),9:new Set([5]),10:new Set([5,0]),11:new Set([6]),12:new Set([6,2]),15:new Set([9]),16:new Set([7]),17:new Set([7,0]),18:new Set([7,4]),19:new Set([10]),20:new Set([11]),21:new Set([11,0]),22:new Set([11,7]),23:new Set([12]),24:new Set([12,4]),25:new Set([12,1])};function Lie(t){const e=new Set;for(const[n,r]of Object.entries(Die))[...r].every(a=>t.has(a))&&e.add(Number(n));return e}var M6=(t=>(t[t.Road=0]="Road",t[t.Light=1]="Light",t[t.Dark=2]="Dark",t[t.Green=3]="Green",t[t.NavRed=4]="NavRed",t[t.NavGreen=5]="NavGreen",t[t.NavBlue=6]="NavBlue",t[t.NavYellow=7]="NavYellow",t[t.NavPurple=8]="NavPurple",t))(M6||{});const kie="modulepreload",zie=function(t){return"/ats-map/"+t},Ak={},Oie=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let _=function(b){return Promise.all(b.map(M=>Promise.resolve(M).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};var u=_;document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),m=s?.nonce||s?.getAttribute("nonce");a=_(n.map(b=>{if(b=zie(b),b in Ak)return;Ak[b]=!0;const M=b.endsWith(".css"),C=M?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${C}`))return;const A=document.createElement("link");if(A.rel=M?"stylesheet":kie,M||(A.as="script"),A.crossOrigin="",A.href=b,m&&A.setAttribute("nonce",m),document.head.appendChild(A),M)return new Promise((k,z)=>{A.addEventListener("load",k),A.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${b}`)))})}))}function l(s){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=s,window.dispatchEvent(m),!m.defaultPrevented)throw s}return a.then(s=>{for(const m of s||[])m.status==="rejected"&&l(m.reason);return e().catch(l)})},E6=q.createContext(null);function Nx(){const t=q.useContext(E6)?.maps,e=q.useContext(Ug);return q.useMemo(()=>({...t,current:e?.map}),[t,e])}function Fie(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,a=Array.isArray(e)?e[0]:e?e.x:0,l=Array.isArray(e)?e[1]:e?e.y:0;return n===a&&r===l}function xl(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!xl(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!xl(t[a],e[a]))return!1;return!0}return!1}function Ik(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Rk(t,e){const n=e.viewState||e,r={};if("longitude"in n&&"latitude"in n&&(n.longitude!==t.center.lng||n.latitude!==t.center.lat)){const a=t.center.constructor;r.center=new a(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==t.zoom&&(r.zoom=n.zoom),"bearing"in n&&n.bearing!==t.bearing&&(r.bearing=n.bearing),"pitch"in n&&n.pitch!==t.pitch&&(r.pitch=n.pitch),n.padding&&t.padding&&!xl(n.padding,t.padding)&&(r.padding=n.padding),r}const Nie=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Dk(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let a=null;"interactive"in r&&(a=Object.assign({},r),delete a.interactive);const l=e[r.ref];if(l){a=a||Object.assign({},r),delete a.ref;for(const u of Nie)u in l&&(a[u]=l[u])}return a||r});return{...t,layers:n}}const Lk={version:8,sources:{},layers:[]},kk={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},zk={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Ok={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Bie=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Uie=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Fy{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=a=>{const l=this.props[Ok[a.type]];l?l(a):a.type==="error"&&console.error(a.error)},this._onCameraEvent=a=>{if(this._internalUpdate)return;a.viewState=this._propsedCameraUpdate||Ik(this._map.transform);const l=this.props[zk[a.type]];l&&l(a)},this._onCameraUpdate=a=>this._internalUpdate?a:(this._propsedCameraUpdate=Ik(a),Rk(a,this.props)),this._onPointerEvent=a=>{(a.type==="mousemove"||a.type==="mouseout")&&this._updateHover(a);const l=this.props[kk[a.type]];l&&(this.props.interactiveLayerIds&&a.type!=="mouseover"&&a.type!=="mouseout"&&(a.features=this._hoveredFeatures||this._queryRenderedFeatures(a.point)),l(a),delete a.features)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n),a=this._updateSize(e),l=this._updateViewState(e);this._updateStyle(e,n),this._updateStyleComponents(e),this._updateHandlers(e,n),(r||a||l&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Fy.savedMaps.pop();if(!r)return null;const a=r.map,l=a.getContainer();for(n.className=l.className;l.childNodes.length>0;)n.appendChild(l.childNodes[0]);a._container=n;const u=a._resizeObserver;u&&(u.disconnect(),u.observe(n)),r.setProps({...e,styleDiffing:!1}),a.resize();const{initialViewState:s}=e;return s&&(s.bounds?a.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):r._updateViewState(s)),a.isStyleLoaded()?a.fire("load"):a.once("style.load",()=>a.fire("load")),a._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=Lk}=n,a={...n,...n.initialViewState,container:e,style:Dk(r)},l=a.initialViewState||a.viewState||a;if(Object.assign(a,{center:[l.longitude||0,l.latitude||0],zoom:l.zoom||0,pitch:l.pitch||0,bearing:l.bearing||0}),n.gl){const s=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=s,n.gl)}const u=new this._MapClass(a);l.padding&&u.setPadding(l.padding),n.cursor&&(u.getCanvas().style.cursor=n.cursor),u.transformCameraUpdate=this._onCameraUpdate,u.on("style.load",()=>{this._styleComponents={light:u.getLight(),sky:u.getSky(),projection:u.getProjection?.(),terrain:u.getTerrain()},this._updateStyleComponents(this.props)}),u.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const s in kk)u.on(s,this._onPointerEvent);for(const s in zk)u.on(s,this._onCameraEvent);for(const s in Ok)u.on(s,this._onEvent);this._map=u}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),Fy.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e){const n=this._map,r=n.transform;if(!n.isMoving()){const l=Rk(r,e);if(Object.keys(l).length>0)return this._internalUpdate=!0,n.jumpTo(l),this._internalUpdate=!1,!0}return!1}_updateSettings(e,n){const r=this._map;let a=!1;for(const l of Bie)l in e&&!xl(e[l],n[l])&&(a=!0,r[`set${l[0].toUpperCase()}${l.slice(1)}`]?.call(r,e[l]));return a}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=Lk,styleDiffing:a=!0}=e,l={diff:a};"localIdeographFontFamily"in e&&(l.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Dk(r),l)}}_updateStyleComponents({light:e,projection:n,sky:r,terrain:a}){const l=this._map,u=this._styleComponents;l.style._loaded&&(e&&!xl(e,u.light)&&(u.light=e,l.setLight(e)),n&&!xl(n,u.projection)&&n!==u.projection?.type&&(u.projection=typeof n=="string"?{type:n}:n,l.setProjection?.(u.projection)),r&&!xl(r,u.sky)&&(u.sky=r,l.setSky(r)),a!==void 0&&!xl(a,u.terrain)&&(!a||l.getSource(a.source))&&(u.terrain=a,l.setTerrain(a)))}_updateHandlers(e,n){const r=this._map;for(const a of Uie){const l=e[a]??!0,u=n[a]??!0;xl(l,u)||(l?r[a].enable(l):r[a].disable())}}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const a=e.type,l=this._hoveredFeatures?.length>0,u=this._queryRenderedFeatures(e.point),s=u.length>0;!s&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=u,s&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=a}else this._hoveredFeatures=null}}Fy.savedMaps=[];const $ie=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Vie(t){if(!t)return null;const e=t.map,n={getMap:()=>e};for(const r of jie(e))!(r in n)&&!$ie.includes(r)&&(n[r]=e[r].bind(e));return n}function jie(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const Hie=typeof document<"u"?q.useLayoutEffect:q.useEffect;function Gie(t,e){const{RTLTextPlugin:n,maxParallelImageRequests:r,workerCount:a,workerUrl:l}=e;if(n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:u,lazy:s=!0}=typeof n=="string"?{pluginUrl:n}:n;t.setRTLTextPlugin(u,m=>{m&&console.error(m)},s)}r!==void 0&&t.setMaxParallelImageRequests(r),a!==void 0&&t.setWorkerCount(a),l!==void 0&&t.setWorkerUrl(l)}const Ug=q.createContext(null);function Wie(t,e){const n=q.useContext(E6),[r,a]=q.useState(null),l=q.useRef(),{current:u}=q.useRef({mapLib:null,map:null});q.useEffect(()=>{const _=t.mapLib;let b=!0,M;return Promise.resolve(_||Oie(()=>Promise.resolve().then(()=>poe),[])).then(C=>{if(!b)return;if(!C)throw new Error("Invalid mapLib");const A="Map"in C?C:C.default;if(!A.Map)throw new Error("Invalid mapLib");Gie(A,t),t.reuseMaps&&(M=Fy.reuse(t,l.current)),M||(M=new Fy(A.Map,t,l.current)),u.map=Vie(M),u.mapLib=A,a(M),n?.onMapMount(u.map,t.id)}).catch(C=>{const{onError:A}=t;A?A({type:"error",target:null,originalEvent:null,error:C}):console.error(C)}),()=>{b=!1,M&&(n?.onMapUnmount(t.id),t.reuseMaps?M.recycle():M.destroy())}},[]),Hie(()=>{r&&r.setProps(t)}),q.useImperativeHandle(e,()=>u.map,[r]);const s=q.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),m={height:"100%"};return q.createElement("div",{id:t.id,ref:l,style:s},r&&q.createElement(Ug.Provider,{value:u},q.createElement("div",{"mapboxgl-children":"",style:m},t.children)))}const Bx=q.forwardRef(Wie),qie=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function bf(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const a=e[r];Number.isFinite(a)&&!qie.test(r)?n[r]=`${a}px`:n[r]=a}}function C6(t,e){if(t===e)return null;const n=Fk(t),r=Fk(e),a=[];for(const l of r)n.has(l)||a.push(l);for(const l of n)r.has(l)||a.push(l);return a.length===0?null:a}function Fk(t){return new Set(t?t.trim().split(/\s+/):[])}const BI=q.memo(q.forwardRef((t,e)=>{const{map:n,mapLib:r}=q.useContext(Ug),a=q.useRef({props:t}),l=q.useMemo(()=>{let O=!1;q.Children.forEach(t.children,X=>{X&&(O=!0)});const j={...t,element:O?document.createElement("div"):void 0},U=new r.Marker(j);return U.setLngLat([t.longitude,t.latitude]),U.getElement().addEventListener("click",X=>{a.current.props.onClick?.({type:"click",target:U,originalEvent:X})}),U.on("dragstart",X=>{const K=X;K.lngLat=l.getLngLat(),a.current.props.onDragStart?.(K)}),U.on("drag",X=>{const K=X;K.lngLat=l.getLngLat(),a.current.props.onDrag?.(K)}),U.on("dragend",X=>{const K=X;K.lngLat=l.getLngLat(),a.current.props.onDragEnd?.(K)}),U},[]);q.useEffect(()=>(l.addTo(n.getMap()),()=>{l.remove()}),[]);const{longitude:u,latitude:s,offset:m,style:_,draggable:b=!1,popup:M=null,rotation:C=0,rotationAlignment:A="auto",pitchAlignment:k="auto"}=t;q.useEffect(()=>{bf(l.getElement(),_)},[_]),q.useImperativeHandle(e,()=>l,[]);const z=a.current.props;(l.getLngLat().lng!==u||l.getLngLat().lat!==s)&&l.setLngLat([u,s]),m&&!Fie(l.getOffset(),m)&&l.setOffset(m),l.isDraggable()!==b&&l.setDraggable(b),l.getRotation()!==C&&l.setRotation(C),l.getRotationAlignment()!==A&&l.setRotationAlignment(A),l.getPitchAlignment()!==k&&l.setPitchAlignment(k),l.getPopup()!==M&&l.setPopup(M);const P=C6(z.className,t.className);if(P)for(const O of P)l.toggleClassName(O);return a.current.props=t,ES.createPortal(t.children,l.getElement())})),Xie=q.memo(q.forwardRef((t,e)=>{const{map:n,mapLib:r}=q.useContext(Ug),a=q.useMemo(()=>document.createElement("div"),[]),l=q.useRef({props:t}),u=q.useMemo(()=>{const s={...t},m=new r.Popup(s);return m.setLngLat([t.longitude,t.latitude]),m.once("open",_=>{l.current.props.onOpen?.(_)}),m},[]);if(q.useEffect(()=>{const s=m=>{l.current.props.onClose?.(m)};return u.on("close",s),u.setDOMContent(a).addTo(n.getMap()),()=>{u.off("close",s),u.isOpen()&&u.remove()}},[]),q.useEffect(()=>{bf(u.getElement(),t.style)},[t.style]),q.useImperativeHandle(e,()=>u,[]),u.isOpen()){const s=l.current.props;(u.getLngLat().lng!==t.longitude||u.getLngLat().lat!==t.latitude)&&u.setLngLat([t.longitude,t.latitude]),t.offset&&!xl(s.offset,t.offset)&&u.setOffset(t.offset),(s.anchor!==t.anchor||s.maxWidth!==t.maxWidth)&&(u.options.anchor=t.anchor,u.setMaxWidth(t.maxWidth));const m=C6(s.className,t.className);if(m)for(const _ of m)u.toggleClassName(_);l.current.props=t}return ES.createPortal(t.children,a)}));function Il(t,e,n,r){const a=q.useContext(Ug),l=q.useMemo(()=>t(a),[]);return q.useEffect(()=>{const u=e,s=null,m=typeof e=="function"?e:null,{map:_}=a;return _.hasControl(l)||(_.addControl(l,u?.position),s&&s(a)),()=>{m&&m(a),_.hasControl(l)&&_.removeControl(l)}},[]),l}function Zie(t){const e=Il(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return q.useEffect(()=>{bf(e._container,t.style)},[t.style]),null}const T6=q.memo(Zie);function Yie(t){const e=Il(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return q.useEffect(()=>{bf(e._controlContainer,t.style)},[t.style]),null}const UI=q.memo(Yie);function Kie(t,e){const n=q.useRef({props:t}),r=Il(({mapLib:a})=>{const l=new a.GeolocateControl(t),u=l._setupUI;return l._setupUI=()=>{l._container.hasChildNodes()||u()},l.on("geolocate",s=>{n.current.props.onGeolocate?.(s)}),l.on("error",s=>{n.current.props.onError?.(s)}),l.on("outofmaxbounds",s=>{n.current.props.onOutOfMaxBounds?.(s)}),l.on("trackuserlocationstart",s=>{n.current.props.onTrackUserLocationStart?.(s)}),l.on("trackuserlocationend",s=>{n.current.props.onTrackUserLocationEnd?.(s)}),l},{position:t.position});return n.current.props=t,q.useImperativeHandle(e,()=>r,[]),q.useEffect(()=>{bf(r._container,t.style)},[t.style]),null}q.memo(q.forwardRef(Kie));function Jie(t){const e=Il(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return q.useEffect(()=>{bf(e._container,t.style)},[t.style]),null}const $I=q.memo(Jie);function Qie(t){const e=Il(({mapLib:l})=>new l.ScaleControl(t),{position:t.position}),n=q.useRef(t),r=n.current;n.current=t;const{style:a}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),q.useEffect(()=>{bf(e._container,a)},[a]),null}q.memo(Qie);function eoe(t){const e=Il(({mapLib:n})=>new n.TerrainControl(t),{position:t.position});return q.useEffect(()=>{bf(e._container,t.style)},[t.style]),null}q.memo(eoe);function toe(t){const e=Il(({mapLib:n})=>new n.LogoControl(t),{position:t.position});return q.useEffect(()=>{bf(e._container,t.style)},[t.style]),null}q.memo(toe);function Aw(t,e){if(!t)throw new Error(e)}let noe=0;function roe(t,e,n){if(t.style&&t.style._loaded){const r={...n};return delete r.id,delete r.children,t.addSource(e,r),t.getSource(e)}return null}function ioe(t,e,n){Aw(e.id===n.id,"source id changed"),Aw(e.type===n.type,"source type changed");let r="",a=0;for(const u in e)u!=="children"&&u!=="id"&&!xl(n[u],e[u])&&(r=u,a++);if(!a)return;const l=e.type;if(l==="geojson")t.setData(e.data);else if(l==="image")t.updateImage({url:e.url,coordinates:e.coordinates});else switch(r){case"coordinates":t.setCoordinates?.(e.coordinates);break;case"url":t.setUrl?.(e.url);break;case"tiles":t.setTiles?.(e.tiles);break;default:console.warn(`Unable to update <Source> prop: ${r}`)}}function Jp(t){const e=q.useContext(Ug).map.getMap(),n=q.useRef(t),[,r]=q.useState(0),a=q.useMemo(()=>t.id||`jsx-source-${noe++}`,[]);q.useEffect(()=>{if(e){const u=()=>setTimeout(()=>r(s=>s+1),0);return e.on("styledata",u),u(),()=>{if(e.off("styledata",u),e.style&&e.style._loaded&&e.getSource(a)){const s=e.getStyle()?.layers;if(s)for(const m of s)m.source===a&&e.removeLayer(m.id);e.removeSource(a)}}}},[e]);let l=e&&e.style&&e.getSource(a);return l?ioe(l,t,n.current):l=roe(e,a,t),n.current=t,l&&q.Children.map(t.children,u=>u&&q.cloneElement(u,{source:a}))||null}function ooe(t,e,n,r){if(Aw(n.id===r.id,"layer id changed"),Aw(n.type===r.type,"layer type changed"),n.type==="custom"||r.type==="custom")return;const{layout:a={},paint:l={},filter:u,minzoom:s,maxzoom:m,beforeId:_}=n;if(_!==r.beforeId&&t.moveLayer(e,_),a!==r.layout){const b=r.layout||{};for(const M in a)xl(a[M],b[M])||t.setLayoutProperty(e,M,a[M]);for(const M in b)a.hasOwnProperty(M)||t.setLayoutProperty(e,M,void 0)}if(l!==r.paint){const b=r.paint||{};for(const M in l)xl(l[M],b[M])||t.setPaintProperty(e,M,l[M]);for(const M in b)l.hasOwnProperty(M)||t.setPaintProperty(e,M,void 0)}xl(u,r.filter)||t.setFilter(e,u),(s!==r.minzoom||m!==r.maxzoom)&&t.setLayerZoomRange(e,s,m)}function soe(t,e,n){if(t.style&&t.style._loaded&&(!("source"in n)||t.getSource(n.source))){const r={...n,id:e};delete r.beforeId,t.addLayer(r,n.beforeId)}}let aoe=0;function Dr(t){const e=q.useContext(Ug).map.getMap(),n=q.useRef(t),[,r]=q.useState(0),a=q.useMemo(()=>t.id||`jsx-layer-${aoe++}`,[]);if(q.useEffect(()=>{if(e){const u=()=>r(s=>s+1);return e.on("styledata",u),u(),()=>{e.off("styledata",u),e.style&&e.style._loaded&&e.getLayer(a)&&e.removeLayer(a)}}},[e]),e&&e.style&&e.getLayer(a))try{ooe(e,a,t,n.current)}catch(u){console.warn(u)}else soe(e,a,t);return n.current=t,null}const loe={"text-color":"hsl(42, 10%, 14%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},coe={"text-color":"hsl(42, 10%, 24%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},uoe={"text-color":"hsl(42, 10%, 86%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},hoe={"text-color":"hsl(42, 10%, 76%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},XS={light:{water:"#b2cdfb",land:"#f8f8f8",stateBorder:"#aaa",countryBorder:"#ccc",primaryTextPaint:loe,secondaryTextPaint:coe,hiddenRoad:"#e9e9e8",footprint:"#e9e9e8",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#eeeeffcc",trainLine:"#aaa",trainLabel:"#555c",trainHalo:"#eefc",mapAreaOutline:"#999a"},dark:{water:"#36415d",land:"#1a1a1a",stateBorder:"#555",countryBorder:"#333",primaryTextPaint:uoe,secondaryTextPaint:hoe,hiddenRoad:"#404038",footprint:"#30302f88",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#303028cc",trainLine:"#888",trainLabel:"#eeec",trainHalo:"#303028cc",mapAreaOutline:"#777a"}};var Qb={exports:{}};var doe=Qb.exports,Nk;function foe(){return Nk||(Nk=1,function(t,e){(function(n,r){t.exports=r()})(doe,function(){var n={},r={};function a(u,s,m){if(r[u]=m,u==="index"){var _="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",b={};return r.shared(b),r.index(n,b),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([_],{type:"text/javascript"}))),n}}a("shared",["exports"],function(u){function s(h,i,c,f){return new(c||(c=Promise))(function(v,w){function S($){try{F(f.next($))}catch(G){w(G)}}function I($){try{F(f.throw($))}catch(G){w(G)}}function F($){var G;$.done?v($.value):(G=$.value,G instanceof c?G:new c(function(W){W(G)})).then(S,I)}F((f=f.apply(h,i||[])).next())})}function m(h,i){this.x=h,this.y=i}function _(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var b,M;typeof SuppressedError=="function"&&SuppressedError,m.prototype={clone(){return new m(this.x,this.y)},add(h){return this.clone()._add(h)},sub(h){return this.clone()._sub(h)},multByPoint(h){return this.clone()._multByPoint(h)},divByPoint(h){return this.clone()._divByPoint(h)},mult(h){return this.clone()._mult(h)},div(h){return this.clone()._div(h)},rotate(h){return this.clone()._rotate(h)},rotateAround(h,i){return this.clone()._rotateAround(h,i)},matMult(h){return this.clone()._matMult(h)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(h){return this.x===h.x&&this.y===h.y},dist(h){return Math.sqrt(this.distSqr(h))},distSqr(h){const i=h.x-this.x,c=h.y-this.y;return i*i+c*c},angle(){return Math.atan2(this.y,this.x)},angleTo(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith(h){return this.angleWithSep(h.x,h.y)},angleWithSep(h,i){return Math.atan2(this.x*i-this.y*h,this.x*h+this.y*i)},_matMult(h){const i=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=i,this},_add(h){return this.x+=h.x,this.y+=h.y,this},_sub(h){return this.x-=h.x,this.y-=h.y,this},_mult(h){return this.x*=h,this.y*=h,this},_div(h){return this.x/=h,this.y/=h,this},_multByPoint(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint(h){return this.x/=h.x,this.y/=h.y,this},_unit(){return this._div(this.mag()),this},_perp(){const h=this.y;return this.y=this.x,this.x=-h,this},_rotate(h){const i=Math.cos(h),c=Math.sin(h),f=c*this.x+i*this.y;return this.x=i*this.x-c*this.y,this.y=f,this},_rotateAround(h,i){const c=Math.cos(h),f=Math.sin(h),v=i.y+f*(this.x-i.x)+c*(this.y-i.y);return this.x=i.x+c*(this.x-i.x)-f*(this.y-i.y),this.y=v,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:m},m.convert=function(h){if(h instanceof m)return h;if(Array.isArray(h))return new m(+h[0],+h[1]);if(h.x!==void 0&&h.y!==void 0)return new m(+h.x,+h.y);throw new Error("Expected [x, y] or {x, y} point format")};var C=function(){if(M)return b;function h(i,c,f,v){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(v-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=c,this.p2x=f,this.p2y=v}return M=1,b=h,h.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,c){if(c===void 0&&(c=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,v=0;v<8;v++){var w=this.sampleCurveX(f)-i;if(Math.abs(w)<c)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=w/S}var I=0,F=1;for(f=i,v=0;v<20&&(w=this.sampleCurveX(f),!(Math.abs(w-i)<c));v++)i>w?I=f:F=f,f=.5*(F-I)+I;return f},solve:function(i,c){return this.sampleCurveY(this.solveCurveX(i,c))}},b}(),A=_(C);let k,z;function P(){return k==null&&(k=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),k}function O(){if(z==null&&(z=!1,P())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let f=0;f<5*5;f++){const v=4*f;i.fillStyle=`rgb(${v},${v+1},${v+2})`,i.fillRect(f%5,Math.floor(f/5),1,1)}const c=i.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&c[f]!==f){z=!0;break}}}return z||!1}var j=1e-6,U=typeof Float32Array<"u"?Float32Array:Array;function X(){var h=new U(9);return U!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function K(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function se(){var h=new U(3);return U!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function J(h){var i=h[0],c=h[1],f=h[2];return Math.sqrt(i*i+c*c+f*f)}function ue(h,i,c){var f=new U(3);return f[0]=h,f[1]=i,f[2]=c,f}function ne(h,i,c){return h[0]=i[0]+c[0],h[1]=i[1]+c[1],h[2]=i[2]+c[2],h}function H(h,i,c){return h[0]=i[0]*c,h[1]=i[1]*c,h[2]=i[2]*c,h}function de(h,i,c){var f=i[0],v=i[1],w=i[2],S=c[0],I=c[1],F=c[2];return h[0]=v*F-w*I,h[1]=w*S-f*F,h[2]=f*I-v*S,h}var Ee,Pe=J;function Ze(h,i,c){var f=i[0],v=i[1],w=i[2],S=i[3];return h[0]=c[0]*f+c[4]*v+c[8]*w+c[12]*S,h[1]=c[1]*f+c[5]*v+c[9]*w+c[13]*S,h[2]=c[2]*f+c[6]*v+c[10]*w+c[14]*S,h[3]=c[3]*f+c[7]*v+c[11]*w+c[15]*S,h}function ke(){var h=new U(4);return U!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function Te(h,i,c,f){var v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",w=Math.PI/360;i*=w,f*=w,c*=w;var S=Math.sin(i),I=Math.cos(i),F=Math.sin(c),$=Math.cos(c),G=Math.sin(f),W=Math.cos(f);switch(v){case"xyz":h[0]=S*$*W+I*F*G,h[1]=I*F*W-S*$*G,h[2]=I*$*G+S*F*W,h[3]=I*$*W-S*F*G;break;case"xzy":h[0]=S*$*W-I*F*G,h[1]=I*F*W-S*$*G,h[2]=I*$*G+S*F*W,h[3]=I*$*W+S*F*G;break;case"yxz":h[0]=S*$*W+I*F*G,h[1]=I*F*W-S*$*G,h[2]=I*$*G-S*F*W,h[3]=I*$*W+S*F*G;break;case"yzx":h[0]=S*$*W+I*F*G,h[1]=I*F*W+S*$*G,h[2]=I*$*G-S*F*W,h[3]=I*$*W-S*F*G;break;case"zxy":h[0]=S*$*W-I*F*G,h[1]=I*F*W+S*$*G,h[2]=I*$*G+S*F*W,h[3]=I*$*W-S*F*G;break;case"zyx":h[0]=S*$*W-I*F*G,h[1]=I*F*W+S*$*G,h[2]=I*$*G-S*F*W,h[3]=I*$*W+S*F*G;break;default:throw new Error("Unknown angle order "+v)}return h}function Ie(){var h=new U(2);return U!=Float32Array&&(h[0]=0,h[1]=0),h}function Ce(h,i){var c=new U(2);return c[0]=h,c[1]=i,c}se(),Ee=new U(4),U!=Float32Array&&(Ee[0]=0,Ee[1]=0,Ee[2]=0,Ee[3]=0),se(),ue(1,0,0),ue(0,1,0),ke(),ke(),X(),Ie();const Ue=8192;function nt(h,i,c){return i*(Ue/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}function Le(h,i){return(h%i+i)%i}function lt(h,i,c){return h*(1-c)+i*c}function Ht(h){if(h<=0)return 0;if(h>=1)return 1;const i=h*h,c=i*h;return 4*(h<.5?c:3*(h-i)+c-.75)}function He(h,i,c,f){const v=new A(h,i,c,f);return w=>v.solve(w)}const pt=He(.25,.1,.25,1);function _t(h,i,c){return Math.min(c,Math.max(i,h))}function ot(h,i,c){const f=c-i,v=((h-i)%f+f)%f+i;return v===i?c:v}function et(h,...i){for(const c of i)for(const f in c)h[f]=c[f];return h}let Mt=1;function Tt(h,i,c){const f={};for(const v in h)f[v]=i.call(this,h[v],v,h);return f}function hn(h,i,c){const f={};for(const v in h)i.call(this,h[v],v,h)&&(f[v]=h[v]);return f}function en(h){return Array.isArray(h)?h.map(en):typeof h=="object"&&h?Tt(h,en):h}const an={};function Ke(h){an[h]||(typeof console<"u"&&console.warn(h),an[h]=!0)}function An(h,i,c){return(c.y-h.y)*(i.x-h.x)>(i.y-h.y)*(c.x-h.x)}function Gt(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let on=null;function Wt(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const Gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function dn(h,i,c,f,v){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const w=new VideoFrame(h,{timestamp:0});try{const S=w?.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const I=S.startsWith("BGR"),F=new Uint8ClampedArray(f*v*4);if(yield w.copyTo(F,function($,G,W,te,ie){const pe=4*Math.max(-G,0),me=(Math.max(0,W)-W)*te*4+pe,ve=4*te,Ae=Math.max(0,G),We=Math.max(0,W);return{rect:{x:Ae,y:We,width:Math.min($.width,G+te)-Ae,height:Math.min($.height,W+ie)-We},layout:[{offset:me,stride:ve}]}}(h,i,c,f,v)),I)for(let $=0;$<F.length;$+=4){const G=F[$];F[$]=F[$+2],F[$+2]=G}return F}finally{w.close()}})}let Ve,Se;function bt(h,i,c,f){return h.addEventListener(i,c,f),{unsubscribe:()=>{h.removeEventListener(i,c,f)}}}function Nt(h){return h*Math.PI/180}function jt(h){return h/Math.PI*180}const Ut={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},yn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Zt="AbortError";class qt extends Error{constructor(i=Zt){super(i instanceof Error?i.message:i),this.name=Zt,i instanceof Error&&i.stack&&(this.stack=i.stack)}}function Fn(h){return h.name===Zt}const Be={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ee(h){return Be.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}const oe="global-dispatcher";class fe extends Error{constructor(i,c,f,v){super(`AJAXError: ${c} (${i}): ${f}`),this.status=i,this.statusText=c,this.url=f,this.body=v}}const he=()=>Gt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,xe=function(h,i){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){const f=ee(h.url);if(f)return f(h,i);if(Gt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:oe},i)}if(!(/^file:/.test(c=h.url)||/^file:/.test(he())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,v){return s(this,void 0,void 0,function*(){const w=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:he(),signal:v.signal});let S,I;f.type!=="json"||w.headers.has("Accept")||w.headers.set("Accept","application/json");try{S=yield fetch(w)}catch($){throw Fn($)?$:new fe(0,$.message,f.url,new Blob)}if(!S.ok){const $=yield S.blob();throw new fe(S.status,S.statusText,f.url,$)}I=f.type==="arrayBuffer"||f.type==="image"?S.arrayBuffer():f.type==="json"?S.json():S.text();const F=yield I;return v.signal.throwIfAborted(),{data:F,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(h,i);if(Gt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:oe},i)}var c;return function(f,v){return new Promise((w,S)=>{var I;const F=new XMLHttpRequest;F.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(F.responseType="arraybuffer");for(const $ in f.headers)F.setRequestHeader($,f.headers[$]);f.type==="json"&&(F.responseType="text",!((I=f.headers)===null||I===void 0)&&I.Accept||F.setRequestHeader("Accept","application/json")),F.withCredentials=f.credentials==="include",F.onerror=()=>{S(new Error(F.statusText))},F.onload=()=>{if(!v.signal.aborted)if((F.status>=200&&F.status<300||F.status===0)&&F.response!==null){let $=F.response;if(f.type==="json")try{$=JSON.parse(F.response)}catch(G){return void S(G)}w({data:$,cacheControl:F.getResponseHeader("Cache-Control"),expires:F.getResponseHeader("Expires")})}else{const $=new Blob([F.response],{type:F.getResponseHeader("Content-Type")});S(new fe(F.status,F.statusText,f.url,$))}},v.signal.addEventListener("abort",()=>{F.abort(),S(new qt(v.signal.reason))}),F.send(f.body)})}(h,i)};function Ye(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const i=new URL(h),c=window.location;return i.protocol===c.protocol&&i.host===c.host}function st(h,i,c){c[h]&&c[h].indexOf(i)!==-1||(c[h]=c[h]||[],c[h].push(i))}function _e(h,i,c){if(c&&c[h]){const f=c[h].indexOf(i);f!==-1&&c[h].splice(f,1)}}class Fe{constructor(i,c={}){et(this,c),this.type=i}}class Ge extends Fe{constructor(i,c={}){super("error",et({error:i},c))}}class je{on(i,c){return this._listeners=this._listeners||{},st(i,c,this._listeners),{unsubscribe:()=>{this.off(i,c)}}}off(i,c){return _e(i,c,this._listeners),_e(i,c,this._oneTimeListeners),this}once(i,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},st(i,c,this._oneTimeListeners),this):new Promise(f=>this.once(i,f))}fire(i,c){typeof i=="string"&&(i=new Fe(i,c||{}));const f=i.type;if(this.listens(f)){i.target=this;const v=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const I of v)I.call(this,i);const w=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const I of w)_e(f,I,this._oneTimeListeners),I.call(this,i);const S=this._eventedParent;S&&(et(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(i))}else i instanceof Ge&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,c){return this._eventedParent=i,this._eventedParentData=c,this}}var De={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const zt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function fn(h,i){const c={};for(const f in h)f!=="ref"&&(c[f]=h[f]);return zt.forEach(f=>{f in i&&(c[f]=i[f])}),c}function sn(h,i){if(Array.isArray(h)){if(!Array.isArray(i)||h.length!==i.length)return!1;for(let c=0;c<h.length;c++)if(!sn(h[c],i[c]))return!1;return!0}if(typeof h=="object"&&h!==null&&i!==null){if(typeof i!="object"||Object.keys(h).length!==Object.keys(i).length)return!1;for(const c in h)if(!sn(h[c],i[c]))return!1;return!0}return h===i}function Jt(h,i){h.push(i)}function cn(h,i,c){Jt(c,{command:"addSource",args:[h,i[h]]})}function Zn(h,i,c){Jt(i,{command:"removeSource",args:[h]}),c[h]=!0}function yr(h,i,c,f){Zn(h,c,f),cn(h,i,c)}function Ar(h,i,c){let f;for(f in h[c])if(Object.prototype.hasOwnProperty.call(h[c],f)&&f!=="data"&&!sn(h[c][f],i[c][f]))return!1;for(f in i[c])if(Object.prototype.hasOwnProperty.call(i[c],f)&&f!=="data"&&!sn(h[c][f],i[c][f]))return!1;return!0}function Je(h,i,c,f,v,w){h=h||{},i=i||{};for(const S in h)Object.prototype.hasOwnProperty.call(h,S)&&(sn(h[S],i[S])||c.push({command:w,args:[f,S,i[S],v]}));for(const S in i)Object.prototype.hasOwnProperty.call(i,S)&&!Object.prototype.hasOwnProperty.call(h,S)&&(sn(h[S],i[S])||c.push({command:w,args:[f,S,i[S],v]}))}function gt(h){return h.id}function St(h,i){return h[i.id]=i,h}class ft{constructor(i,c,f,v){this.message=(i?`${i}: `:"")+f,v&&(this.identifier=v),c!=null&&c.__line__&&(this.line=c.__line__)}}function Qt(h,...i){for(const c of i)for(const f in c)h[f]=c[f];return h}class Sn extends Error{constructor(i,c){super(c),this.message=c,this.key=i}}class Un{constructor(i,c=[]){this.parent=i,this.bindings={};for(const[f,v]of c)this.bindings[f]=v}concat(i){return new Un(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const kn={kind:"null"},Rt={kind:"number"},ct={kind:"string"},ut={kind:"boolean"},Vt={kind:"color"},En={kind:"projectionDefinition"},Bn={kind:"object"},In={kind:"value"},fr={kind:"collator"},Re={kind:"formatted"},mt={kind:"padding"},Lt={kind:"colorArray"},Et={kind:"numberArray"},wt={kind:"resolvedImage"},un={kind:"variableAnchorOffsetCollection"};function _n(h,i){return{kind:"array",itemType:h,N:i}}function pn(h){if(h.kind==="array"){const i=pn(h.itemType);return typeof h.N=="number"?`array<${i}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${i}>`}return h.kind}const jn=[kn,Rt,ct,ut,Vt,En,Re,Bn,_n(In),mt,Et,Lt,wt,un];function mn(h,i){if(i.kind==="error")return null;if(h.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!mn(h.itemType,i.itemType))&&(typeof h.N!="number"||h.N===i.N))return null}else{if(h.kind===i.kind)return null;if(h.kind==="value"){for(const c of jn)if(!mn(c,i))return null}}return`Expected ${pn(h)} but found ${pn(i)} instead.`}function Wn(h,i){return i.some(c=>c.kind===h.kind)}function Pn(h,i){return i.some(c=>c==="null"?h===null:c==="array"?Array.isArray(h):c==="object"?h&&!Array.isArray(h)&&typeof h=="object":c===typeof h)}function Rn(h,i){return h.kind==="array"&&i.kind==="array"?h.itemType.kind===i.itemType.kind&&typeof h.N=="number":h.kind===i.kind}const Qn=.96422,Ir=.82521,wr=4/29,On=6/29,or=3*On*On,gi=On*On*On,Cr=Math.PI/180,zo=180/Math.PI;function Ll(h){return(h%=360)<0&&(h+=360),h}function Go([h,i,c,f]){let v,w;const S=ei((.2225045*(h=ea(h))+.7168786*(i=ea(i))+.0606169*(c=ea(c)))/1);h===i&&i===c?v=w=S:(v=ei((.4360747*h+.3850649*i+.1430804*c)/Qn),w=ei((.0139322*h+.0971045*i+.7141733*c)/Ir));const I=116*S-16;return[I<0?0:I,500*(v-S),200*(S-w),f]}function ea(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function ei(h){return h>gi?Math.pow(h,1/3):h/or+wr}function _o([h,i,c,f]){let v=(h+16)/116,w=isNaN(i)?v:v+i/500,S=isNaN(c)?v:v-c/200;return v=1*uo(v),w=Qn*uo(w),S=Ir*uo(S),[eo(3.1338561*w-1.6168667*v-.4906146*S),eo(-.9787684*w+1.9161415*v+.033454*S),eo(.0719453*w-.2289914*v+1.4052427*S),f]}function eo(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function uo(h){return h>On?h*h*h:or*(h-wr)}const xo=Object.hasOwn||function(h,i){return Object.prototype.hasOwnProperty.call(h,i)};function kr(h,i){return xo(h,i)?h[i]:void 0}function Us(h){return parseInt(h.padEnd(2,h),16)/255}function gm(h,i){return yc(i?h/100:h,0,1)}function yc(h,i,c){return Math.min(Math.max(i,h),c)}function Mf(h){return!h.some(Number.isNaN)}const ch={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function kl(h,i,c){return h+c*(i-h)}function _c(h,i,c){return h.map((f,v)=>kl(f,i[v],c))}class _r{constructor(i,c,f,v=1,w=!0){this.r=i,this.g=c,this.b=f,this.a=v,w||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter("rgb",[i,c,f,v]))}static parse(i){if(i instanceof _r)return i;if(typeof i!="string")return;const c=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const v=kr(ch,f);if(v){const[S,I,F]=v;return[S/255,I/255,F/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const S=f.length<6?1:2;let I=1;return[Us(f.slice(I,I+=S)),Us(f.slice(I,I+=S)),Us(f.slice(I,I+=S)),Us(f.slice(I,I+S)||"ff")]}if(f.startsWith("rgb")){const S=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[I,F,$,G,W,te,ie,pe,me,ve,Ae,We]=S,Me=[G||" ",ie||" ",ve].join("");if(Me==="  "||Me==="  /"||Me===",,"||Me===",,,"){const Oe=[$,te,me].join(""),tt=Oe==="%%%"?100:Oe===""?255:0;if(tt){const dt=[yc(+F/tt,0,1),yc(+W/tt,0,1),yc(+pe/tt,0,1),Ae?gm(+Ae,We):1];if(Mf(dt))return dt}}return}}const w=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[S,I,F,$,G,W,te,ie,pe]=w,me=[F||" ",G||" ",te].join("");if(me==="  "||me==="  /"||me===",,"||me===",,,"){const ve=[+I,yc(+$,0,100),yc(+W,0,100),ie?gm(+ie,pe):1];if(Mf(ve))return function([Ae,We,Me,Oe]){function tt(dt){const Ct=(dt+Ae/30)%12,Xt=We*Math.min(Me,1-Me);return Me-Xt*Math.max(-1,Math.min(Ct-3,9-Ct,1))}return Ae=Ll(Ae),We/=100,Me/=100,[tt(0),tt(8),tt(4),Oe]}(ve)}}}(i);return c?new _r(...c,!1):void 0}get rgb(){const{r:i,g:c,b:f,a:v}=this,w=v||1/0;return this.overwriteGetter("rgb",[i/w,c/w,f/w,v])}get hcl(){return this.overwriteGetter("hcl",function(i){const[c,f,v,w]=Go(i),S=Math.sqrt(f*f+v*v);return[Math.round(1e4*S)?Ll(Math.atan2(v,f)*zo):NaN,S,c,w]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Go(this.rgb))}overwriteGetter(i,c){return Object.defineProperty(this,i,{value:c}),c}toString(){const[i,c,f,v]=this.rgb;return`rgba(${[i,c,f].map(w=>Math.round(255*w)).join(",")},${v})`}static interpolate(i,c,f,v="rgb"){switch(v){case"rgb":{const[w,S,I,F]=_c(i.rgb,c.rgb,f);return new _r(w,S,I,F,!1)}case"hcl":{const[w,S,I,F]=i.hcl,[$,G,W,te]=c.hcl;let ie,pe;if(isNaN(w)||isNaN($))isNaN(w)?isNaN($)?ie=NaN:(ie=$,I!==1&&I!==0||(pe=G)):(ie=w,W!==1&&W!==0||(pe=S));else{let Me=$-w;$>w&&Me>180?Me-=360:$<w&&w-$>180&&(Me+=360),ie=w+f*Me}const[me,ve,Ae,We]=function([Me,Oe,tt,dt]){return Me=isNaN(Me)?0:Me*Cr,_o([tt,Math.cos(Me)*Oe,Math.sin(Me)*Oe,dt])}([ie,pe??kl(S,G,f),kl(I,W,f),kl(F,te,f)]);return new _r(me,ve,Ae,We,!1)}case"lab":{const[w,S,I,F]=_o(_c(i.lab,c.lab,f));return new _r(w,S,I,F,!1)}}}}_r.black=new _r(0,0,0,1),_r.white=new _r(1,1,1,1),_r.transparent=new _r(0,0,0,0),_r.red=new _r(1,0,0,1);class Za{constructor(i,c,f){this.sensitivity=i?c?"variant":"case":c?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,c){return this.collator.compare(i,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const xc=["bottom","center","top"];class Ya{constructor(i,c,f,v,w,S){this.text=i,this.image=c,this.scale=f,this.fontStack=v,this.textColor=w,this.verticalAlign=S}}class bo{constructor(i){this.sections=i}static fromString(i){return new bo([new Ya(i,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof bo?i:bo.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class to{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof to)return i;if(typeof i=="number")return new to([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const c of i)if(typeof c!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new to(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,c,f){return new to(_c(i.values,c.values,f))}}class Zr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Zr)return i;if(typeof i=="number")return new Zr([i]);if(Array.isArray(i)){for(const c of i)if(typeof c!="number")return;return new Zr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,c,f){return new Zr(_c(i.values,c.values,f))}}class dr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof dr)return i;if(typeof i=="string"){const f=_r.parse(i);return f?new dr([f]):void 0}if(!Array.isArray(i))return;const c=[];for(const f of i){if(typeof f!="string")return;const v=_r.parse(f);if(!v)return;c.push(v)}return new dr(c)}toString(){return JSON.stringify(this.values)}static interpolate(i,c,f,v="rgb"){const w=[];if(i.values.length!=c.values.length)throw new Error(`colorArray: Arrays have mismatched length (${i.values.length} vs. ${c.values.length}), cannot interpolate.`);for(let S=0;S<i.values.length;S++)w.push(_r.interpolate(i.values[S],c.values[S],f,v));return new dr(w)}}class ti extends Error{constructor(i){super(i),this.name="RuntimeError"}toJSON(){return this.message}}const ta=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class os{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof os)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let c=0;c<i.length;c+=2){const f=i[c],v=i[c+1];if(typeof f!="string"||!ta.has(f)||!Array.isArray(v)||v.length!==2||typeof v[0]!="number"||typeof v[1]!="number")return}return new os(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,c,f){const v=i.values,w=c.values;if(v.length!==w.length)throw new ti(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${c.toString()}`);const S=[];for(let I=0;I<v.length;I+=2){if(v[I]!==w[I])throw new ti(`Cannot interpolate values containing mismatched anchors. from[${I}]: ${v[I]}, to[${I}]: ${w[I]}`);S.push(v[I]);const[F,$]=v[I+1],[G,W]=w[I+1];S.push([kl(F,G,f),kl($,W,f)])}return new os(S)}}class _s{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new _s({name:i,available:!1}):null}}class wo{constructor(i,c,f){this.from=i,this.to=c,this.transition=f}static interpolate(i,c,f){return new wo(i,c,f)}static parse(i){return i instanceof wo?i:Array.isArray(i)&&i.length===3&&typeof i[0]=="string"&&typeof i[1]=="string"&&typeof i[2]=="number"?new wo(i[0],i[1],i[2]):typeof i=="object"&&typeof i.from=="string"&&typeof i.to=="string"&&typeof i.transition=="number"?new wo(i.from,i.to,i.transition):typeof i=="string"?new wo(i,i,1):void 0}}function lu(h,i,c,f){return typeof h=="number"&&h>=0&&h<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof c=="number"&&c>=0&&c<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[h,i,c,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[h,i,c,f]:[h,i,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function bc(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof wo||h instanceof _r||h instanceof Za||h instanceof bo||h instanceof to||h instanceof Zr||h instanceof dr||h instanceof os||h instanceof _s)return!0;if(Array.isArray(h)){for(const i of h)if(!bc(i))return!1;return!0}if(typeof h=="object"){for(const i in h)if(!bc(h[i]))return!1;return!0}return!1}function vi(h){if(h===null)return kn;if(typeof h=="string")return ct;if(typeof h=="boolean")return ut;if(typeof h=="number")return Rt;if(h instanceof _r)return Vt;if(h instanceof wo)return En;if(h instanceof Za)return fr;if(h instanceof bo)return Re;if(h instanceof to)return mt;if(h instanceof Zr)return Et;if(h instanceof dr)return Lt;if(h instanceof os)return un;if(h instanceof _s)return wt;if(Array.isArray(h)){const i=h.length;let c;for(const f of h){const v=vi(f);if(c){if(c===v)continue;c=In;break}c=v}return _n(c||In,i)}return Bn}function Ea(h){const i=typeof h;return h===null?"":i==="string"||i==="number"||i==="boolean"?String(h):h instanceof _r||h instanceof wo||h instanceof bo||h instanceof to||h instanceof Zr||h instanceof dr||h instanceof os||h instanceof _s?h.toString():JSON.stringify(h)}class ss{constructor(i,c){this.type=i,this.value=c}static parse(i,c){if(i.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!bc(i[1]))return c.error("invalid value");const f=i[1];let v=vi(f);const w=c.expectedType;return v.kind!=="array"||v.N!==0||!w||w.kind!=="array"||typeof w.N=="number"&&w.N!==0||(v=w),new ss(v,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const cu={string:ct,number:Rt,boolean:ut,object:Bn};class xs{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");let f,v=1;const w=i[0];if(w==="array"){let I,F;if(i.length>2){const $=i[1];if(typeof $!="string"||!($ in cu)||$==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);I=cu[$],v++}else I=In;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return c.error('The length argument to "array" must be a positive integer literal',2);F=i[2],v++}f=_n(I,F)}else{if(!cu[w])throw new Error(`Types doesn't contain name = ${w}`);f=cu[w]}const S=[];for(;v<i.length;v++){const I=c.parse(i[v],v,In);if(!I)return null;S.push(I)}return new xs(f,S)}evaluate(i){for(let c=0;c<this.args.length;c++){const f=this.args[c].evaluate(i);if(!mn(this.type,vi(f)))return f;if(c===this.args.length-1)throw new ti(`Expected value to be of type ${pn(this.type)}, but found ${pn(vi(f))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const uu={"to-boolean":ut,"to-color":Vt,"to-number":Rt,"to-string":ct};class Ca{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const f=i[0];if(!uu[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&i.length!==2)return c.error("Expected one argument.");const v=uu[f],w=[];for(let S=1;S<i.length;S++){const I=c.parse(i[S],S,In);if(!I)return null;w.push(I)}return new Ca(v,w)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let c,f;for(const v of this.args){if(c=v.evaluate(i),f=null,c instanceof _r)return c;if(typeof c=="string"){const w=i.parseColor(c);if(w)return w}else if(Array.isArray(c)&&(f=c.length<3||c.length>4?`Invalid rgba value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:lu(c[0],c[1],c[2],c[3]),!f))return new _r(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new ti(f||`Could not parse color from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"padding":{let c;for(const f of this.args){c=f.evaluate(i);const v=to.parse(c);if(v)return v}throw new ti(`Could not parse padding from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"numberArray":{let c;for(const f of this.args){c=f.evaluate(i);const v=Zr.parse(c);if(v)return v}throw new ti(`Could not parse numberArray from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"colorArray":{let c;for(const f of this.args){c=f.evaluate(i);const v=dr.parse(c);if(v)return v}throw new ti(`Could not parse colorArray from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"variableAnchorOffsetCollection":{let c;for(const f of this.args){c=f.evaluate(i);const v=os.parse(c);if(v)return v}throw new ti(`Could not parse variableAnchorOffsetCollection from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"number":{let c=null;for(const f of this.args){if(c=f.evaluate(i),c===null)return 0;const v=Number(c);if(!isNaN(v))return v}throw new ti(`Could not convert ${JSON.stringify(c)} to number.`)}case"formatted":return bo.fromString(Ea(this.args[0].evaluate(i)));case"resolvedImage":return _s.fromString(Ea(this.args[0].evaluate(i)));case"projectionDefinition":return this.args[0].evaluate(i);default:return Ea(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const fd=["Unknown","Point","LineString","Polygon"];class pd{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?fd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let c=this._parseColorCache.get(i);return c||(c=_r.parse(i),this._parseColorCache.set(i,c)),c}}class wc{constructor(i,c,f=[],v,w=new Un,S=[]){this.registry=i,this.path=f,this.key=f.map(I=>`[${I}]`).join(""),this.scope=w,this.errors=S,this.expectedType=v,this._isConstant=c}parse(i,c,f,v,w={}){return c?this.concat(c,f,v)._parse(i,w):this._parse(i,w)}_parse(i,c){function f(v,w,S){return S==="assert"?new xs(w,[v]):S==="coerce"?new Ca(w,[v]):v}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=i[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const w=this.registry[v];if(w){let S=w.parse(i,this);if(!S)return null;if(this.expectedType){const I=this.expectedType,F=S.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||F.kind!=="value"){if(I.kind==="projectionDefinition"&&["string","array"].includes(F.kind)||["color","formatted","resolvedImage"].includes(I.kind)&&["value","string"].includes(F.kind)||["padding","numberArray"].includes(I.kind)&&["value","number","array"].includes(F.kind)||I.kind==="colorArray"&&["value","string","array"].includes(F.kind)||I.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(F.kind))S=f(S,I,c.typeAnnotation||"coerce");else if(this.checkSubtype(I,F))return null}else S=f(S,I,c.typeAnnotation||"assert")}if(!(S instanceof ss)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const I=new pd;try{S=new ss(S.type,S.evaluate(I))}catch(F){return this.error(F.message),null}}return S}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,c,f){const v=typeof i=="number"?this.path.concat(i):this.path,w=f?this.scope.concat(f):this.scope;return new wc(this.registry,this._isConstant,v,c||null,w,this.errors)}error(i,...c){const f=`${this.key}${c.map(v=>`[${v}]`).join("")}`;this.errors.push(new Sn(f,i))}checkSubtype(i,c){const f=mn(i,c);return f&&this.error(f),f}}class Br{constructor(i,c){this.type=c.type,this.bindings=[].concat(i),this.result=c}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const c of this.bindings)i(c[1]);i(this.result)}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const f=[];for(let w=1;w<i.length-1;w+=2){const S=i[w];if(typeof S!="string")return c.error(`Expected string, but found ${typeof S} instead.`,w);if(/[^a-zA-Z0-9_]/.test(S))return c.error("Variable names must contain only alphanumeric characters or '_'.",w);const I=c.parse(i[w+1],w+1);if(!I)return null;f.push([S,I])}const v=c.parse(i[i.length-1],i.length-1,c.expectedType,f);return v?new Br(f,v):null}outputDefined(){return this.result.outputDefined()}}class Sc{constructor(i,c){this.type=c.type,this.name=i,this.boundExpression=c}static parse(i,c){if(i.length!==2||typeof i[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const f=i[1];return c.scope.has(f)?new Sc(f,c.scope.get(f)):c.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Pr{constructor(i,c,f){this.type=i,this.index=c,this.input=f}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=c.parse(i[1],1,Rt),v=c.parse(i[2],2,_n(c.expectedType||In));return f&&v?new Pr(v.type.itemType,f,v):null}evaluate(i){const c=this.index.evaluate(i),f=this.input.evaluate(i);if(c<0)throw new ti(`Array index out of bounds: ${c} < 0.`);if(c>=f.length)throw new ti(`Array index out of bounds: ${c} > ${f.length-1}.`);if(c!==Math.floor(c))throw new ti(`Array index must be an integer, but found ${c} instead.`);return f[c]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class xr{constructor(i,c){this.type=ut,this.needle=i,this.haystack=c}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const f=c.parse(i[1],1,In),v=c.parse(i[2],2,In);return f&&v?Wn(f.type,[ut,ct,Rt,kn,In])?new xr(f,v):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${pn(f.type)} instead`):null}evaluate(i){const c=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!f)return!1;if(!Pn(c,["boolean","string","number","null"]))throw new ti(`Expected first argument to be of type boolean, string, number or null, but found ${pn(vi(c))} instead.`);if(!Pn(f,["string","array"]))throw new ti(`Expected second argument to be of type array or string, but found ${pn(vi(f))} instead.`);return f.indexOf(c)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class zl{constructor(i,c,f){this.type=Rt,this.needle=i,this.haystack=c,this.fromIndex=f}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 2 or 3 arguments, but found ${i.length-1} instead.`);const f=c.parse(i[1],1,In),v=c.parse(i[2],2,In);if(!f||!v)return null;if(!Wn(f.type,[ut,ct,Rt,kn,In]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${pn(f.type)} instead`);if(i.length===4){const w=c.parse(i[3],3,Rt);return w?new zl(f,v,w):null}return new zl(f,v)}evaluate(i){const c=this.needle.evaluate(i),f=this.haystack.evaluate(i);if(!Pn(c,["boolean","string","number","null"]))throw new ti(`Expected first argument to be of type boolean, string, number or null, but found ${pn(vi(c))} instead.`);let v;if(this.fromIndex&&(v=this.fromIndex.evaluate(i)),Pn(f,["string"])){const w=f.indexOf(c,v);return w===-1?-1:[...f.slice(0,w)].length}if(Pn(f,["array"]))return f.indexOf(c,v);throw new ti(`Expected second argument to be of type array or string, but found ${pn(vi(f))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class Rr{constructor(i,c,f,v,w,S){this.inputType=i,this.type=c,this.input=f,this.cases=v,this.outputs=w,this.otherwise=S}static parse(i,c){if(i.length<5)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return c.error("Expected an even number of arguments.");let f,v;c.expectedType&&c.expectedType.kind!=="value"&&(v=c.expectedType);const w={},S=[];for(let $=2;$<i.length-1;$+=2){let G=i[$];const W=i[$+1];Array.isArray(G)||(G=[G]);const te=c.concat($);if(G.length===0)return te.error("Expected at least one branch label.");for(const pe of G){if(typeof pe!="number"&&typeof pe!="string")return te.error("Branch labels must be numbers or strings.");if(typeof pe=="number"&&Math.abs(pe)>Number.MAX_SAFE_INTEGER)return te.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof pe=="number"&&Math.floor(pe)!==pe)return te.error("Numeric branch labels must be integer values.");if(f){if(te.checkSubtype(f,vi(pe)))return null}else f=vi(pe);if(w[String(pe)]!==void 0)return te.error("Branch labels must be unique.");w[String(pe)]=S.length}const ie=c.parse(W,$,v);if(!ie)return null;v=v||ie.type,S.push(ie)}const I=c.parse(i[1],1,In);if(!I)return null;const F=c.parse(i[i.length-1],i.length-1,v);return F?I.type.kind!=="value"&&c.concat(1).checkSubtype(f,I.type)?null:new Rr(f,v,I,w,S,F):null}evaluate(i){const c=this.input.evaluate(i);return(vi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class uh{constructor(i,c,f){this.type=i,this.branches=c,this.otherwise=f}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return c.error("Expected an odd number of arguments.");let f;c.expectedType&&c.expectedType.kind!=="value"&&(f=c.expectedType);const v=[];for(let S=1;S<i.length-1;S+=2){const I=c.parse(i[S],S,ut);if(!I)return null;const F=c.parse(i[S+1],S+1,f);if(!F)return null;v.push([I,F]),f=f||F.type}const w=c.parse(i[i.length-1],i.length-1,f);if(!w)return null;if(!f)throw new Error("Can't infer output type");return new uh(f,v,w)}evaluate(i){for(const[c,f]of this.branches)if(c.evaluate(i))return f.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[c,f]of this.branches)i(c),i(f);i(this.otherwise)}outputDefined(){return this.branches.every(([i,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class zi{constructor(i,c,f,v){this.type=i,this.input=c,this.beginIndex=f,this.endIndex=v}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 2 or 3 arguments, but found ${i.length-1} instead.`);const f=c.parse(i[1],1,In),v=c.parse(i[2],2,Rt);if(!f||!v)return null;if(!Wn(f.type,[_n(In),ct,In]))return c.error(`Expected first argument to be of type array or string, but found ${pn(f.type)} instead`);if(i.length===4){const w=c.parse(i[3],3,Rt);return w?new zi(f.type,f,v,w):null}return new zi(f.type,f,v)}evaluate(i){const c=this.input.evaluate(i),f=this.beginIndex.evaluate(i);let v;if(this.endIndex&&(v=this.endIndex.evaluate(i)),Pn(c,["string"]))return[...c].slice(f,v).join("");if(Pn(c,["array"]))return c.slice(f,v);throw new ti(`Expected first argument to be of type array or string, but found ${pn(vi(c))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function Ta(h,i){const c=h.length-1;let f,v,w=0,S=c,I=0;for(;w<=S;)if(I=Math.floor((w+S)/2),f=h[I],v=h[I+1],f<=i){if(I===c||i<v)return I;w=I+1}else{if(!(f>i))throw new ti("Input is not a number.");S=I-1}return 0}class Ka{constructor(i,c,f){this.type=i,this.input=c,this.labels=[],this.outputs=[];for(const[v,w]of f)this.labels.push(v),this.outputs.push(w)}static parse(i,c){if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");const f=c.parse(i[1],1,Rt);if(!f)return null;const v=[];let w=null;c.expectedType&&c.expectedType.kind!=="value"&&(w=c.expectedType);for(let S=1;S<i.length;S+=2){const I=S===1?-1/0:i[S],F=i[S+1],$=S,G=S+1;if(typeof I!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(v.length&&v[v.length-1][0]>=I)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',$);const W=c.parse(F,G,w);if(!W)return null;w=w||W.type,v.push([I,W])}return new Ka(w,f,v)}evaluate(i){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(i);const v=this.input.evaluate(i);if(v<=c[0])return f[0].evaluate(i);const w=c.length;return v>=c[w-1]?f[w-1].evaluate(i):f[Ta(c,v)].evaluate(i)}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function hh(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var md,gd,vm=function(){if(gd)return md;function h(i,c,f,v){this.cx=3*i,this.bx=3*(f-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(v-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=c,this.p2x=f,this.p2y=v}return gd=1,md=h,h.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,c){if(c===void 0&&(c=1e-6),i<0)return 0;if(i>1)return 1;for(var f=i,v=0;v<8;v++){var w=this.sampleCurveX(f)-i;if(Math.abs(w)<c)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=w/S}var I=0,F=1;for(f=i,v=0;v<20&&(w=this.sampleCurveX(f),!(Math.abs(w-i)<c));v++)i>w?I=f:F=f,f=.5*(F-I)+I;return f},solve:function(i,c){return this.sampleCurveY(this.solveCurveX(i,c))}},md}(),dh=hh(vm);class So{constructor(i,c,f,v,w){this.type=i,this.operator=c,this.interpolation=f,this.input=v,this.labels=[],this.outputs=[];for(const[S,I]of w)this.labels.push(S),this.outputs.push(I)}static interpolationFactor(i,c,f,v){let w=0;if(i.name==="exponential")w=Pa(c,i.base,f,v);else if(i.name==="linear")w=Pa(c,1,f,v);else if(i.name==="cubic-bezier"){const S=i.controlPoints;w=new dh(S[0],S[1],S[2],S[3]).solve(Pa(c,1,f,v))}return w}static parse(i,c){let[f,v,w,...S]=i;if(!Array.isArray(v)||v.length===0)return c.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const $=v[1];if(typeof $!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:$}}else{if(v[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const $=v.slice(1);if($.length!==4||$.some(G=>typeof G!="number"||G<0||G>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:$}}}if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(w=c.parse(w,2,Rt),!w)return null;const I=[];let F=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||c.expectedType==Lt?c.expectedType&&c.expectedType.kind!=="value"&&(F=c.expectedType):F=Vt;for(let $=0;$<S.length;$+=2){const G=S[$],W=S[$+1],te=$+3,ie=$+4;if(typeof G!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',te);if(I.length&&I[I.length-1][0]>=G)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',te);const pe=c.parse(W,ie,F);if(!pe)return null;F=F||pe.type,I.push([G,pe])}return Rn(F,Rt)||Rn(F,En)||Rn(F,Vt)||Rn(F,mt)||Rn(F,Et)||Rn(F,Lt)||Rn(F,un)||Rn(F,_n(Rt))?new So(F,f,v,w,I):c.error(`Type ${pn(F)} is not interpolatable.`)}evaluate(i){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(i);const v=this.input.evaluate(i);if(v<=c[0])return f[0].evaluate(i);const w=c.length;if(v>=c[w-1])return f[w-1].evaluate(i);const S=Ta(c,v),I=So.interpolationFactor(this.interpolation,v,c[S],c[S+1]),F=f[S].evaluate(i),$=f[S+1].evaluate(i);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return kl(F,$,I);case"color":return _r.interpolate(F,$,I);case"padding":return to.interpolate(F,$,I);case"colorArray":return dr.interpolate(F,$,I);case"numberArray":return Zr.interpolate(F,$,I);case"variableAnchorOffsetCollection":return os.interpolate(F,$,I);case"array":return _c(F,$,I);case"projectionDefinition":return wo.interpolate(F,$,I)}case"interpolate-hcl":switch(this.type.kind){case"color":return _r.interpolate(F,$,I,"hcl");case"colorArray":return dr.interpolate(F,$,I,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return _r.interpolate(F,$,I,"lab");case"colorArray":return dr.interpolate(F,$,I,"lab")}}}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Pa(h,i,c,f){const v=f-c,w=h-c;return v===0?0:i===1?w/v:(Math.pow(i,w)-1)/(Math.pow(i,v)-1)}const Ai={color:_r.interpolate,number:kl,padding:to.interpolate,numberArray:Zr.interpolate,colorArray:dr.interpolate,variableAnchorOffsetCollection:os.interpolate,array:_c};class hu{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");let f=null;const v=c.expectedType;v&&v.kind!=="value"&&(f=v);const w=[];for(const I of i.slice(1)){const F=c.parse(I,1+w.length,f,void 0,{typeAnnotation:"omit"});if(!F)return null;f=f||F.type,w.push(F)}if(!f)throw new Error("No output type");const S=v&&w.some(I=>mn(v,I.type));return new hu(S?In:f,w)}evaluate(i){let c,f=null,v=0;for(const w of this.args)if(v++,f=w.evaluate(i),f&&f instanceof _s&&!f.available&&(c||(c=f.name),f=null,v===this.args.length&&(f=c)),f!==null)break;return f}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function ym(h,i){return h==="=="||h==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function du(h,i,c,f){return f.compare(i,c)===0}function Ui(h,i,c){const f=h!=="=="&&h!=="!=";return class P6{constructor(w,S,I){this.type=ut,this.lhs=w,this.rhs=S,this.collator=I,this.hasUntypedArgument=w.type.kind==="value"||S.type.kind==="value"}static parse(w,S){if(w.length!==3&&w.length!==4)return S.error("Expected two or three arguments.");const I=w[0];let F=S.parse(w[1],1,In);if(!F)return null;if(!ym(I,F.type))return S.concat(1).error(`"${I}" comparisons are not supported for type '${pn(F.type)}'.`);let $=S.parse(w[2],2,In);if(!$)return null;if(!ym(I,$.type))return S.concat(2).error(`"${I}" comparisons are not supported for type '${pn($.type)}'.`);if(F.type.kind!==$.type.kind&&F.type.kind!=="value"&&$.type.kind!=="value")return S.error(`Cannot compare types '${pn(F.type)}' and '${pn($.type)}'.`);f&&(F.type.kind==="value"&&$.type.kind!=="value"?F=new xs($.type,[F]):F.type.kind!=="value"&&$.type.kind==="value"&&($=new xs(F.type,[$])));let G=null;if(w.length===4){if(F.type.kind!=="string"&&$.type.kind!=="string"&&F.type.kind!=="value"&&$.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(G=S.parse(w[3],3,fr),!G)return null}return new P6(F,$,G)}evaluate(w){const S=this.lhs.evaluate(w),I=this.rhs.evaluate(w);if(f&&this.hasUntypedArgument){const F=vi(S),$=vi(I);if(F.kind!==$.kind||F.kind!=="string"&&F.kind!=="number")throw new ti(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${F.kind}, ${$.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const F=vi(S),$=vi(I);if(F.kind!=="string"||$.kind!=="string")return i(w,S,I)}return this.collator?c(w,S,I,this.collator.evaluate(w)):i(w,S,I)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}}}const jg=Ui("==",function(h,i,c){return i===c},du),_m=Ui("!=",function(h,i,c){return i!==c},function(h,i,c,f){return!du(0,i,c,f)}),Hg=Ui("<",function(h,i,c){return i<c},function(h,i,c,f){return f.compare(i,c)<0}),i0=Ui(">",function(h,i,c){return i>c},function(h,i,c,f){return f.compare(i,c)>0}),fu=Ui("<=",function(h,i,c){return i<=c},function(h,i,c,f){return f.compare(i,c)<=0}),Ef=Ui(">=",function(h,i,c){return i>=c},function(h,i,c,f){return f.compare(i,c)>=0});class fh{constructor(i,c,f){this.type=fr,this.locale=f,this.caseSensitive=i,this.diacriticSensitive=c}static parse(i,c){if(i.length!==2)return c.error("Expected one argument.");const f=i[1];if(typeof f!="object"||Array.isArray(f))return c.error("Collator options argument must be an object.");const v=c.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,ut);if(!v)return null;const w=c.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,ut);if(!w)return null;let S=null;return f.locale&&(S=c.parse(f.locale,1,ct),!S)?null:new fh(v,w,S)}evaluate(i){return new Za(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class xm{constructor(i,c,f,v,w){this.type=ct,this.number=i,this.locale=c,this.currency=f,this.minFractionDigits=v,this.maxFractionDigits=w}static parse(i,c){if(i.length!==3)return c.error("Expected two arguments.");const f=c.parse(i[1],1,Rt);if(!f)return null;const v=i[2];if(typeof v!="object"||Array.isArray(v))return c.error("NumberFormat options argument must be an object.");let w=null;if(v.locale&&(w=c.parse(v.locale,1,ct),!w))return null;let S=null;if(v.currency&&(S=c.parse(v.currency,1,ct),!S))return null;let I=null;if(v["min-fraction-digits"]&&(I=c.parse(v["min-fraction-digits"],1,Rt),!I))return null;let F=null;return v["max-fraction-digits"]&&(F=c.parse(v["max-fraction-digits"],1,Rt),!F)?null:new xm(f,w,S,I,F)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class vd{constructor(i){this.type=Re,this.sections=i}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const f=i[1];if(!Array.isArray(f)&&typeof f=="object")return c.error("First argument must be an image or text section.");const v=[];let w=!1;for(let S=1;S<=i.length-1;++S){const I=i[S];if(w&&typeof I=="object"&&!Array.isArray(I)){w=!1;let F=null;if(I["font-scale"]&&(F=c.parse(I["font-scale"],1,Rt),!F))return null;let $=null;if(I["text-font"]&&($=c.parse(I["text-font"],1,_n(ct)),!$))return null;let G=null;if(I["text-color"]&&(G=c.parse(I["text-color"],1,Vt),!G))return null;let W=null;if(I["vertical-align"]){if(typeof I["vertical-align"]=="string"&&!xc.includes(I["vertical-align"]))return c.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${I["vertical-align"]}' instead.`);if(W=c.parse(I["vertical-align"],1,ct),!W)return null}const te=v[v.length-1];te.scale=F,te.font=$,te.textColor=G,te.verticalAlign=W}else{const F=c.parse(i[S],1,In);if(!F)return null;const $=F.type.kind;if($!=="string"&&$!=="value"&&$!=="null"&&$!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,v.push({content:F,scale:null,font:null,textColor:null,verticalAlign:null})}}return new vd(v)}evaluate(i){return new bo(this.sections.map(c=>{const f=c.content.evaluate(i);return vi(f)===wt?new Ya("",f,null,null,null,c.verticalAlign?c.verticalAlign.evaluate(i):null):new Ya(Ea(f),null,c.scale?c.scale.evaluate(i):null,c.font?c.font.evaluate(i).join(","):null,c.textColor?c.textColor.evaluate(i):null,c.verticalAlign?c.verticalAlign.evaluate(i):null)}))}eachChild(i){for(const c of this.sections)i(c.content),c.scale&&i(c.scale),c.font&&i(c.font),c.textColor&&i(c.textColor),c.verticalAlign&&i(c.verticalAlign)}outputDefined(){return!1}}class Mc{constructor(i){this.type=wt,this.input=i}static parse(i,c){if(i.length!==2)return c.error("Expected two arguments.");const f=c.parse(i[1],1,ct);return f?new Mc(f):c.error("No image name provided.")}evaluate(i){const c=this.input.evaluate(i),f=_s.fromString(c);return f&&i.availableImages&&(f.available=i.availableImages.indexOf(c)>-1),f}eachChild(i){i(this.input)}outputDefined(){return!1}}class ph{constructor(i){this.type=Rt,this.input=i}static parse(i,c){if(i.length!==2)return c.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=c.parse(i[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${pn(f.type)} instead.`):new ph(f):null}evaluate(i){const c=this.input.evaluate(i);if(typeof c=="string")return[...c].length;if(Array.isArray(c))return c.length;throw new ti(`Expected value to be of type string or array, but found ${pn(vi(c))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const no=8192;function Gg(h,i){const c=(180+h[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,v=Math.pow(2,i.z);return[Math.round(c*v*no),Math.round(f*v*no)]}function pu(h,i){const c=Math.pow(2,i.z);return[(v=(h[0]/no+i.x)/c,360*v-180),(f=(h[1]/no+i.y)/c,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,v}function yd(h,i){h[0]=Math.min(h[0],i[0]),h[1]=Math.min(h[1],i[1]),h[2]=Math.max(h[2],i[0]),h[3]=Math.max(h[3],i[1])}function mu(h,i){return!(h[0]<=i[0]||h[2]>=i[2]||h[1]<=i[1]||h[3]>=i[3])}function o0(h,i,c){const f=h[0]-i[0],v=h[1]-i[1],w=h[0]-c[0],S=h[1]-c[1];return f*S-w*v==0&&f*w<=0&&v*S<=0}function Cf(h,i,c,f){return(v=[f[0]-c[0],f[1]-c[1]])[0]*(w=[i[0]-h[0],i[1]-h[1]])[1]-v[1]*w[0]!=0&&!(!bm(h,i,c,f)||!bm(c,f,h,i));var v,w}function s0(h,i,c){for(const f of c)for(let v=0;v<f.length-1;++v)if(Cf(h,i,f[v],f[v+1]))return!0;return!1}function mh(h,i,c=!1){let f=!1;for(const I of i)for(let F=0;F<I.length-1;F++){if(o0(h,I[F],I[F+1]))return c;(w=I[F])[1]>(v=h)[1]!=(S=I[F+1])[1]>v[1]&&v[0]<(S[0]-w[0])*(v[1]-w[1])/(S[1]-w[1])+w[0]&&(f=!f)}var v,w,S;return f}function Tf(h,i){for(const c of i)if(mh(h,c))return!0;return!1}function Pf(h,i){for(const c of h)if(!mh(c,i))return!1;for(let c=0;c<h.length-1;++c)if(s0(h[c],h[c+1],i))return!1;return!0}function gh(h,i){for(const c of i)if(Pf(h,c))return!0;return!1}function bm(h,i,c,f){const v=f[0]-c[0],w=f[1]-c[1],S=(h[0]-c[0])*w-v*(h[1]-c[1]),I=(i[0]-c[0])*w-v*(i[1]-c[1]);return S>0&&I<0||S<0&&I>0}function Af(h,i,c){const f=[];for(let v=0;v<h.length;v++){const w=[];for(let S=0;S<h[v].length;S++){const I=Gg(h[v][S],c);yd(i,I),w.push(I)}f.push(w)}return f}function If(h,i,c){const f=[];for(let v=0;v<h.length;v++){const w=Af(h[v],i,c);f.push(w)}return f}function wm(h,i,c,f){if(h[0]<c[0]||h[0]>c[2]){const v=.5*f;let w=h[0]-c[0]>v?-f:c[0]-h[0]>v?f:0;w===0&&(w=h[0]-c[2]>v?-f:c[2]-h[0]>v?f:0),h[0]+=w}yd(i,h)}function Sm(h,i,c,f){const v=Math.pow(2,f.z)*no,w=[f.x*no,f.y*no],S=[];for(const I of h)for(const F of I){const $=[F.x+w[0],F.y+w[1]];wm($,i,c,v),S.push($)}return S}function Mm(h,i,c,f){const v=Math.pow(2,f.z)*no,w=[f.x*no,f.y*no],S=[];for(const F of h){const $=[];for(const G of F){const W=[G.x+w[0],G.y+w[1]];yd(i,W),$.push(W)}S.push($)}if(i[2]-i[0]<=v/2){(I=i)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const F of S)for(const $ of F)wm($,i,c,v)}var I;return S}class na{constructor(i,c){this.type=ut,this.geojson=i,this.geometries=c}static parse(i,c){if(i.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(bc(i[1])){const f=i[1];if(f.type==="FeatureCollection"){const v=[];for(const w of f.features){const{type:S,coordinates:I}=w.geometry;S==="Polygon"&&v.push(I),S==="MultiPolygon"&&v.push(...I)}if(v.length)return new na(f,{type:"MultiPolygon",coordinates:v})}else if(f.type==="Feature"){const v=f.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new na(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new na(f,f)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(c,f){const v=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],S=c.canonicalID();if(f.type==="Polygon"){const I=Af(f.coordinates,w,S),F=Sm(c.geometry(),v,w,S);if(!mu(v,w))return!1;for(const $ of F)if(!mh($,I))return!1}if(f.type==="MultiPolygon"){const I=If(f.coordinates,w,S),F=Sm(c.geometry(),v,w,S);if(!mu(v,w))return!1;for(const $ of F)if(!Tf($,I))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(c,f){const v=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],S=c.canonicalID();if(f.type==="Polygon"){const I=Af(f.coordinates,w,S),F=Mm(c.geometry(),v,w,S);if(!mu(v,w))return!1;for(const $ of F)if(!Pf($,I))return!1}if(f.type==="MultiPolygon"){const I=If(f.coordinates,w,S),F=Mm(c.geometry(),v,w,S);if(!mu(v,w))return!1;for(const $ of F)if(!gh($,I))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Wg=class{constructor(h=[],i=(c,f)=>c<f?-1:c>f?1:0){if(this.data=h,this.length=this.data.length,this.compare=i,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:i,compare:c}=this,f=i[h];for(;h>0;){const v=h-1>>1,w=i[v];if(c(f,w)>=0)break;i[h]=w,h=v}i[h]=f}_down(h){const{data:i,compare:c}=this,f=this.length>>1,v=i[h];for(;h<f;){let w=1+(h<<1);const S=w+1;if(S<this.length&&c(i[S],i[w])<0&&(w=S),c(i[w],v)>=0)break;i[h]=i[w],h=w}i[h]=v}};function Em(h,i,c=0,f=h.length-1,v=Cm){for(;f>c;){if(f-c>600){const F=f-c+1,$=i-c+1,G=Math.log(F),W=.5*Math.exp(2*G/3),te=.5*Math.sqrt(G*W*(F-W)/F)*($-F/2<0?-1:1);Em(h,i,Math.max(c,Math.floor(i-$*W/F+te)),Math.min(f,Math.floor(i+(F-$)*W/F+te)),v)}const w=h[i];let S=c,I=f;for(vh(h,c,i),v(h[f],w)>0&&vh(h,c,f);S<I;){for(vh(h,S,I),S++,I--;v(h[S],w)<0;)S++;for(;v(h[I],w)>0;)I--}v(h[c],w)===0?vh(h,c,I):(I++,vh(h,I,f)),I<=i&&(c=I+1),i<=I&&(f=I-1)}}function vh(h,i,c){const f=h[i];h[i]=h[c],h[c]=f}function Cm(h,i){return h<i?-1:h>i?1:0}function _d(h,i){if(h.length<=1)return[h];const c=[];let f,v;for(const w of h){const S=bd(w);S!==0&&(w.area=Math.abs(S),v===void 0&&(v=S<0),v===S<0?(f&&c.push(f),f=[w]):f.push(w))}if(f&&c.push(f),i>1)for(let w=0;w<c.length;w++)c[w].length<=i||(Em(c[w],i,1,c[w].length-1,xd),c[w]=c[w].slice(0,i));return c}function xd(h,i){return i.area-h.area}function bd(h){let i=0;for(let c,f,v=0,w=h.length,S=w-1;v<w;S=v++)c=h[v],f=h[S],i+=(f.x-c.x)*(c.y+f.y);return i}const qg=1/298.257223563,Ec=qg*(2-qg),Xg=Math.PI/180;class Rf{constructor(i){const c=6378.137*Xg*1e3,f=Math.cos(i*Xg),v=1/(1-Ec*(1-f*f)),w=Math.sqrt(v);this.kx=c*w*f,this.ky=c*w*v*(1-Ec)}distance(i,c){const f=this.wrap(i[0]-c[0])*this.kx,v=(i[1]-c[1])*this.ky;return Math.sqrt(f*f+v*v)}pointOnLine(i,c){let f,v,w,S,I=1/0;for(let F=0;F<i.length-1;F++){let $=i[F][0],G=i[F][1],W=this.wrap(i[F+1][0]-$)*this.kx,te=(i[F+1][1]-G)*this.ky,ie=0;W===0&&te===0||(ie=(this.wrap(c[0]-$)*this.kx*W+(c[1]-G)*this.ky*te)/(W*W+te*te),ie>1?($=i[F+1][0],G=i[F+1][1]):ie>0&&($+=W/this.kx*ie,G+=te/this.ky*ie)),W=this.wrap(c[0]-$)*this.kx,te=(c[1]-G)*this.ky;const pe=W*W+te*te;pe<I&&(I=pe,f=$,v=G,w=F,S=ie)}return{point:[f,v],index:w,t:Math.max(0,Math.min(1,S))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function Df(h,i){return i[0]-h[0]}function yh(h){return h[1]-h[0]+1}function ra(h,i){return h[1]>=h[0]&&h[1]<i}function wd(h,i){if(h[0]>h[1])return[null,null];const c=yh(h);if(i){if(c===2)return[h,null];const v=Math.floor(c/2);return[[h[0],h[0]+v],[h[0]+v,h[1]]]}if(c===1)return[h,null];const f=Math.floor(c/2)-1;return[[h[0],h[0]+f],[h[0]+f+1,h[1]]]}function Lf(h,i){if(!ra(i,h.length))return[1/0,1/0,-1/0,-1/0];const c=[1/0,1/0,-1/0,-1/0];for(let f=i[0];f<=i[1];++f)yd(c,h[f]);return c}function Tm(h){const i=[1/0,1/0,-1/0,-1/0];for(const c of h)for(const f of c)yd(i,f);return i}function Pm(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function kf(h,i,c){if(!Pm(h)||!Pm(i))return NaN;let f=0,v=0;return h[2]<i[0]&&(f=i[0]-h[2]),h[0]>i[2]&&(f=h[0]-i[2]),h[1]>i[3]&&(v=h[1]-i[3]),h[3]<i[1]&&(v=i[1]-h[3]),c.distance([0,0],[f,v])}function gu(h,i,c){const f=c.pointOnLine(i,h);return c.distance(h,f.point)}function Am(h,i,c,f,v){const w=Math.min(gu(h,[c,f],v),gu(i,[c,f],v)),S=Math.min(gu(c,[h,i],v),gu(f,[h,i],v));return Math.min(w,S)}function Aa(h,i,c,f,v){if(!ra(i,h.length)||!ra(f,c.length))return 1/0;let w=1/0;for(let S=i[0];S<i[1];++S){const I=h[S],F=h[S+1];for(let $=f[0];$<f[1];++$){const G=c[$],W=c[$+1];if(Cf(I,F,G,W))return 0;w=Math.min(w,Am(I,F,G,W,v))}}return w}function _h(h,i,c,f,v){if(!ra(i,h.length)||!ra(f,c.length))return NaN;let w=1/0;for(let S=i[0];S<=i[1];++S)for(let I=f[0];I<=f[1];++I)if(w=Math.min(w,v.distance(h[S],c[I])),w===0)return w;return w}function Zg(h,i,c){if(mh(h,i,!0))return 0;let f=1/0;for(const v of i){const w=v[0],S=v[v.length-1];if(w!==S&&(f=Math.min(f,gu(h,[S,w],c)),f===0))return f;const I=c.pointOnLine(v,h);if(f=Math.min(f,c.distance(h,I.point)),f===0)return f}return f}function Yg(h,i,c,f){if(!ra(i,h.length))return NaN;for(let w=i[0];w<=i[1];++w)if(mh(h[w],c,!0))return 0;let v=1/0;for(let w=i[0];w<i[1];++w){const S=h[w],I=h[w+1];for(const F of c)for(let $=0,G=F.length,W=G-1;$<G;W=$++){const te=F[W],ie=F[$];if(Cf(S,I,te,ie))return 0;v=Math.min(v,Am(S,I,te,ie,f))}}return v}function Im(h,i){for(const c of h)for(const f of c)if(mh(f,i,!0))return!0;return!1}function Kg(h,i,c,f=1/0){const v=Tm(h),w=Tm(i);if(f!==1/0&&kf(v,w,c)>=f)return f;if(mu(v,w)){if(Im(h,i))return 0}else if(Im(i,h))return 0;let S=1/0;for(const I of h)for(let F=0,$=I.length,G=$-1;F<$;G=F++){const W=I[G],te=I[F];for(const ie of i)for(let pe=0,me=ie.length,ve=me-1;pe<me;ve=pe++){const Ae=ie[ve],We=ie[pe];if(Cf(W,te,Ae,We))return 0;S=Math.min(S,Am(W,te,Ae,We,c))}}return S}function Ur(h,i,c,f,v,w){if(!w)return;const S=kf(Lf(f,w),v,c);S<i&&h.push([S,w,[0,0]])}function zf(h,i,c,f,v,w,S){if(!w||!S)return;const I=kf(Lf(f,w),Lf(v,S),c);I<i&&h.push([I,w,S])}function Of(h,i,c,f,v=1/0){let w=Math.min(f.distance(h[0],c[0][0]),v);if(w===0)return w;const S=new Wg([[0,[0,h.length-1],[0,0]]],Df),I=Tm(c);for(;S.length>0;){const F=S.pop();if(F[0]>=w)continue;const $=F[1],G=i?50:100;if(yh($)<=G){if(!ra($,h.length))return NaN;if(i){const W=Yg(h,$,c,f);if(isNaN(W)||W===0)return W;w=Math.min(w,W)}else for(let W=$[0];W<=$[1];++W){const te=Zg(h[W],c,f);if(w=Math.min(w,te),w===0)return 0}}else{const W=wd($,i);Ur(S,w,f,h,I,W[0]),Ur(S,w,f,h,I,W[1])}}return w}function Ol(h,i,c,f,v,w=1/0){let S=Math.min(w,v.distance(h[0],c[0]));if(S===0)return S;const I=new Wg([[0,[0,h.length-1],[0,c.length-1]]],Df);for(;I.length>0;){const F=I.pop();if(F[0]>=S)continue;const $=F[1],G=F[2],W=i?50:100,te=f?50:100;if(yh($)<=W&&yh(G)<=te){if(!ra($,h.length)&&ra(G,c.length))return NaN;let ie;if(i&&f)ie=Aa(h,$,c,G,v),S=Math.min(S,ie);else if(i&&!f){const pe=h.slice($[0],$[1]+1);for(let me=G[0];me<=G[1];++me)if(ie=gu(c[me],pe,v),S=Math.min(S,ie),S===0)return S}else if(!i&&f){const pe=c.slice(G[0],G[1]+1);for(let me=$[0];me<=$[1];++me)if(ie=gu(h[me],pe,v),S=Math.min(S,ie),S===0)return S}else ie=_h(h,$,c,G,v),S=Math.min(S,ie)}else{const ie=wd($,i),pe=wd(G,f);zf(I,S,v,h,c,ie[0],pe[0]),zf(I,S,v,h,c,ie[0],pe[1]),zf(I,S,v,h,c,ie[1],pe[0]),zf(I,S,v,h,c,ie[1],pe[1])}}return S}function Sd(h){return h.type==="MultiPolygon"?h.coordinates.map(i=>({type:"Polygon",coordinates:i})):h.type==="MultiLineString"?h.coordinates.map(i=>({type:"LineString",coordinates:i})):h.type==="MultiPoint"?h.coordinates.map(i=>({type:"Point",coordinates:i})):[h]}class Ia{constructor(i,c){this.type=Rt,this.geojson=i,this.geometries=c}static parse(i,c){if(i.length!==2)return c.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(bc(i[1])){const f=i[1];if(f.type==="FeatureCollection")return new Ia(f,f.features.map(v=>Sd(v.geometry)).flat());if(f.type==="Feature")return new Ia(f,Sd(f.geometry));if("type"in f&&"coordinates"in f)return new Ia(f,Sd(f))}return c.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(c,f){const v=c.geometry(),w=v.flat().map(F=>pu([F.x,F.y],c.canonical));if(v.length===0)return NaN;const S=new Rf(w[0][1]);let I=1/0;for(const F of f){switch(F.type){case"Point":I=Math.min(I,Ol(w,!1,[F.coordinates],!1,S,I));break;case"LineString":I=Math.min(I,Ol(w,!1,F.coordinates,!0,S,I));break;case"Polygon":I=Math.min(I,Of(w,!1,F.coordinates,S,I))}if(I===0)return I}return I}(i,this.geometries);if(i.geometryType()==="LineString")return function(c,f){const v=c.geometry(),w=v.flat().map(F=>pu([F.x,F.y],c.canonical));if(v.length===0)return NaN;const S=new Rf(w[0][1]);let I=1/0;for(const F of f){switch(F.type){case"Point":I=Math.min(I,Ol(w,!0,[F.coordinates],!1,S,I));break;case"LineString":I=Math.min(I,Ol(w,!0,F.coordinates,!0,S,I));break;case"Polygon":I=Math.min(I,Of(w,!0,F.coordinates,S,I))}if(I===0)return I}return I}(i,this.geometries);if(i.geometryType()==="Polygon")return function(c,f){const v=c.geometry();if(v.length===0||v[0].length===0)return NaN;const w=_d(v,0).map(F=>F.map($=>$.map(G=>pu([G.x,G.y],c.canonical)))),S=new Rf(w[0][0][0][1]);let I=1/0;for(const F of f)for(const $ of w){switch(F.type){case"Point":I=Math.min(I,Of([F.coordinates],!1,$,S,I));break;case"LineString":I=Math.min(I,Of(F.coordinates,!0,$,S,I));break;case"Polygon":I=Math.min(I,Kg($,F.coordinates,S,I))}if(I===0)return I}return I}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class vu{constructor(i){this.type=In,this.key=i}static parse(i,c){if(i.length!==2)return c.error(`Expected 1 argument, but found ${i.length-1} instead.`);const f=i[1];return f==null?c.error("Global state property must be defined."):typeof f!="string"?c.error(`Global state property must be string, but found ${typeof i[1]} instead.`):new vu(f)}evaluate(i){var c;const f=(c=i.globals)===null||c===void 0?void 0:c.globalState;return f&&Object.keys(f).length!==0?kr(f,this.key):null}eachChild(){}outputDefined(){return!1}}const yu={"==":jg,"!=":_m,">":i0,"<":Hg,">=":Ef,"<=":fu,array:xs,at:Pr,boolean:xs,case:uh,coalesce:hu,collator:fh,format:vd,image:Mc,in:xr,"index-of":zl,interpolate:So,"interpolate-hcl":So,"interpolate-lab":So,length:ph,let:Br,literal:ss,match:Rr,number:xs,"number-format":xm,object:xs,slice:zi,step:Ka,string:xs,"to-boolean":Ca,"to-color":Ca,"to-number":Ca,"to-string":Ca,var:Sc,within:na,distance:Ia,"global-state":vu};class as{constructor(i,c,f,v){this.name=i,this.type=c,this._evaluate=f,this.args=v}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,c){const f=i[0],v=as.definitions[f];if(!v)return c.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const w=Array.isArray(v)?v[0]:v.type,S=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,I=S.filter(([$])=>!Array.isArray($)||$.length===i.length-1);let F=null;for(const[$,G]of I){F=new wc(c.registry,Md,c.path,null,c.scope);const W=[];let te=!1;for(let ie=1;ie<i.length;ie++){const pe=i[ie],me=Array.isArray($)?$[ie-1]:$.type,ve=F.parse(pe,1+W.length,me);if(!ve){te=!0;break}W.push(ve)}if(!te)if(Array.isArray($)&&$.length!==W.length)F.error(`Expected ${$.length} arguments, but found ${W.length} instead.`);else{for(let ie=0;ie<W.length;ie++){const pe=Array.isArray($)?$[ie]:$.type,me=W[ie];F.concat(ie+1).checkSubtype(pe,me.type)}if(F.errors.length===0)return new as(f,w,G,W)}}if(I.length===1)c.errors.push(...F.errors);else{const $=(I.length?I:S).map(([W])=>{return te=W,Array.isArray(te)?`(${te.map(pn).join(", ")})`:`(${pn(te.type)}...)`;var te}).join(" | "),G=[];for(let W=1;W<i.length;W++){const te=c.parse(i[W],1+G.length);if(!te)return null;G.push(pn(te.type))}c.error(`Expected arguments of type ${$}, but found (${G.join(", ")}) instead.`)}return null}static register(i,c){as.definitions=c;for(const f in c)i[f]=as}}function _u(h,[i,c,f,v]){i=i.evaluate(h),c=c.evaluate(h),f=f.evaluate(h);const w=v?v.evaluate(h):1,S=lu(i,c,f,w);if(S)throw new ti(S);return new _r(i/255,c/255,f/255,w,!1)}function Ff(h,i){return h in i}function Nf(h,i){const c=i[h];return c===void 0?null:c}function Ja(h){return{type:h}}function Md(h){if(h instanceof Sc)return Md(h.boundExpression);if(h instanceof as&&h.name==="error"||h instanceof fh||h instanceof na||h instanceof Ia||h instanceof vu)return!1;const i=h instanceof Ca||h instanceof xs;let c=!0;return h.eachChild(f=>{c=i?c&&Md(f):c&&f instanceof ss}),!!c&&Ed(h)&&Cd(h,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Ed(h){if(h instanceof as&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof na||h instanceof Ia)return!1;let i=!0;return h.eachChild(c=>{i&&!Ed(c)&&(i=!1)}),i}function xh(h){if(h instanceof as&&h.name==="feature-state")return!1;let i=!0;return h.eachChild(c=>{i&&!xh(c)&&(i=!1)}),i}function Cd(h,i){if(h instanceof as&&i.indexOf(h.name)>=0)return!1;let c=!0;return h.eachChild(f=>{c&&!Cd(f,i)&&(c=!1)}),c}function Rm(h){return{result:"success",value:h}}function xu(h){return{result:"error",value:h}}function $s(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function Bf(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function Td(h){return!!h.expression&&h.expression.interpolated}function Tr(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Uf(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)&&vi(h)===Bn}function Pd(h){return h}function Jg(h,i){const c=h.stops&&typeof h.stops[0][0]=="object",f=c||!(c||h.property!==void 0),v=h.type||(Td(i)?"exponential":"interval"),w=function(G){switch(G.type){case"color":return _r.parse;case"padding":return to.parse;case"numberArray":return Zr.parse;case"colorArray":return dr.parse;default:return null}}(i);if(w&&((h=Qt({},h)).stops&&(h.stops=h.stops.map(G=>[G[0],w(G[1])])),h.default=w(h.default?h.default:i.default)),h.colorSpace&&(S=h.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var S;const I=function(G){switch(G){case"exponential":return $f;case"interval":return Ii;case"categorical":return Qg;case"identity":return Vf;default:throw new Error(`Unknown function type "${G}"`)}}(v);let F,$;if(v==="categorical"){F=Object.create(null);for(const G of h.stops)F[G[0]]=G[1];$=typeof h.stops[0][0]}if(c){const G={},W=[];for(let pe=0;pe<h.stops.length;pe++){const me=h.stops[pe],ve=me[0].zoom;G[ve]===void 0&&(G[ve]={zoom:ve,type:h.type,property:h.property,default:h.default,stops:[]},W.push(ve)),G[ve].stops.push([me[0].value,me[1]])}const te=[];for(const pe of W)te.push([G[pe].zoom,Jg(G[pe],i)]);const ie={name:"linear"};return{kind:"composite",interpolationType:ie,interpolationFactor:So.interpolationFactor.bind(void 0,ie),zoomStops:te.map(pe=>pe[0]),evaluate:({zoom:pe},me)=>$f({stops:te,base:h.base},i,pe).evaluate(pe,me)}}if(f){const G=v==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:G,interpolationFactor:So.interpolationFactor.bind(void 0,G),zoomStops:h.stops.map(W=>W[0]),evaluate:({zoom:W})=>I(h,i,W,F,$)}}return{kind:"source",evaluate(G,W){const te=W&&W.properties?W.properties[h.property]:void 0;return te===void 0?bh(h.default,i.default):I(h,i,te,F,$)}}}function bh(h,i,c){return h!==void 0?h:i!==void 0?i:c!==void 0?c:void 0}function Qg(h,i,c,f,v){return bh(typeof c===v?f[c]:void 0,h.default,i.default)}function Ii(h,i,c){if(Tr(c)!=="number")return bh(h.default,i.default);const f=h.stops.length;if(f===1||c<=h.stops[0][0])return h.stops[0][1];if(c>=h.stops[f-1][0])return h.stops[f-1][1];const v=Ta(h.stops.map(w=>w[0]),c);return h.stops[v][1]}function $f(h,i,c){const f=h.base!==void 0?h.base:1;if(Tr(c)!=="number")return bh(h.default,i.default);const v=h.stops.length;if(v===1||c<=h.stops[0][0])return h.stops[0][1];if(c>=h.stops[v-1][0])return h.stops[v-1][1];const w=Ta(h.stops.map(G=>G[0]),c),S=function(G,W,te,ie){const pe=ie-te,me=G-te;return pe===0?0:W===1?me/pe:(Math.pow(W,me)-1)/(Math.pow(W,pe)-1)}(c,f,h.stops[w][0],h.stops[w+1][0]),I=h.stops[w][1],F=h.stops[w+1][1],$=Ai[i.type]||Pd;return typeof I.evaluate=="function"?{evaluate(...G){const W=I.evaluate.apply(void 0,G),te=F.evaluate.apply(void 0,G);if(W!==void 0&&te!==void 0)return $(W,te,S,h.colorSpace)}}:$(I,F,S,h.colorSpace)}function Vf(h,i,c){switch(i.type){case"color":c=_r.parse(c);break;case"formatted":c=bo.fromString(c.toString());break;case"resolvedImage":c=_s.fromString(c.toString());break;case"padding":c=to.parse(c);break;case"colorArray":c=dr.parse(c);break;case"numberArray":c=Zr.parse(c);break;default:Tr(c)===i.type||i.type==="enum"&&i.values[c]||(c=void 0)}return bh(c,h.default,i.default)}as.register(yu,{error:[{kind:"error"},[ct],(h,[i])=>{throw new ti(i.evaluate(h))}],typeof:[ct,[In],(h,[i])=>pn(vi(i.evaluate(h)))],"to-rgba":[_n(Rt,4),[Vt],(h,[i])=>{const[c,f,v,w]=i.evaluate(h).rgb;return[255*c,255*f,255*v,w]}],rgb:[Vt,[Rt,Rt,Rt],_u],rgba:[Vt,[Rt,Rt,Rt,Rt],_u],has:{type:ut,overloads:[[[ct],(h,[i])=>Ff(i.evaluate(h),h.properties())],[[ct,Bn],(h,[i,c])=>Ff(i.evaluate(h),c.evaluate(h))]]},get:{type:In,overloads:[[[ct],(h,[i])=>Nf(i.evaluate(h),h.properties())],[[ct,Bn],(h,[i,c])=>Nf(i.evaluate(h),c.evaluate(h))]]},"feature-state":[In,[ct],(h,[i])=>Nf(i.evaluate(h),h.featureState||{})],properties:[Bn,[],h=>h.properties()],"geometry-type":[ct,[],h=>h.geometryType()],id:[In,[],h=>h.id()],zoom:[Rt,[],h=>h.globals.zoom],"heatmap-density":[Rt,[],h=>h.globals.heatmapDensity||0],elevation:[Rt,[],h=>h.globals.elevation||0],"line-progress":[Rt,[],h=>h.globals.lineProgress||0],accumulated:[In,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[Rt,Ja(Rt),(h,i)=>{let c=0;for(const f of i)c+=f.evaluate(h);return c}],"*":[Rt,Ja(Rt),(h,i)=>{let c=1;for(const f of i)c*=f.evaluate(h);return c}],"-":{type:Rt,overloads:[[[Rt,Rt],(h,[i,c])=>i.evaluate(h)-c.evaluate(h)],[[Rt],(h,[i])=>-i.evaluate(h)]]},"/":[Rt,[Rt,Rt],(h,[i,c])=>i.evaluate(h)/c.evaluate(h)],"%":[Rt,[Rt,Rt],(h,[i,c])=>i.evaluate(h)%c.evaluate(h)],ln2:[Rt,[],()=>Math.LN2],pi:[Rt,[],()=>Math.PI],e:[Rt,[],()=>Math.E],"^":[Rt,[Rt,Rt],(h,[i,c])=>Math.pow(i.evaluate(h),c.evaluate(h))],sqrt:[Rt,[Rt],(h,[i])=>Math.sqrt(i.evaluate(h))],log10:[Rt,[Rt],(h,[i])=>Math.log(i.evaluate(h))/Math.LN10],ln:[Rt,[Rt],(h,[i])=>Math.log(i.evaluate(h))],log2:[Rt,[Rt],(h,[i])=>Math.log(i.evaluate(h))/Math.LN2],sin:[Rt,[Rt],(h,[i])=>Math.sin(i.evaluate(h))],cos:[Rt,[Rt],(h,[i])=>Math.cos(i.evaluate(h))],tan:[Rt,[Rt],(h,[i])=>Math.tan(i.evaluate(h))],asin:[Rt,[Rt],(h,[i])=>Math.asin(i.evaluate(h))],acos:[Rt,[Rt],(h,[i])=>Math.acos(i.evaluate(h))],atan:[Rt,[Rt],(h,[i])=>Math.atan(i.evaluate(h))],min:[Rt,Ja(Rt),(h,i)=>Math.min(...i.map(c=>c.evaluate(h)))],max:[Rt,Ja(Rt),(h,i)=>Math.max(...i.map(c=>c.evaluate(h)))],abs:[Rt,[Rt],(h,[i])=>Math.abs(i.evaluate(h))],round:[Rt,[Rt],(h,[i])=>{const c=i.evaluate(h);return c<0?-Math.round(-c):Math.round(c)}],floor:[Rt,[Rt],(h,[i])=>Math.floor(i.evaluate(h))],ceil:[Rt,[Rt],(h,[i])=>Math.ceil(i.evaluate(h))],"filter-==":[ut,[ct,In],(h,[i,c])=>h.properties()[i.value]===c.value],"filter-id-==":[ut,[In],(h,[i])=>h.id()===i.value],"filter-type-==":[ut,[ct],(h,[i])=>h.geometryType()===i.value],"filter-<":[ut,[ct,In],(h,[i,c])=>{const f=h.properties()[i.value],v=c.value;return typeof f==typeof v&&f<v}],"filter-id-<":[ut,[In],(h,[i])=>{const c=h.id(),f=i.value;return typeof c==typeof f&&c<f}],"filter->":[ut,[ct,In],(h,[i,c])=>{const f=h.properties()[i.value],v=c.value;return typeof f==typeof v&&f>v}],"filter-id->":[ut,[In],(h,[i])=>{const c=h.id(),f=i.value;return typeof c==typeof f&&c>f}],"filter-<=":[ut,[ct,In],(h,[i,c])=>{const f=h.properties()[i.value],v=c.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[ut,[In],(h,[i])=>{const c=h.id(),f=i.value;return typeof c==typeof f&&c<=f}],"filter->=":[ut,[ct,In],(h,[i,c])=>{const f=h.properties()[i.value],v=c.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[ut,[In],(h,[i])=>{const c=h.id(),f=i.value;return typeof c==typeof f&&c>=f}],"filter-has":[ut,[In],(h,[i])=>i.value in h.properties()],"filter-has-id":[ut,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[ut,[_n(ct)],(h,[i])=>i.value.indexOf(h.geometryType())>=0],"filter-id-in":[ut,[_n(In)],(h,[i])=>i.value.indexOf(h.id())>=0],"filter-in-small":[ut,[ct,_n(In)],(h,[i,c])=>c.value.indexOf(h.properties()[i.value])>=0],"filter-in-large":[ut,[ct,_n(In)],(h,[i,c])=>function(f,v,w,S){for(;w<=S;){const I=w+S>>1;if(v[I]===f)return!0;v[I]>f?S=I-1:w=I+1}return!1}(h.properties()[i.value],c.value,0,c.value.length-1)],all:{type:ut,overloads:[[[ut,ut],(h,[i,c])=>i.evaluate(h)&&c.evaluate(h)],[Ja(ut),(h,i)=>{for(const c of i)if(!c.evaluate(h))return!1;return!0}]]},any:{type:ut,overloads:[[[ut,ut],(h,[i,c])=>i.evaluate(h)||c.evaluate(h)],[Ja(ut),(h,i)=>{for(const c of i)if(c.evaluate(h))return!0;return!1}]]},"!":[ut,[ut],(h,[i])=>!i.evaluate(h)],"is-supported-script":[ut,[ct],(h,[i])=>{const c=h.globals&&h.globals.isSupportedScript;return!c||c(i.evaluate(h))}],upcase:[ct,[ct],(h,[i])=>i.evaluate(h).toUpperCase()],downcase:[ct,[ct],(h,[i])=>i.evaluate(h).toLowerCase()],concat:[ct,Ja(In),(h,i)=>i.map(c=>Ea(c.evaluate(h))).join("")],"resolved-locale":[ct,[fr],(h,[i])=>i.evaluate(h).resolvedLocale()]});class bu{constructor(i,c,f){this.expression=i,this._warningHistory={},this._evaluator=new pd,this._defaultValue=c?function(v){if(v.type==="color"&&Uf(v.default))return new _r(0,0,0,0);switch(v.type){case"color":return _r.parse(v.default)||null;case"padding":return to.parse(v.default)||null;case"numberArray":return Zr.parse(v.default)||null;case"colorArray":return dr.parse(v.default)||null;case"variableAnchorOffsetCollection":return os.parse(v.default)||null;case"projectionDefinition":return wo.parse(v.default)||null;default:return v.default===void 0?null:v.default}}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null,this._globalState=f}evaluateWithoutErrorHandling(i,c,f,v,w,S){return this._globalState&&(i=Ac(i,this._globalState)),this._evaluator.globals=i,this._evaluator.feature=c,this._evaluator.featureState=f,this._evaluator.canonical=v,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(i,c,f,v,w,S){this._globalState&&(i=Ac(i,this._globalState)),this._evaluator.globals=i,this._evaluator.feature=c||null,this._evaluator.featureState=f||null,this._evaluator.canonical=v,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=S||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new ti(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function wu(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in yu}function Su(h,i,c){const f=new wc(yu,Md,[],i?function(w){const S={color:Vt,string:ct,number:Rt,enum:ct,boolean:ut,formatted:Re,padding:mt,numberArray:Et,colorArray:Lt,projectionDefinition:En,resolvedImage:wt,variableAnchorOffsetCollection:un};return w.type==="array"?_n(S[w.value]||In,w.length):S[w.type]}(i):void 0),v=f.parse(h,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?Rm(new bu(v,i,c)):xu(f.errors)}class Cc{constructor(i,c,f){this.kind=i,this._styleExpression=c,this.isStateDependent=i!=="constant"&&!xh(c.expression),this.globalStateRefs=Pc(c.expression),this._globalState=f}evaluateWithoutErrorHandling(i,c,f,v,w,S){return this._globalState&&(i=Ac(i,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(i,c,f,v,w,S)}evaluate(i,c,f,v,w,S){return this._globalState&&(i=Ac(i,this._globalState)),this._styleExpression.evaluate(i,c,f,v,w,S)}}class wh{constructor(i,c,f,v,w){this.kind=i,this.zoomStops=f,this._styleExpression=c,this.isStateDependent=i!=="camera"&&!xh(c.expression),this.globalStateRefs=Pc(c.expression),this.interpolationType=v,this._globalState=w}evaluateWithoutErrorHandling(i,c,f,v,w,S){return this._globalState&&(i=Ac(i,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(i,c,f,v,w,S)}evaluate(i,c,f,v,w,S){return this._globalState&&(i=Ac(i,this._globalState)),this._styleExpression.evaluate(i,c,f,v,w,S)}interpolationFactor(i,c,f){return this.interpolationType?So.interpolationFactor(this.interpolationType,i,c,f):0}}function Tc(h,i,c){const f=Su(h,i,c);if(f.result==="error")return f;const v=f.value.expression,w=Ed(v);if(!w&&!$s(i))return xu([new Sn("","data expressions not supported")]);const S=Cd(v,["zoom"]);if(!S&&!Bf(i))return xu([new Sn("","zoom expressions not supported")]);const I=jf(v);return I||S?I instanceof Sn?xu([I]):I instanceof So&&!Td(i)?xu([new Sn("",'"interpolate" expressions cannot be used with this property')]):Rm(I?new wh(w?"camera":"composite",f.value,I.labels,I instanceof So?I.interpolation:void 0,c):new Cc(w?"constant":"source",f.value,c)):xu([new Sn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ad{constructor(i,c){this._parameters=i,this._specification=c,Qt(this,Jg(this._parameters,this._specification))}static deserialize(i){return new Ad(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function jf(h){let i=null;if(h instanceof Br)i=jf(h.result);else if(h instanceof hu){for(const c of h.args)if(i=jf(c),i)break}else(h instanceof Ka||h instanceof So)&&h.input instanceof as&&h.input.name==="zoom"&&(i=h);return i instanceof Sn||h.eachChild(c=>{const f=jf(c);f instanceof Sn?i=f:!i&&f?i=new Sn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&f&&i!==f&&(i=new Sn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Pc(h,i=new Set){return h instanceof vu&&i.add(h.key),h.eachChild(c=>{Pc(c,i)}),i}function Ac(h,i){const{zoom:c,heatmapDensity:f,elevation:v,lineProgress:w,isSupportedScript:S,accumulated:I}=h??{};return{zoom:c,heatmapDensity:f,elevation:v,lineProgress:w,isSupportedScript:S,accumulated:I,globalState:i}}function Sh(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const i of h.slice(1))if(!Sh(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const Hf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Mu(h,i){if(h==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Sh(h)||(h=Eu(h));const c=Su(h,Hf,i);if(c.result==="error")throw new Error(c.value.map(f=>`${f.key}: ${f.message}`).join(", "));return{filter:(f,v,w)=>c.value.evaluate(f,v,{},w),needGeometry:Gf(h),getGlobalStateRefs:()=>Pc(c.value.expression)}}function Dm(h,i){return h<i?-1:h>i?1:0}function Gf(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let i=1;i<h.length;i++)if(Gf(h[i]))return!0;return!1}function Eu(h){if(!h)return!0;const i=h[0];return h.length<=1?i!=="any":i==="=="?Wf(h[1],h[2],"=="):i==="!="?Id(Wf(h[1],h[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Wf(h[1],h[2],i):i==="any"?(c=h.slice(1),["any"].concat(c.map(Eu))):i==="all"?["all"].concat(h.slice(1).map(Eu)):i==="none"?["all"].concat(h.slice(1).map(Eu).map(Id)):i==="in"?Lm(h[1],h.slice(2)):i==="!in"?Id(Lm(h[1],h.slice(2))):i==="has"?ev(h[1]):i!=="!has"||Id(ev(h[1]));var c}function Wf(h,i,c){switch(h){case"$type":return[`filter-type-${c}`,i];case"$id":return[`filter-id-${c}`,i];default:return[`filter-${c}`,h,i]}}function Lm(h,i){if(i.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(c=>typeof c!=typeof i[0])?["filter-in-large",h,["literal",i.sort(Dm)]]:["filter-in-small",h,["literal",i]]}}function ev(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Id(h){return["!",h]}function Mh(h){const i=typeof h;if(i==="number"||i==="boolean"||i==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let v="[";for(const w of h)v+=`${Mh(w)},`;return`${v}]`}const c=Object.keys(h).sort();let f="{";for(let v=0;v<c.length;v++)f+=`${JSON.stringify(c[v])}:${Mh(h[c[v]])},`;return`${f}}`}function Fl(h){let i="";for(const c of zt)i+=`/${Mh(h[c])}`;return i}function km(h){const i=h.value;return i?[new ft(h.key,i,"constants have been deprecated as of v8")]:[]}function li(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Wo(h){if(Array.isArray(h))return h.map(Wo);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const i={};for(const c in h)i[c]=Wo(h[c]);return i}return li(h)}function Oo(h){const i=h.key,c=h.value,f=h.valueSpec||{},v=h.objectElementValidators||{},w=h.style,S=h.styleSpec,I=h.validateSpec;let F=[];const $=Tr(c);if($!=="object")return[new ft(i,c,`object expected, ${$} found`)];for(const G in c){const W=G.split(".")[0],te=kr(f,W)||f["*"];let ie;if(kr(v,W))ie=v[W];else if(kr(f,W)){if(c[G]===void 0)continue;ie=I}else if(v["*"])ie=v["*"];else{if(!f["*"]){F.push(new ft(i,c[G],`unknown property "${G}"`));continue}ie=I}F=F.concat(ie({key:(i&&`${i}.`)+G,value:c[G],valueSpec:te,style:w,styleSpec:S,object:c,objectKey:G,validateSpec:I},c))}for(const G in f)v[G]||f[G].required&&f[G].default===void 0&&c[G]===void 0&&F.push(new ft(i,c,`missing required property "${G}"`));return F}function ia(h){const i=h.value,c=h.valueSpec,f=h.style,v=h.styleSpec,w=h.key,S=h.arrayElementValidator||h.validateSpec;if(Tr(i)!=="array")return[new ft(w,i,`array expected, ${Tr(i)} found`)];if(c.length&&i.length!==c.length)return[new ft(w,i,`array length ${c.length} expected, length ${i.length} found`)];let I={type:c.value,values:c.values};v.$version<7&&(I.function=c.function),Tr(c.value)==="object"&&(I=c.value);let F=[];for(let $=0;$<i.length;$++)F=F.concat(S({array:i,arrayIndex:$,value:i[$],valueSpec:I,validateSpec:h.validateSpec,style:f,styleSpec:v,key:`${w}[${$}]`}));return F}function Cu(h){const i=h.key,c=h.value,f=h.valueSpec;let v=Tr(c);return v==="number"&&c!=c&&(v="NaN"),v!=="number"?[new ft(i,c,`number expected, ${v} found`)]:"minimum"in f&&c<f.minimum?[new ft(i,c,`${c} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&c>f.maximum?[new ft(i,c,`${c} is greater than the maximum value ${f.maximum}`)]:[]}function qf(h){const i=h.valueSpec,c=li(h.value.type);let f,v,w,S={};const I=c!=="categorical"&&h.value.property===void 0,F=!I,$=Tr(h.value.stops)==="array"&&Tr(h.value.stops[0])==="array"&&Tr(h.value.stops[0][0])==="object",G=Oo({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(ie){if(c==="identity")return[new ft(ie.key,ie.value,'identity function may not have a "stops" property')];let pe=[];const me=ie.value;return pe=pe.concat(ia({key:ie.key,value:me,valueSpec:ie.valueSpec,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec,arrayElementValidator:W})),Tr(me)==="array"&&me.length===0&&pe.push(new ft(ie.key,me,"array must have at least one stop")),pe},default:function(ie){return ie.validateSpec({key:ie.key,value:ie.value,valueSpec:i,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec})}}});return c==="identity"&&I&&G.push(new ft(h.key,h.value,'missing required property "property"')),c==="identity"||h.value.stops||G.push(new ft(h.key,h.value,'missing required property "stops"')),c==="exponential"&&h.valueSpec.expression&&!Td(h.valueSpec)&&G.push(new ft(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(F&&!$s(h.valueSpec)?G.push(new ft(h.key,h.value,"property functions not supported")):I&&!Bf(h.valueSpec)&&G.push(new ft(h.key,h.value,"zoom functions not supported"))),c!=="categorical"&&!$||h.value.property!==void 0||G.push(new ft(h.key,h.value,'"property" property is required')),G;function W(ie){let pe=[];const me=ie.value,ve=ie.key;if(Tr(me)!=="array")return[new ft(ve,me,`array expected, ${Tr(me)} found`)];if(me.length!==2)return[new ft(ve,me,`array length 2 expected, length ${me.length} found`)];if($){if(Tr(me[0])!=="object")return[new ft(ve,me,`object expected, ${Tr(me[0])} found`)];if(me[0].zoom===void 0)return[new ft(ve,me,"object stop key must have zoom")];if(me[0].value===void 0)return[new ft(ve,me,"object stop key must have value")];if(w&&w>li(me[0].zoom))return[new ft(ve,me[0].zoom,"stop zoom values must appear in ascending order")];li(me[0].zoom)!==w&&(w=li(me[0].zoom),v=void 0,S={}),pe=pe.concat(Oo({key:`${ve}[0]`,value:me[0],valueSpec:{zoom:{}},validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec,objectElementValidators:{zoom:Cu,value:te}}))}else pe=pe.concat(te({key:`${ve}[0]`,value:me[0],validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec},me));return wu(Wo(me[1]))?pe.concat([new ft(`${ve}[1]`,me[1],"expressions are not allowed in function stops.")]):pe.concat(ie.validateSpec({key:`${ve}[1]`,value:me[1],valueSpec:i,validateSpec:ie.validateSpec,style:ie.style,styleSpec:ie.styleSpec}))}function te(ie,pe){const me=Tr(ie.value),ve=li(ie.value),Ae=ie.value!==null?ie.value:pe;if(f){if(me!==f)return[new ft(ie.key,Ae,`${me} stop domain type must match previous stop domain type ${f}`)]}else f=me;if(me!=="number"&&me!=="string"&&me!=="boolean")return[new ft(ie.key,Ae,"stop domain value must be a number, string, or boolean")];if(me!=="number"&&c!=="categorical"){let We=`number expected, ${me} found`;return $s(i)&&c===void 0&&(We+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ft(ie.key,Ae,We)]}return c!=="categorical"||me!=="number"||isFinite(ve)&&Math.floor(ve)===ve?c!=="categorical"&&me==="number"&&v!==void 0&&ve<v?[new ft(ie.key,Ae,"stop domain values must appear in ascending order")]:(v=ve,c==="categorical"&&ve in S?[new ft(ie.key,Ae,"stop domain values must be unique")]:(S[ve]=!0,[])):[new ft(ie.key,Ae,`integer expected, found ${ve}`)]}}function Ic(h){const i=(h.expressionContext==="property"?Tc:Su)(Wo(h.value),h.valueSpec);if(i.result==="error")return i.value.map(f=>new ft(`${h.key}${f.key}`,h.value,f.message));const c=i.value.expression||i.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!c.outputDefined())return[new ft(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!xh(c))return[new ft(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!xh(c))return[new ft(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!Cd(c,["zoom","feature-state"]))return[new ft(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Ed(c))return[new ft(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ra(h){const i=h.key,c=h.value,f=Tr(c);return f!=="string"?[new ft(i,c,`color expected, ${f} found`)]:_r.parse(String(c))?[]:[new ft(i,c,`color expected, "${c}" found`)]}function Da(h){const i=h.key,c=h.value,f=h.valueSpec,v=[];return Array.isArray(f.values)?f.values.indexOf(li(c))===-1&&v.push(new ft(i,c,`expected one of [${f.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(f.values).indexOf(li(c))===-1&&v.push(new ft(i,c,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(c)} found`)),v}function La(h){return Sh(Wo(h.value))?Ic(Qt({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Rd(h)}function Rd(h){const i=h.value,c=h.key;if(Tr(i)!=="array")return[new ft(c,i,`array expected, ${Tr(i)} found`)];const f=h.styleSpec;let v,w=[];if(i.length<1)return[new ft(c,i,"filter array must have at least 1 element")];switch(w=w.concat(Da({key:`${c}[0]`,value:i[0],valueSpec:f.filter_operator,style:h.style,styleSpec:h.styleSpec})),li(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&li(i[1])==="$type"&&w.push(new ft(c,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&w.push(new ft(c,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(v=Tr(i[1]),v!=="string"&&w.push(new ft(`${c}[1]`,i[1],`string expected, ${v} found`)));for(let S=2;S<i.length;S++)v=Tr(i[S]),li(i[1])==="$type"?w=w.concat(Da({key:`${c}[${S}]`,value:i[S],valueSpec:f.geometry_type,style:h.style,styleSpec:h.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&w.push(new ft(`${c}[${S}]`,i[S],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let S=1;S<i.length;S++)w=w.concat(Rd({key:`${c}[${S}]`,value:i[S],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":v=Tr(i[1]),i.length!==2?w.push(new ft(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):v!=="string"&&w.push(new ft(`${c}[1]`,i[1],`string expected, ${v} found`))}return w}function Xf(h,i){const c=h.key,f=h.validateSpec,v=h.style,w=h.styleSpec,S=h.value,I=h.objectKey,F=w[`${i}_${h.layerType}`];if(!F)return[];const $=I.match(/^(.*)-transition$/);if(i==="paint"&&$&&F[$[1]]&&F[$[1]].transition)return f({key:c,value:S,valueSpec:w.transition,style:v,styleSpec:w});const G=h.valueSpec||F[I];if(!G)return[new ft(c,S,`unknown property "${I}"`)];let W;if(Tr(S)==="string"&&$s(G)&&!G.tokens&&(W=/^{([^}]+)}$/.exec(S)))return[new ft(c,S,`"${I}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(W[1])} }\`.`)];const te=[];return h.layerType==="symbol"&&I==="text-font"&&Uf(Wo(S))&&li(S.type)==="identity"&&te.push(new ft(c,S,'"text-font" does not support identity functions')),te.concat(f({key:h.key,value:S,valueSpec:G,style:v,styleSpec:w,expressionContext:"property",propertyType:i,propertyKey:I}))}function Tu(h){return Xf(h,"paint")}function Nl(h){return Xf(h,"layout")}function yi(h){let i=[];const c=h.value,f=h.key,v=h.style,w=h.styleSpec;if(Tr(c)!=="object")return[new ft(f,c,`object expected, ${Tr(c)} found`)];c.type||c.ref||i.push(new ft(f,c,'either "type" or "ref" is required'));let S=li(c.type);const I=li(c.ref);if(c.id){const F=li(c.id);for(let $=0;$<h.arrayIndex;$++){const G=v.layers[$];li(G.id)===F&&i.push(new ft(f,c.id,`duplicate layer id "${c.id}", previously used at line ${G.id.__line__}`))}}if("ref"in c){let F;["type","source","source-layer","filter","layout"].forEach($=>{$ in c&&i.push(new ft(f,c[$],`"${$}" is prohibited for ref layers`))}),v.layers.forEach($=>{li($.id)===I&&(F=$)}),F?F.ref?i.push(new ft(f,c.ref,"ref cannot reference another ref layer")):S=li(F.type):i.push(new ft(f,c.ref,`ref layer "${I}" not found`))}else if(S!=="background")if(c.source){const F=v.sources&&v.sources[c.source],$=F&&li(F.type);F?$==="vector"&&S==="raster"?i.push(new ft(f,c.source,`layer "${c.id}" requires a raster source`)):$!=="raster-dem"&&S==="hillshade"||$!=="raster-dem"&&S==="color-relief"?i.push(new ft(f,c.source,`layer "${c.id}" requires a raster-dem source`)):$==="raster"&&S!=="raster"?i.push(new ft(f,c.source,`layer "${c.id}" requires a vector source`)):$!=="vector"||c["source-layer"]?$==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?i.push(new ft(f,c.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!c.paint||!c.paint["line-gradient"]||$==="geojson"&&F.lineMetrics||i.push(new ft(f,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new ft(f,c,`layer "${c.id}" must specify a "source-layer"`)):i.push(new ft(f,c.source,`source "${c.source}" not found`))}else i.push(new ft(f,c,'missing required property "source"'));return i=i.concat(Oo({key:f,value:c,valueSpec:w.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${f}.type`,value:c.type,valueSpec:w.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:c,objectKey:"type"}),filter:La,layout:F=>Oo({layer:c,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{"*":$=>Nl(Qt({layerType:S},$))}}),paint:F=>Oo({layer:c,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{"*":$=>Tu(Qt({layerType:S},$))}})}})),i}function Wr(h){const i=h.value,c=h.key,f=Tr(i);return f!=="string"?[new ft(c,i,`string expected, ${f} found`)]:[]}const Qa={promoteId:function({key:h,value:i}){if(Tr(i)==="string")return Wr({key:h,value:i});{const c=[];for(const f in i)c.push(...Wr({key:`${h}.${f}`,value:i[f]}));return c}}};function Mo(h){const i=h.value,c=h.key,f=h.styleSpec,v=h.style,w=h.validateSpec;if(!i.type)return[new ft(c,i,'"type" is required')];const S=li(i.type);let I;switch(S){case"vector":case"raster":return I=Oo({key:c,value:i,valueSpec:f[`source_${S.replace("-","_")}`],style:h.style,styleSpec:f,objectElementValidators:Qa,validateSpec:w}),I;case"raster-dem":return I=function(F){var $;const G=($=F.sourceName)!==null&&$!==void 0?$:"",W=F.value,te=F.styleSpec,ie=te.source_raster_dem,pe=F.style;let me=[];const ve=Tr(W);if(W===void 0)return me;if(ve!=="object")return me.push(new ft("source_raster_dem",W,`object expected, ${ve} found`)),me;const Ae=li(W.encoding)==="custom",We=["redFactor","greenFactor","blueFactor","baseShift"],Me=F.value.encoding?`"${F.value.encoding}"`:"Default";for(const Oe in W)!Ae&&We.includes(Oe)?me.push(new ft(Oe,W[Oe],`In "${G}": "${Oe}" is only valid when "encoding" is set to "custom". ${Me} encoding found`)):ie[Oe]?me=me.concat(F.validateSpec({key:Oe,value:W[Oe],valueSpec:ie[Oe],validateSpec:F.validateSpec,style:pe,styleSpec:te})):me.push(new ft(Oe,W[Oe],`unknown property "${Oe}"`));return me}({sourceName:c,value:i,style:h.style,styleSpec:f,validateSpec:w}),I;case"geojson":if(I=Oo({key:c,value:i,valueSpec:f.source_geojson,style:v,styleSpec:f,validateSpec:w,objectElementValidators:Qa}),i.cluster)for(const F in i.clusterProperties){const[$,G]=i.clusterProperties[F],W=typeof $=="string"?[$,["accumulated"],["get",F]]:$;I.push(...Ic({key:`${c}.${F}.map`,value:G,expressionContext:"cluster-map"})),I.push(...Ic({key:`${c}.${F}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return I;case"video":return Oo({key:c,value:i,valueSpec:f.source_video,style:v,validateSpec:w,styleSpec:f});case"image":return Oo({key:c,value:i,valueSpec:f.source_image,style:v,validateSpec:w,styleSpec:f});case"canvas":return[new ft(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Da({key:`${c}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Eo(h){const i=h.value,c=h.styleSpec,f=c.light,v=h.style;let w=[];const S=Tr(i);if(i===void 0)return w;if(S!=="object")return w=w.concat([new ft("light",i,`object expected, ${S} found`)]),w;for(const I in i){const F=I.match(/^(.*)-transition$/);w=w.concat(F&&f[F[1]]&&f[F[1]].transition?h.validateSpec({key:I,value:i[I],valueSpec:c.transition,validateSpec:h.validateSpec,style:v,styleSpec:c}):f[I]?h.validateSpec({key:I,value:i[I],valueSpec:f[I],validateSpec:h.validateSpec,style:v,styleSpec:c}):[new ft(I,i[I],`unknown property "${I}"`)])}return w}function Rc(h){const i=h.value,c=h.styleSpec,f=c.sky,v=h.style,w=Tr(i);if(i===void 0)return[];if(w!=="object")return[new ft("sky",i,`object expected, ${w} found`)];let S=[];for(const I in i)S=S.concat(f[I]?h.validateSpec({key:I,value:i[I],valueSpec:f[I],style:v,styleSpec:c}):[new ft(I,i[I],`unknown property "${I}"`)]);return S}function Dc(h){const i=h.value,c=h.styleSpec,f=c.terrain,v=h.style;let w=[];const S=Tr(i);if(i===void 0)return w;if(S!=="object")return w=w.concat([new ft("terrain",i,`object expected, ${S} found`)]),w;for(const I in i)w=w.concat(f[I]?h.validateSpec({key:I,value:i[I],valueSpec:f[I],validateSpec:h.validateSpec,style:v,styleSpec:c}):[new ft(I,i[I],`unknown property "${I}"`)]);return w}function qo(h){let i=[];const c=h.value,f=h.key;if(Array.isArray(c)){const v=[],w=[];for(const S in c)c[S].id&&v.includes(c[S].id)&&i.push(new ft(f,c,`all the sprites' ids must be unique, but ${c[S].id} is duplicated`)),v.push(c[S].id),c[S].url&&w.includes(c[S].url)&&i.push(new ft(f,c,`all the sprites' URLs must be unique, but ${c[S].url} is duplicated`)),w.push(c[S].url),i=i.concat(Oo({key:`${f}[${S}]`,value:c[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return i}return Wr({key:f,value:c})}function Dd(h){return!!h&&h.constructor===Object}function Zf(h){return Dd(h.value)?[]:[new ft(h.key,h.value,`object expected, ${Tr(h.value)} found`)]}const Yf={"*":()=>[],array:ia,boolean:function(h){const i=h.value,c=h.key,f=Tr(i);return f!=="boolean"?[new ft(c,i,`boolean expected, ${f} found`)]:[]},number:Cu,color:Ra,constants:km,enum:Da,filter:La,function:qf,layer:yi,object:Oo,source:Mo,light:Eo,sky:Rc,terrain:Dc,projection:function(h){const i=h.value,c=h.styleSpec,f=c.projection,v=h.style,w=Tr(i);if(i===void 0)return[];if(w!=="object")return[new ft("projection",i,`object expected, ${w} found`)];let S=[];for(const I in i)S=S.concat(f[I]?h.validateSpec({key:I,value:i[I],valueSpec:f[I],style:v,styleSpec:c}):[new ft(I,i[I],`unknown property "${I}"`)]);return S},projectionDefinition:function(h){const i=h.key;let c=h.value;c=c instanceof String?c.valueOf():c;const f=Tr(c);return f!=="array"||function(v){return Array.isArray(v)&&v.length===3&&typeof v[0]=="string"&&typeof v[1]=="string"&&typeof v[2]=="number"}(c)||function(v){return!!["interpolate","step","literal"].includes(v[0])}(c)?["array","string"].includes(f)?[]:[new ft(i,c,`projection expected, invalid type "${f}" found`)]:[new ft(i,c,`projection expected, invalid array ${JSON.stringify(c)} found`)]},string:Wr,formatted:function(h){return Wr(h).length===0?[]:Ic(h)},resolvedImage:function(h){return Wr(h).length===0?[]:Ic(h)},padding:function(h){const i=h.key,c=h.value;if(Tr(c)==="array"){if(c.length<1||c.length>4)return[new ft(i,c,`padding requires 1 to 4 values; ${c.length} values found`)];const f={type:"number"};let v=[];for(let w=0;w<c.length;w++)v=v.concat(h.validateSpec({key:`${i}[${w}]`,value:c[w],validateSpec:h.validateSpec,valueSpec:f}));return v}return Cu({key:i,value:c,valueSpec:{}})},numberArray:function(h){const i=h.key,c=h.value;if(Tr(c)==="array"){const f={type:"number"};if(c.length<1)return[new ft(i,c,"array length at least 1 expected, length 0 found")];let v=[];for(let w=0;w<c.length;w++)v=v.concat(h.validateSpec({key:`${i}[${w}]`,value:c[w],validateSpec:h.validateSpec,valueSpec:f}));return v}return Cu({key:i,value:c,valueSpec:{}})},colorArray:function(h){const i=h.key,c=h.value;if(Tr(c)==="array"){if(c.length<1)return[new ft(i,c,"array length at least 1 expected, length 0 found")];let f=[];for(let v=0;v<c.length;v++)f=f.concat(Ra({key:`${i}[${v}]`,value:c[v]}));return f}return Ra({key:i,value:c})},variableAnchorOffsetCollection:function(h){const i=h.key,c=h.value,f=Tr(c),v=h.styleSpec;if(f!=="array"||c.length<1||c.length%2!=0)return[new ft(i,c,"variableAnchorOffsetCollection requires a non-empty array of even length")];let w=[];for(let S=0;S<c.length;S+=2)w=w.concat(Da({key:`${i}[${S}]`,value:c[S],valueSpec:v.layout_symbol["text-anchor"]})),w=w.concat(ia({key:`${i}[${S+1}]`,value:c[S+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:v}));return w},sprite:qo,state:Zf,fontFaces:function(h){const i=h.key,c=h.value,f=h.validateSpec,v=h.styleSpec,w=h.style;if(!Dd(c))return[new ft(i,c,`object expected, ${Tr(c)} found`)];const S=[];for(const I in c){const F=c[I],$=Tr(F);if($==="string")S.push(...Wr({key:`${i}.${I}`,value:F}));else if($==="array"){const G={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[W,te]of F.entries())S.push(...Oo({key:`${i}.${I}[${W}]`,value:te,valueSpec:G,styleSpec:v,style:w,validateSpec:f}))}else S.push(new ft(`${i}.${I}`,F,`string or array expected, ${$} found`))}return S}};function ka(h){const i=h.value,c=h.valueSpec,f=h.styleSpec;return h.validateSpec=ka,c.expression&&Uf(li(i))?qf(h):c.expression&&wu(Wo(i))?Ic(h):c.type&&Yf[c.type]?Yf[c.type](h):Oo(Qt({},h,{valueSpec:c.type?f[c.type]:c}))}function zm(h){const i=h.value,c=h.key,f=Wr(h);return f.length||(i.indexOf("{fontstack}")===-1&&f.push(new ft(c,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&f.push(new ft(c,i,'"glyphs" url must include a "{range}" token'))),f}function ro(h,i=De){let c=[];return c=c.concat(ka({key:"",value:h,valueSpec:i.$root,styleSpec:i,style:h,validateSpec:ka,objectElementValidators:{glyphs:zm,"*":()=>[]}})),h.constants&&(c=c.concat(km({key:"constants",value:h.constants}))),Kf(c)}function bs(h){return function(i){return h(Object.assign({},i,{validateSpec:ka}))}}function Kf(h){return[].concat(h).sort((i,c)=>i.line-c.line)}function oa(h){return function(...i){return Kf(h.apply(this,i))}}ro.source=oa(bs(Mo)),ro.sprite=oa(bs(qo)),ro.glyphs=oa(bs(zm)),ro.light=oa(bs(Eo)),ro.sky=oa(bs(Rc)),ro.terrain=oa(bs(Dc)),ro.state=oa(bs(Zf)),ro.layer=oa(bs(yi)),ro.filter=oa(bs(La)),ro.paintProperty=oa(bs(Tu)),ro.layoutProperty=oa(bs(Nl));const a0={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class sa{constructor(i,c){this._globalState=c,this.setValue(i)}evaluate(){var i;return(i=this._literalValue)!==null&&i!==void 0?i:this._compiledValue.evaluate({})}setValue(i){if(i==null||i==="visible"||i==="none")return this._literalValue=i==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const c=Su(i,a0,this._globalState);if(c.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(c.value.map(f=>`${f.key}: ${f.message}`).join(", "));this._literalValue=void 0,this._compiledValue=c.value,this._globalStateRefs=Pc(c.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const el=De,$i=ro,Lc=$i.light,Ld=$i.sky,aa=$i.paintProperty,la=$i.layoutProperty;function ca(h,i){let c=!1;if(i&&i.length)for(const f of i)h.fire(new Ge(new Error(f.message))),c=!0;return c}class ws{constructor(i,c,f){const v=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const S=new Int32Array(this.arrayBuffer);i=S[0],this.d=(c=S[1])+2*(f=S[2]);for(let F=0;F<this.d*this.d;F++){const $=S[3+F],G=S[3+F+1];v.push($===G?null:S.subarray($,G))}const I=S[3+v.length+1];this.keys=S.subarray(S[3+v.length],I),this.bboxes=S.subarray(I),this.insert=this._insertReadonly}else{this.d=c+2*f;for(let S=0;S<this.d*this.d;S++)v.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=i,this.padding=f,this.scale=c/i,this.uid=0;const w=f/c*i;this.min=-w,this.max=i+w}insert(i,c,f,v,w){this._forEachCell(c,f,v,w,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(w)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,c,f,v,w,S){this.cells[w].push(S)}query(i,c,f,v,w){const S=this.min,I=this.max;if(i<=S&&c<=S&&I<=f&&I<=v&&!w)return Array.prototype.slice.call(this.keys);{const F=[];return this._forEachCell(i,c,f,v,this._queryCell,F,{},w),F}}_queryCell(i,c,f,v,w,S,I,F){const $=this.cells[w];if($!==null){const G=this.keys,W=this.bboxes;for(let te=0;te<$.length;te++){const ie=$[te];if(I[ie]===void 0){const pe=4*ie;(F?F(W[pe+0],W[pe+1],W[pe+2],W[pe+3]):i<=W[pe+2]&&c<=W[pe+3]&&f>=W[pe+0]&&v>=W[pe+1])?(I[ie]=!0,S.push(G[ie])):I[ie]=!1}}}}_forEachCell(i,c,f,v,w,S,I,F){const $=this._convertToCellCoord(i),G=this._convertToCellCoord(c),W=this._convertToCellCoord(f),te=this._convertToCellCoord(v);for(let ie=$;ie<=W;ie++)for(let pe=G;pe<=te;pe++){const me=this.d*pe+ie;if((!F||F(this._convertFromCellCoord(ie),this._convertFromCellCoord(pe),this._convertFromCellCoord(ie+1),this._convertFromCellCoord(pe+1)))&&w.call(this,i,c,f,v,me,S,I,F))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,c=3+this.cells.length+1+1;let f=0;for(let S=0;S<this.cells.length;S++)f+=this.cells[S].length;const v=new Int32Array(c+f+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let w=c;for(let S=0;S<i.length;S++){const I=i[S];v[3+S]=w,v.set(I,w),w+=I.length}return v[3+i.length]=w,v.set(this.keys,w),w+=this.keys.length,v[3+i.length+1]=w,v.set(this.bboxes,w),w+=this.bboxes.length,v.buffer}static serialize(i,c){const f=i.toArrayBuffer();return c&&c.push(f),{buffer:f}}static deserialize(i){return new ws(i.buffer)}}const ho={};function Nn(h,i,c={}){if(ho[h])throw new Error(`${h} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:h,writeable:!1}),ho[h]={klass:i,omit:c.omit||[],shallow:c.shallow||[]}}Nn("Object",Object),Nn("Set",Set),Nn("TransferableGridIndex",ws),Nn("Color",_r),Nn("Error",Error),Nn("AJAXError",fe),Nn("ResolvedImage",_s),Nn("StylePropertyFunction",Ad),Nn("StyleExpression",bu,{omit:["_evaluator"]}),Nn("ZoomDependentExpression",wh),Nn("ZoomConstantExpression",Cc),Nn("CompoundExpression",as,{omit:["_evaluate"]});for(const h in yu)yu[h]._classRegistryKey||Nn(`Expression_${h}`,yu[h]);function kd(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function zd(h){return h.$name||h.constructor._classRegistryKey}function kc(h){return!function(i){if(i===null||typeof i!="object")return!1;const c=zd(i);return!(!c||c==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||kd(h)||Wt(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function Fo(h,i){if(kc(h))return(kd(h)||Wt(h))&&i&&i.push(h),ArrayBuffer.isView(h)&&i&&i.push(h.buffer),h instanceof ImageData&&i&&i.push(h.data.buffer),h;if(Array.isArray(h)){const w=[];for(const S of h)w.push(Fo(S,i));return w}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);const c=zd(h);if(!c)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!ho[c])throw new Error(`${c} is not registered.`);const{klass:f}=ho[c],v=f.serialize?f.serialize(h,i):{};if(f.serialize){if(i&&v===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const w in h){if(!h.hasOwnProperty(w)||ho[c].omit.indexOf(w)>=0)continue;const S=h[w];v[w]=ho[c].shallow.indexOf(w)>=0?S:Fo(S,i)}h instanceof Error&&(v.message=h.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(v.$name=c),v}function No(h){if(kc(h))return h;if(Array.isArray(h))return h.map(No);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);const i=zd(h)||"Object";if(!ho[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:c}=ho[i];if(!c)throw new Error(`can't deserialize unregistered class ${i}`);if(c.deserialize)return c.deserialize(h);const f=Object.create(c.prototype);for(const v of Object.keys(h)){if(v==="$name")continue;const w=h[v];f[v]=ho[i].shallow.indexOf(v)>=0?w:No(w)}return f}class _i{constructor(){this.first=!0}update(i,c){const f=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=c),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=f,!0))}}function ls(h){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(h))}function Jf(h){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(h))}function Om(h){return/\s/u.test(String.fromCodePoint(h))}function zc(h){for(const i of h)if(Jf(i.codePointAt(0)))return!0;return!1}function Fm(h){for(const i of h)if(!Nm(i.codePointAt(0)))return!1;return!0}function Od(h){const i=h.map(c=>{try{return new RegExp(`\\p{sc=${c}}`,"u").source}catch{return null}}).filter(c=>c);return new RegExp(i.join("|"),"u")}const Pu=Od(["Arab","Dupl","Mong","Ougr","Syrc"]);function Nm(h){return!Pu.test(String.fromCodePoint(h))}function Oc(h){return!(Jf(h)||(i=h,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(i))));var i}const Qf=Od(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Bm(h){return Qf.test(String.fromCodePoint(h))}function Au(h,i){return!(!i&&Bm(h)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(h)))}function Fd(h){for(const i of h)if(Bm(i.codePointAt(0)))return!0;return!1}const Bl=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if(Bl.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,i){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!=="loading")return this.setState(h),h;const c=h.pluginURL,f=new Promise(w=>{this.loadScriptResolve=w});i(c);const v=new Promise(w=>setTimeout(()=>w(),this.TIMEOUT));if(yield Promise.race([f,v]),this.isParsed()){const w={pluginStatus:"loaded",pluginURL:c};return this.setState(w),w}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${c}`)})}};class Jr{constructor(i,c){this.isSupportedScript=Eh,this.zoom=i,c?(this.now=c.now||0,this.fadeDuration=c.fadeDuration||0,this.zoomHistory=c.zoomHistory||new _i,this.transition=c.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new _i,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,c=i-Math.floor(i),f=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*c}}}function Eh(h){return function(i,c){for(const f of i)if(!Au(f.codePointAt(0),c))return!1;return!0}(h,Bl.getRTLTextPluginStatus()==="loaded")}const Ch="-transition";class Iu{constructor(i,c,f){this.property=i,this.value=c,this.expression=function(v,w,S){if(Uf(v))return new Ad(v,w);if(wu(v)){const I=Tc(v,w,S);if(I.result==="error")throw new Error(I.value.map(F=>`${F.key}: ${F.message}`).join(", "));return I.value}{let I=v;return w.type==="color"&&typeof v=="string"?I=_r.parse(v):w.type!=="padding"||typeof v!="number"&&!Array.isArray(v)?w.type!=="numberArray"||typeof v!="number"&&!Array.isArray(v)?w.type!=="colorArray"||typeof v!="string"&&!Array.isArray(v)?w.type==="variableAnchorOffsetCollection"&&Array.isArray(v)?I=os.parse(v):w.type==="projectionDefinition"&&typeof v=="string"&&(I=wo.parse(v)):I=dr.parse(v):I=Zr.parse(v):I=to.parse(v),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>I}}}(c===void 0?i.specification.default:c,i.specification,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(i,c,f){return this.property.possiblyEvaluate(this,i,c,f)}}class Ru{constructor(i,c){this.property=i,this.value=new Iu(i,void 0,c)}transitioned(i,c){return new ep(this.property,this.value,c,et({},i.transition,this.transition),i.now)}untransitioned(){return new ep(this.property,this.value,null,{},0)}}class Fc{constructor(i,c){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._globalState=c}getValue(i){return en(this._values[i].value.value)}setValue(i,c){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Ru(this._values[i].property,this._globalState)),this._values[i].value=new Iu(this._values[i].property,c===null?void 0:en(c),this._globalState)}getTransition(i){return en(this._values[i].transition)}setTransition(i,c){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Ru(this._values[i].property,this._globalState)),this._values[i].transition=en(c)||void 0}serialize(){const i={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(i[c]=f);const v=this.getTransition(c);v!==void 0&&(i[`${c}${Ch}`]=v)}return i}transitioned(i,c){const f=new tp(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].transitioned(i,c._values[v]);return f}untransitioned(){const i=new tp(this._properties);for(const c of Object.keys(this._values))i._values[c]=this._values[c].untransitioned();return i}}class ep{constructor(i,c,f,v,w){this.property=i,this.value=c,this.begin=w+v.delay||0,this.end=this.begin+v.duration||0,i.specification.transition&&(v.delay||v.duration)&&(this.prior=f)}possiblyEvaluate(i,c,f){const v=i.now||0,w=this.value.possiblyEvaluate(i,c,f),S=this.prior;if(S){if(v>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(v<this.begin)return S.possiblyEvaluate(i,c,f);{const I=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(i,c,f),w,Ht(I))}}return w}}class tp{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,c,f){const v=new tl(this._properties);for(const w of Object.keys(this._values))v._values[w]=this._values[w].possiblyEvaluate(i,c,f);return v}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class np{constructor(i,c){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._globalState=c}hasValue(i){return this._values[i].value!==void 0}getValue(i){return en(this._values[i].value)}setValue(i,c){this._values[i]=new Iu(this._values[i].property,c===null?void 0:en(c),this._globalState)}serialize(){const i={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(i[c]=f)}return i}possiblyEvaluate(i,c,f){const v=new tl(this._properties);for(const w of Object.keys(this._values))v._values[w]=this._values[w].possiblyEvaluate(i,c,f);return v}}class Vs{constructor(i,c,f){this.property=i,this.value=c,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,c,f,v){return this.property.evaluate(this.value,this.parameters,i,c,f,v)}}class tl{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Vn{constructor(i){this.specification=i}possiblyEvaluate(i,c){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(c)}interpolate(i,c,f){const v=Ai[this.specification.type];return v?v(i,c,f):i}}class rr{constructor(i,c){this.specification=i,this.overrides=c}possiblyEvaluate(i,c,f,v){return new Vs(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(c,null,{},f,v)}:i.expression,c)}interpolate(i,c,f){if(i.value.kind!=="constant"||c.value.kind!=="constant")return i;if(i.value.value===void 0||c.value.value===void 0)return new Vs(this,{kind:"constant",value:void 0},i.parameters);const v=Ai[this.specification.type];if(v){const w=v(i.value.value,c.value.value,f);return new Vs(this,{kind:"constant",value:w},i.parameters)}return i}evaluate(i,c,f,v,w,S){return i.kind==="constant"?i.value:i.evaluate(c,f,v,w,S)}}class Du extends rr{possiblyEvaluate(i,c,f,v){if(i.value===void 0)return new Vs(this,{kind:"constant",value:void 0},c);if(i.expression.kind==="constant"){const w=i.expression.evaluate(c,null,{},f,v),S=i.property.specification.type==="resolvedImage"&&typeof w!="string"?w.name:w,I=this._calculate(S,S,S,c);return new Vs(this,{kind:"constant",value:I},c)}if(i.expression.kind==="camera"){const w=this._calculate(i.expression.evaluate({zoom:c.zoom-1}),i.expression.evaluate({zoom:c.zoom}),i.expression.evaluate({zoom:c.zoom+1}),c);return new Vs(this,{kind:"constant",value:w},c)}return new Vs(this,i.expression,c)}evaluate(i,c,f,v,w,S){if(i.kind==="source"){const I=i.evaluate(c,f,v,w,S);return this._calculate(I,I,I,c)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(c.zoom)-1},f,v),i.evaluate({zoom:Math.floor(c.zoom)},f,v),i.evaluate({zoom:Math.floor(c.zoom)+1},f,v),c):i.value}_calculate(i,c,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:i,to:c}:{from:f,to:c}}interpolate(i){return i}}class Nd{constructor(i){this.specification=i}possiblyEvaluate(i,c,f,v){if(i.value!==void 0){if(i.expression.kind==="constant"){const w=i.expression.evaluate(c,null,{},f,v);return this._calculate(w,w,w,c)}return this._calculate(i.expression.evaluate(new Jr(Math.floor(c.zoom-1),c)),i.expression.evaluate(new Jr(Math.floor(c.zoom),c)),i.expression.evaluate(new Jr(Math.floor(c.zoom+1),c)),c)}}_calculate(i,c,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:i,to:c}:{from:f,to:c}}interpolate(i){return i}}class ua{constructor(i){this.specification=i}possiblyEvaluate(i,c,f,v){return!!i.expression.evaluate(c,null,{},f,v)}interpolate(){return!1}}class Wi{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in i){const f=i[c];f.specification.overridable&&this.overridableProperties.push(c);const v=this.defaultPropertyValues[c]=new Iu(f,void 0,void 0),w=this.defaultTransitionablePropertyValues[c]=new Ru(f,void 0);this.defaultTransitioningPropertyValues[c]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=v.possiblyEvaluate({})}}}Nn("DataDrivenProperty",rr),Nn("DataConstantProperty",Vn),Nn("CrossFadedDataDrivenProperty",Du),Nn("CrossFadedProperty",Nd),Nn("ColorRampProperty",ua);class Ss extends je{constructor(i,c,f){if(super(),this.id=i.id,this.type=i.type,this._globalState=f,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=function(v,w){return new sa(v,w)}(this.visibility,f),i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter,this._featureFilter=Mu(i.filter,f)),c.layout&&(this._unevaluatedLayout=new np(c.layout,f)),c.paint)){this._transitionablePaint=new Fc(c.paint,f);for(const v in i.paint)this.setPaintProperty(v,i.paint[v],{validate:!1});for(const v in i.layout)this.setLayoutProperty(v,i.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new tl(c.paint)}}setFilter(i){this.filter=i,this._featureFilter=Mu(i,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}getLayoutAffectingGlobalStateRefs(){const i=new Set;for(const c of this._visibilityExpression.getGlobalStateRefs())i.add(c);if(this._unevaluatedLayout)for(const c in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[c];for(const v of f.getGlobalStateRefs())i.add(v)}for(const c of this._featureFilter.getGlobalStateRefs())i.add(c);return i}getPaintAffectingGlobalStateRefs(){var i;const c=new globalThis.Map;if(this._transitionablePaint)for(const f in this._transitionablePaint._values){const v=this._transitionablePaint._values[f].value;for(const w of v.getGlobalStateRefs()){const S=(i=c.get(w))!==null&&i!==void 0?i:[];S.push({name:f,value:v.value}),c.set(w,S)}}return c}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(i,c,f={}){if(c==null||!this._validate(la,`layers.${this.id}.layout.${i}`,i,c,f))return i==="visibility"?(this.visibility=c,this._visibilityExpression.setValue(c),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(i,c)}getPaintProperty(i){return i.endsWith(Ch)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,c,f={}){if(c!=null&&this._validate(aa,`layers.${this.id}.paint.${i}`,i,c,f))return!1;if(i.endsWith(Ch))return this._transitionablePaint.setTransition(i.slice(0,-11),c||void 0),!1;{const v=this._transitionablePaint._values[i],w=v.property.specification["property-type"]==="cross-faded-data-driven",S=v.value.isDataDriven(),I=v.value;this._transitionablePaint.setValue(i,c),this._handleSpecialPaintPropertyUpdate(i);const F=this._transitionablePaint._values[i].value;return F.isDataDriven()||S||w||this._handleOverridablePaintPropertyUpdate(i,I,F)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,c,f){return!1}isHidden(i=this.minzoom,c=!1){return!!(this.minzoom&&i<(c?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&i>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(i,c){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,c)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),hn(i,(c,f)=>!(c===void 0||f==="layout"&&!Object.keys(c).length||f==="paint"&&!Object.keys(c).length))}_validate(i,c,f,v,w={}){return(!w||w.validate!==!1)&&ca(this,i.call($i,{key:c,layerType:this.type,objectKey:f,value:v,styleSpec:De,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const c=this.paint.get(i);if(c instanceof Vs&&$s(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}}let rp;var nl={get paint(){return rp=rp||new Wi({"raster-opacity":new Vn(De.paint_raster["raster-opacity"]),"raster-hue-rotate":new Vn(De.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Vn(De.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Vn(De.paint_raster["raster-brightness-max"]),"raster-saturation":new Vn(De.paint_raster["raster-saturation"]),"raster-contrast":new Vn(De.paint_raster["raster-contrast"]),"raster-resampling":new Vn(De.paint_raster["raster-resampling"]),"raster-fade-duration":new Vn(De.paint_raster["raster-fade-duration"])})}};class Nc extends Ss{constructor(i,c){super(i,nl,c)}}const ip={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Th{constructor(i,c){this._structArray=i,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ci{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,c){return i._trim(),c&&(i.isTransferred=!0,c.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const c=Object.create(this.prototype);return c.arrayBuffer=i.arrayBuffer,c.length=i.length,c.capacity=i.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Vi(h,i=1){let c=0,f=0;return{members:h.map(v=>{const w=ip[v.type].BYTES_PER_ELEMENT,S=c=za(c,Math.max(i,w)),I=v.components||1;return f=Math.max(f,w),c+=w*I,{name:v.name,type:v.type,components:I,offset:S}}),size:za(c,Math.max(f,i)),alignment:i}}function za(h,i){return Math.ceil(h/i)*i}class Ms extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c){const f=this.length;return this.resize(f+1),this.emplace(f,i,c)}emplace(i,c,f){const v=2*i;return this.int16[v+0]=c,this.int16[v+1]=f,i}}Ms.prototype.bytesPerElement=4,Nn("StructArrayLayout2i4",Ms);class Bc extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,f)}emplace(i,c,f,v){const w=3*i;return this.int16[w+0]=c,this.int16[w+1]=f,this.int16[w+2]=v,i}}Bc.prototype.bytesPerElement=6,Nn("StructArrayLayout3i6",Bc);class Lu extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,f,v){const w=this.length;return this.resize(w+1),this.emplace(w,i,c,f,v)}emplace(i,c,f,v,w){const S=4*i;return this.int16[S+0]=c,this.int16[S+1]=f,this.int16[S+2]=v,this.int16[S+3]=w,i}}Lu.prototype.bytesPerElement=8,Nn("StructArrayLayout4i8",Lu);class rl extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,c,f,v,w,S)}emplace(i,c,f,v,w,S,I){const F=6*i;return this.int16[F+0]=c,this.int16[F+1]=f,this.int16[F+2]=v,this.int16[F+3]=w,this.int16[F+4]=S,this.int16[F+5]=I,i}}rl.prototype.bytesPerElement=12,Nn("StructArrayLayout2i4i12",rl);class Bd extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,c,f,v,w,S)}emplace(i,c,f,v,w,S,I){const F=4*i,$=8*i;return this.int16[F+0]=c,this.int16[F+1]=f,this.uint8[$+4]=v,this.uint8[$+5]=w,this.uint8[$+6]=S,this.uint8[$+7]=I,i}}Bd.prototype.bytesPerElement=8,Nn("StructArrayLayout2i4ub8",Bd);class il extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c){const f=this.length;return this.resize(f+1),this.emplace(f,i,c)}emplace(i,c,f){const v=2*i;return this.float32[v+0]=c,this.float32[v+1]=f,i}}il.prototype.bytesPerElement=8,Nn("StructArrayLayout2f8",il);class ol extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S,I,F,$,G){const W=this.length;return this.resize(W+1),this.emplace(W,i,c,f,v,w,S,I,F,$,G)}emplace(i,c,f,v,w,S,I,F,$,G,W){const te=10*i;return this.uint16[te+0]=c,this.uint16[te+1]=f,this.uint16[te+2]=v,this.uint16[te+3]=w,this.uint16[te+4]=S,this.uint16[te+5]=I,this.uint16[te+6]=F,this.uint16[te+7]=$,this.uint16[te+8]=G,this.uint16[te+9]=W,i}}ol.prototype.bytesPerElement=20,Nn("StructArrayLayout10ui20",ol);class Ph extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S,I,F){const $=this.length;return this.resize($+1),this.emplace($,i,c,f,v,w,S,I,F)}emplace(i,c,f,v,w,S,I,F,$){const G=8*i;return this.uint16[G+0]=c,this.uint16[G+1]=f,this.uint16[G+2]=v,this.uint16[G+3]=w,this.uint16[G+4]=S,this.uint16[G+5]=I,this.uint16[G+6]=F,this.uint16[G+7]=$,i}}Ph.prototype.bytesPerElement=16,Nn("StructArrayLayout8ui16",Ph);class ui extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S,I,F,$,G,W,te){const ie=this.length;return this.resize(ie+1),this.emplace(ie,i,c,f,v,w,S,I,F,$,G,W,te)}emplace(i,c,f,v,w,S,I,F,$,G,W,te,ie){const pe=12*i;return this.int16[pe+0]=c,this.int16[pe+1]=f,this.int16[pe+2]=v,this.int16[pe+3]=w,this.uint16[pe+4]=S,this.uint16[pe+5]=I,this.uint16[pe+6]=F,this.uint16[pe+7]=$,this.int16[pe+8]=G,this.int16[pe+9]=W,this.int16[pe+10]=te,this.int16[pe+11]=ie,i}}ui.prototype.bytesPerElement=24,Nn("StructArrayLayout4i4ui4i24",ui);class ku extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,f)}emplace(i,c,f,v){const w=3*i;return this.float32[w+0]=c,this.float32[w+1]=f,this.float32[w+2]=v,i}}ku.prototype.bytesPerElement=12,Nn("StructArrayLayout3f12",ku);class zu extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint32[1*i+0]=c,i}}zu.prototype.bytesPerElement=4,Nn("StructArrayLayout1ul4",zu);class Ud extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S,I,F,$){const G=this.length;return this.resize(G+1),this.emplace(G,i,c,f,v,w,S,I,F,$)}emplace(i,c,f,v,w,S,I,F,$,G){const W=10*i,te=5*i;return this.int16[W+0]=c,this.int16[W+1]=f,this.int16[W+2]=v,this.int16[W+3]=w,this.int16[W+4]=S,this.int16[W+5]=I,this.uint32[te+3]=F,this.uint16[W+8]=$,this.uint16[W+9]=G,i}}Ud.prototype.bytesPerElement=20,Nn("StructArrayLayout6i1ul2ui20",Ud);class Ul extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,c,f,v,w,S)}emplace(i,c,f,v,w,S,I){const F=6*i;return this.int16[F+0]=c,this.int16[F+1]=f,this.int16[F+2]=v,this.int16[F+3]=w,this.int16[F+4]=S,this.int16[F+5]=I,i}}Ul.prototype.bytesPerElement=12,Nn("StructArrayLayout2i2i2i12",Ul);class $l extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w){const S=this.length;return this.resize(S+1),this.emplace(S,i,c,f,v,w)}emplace(i,c,f,v,w,S){const I=4*i,F=8*i;return this.float32[I+0]=c,this.float32[I+1]=f,this.float32[I+2]=v,this.int16[F+6]=w,this.int16[F+7]=S,i}}$l.prototype.bytesPerElement=16,Nn("StructArrayLayout2f1f2i16",$l);class Vl extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S){const I=this.length;return this.resize(I+1),this.emplace(I,i,c,f,v,w,S)}emplace(i,c,f,v,w,S,I){const F=16*i,$=4*i,G=8*i;return this.uint8[F+0]=c,this.uint8[F+1]=f,this.float32[$+1]=v,this.float32[$+2]=w,this.int16[G+6]=S,this.int16[G+7]=I,i}}Vl.prototype.bytesPerElement=16,Nn("StructArrayLayout2ub2f2i16",Vl);class hi extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,f)}emplace(i,c,f,v){const w=3*i;return this.uint16[w+0]=c,this.uint16[w+1]=f,this.uint16[w+2]=v,i}}hi.prototype.bytesPerElement=6,Nn("StructArrayLayout3ui6",hi);class Ri extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S,I,F,$,G,W,te,ie,pe,me,ve,Ae){const We=this.length;return this.resize(We+1),this.emplace(We,i,c,f,v,w,S,I,F,$,G,W,te,ie,pe,me,ve,Ae)}emplace(i,c,f,v,w,S,I,F,$,G,W,te,ie,pe,me,ve,Ae,We){const Me=24*i,Oe=12*i,tt=48*i;return this.int16[Me+0]=c,this.int16[Me+1]=f,this.uint16[Me+2]=v,this.uint16[Me+3]=w,this.uint32[Oe+2]=S,this.uint32[Oe+3]=I,this.uint32[Oe+4]=F,this.uint16[Me+10]=$,this.uint16[Me+11]=G,this.uint16[Me+12]=W,this.float32[Oe+7]=te,this.float32[Oe+8]=ie,this.uint8[tt+36]=pe,this.uint8[tt+37]=me,this.uint8[tt+38]=ve,this.uint32[Oe+10]=Ae,this.int16[Me+22]=We,i}}Ri.prototype.bytesPerElement=48,Nn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ri);class io extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,f,v,w,S,I,F,$,G,W,te,ie,pe,me,ve,Ae,We,Me,Oe,tt,dt,Ct,Xt,Yt,rn,Mn,ln){const Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,i,c,f,v,w,S,I,F,$,G,W,te,ie,pe,me,ve,Ae,We,Me,Oe,tt,dt,Ct,Xt,Yt,rn,Mn,ln)}emplace(i,c,f,v,w,S,I,F,$,G,W,te,ie,pe,me,ve,Ae,We,Me,Oe,tt,dt,Ct,Xt,Yt,rn,Mn,ln,Kt){const Bt=32*i,Hn=16*i;return this.int16[Bt+0]=c,this.int16[Bt+1]=f,this.int16[Bt+2]=v,this.int16[Bt+3]=w,this.int16[Bt+4]=S,this.int16[Bt+5]=I,this.int16[Bt+6]=F,this.int16[Bt+7]=$,this.uint16[Bt+8]=G,this.uint16[Bt+9]=W,this.uint16[Bt+10]=te,this.uint16[Bt+11]=ie,this.uint16[Bt+12]=pe,this.uint16[Bt+13]=me,this.uint16[Bt+14]=ve,this.uint16[Bt+15]=Ae,this.uint16[Bt+16]=We,this.uint16[Bt+17]=Me,this.uint16[Bt+18]=Oe,this.uint16[Bt+19]=tt,this.uint16[Bt+20]=dt,this.uint16[Bt+21]=Ct,this.uint16[Bt+22]=Xt,this.uint32[Hn+12]=Yt,this.float32[Hn+13]=rn,this.float32[Hn+14]=Mn,this.uint16[Bt+30]=ln,this.uint16[Bt+31]=Kt,i}}io.prototype.bytesPerElement=64,Nn("StructArrayLayout8i15ui1ul2f2ui64",io);class Ou extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.float32[1*i+0]=c,i}}Ou.prototype.bytesPerElement=4,Nn("StructArrayLayout1f4",Ou);class Uc extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,f)}emplace(i,c,f,v){const w=3*i;return this.uint16[6*i+0]=c,this.float32[w+1]=f,this.float32[w+2]=v,i}}Uc.prototype.bytesPerElement=12,Nn("StructArrayLayout1ui2f12",Uc);class Fu extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,f)}emplace(i,c,f,v){const w=4*i;return this.uint32[2*i+0]=c,this.uint16[w+2]=f,this.uint16[w+3]=v,i}}Fu.prototype.bytesPerElement=8,Nn("StructArrayLayout1ul2ui8",Fu);class E extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c){const f=this.length;return this.resize(f+1),this.emplace(f,i,c)}emplace(i,c,f){const v=2*i;return this.uint16[v+0]=c,this.uint16[v+1]=f,i}}E.prototype.bytesPerElement=4,Nn("StructArrayLayout2ui4",E);class o extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint16[1*i+0]=c,i}}o.prototype.bytesPerElement=2,Nn("StructArrayLayout1ui2",o);class d extends ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,f,v){const w=this.length;return this.resize(w+1),this.emplace(w,i,c,f,v)}emplace(i,c,f,v,w){const S=4*i;return this.float32[S+0]=c,this.float32[S+1]=f,this.float32[S+2]=v,this.float32[S+3]=w,i}}d.prototype.bytesPerElement=16,Nn("StructArrayLayout4f16",d);class g extends Th{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new m(this.anchorPointX,this.anchorPointY)}}g.prototype.size=20;class x extends Ud{get(i){return new g(this,i)}}Nn("CollisionBoxArray",x);class T extends Th{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}T.prototype.size=48;class D extends Ri{get(i){return new T(this,i)}}Nn("PlacedSymbolArray",D);class N extends Th{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}N.prototype.size=64;class V extends io{get(i){return new N(this,i)}}Nn("SymbolInstanceArray",V);class Z extends Ou{getoffsetX(i){return this.float32[1*i+0]}}Nn("GlyphOffsetArray",Z);class Q extends Bc{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Nn("SymbolLineVertexArray",Q);class ce extends Th{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ce.prototype.size=12;class le extends Uc{get(i){return new ce(this,i)}}Nn("TextAnchorOffsetArray",le);class ge extends Th{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ge.prototype.size=8;class be extends Fu{get(i){return new ge(this,i)}}Nn("FeatureIndexArray",be);class ze extends Ms{}class $e extends Ms{}class Ne extends Ms{}class qe extends rl{}class it extends Bd{}class Xe extends il{}class rt extends ol{}class ht extends Ph{}class Qe extends ui{}class yt extends ku{}class Ot extends zu{}class Pt extends Ul{}class It extends Vl{}class Dt extends hi{}class gn extends E{}const xn=Vi([{name:"a_pos",components:2,type:"Int16"}],4),{members:tn}=xn;class Dn{constructor(i=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=i}prepareSegment(i,c,f,v){const w=this.segments[this.segments.length-1];return i>Dn.MAX_VERTEX_ARRAY_LENGTH&&Ke(`Max vertices per segment is ${Dn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Dn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!w||w.vertexLength+i>Dn.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==v?this.createNewSegment(c,f,v):w}createNewSegment(i,c,f){const v={vertexOffset:i.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(v.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(v),v}getOrCreateLatestSegment(i,c,f){return this.prepareSegment(0,i,c,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const i of this.segments)for(const c in i.vaos)i.vaos[c].destroy()}static simpleSegment(i,c,f,v){return new Dn([{vertexOffset:i,primitiveOffset:c,vertexLength:f,primitiveLength:v,vaos:{},sortKey:0}])}}function gr(h,i){return 256*(h=_t(Math.floor(h),0,255))+_t(Math.floor(i),0,255)}Dn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nn("SegmentVector",Dn);const Yr=Vi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),xi=Vi([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var ni,bi,ri,wi={exports:{}},Di={exports:{}},Co={exports:{}},Xi=function(){if(ri)return wi.exports;ri=1;var h=(ni||(ni=1,Di.exports=function(c,f){var v,w,S,I,F,$,G,W;for(w=c.length-(v=3&c.length),S=f,F=3432918353,$=461845907,W=0;W<w;)G=255&c.charCodeAt(W)|(255&c.charCodeAt(++W))<<8|(255&c.charCodeAt(++W))<<16|(255&c.charCodeAt(++W))<<24,++W,S=27492+(65535&(I=5*(65535&(S=(S^=G=(65535&(G=(G=(65535&G)*F+(((G>>>16)*F&65535)<<16)&4294967295)<<15|G>>>17))*$+(((G>>>16)*$&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(I>>>16)&65535)<<16);switch(G=0,v){case 3:G^=(255&c.charCodeAt(W+2))<<16;case 2:G^=(255&c.charCodeAt(W+1))<<8;case 1:S^=G=(65535&(G=(G=(65535&(G^=255&c.charCodeAt(W)))*F+(((G>>>16)*F&65535)<<16)&4294967295)<<15|G>>>17))*$+(((G>>>16)*$&65535)<<16)&4294967295}return S^=c.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),Di.exports),i=(bi||(bi=1,Co.exports=function(c,f){for(var v,w=c.length,S=f^w,I=0;w>=4;)v=1540483477*(65535&(v=255&c.charCodeAt(I)|(255&c.charCodeAt(++I))<<8|(255&c.charCodeAt(++I))<<16|(255&c.charCodeAt(++I))<<24))+((1540483477*(v>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),w-=4,++I;switch(w){case 3:S^=(255&c.charCodeAt(I+2))<<16;case 2:S^=(255&c.charCodeAt(I+1))<<8;case 1:S=1540483477*(65535&(S^=255&c.charCodeAt(I)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),Co.exports);return wi.exports=h,wi.exports.murmur3=h,wi.exports.murmur2=i,wi.exports}(),qr=_(Xi);class fo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,c,f,v){this.ids.push(Oa(i)),this.positions.push(c,f,v)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=Oa(i);let f=0,v=this.ids.length-1;for(;f<v;){const S=f+v>>1;this.ids[S]>=c?v=S:f=S+1}const w=[];for(;this.ids[f]===c;)w.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return w}static serialize(i,c){const f=new Float64Array(i.ids),v=new Uint32Array(i.positions);return sl(f,v,0,f.length-1),c&&c.push(f.buffer,v.buffer),{ids:f,positions:v}}static deserialize(i){const c=new fo;return c.ids=i.ids,c.positions=i.positions,c.indexed=!0,c}}function Oa(h){const i=+h;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:qr(String(h))}function sl(h,i,c,f){for(;c<f;){const v=h[c+f>>1];let w=c-1,S=f+1;for(;;){do w++;while(h[w]<v);do S--;while(h[S]>v);if(w>=S)break;Fa(h,w,S),Fa(i,3*w,3*S),Fa(i,3*w+1,3*S+1),Fa(i,3*w+2,3*S+2)}S-c<f-S?(sl(h,i,c,S),c=S+1):(sl(h,i,S+1,f),f=S)}}function Fa(h,i,c){const f=h[i];h[i]=h[c],h[c]=f}Nn("FeaturePositionMap",fo);class cs{constructor(i,c){this.gl=i.gl,this.location=c}}class jl extends cs{constructor(i,c){super(i,c),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class al extends cs{constructor(i,c){super(i,c),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Hl extends cs{constructor(i,c){super(i,c),this.current=_r.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const Es=new Float32Array(16);function ll(h){return[gr(255*h.r,255*h.g),gr(255*h.b,255*h.a)]}class ha{constructor(i,c,f){this.value=i,this.uniformNames=c.map(v=>`u_${v}`),this.type=f}setUniform(i,c,f){i.set(f.constantOr(this.value))}getBinding(i,c,f){return this.type==="color"?new Hl(i,c):new jl(i,c)}}class da{constructor(i,c){this.uniformNames=c.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=i.tlbr}setConstantDashPositions(i,c){this.dashTo=[0,i.y,i.height,i.width],this.dashFrom=[0,c.y,c.height,c.width]}setUniform(i,c,f,v){let w=null;v==="u_pattern_to"?w=this.patternTo:v==="u_pattern_from"?w=this.patternFrom:v==="u_dasharray_to"?w=this.dashTo:v==="u_dasharray_from"?w=this.dashFrom:v==="u_pixel_ratio_to"?w=this.pixelRatioTo:v==="u_pixel_ratio_from"&&(w=this.pixelRatioFrom),w!==null&&i.set(w)}getBinding(i,c,f){return f.substr(0,9)==="u_pattern"||f.substr(0,12)==="u_dasharray_"?new al(i,c):new jl(i,c)}}class si{constructor(i,c,f,v){this.expression=i,this.type=f,this.maxValue=0,this.paintVertexAttributes=c.map(w=>({name:`a_${w}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(i,c,f){const v=this.paintVertexArray.length,w=this.expression.evaluate(new Jr(0,f),c,{},f.canonical,[],f.formattedSection);this.paintVertexArray.resize(i),this._setPaintValue(v,i,w)}updatePaintArray(i,c,f,v,w){const S=this.expression.evaluate(new Jr(0,w),f,v);this._setPaintValue(i,c,S)}_setPaintValue(i,c,f){if(this.type==="color"){const v=ll(f);for(let w=i;w<c;w++)this.paintVertexArray.emplace(w,v[0],v[1])}else{for(let v=i;v<c;v++)this.paintVertexArray.emplace(v,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ii{constructor(i,c,f,v,w,S){this.expression=i,this.uniformNames=c.map(I=>`u_${I}_t`),this.type=f,this.useIntegerZoom=v,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=c.map(I=>({name:`a_${I}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(i,c,f){const v=this.expression.evaluate(new Jr(this.zoom,f),c,{},f.canonical,[],f.formattedSection),w=this.expression.evaluate(new Jr(this.zoom+1,f),c,{},f.canonical,[],f.formattedSection),S=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(S,i,v,w)}updatePaintArray(i,c,f,v,w){const S=this.expression.evaluate(new Jr(this.zoom,w),f,v),I=this.expression.evaluate(new Jr(this.zoom+1,w),f,v);this._setPaintValue(i,c,S,I)}_setPaintValue(i,c,f,v){if(this.type==="color"){const w=ll(f),S=ll(v);for(let I=i;I<c;I++)this.paintVertexArray.emplace(I,w[0],w[1],S[0],S[1])}else{for(let w=i;w<c;w++)this.paintVertexArray.emplace(w,f,v);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(v))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,c){const f=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,v=_t(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);i.set(v)}getBinding(i,c,f){return new jl(i,c)}}class oo{constructor(i,c,f,v,w,S){this.expression=i,this.type=c,this.useIntegerZoom=f,this.zoom=v,this.layerId=S,this.zoomInPaintVertexArray=new w,this.zoomOutPaintVertexArray=new w}populatePaintArray(i,c,f){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(v,i,this.getPositionIds(c),f)}updatePaintArray(i,c,f,v,w){this._setPaintValues(i,c,this.getPositionIds(f),w)}_setPaintValues(i,c,f,v){const w=this.getPositions(v);if(!w||!f)return;const S=w[f.min],I=w[f.mid],F=w[f.max];if(S&&I&&F)for(let $=i;$<c;$++)this.emplace(this.zoomInPaintVertexArray,$,I,S),this.emplace(this.zoomOutPaintVertexArray,$,I,F)}upload(i){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const c=this.getVertexAttributes();this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,c,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,c,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class po extends oo{getPositions(i){return i.imagePositions}getPositionIds(i){return i.patterns&&i.patterns[this.layerId]}getVertexAttributes(){return Yr.members}emplace(i,c,f,v){i.emplace(c,f.tlbr[0],f.tlbr[1],f.tlbr[2],f.tlbr[3],v.tlbr[0],v.tlbr[1],v.tlbr[2],v.tlbr[3],f.pixelRatio,v.pixelRatio)}}class us extends oo{getPositions(i){return i.dashPositions}getPositionIds(i){return i.dashes&&i.dashes[this.layerId]}getVertexAttributes(){return xi.members}emplace(i,c,f,v){i.emplace(c,0,f.y,f.height,f.width,0,v.y,v.height,v.width)}}class Xo{constructor(i,c,f){this.binders={},this._buffers=[];const v=[];for(const w in i.paint._values){if(!f(w))continue;const S=i.paint.get(w);if(!(S instanceof Vs&&$s(S.property.specification)))continue;const I=tv(w,i.type),F=S.value,$=S.property.specification.type,G=S.property.useIntegerZoom,W=S.property.specification["property-type"],te=W==="cross-faded"||W==="cross-faded-data-driven";if(F.kind==="constant")this.binders[w]=te?new da(F.value,I):new ha(F.value,I,$),v.push(`/u_${w}`);else if(F.kind==="source"||te){const ie=Um(w,$,"source");this.binders[w]=te?w==="line-dasharray"?new us(F,$,G,c,ie,i.id):new po(F,$,G,c,ie,i.id):new si(F,I,$,ie),v.push(`/a_${w}`)}else{const ie=Um(w,$,"composite");this.binders[w]=new ii(F,I,$,G,c,ie),v.push(`/z_${w}`)}}this.cacheKey=v.sort().join("")}getMaxValue(i){const c=this.binders[i];return c instanceof si||c instanceof ii?c.maxValue:0}populatePaintArrays(i,c,f){for(const v in this.binders){const w=this.binders[v];(w instanceof si||w instanceof ii||w instanceof oo)&&w.populatePaintArray(i,c,f)}}setConstantPatternPositions(i,c){for(const f in this.binders){const v=this.binders[f];v instanceof da&&v.setConstantPatternPositions(i,c)}}setConstantDashPositions(i,c){for(const f in this.binders){const v=this.binders[f];v instanceof da&&v.setConstantDashPositions(i,c)}}updatePaintArrays(i,c,f,v,w){let S=!1;for(const I in i){const F=c.getPositions(I);for(const $ of F){const G=f.feature($.index);for(const W in this.binders){const te=this.binders[W];if((te instanceof si||te instanceof ii||te instanceof oo)&&te.expression.isStateDependent===!0){const ie=v.paint.get(W);te.expression=ie.value,te.updatePaintArray($.start,$.end,G,i[I],w),S=!0}}}}return S}defines(){const i=[];for(const c in this.binders){const f=this.binders[c];(f instanceof ha||f instanceof da)&&i.push(...f.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return i}getBinderAttributes(){const i=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof si||f instanceof ii)for(let v=0;v<f.paintVertexAttributes.length;v++)i.push(f.paintVertexAttributes[v].name);else if(f instanceof oo){const v=f.getVertexAttributes();for(const w of v)i.push(w.name)}}return i}getBinderUniforms(){const i=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof ha||f instanceof da||f instanceof ii)for(const v of f.uniformNames)i.push(v)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,c){const f=[];for(const v in this.binders){const w=this.binders[v];if(w instanceof ha||w instanceof da||w instanceof ii){for(const S of w.uniformNames)if(c[S]){const I=w.getBinding(i,c[S],S);f.push({name:S,property:v,binding:I})}}}return f}setUniforms(i,c,f,v){for(const{name:w,property:S,binding:I}of c)this.binders[S].setUniform(I,v,f.get(S),w)}updatePaintBuffers(i){this._buffers=[];for(const c in this.binders){const f=this.binders[c];if(i&&f instanceof oo){const v=i.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(f instanceof si||f instanceof ii)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(i){for(const c in this.binders){const f=this.binders[c];(f instanceof si||f instanceof ii||f instanceof oo)&&f.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const c=this.binders[i];(c instanceof si||c instanceof ii||c instanceof oo)&&c.destroy()}}}class $c{constructor(i,c,f=()=>!0){this.programConfigurations={};for(const v of i)this.programConfigurations[v.id]=new Xo(v,c,f);this.needsUpload=!1,this._featureMap=new fo,this._bufferOffset=0}populatePaintArrays(i,c,f,v){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(i,c,v);c.id!==void 0&&this._featureMap.add(c.id,f,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,c,f,v){for(const w of f)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(i,this._featureMap,c,w,v)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function tv(h,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${i}-`,"").replace(/-/g,"_")]}function Um(h,i,c){const f={color:{source:il,composite:d},number:{source:Ou,composite:il}},v=function(w){return{"line-pattern":{source:rt,composite:rt},"fill-pattern":{source:rt,composite:rt},"fill-extrusion-pattern":{source:rt,composite:rt},"line-dasharray":{source:ht,composite:ht}}[w]}(h);return v&&v[c]||f[i][c]}Nn("ConstantBinder",ha),Nn("CrossFadedConstantBinder",da),Nn("SourceExpressionBinder",si),Nn("CrossFadedPatternBinder",po),Nn("CrossFadedDasharrayBinder",us),Nn("CompositeExpressionBinder",ii),Nn("ProgramConfiguration",Xo,{omit:["_buffers"]}),Nn("ProgramConfigurationSet",$c);const op=Math.pow(2,14)-1,Gl=-op-1;function cl(h){const i=Ue/h.extent,c=h.loadGeometry();for(let f=0;f<c.length;f++){const v=c[f];for(let w=0;w<v.length;w++){const S=v[w],I=Math.round(S.x*i),F=Math.round(S.y*i);S.x=_t(I,Gl,op),S.y=_t(F,Gl,op),(I<S.x||I>S.x+1||F<S.y||F>S.y+1)&&Ke("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Wl(h,i){return{type:h.type,id:h.id,properties:h.properties,geometry:i?cl(h):[]}}const $d=-32768;function sp(h,i,c,f,v){h.emplaceBack($d+8*i+f,$d+8*c+v)}class Vd{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasDependencies=!1,this.layoutVertexArray=new $e,this.indexArray=new Dt,this.segments=new Dn,this.programConfigurations=new $c(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,f){const v=this.layers[0],w=[];let S=null,I=!1,F=v.type==="heatmap";if(v.type==="circle"){const G=v;S=G.layout.get("circle-sort-key"),I=!S.isConstant(),F=F||G.paint.get("circle-pitch-alignment")==="map"}const $=F?c.subdivisionGranularity.circle:1;for(const{feature:G,id:W,index:te,sourceLayerIndex:ie}of i){const pe=this.layers[0]._featureFilter.needGeometry,me=Wl(G,pe);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),me,f))continue;const ve=I?S.evaluate(me,{},f):void 0,Ae={id:W,properties:G.properties,type:G.type,sourceLayerIndex:ie,index:te,geometry:pe?me.geometry:cl(G),patterns:{},sortKey:ve};w.push(Ae)}I&&w.sort((G,W)=>G.sortKey-W.sortKey);for(const G of w){const{geometry:W,index:te,sourceLayerIndex:ie}=G,pe=i[te].feature;this.addFeature(G,W,te,f,$),c.featureIndex.insert(pe,W,te,ie,this.index)}}update(i,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,tn),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,c,f,v,w=1){let S;switch(w){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${w}; valid values are 1, 3, 5, 7.`)}const I=S.length;for(const F of c)for(const $ of F){const G=$.x,W=$.y;if(G<0||G>=Ue||W<0||W>=Ue)continue;const te=this.segments.prepareSegment(I*I,this.layoutVertexArray,this.indexArray,i.sortKey),ie=te.vertexLength;for(let pe=0;pe<I;pe++)for(let me=0;me<I;me++)sp(this.layoutVertexArray,G,W,S[me],S[pe]);for(let pe=0;pe<I-1;pe++)for(let me=0;me<I-1;me++){const ve=ie+pe*I+me,Ae=ie+(pe+1)*I+me;this.indexArray.emplaceBack(ve,Ae+1,ve+1),this.indexArray.emplaceBack(ve,Ae,Ae+1)}te.vertexLength+=I*I,te.primitiveLength+=(I-1)*(I-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:{},canonical:v})}}function Ah(h,i){for(let c=0;c<h.length;c++)if(Nu(i,h[c]))return!0;for(let c=0;c<i.length;c++)if(Nu(h,i[c]))return!0;return!!lp(h,i)}function ap(h,i,c){return!!Nu(h,i)||!!nv(i,h,c)}function l0(h,i){if(h.length===1)return u0(i,h[0]);for(let c=0;c<i.length;c++){const f=i[c];for(let v=0;v<f.length;v++)if(Nu(h,f[v]))return!0}for(let c=0;c<h.length;c++)if(u0(i,h[c]))return!0;for(let c=0;c<i.length;c++)if(lp(h,i[c]))return!0;return!1}function c0(h,i,c){if(h.length>1){if(lp(h,i))return!0;for(let f=0;f<i.length;f++)if(nv(i[f],h,c))return!0}for(let f=0;f<h.length;f++)if(nv(h[f],i,c))return!0;return!1}function lp(h,i){if(h.length===0||i.length===0)return!1;for(let c=0;c<h.length-1;c++){const f=h[c],v=h[c+1];for(let w=0;w<i.length-1;w++)if(v2(f,v,i[w],i[w+1]))return!0}return!1}function v2(h,i,c,f){return An(h,c,f)!==An(i,c,f)&&An(h,i,c)!==An(h,i,f)}function nv(h,i,c){const f=c*c;if(i.length===1)return h.distSqr(i[0])<f;for(let v=1;v<i.length;v++)if(rv(h,i[v-1],i[v])<f)return!0;return!1}function rv(h,i,c){const f=i.distSqr(c);if(f===0)return h.distSqr(i);const v=((h.x-i.x)*(c.x-i.x)+(h.y-i.y)*(c.y-i.y))/f;return h.distSqr(v<0?i:v>1?c:c.sub(i)._mult(v)._add(i))}function u0(h,i){let c,f,v,w=!1;for(let S=0;S<h.length;S++){c=h[S];for(let I=0,F=c.length-1;I<c.length;F=I++)f=c[I],v=c[F],f.y>i.y!=v.y>i.y&&i.x<(v.x-f.x)*(i.y-f.y)/(v.y-f.y)+f.x&&(w=!w)}return w}function Nu(h,i){let c=!1;for(let f=0,v=h.length-1;f<h.length;v=f++){const w=h[f],S=h[v];w.y>i.y!=S.y>i.y&&i.x<(S.x-w.x)*(i.y-w.y)/(S.y-w.y)+w.x&&(c=!c)}return c}function Bu(h,i,c){const f=c[0],v=c[2];if(h.x<f.x&&i.x<f.x||h.x>v.x&&i.x>v.x||h.y<f.y&&i.y<f.y||h.y>v.y&&i.y>v.y)return!1;const w=An(h,i,c[0]);return w!==An(h,i,c[1])||w!==An(h,i,c[2])||w!==An(h,i,c[3])}function cp(h,i,c){const f=i.paint.get(h).value;return f.kind==="constant"?f.value:c.programConfigurations.get(i.id).getMaxValue(h)}function $m(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function up(h,i,c,f,v){if(!i[0]&&!i[1])return h;const w=m.convert(i)._mult(v);c==="viewport"&&w._rotate(-f);const S=[];for(let I=0;I<h.length;I++)S.push(h[I].sub(w));return S}function s1(h){const i=[];for(let c=0;c<h.length;c++){const f=h[c],v=i.at(-1);(c===0||v&&!f.equals(v))&&i.push(f)}return i}function a1({queryGeometry:h,size:i},c){return ap(h,c,i)}function Vm({queryGeometry:h,size:i,transform:c,unwrappedTileID:f,getElevation:v},w){return ap(h,w,i*(c.projectTileCoordinates(w.x,w.y,f,v).signedDistanceFromCamera/c.cameraToCenterDistance))}function Cs({queryGeometry:h,size:i,transform:c,unwrappedTileID:f,getElevation:v},w){const S=c.projectTileCoordinates(w.x,w.y,f,v).signedDistanceFromCamera,I=i*(c.cameraToCenterDistance/S);return ap(h,hp(w,c,f,v),I)}function y2({queryGeometry:h,size:i,transform:c,unwrappedTileID:f,getElevation:v},w){return ap(h,hp(w,c,f,v),i)}function l1({queryGeometry:h,size:i,transform:c,unwrappedTileID:f,getElevation:v,pitchAlignment:w="map",pitchScale:S="map"},I){const F=w==="map"?S==="map"?a1:Vm:S==="map"?Cs:y2,$={queryGeometry:h,size:i,transform:c,unwrappedTileID:f,getElevation:v};for(const G of I)for(const W of G)if(F($,W))return!0;return!1}function hp(h,i,c,f){const v=i.projectTileCoordinates(h.x,h.y,c,f).point;return new m((.5*v.x+.5)*i.width,(.5*-v.y+.5)*i.height)}let hs,c1;Nn("CircleBucket",Vd,{omit:["layers"]});var ir={get paint(){return c1=c1||new Wi({"circle-radius":new rr(De.paint_circle["circle-radius"]),"circle-color":new rr(De.paint_circle["circle-color"]),"circle-blur":new rr(De.paint_circle["circle-blur"]),"circle-opacity":new rr(De.paint_circle["circle-opacity"]),"circle-translate":new Vn(De.paint_circle["circle-translate"]),"circle-translate-anchor":new Vn(De.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Vn(De.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Vn(De.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rr(De.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rr(De.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rr(De.paint_circle["circle-stroke-opacity"])})},get layout(){return hs=hs||new Wi({"circle-sort-key":new rr(De.layout_circle["circle-sort-key"])})}};class dp extends Ss{constructor(i,c){super(i,ir,c)}createBucket(i){return new Vd(i)}queryRadius(i){const c=i;return cp("circle-radius",this,c)+cp("circle-stroke-width",this,c)+$m(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:i,feature:c,featureState:f,geometry:v,transform:w,pixelsToTileUnits:S,unwrappedTileID:I,getElevation:F}){const $=up(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-w.bearingInRadians,S),G=this.paint.get("circle-radius").evaluate(c,f)+this.paint.get("circle-stroke-width").evaluate(c,f),W=this.paint.get("circle-pitch-scale"),te=this.paint.get("circle-pitch-alignment");let ie,pe;return te==="map"?(ie=$,pe=G*S):(ie=function(me,ve,Ae,We){return me.map(Me=>hp(Me,ve,Ae,We))}($,w,I,F),pe=G),l1({queryGeometry:ie,size:pe,transform:w,unwrappedTileID:I,getElevation:F,pitchAlignment:te,pitchScale:W},v)}}class iv extends Vd{}let h0;Nn("HeatmapBucket",iv,{omit:["layers"]});var _2={get paint(){return h0=h0||new Wi({"heatmap-radius":new rr(De.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rr(De.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Vn(De.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ua(De.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Vn(De.paint_heatmap["heatmap-opacity"])})}};function jd(h,{width:i,height:c},f,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==i*c*f)throw new RangeError(`mismatched image size. expected: ${v.length} but got: ${i*c*f}`)}else v=new Uint8Array(i*c*f);return h.width=i,h.height=c,h.data=v,h}function jm(h,{width:i,height:c},f){if(i===h.width&&c===h.height)return;const v=jd({},{width:i,height:c},f);Hm(h,v,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,i),height:Math.min(h.height,c)},f),h.width=i,h.height=c,h.data=v.data}function Hm(h,i,c,f,v,w){if(v.width===0||v.height===0)return i;if(v.width>h.width||v.height>h.height||c.x>h.width-v.width||c.y>h.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>i.width||v.height>i.height||f.x>i.width-v.width||f.y>i.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const S=h.data,I=i.data;if(S===I)throw new Error("srcData equals dstData, so image is already copied");for(let F=0;F<v.height;F++){const $=((c.y+F)*h.width+c.x)*w,G=((f.y+F)*i.width+f.x)*w;for(let W=0;W<v.width*w;W++)I[G+W]=S[$+W]}return i}class fp{constructor(i,c){jd(this,i,1,c)}resize(i){jm(this,i,1)}clone(){return new fp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,f,v,w){Hm(i,c,f,v,w,1)}}class Ts{constructor(i,c){jd(this,i,4,c)}resize(i){jm(this,i,4)}replace(i,c){c?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ts({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,f,v,w){Hm(i,c,f,v,w,4)}setPixel(i,c,f){const v=4*(i*this.width+c);this.data[v+0]=Math.round(255*f.r/f.a),this.data[v+1]=Math.round(255*f.g/f.a),this.data[v+2]=Math.round(255*f.b/f.a),this.data[v+3]=Math.round(255*f.a)}}function d0(h){const i={},c=h.resolution||256,f=h.clips?h.clips.length:1,v=h.image||new Ts({width:c,height:f});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const w=(S,I,F)=>{i[h.evaluationKey]=F;const $=h.expression.evaluate(i);v.setPixel(S/4/c,I/4,$)};if(h.clips)for(let S=0,I=0;S<f;++S,I+=4*c)for(let F=0,$=0;F<c;F++,$+=4){const G=F/(c-1),{start:W,end:te}=h.clips[S];w(I,$,W*(1-G)+te*G)}else for(let S=0,I=0;S<c;S++,I+=4)w(0,I,S/(c-1));return v}Nn("AlphaImage",fp),Nn("RGBAImage",Ts);const Gm="big-fb";class f0 extends Ss{createBucket(i){return new iv(i)}constructor(i,c){super(i,_2,c),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=d0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Gm)&&this.heatmapFbos.delete(Gm)}queryRadius(i){return cp("heatmap-radius",this,i)}queryIntersectsFeature({queryGeometry:i,feature:c,featureState:f,geometry:v,transform:w,pixelsToTileUnits:S,unwrappedTileID:I,getElevation:F}){return l1({queryGeometry:i,size:this.paint.get("heatmap-radius").evaluate(c,f)*S,transform:w,unwrappedTileID:I,getElevation:F},v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let Zo;var ql={get paint(){return Zo=Zo||new Wi({"hillshade-illumination-direction":new Vn(De.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Vn(De.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Vn(De.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Vn(De.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Vn(De.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Vn(De.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Vn(De.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Vn(De.paint_hillshade["hillshade-method"])})}};class Ih extends Ss{constructor(i,c){super(i,ql,c),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let i=this.paint.get("hillshade-illumination-direction").values,c=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,v=this.paint.get("hillshade-shadow-color").values;const w=Math.max(i.length,c.length,f.length,v.length);i=i.concat(Array(w-i.length).fill(i.at(-1))),c=c.concat(Array(w-c.length).fill(c.at(-1))),f=f.concat(Array(w-f.length).fill(f.at(-1))),v=v.concat(Array(w-v.length).fill(v.at(-1)));const S=c.map(Nt);return{directionRadians:i.map(Nt),altitudeRadians:S,shadowColor:v,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let p0;var u1={get paint(){return p0=p0||new Wi({"color-relief-opacity":new Vn(De["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new ua(De["paint_color-relief"]["color-relief-color"])})}};class Na{constructor(i,c,f,v){this.context=i,this.format=f,this.texture=i.gl.createTexture(),this.update(c,v)}update(i,c,f){const{width:v,height:w}=i,S=!(this.size&&this.size[0]===v&&this.size[1]===w||f),{context:I}=this,{gl:F}=I;if(this.useMipmap=!!(c&&c.useMipmap),F.bindTexture(F.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===F.RGBA&&(!c||c.premultiply!==!1)),S)this.size=[v,w],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Wt(i)?F.texImage2D(F.TEXTURE_2D,0,this.format,this.format,F.UNSIGNED_BYTE,i):F.texImage2D(F.TEXTURE_2D,0,this.format,v,w,0,this.format,F.UNSIGNED_BYTE,i.data);else{const{x:$,y:G}=f||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||Wt(i)?F.texSubImage2D(F.TEXTURE_2D,0,$,G,F.RGBA,F.UNSIGNED_BYTE,i):F.texSubImage2D(F.TEXTURE_2D,0,$,G,v,w,F.RGBA,F.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&F.generateMipmap(F.TEXTURE_2D),I.pixelStoreUnpackFlipY.setDefault(),I.pixelStoreUnpack.setDefault(),I.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(i,c,f){const{context:v}=this,{gl:w}=v;w.bindTexture(w.TEXTURE_2D,this.texture),f!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=w.LINEAR),i!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,i),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,f||i),this.filter=i),c!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,c),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class m0{constructor(i,c,f,v=1,w=1,S=1,I=0){if(this.uid=i,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Ke(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=c.height;const F=this.dim=c.height-2;switch(this.data=new Uint32Array(c.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=v,this.greenFactor=w,this.blueFactor=S,this.baseShift=I;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let $=0;$<F;$++)this.data[this._idx(-1,$)]=this.data[this._idx(0,$)],this.data[this._idx(F,$)]=this.data[this._idx(F-1,$)],this.data[this._idx($,-1)]=this.data[this._idx($,0)],this.data[this._idx($,F)]=this.data[this._idx($,F-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(F,-1)]=this.data[this._idx(F-1,0)],this.data[this._idx(-1,F)]=this.data[this._idx(0,F-1)],this.data[this._idx(F,F)]=this.data[this._idx(F-1,F-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let $=0;$<F;$++)for(let G=0;G<F;G++){const W=this.get($,G);W>this.max&&(this.max=W),W<this.min&&(this.min=W)}}get(i,c){const f=new Uint8Array(this.data.buffer),v=4*this._idx(i,c);return this.unpack(f[v],f[v+1],f[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,c){if(i<-1||i>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${i}, y: ${c}, dim: ${this.dim}`);return(c+1)*this.stride+(i+1)}unpack(i,c,f){return i*this.redFactor+c*this.greenFactor+f*this.blueFactor-this.baseShift}pack(i){return Xl(i,this.getUnpackVector())}getPixels(){return new Ts({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,c,f){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let v=c*this.dim,w=c*this.dim+this.dim,S=f*this.dim,I=f*this.dim+this.dim;switch(c){case-1:v=w-1;break;case 1:w=v+1}switch(f){case-1:S=I-1;break;case 1:I=S+1}const F=-c*this.dim,$=-f*this.dim;for(let G=S;G<I;G++)for(let W=v;W<w;W++)this.data[this._idx(W,G)]=i.data[this._idx(W+F,G+$)]}}function Xl(h,i){const c=i[0],f=i[1],v=i[2],w=i[3],S=Math.min(c,f,v),I=Math.round((h+w)/S);return{r:Math.floor(I*S/c)%256,g:Math.floor(I*S/f)%256,b:Math.floor(I*S/v)%256}}Nn("DEMData",m0);class x2 extends Ss{constructor(i,c){super(i,u1,c)}_createColorRamp(i){const c={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof Cc&&f._styleExpression.expression instanceof So){this.colorRampExpression=f;const S=f._styleExpression.expression;c.elevationStops=S.labels,c.colorStops=[];for(const I of c.elevationStops)c.colorStops.push(S.evaluate({globals:{elevation:I}}))}if(c.elevationStops.length<1&&(c.elevationStops=[0],c.colorStops=[_r.transparent]),c.elevationStops.length<2&&(c.elevationStops.push(c.elevationStops[0]+1),c.colorStops.push(c.colorStops[0])),c.elevationStops.length<=i)return c;const v={elevationStops:[],colorStops:[]},w=(c.elevationStops.length-1)/(i-1);for(let S=0;S<c.elevationStops.length-.5;S+=w)v.elevationStops.push(c.elevationStops[Math.round(S)]),v.colorStops.push(c.colorStops[Math.round(S)]);return Ke(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${i}, provided: ${c.elevationStops.length}`),v}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(i,c,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const v=this._createColorRamp(c),w=new Ts({width:v.colorStops.length,height:1}),S=new Ts({width:v.colorStops.length,height:1});for(let I=0;I<v.elevationStops.length;I++){const F=Xl(v.elevationStops[I],f);S.setPixel(0,I,new _r(F.r/255,F.g/255,F.b/255,1)),w.setPixel(0,I,v.colorStops[I])}return this.colorRampTextures={elevationTexture:new Na(i,S,i.gl.RGBA),colorTexture:new Na(i,w,i.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const h1=Vi([{name:"a_pos",components:2,type:"Int16"}],4),{members:d1}=h1;function Wm(h,i,c){const f=c.patternDependencies;let v=!1;for(const w of i){const S=w.paint.get(`${h}-pattern`);S.isConstant()||(v=!0);const I=S.constantOr(null);I&&(v=!0,f[I.to]=!0,f[I.from]=!0)}return v}function ov(h,i,c,f,v){const{zoom:w}=f,S=v.patternDependencies;for(const I of i){const F=I.paint.get(`${h}-pattern`).value;if(F.kind!=="constant"){let $=F.evaluate({zoom:w-1},c,{},v.availableImages),G=F.evaluate({zoom:w},c,{},v.availableImages),W=F.evaluate({zoom:w+1},c,{},v.availableImages);$=$&&$.name?$.name:$,G=G&&G.name?G.name:G,W=W&&W.name?W.name:W,S[$]=!0,S[G]=!0,S[W]=!0,c.patterns[I.id]={min:$,mid:G,max:W}}}return c}function f1(h,i,c,f,v){let w;if(v===function(S,I,F,$){let G=0;for(let W=I,te=F-$;W<F;W+=$)G+=(S[te]-S[W])*(S[W+1]+S[te+1]),te=W;return G}(h,i,c,f)>0)for(let S=i;S<c;S+=f)w=$u(S/f|0,h[S],h[S+1],w);else for(let S=c-f;S>=i;S-=f)w=$u(S/f|0,h[S],h[S+1],w);return w&&Bo(w,w.next)&&(kh(w),w=w.next),w}function Vc(h,i){if(!h)return h;i||(i=h);let c,f=h;do if(c=!1,f.steiner||!Bo(f,f.next)&&Li(f.prev,f,f.next)!==0)f=f.next;else{if(kh(f),f=i=f.prev,f===f.next)break;c=!0}while(c||f!==i);return i}function Hd(h,i,c,f,v,w,S){if(!h)return;!S&&w&&function(F,$,G,W){let te=F;do te.z===0&&(te.z=mo(te.x,te.y,$,G,W)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==F);te.prevZ.nextZ=null,te.prevZ=null,function(ie){let pe,me=1;do{let ve,Ae=ie;ie=null;let We=null;for(pe=0;Ae;){pe++;let Me=Ae,Oe=0;for(let dt=0;dt<me&&(Oe++,Me=Me.nextZ,Me);dt++);let tt=me;for(;Oe>0||tt>0&&Me;)Oe!==0&&(tt===0||!Me||Ae.z<=Me.z)?(ve=Ae,Ae=Ae.nextZ,Oe--):(ve=Me,Me=Me.nextZ,tt--),We?We.nextZ=ve:ie=ve,ve.prevZ=We,We=ve;Ae=Me}We.nextZ=null,me*=2}while(pe>1)}(te)}(h,f,v,w);let I=h;for(;h.prev!==h.next;){const F=h.prev,$=h.next;if(w?Kr(h,f,v,w):ul(h))i.push(F.i,h.i,$.i),kh(h),h=$.next,I=$.next;else if((h=$)===I){S?S===1?Hd(h=Yo(Vc(h),i),i,c,f,v,w,2):S===2&&To(h,i,c,f,v,w):Hd(Vc(h),i,c,f,v,w,1);break}}}function ul(h){const i=h.prev,c=h,f=h.next;if(Li(i,c,f)>=0)return!1;const v=i.x,w=c.x,S=f.x,I=i.y,F=c.y,$=f.y,G=Math.min(v,w,S),W=Math.min(I,F,$),te=Math.max(v,w,S),ie=Math.max(I,F,$);let pe=f.next;for(;pe!==i;){if(pe.x>=G&&pe.x<=te&&pe.y>=W&&pe.y<=ie&&Dh(v,I,w,F,S,$,pe.x,pe.y)&&Li(pe.prev,pe,pe.next)>=0)return!1;pe=pe.next}return!0}function Kr(h,i,c,f){const v=h.prev,w=h,S=h.next;if(Li(v,w,S)>=0)return!1;const I=v.x,F=w.x,$=S.x,G=v.y,W=w.y,te=S.y,ie=Math.min(I,F,$),pe=Math.min(G,W,te),me=Math.max(I,F,$),ve=Math.max(G,W,te),Ae=mo(ie,pe,i,c,f),We=mo(me,ve,i,c,f);let Me=h.prevZ,Oe=h.nextZ;for(;Me&&Me.z>=Ae&&Oe&&Oe.z<=We;){if(Me.x>=ie&&Me.x<=me&&Me.y>=pe&&Me.y<=ve&&Me!==v&&Me!==S&&Dh(I,G,F,W,$,te,Me.x,Me.y)&&Li(Me.prev,Me,Me.next)>=0||(Me=Me.prevZ,Oe.x>=ie&&Oe.x<=me&&Oe.y>=pe&&Oe.y<=ve&&Oe!==v&&Oe!==S&&Dh(I,G,F,W,$,te,Oe.x,Oe.y)&&Li(Oe.prev,Oe,Oe.next)>=0))return!1;Oe=Oe.nextZ}for(;Me&&Me.z>=Ae;){if(Me.x>=ie&&Me.x<=me&&Me.y>=pe&&Me.y<=ve&&Me!==v&&Me!==S&&Dh(I,G,F,W,$,te,Me.x,Me.y)&&Li(Me.prev,Me,Me.next)>=0)return!1;Me=Me.prevZ}for(;Oe&&Oe.z<=We;){if(Oe.x>=ie&&Oe.x<=me&&Oe.y>=pe&&Oe.y<=ve&&Oe!==v&&Oe!==S&&Dh(I,G,F,W,$,te,Oe.x,Oe.y)&&Li(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function Yo(h,i){let c=h;do{const f=c.prev,v=c.next.next;!Bo(f,v)&&sv(f,c,c.next,v)&&Lh(f,v)&&Lh(v,f)&&(i.push(f.i,c.i,v.i),kh(c),kh(c.next),c=h=v),c=c.next}while(c!==h);return Vc(c)}function To(h,i,c,f,v,w){let S=h;do{let I=S.next.next;for(;I!==S.prev;){if(S.i!==I.i&&g0(S,I)){let F=av(S,I);return S=Vc(S,S.next),F=Vc(F,F.next),Hd(S,i,c,f,v,w,0),void Hd(F,i,c,f,v,w,0)}I=I.next}S=S.next}while(S!==h)}function ds(h,i){let c=h.x-i.x;return c===0&&(c=h.y-i.y,c===0)&&(c=(h.next.y-h.y)/(h.next.x-h.x)-(i.next.y-i.y)/(i.next.x-i.x)),c}function Ba(h,i){const c=function(v,w){let S=w;const I=v.x,F=v.y;let $,G=-1/0;if(Bo(v,S))return S;do{if(Bo(v,S.next))return S.next;if(F<=S.y&&F>=S.next.y&&S.next.y!==S.y){const me=S.x+(F-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(me<=I&&me>G&&(G=me,$=S.x<S.next.x?S:S.next,me===I))return $}S=S.next}while(S!==w);if(!$)return null;const W=$,te=$.x,ie=$.y;let pe=1/0;S=$;do{if(I>=S.x&&S.x>=te&&I!==S.x&&Rh(F<ie?I:G,F,te,ie,F<ie?G:I,F,S.x,S.y)){const me=Math.abs(F-S.y)/(I-S.x);Lh(S,v)&&(me<pe||me===pe&&(S.x>$.x||S.x===$.x&&pp($,S)))&&($=S,pe=me)}S=S.next}while(S!==W);return $}(h,i);if(!c)return i;const f=av(c,h);return Vc(f,f.next),Vc(c,c.next)}function pp(h,i){return Li(h.prev,h,i.prev)<0&&Li(i.next,h,h.next)<0}function mo(h,i,c,f,v){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-c)*v|0)|h<<8))|h<<4))|h<<2))|h<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-f)*v|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function qm(h){let i=h,c=h;do(i.x<c.x||i.x===c.x&&i.y<c.y)&&(c=i),i=i.next;while(i!==h);return c}function Rh(h,i,c,f,v,w,S,I){return(v-S)*(i-I)>=(h-S)*(w-I)&&(h-S)*(f-I)>=(c-S)*(i-I)&&(c-S)*(w-I)>=(v-S)*(f-I)}function Dh(h,i,c,f,v,w,S,I){return!(h===S&&i===I)&&Rh(h,i,c,f,v,w,S,I)}function g0(h,i){return h.next.i!==i.i&&h.prev.i!==i.i&&!function(c,f){let v=c;do{if(v.i!==c.i&&v.next.i!==c.i&&v.i!==f.i&&v.next.i!==f.i&&sv(v,v.next,c,f))return!0;v=v.next}while(v!==c);return!1}(h,i)&&(Lh(h,i)&&Lh(i,h)&&function(c,f){let v=c,w=!1;const S=(c.x+f.x)/2,I=(c.y+f.y)/2;do v.y>I!=v.next.y>I&&v.next.y!==v.y&&S<(v.next.x-v.x)*(I-v.y)/(v.next.y-v.y)+v.x&&(w=!w),v=v.next;while(v!==c);return w}(h,i)&&(Li(h.prev,h,i.prev)||Li(h,i.prev,i))||Bo(h,i)&&Li(h.prev,h,h.next)>0&&Li(i.prev,i,i.next)>0)}function Li(h,i,c){return(i.y-h.y)*(c.x-i.x)-(i.x-h.x)*(c.y-i.y)}function Bo(h,i){return h.x===i.x&&h.y===i.y}function sv(h,i,c,f){const v=hl(Li(h,i,c)),w=hl(Li(h,i,f)),S=hl(Li(c,f,h)),I=hl(Li(c,f,i));return v!==w&&S!==I||!(v!==0||!Uu(h,c,i))||!(w!==0||!Uu(h,f,i))||!(S!==0||!Uu(c,h,f))||!(I!==0||!Uu(c,i,f))}function Uu(h,i,c){return i.x<=Math.max(h.x,c.x)&&i.x>=Math.min(h.x,c.x)&&i.y<=Math.max(h.y,c.y)&&i.y>=Math.min(h.y,c.y)}function hl(h){return h>0?1:h<0?-1:0}function Lh(h,i){return Li(h.prev,h,h.next)<0?Li(h,i,h.next)>=0&&Li(h,h.prev,i)>=0:Li(h,i,h.prev)<0||Li(h,h.next,i)<0}function av(h,i){const c=jc(h.i,h.x,h.y),f=jc(i.i,i.x,i.y),v=h.next,w=i.prev;return h.next=i,i.prev=h,c.next=v,v.prev=c,f.next=c,c.prev=f,w.next=f,f.prev=w,f}function $u(h,i,c,f){const v=jc(h,i,c);return f?(v.next=f.next,v.prev=f,f.next.prev=v,f.next=v):(v.prev=v,v.next=v),v}function kh(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function jc(h,i,c){return{i:h,x:i,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Vu{constructor(i,c){if(c>i)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=i,this._minGranularity=c}getGranularityForZoomLevel(i){return Math.max(Math.floor(this._baseZoomGranularity/(1<<i)),this._minGranularity,1)}}class zh{constructor(i){this.fill=i.fill,this.line=i.line,this.tile=i.tile,this.stencil=i.stencil,this.circle=i.circle}}zh.noSubdivision=new zh({fill:new Vu(0,0),line:new Vu(0,0),tile:new Vu(0,0),stencil:new Vu(0,0),circle:1}),Nn("SubdivisionGranularityExpression",Vu),Nn("SubdivisionGranularitySetting",zh);const Oh=-32768,Fh=32767;class lv{constructor(i,c){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=i,this._granularityCellSize=Ue/i,this._canonical=c}_getKey(i,c){return(i+=32768)<<16|c+32768}_vertexToIndex(i,c){if(i<-32768||c<-32768||i>32767||c>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(i),v=0|Math.round(c),w=this._getKey(f,v);if(this._vertexDictionary.has(w))return this._vertexDictionary.get(w);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(w,S),this._vertexBuffer.push(f,v),S}_subdivideTrianglesScanline(i){if(this._granularity<2)return function(v,w){const S=[];for(let I=0;I<w.length;I+=3){const F=w[I],$=w[I+1],G=w[I+2],W=v[2*F],te=v[2*F+1];(v[2*$]-W)*(v[2*G+1]-te)-(v[2*$+1]-te)*(v[2*G]-W)>0?(S.push(F),S.push(G),S.push($)):(S.push(F),S.push($),S.push(G))}return S}(this._vertexBuffer,i);const c=[],f=i.length;for(let v=0;v<f;v+=3){const w=[i[v+0],i[v+1],i[v+2]],S=[this._vertexBuffer[2*i[v+0]+0],this._vertexBuffer[2*i[v+0]+1],this._vertexBuffer[2*i[v+1]+0],this._vertexBuffer[2*i[v+1]+1],this._vertexBuffer[2*i[v+2]+0],this._vertexBuffer[2*i[v+2]+1]];let I=1/0,F=1/0,$=-1/0,G=-1/0;for(let me=0;me<3;me++){const ve=S[2*me],Ae=S[2*me+1];I=Math.min(I,ve),$=Math.max($,ve),F=Math.min(F,Ae),G=Math.max(G,Ae)}if(I===$||F===G)continue;const W=Math.floor(I/this._granularityCellSize),te=Math.ceil($/this._granularityCellSize),ie=Math.floor(F/this._granularityCellSize),pe=Math.ceil(G/this._granularityCellSize);if(W!==te||ie!==pe)for(let me=ie;me<pe;me++){const ve=this._scanlineGenerateVertexRingForCellRow(me,S,w);Zl(this._vertexBuffer,ve,c)}else c.push(...w)}return c}_scanlineGenerateVertexRingForCellRow(i,c,f){const v=i*this._granularityCellSize,w=v+this._granularityCellSize,S=[];for(let I=0;I<3;I++){const F=c[2*I],$=c[2*I+1],G=c[2*(I+1)%6],W=c[(2*(I+1)+1)%6],te=c[2*(I+2)%6],ie=c[(2*(I+2)+1)%6],pe=G-F,me=W-$,ve=pe===0,Ae=me===0,We=(v-$)/me,Me=(w-$)/me,Oe=Math.min(We,Me),tt=Math.max(We,Me);if(!Ae&&(Oe>=1||tt<=0)||Ae&&($<v||$>w)){W>=v&&W<=w&&S.push(f[(I+1)%3]);continue}!Ae&&Oe>0&&S.push(this._vertexToIndex(F+pe*Oe,$+me*Oe));const dt=F+pe*Math.max(Oe,0),Ct=F+pe*Math.min(tt,1);ve||this._generateIntraEdgeVertices(S,F,$,G,W,dt,Ct),!Ae&&tt<1&&S.push(this._vertexToIndex(F+pe*tt,$+me*tt)),(Ae||W>=v&&W<=w)&&S.push(f[(I+1)%3]),!Ae&&(W<=v||W>=w)&&this._generateInterEdgeVertices(S,F,$,G,W,te,ie,Ct,v,w)}return S}_generateIntraEdgeVertices(i,c,f,v,w,S,I){const F=v-c,$=w-f,G=$===0,W=G?Math.min(c,v):Math.min(S,I),te=G?Math.max(c,v):Math.max(S,I),ie=Math.floor(W/this._granularityCellSize)+1,pe=Math.ceil(te/this._granularityCellSize)-1;if(G?c<v:S<I)for(let me=ie;me<=pe;me++){const ve=me*this._granularityCellSize;i.push(this._vertexToIndex(ve,f+$*(ve-c)/F))}else for(let me=pe;me>=ie;me--){const ve=me*this._granularityCellSize;i.push(this._vertexToIndex(ve,f+$*(ve-c)/F))}}_generateInterEdgeVertices(i,c,f,v,w,S,I,F,$,G){const W=w-f,te=S-v,ie=I-w,pe=($-w)/ie,me=(G-w)/ie,ve=Math.min(pe,me),Ae=Math.max(pe,me),We=v+te*ve;let Me=Math.floor(Math.min(We,F)/this._granularityCellSize)+1,Oe=Math.ceil(Math.max(We,F)/this._granularityCellSize)-1,tt=F<We;const dt=ie===0;if(dt&&(I===$||I===G))return;if(dt||ve>=1||Ae<=0){const Xt=f-I,Yt=S+(c-S)*Math.min(($-I)/Xt,(G-I)/Xt);Me=Math.floor(Math.min(Yt,F)/this._granularityCellSize)+1,Oe=Math.ceil(Math.max(Yt,F)/this._granularityCellSize)-1,tt=F<Yt}const Ct=W>0?G:$;if(tt)for(let Xt=Me;Xt<=Oe;Xt++)i.push(this._vertexToIndex(Xt*this._granularityCellSize,Ct));else for(let Xt=Oe;Xt>=Me;Xt--)i.push(this._vertexToIndex(Xt*this._granularityCellSize,Ct))}_generateOutline(i){const c=[];for(const f of i){const v=fa(f,this._granularity,!0),w=this._pointArrayToIndices(v),S=[];for(let I=1;I<w.length;I++)S.push(w[I-1]),S.push(w[I]);c.push(S)}return c}_handlePoles(i){let c=!1,f=!1;this._canonical&&(this._canonical.y===0&&(c=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(c||f)&&this._fillPoles(i,c,f)}_ensureNoPoleVertices(){const i=this._vertexBuffer;for(let c=0;c<i.length;c+=2){const f=i[c+1];f===Oh&&(i[c+1]=-32767),f===Fh&&(i[c+1]=32766)}}_generatePoleQuad(i,c,f,v,w,S){v>w!=(S===Oh)?(i.push(c),i.push(f),i.push(this._vertexToIndex(v,S)),i.push(f),i.push(this._vertexToIndex(w,S)),i.push(this._vertexToIndex(v,S))):(i.push(f),i.push(c),i.push(this._vertexToIndex(v,S)),i.push(this._vertexToIndex(w,S)),i.push(f),i.push(this._vertexToIndex(v,S)))}_fillPoles(i,c,f){const v=this._vertexBuffer,w=Ue,S=i.length;for(let I=2;I<S;I+=3){const F=i[I-2],$=i[I-1],G=i[I],W=v[2*F],te=v[2*F+1],ie=v[2*$],pe=v[2*$+1],me=v[2*G],ve=v[2*G+1];c&&(te===0&&pe===0&&this._generatePoleQuad(i,F,$,W,ie,Oh),pe===0&&ve===0&&this._generatePoleQuad(i,$,G,ie,me,Oh),ve===0&&te===0&&this._generatePoleQuad(i,G,F,me,W,Oh)),f&&(te===w&&pe===w&&this._generatePoleQuad(i,F,$,W,ie,Fh),pe===w&&ve===w&&this._generatePoleQuad(i,$,G,ie,me,Fh),ve===w&&te===w&&this._generatePoleQuad(i,G,F,me,W,Fh))}}_initializeVertices(i){for(let c=0;c<i.length;c+=2)this._vertexToIndex(i[c],i[c+1])}subdividePolygonInternal(i,c){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:v}=function(I){const F=[],$=[];for(const G of I)if(G.length!==0){G!==I[0]&&F.push($.length/2);for(let W=0;W<G.length;W++)$.push(G[W].x),$.push(G[W].y)}return{flattened:$,holeIndices:F}}(i);let w;this._initializeVertices(f);try{const I=function($,G,W=2){const te=G&&G.length,ie=te?G[0]*W:$.length;let pe=f1($,0,ie,W,!0);const me=[];if(!pe||pe.next===pe.prev)return me;let ve,Ae,We;if(te&&(pe=function(Me,Oe,tt,dt){const Ct=[];for(let Xt=0,Yt=Oe.length;Xt<Yt;Xt++){const rn=f1(Me,Oe[Xt]*dt,Xt<Yt-1?Oe[Xt+1]*dt:Me.length,dt,!1);rn===rn.next&&(rn.steiner=!0),Ct.push(qm(rn))}Ct.sort(ds);for(let Xt=0;Xt<Ct.length;Xt++)tt=Ba(Ct[Xt],tt);return tt}($,G,pe,W)),$.length>80*W){ve=$[0],Ae=$[1];let Me=ve,Oe=Ae;for(let tt=W;tt<ie;tt+=W){const dt=$[tt],Ct=$[tt+1];dt<ve&&(ve=dt),Ct<Ae&&(Ae=Ct),dt>Me&&(Me=dt),Ct>Oe&&(Oe=Ct)}We=Math.max(Me-ve,Oe-Ae),We=We!==0?32767/We:0}return Hd(pe,me,W,ve,Ae,We,0),me}(f,v),F=this._convertIndices(f,I);w=this._subdivideTrianglesScanline(F)}catch(I){console.error(I)}let S=[];return c&&(S=this._generateOutline(i)),this._ensureNoPoleVertices(),this._handlePoles(w),{verticesFlattened:this._vertexBuffer,indicesTriangles:w,indicesLineList:S}}_convertIndices(i,c){const f=[];for(let v=0;v<c.length;v++)f.push(this._vertexToIndex(i[2*c[v]],i[2*c[v]+1]));return f}_pointArrayToIndices(i){const c=[];for(let f=0;f<i.length;f++){const v=i[f];c.push(this._vertexToIndex(v.x,v.y))}return c}}function Ps(h,i,c,f=!0){return new lv(c,i).subdividePolygonInternal(h,f)}function fa(h,i,c=!1){if(!h||h.length<1)return[];if(h.length<2)return[];const f=h[0],v=h[h.length-1],w=c&&(f.x!==v.x||f.y!==v.y);if(i<2)return w?[...h,h[0]]:[...h];const S=Math.floor(Ue/i),I=[];I.push(new m(h[0].x,h[0].y));const F=h.length,$=w?F:F-1;for(let G=0;G<$;G++){const W=h[G],te=G<F-1?h[G+1]:h[0],ie=W.x,pe=W.y,me=te.x,ve=te.y,Ae=ie!==me,We=pe!==ve;if(!Ae&&!We)continue;const Me=me-ie,Oe=ve-pe,tt=Math.abs(Me),dt=Math.abs(Oe);let Ct=ie,Xt=pe;for(;;){const rn=Me>0?(Math.floor(Ct/S)+1)*S:(Math.ceil(Ct/S)-1)*S,Mn=Oe>0?(Math.floor(Xt/S)+1)*S:(Math.ceil(Xt/S)-1)*S,ln=Math.abs(Ct-rn),Kt=Math.abs(Xt-Mn),Bt=Math.abs(Ct-me),Hn=Math.abs(Xt-ve),Xn=Ae?ln/tt:Number.POSITIVE_INFINITY,ur=We?Kt/dt:Number.POSITIVE_INFINITY;if((Bt<=ln||!Ae)&&(Hn<=Kt||!We))break;if(Xn<ur&&Ae||!We){Ct=rn,Xt+=Oe*Xn;const Jn=new m(Ct,Math.round(Xt));I[I.length-1].x===Jn.x&&I[I.length-1].y===Jn.y||I.push(Jn)}else{Ct+=Me*ur,Xt=Mn;const Jn=new m(Math.round(Ct),Xt);I[I.length-1].x===Jn.x&&I[I.length-1].y===Jn.y||I.push(Jn)}}const Yt=new m(me,ve);I[I.length-1].x===Yt.x&&I[I.length-1].y===Yt.y||I.push(Yt)}return I}function Zl(h,i,c){if(i.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,v=h[2*i[0]];for(let F=1;F<i.length;F++){const $=h[2*i[F]];$<v&&(v=$,f=F)}const w=i.length;let S=f,I=(S+1)%w;for(;;){const F=S-1>=0?S-1:w-1,$=(I+1)%w,G=h[2*i[F]],W=h[2*i[$]],te=h[2*i[S]],ie=h[2*i[S]+1],pe=h[2*i[I]+1];let me=!1;if(G<W)me=!0;else if(G>W)me=!1;else{const ve=pe-ie,Ae=-(h[2*i[I]]-te),We=ie<pe?1:-1;((G-te)*ve+(h[2*i[F]+1]-ie)*Ae)*We>((W-te)*ve+(h[2*i[$]+1]-ie)*Ae)*We&&(me=!0)}if(me){const ve=i[F],Ae=i[S],We=i[I];ve!==Ae&&ve!==We&&Ae!==We&&c.push(We,Ae,ve),S--,S<0&&(S=w-1)}else{const ve=i[$],Ae=i[S],We=i[I];ve!==Ae&&ve!==We&&Ae!==We&&c.push(We,Ae,ve),I++,I>=w&&(I=0)}if(F===$)break}}function js(h,i,c,f,v,w,S,I,F){const $=v.length/2,G=S&&I&&F;if($<Dn.MAX_VERTEX_ARRAY_LENGTH){const W=i.prepareSegment($,c,f),te=W.vertexLength;for(let me=0;me<w.length;me+=3)f.emplaceBack(te+w[me],te+w[me+1],te+w[me+2]);let ie,pe;W.vertexLength+=$,W.primitiveLength+=w.length/3,G&&(pe=S.prepareSegment($,c,I),ie=pe.vertexLength,pe.vertexLength+=$);for(let me=0;me<v.length;me+=2)h(v[me],v[me+1]);if(G)for(let me=0;me<F.length;me++){const ve=F[me];for(let Ae=1;Ae<ve.length;Ae+=2)I.emplaceBack(ie+ve[Ae-1],ie+ve[Ae]);pe.primitiveLength+=ve.length/2}}else(function(W,te,ie,pe,me,ve){const Ae=[];for(let dt=0;dt<pe.length/2;dt++)Ae.push(-1);const We={count:0};let Me=0,Oe=W.getOrCreateLatestSegment(te,ie),tt=Oe.vertexLength;for(let dt=2;dt<me.length;dt+=3){const Ct=me[dt-2],Xt=me[dt-1],Yt=me[dt];let rn=Ae[Ct]<Me,Mn=Ae[Xt]<Me,ln=Ae[Yt]<Me;Oe.vertexLength+((rn?1:0)+(Mn?1:0)+(ln?1:0))>Dn.MAX_VERTEX_ARRAY_LENGTH&&(Oe=W.createNewSegment(te,ie),Me=We.count,rn=!0,Mn=!0,ln=!0,tt=0);const Kt=mp(Ae,pe,ve,We,Ct,rn,Oe),Bt=mp(Ae,pe,ve,We,Xt,Mn,Oe),Hn=mp(Ae,pe,ve,We,Yt,ln,Oe);ie.emplaceBack(tt+Kt-Me,tt+Bt-Me,tt+Hn-Me),Oe.primitiveLength++}})(i,c,f,v,w,h),G&&function(W,te,ie,pe,me,ve){const Ae=[];for(let dt=0;dt<pe.length/2;dt++)Ae.push(-1);const We={count:0};let Me=0,Oe=W.getOrCreateLatestSegment(te,ie),tt=Oe.vertexLength;for(let dt=0;dt<me.length;dt++){const Ct=me[dt];for(let Xt=1;Xt<me[dt].length;Xt+=2){const Yt=Ct[Xt-1],rn=Ct[Xt];let Mn=Ae[Yt]<Me,ln=Ae[rn]<Me;Oe.vertexLength+((Mn?1:0)+(ln?1:0))>Dn.MAX_VERTEX_ARRAY_LENGTH&&(Oe=W.createNewSegment(te,ie),Me=We.count,Mn=!0,ln=!0,tt=0);const Kt=mp(Ae,pe,ve,We,Yt,Mn,Oe),Bt=mp(Ae,pe,ve,We,rn,ln,Oe);ie.emplaceBack(tt+Kt-Me,tt+Bt-Me),Oe.primitiveLength++}}}(S,c,I,v,F,h),i.forceNewSegmentOnNextPrepare(),S?.forceNewSegmentOnNextPrepare()}function mp(h,i,c,f,v,w,S){if(w){const I=f.count;return c(i[2*v],i[2*v+1]),h[v]=f.count,f.count++,S.vertexLength++,I}return h[v]}class Xm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Ne,this.indexArray=new Dt,this.indexArray2=new gn,this.programConfigurations=new $c(i.layers,i.zoom),this.segments=new Dn,this.segments2=new Dn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,f){this.hasDependencies=Wm("fill",this.layers,c);const v=this.layers[0].layout.get("fill-sort-key"),w=!v.isConstant(),S=[];for(const{feature:I,id:F,index:$,sourceLayerIndex:G}of i){const W=this.layers[0]._featureFilter.needGeometry,te=Wl(I,W);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),te,f))continue;const ie=w?v.evaluate(te,{},f,c.availableImages):void 0,pe={id:F,properties:I.properties,type:I.type,sourceLayerIndex:G,index:$,geometry:W?te.geometry:cl(I),patterns:{},sortKey:ie};S.push(pe)}w&&S.sort((I,F)=>I.sortKey-F.sortKey);for(const I of S){const{geometry:F,index:$,sourceLayerIndex:G}=I;if(this.hasDependencies){const W=ov("fill",this.layers,I,{zoom:this.zoom},c);this.patternFeatures.push(W)}else this.addFeature(I,F,$,f,{},c.subdivisionGranularity);c.featureIndex.insert(i[$].feature,F,$,G,this.index)}}update(i,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,{imagePositions:f})}addFeatures(i,c,f){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,c,f,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,d1),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,c,f,v,w,S){for(const I of _d(c,500)){const F=Ps(I,v,S.fill.getGranularityForZoomLevel(v.z)),$=this.layoutVertexArray;js((G,W)=>{$.emplaceBack(G,W)},this.segments,this.layoutVertexArray,this.indexArray,F.verticesFlattened,F.indicesTriangles,this.segments2,this.indexArray2,F.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:w,canonical:v})}}let cv,p1;Nn("FillBucket",Xm,{omit:["layers","patternFeatures"]});var Nh={get paint(){return p1=p1||new Wi({"fill-antialias":new Vn(De.paint_fill["fill-antialias"]),"fill-opacity":new rr(De.paint_fill["fill-opacity"]),"fill-color":new rr(De.paint_fill["fill-color"]),"fill-outline-color":new rr(De.paint_fill["fill-outline-color"]),"fill-translate":new Vn(De.paint_fill["fill-translate"]),"fill-translate-anchor":new Vn(De.paint_fill["fill-translate-anchor"]),"fill-pattern":new Du(De.paint_fill["fill-pattern"])})},get layout(){return cv=cv||new Wi({"fill-sort-key":new rr(De.layout_fill["fill-sort-key"])})}};class m1 extends Ss{constructor(i,c){super(i,Nh,c)}recalculate(i,c){super.recalculate(i,c);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Xm(i)}queryRadius(){return $m(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:i,geometry:c,transform:f,pixelsToTileUnits:v}){return l0(up(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,v),c)}isTileClipped(){return!0}}const v0=Vi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Gd=Vi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:y0}=v0;class Yl{constructor(i,c,f,v,w){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=i,this._geometry=-1,this._keys=v,this._values=w,i.readFields(g1,this,c)}loadGeometry(){const i=this._pbf;i.pos=this._geometry;const c=i.readVarint()+i.pos,f=[];let v,w=1,S=0,I=0,F=0;for(;i.pos<c;){if(S<=0){const $=i.readVarint();w=7&$,S=$>>3}if(S--,w===1||w===2)I+=i.readSVarint(),F+=i.readSVarint(),w===1&&(v&&f.push(v),v=[]),v&&v.push(new m(I,F));else{if(w!==7)throw new Error(`unknown command ${w}`);v&&v.push(v[0].clone())}}return v&&f.push(v),f}bbox(){const i=this._pbf;i.pos=this._geometry;const c=i.readVarint()+i.pos;let f=1,v=0,w=0,S=0,I=1/0,F=-1/0,$=1/0,G=-1/0;for(;i.pos<c;){if(v<=0){const W=i.readVarint();f=7&W,v=W>>3}if(v--,f===1||f===2)w+=i.readSVarint(),S+=i.readSVarint(),w<I&&(I=w),w>F&&(F=w),S<$&&($=S),S>G&&(G=S);else if(f!==7)throw new Error(`unknown command ${f}`)}return[I,$,F,G]}toGeoJSON(i,c,f){const v=this.extent*Math.pow(2,f),w=this.extent*i,S=this.extent*c,I=this.loadGeometry();function F(te){return[360*(te.x+w)/v-180,360/Math.PI*Math.atan(Math.exp((1-2*(te.y+S)/v)*Math.PI))-90]}function $(te){return te.map(F)}let G;if(this.type===1){const te=[];for(const pe of I)te.push(pe[0]);const ie=$(te);G=te.length===1?{type:"Point",coordinates:ie[0]}:{type:"MultiPoint",coordinates:ie}}else if(this.type===2){const te=I.map($);G=te.length===1?{type:"LineString",coordinates:te[0]}:{type:"MultiLineString",coordinates:te}}else{if(this.type!==3)throw new Error("unknown feature type");{const te=_0(I),ie=[];for(const pe of te)ie.push(pe.map($));G=ie.length===1?{type:"Polygon",coordinates:ie[0]}:{type:"MultiPolygon",coordinates:ie}}}const W={type:"Feature",geometry:G,properties:this.properties};return this.id!=null&&(W.id=this.id),W}}function g1(h,i,c){h===1?i.id=c.readVarint():h===2?function(f,v){const w=f.readVarint()+f.pos;for(;f.pos<w;){const S=v._keys[f.readVarint()],I=v._values[f.readVarint()];v.properties[S]=I}}(c,i):h===3?i.type=c.readVarint():h===4&&(i._geometry=c.pos)}function _0(h){const i=h.length;if(i<=1)return[h];const c=[];let f,v;for(let w=0;w<i;w++){const S=x0(h[w]);S!==0&&(v===void 0&&(v=S<0),v===S<0?(f&&c.push(f),f=[h[w]]):f&&f.push(h[w]))}return f&&c.push(f),c}function x0(h){let i=0;for(let c,f,v=0,w=h.length,S=w-1;v<w;S=v++)c=h[v],f=h[S],i+=(f.x-c.x)*(c.y+f.y);return i}Yl.types=["Unknown","Point","LineString","Polygon"];class uv{constructor(i,c){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(b2,this,c),this.length=this._features.length}feature(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];const c=this._pbf.readVarint()+this._pbf.pos;return new Yl(this._pbf,c,this.extent,this._keys,this._values)}}function b2(h,i,c){h===15?i.version=c.readVarint():h===1?i.name=c.readString():h===5?i.extent=c.readVarint():h===2?i._features.push(c.pos):h===3?i._keys.push(c.readString()):h===4&&i._values.push(function(f){let v=null;const w=f.readVarint()+f.pos;for(;f.pos<w;){const S=f.readVarint()>>3;v=S===1?f.readString():S===2?f.readFloat():S===3?f.readDouble():S===4?f.readVarint64():S===5?f.readVarint():S===6?f.readSVarint():S===7?f.readBoolean():null}if(v==null)throw new Error("unknown feature value");return v}(c))}class v1{constructor(i,c){this.layers=i.readFields(y1,{},c)}}function y1(h,i,c){if(h===3){const f=new uv(c,c.readVarint()+c.pos);f.length&&(i[f.name]=f)}}const hv=Math.pow(2,13);function Kl(h,i,c,f,v,w,S,I){h.emplaceBack(i,c,2*Math.floor(f*hv)+S,v*hv*2,w*hv*2,Math.round(I))}class b0{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasDependencies=!1,this.layoutVertexArray=new qe,this.centroidVertexArray=new ze,this.indexArray=new Dt,this.programConfigurations=new $c(i.layers,i.zoom),this.segments=new Dn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,f){this.features=[],this.hasDependencies=Wm("fill-extrusion",this.layers,c);for(const{feature:v,id:w,index:S,sourceLayerIndex:I}of i){const F=this.layers[0]._featureFilter.needGeometry,$=Wl(v,F);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),$,f))continue;const G={id:w,sourceLayerIndex:I,index:S,geometry:F?$.geometry:cl(v),properties:v.properties,type:v.type,patterns:{}};this.hasDependencies?this.features.push(ov("fill-extrusion",this.layers,G,{zoom:this.zoom},c)):this.addFeature(G,G.geometry,S,f,{},c.subdivisionGranularity),c.featureIndex.insert(v,G.geometry,S,I,this.index,!0)}}addFeatures(i,c,f){for(const v of this.features){const{geometry:w}=v;this.addFeature(v,w,v.index,c,f,i.subdivisionGranularity)}}update(i,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,y0),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,Gd.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,c,f,v,w,S){for(const I of _d(c,500)){const F={x:0,y:0,sampleCount:0},$=this.layoutVertexArray.length;this.processPolygon(F,v,i,I,S);const G=this.layoutVertexArray.length-$,W=Math.floor(F.x/F.sampleCount),te=Math.floor(F.y/F.sampleCount);for(let ie=0;ie<G;ie++)this.centroidVertexArray.emplaceBack(W,te)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:w,canonical:v})}processPolygon(i,c,f,v,w){if(v.length<1||Zi(v[0]))return;for(const W of v)W.length!==0&&gp(i,W);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},I=w.fill.getGranularityForZoomLevel(c.z),F=Yl.types[f.type]==="Polygon";for(const W of v){if(W.length===0||Zi(W))continue;const te=fa(W,I,F);this._generateSideFaces(te,S)}if(!F)return;const $=Ps(v,c,I,!1),G=this.layoutVertexArray;js((W,te)=>{Kl(G,W,te,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,$.verticesFlattened,$.indicesTriangles)}_generateSideFaces(i,c){let f=0;for(let v=1;v<i.length;v++){const w=i[v],S=i[v-1];if(_1(w,S))continue;c.segment.vertexLength+4>Dn.MAX_VERTEX_ARRAY_LENGTH&&(c.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const I=w.sub(S)._perp()._unit(),F=S.dist(w);f+F>32768&&(f=0),Kl(this.layoutVertexArray,w.x,w.y,I.x,I.y,0,0,f),Kl(this.layoutVertexArray,w.x,w.y,I.x,I.y,0,1,f),f+=F,Kl(this.layoutVertexArray,S.x,S.y,I.x,I.y,0,0,f),Kl(this.layoutVertexArray,S.x,S.y,I.x,I.y,0,1,f);const $=c.segment.vertexLength;this.indexArray.emplaceBack($,$+2,$+1),this.indexArray.emplaceBack($+1,$+2,$+3),c.segment.vertexLength+=4,c.segment.primitiveLength+=2}}}function gp(h,i){for(let c=0;c<i.length;c++){const f=i[c];c===i.length-1&&i[0].x===f.x&&i[0].y===f.y||(h.x+=f.x,h.y+=f.y,h.sampleCount++)}}function _1(h,i){return h.x===i.x&&(h.x<0||h.x>Ue)||h.y===i.y&&(h.y<0||h.y>Ue)}function Zi(h){return h.every(i=>i.x<0)||h.every(i=>i.x>Ue)||h.every(i=>i.y<0)||h.every(i=>i.y>Ue)}let x1;Nn("FillExtrusionBucket",b0,{omit:["layers","features"]});var b1={get paint(){return x1=x1||new Wi({"fill-extrusion-opacity":new Vn(De["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rr(De["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Vn(De["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Vn(De["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Du(De["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rr(De["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rr(De["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Vn(De["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class w2 extends Ss{constructor(i,c){super(i,b1,c)}createBucket(i){return new b0(i)}queryRadius(){return $m(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:i,feature:c,featureState:f,geometry:v,transform:w,pixelsToTileUnits:S,pixelPosMatrix:I}){const F=up(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-w.bearingInRadians,S),$=this.paint.get("fill-extrusion-height").evaluate(c,f),G=this.paint.get("fill-extrusion-base").evaluate(c,f),W=function(ie,pe){const me=[];for(const ve of ie){const Ae=[ve.x,ve.y,0,1];Ze(Ae,Ae,pe),me.push(new m(Ae[0]/Ae[3],Ae[1]/Ae[3]))}return me}(F,I),te=function(ie,pe,me,ve){const Ae=[],We=[],Me=ve[8]*pe,Oe=ve[9]*pe,tt=ve[10]*pe,dt=ve[11]*pe,Ct=ve[8]*me,Xt=ve[9]*me,Yt=ve[10]*me,rn=ve[11]*me;for(const Mn of ie){const ln=[],Kt=[];for(const Bt of Mn){const Hn=Bt.x,Xn=Bt.y,ur=ve[0]*Hn+ve[4]*Xn+ve[12],Jn=ve[1]*Hn+ve[5]*Xn+ve[13],Mr=ve[2]*Hn+ve[6]*Xn+ve[14],ji=ve[3]*Hn+ve[7]*Xn+ve[15],Ao=Mr+tt,Rs=ji+dt,Hc=ur+Ct,ga=Jn+Xt,fs=Mr+Yt,Ds=ji+rn,ao=new m((ur+Me)/Rs,(Jn+Oe)/Rs);ao.z=Ao/Rs,ln.push(ao);const ps=new m(Hc/Ds,ga/Ds);ps.z=fs/Ds,Kt.push(ps)}Ae.push(ln),We.push(Kt)}return[Ae,We]}(v,G,$,I);return function(ie,pe,me){let ve=1/0;l0(me,pe)&&(ve=w0(me,pe[0]));for(let Ae=0;Ae<pe.length;Ae++){const We=pe[Ae],Me=ie[Ae];for(let Oe=0;Oe<We.length-1;Oe++){const tt=We[Oe],dt=[tt,We[Oe+1],Me[Oe+1],Me[Oe],tt];Ah(me,dt)&&(ve=Math.min(ve,w0(me,dt)))}}return ve!==1/0&&ve}(te[0],te[1],W)}}function Zm(h,i){return h.x*i.x+h.y*i.y}function w0(h,i){if(h.length===1){let c=0;const f=i[c++];let v;for(;!v||f.equals(v);)if(v=i[c++],!v)return 1/0;for(;c<i.length;c++){const w=i[c],S=h[0],I=v.sub(f),F=w.sub(f),$=S.sub(f),G=Zm(I,I),W=Zm(I,F),te=Zm(F,F),ie=Zm($,I),pe=Zm($,F),me=G*te-W*W,ve=(te*ie-W*pe)/me,Ae=(G*pe-W*ie)/me,We=f.z*(1-ve-Ae)+v.z*ve+w.z*Ae;if(isFinite(We))return We}return 1/0}{let c=1/0;for(const f of i)c=Math.min(c,f.z);return c}}const w1=Vi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:S2}=w1,dl=Vi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:S0}=dl,M2=Math.cos(Math.PI/180*37.5),ju=Math.pow(2,14)/.5;class vp{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new it,this.layoutVertexArray2=new Xe,this.indexArray=new Dt,this.programConfigurations=new $c(i.layers,i.zoom),this.segments=new Dn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,f){this.hasDependencies=Wm("line",this.layers,c)||this.hasLineDasharray(this.layers);const v=this.layers[0].layout.get("line-sort-key"),w=!v.isConstant(),S=[];for(const{feature:I,id:F,index:$,sourceLayerIndex:G}of i){const W=this.layers[0]._featureFilter.needGeometry,te=Wl(I,W);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),te,f))continue;const ie=w?v.evaluate(te,{},f):void 0,pe={id:F,properties:I.properties,type:I.type,sourceLayerIndex:G,index:$,geometry:W?te.geometry:cl(I),patterns:{},dashes:{},sortKey:ie};S.push(pe)}w&&S.sort((I,F)=>I.sortKey-F.sortKey);for(const I of S){const{geometry:F,index:$,sourceLayerIndex:G}=I;this.hasDependencies?(Wm("line",this.layers,c)?ov("line",this.layers,I,{zoom:this.zoom},c):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,I,this.zoom,c),this.patternFeatures.push(I)):this.addFeature(I,F,$,f,{},{},c.subdivisionGranularity),c.featureIndex.insert(i[$].feature,F,$,G,this.index)}}update(i,c,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,{imagePositions:f,dashPositions:v})}addFeatures(i,c,f,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,c,f,v,i.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,S0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,S2),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,c,f,v,w,S,I){const F=this.layers[0].layout,$=F.get("line-join").evaluate(i,{}),G=F.get("line-cap"),W=F.get("line-miter-limit"),te=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const ie of c)this.addLine(ie,i,$,G,W,te,v,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,{imagePositions:w,dashPositions:S,canonical:v})}addLine(i,c,f,v,w,S,I,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,i=fa(i,I?F.line.getGranularityForZoomLevel(I.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Me=0;Me<i.length-1;Me++)this.totalDistance+=i[Me].dist(i[Me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const $=Yl.types[c.type]==="Polygon";let G=i.length;for(;G>=2&&i[G-1].equals(i[G-2]);)G--;let W=0;for(;W<G-1&&i[W].equals(i[W+1]);)W++;if(G<($?3:2))return;f==="bevel"&&(w=1.05);const te=this.overscaling<=16?122880/(512*this.overscaling):0,ie=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray);let pe,me,ve,Ae,We;this.e1=this.e2=-1,$&&(pe=i[G-2],We=i[W].sub(pe)._unit()._perp());for(let Me=W;Me<G;Me++){if(ve=Me===G-1?$?i[W+1]:void 0:i[Me+1],ve&&i[Me].equals(ve))continue;We&&(Ae=We),pe&&(me=pe),pe=i[Me],We=ve?ve.sub(pe)._unit()._perp():Ae,Ae=Ae||We;let Oe=Ae.add(We);Oe.x===0&&Oe.y===0||Oe._unit();const tt=Ae.x*We.x+Ae.y*We.y,dt=Oe.x*We.x+Oe.y*We.y,Ct=dt!==0?1/dt:1/0,Xt=2*Math.sqrt(2-2*dt),Yt=dt<M2&&me&&ve,rn=Ae.x*We.y-Ae.y*We.x>0;if(Yt&&Me>W){const Kt=pe.dist(me);if(Kt>2*te){const Bt=pe.sub(pe.sub(me)._mult(te/Kt)._round());this.updateDistance(me,Bt),this.addCurrentVertex(Bt,Ae,0,0,ie),me=Bt}}const Mn=me&&ve;let ln=Mn?f:$?"butt":v;if(Mn&&ln==="round"&&(Ct<S?ln="miter":Ct<=2&&(ln="fakeround")),ln==="miter"&&Ct>w&&(ln="bevel"),ln==="bevel"&&(Ct>2&&(ln="flipbevel"),Ct<w&&(ln="miter")),me&&this.updateDistance(me,pe),ln==="miter")Oe._mult(Ct),this.addCurrentVertex(pe,Oe,0,0,ie);else if(ln==="flipbevel"){if(Ct>100)Oe=We.mult(-1);else{const Kt=Ct*Ae.add(We).mag()/Ae.sub(We).mag();Oe._perp()._mult(Kt*(rn?-1:1))}this.addCurrentVertex(pe,Oe,0,0,ie),this.addCurrentVertex(pe,Oe.mult(-1),0,0,ie)}else if(ln==="bevel"||ln==="fakeround"){const Kt=-Math.sqrt(Ct*Ct-1),Bt=rn?Kt:0,Hn=rn?0:Kt;if(me&&this.addCurrentVertex(pe,Ae,Bt,Hn,ie),ln==="fakeround"){const Xn=Math.round(180*Xt/Math.PI/20);for(let ur=1;ur<Xn;ur++){let Jn=ur/Xn;if(Jn!==.5){const ji=Jn-.5;Jn+=Jn*ji*(Jn-1)*((1.0904+tt*(tt*(3.55645-1.43519*tt)-3.2452))*ji*ji+(.848013+tt*(.215638*tt-1.06021)))}const Mr=We.sub(Ae)._mult(Jn)._add(Ae)._unit()._mult(rn?-1:1);this.addHalfVertex(pe,Mr.x,Mr.y,!1,rn,0,ie)}}ve&&this.addCurrentVertex(pe,We,-Bt,-Hn,ie)}else if(ln==="butt")this.addCurrentVertex(pe,Oe,0,0,ie);else if(ln==="square"){const Kt=me?1:-1;this.addCurrentVertex(pe,Oe,Kt,Kt,ie)}else ln==="round"&&(me&&(this.addCurrentVertex(pe,Ae,0,0,ie),this.addCurrentVertex(pe,Ae,1,1,ie,!0)),ve&&(this.addCurrentVertex(pe,We,-1,-1,ie,!0),this.addCurrentVertex(pe,We,0,0,ie)));if(Yt&&Me<G-1){const Kt=pe.dist(ve);if(Kt>2*te){const Bt=pe.add(ve.sub(pe)._mult(te/Kt)._round());this.updateDistance(pe,Bt),this.addCurrentVertex(Bt,We,0,0,ie),pe=Bt}}}}addCurrentVertex(i,c,f,v,w,S=!1){const I=c.y*v-c.x,F=-c.y-c.x*v;this.addHalfVertex(i,c.x+c.y*f,c.y-c.x*f,S,!1,f,w),this.addHalfVertex(i,I,F,S,!0,-v,w),this.distance>ju/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,c,f,v,w,S))}addHalfVertex({x:i,y:c},f,v,w,S,I,F){const $=.5*(this.lineClips?this.scaledDistance*(ju-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(w?1:0),(c<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*v)+128,1+(I===0?0:I<0?-1:1)|(63&$)<<2,$>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const G=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,G,this.e2),F.primitiveLength++),S?this.e2=G:this.e1=G}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,c){this.distance+=i.dist(c),this.updateScaledDistance()}hasLineDasharray(i){for(const c of i){const f=c.paint.get("line-dasharray");if(f&&!f.isConstant())return!0}return!1}addLineDashDependencies(i,c,f,v){for(const w of i){const S=w.paint.get("line-dasharray");if(!S||S.value.kind==="constant")continue;const I=w.layout.get("line-cap")==="round",F={dasharray:S.value.evaluate({zoom:f-1},c,{}),round:I},$={dasharray:S.value.evaluate({zoom:f},c,{}),round:I},G={dasharray:S.value.evaluate({zoom:f+1},c,{}),round:I},W=`${F.dasharray.join(",")},${F.round}`,te=`${$.dasharray.join(",")},${$.round}`,ie=`${G.dasharray.join(",")},${G.round}`;v.dashDependencies[W]=F,v.dashDependencies[te]=$,v.dashDependencies[ie]=G,c.dashes[w.id]={min:W,mid:te,max:ie}}}}let Bh,Ym;Nn("LineBucket",vp,{omit:["layers","patternFeatures"]});var dv={get paint(){return Ym=Ym||new Wi({"line-opacity":new rr(De.paint_line["line-opacity"]),"line-color":new rr(De.paint_line["line-color"]),"line-translate":new Vn(De.paint_line["line-translate"]),"line-translate-anchor":new Vn(De.paint_line["line-translate-anchor"]),"line-width":new rr(De.paint_line["line-width"]),"line-gap-width":new rr(De.paint_line["line-gap-width"]),"line-offset":new rr(De.paint_line["line-offset"]),"line-blur":new rr(De.paint_line["line-blur"]),"line-dasharray":new Du(De.paint_line["line-dasharray"]),"line-pattern":new Du(De.paint_line["line-pattern"]),"line-gradient":new ua(De.paint_line["line-gradient"])})},get layout(){return Bh=Bh||new Wi({"line-cap":new Vn(De.layout_line["line-cap"]),"line-join":new rr(De.layout_line["line-join"]),"line-miter-limit":new Vn(De.layout_line["line-miter-limit"]),"line-round-limit":new Vn(De.layout_line["line-round-limit"]),"line-sort-key":new rr(De.layout_line["line-sort-key"])})}};class M0 extends rr{possiblyEvaluate(i,c){return c=new Jr(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(i,c)}evaluate(i,c,f,v){return c=et({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(i,c,f,v)}}let fv;class E0 extends Ss{constructor(i,c){super(i,dv,c),this.gradientVersion=0,fv||(fv=new M0(dv.paint.properties["line-width"].specification),fv.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const c=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(c)&&c._styleExpression.expression instanceof Ka,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,c){super.recalculate(i,c),this.paint._values["line-floorwidth"]=fv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new vp(i)}queryRadius(i){const c=i,f=S1(cp("line-width",this,c),cp("line-gap-width",this,c)),v=cp("line-offset",this,c);return f/2+Math.abs(v)+$m(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:i,feature:c,featureState:f,geometry:v,transform:w,pixelsToTileUnits:S}){const I=up(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-w.bearingInRadians,S),F=S/2*S1(this.paint.get("line-width").evaluate(c,f),this.paint.get("line-gap-width").evaluate(c,f)),$=this.paint.get("line-offset").evaluate(c,f);return $&&(v=function(G,W){const te=[];for(let ie=0;ie<G.length;ie++){const pe=s1(G[ie]),me=[];for(let ve=0;ve<pe.length;ve++){const Ae=pe[ve],We=pe[ve-1],Me=pe[ve+1],Oe=ve===0?new m(0,0):Ae.sub(We)._unit()._perp(),tt=ve===pe.length-1?new m(0,0):Me.sub(Ae)._unit()._perp(),dt=Oe._add(tt)._unit(),Ct=dt.x*tt.x+dt.y*tt.y;Ct!==0&&dt._mult(1/Ct),me.push(dt._mult(W)._add(Ae))}te.push(me)}return te}(v,$*S)),function(G,W,te){for(let ie=0;ie<W.length;ie++){const pe=W[ie];if(G.length>=3){for(let me=0;me<pe.length;me++)if(Nu(G,pe[me]))return!0}if(c0(G,pe,te))return!0}return!1}(I,v,F)}isTileClipped(){return!0}}function S1(h,i){return i>0?i+2*h:h}const M1=Vi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),E1=Vi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Vi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const pv=Vi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Vi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Km=Vi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),C1=Vi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function C0(h,i,c){return h.sections.forEach(f=>{f.text=function(v,w,S){const I=w.layout.get("text-transform").evaluate(S,{});return I==="uppercase"?v=v.toLocaleUpperCase():I==="lowercase"&&(v=v.toLocaleLowerCase()),Bl.applyArabicShaping&&(v=Bl.applyArabicShaping(v)),v}(f.text,i,c)}),h}Vi([{name:"triangle",components:3,type:"Uint16"}]),Vi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Vi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Vi([{type:"Float32",name:"offsetX"}]),Vi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Vi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Po=24;const yp={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},T0={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},mv={40:!0};function gv(h,i,c,f,v,w){if("fontStack"in i){const S=c[i.fontStack],I=S&&S[h];return I?I.metrics.advance*i.scale+v:0}{const S=f[i.imageName];return S?S.displaySize[0]*i.scale*Po/w+v:0}}function Jm(h,i,c,f){const v=Math.pow(h-i,2);return f?h<i?v/2:2*v:v+Math.abs(c)*c}function T1(h,i,c){let f=0;return h===10&&(f-=1e4),c&&(f+=150),h!==40&&h!==65288||(f+=50),i!==41&&i!==65289||(f+=50),f}function P1(h,i,c,f,v,w){let S=null,I=Jm(i,c,v,w);for(const F of f){const $=Jm(i-F.x,c,v,w)+F.badness;$<=I&&(S=F,I=$)}return{index:h,x:i,priorBreak:S,badness:I}}function Qm(h){return h?Qm(h.priorBreak).concat(h.index):[]}class _p{constructor(i="",c=[],f=[]){this.text=i,this.sections=c,this.sectionIndex=f,this.imageSectionID=null}static fromFeature(i,c){const f=new _p;for(let v=0;v<i.sections.length;v++){const w=i.sections[v];w.image?f.addImageSection(w):f.addTextSection(w,c)}return f}length(){return[...this.text].length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}verticalizePunctuation(){this.text=function(i){let c="",f={premature:!0,value:void 0};const v=i[Symbol.iterator]();let w=v.next();const S=i[Symbol.iterator]();S.next();let I=S.next();for(;!w.done;)c+=!I.done&&Oc(I.value.codePointAt(0))&&!yp[I.value]||!f.premature&&Oc(f.value.codePointAt(0))&&!yp[f.value]||!yp[w.value]?w.value:yp[w.value],f={value:w.value,premature:!1},w=v.next(),I=S.next();return c}(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const i=this.text.match(/^\s*/),c=i?i[0].length:0,f=this.text.match(/\S\s*$/),v=f?f[0].length-1:0;this.text=this.text.substring(c,this.text.length-v),this.sectionIndex=this.sectionIndex.slice(c,this.sectionIndex.length-v)}substring(i,c){const f=[...this.text].slice(i,c).join(""),v=this.sectionIndex.slice(i,c);return new _p(f,this.sections,v)}toCodeUnitIndex(i){return[...this.text].slice(0,i).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,c)=>Math.max(i,this.sections[c].scale),0)}getMaxImageSize(i){let c=0,f=0;for(let v=0;v<this.length();v++){const w=this.getSection(v);if("imageName"in w){const S=i[w.imageName];if(!S)continue;const I=S.displaySize;c=Math.max(c,I[0]),f=Math.max(f,I[1])}}return{maxImageWidth:c,maxImageHeight:f}}addTextSection(i,c){this.text+=i.text,this.sections.push({scale:i.scale||1,verticalAlign:i.verticalAlign||"bottom",fontStack:i.fontStack||c});const f=this.sections.length-1;this.sectionIndex.push(...[...i.text].map(()=>f))}addImageSection(i){const c=i.image?i.image.name:"";if(c.length===0)return void Ke("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push({scale:1,verticalAlign:i.verticalAlign||"bottom",imageName:c}),this.sectionIndex.push(this.sections.length-1)):Ke("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(i,c,f,v,w){const S=[],I=this.determineAverageLineWidth(i,c,f,v,w),F=this.hasZeroWidthSpaces();let $=0,G=0;const W=this.text[Symbol.iterator]();let te=W.next();const ie=this.text[Symbol.iterator]();ie.next();let pe=ie.next();const me=this.text[Symbol.iterator]();me.next(),me.next();let ve=me.next();for(;!te.done;){const Ae=this.getSection(G),We=te.value.codePointAt(0);if(Om(We)||($+=gv(We,Ae,f,v,i,w)),!pe.done){const Me=ls(We),Oe=pe.value.codePointAt(0);(T0[We]||Me||"imageName"in Ae||!ve.done&&mv[Oe])&&S.push(P1(G+1,$,I,S,T1(We,Oe,Me&&F),!1))}G++,te=W.next(),pe=ie.next(),ve=me.next()}return Qm(P1(this.length(),$,I,S,0,!0))}determineAverageLineWidth(i,c,f,v,w){let S=0,I=0;for(const F of this.text){const $=this.getSection(I);S+=gv(F.codePointAt(0),$,f,v,i,w),I++}return S/Math.max(1,Math.ceil(S/c))}}const Wd=4294967296,A1=1/Wd,eg=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class p{constructor(i=new Uint8Array(16)){this.buf=ArrayBuffer.isView(i)?i:new Uint8Array(i),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(i,c,f=this.length){for(;this.pos<f;){const v=this.readVarint(),w=v>>3,S=this.pos;this.type=7&v,i(w,c,this),this.pos===S&&this.skip(v)}return c}readMessage(i,c){return this.readFields(i,c,this.readVarint()+this.pos)}readFixed32(){const i=this.dataView.getUint32(this.pos,!0);return this.pos+=4,i}readSFixed32(){const i=this.dataView.getInt32(this.pos,!0);return this.pos+=4,i}readFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Wd;return this.pos+=8,i}readSFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Wd;return this.pos+=8,i}readFloat(){const i=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,i}readDouble(){const i=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,i}readVarint(i){const c=this.buf;let f,v;return v=c[this.pos++],f=127&v,v<128?f:(v=c[this.pos++],f|=(127&v)<<7,v<128?f:(v=c[this.pos++],f|=(127&v)<<14,v<128?f:(v=c[this.pos++],f|=(127&v)<<21,v<128?f:(v=c[this.pos],f|=(15&v)<<28,function(w,S,I){const F=I.buf;let $,G;if(G=F[I.pos++],$=(112&G)>>4,G<128||(G=F[I.pos++],$|=(127&G)<<3,G<128)||(G=F[I.pos++],$|=(127&G)<<10,G<128)||(G=F[I.pos++],$|=(127&G)<<17,G<128)||(G=F[I.pos++],$|=(127&G)<<24,G<128)||(G=F[I.pos++],$|=(1&G)<<31,G<128))return y(w,$,S);throw new Error("Expected varint not more than 10 bytes")}(f,i,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const i=this.readVarint();return i%2==1?(i+1)/-2:i/2}readBoolean(){return!!this.readVarint()}readString(){const i=this.readVarint()+this.pos,c=this.pos;return this.pos=i,i-c>=12&&eg?eg.decode(this.buf.subarray(c,i)):function(f,v,w){let S="",I=v;for(;I<w;){const F=f[I];let $,G,W,te=null,ie=F>239?4:F>223?3:F>191?2:1;if(I+ie>w)break;ie===1?F<128&&(te=F):ie===2?($=f[I+1],(192&$)==128&&(te=(31&F)<<6|63&$,te<=127&&(te=null))):ie===3?($=f[I+1],G=f[I+2],(192&$)==128&&(192&G)==128&&(te=(15&F)<<12|(63&$)<<6|63&G,(te<=2047||te>=55296&&te<=57343)&&(te=null))):ie===4&&($=f[I+1],G=f[I+2],W=f[I+3],(192&$)==128&&(192&G)==128&&(192&W)==128&&(te=(15&F)<<18|(63&$)<<12|(63&G)<<6|63&W,(te<=65535||te>=1114112)&&(te=null))),te===null?(te=65533,ie=1):te>65535&&(te-=65536,S+=String.fromCharCode(te>>>10&1023|55296),te=56320|1023&te),S+=String.fromCharCode(te),I+=ie}return S}(this.buf,c,i)}readBytes(){const i=this.readVarint()+this.pos,c=this.buf.subarray(this.pos,i);return this.pos=i,c}readPackedVarint(i=[],c){const f=this.readPackedEnd();for(;this.pos<f;)i.push(this.readVarint(c));return i}readPackedSVarint(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readSVarint());return i}readPackedBoolean(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readBoolean());return i}readPackedFloat(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readFloat());return i}readPackedDouble(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readDouble());return i}readPackedFixed32(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readFixed32());return i}readPackedSFixed32(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readSFixed32());return i}readPackedFixed64(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readFixed64());return i}readPackedSFixed64(i=[]){const c=this.readPackedEnd();for(;this.pos<c;)i.push(this.readSFixed64());return i}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(i){const c=7&i;if(c===0)for(;this.buf[this.pos++]>127;);else if(c===2)this.pos=this.readVarint()+this.pos;else if(c===5)this.pos+=4;else{if(c!==1)throw new Error(`Unimplemented type: ${c}`);this.pos+=8}}writeTag(i,c){this.writeVarint(i<<3|c)}realloc(i){let c=this.length||16;for(;c<this.pos+i;)c*=2;if(c!==this.length){const f=new Uint8Array(c);f.set(this.buf),this.buf=f,this.dataView=new DataView(f.buffer),this.length=c}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeSFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*A1),!0),this.pos+=8}writeSFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*A1),!0),this.pos+=8}writeVarint(i){(i=+i||0)>268435455||i<0?function(c,f){let v,w;if(c>=0?(v=c%4294967296|0,w=c/4294967296|0):(v=~(-c%4294967296),w=~(-c/4294967296),4294967295^v?v=v+1|0:(v=0,w=w+1|0)),c>=18446744073709552e3||c<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(S,I,F){F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,S>>>=7,F.buf[F.pos++]=127&S|128,F.buf[F.pos]=127&(S>>>=7)}(v,0,f),function(S,I){const F=(7&S)<<4;I.buf[I.pos++]|=F|((S>>>=3)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S|((S>>>=7)?128:0),S&&(I.buf[I.pos++]=127&S)))))}(w,f)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))}writeSVarint(i){this.writeVarint(i<0?2*-i-1:2*i)}writeBoolean(i){this.writeVarint(+i)}writeString(i){i=String(i),this.realloc(4*i.length),this.pos++;const c=this.pos;this.pos=function(v,w,S){for(let I,F,$=0;$<w.length;$++){if(I=w.charCodeAt($),I>55295&&I<57344){if(!F){I>56319||$+1===w.length?(v[S++]=239,v[S++]=191,v[S++]=189):F=I;continue}if(I<56320){v[S++]=239,v[S++]=191,v[S++]=189,F=I;continue}I=F-55296<<10|I-56320|65536,F=null}else F&&(v[S++]=239,v[S++]=191,v[S++]=189,F=null);I<128?v[S++]=I:(I<2048?v[S++]=I>>6|192:(I<65536?v[S++]=I>>12|224:(v[S++]=I>>18|240,v[S++]=I>>12&63|128),v[S++]=I>>6&63|128),v[S++]=63&I|128)}return S}(this.buf,i,this.pos);const f=this.pos-c;f>=128&&R(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f}writeFloat(i){this.realloc(4),this.dataView.setFloat32(this.pos,i,!0),this.pos+=4}writeDouble(i){this.realloc(8),this.dataView.setFloat64(this.pos,i,!0),this.pos+=8}writeBytes(i){const c=i.length;this.writeVarint(c),this.realloc(c);for(let f=0;f<c;f++)this.buf[this.pos++]=i[f]}writeRawMessage(i,c){this.pos++;const f=this.pos;i(c,this);const v=this.pos-f;v>=128&&R(f,v,this),this.pos=f-1,this.writeVarint(v),this.pos+=v}writeMessage(i,c,f){this.writeTag(i,2),this.writeRawMessage(c,f)}writePackedVarint(i,c){c.length&&this.writeMessage(i,B,c)}writePackedSVarint(i,c){c.length&&this.writeMessage(i,Y,c)}writePackedBoolean(i,c){c.length&&this.writeMessage(i,at,c)}writePackedFloat(i,c){c.length&&this.writeMessage(i,re,c)}writePackedDouble(i,c){c.length&&this.writeMessage(i,we,c)}writePackedFixed32(i,c){c.length&&this.writeMessage(i,vt,c)}writePackedSFixed32(i,c){c.length&&this.writeMessage(i,$t,c)}writePackedFixed64(i,c){c.length&&this.writeMessage(i,wn,c)}writePackedSFixed64(i,c){c.length&&this.writeMessage(i,Cn,c)}writeBytesField(i,c){this.writeTag(i,2),this.writeBytes(c)}writeFixed32Field(i,c){this.writeTag(i,5),this.writeFixed32(c)}writeSFixed32Field(i,c){this.writeTag(i,5),this.writeSFixed32(c)}writeFixed64Field(i,c){this.writeTag(i,1),this.writeFixed64(c)}writeSFixed64Field(i,c){this.writeTag(i,1),this.writeSFixed64(c)}writeVarintField(i,c){this.writeTag(i,0),this.writeVarint(c)}writeSVarintField(i,c){this.writeTag(i,0),this.writeSVarint(c)}writeStringField(i,c){this.writeTag(i,2),this.writeString(c)}writeFloatField(i,c){this.writeTag(i,5),this.writeFloat(c)}writeDoubleField(i,c){this.writeTag(i,1),this.writeDouble(c)}writeBooleanField(i,c){this.writeVarintField(i,+c)}}function y(h,i,c){return c?4294967296*i+(h>>>0):4294967296*(i>>>0)+(h>>>0)}function R(h,i,c){const f=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));c.realloc(f);for(let v=c.pos-1;v>=h;v--)c.buf[v+f]=c.buf[v]}function B(h,i){for(let c=0;c<h.length;c++)i.writeVarint(h[c])}function Y(h,i){for(let c=0;c<h.length;c++)i.writeSVarint(h[c])}function re(h,i){for(let c=0;c<h.length;c++)i.writeFloat(h[c])}function we(h,i){for(let c=0;c<h.length;c++)i.writeDouble(h[c])}function at(h,i){for(let c=0;c<h.length;c++)i.writeBoolean(h[c])}function vt(h,i){for(let c=0;c<h.length;c++)i.writeFixed32(h[c])}function $t(h,i){for(let c=0;c<h.length;c++)i.writeSFixed32(h[c])}function wn(h,i){for(let c=0;c<h.length;c++)i.writeFixed64(h[c])}function Cn(h,i){for(let c=0;c<h.length;c++)i.writeSFixed64(h[c])}function bn(h,i,c){h===1&&c.readMessage(tr,i)}function tr(h,i,c){if(h===3){const{id:f,bitmap:v,width:w,height:S,left:I,top:F,advance:$}=c.readMessage(sr,{});i.push({id:f,bitmap:new fp({width:w+6,height:S+6},v),metrics:{width:w,height:S,left:I,top:F,advance:$}})}}function sr(h,i,c){h===1?i.id=c.readVarint():h===2?i.bitmap=c.readBytes():h===3?i.width=c.readVarint():h===4?i.height=c.readVarint():h===5?i.left=c.readSVarint():h===6?i.top=c.readSVarint():h===7&&(i.advance=c.readVarint())}function cr(h){let i=0,c=0;for(const S of h)i+=S.w*S.h,c=Math.max(c,S.w);h.sort((S,I)=>I.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),c),h:1/0}];let v=0,w=0;for(const S of h)for(let I=f.length-1;I>=0;I--){const F=f[I];if(!(S.w>F.w||S.h>F.h)){if(S.x=F.x,S.y=F.y,w=Math.max(w,S.y+S.h),v=Math.max(v,S.x+S.w),S.w===F.w&&S.h===F.h){const $=f.pop();$&&I<f.length&&(f[I]=$)}else S.h===F.h?(F.x+=S.w,F.w-=S.w):S.w===F.w?(F.y+=S.h,F.h-=S.h):(f.push({x:F.x+S.w,y:F.y,w:F.w-S.w,h:S.h}),F.y+=S.h,F.h-=S.h);break}}return{w:v,h:w,fill:i/(v*w)||0}}class Yi{constructor(i,{pixelRatio:c,version:f,stretchX:v,stretchY:w,content:S,textFitWidth:I,textFitHeight:F}){this.paddedRect=i,this.pixelRatio=c,this.stretchX=v,this.stretchY=w,this.content=S,this.version=f,this.textFitWidth=I,this.textFitHeight=F}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class kt{constructor(i,c){const f={},v={};this.haveRenderCallbacks=[];const w=[];this.addImages(i,f,w),this.addImages(c,v,w);const{w:S,h:I}=cr(w),F=new Ts({width:S||1,height:I||1});for(const $ in i){const G=i[$],W=f[$].paddedRect;Ts.copy(G.data,F,{x:0,y:0},{x:W.x+1,y:W.y+1},G.data)}for(const $ in c){const G=c[$],W=v[$].paddedRect,te=W.x+1,ie=W.y+1,pe=G.data.width,me=G.data.height;Ts.copy(G.data,F,{x:0,y:0},{x:te,y:ie},G.data),Ts.copy(G.data,F,{x:0,y:me-1},{x:te,y:ie-1},{width:pe,height:1}),Ts.copy(G.data,F,{x:0,y:0},{x:te,y:ie+me},{width:pe,height:1}),Ts.copy(G.data,F,{x:pe-1,y:0},{x:te-1,y:ie},{width:1,height:me}),Ts.copy(G.data,F,{x:0,y:0},{x:te+pe,y:ie},{width:1,height:me})}this.image=F,this.iconPositions=f,this.patternPositions=v}addImages(i,c,f){for(const v in i){const w=i[v],S={x:0,y:0,w:w.data.width+2,h:w.data.height+2};f.push(S),c[v]=new Yi(S,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(i,c){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in i.updatedImages)this.patchUpdatedImage(this.iconPositions[f],i.getImage(f),c),this.patchUpdatedImage(this.patternPositions[f],i.getImage(f),c)}patchUpdatedImage(i,c,f){if(!i||!c||i.version===c.version)return;i.version=c.version;const[v,w]=i.tl;f.update(c.data,void 0,{x:v,y:w})}}var xt;function Ft(h,i,c,f,v,w,S,I,F,$,G,W,te,ie,pe){const me=_p.fromFeature(h,v);let ve;W===u.az.vertical&&me.verticalizePunctuation();let Ae=me.determineLineBreaks($,w,i,f,ie);const{processBidirectionalText:We,processStyledBidirectionalText:Me}=Bl;if(We&&me.sections.length===1){ve=[],Ae=Ae.map(Ct=>me.toCodeUnitIndex(Ct));const dt=We(me.toString(),Ae);for(const Ct of dt){const Xt=[...Ct].map(()=>0);ve.push(new _p(Ct,me.sections,Xt))}}else if(Me){ve=[],Ae=Ae.map(Yt=>me.toCodeUnitIndex(Yt));let dt=0;const Ct=[];for(const Yt of me.text)Ct.push(...Array(Yt.length).fill(me.sectionIndex[dt])),dt++;const Xt=Me(me.text,Ct,Ae);for(const Yt of Xt){const rn=[];let Mn="";for(const ln of Yt[0])rn.push(Yt[1][Mn.length]),Mn+=ln;ve.push(new _p(Yt[0],me.sections,rn))}}else ve=function(dt,Ct){const Xt=[];let Yt=0;for(const rn of Ct)Xt.push(dt.substring(Yt,rn)),Yt=rn;return Yt<dt.length()&&Xt.push(dt.substring(Yt,dt.length())),Xt}(me,Ae);const Oe=[],tt={positionedLines:Oe,text:me.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:W,iconsInText:!1,verticalizable:!1};return function(dt,Ct,Xt,Yt,rn,Mn,ln,Kt,Bt,Hn,Xn,ur){let Jn=0,Mr=0,ji=0,Ao=0;const Rs=Kt==="right"?1:Kt==="left"?0:.5,Hc=Po/ur;let ga=0;for(const ao of rn){ao.trim();const ps=ao.getMaxScale(),Gs={positionedGlyphs:[],lineOffset:0};dt.positionedLines[ga]=Gs;const Ws=Gs.positionedGlyphs;let Ua=0;if(!ao.length()){Mr+=Mn,++ga;continue}const Ls=hr(Yt,ao,Hc);let $a=0;for(const Qo of ao.text){const qi=ao.getSection($a),Io=Qo.codePointAt(0),Ji=vr(Bt,Xn,Io),es={glyph:Io,imageName:null,x:Jn,y:Mr+-17,vertical:Ji,scale:1,fontStack:"",sectionIndex:ao.getSectionIndex($a),metrics:null,rect:null};let Xd;if("fontStack"in qi){if(Xd=br(qi,Io,Ji,Ls,Ct,Xt),!Xd)continue;es.fontStack=qi.fontStack}else{if(dt.iconsInText=!0,qi.scale*=Hc,Xd=Ko(qi,Ji,ps,Ls,Yt),!Xd)continue;Ua=Math.max(Ua,Xd.imageOffset),es.imageName=qi.imageName}const{rect:Wu,metrics:k0,baselineOffset:Ep}=Xd;es.y+=Ep,es.scale=qi.scale,es.metrics=k0,es.rect=Wu,Ws.push(es),Ji?(dt.verticalizable=!0,Jn+=("imageName"in qi?k0.advance:Po)*qi.scale+Hn):Jn+=k0.advance*qi.scale+Hn,$a++}Ws.length!==0&&(ji=Math.max(Jn-Hn,ji),Qr(Ws,0,Ws.length-1,Rs)),Jn=0,Gs.lineOffset=Math.max(Ua,(ps-1)*Po);const Gc=Mn*ps+Ua;Mr+=Gc,Ao=Math.max(Gc,Ao),++ga}const{horizontalAlign:fs,verticalAlign:Ds}=zn(ln);(function(ao,ps,Gs,Ws,Ua,Ls,$a,Gc,Qo){const qi=(ps-Gs)*Ua;let Io=0;Io=Ls!==$a?-Gc*Ws- -17:-Ws*Qo*$a+.5*$a;for(const Ji of ao)for(const es of Ji.positionedGlyphs)es.x+=qi,es.y+=Io})(dt.positionedLines,Rs,fs,Ds,ji,Ao,Mn,Mr,rn.length),dt.top+=-Ds*Mr,dt.bottom=dt.top+Mr,dt.left+=-fs*ji,dt.right=dt.left+ji}(tt,i,c,f,ve,S,I,F,W,$,te,pe),!function(dt){for(const Ct of dt)if(Ct.positionedGlyphs.length!==0)return!1;return!0}(Oe)&&tt}function zn(h){let i=.5,c=.5;switch(h){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:i,verticalAlign:c}}function hr(h,i,c){const f=i.getMaxScale()*Po,{maxImageWidth:v,maxImageHeight:w}=i.getMaxImageSize(h),S=Math.max(f,w*c);return{verticalLineContentWidth:Math.max(f,v*c),horizontalLineContentHeight:S}}function mr(h){switch(h){case"top":return 0;case"center":return .5;default:return 1}}function vr(h,i,c){return!(h===u.az.horizontal||!i&&!Jf(c)||i&&(Om(c)||(f=c,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(f)))));var f}function br(h,i,c,f,v,w){const S=w[h.fontStack],I=function($,G,W,te){if($&&$.rect)return $;const ie=G[W.fontStack],pe=ie&&ie[te];return pe?{rect:null,metrics:pe.metrics}:null}(S&&S[i],v,h,i);if(I===null)return null;let F;if(c)F=f.verticalLineContentWidth-h.scale*Po;else{const $=mr(h.verticalAlign);F=(f.horizontalLineContentHeight-h.scale*Po)*$}return{rect:I.rect,metrics:I.metrics,baselineOffset:F}}function Ko(h,i,c,f,v){const w=v[h.imageName];if(!w)return null;const S=w.paddedRect,I=w.displaySize,F={width:I[0],height:I[1],left:1,top:-3,advance:i?I[1]:I[0]};let $;if(i)$=f.verticalLineContentWidth-I[1]*h.scale;else{const G=mr(h.verticalAlign);$=(f.horizontalLineContentHeight-I[1]*h.scale)*G}return{rect:S,metrics:F,baselineOffset:$,imageOffset:(i?I[0]:I[1])*h.scale-Po*c}}function Qr(h,i,c,f){if(f===0)return;const v=h[c],w=(h[c].x+v.metrics.advance*v.scale)*f;for(let S=i;S<=c;S++)h[S].x-=w}function Uh(h,i,c){const{horizontalAlign:f,verticalAlign:v}=zn(c),w=i[0]-h.displaySize[0]*f,S=i[1]-h.displaySize[1]*v;return{image:h,top:S,bottom:S+h.displaySize[1],left:w,right:w+h.displaySize[0]}}function I1(h){var i,c;let f=h.left,v=h.top,w=h.right-f,S=h.bottom-v;const I=(i=h.image.textFitWidth)!==null&&i!==void 0?i:"stretchOrShrink",F=(c=h.image.textFitHeight)!==null&&c!==void 0?c:"stretchOrShrink",$=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(F==="proportional"){if(I==="stretchOnly"&&w/S<$||I==="proportional"){const G=Math.ceil(S*$);f*=G/w,w=G}}else if(I==="proportional"&&F==="stretchOnly"&&$!==0&&w/S>$){const G=Math.ceil(w/$);v*=G/S,S=G}return{x1:f,y1:v,x2:f+w,y2:v+S}}function JR(h,i,c,f,v,w){const S=h.image;let I;if(S.content){const ve=S.content,Ae=S.pixelRatio||1;I=[ve[0]/Ae,ve[1]/Ae,S.displaySize[0]-ve[2]/Ae,S.displaySize[1]-ve[3]/Ae]}const F=i.left*w,$=i.right*w;let G,W,te,ie;c==="width"||c==="both"?(ie=v[0]+F-f[3],W=v[0]+$+f[1]):(ie=v[0]+(F+$-S.displaySize[0])/2,W=ie+S.displaySize[0]);const pe=i.top*w,me=i.bottom*w;return c==="height"||c==="both"?(G=v[1]+pe-f[0],te=v[1]+me+f[2]):(G=v[1]+(pe+me-S.displaySize[1])/2,te=G+S.displaySize[1]),{image:S,top:G,right:W,bottom:te,left:ie,collisionPadding:I}}Nn("ImagePosition",Yi),Nn("ImageAtlas",kt),u.az=void 0,(xt=u.az||(u.az={}))[xt.none=0]="none",xt[xt.horizontal=1]="horizontal",xt[xt.vertical=2]="vertical",xt[xt.horizontalOnly=3]="horizontalOnly";const qd=128,xp=32640;function QR(h,i){const{expression:c}=i;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new Jr(h+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:v}=c;let w=0;for(;w<f.length&&f[w]<=h;)w++;w=Math.max(0,w-1);let S=w;for(;S<f.length&&f[S]<h+1;)S++;S=Math.min(f.length-1,S);const I=f[w],F=f[S];return c.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:F,interpolationType:v}:{kind:"camera",minZoom:I,maxZoom:F,minSize:c.evaluate(new Jr(I)),maxSize:c.evaluate(new Jr(F)),interpolationType:v}}}function E2(h,i,c){let f="never";const v=h.get(i);return v?f=v:h.get(c)&&(f="always"),f}const Yj=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function R1(h,i,c,f,v,w,S,I,F,$,G,W,te){const ie=I?Math.min(xp,Math.round(I[0])):0,pe=I?Math.min(xp,Math.round(I[1])):0;h.emplaceBack(i,c,Math.round(32*f),Math.round(32*v),w,S,(ie<<1)+(F?1:0),pe,16*$,16*G,256*W,256*te)}function C2(h,i,c){h.emplaceBack(i.x,i.y,c),h.emplaceBack(i.x,i.y,c),h.emplaceBack(i.x,i.y,c),h.emplaceBack(i.x,i.y,c)}function Kj(h){for(const i of h.sections)if(Fd(i.text))return!0;return!1}class T2{constructor(i){this.layoutVertexArray=new Qe,this.indexArray=new Dt,this.programConfigurations=i,this.segments=new Dn,this.dynamicLayoutVertexArray=new yt,this.opacityVertexArray=new Ot,this.hasVisibleVertices=!1,this.placedSymbolArray=new D}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,c,f,v){this.isEmpty()||(f&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,M1.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,E1.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Yj,!0),this.opacityVertexBuffer.itemSize=1),(f||v)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Nn("SymbolBuffers",T2);class P2{constructor(i,c,f){this.layoutVertexArray=new i,this.layoutAttributes=c,this.indexArray=new f,this.segments=new Dn,this.collisionVertexArray=new It}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,pv.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Nn("CollisionBuffers",P2);class vv{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(S=>S.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=QR(this.zoom,c["text-size"]),this.iconSizeData=QR(this.zoom,c["icon-size"]);const f=this.layers[0].layout,v=f.get("symbol-sort-key"),w=f.get("symbol-z-order");this.canOverlap=E2(f,"text-overlap","text-allow-overlap")!=="never"||E2(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=w!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(w==="viewport-y"||w==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(S=>u.az[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=i.sourceID}createArrays(){this.text=new T2(new $c(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new T2(new $c(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Z,this.lineVertexArray=new Q,this.symbolInstances=new V,this.textAnchorOffsets=new le}calculateGlyphDependencies(i,c,f,v,w){for(const S of i)if(c[S.codePointAt(0)]=!0,(f||v)&&w){const I=yp[S];I&&(c[I.codePointAt(0)]=!0)}}populate(i,c,f){const v=this.layers[0],w=v.layout,S=w.get("text-font"),I=w.get("text-field"),F=w.get("icon-image"),$=(I.value.kind!=="constant"||I.value.value instanceof bo&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),G=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,W=w.get("symbol-sort-key");if(this.features=[],!$&&!G)return;const te=c.iconDependencies,ie=c.glyphDependencies,pe=c.availableImages,me=new Jr(this.zoom);for(const{feature:ve,id:Ae,index:We,sourceLayerIndex:Me}of i){const Oe=v._featureFilter.needGeometry,tt=Wl(ve,Oe);if(!v._featureFilter.filter(me,tt,f))continue;let dt,Ct;if(Oe||(tt.geometry=cl(ve)),$){const Yt=v.getValueAndResolveTokens("text-field",tt,f,pe),rn=bo.factory(Yt),Mn=this.hasRTLText=this.hasRTLText||Kj(rn);(!Mn||Bl.getRTLTextPluginStatus()==="unavailable"||Mn&&Bl.isParsed())&&(dt=C0(rn,v,tt))}if(G){const Yt=v.getValueAndResolveTokens("icon-image",tt,f,pe);Ct=Yt instanceof _s?Yt:_s.fromString(Yt)}if(!dt&&!Ct)continue;const Xt=this.sortFeaturesByKey?W.evaluate(tt,{},f):void 0;if(this.features.push({id:Ae,text:dt,icon:Ct,index:We,sourceLayerIndex:Me,geometry:tt.geometry,properties:ve.properties,type:Yl.types[ve.type],sortKey:Xt}),Ct&&(te[Ct.name]=!0),dt){const Yt=S.evaluate(tt,{},f).join(","),rn=w.get("text-rotation-alignment")!=="viewport"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.az.vertical)>=0;for(const Mn of dt.sections)if(Mn.image)te[Mn.image.name]=!0;else{const ln=zc(dt.toString()),Kt=Mn.fontStack||Yt,Bt=ie[Kt]=ie[Kt]||{};this.calculateGlyphDependencies(Mn.text,Bt,rn,this.allowVerticalPlacement,ln)}}}w.get("symbol-placement")==="line"&&(this.features=function(ve){const Ae={},We={},Me=[];let Oe=0;function tt(Yt){Me.push(ve[Yt]),Oe++}function dt(Yt,rn,Mn){const ln=We[Yt];return delete We[Yt],We[rn]=ln,Me[ln].geometry[0].pop(),Me[ln].geometry[0]=Me[ln].geometry[0].concat(Mn[0]),ln}function Ct(Yt,rn,Mn){const ln=Ae[rn];return delete Ae[rn],Ae[Yt]=ln,Me[ln].geometry[0].shift(),Me[ln].geometry[0]=Mn[0].concat(Me[ln].geometry[0]),ln}function Xt(Yt,rn,Mn){const ln=Mn?rn[0][rn[0].length-1]:rn[0][0];return`${Yt}:${ln.x}:${ln.y}`}for(let Yt=0;Yt<ve.length;Yt++){const rn=ve[Yt],Mn=rn.geometry,ln=rn.text?rn.text.toString():null;if(!ln){tt(Yt);continue}const Kt=Xt(ln,Mn),Bt=Xt(ln,Mn,!0);if(Kt in We&&Bt in Ae&&We[Kt]!==Ae[Bt]){const Hn=Ct(Kt,Bt,Mn),Xn=dt(Kt,Bt,Me[Hn].geometry);delete Ae[Kt],delete We[Bt],We[Xt(ln,Me[Xn].geometry,!0)]=Xn,Me[Hn].geometry=null}else Kt in We?dt(Kt,Bt,Mn):Bt in Ae?Ct(Kt,Bt,Mn):(tt(Yt),Ae[Kt]=Oe-1,We[Bt]=Oe-1)}return Me.filter(Yt=>Yt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ve,Ae)=>ve.sortKey-Ae.sortKey)}update(i,c,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,c,this.layers,{imagePositions:f}),this.icon.programConfigurations.updatePaintArrays(i,c,this.layers,{imagePositions:f}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,c){const f=this.lineVertexArray.length;if(i.segment!==void 0){let v=i.dist(c[i.segment+1]),w=i.dist(c[i.segment]);const S={};for(let I=i.segment+1;I<c.length;I++)S[I]={x:c[I].x,y:c[I].y,tileUnitDistanceFromAnchor:v},I<c.length-1&&(v+=c[I+1].dist(c[I]));for(let I=i.segment||0;I>=0;I--)S[I]={x:c[I].x,y:c[I].y,tileUnitDistanceFromAnchor:w},I>0&&(w+=c[I-1].dist(c[I]));for(let I=0;I<c.length;I++){const F=S[I];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(i,c,f,v,w,S,I,F,$,G,W,te){const ie=i.indexArray,pe=i.layoutVertexArray,me=i.segments.prepareSegment(4*c.length,pe,ie,this.canOverlap?S.sortKey:void 0),ve=this.glyphOffsetArray.length,Ae=me.vertexLength,We=this.allowVerticalPlacement&&I===u.az.vertical?Math.PI/2:0,Me=S.text&&S.text.sections;for(let Oe=0;Oe<c.length;Oe++){const{tl:tt,tr:dt,bl:Ct,br:Xt,tex:Yt,pixelOffsetTL:rn,pixelOffsetBR:Mn,minFontScaleX:ln,minFontScaleY:Kt,glyphOffset:Bt,isSDF:Hn,sectionIndex:Xn}=c[Oe],ur=me.vertexLength,Jn=Bt[1];R1(pe,F.x,F.y,tt.x,Jn+tt.y,Yt.x,Yt.y,f,Hn,rn.x,rn.y,ln,Kt),R1(pe,F.x,F.y,dt.x,Jn+dt.y,Yt.x+Yt.w,Yt.y,f,Hn,Mn.x,rn.y,ln,Kt),R1(pe,F.x,F.y,Ct.x,Jn+Ct.y,Yt.x,Yt.y+Yt.h,f,Hn,rn.x,Mn.y,ln,Kt),R1(pe,F.x,F.y,Xt.x,Jn+Xt.y,Yt.x+Yt.w,Yt.y+Yt.h,f,Hn,Mn.x,Mn.y,ln,Kt),C2(i.dynamicLayoutVertexArray,F,We),ie.emplaceBack(ur,ur+2,ur+1),ie.emplaceBack(ur+1,ur+2,ur+3),me.vertexLength+=4,me.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Bt[0]),Oe!==c.length-1&&Xn===c[Oe+1].sectionIndex||i.programConfigurations.populatePaintArrays(pe.length,S,S.index,{imagePositions:{},canonical:te,formattedSection:Me&&Me[Xn]})}i.placedSymbolArray.emplaceBack(F.x,F.y,ve,this.glyphOffsetArray.length-ve,Ae,$,G,F.segment,f?f[0]:0,f?f[1]:0,v[0],v[1],I,0,!1,0,W)}_addCollisionDebugVertex(i,c,f,v,w,S){return c.emplaceBack(0,0),i.emplaceBack(f.x,f.y,v,w,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(i,c,f,v,w,S,I){const F=w.segments.prepareSegment(4,w.layoutVertexArray,w.indexArray),$=F.vertexLength,G=w.layoutVertexArray,W=w.collisionVertexArray,te=I.anchorX,ie=I.anchorY;this._addCollisionDebugVertex(G,W,S,te,ie,new m(i,c)),this._addCollisionDebugVertex(G,W,S,te,ie,new m(f,c)),this._addCollisionDebugVertex(G,W,S,te,ie,new m(f,v)),this._addCollisionDebugVertex(G,W,S,te,ie,new m(i,v)),F.vertexLength+=4;const pe=w.indexArray;pe.emplaceBack($,$+1),pe.emplaceBack($+1,$+2),pe.emplaceBack($+2,$+3),pe.emplaceBack($+3,$),F.primitiveLength+=4}addDebugCollisionBoxes(i,c,f,v){for(let w=i;w<c;w++){const S=this.collisionBoxArray.get(w);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,v?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new P2(Pt,Km.members,gn),this.iconCollisionBox=new P2(Pt,Km.members,gn);for(let i=0;i<this.symbolInstances.length;i++){const c=this.symbolInstances.get(i);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(i,c,f,v,w,S,I,F,$){const G={};for(let W=c;W<f;W++){const te=i.get(W);G.textBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},G.textFeatureIndex=te.featureIndex;break}for(let W=v;W<w;W++){const te=i.get(W);G.verticalTextBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},G.verticalTextFeatureIndex=te.featureIndex;break}for(let W=S;W<I;W++){const te=i.get(W);G.iconBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},G.iconFeatureIndex=te.featureIndex;break}for(let W=F;W<$;W++){const te=i.get(W);G.verticalIconBox={x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,anchorPointX:te.anchorPointX,anchorPointY:te.anchorPointY},G.verticalIconFeatureIndex=te.featureIndex;break}return G}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,c){const f=i.placedSymbolArray.get(c),v=f.vertexStartIndex+4*f.numGlyphs;for(let w=f.vertexStartIndex;w<v;w+=4)i.indexArray.emplaceBack(w,w+2,w+1),i.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(i),f=Math.cos(i),v=[],w=[],S=[];for(let I=0;I<this.symbolInstances.length;++I){S.push(I);const F=this.symbolInstances.get(I);v.push(0|Math.round(c*F.anchorX+f*F.anchorY)),w.push(F.featureIndex)}return S.sort((I,F)=>v[I]-v[F]||w[F]-w[I]),S}addToSortKeyRanges(i,c){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===c?f.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const f=this.symbolInstances.get(c);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((v,w,S)=>{v>=0&&S.indexOf(v)===w&&this.addIndicesForPlacedSymbol(this.text,v)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let e3,t3;Nn("SymbolBucket",vv,{omit:["layers","collisionBoxArray","features","compareText"]}),vv.MAX_GLYPHS=65535,vv.addDynamicAttributes=C2;var A2={get paint(){return t3=t3||new Wi({"icon-opacity":new rr(De.paint_symbol["icon-opacity"]),"icon-color":new rr(De.paint_symbol["icon-color"]),"icon-halo-color":new rr(De.paint_symbol["icon-halo-color"]),"icon-halo-width":new rr(De.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rr(De.paint_symbol["icon-halo-blur"]),"icon-translate":new Vn(De.paint_symbol["icon-translate"]),"icon-translate-anchor":new Vn(De.paint_symbol["icon-translate-anchor"]),"text-opacity":new rr(De.paint_symbol["text-opacity"]),"text-color":new rr(De.paint_symbol["text-color"],{runtimeType:Vt,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new rr(De.paint_symbol["text-halo-color"]),"text-halo-width":new rr(De.paint_symbol["text-halo-width"]),"text-halo-blur":new rr(De.paint_symbol["text-halo-blur"]),"text-translate":new Vn(De.paint_symbol["text-translate"]),"text-translate-anchor":new Vn(De.paint_symbol["text-translate-anchor"])})},get layout(){return e3=e3||new Wi({"symbol-placement":new Vn(De.layout_symbol["symbol-placement"]),"symbol-spacing":new Vn(De.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Vn(De.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rr(De.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Vn(De.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Vn(De.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Vn(De.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Vn(De.layout_symbol["icon-ignore-placement"]),"icon-optional":new Vn(De.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Vn(De.layout_symbol["icon-rotation-alignment"]),"icon-size":new rr(De.layout_symbol["icon-size"]),"icon-text-fit":new Vn(De.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Vn(De.layout_symbol["icon-text-fit-padding"]),"icon-image":new rr(De.layout_symbol["icon-image"]),"icon-rotate":new rr(De.layout_symbol["icon-rotate"]),"icon-padding":new rr(De.layout_symbol["icon-padding"]),"icon-keep-upright":new Vn(De.layout_symbol["icon-keep-upright"]),"icon-offset":new rr(De.layout_symbol["icon-offset"]),"icon-anchor":new rr(De.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Vn(De.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Vn(De.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Vn(De.layout_symbol["text-rotation-alignment"]),"text-field":new rr(De.layout_symbol["text-field"]),"text-font":new rr(De.layout_symbol["text-font"]),"text-size":new rr(De.layout_symbol["text-size"]),"text-max-width":new rr(De.layout_symbol["text-max-width"]),"text-line-height":new Vn(De.layout_symbol["text-line-height"]),"text-letter-spacing":new rr(De.layout_symbol["text-letter-spacing"]),"text-justify":new rr(De.layout_symbol["text-justify"]),"text-radial-offset":new rr(De.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Vn(De.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new rr(De.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new rr(De.layout_symbol["text-anchor"]),"text-max-angle":new Vn(De.layout_symbol["text-max-angle"]),"text-writing-mode":new Vn(De.layout_symbol["text-writing-mode"]),"text-rotate":new rr(De.layout_symbol["text-rotate"]),"text-padding":new Vn(De.layout_symbol["text-padding"]),"text-keep-upright":new Vn(De.layout_symbol["text-keep-upright"]),"text-transform":new rr(De.layout_symbol["text-transform"]),"text-offset":new rr(De.layout_symbol["text-offset"]),"text-allow-overlap":new Vn(De.layout_symbol["text-allow-overlap"]),"text-overlap":new Vn(De.layout_symbol["text-overlap"]),"text-ignore-placement":new Vn(De.layout_symbol["text-ignore-placement"]),"text-optional":new Vn(De.layout_symbol["text-optional"])})}};class n3{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:kn,this.defaultValue=i}evaluate(i){if(i.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(i.formattedSection))return c.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nn("FormatSectionOverride",n3,{omit:["defaultValue"]});class D1 extends Ss{constructor(i,c){super(i,A2,c)}recalculate(i,c){if(super.recalculate(i,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const v=[];for(const w of f)v.indexOf(w)<0&&v.push(w);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,c,f,v){const w=this.layout.get(i).evaluate(c,{},f,v),S=this._unevaluatedLayout._values[i];return S.isDataDriven()||wu(S.value)||!w?w:function(I,F){return F.replace(/{([^{}]+)}/g,($,G)=>I&&G in I?String(I[G]):"")}(c.properties,w)}createBucket(i){return new vv(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of A2.paint.overridableProperties){if(!D1.hasPaintOverride(this.layout,i))continue;const c=this.paint.get(i),f=new n3(c),v=new bu(f,c.property.specification);let w=null;w=c.value.kind==="constant"||c.value.kind==="source"?new Cc("source",v):new wh("composite",v,c.value.zoomStops),this.paint._values[i]=new Vs(c.property,w,c.parameters)}}_handleOverridablePaintPropertyUpdate(i,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven())&&D1.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,c){const f=i.get("text-field"),v=A2.paint.properties[c];let w=!1;const S=I=>{for(const F of I)if(v.overrides&&v.overrides.hasOverride(F))return void(w=!0)};if(f.value.kind==="constant"&&f.value.value instanceof bo)S(f.value.value.sections);else if(f.value.kind==="source"||f.value.kind==="composite"){const I=$=>{w||($ instanceof ss&&vi($.value)===Re?S($.value.sections):$ instanceof vd?S($.sections):$.eachChild(I))},F=f.value;F._styleExpression&&I(F._styleExpression.expression)}return w}}let r3;var Jj={get paint(){return r3=r3||new Wi({"background-color":new Vn(De.paint_background["background-color"]),"background-pattern":new Nd(De.paint_background["background-pattern"]),"background-opacity":new Vn(De.paint_background["background-opacity"])})}};class Qj extends Ss{constructor(i,c){super(i,Jj,c)}}class e9 extends Ss{constructor(i,c){super(i,{},c),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class t9{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const n9={once:!0},I2=63710088e-1;class bp{constructor(i,c){if(isNaN(i)||isNaN(c))throw new Error(`Invalid LngLat object: (${i}, ${c})`);if(this.lng=+i,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bp(ot(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const c=Math.PI/180,f=this.lat*c,v=i.lat*c,w=Math.sin(f)*Math.sin(v)+Math.cos(f)*Math.cos(v)*Math.cos((i.lng-this.lng)*c);return I2*Math.acos(Math.min(w,1))}static convert(i){if(i instanceof bp)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new bp(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new bp(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const i3=2*Math.PI*I2;function o3(h){return i3*Math.cos(h*Math.PI/180)}function s3(h){return(180+h)/360}function a3(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function l3(h,i){return h/o3(i)}function c3(h){return 360*h-180}function L1(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function u3(h,i){return h*o3(L1(i))}class P0{constructor(i,c,f=0){this.x=+i,this.y=+c,this.z=+f}static fromLngLat(i,c=0){const f=bp.convert(i);return new P0(s3(f.lng),a3(f.lat),l3(c,f.lat))}toLngLat(){return new bp(c3(this.x),L1(this.y))}toAltitude(){return u3(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/i3*(i=L1(this.y),1/Math.cos(i*Math.PI/180));var i}}function h3(h,i,c){var f=2*Math.PI*6378137/256/Math.pow(2,c);return[h*f-2*Math.PI*6378137/2,i*f-2*Math.PI*6378137/2]}class R2{constructor(i,c,f){if(!function(v,w,S){return!(v<0||v>25||S<0||S>=Math.pow(2,v)||w<0||w>=Math.pow(2,v))}(i,c,f))throw new Error(`x=${c}, y=${f}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=c,this.y=f,this.key=yv(0,i,i,c,f)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,c,f){const v=(S=this.y,I=this.z,F=h3(256*(w=this.x),256*(S=Math.pow(2,I)-S-1),I),$=h3(256*(w+1),256*(S+1),I),F[0]+","+F[1]+","+$[0]+","+$[1]);var w,S,I,F,$;const G=function(W,te,ie){let pe,me="";for(let ve=W;ve>0;ve--)pe=1<<ve-1,me+=(te&pe?1:0)+(ie&pe?2:0);return me}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,G).replace(/{bbox-epsg-3857}/g,v)}isChildOf(i){const c=this.z-i.z;return c>0&&i.x===this.x>>c&&i.y===this.y>>c}getTilePoint(i){const c=Math.pow(2,this.z);return new m((i.x*c-this.x)*Ue,(i.y*c-this.y)*Ue)}toString(){return`${this.z}/${this.x}/${this.y}`}}class d3{constructor(i,c){this.wrap=i,this.canonical=c,this.key=yv(i,c.z,c.z,c.x,c.y)}}class fl{constructor(i,c,f,v,w){if(this.terrainRttPosMatrix32f=null,i<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${f}`);this.overscaledZ=i,this.wrap=c,this.canonical=new R2(f,+v,+w),this.key=yv(c,i,f,v,w)}clone(){return new fl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-i;return i>this.canonical.z?new fl(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fl(i,this.wrap,i,this.canonical.x>>c,this.canonical.y>>c)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(i,c){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-i;return i>this.canonical.z?yv(this.wrap*+c,i,this.canonical.z,this.canonical.x,this.canonical.y):yv(this.wrap*+c,i,i,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(i){if(i.wrap!==this.wrap||this.overscaledZ-i.overscaledZ<=0)return!1;if(i.overscaledZ===0)return this.overscaledZ>0;const c=this.canonical.z-i.canonical.z;return!(c<0)&&i.canonical.x===this.canonical.x>>c&&i.canonical.y===this.canonical.y>>c}children(i){if(this.overscaledZ>=i)return[new fl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,f=2*this.canonical.x,v=2*this.canonical.y;return[new fl(c,this.wrap,c,f,v),new fl(c,this.wrap,c,f+1,v),new fl(c,this.wrap,c,f,v+1),new fl(c,this.wrap,c,f+1,v+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new fl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new fl(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new d3(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new P0(i.x-this.wrap,i.y))}normalizeCoordinates(i,c,f=8192){if(i>=0&&i<f&&c>=0&&c<f)return{tileID:this,x:i,y:c};const v=Math.floor(i/f),w=Math.floor(c/f),S=i-v*f,I=c-w*f,F=this.canonical.z,$=1<<F,G=this.canonical.y+w;if(G<0||G>=$)return null;let W=this.canonical.x+v,te=this.wrap;return W<0?(te-=Math.ceil(-W/$),W=(W%$+$)%$):W>=$&&(te+=Math.floor(W/$),W%=$),{tileID:new fl(this.overscaledZ,te,F,W,G),x:S,y:I}}}function yv(h,i,c,f,v){(h*=2)<0&&(h=-1*h-1);const w=1<<c;return(w*w*h+w*v+f).toString(36)+c.toString(36)+i.toString(36)}function D2(h,i){return i?h.properties[i]:h.id}function r9(h,i){const c={id:h.id};if(i.removeAllProperties&&(delete h.removeProperties,delete h.addOrUpdateProperties,delete i.removeProperties),i.removeProperties)for(const f of i.removeProperties){const v=h.addOrUpdateProperties.findIndex(w=>w.key===f);v>-1&&h.addOrUpdateProperties.splice(v,1)}return(h.removeAllProperties||i.removeAllProperties)&&(c.removeAllProperties=!0),(h.removeProperties||i.removeProperties)&&(c.removeProperties=[...h.removeProperties||[],...i.removeProperties||[]]),(h.addOrUpdateProperties||i.addOrUpdateProperties)&&(c.addOrUpdateProperties=[...h.addOrUpdateProperties||[],...i.addOrUpdateProperties||[]]),(h.newGeometry||i.newGeometry)&&(c.newGeometry=i.newGeometry||h.newGeometry),c}function f3(h){var i,c;if(!h)return{};const f={};return f.removeAll=h.removeAll,f.remove=new Set(h.remove||[]),f.add=new Map((i=h.add)===null||i===void 0?void 0:i.map(v=>[v.id,v])),f.update=new Map((c=h.update)===null||c===void 0?void 0:c.map(v=>[v.id,v])),f}Nn("CanonicalTileID",R2),Nn("OverscaledTileID",fl,{omit:["terrainRttPosMatrix32f"]});class tg{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(i){return this.minX=Math.min(this.minX,i.x),this.minY=Math.min(this.minY,i.y),this.maxX=Math.max(this.maxX,i.x),this.maxY=Math.max(this.maxY,i.y),this}expandBy(i){return this.minX-=i,this.minY-=i,this.maxX+=i,this.maxY+=i,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(i){return this.expandBy(-i)}map(i){const c=new tg;return c.extend(i(new m(this.minX,this.minY))),c.extend(i(new m(this.maxX,this.minY))),c.extend(i(new m(this.minX,this.maxY))),c.extend(i(new m(this.maxX,this.maxY))),c}static fromPoints(i){const c=new tg;for(const f of i)c.extend(f);return c}contains(i){return i.x>=this.minX&&i.x<=this.maxX&&i.y>=this.minY&&i.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(i){return!this.empty()&&!i.empty()&&i.minX>=this.minX&&i.maxX<=this.maxX&&i.minY>=this.minY&&i.maxY<=this.maxY}intersects(i){return!this.empty()&&!i.empty()&&i.minX<=this.maxX&&i.maxX>=this.minX&&i.minY<=this.maxY&&i.maxY>=this.minY}}class p3{constructor(i){this._stringToNumber={},this._numberToString=[];for(let c=0;c<i.length;c++){const f=i[c];this._stringToNumber[f]=c,this._numberToString[c]=f}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class m3{constructor(i,c,f,v,w){this.type="Feature",this._vectorTileFeature=i,this._x=f,this._y=v,this._z=c,this.properties=i.properties,this.id=w}projectPoint(i,c,f,v){return[360*(i.x+c)/v-180,360/Math.PI*Math.atan(Math.exp((1-2*(i.y+f)/v)*Math.PI))-90]}projectLine(i,c,f,v){return i.map(w=>this.projectPoint(w,c,f,v))}get geometry(){if(this._geometry)return this._geometry;const i=this._vectorTileFeature,c=i.extent*Math.pow(2,this._z),f=i.extent*this._x,v=i.extent*this._y,w=i.loadGeometry();switch(i.type){case 1:{const S=[];for(const F of w)S.push(F[0]);const I=this.projectLine(S,f,v,c);this._geometry=S.length===1?{type:"Point",coordinates:I[0]}:{type:"MultiPoint",coordinates:I};break}case 2:{const S=w.map(I=>this.projectLine(I,f,v,c));this._geometry=S.length===1?{type:"LineString",coordinates:S[0]}:{type:"MultiLineString",coordinates:S};break}case 3:{const S=_0(w),I=[];for(const F of S)I.push(F.map($=>this.projectLine($,f,v,c)));this._geometry=I.length===1?{type:"Polygon",coordinates:I[0]}:{type:"MultiPolygon",coordinates:I};break}default:throw new Error(`unknown feature type: ${i.type}`)}return this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const c in this)c!=="_geometry"&&c!=="_vectorTileFeature"&&c!=="_x"&&c!=="_y"&&c!=="_z"&&(i[c]=this[c]);return i}}class _v{_name;dataBuffer;nullabilityBuffer;_size;constructor(i,c,f){this._name=i,this.dataBuffer=c,typeof f=="number"?this._size=f:(this.nullabilityBuffer=f,this._size=f.size())}getValue(i){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(i)?null:this.getValueFromBuffer(i)}has(i){return this.nullabilityBuffer&&this.nullabilityBuffer.get(i)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class k1 extends _v{}class L2 extends k1{getValueFromBuffer(i){return this.dataBuffer[i]}}class k2 extends k1{getValueFromBuffer(i){return this.dataBuffer[i]}}class g3 extends _v{delta;constructor(i,c,f,v){super(i,c,v),this.delta=f}}class z2 extends g3{constructor(i,c,f,v){super(i,Int32Array.of(c),f,v)}getValueFromBuffer(i){return this.dataBuffer[0]+i*this.delta}}class O2 extends _v{constructor(i,c,f){super(i,Int32Array.of(c),f)}getValueFromBuffer(i){return this.dataBuffer[0]}}class i9{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(i,c,f,v,w=4096){this._name=i,this._geometryVector=c,this._idVector=f,this._propertyVectors=v,this._extent=w}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(i){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map(c=>[c.name,c]))),this.propertyVectorsMap.get(i)}*[Symbol.iterator](){const i=this.geometryVector[Symbol.iterator]();let c=0;for(;c<this.numFeatures;){let f;this.idVector&&(f=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(c)):this.idVector.getValue(c));const v=i?.next().value,w={};for(const S of this.propertyVectors){if(!S)continue;const I=S.name,F=S.getValue(c);F!==null&&(w[I]=F)}c++,yield{id:f,geometry:v,properties:w}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const i=[],c=this.geometryVector.getGeometries();for(let f=0;f<this.numFeatures;f++){let v;this.idVector&&(v=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(f)):this.idVector.getValue(f));const w={coordinates:c[f],type:this.geometryVector.geometryType(f)},S={};for(const I of this.propertyVectors){if(!I)continue;const F=I.name,$=I.getValue(f);$!==null&&(S[F]=$)}i.push({id:v,geometry:w,properties:S})}return i}containsMaxSaveIntegerValues(i){return i instanceof L2||i instanceof O2&&i instanceof z2||i instanceof k2}}class o9{value;constructor(i){this.value=i}get(){return this.value}set(i){this.value=i}increment(){return this.value++}add(i){this.value+=i}}var ai,wp,As,Hu,ng,pl,so,Jo,v3,Jl;function Hs(h,i,c){const f=new Int32Array(c);let v=0,w=i.get();for(let S=0;S<f.length;S++){let I=h[w++],F=127&I;I<128||(I=h[w++],F|=(127&I)<<7,I<128||(I=h[w++],F|=(127&I)<<14,I<128||(I=h[w++],F|=(127&I)<<21,I<128||(I=h[w++],F|=(15&I)<<28)))),f[v++]=F}return i.set(w),f}function F2(h,i,c){const f=new BigInt64Array(c);for(let v=0;v<f.length;v++)f[v]=s9(h,i);return f}function s9(h,i){let c=0n,f=0,v=i.get();for(;v<h.length;){const w=h[v++];if(c|=BigInt(127&w)<<BigInt(f),!(128&w))break;if(f+=7,f>=64)throw new Error("Varint too long")}return i.set(v),c}function a9(h,i){let c,f;return f=h[i.get()],i.increment(),c=127&f,f<128?c:(f=h[i.get()],i.increment(),c|=(127&f)<<7,f<128?c:(f=h[i.get()],i.increment(),c|=(127&f)<<14,f<128?c:(f=h[i.get()],i.increment(),c|=(127&f)<<21,f<128?c:(f=h[i.get()],c|=(15&f)<<28,function(v,w,S){let I,F;if(F=w[S.get()],S.increment(),I=(112&F)>>4,F<128||(F=w[S.get()],S.increment(),I|=(127&F)<<3,F<128)||(F=w[S.get()],S.increment(),I|=(127&F)<<10,F<128)||(F=w[S.get()],S.increment(),I|=(127&F)<<17,F<128)||(F=w[S.get()],S.increment(),I|=(127&F)<<24,F<128)||(F=w[S.get()],S.increment(),I|=(1&F)<<31,F<128))return 4294967296*I+(v>>>0);throw new Error("Expected varint not more than 10 bytes")}(c,h,i)))))}function Ki(h){return h>>>1^-(1&h)}function ml(h){return h>>1n^-(1n&h)}function xv(h){return h%2==1?(h+1)/-2:h/2}function y3(h,i,c){if(c===void 0){c=0;for(let w=0;w<i;w++)c+=h[w]}const f=new Int32Array(c);let v=0;for(let w=0;w<i;w++){const S=h[w];f.fill(h[w+i],v,v+S),v+=S}return f}function _3(h,i,c){if(c===void 0){c=0;for(let w=0;w<i;w++)c+=Number(h[w])}const f=new BigInt64Array(c);let v=0;for(let w=0;w<i;w++){const S=Number(h[w]);f.fill(h[w+i],v,v+S),v+=S}return f}function x3(h,i,c){const f=new Float64Array(c);let v=0;for(let w=0;w<i;w++){const S=h[w];f.fill(h[w+i],v,v+S),v+=S}return f}function b3(h){const i=h.length/4*4;let c=1;if(i>=4)for(let f=h[0];c<i-4;c+=4)f=h[c]+=f,f=h[c+1]+=f,f=h[c+2]+=f,f=h[c+3]+=f;for(;c!=h.length;)h[c]+=h[c-1],++c}(function(h){h.NONE="NONE",h.DELTA="DELTA",h.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",h.RLE="RLE",h.MORTON="MORTON",h.PDE="PDE"})(ai||(ai={})),function(h){h.NONE="NONE",h.FAST_PFOR="FAST_PFOR",h.VARINT="VARINT",h.ALP="ALP"}(wp||(wp={})),function(h){h.PRESENT="PRESENT",h.DATA="DATA",h.OFFSET="OFFSET",h.LENGTH="LENGTH"}(As||(As={}));class N2{_dictionaryType;_offsetType;_lengthType;constructor(i,c,f){this._dictionaryType=i,this._offsetType=c,this._lengthType=f}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function pa(h,i){const c=function(f,v){const w=f[v.get()],S=Object.values(As)[w>>4];let I=null;switch(S){case As.DATA:I=new N2(Object.values(Hu)[15&w]);break;case As.OFFSET:I=new N2(null,Object.values(ng)[15&w]);break;case As.LENGTH:I=new N2(null,null,Object.values(pl)[15&w])}v.increment();const F=f[v.get()],$=Object.values(ai)[F>>5],G=Object.values(ai)[F>>2&7],W=Object.values(wp)[3&F];v.increment();const te=Hs(f,v,2),ie=te[0];return{physicalStreamType:S,logicalStreamType:I,logicalLevelTechnique1:$,logicalLevelTechnique2:G,physicalLevelTechnique:W,numValues:ie,byteLength:te[1],decompressedCount:ie}}(h,i);return c.logicalLevelTechnique1===ai.MORTON?function(f,v,w){const S=Hs(v,w,2);return{physicalStreamType:f.physicalStreamType,logicalStreamType:f.logicalStreamType,logicalLevelTechnique1:f.logicalLevelTechnique1,logicalLevelTechnique2:f.logicalLevelTechnique2,physicalLevelTechnique:f.physicalLevelTechnique,numValues:f.numValues,byteLength:f.byteLength,decompressedCount:f.decompressedCount,numBits:S[0],coordinateShift:S[1]}}(c,h,i):ai.RLE!==c.logicalLevelTechnique1&&ai.RLE!==c.logicalLevelTechnique2||wp.NONE===c.physicalLevelTechnique?c:function(f,v,w){const S=Hs(v,w,2);return{physicalStreamType:f.physicalStreamType,logicalStreamType:f.logicalStreamType,logicalLevelTechnique1:f.logicalLevelTechnique1,logicalLevelTechnique2:f.logicalLevelTechnique2,physicalLevelTechnique:f.physicalLevelTechnique,numValues:f.numValues,byteLength:f.byteLength,decompressedCount:S[1],runs:S[0],numRleValues:S[1]}}(c,h,i)}(function(h){h.NONE="NONE",h.SINGLE="SINGLE",h.SHARED="SHARED",h.VERTEX="VERTEX",h.MORTON="MORTON",h.FSST="FSST"})(Hu||(Hu={})),function(h){h.VERTEX="VERTEX",h.INDEX="INDEX",h.STRING="STRING",h.KEY="KEY"}(ng||(ng={})),function(h){h.VAR_BINARY="VAR_BINARY",h.GEOMETRIES="GEOMETRIES",h.PARTS="PARTS",h.RINGS="RINGS",h.TRIANGLES="TRIANGLES",h.SYMBOL="SYMBOL",h.DICTIONARY="DICTIONARY"}(pl||(pl={})),function(h){h[h.FLAT=0]="FLAT",h[h.CONST=1]="CONST",h[h.SEQUENCE=2]="SEQUENCE",h[h.DICTIONARY=3]="DICTIONARY",h[h.FSST_DICTIONARY=4]="FSST_DICTIONARY"}(so||(so={}));class Gu{values;_size;constructor(i,c){this.values=i,this._size=c}get(i){const c=Math.floor(i/8);return(this.values[c]>>i%8&1)==1}set(i,c){const f=Math.floor(i/8);this.values[f]=this.values[f]|(c?1:0)<<i%8}getInt(i){const c=Math.floor(i/8);return this.values[c]>>i%8&1}size(){return this._size}getBuffer(){return this.values}}function z1(h,i,c){if(!i)return h;const f=i.size(),v=new h.constructor(f);let w=0;for(let S=0;S<f;S++)v[S]=i.get(S)?h[w++]:c;return v}function ma(h,i,c,f,v,w){return function(S,I,F,$,G){switch(I.logicalLevelTechnique1){case ai.DELTA:if(I.logicalLevelTechnique2===ai.RLE){const W=I;if(!G)return function(te,ie,pe){const me=new Int32Array(pe);let ve=0,Ae=0;for(let We=0;We<ie;We++){const Me=te[We],Oe=Ki(te[We+ie]);for(let tt=0;tt<Me;tt++)Ae+=Oe,me[ve++]=Ae}return me}(S,W.runs,W.numRleValues);S=y3(S,W.runs,W.numRleValues)}(function(W){W[0]=Ki(W[0]);const te=W.length/4*4;let ie=1;if(te>=4)for(;ie<te-4;ie+=4){const pe=W[ie+1],me=W[ie+2],ve=W[ie+3];W[ie]=Ki(W[ie])+W[ie-1],W[ie+1]=Ki(pe)+W[ie],W[ie+2]=Ki(me)+W[ie+1],W[ie+3]=Ki(ve)+W[ie+2]}for(;ie!=W.length;++ie)W[ie]=Ki(W[ie])+W[ie-1]})(S);break;case ai.RLE:S=function(W,te,ie){return ie?function(pe,me,ve){if(ve===void 0){ve=0;for(let Me=0;Me<me;Me++)ve+=pe[Me]}const Ae=new Int32Array(ve);let We=0;for(let Me=0;Me<me;Me++){const Oe=pe[Me];let tt=pe[Me+me];tt=Ki(tt),Ae.fill(tt,We,We+Oe),We+=Oe}return Ae}(W,te.runs,te.numRleValues):y3(W,te.runs,te.numRleValues)}(S,I,F);break;case ai.MORTON:b3(S);break;case ai.COMPONENTWISE_DELTA:(function(W){if(W.length<2)return;W[0]=Ki(W[0]),W[1]=Ki(W[1]);const te=W.length/4*4;let ie=2;if(te>=4)for(;ie<te-4;ie+=4){const pe=W[ie+1],me=W[ie+2],ve=W[ie+3];W[ie]=Ki(W[ie])+W[ie-2],W[ie+1]=Ki(pe)+W[ie-1],W[ie+2]=Ki(me)+W[ie],W[ie+3]=Ki(ve)+W[ie+1]}for(;ie!=W.length;ie+=2)W[ie]=Ki(W[ie])+W[ie-2],W[ie+1]=Ki(W[ie+1])+W[ie-1]})(S);break;case ai.NONE:F&&function(W){for(let te=0;te<W.length;te++)W[te]=Ki(W[te])}(S);break;default:throw new Error(`The specified Logical level technique is not supported: ${I.logicalLevelTechnique1}`)}return G?z1(S,G,0):S}(O1(h,i,c),c,f,0,w)}function Sp(h,i,c){return function(f,v){if(v.logicalLevelTechnique1===ai.DELTA&&v.logicalLevelTechnique2===ai.NONE)return function(w){const S=new Int32Array(w.length+1);S[0]=0,S[1]=Ki(w[0]);let I=S[1];for(let F=2;F!=S.length;++F)I+=Ki(w[F-1]),S[F]=S[F-1]+I;return new Uint32Array(S)}(f);if(v.logicalLevelTechnique1===ai.RLE&&v.logicalLevelTechnique2===ai.NONE)return function(w,S,I){const F=new Int32Array(I+1);F[0]=0;let $=1,G=F[0];for(let W=0;W<S;W++){const te=w[W],ie=w[W+S];for(let pe=$;pe<$+te;pe++)F[pe]=ie+G,G=F[pe];$+=te}return new Uint32Array(F)}(f,v.runs,v.numRleValues);if(v.logicalLevelTechnique1===ai.NONE&&v.logicalLevelTechnique2===ai.NONE){(function(S){let I=0;for(let F=0;F<S.length;F++)S[F]+=I,I=S[F]})(f);const w=new Uint32Array(v.numValues+1);return w[0]=0,w.set(f,1),w}if(v.logicalLevelTechnique1===ai.DELTA&&v.logicalLevelTechnique2===ai.RLE){const w=function(S,I,F){const $=new Int32Array(F+1);$[0]=0;let G=1,W=$[0];for(let te=0;te<I;te++){const ie=S[te];let pe=S[te+I];pe=Ki(pe);for(let me=G;me<G+ie;me++)$[me]=pe+W,W=$[me];G+=ie}return new Uint32Array($)}(f,v.runs,v.numRleValues);return b3(w),w}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")}(O1(h,i,c),c)}function O1(h,i,c){const f=c.physicalLevelTechnique;if(f===wp.FAST_PFOR)return function(){throw new Error("FastPFor is not implemented yet.")}();if(f===wp.VARINT)return Hs(h,i,c.numValues);if(f===wp.NONE){const v=i.get();i.add(c.byteLength);const w=h.subarray(v,i.get());return new Int32Array(w)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function B2(h,i,c,f){const v=O1(h,i,c);if(v.length===1){const w=v[0];return f?Ki(w):w}return f?function(w){return Ki(w[1])}(v):function(w){return w[1]}(v)}function w3(h,i,c){return function(f){if(f.length==2){const v=Ki(f[1]);return[v,v]}return[Ki(f[2]),Ki(f[3])]}(O1(h,i,c))}function S3(h,i,c){return function(f){if(f.length==2){const v=ml(f[1]);return[v,v]}return[ml(f[2]),ml(f[3])]}(F2(h,i,c.numValues))}function M3(h,i,c,f,v){return function(w,S,I,F){switch(S.logicalLevelTechnique1){case ai.DELTA:if(S.logicalLevelTechnique2===ai.RLE){const $=S;if(!F)return function(G,W,te){const ie=new BigInt64Array(te);let pe=0,me=0n;for(let ve=0;ve<W;ve++){const Ae=Number(G[ve]),We=ml(G[ve+W]);for(let Me=0;Me<Ae;Me++)me+=We,ie[pe++]=me}return ie}(w,$.runs,$.numRleValues);w=_3(w,$.runs,$.numRleValues)}(function($){$[0]=ml($[0]);const G=$.length/4*4;let W=1;if(G>=4)for(;W<G-4;W+=4){const te=$[W+1],ie=$[W+2],pe=$[W+3];$[W]=ml($[W])+$[W-1],$[W+1]=ml(te)+$[W],$[W+2]=ml(ie)+$[W+1],$[W+3]=ml(pe)+$[W+2]}for(;W!=$.length;++W)$[W]=ml($[W])+$[W-1]})(w);break;case ai.RLE:w=function($,G,W){return W?function(te,ie,pe){if(pe===void 0){pe=0;for(let Ae=0;Ae<ie;Ae++)pe+=Number(te[Ae])}const me=new BigInt64Array(pe);let ve=0;for(let Ae=0;Ae<ie;Ae++){const We=Number(te[Ae]);let Me=te[Ae+ie];Me=ml(Me),me.fill(Me,ve,ve+We),ve+=We}return me}($,G.runs,G.numRleValues):_3($,G.runs,G.numRleValues)}(w,S,I);break;case ai.NONE:I&&function($){for(let G=0;G<$.length;G++)$[G]=ml($[G])}(w);break;default:throw new Error(`The specified Logical level technique is not supported: ${S.logicalLevelTechnique1}`)}return F?z1(w,F,0n):w}(F2(h,i,c.numValues),c,f,v)}function E3(h,i,c,f){const v=F2(h,i,c.numValues);if(v.length===1){const w=v[0];return f?ml(w):w}return f?function(w){return ml(w[1])}(v):function(w){return w[1]}(v)}function F1(h,i,c,f){const v=h.logicalLevelTechnique1;if(v===ai.RLE)return h.runs===1?so.CONST:so.FLAT;if(v!==ai.DELTA||h.logicalLevelTechnique2!==ai.RLE)return h.numValues===1?so.CONST:so.FLAT;const w=i instanceof Gu?i.size():i;if(h.numRleValues!==w)return so.FLAT;if(h.runs===1)return so.SEQUENCE;if(h.runs!==2)return h.numValues===1?so.CONST:so.FLAT;const S=f.get();let I;if(h.physicalLevelTechnique===wp.VARINT)I=Hs(c,f,4);else{const F=f.get();I=new Int32Array(c.buffer,c.byteOffset+F,4)}return f.set(S),I[2]===2&&I[3]===2?so.SEQUENCE:h.numValues===1?so.CONST:so.FLAT}class C3 extends k1{getValueFromBuffer(i){return this.dataBuffer[i]}}class T3 extends g3{constructor(i,c,f,v){super(i,BigInt64Array.of(c),f,v)}getValueFromBuffer(i){return this.dataBuffer[0]+BigInt(i)*this.delta}}class bv{_geometryOffsets;_partOffsets;_ringOffsets;constructor(i,c,f){this._geometryOffsets=i,this._partOffsets=c,this._ringOffsets=f}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function U2(h,i,c){return{x:P3(h,i)-c,y:P3(h>>1,i)-c}}function P3(h,i){let c=0;for(let f=0;f<i;f++)c|=(h&1<<2*f)>>f;return c}(function(h){h[h.POINT=0]="POINT",h[h.LINESTRING=1]="LINESTRING",h[h.POLYGON=2]="POLYGON",h[h.MULTIPOINT=3]="MULTIPOINT",h[h.MULTILINESTRING=4]="MULTILINESTRING",h[h.MULTIPOLYGON=5]="MULTIPOLYGON"})(Jo||(Jo={})),function(h){h[h.POINT=0]="POINT",h[h.LINESTRING=1]="LINESTRING",h[h.POLYGON=2]="POLYGON"}(v3||(v3={})),function(h){h[h.MORTON=0]="MORTON",h[h.VEC_2=1]="VEC_2",h[h.VEC_3=2]="VEC_3"}(Jl||(Jl={}));class l9{createPoint(i){return[[i]]}createMultiPoint(i){return i.map(c=>[c])}createLineString(i){return[i]}createMultiLineString(i){return i}createPolygon(i,c){return[i].concat(c)}createMultiPolygon(i){return i.flat()}}function A3(h){const i=new Array(h.numGeometries);let c=1,f=1,v=1,w=0;const S=new l9;let I=0,F=0;const $=h.mortonSettings,G=h.topologyVector,W=G.geometryOffsets,te=G.partOffsets,ie=G.ringOffsets,pe=h.vertexOffsets,me=h.containsPolygonGeometry(),ve=h.vertexBuffer;for(let Ae=0;Ae<h.numGeometries;Ae++){const We=h.geometryType(Ae);if(We===Jo.POINT){if(pe&&pe.length!==0)if(h.vertexBufferType===Jl.VEC_2){const Me=2*pe[F++],Oe=new m(ve[Me],ve[Me+1]);i[w++]=S.createPoint(Oe)}else{const Me=U2(ve[pe[F++]],$.numBits,$.coordinateShift),Oe=new m(Me.x,Me.y);i[w++]=S.createPoint(Oe)}else{const Me=new m(ve[I++],ve[I++]);i[w++]=S.createPoint(Me)}W&&v++,te&&c++,ie&&f++}else if(We===Jo.MULTIPOINT){const Me=W[v]-W[v-1];v++;const Oe=new Array(Me);if(pe&&pe.length!==0){for(let tt=0;tt<Me;tt++){const dt=2*pe[F++];Oe[tt]=new m(ve[dt],ve[dt+1])}i[w++]=S.createMultiPoint(Oe)}else{for(let tt=0;tt<Me;tt++){const dt=ve[I++],Ct=ve[I++];Oe[tt]=new m(dt,Ct)}i[w++]=S.createMultiPoint(Oe)}}else if(We===Jo.LINESTRING){let Me,Oe=0;me?(Oe=ie[f]-ie[f-1],f++):Oe=te[c]-te[c-1],c++,pe&&pe.length!==0?(Me=h.vertexBufferType===Jl.VEC_2?V2(ve,pe,F,Oe,!1):j2(ve,pe,F,Oe,!1,$),F+=Oe):(Me=$2(ve,I,Oe,!1),I+=2*Oe),i[w++]=S.createLineString(Me),W&&v++}else if(We===Jo.POLYGON){const Me=te[c]-te[c-1];c++;const Oe=new Array(Me-1);let tt=ie[f]-ie[f-1];if(f++,pe&&pe.length!==0){const dt=h.vertexBufferType===Jl.VEC_2?B1(ve,pe,F,tt):U1(ve,pe,F,tt,0,$);F+=tt;for(let Ct=0;Ct<Oe.length;Ct++)tt=ie[f]-ie[f-1],f++,Oe[Ct]=h.vertexBufferType===Jl.VEC_2?B1(ve,pe,F,tt):U1(ve,pe,F,tt,0,$),F+=tt;i[w++]=S.createPolygon(dt,Oe)}else{const dt=N1(ve,I,tt);I+=2*tt;for(let Ct=0;Ct<Oe.length;Ct++)tt=ie[f]-ie[f-1],f++,Oe[Ct]=N1(ve,I,tt),I+=2*tt;i[w++]=S.createPolygon(dt,Oe)}W&&v++}else if(We===Jo.MULTILINESTRING){const Me=W[v]-W[v-1];v++;const Oe=new Array(Me);if(pe&&pe.length!==0){for(let tt=0;tt<Me;tt++){let dt=0;me?(dt=ie[f]-ie[f-1],f++):dt=te[c]-te[c-1],c++;const Ct=h.vertexBufferType===Jl.VEC_2?V2(ve,pe,F,dt,!1):j2(ve,pe,F,dt,!1,$);Oe[tt]=Ct,F+=dt}i[w++]=S.createMultiLineString(Oe)}else{for(let tt=0;tt<Me;tt++){let dt=0;me?(dt=ie[f]-ie[f-1],f++):dt=te[c]-te[c-1],c++,Oe[tt]=$2(ve,I,dt,!1),I+=2*dt}i[w++]=S.createMultiLineString(Oe)}}else{if(We!==Jo.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const Me=W[v]-W[v-1];v++;const Oe=new Array(Me);let tt=0;if(pe&&pe.length!==0){for(let dt=0;dt<Me;dt++){const Ct=te[c]-te[c-1];c++;const Xt=new Array(Ct-1);tt=ie[f]-ie[f-1],f++;const Yt=h.vertexBufferType===Jl.VEC_2?B1(ve,pe,F,tt):U1(ve,pe,F,tt,0,$);F+=tt;for(let rn=0;rn<Xt.length;rn++)tt=ie[f]-ie[f-1],f++,Xt[rn]=h.vertexBufferType===Jl.VEC_2?B1(ve,pe,F,tt):U1(ve,pe,F,tt,0,$),F+=tt;Oe[dt]=S.createPolygon(Yt,Xt)}i[w++]=S.createMultiPolygon(Oe)}else{for(let dt=0;dt<Me;dt++){const Ct=te[c]-te[c-1];c++;const Xt=new Array(Ct-1);tt=ie[f]-ie[f-1],f++;const Yt=N1(ve,I,tt);I+=2*tt;for(let rn=0;rn<Xt.length;rn++){const Mn=ie[f]-ie[f-1];f++,Xt[rn]=N1(ve,I,Mn),I+=2*Mn}Oe[dt]=S.createPolygon(Yt,Xt)}i[w++]=S.createMultiPolygon(Oe)}}}}return i}function N1(h,i,c){return $2(h,i,c,!0)}function B1(h,i,c,f){return V2(h,i,c,f,!0)}function U1(h,i,c,f,v,w){return j2(h,i,c,f,!0,w)}function $2(h,i,c,f){const v=new Array(f?c+1:c);for(let w=0;w<2*c;w+=2)v[w/2]=new m(h[i+w],h[i+w+1]);return f&&(v[v.length-1]=v[0]),v}function V2(h,i,c,f,v){const w=new Array(v?f+1:f);for(let S=0;S<2*f;S+=2){const I=2*i[c+S/2];w[S/2]=new m(h[I],h[I+1])}return v&&(w[w.length-1]=w[0]),w}function j2(h,i,c,f,v,w){const S=new Array(v?f+1:f);for(let I=0;I<f;I++){const F=U2(h[i[c+I]],w.numBits,w.coordinateShift);S[I]=new m(F.x,F.y)}return v&&(S[S.length-1]=S[0]),S}class I3{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(i,c,f,v,w){this._vertexBufferType=i,this._topologyVector=c,this._vertexOffsets=f,this._vertexBuffer=v,this._mortonSettings=w}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const i=A3(this);let c=0;for(;c<this.numGeometries;)yield{coordinates:i[c],type:this.geometryType(c)},c++}getSimpleEncodedVertex(i){const c=this.vertexOffsets?2*this.vertexOffsets[i]:2*i;return[this.vertexBuffer[c],this.vertexBuffer[c+1]]}getVertex(i){if(this.vertexOffsets&&this.mortonSettings){const f=U2(this.vertexBuffer[this.vertexOffsets[i]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[f.x,f.y]}const c=this.vertexOffsets?2*this.vertexOffsets[i]:2*i;return[this.vertexBuffer[c],this.vertexBuffer[c+1]]}getGeometries(){return A3(this)}get mortonSettings(){return this._mortonSettings}}class R3 extends I3{_numGeometries;_geometryType;constructor(i,c,f,v,w,S,I){super(f,v,w,S,I),this._numGeometries=i,this._geometryType=c}geometryType(i){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===Jo.POLYGON||this._geometryType===Jo.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class D3 extends I3{_geometryTypes;constructor(i,c,f,v,w,S){super(i,f,v,w,S),this._geometryTypes=c}geometryType(i){return this._geometryTypes[i]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let i=0;i<this.numGeometries;i++)if(this.geometryType(i)===Jo.POLYGON||this.geometryType(i)===Jo.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class L3{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(i,c,f,v){this._triangleOffsets=i,this._indexBuffer=c,this._vertexBuffer=f,this._topologyVector=v}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const i=new Array(this.numGeometries),c=this._topologyVector,f=c.partOffsets,v=c.ringOffsets,w=c.geometryOffsets;let S=0,I=1,F=1,$=1;for(let G=0;G<this.numGeometries;G++)switch(this.geometryType(G)){case Jo.POLYGON:{const W=f[I]-f[I-1];I++;const te=[];for(let ie=0;ie<W;ie++){const pe=v[F]-v[F-1];F++;const me=[];for(let ve=0;ve<pe;ve++){const Ae=this._vertexBuffer[S++],We=this._vertexBuffer[S++];me.push(new m(Ae,We))}me.length>0&&me.push(me[0]),te.push(me)}i[G]=te,w&&$++}break;case Jo.MULTIPOLYGON:{const W=w[$]-w[$-1];$++;const te=[];for(let ie=0;ie<W;ie++){const pe=f[I]-f[I-1];I++;for(let me=0;me<pe;me++){const ve=v[F]-v[F-1];F++;const Ae=[];for(let We=0;We<ve;We++){const Me=this._vertexBuffer[S++],Oe=this._vertexBuffer[S++];Ae.push(new m(Me,Oe))}Ae.length>0&&Ae.push(Ae[0]),te.push(Ae)}}i[G]=te}}return i}[Symbol.iterator](){return null}}function k3(h,i,c,f,v,w){return new c9(h,i,c,f,v,w)}class c9 extends L3{_numGeometries;_geometryType;constructor(i,c,f,v,w,S){super(f,v,w,S),this._numGeometries=i,this._geometryType=c}geometryType(i){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function z3(h,i,c,f,v){return new u9(h,i,c,f,v)}class u9 extends L3{_geometryTypes;constructor(i,c,f,v,w){super(c,f,v,w),this._geometryTypes=i}geometryType(i){return this._geometryTypes[i]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function h9(h,i,c,f,v){const w=pa(h,c);let S=null,I=null,F=null,$=null;if(F1(w,f,h,c)===so.CONST){const We=B2(h,c,w,!1);let Me=null,Oe=null,tt=null,dt=null;for(let Ct=0;Ct<i-1;Ct++){const Xt=pa(h,c);switch(Xt.physicalStreamType){case As.LENGTH:switch(Xt.logicalStreamType.lengthType){case pl.GEOMETRIES:Me=Sp(h,c,Xt);break;case pl.PARTS:Oe=Sp(h,c,Xt);break;case pl.RINGS:tt=Sp(h,c,Xt);break;case pl.TRIANGLES:dt=Sp(h,c,Xt)}break;case As.OFFSET:switch(Xt.logicalStreamType.offsetType){case ng.VERTEX:S=ma(h,c,Xt,!1);break;case ng.INDEX:$=ma(h,c,Xt,!1)}break;case As.DATA:Hu.VERTEX===Xt.logicalStreamType.dictionaryType?I=ma(h,c,Xt,!0):(F={numBits:Xt.numBits,coordinateShift:Xt.coordinateShift},I=ma(h,c,Xt,!1))}}return $!==null?Me!=null||Oe!=null?k3(f,We,dt,$,I,new bv(Me,Oe,tt)):k3(f,We,dt,$,I):F===null?function(Ct,Xt,Yt,rn,Mn){return new R3(Ct,Xt,Jl.VEC_2,Yt,rn,Mn)}(f,We,new bv(Me,Oe,tt),S,I):function(Ct,Xt,Yt,rn,Mn,ln){return new R3(Ct,Xt,Jl.MORTON,Yt,rn,Mn,ln)}(f,We,new bv(Me,Oe,tt),S,I,F)}const G=ma(h,c,w,!1);let W=null,te=null,ie=null,pe=null;for(let We=0;We<i-1;We++){const Me=pa(h,c);switch(Me.physicalStreamType){case As.LENGTH:switch(Me.logicalStreamType.lengthType){case pl.GEOMETRIES:W=ma(h,c,Me,!1);break;case pl.PARTS:te=ma(h,c,Me,!1);break;case pl.RINGS:ie=ma(h,c,Me,!1);break;case pl.TRIANGLES:pe=Sp(h,c,Me)}break;case As.OFFSET:switch(Me.logicalStreamType.offsetType){case ng.VERTEX:S=ma(h,c,Me,!1);break;case ng.INDEX:$=ma(h,c,Me,!1)}break;case As.DATA:Hu.VERTEX===Me.logicalStreamType.dictionaryType?I=ma(h,c,Me,!0):(F={numBits:Me.numBits,coordinateShift:Me.coordinateShift},I=ma(h,c,Me,!1))}}let me=null,ve=null,Ae=null;return W!==null?(me=H2(G,W,2),te!==null&&ie!==null?(ve=O3(G,me,te,!1),Ae=function(We,Me,Oe,tt){const dt=new Uint32Array(Oe[Oe.length-1]+1);let Ct=0;dt[0]=Ct;let Xt=1,Yt=1,rn=0;for(let Mn=0;Mn<We.length;Mn++){const ln=We[Mn],Kt=Me[Mn+1]-Me[Mn];if(ln!==0&&ln!==3)for(let Bt=0;Bt<Kt;Bt++){const Hn=Oe[Xt]-Oe[Xt-1];Xt++;for(let Xn=0;Xn<Hn;Xn++)Ct=dt[Yt++]=Ct+tt[rn++]}else for(let Bt=0;Bt<Kt;Bt++)dt[Yt++]=++Ct,Xt++}return dt}(G,me,ve,ie)):te!==null&&(ve=function(We,Me,Oe){const tt=new Uint32Array(Me[Me.length-1]+1);let dt=0;tt[0]=dt;let Ct=1,Xt=0;for(let Yt=0;Yt<We.length;Yt++){const rn=We[Yt],Mn=Me[Yt+1]-Me[Yt];if(rn===4||rn===1)for(let ln=0;ln<Mn;ln++)dt=tt[Ct++]=dt+Oe[Xt++];else for(let ln=0;ln<Mn;ln++)tt[Ct++]=++dt}return tt}(G,me,te))):te!==null&&ie!==null?(ve=H2(G,te,1),Ae=O3(G,ve,ie,!0)):te!==null&&(ve=H2(G,te,0)),$!==null&&ve===null?z3(G,pe,$,I):$!==null?z3(G,pe,$,I,new bv(me,ve,Ae)):F===null?function(We,Me,Oe,tt){return new D3(Jl.VEC_2,We,Me,Oe,tt)}(G,new bv(me,ve,Ae),S,I):function(We,Me,Oe,tt,dt){return new D3(Jl.MORTON,We,Me,Oe,tt,dt)}(G,new bv(me,ve,Ae),S,I,F)}function H2(h,i,c){const f=new Uint32Array(h.length+1);let v=0;f[0]=v;let w=0;for(let S=0;S<h.length;S++)v=f[S+1]=v+(h[S]>c?i[w++]:1);return f}function O3(h,i,c,f){const v=new Uint32Array(i[i.length-1]+1);let w=0;v[0]=w;let S=1,I=0;for(let F=0;F<h.length;F++){const $=h[F],G=i[F+1]-i[F];if($===5||$===2||f&&($===4||$===1))for(let W=0;W<G;W++)w=v[S++]=w+c[I++];else for(let W=0;W<G;W++)v[S++]=++w}return v}class d9 extends _v{dataVector;constructor(i,c,f){super(i,c.getBuffer(),f),this.dataVector=c}getValueFromBuffer(i){return this.dataVector.get(i)}}class f9 extends k1{getValueFromBuffer(i){return this.dataBuffer[i]}}class F3 extends _v{constructor(i,c,f){super(i,BigInt64Array.of(c),f)}getValueFromBuffer(i){return this.dataBuffer[0]}}function A0(h,i,c,f,v){const w=function(S,I,F,$){const G=new Uint8Array(I);let W=0;const te=$.get()+F;for(;W<I&&!($.get()>=te);){const ie=S[$.increment()];if(ie<=127){const pe=ie+3,me=S[$.increment()],ve=Math.min(W+pe,I);G.fill(me,W,ve),W=ve}else{const pe=256-ie;for(let me=0;me<pe&&W<I;me++)G[W++]=S[$.increment()]}}return $.set(te),G}(h,Math.ceil(i/8),c,f);return v?function(S,I,F){if(!F)return S;const $=F.size(),G=new Gu(S,I),W=new Gu(new Uint8Array(Math.ceil($/8)),$);let te=0;for(let ie=0;ie<$;ie++){const pe=!!F.get(ie)&&G.get(te++);W.set(ie,pe)}return W.getBuffer()}(w,i,v):w}const p9=new TextDecoder;function G2(h,i,c){return c-i>=12?p9.decode(h.subarray(i,c)):function(f,v,w){let S="",I=v;for(;I<w;){const F=f[I];let $,G,W,te=null,ie=F>239?4:F>223?3:F>191?2:1;if(I+ie>w)break;ie===1?F<128&&(te=F):ie===2?($=f[I+1],(192&$)==128&&(te=(31&F)<<6|63&$,te<=127&&(te=null))):ie===3?($=f[I+1],G=f[I+2],(192&$)==128&&(192&G)==128&&(te=(15&F)<<12|(63&$)<<6|63&G,(te<=2047||te>=55296&&te<=57343)&&(te=null))):ie===4&&($=f[I+1],G=f[I+2],W=f[I+3],(192&$)==128&&(192&G)==128&&(192&W)==128&&(te=(15&F)<<18|(63&$)<<12|(63&G)<<6|63&W,(te<=65535||te>=1114112)&&(te=null))),te===null?(te=65533,ie=1):te>65535&&(te-=65536,S+=String.fromCharCode(te>>>10&1023|55296),te=56320|1023&te),S+=String.fromCharCode(te),I+=ie}return S}(h,i,c)}class W2 extends _v{offsetBuffer;constructor(i,c,f,v){super(i,f,v),this.offsetBuffer=c}}class N3 extends W2{textEncoder;constructor(i,c,f,v){super(i,c,f,v??c.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(i){return G2(this.dataBuffer,this.offsetBuffer[i],this.offsetBuffer[i+1])}}class wv extends W2{indexBuffer;textEncoder;constructor(i,c,f,v,w){super(i,f,v,w??c.length),this.indexBuffer=c,this.indexBuffer=c,this.textEncoder=new TextEncoder}getValueFromBuffer(i){const c=this.indexBuffer[i];return G2(this.dataBuffer,this.offsetBuffer[c],this.offsetBuffer[c+1])}}class B3 extends W2{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(i,c,f,v,w,S,I){super(i,f,v,I),this.indexBuffer=c,this.symbolOffsetBuffer=w,this.symbolTableBuffer=S,this.textEncoder=new TextEncoder}getValueFromBuffer(i){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=function(f,v,w){const S=[],I=new Array(v.length).fill(0);for(let F=1;F<v.length;F++)I[F]=I[F-1]+v[F-1];for(let F=0;F<w.length;F++)if(w[F]===255)S.push(w[++F]);else{const $=v[w[F]],G=I[w[F]];for(let W=0;W<$;W++)S.push(f[G+W])}return new Uint8Array(S)}(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const c=this.indexBuffer[i];return G2(this.decodedDictionary,this.offsetBuffer[c],this.offsetBuffer[c+1])}offsetToLengthBuffer(i){const c=new Uint32Array(i.length-1);let f=i[0];for(let v=1;v<i.length;v++){const w=i[v];c[v-1]=w-f,f=w}return c}}function m9(h,i,c,f,v,w){return c.type==="scalarType"?function(S,I,F,$,G,W){let te=null,ie=0;if(S===0)return null;if(W.nullable){const me=pa(I,F);ie=me.numValues;const ve=F.get(),Ae=A0(I,ie,me.byteLength,F);F.set(ve+me.byteLength),te=new Gu(Ae,me.numValues)}const pe=te??$;switch(G.physicalType){case 4:case 3:return function(me,ve,Ae,We,Me){const Oe=pa(me,ve),tt=F1(Oe,Me,me,ve),dt=We.physicalType===3;if(tt===so.FLAT){const Ct=ma(me,ve,Oe,dt,0,I0(Me)?Me:void 0);return new L2(Ae.name,Ct,Me)}if(tt===so.SEQUENCE){const Ct=w3(me,ve,Oe);return new z2(Ae.name,Ct[0],Ct[1],Oe.numRleValues)}{const Ct=B2(me,ve,Oe,dt);return new O2(Ae.name,Ct,Me)}}(I,F,W,G,pe);case 9:return function(me,ve,Ae,We,Me){let Oe=null,tt=null,dt=null,Ct=null,Xt=null,Yt=null,rn=null,Mn=null;for(let ln=0;ln<We;ln++){const Kt=pa(ve,Ae);if(Kt.byteLength!==0)switch(Kt.physicalStreamType){case As.PRESENT:{const Bt=A0(ve,Kt.numValues,Kt.byteLength,Ae);Yt=new Gu(Bt,Kt.numValues);break}case As.OFFSET:tt=ma(ve,Ae,Kt,!1,0,Me!=null||Yt!=null?Me??Yt:void 0);break;case As.LENGTH:{const Bt=Sp(ve,Ae,Kt);pl.DICTIONARY===Kt.logicalStreamType.lengthType?Oe=Bt:pl.SYMBOL===Kt.logicalStreamType.lengthType?Ct=Bt:rn=Bt;break}case As.DATA:{const Bt=ve.subarray(Ae.get(),Ae.get()+Kt.byteLength);Ae.add(Kt.byteLength);const Hn=Kt.logicalStreamType.dictionaryType;Hu.FSST===Hn?Xt=Bt:Hu.SINGLE===Hn||Hu.SHARED===Hn?dt=Bt:Hu.NONE===Hn&&(Mn=Bt);break}}}return function(ln,Kt,Bt,Hn,Xn,ur,Jn){return Kt?new B3(ln,Bt,Hn,Xn,ur,Kt,Jn):null}(me,Xt,tt,Oe,dt,Ct,Me??Yt)??function(ln,Kt,Bt,Hn,Xn){return Kt?Xn?new wv(ln,Bt,Hn,Kt,Xn):new wv(ln,Bt,Hn,Kt):null}(me,dt,tt,Oe,Me??Yt)??function(ln,Kt,Bt,Hn,Xn){if(!Kt||!Bt)return null;if(Hn)return Xn?new wv(ln,Hn,Kt,Bt,Xn):new wv(ln,Hn,Kt,Bt);if(Xn&&Xn.size()!==Kt.length-1){const ur=new Int32Array(Xn.size());let Jn=0;for(let Mr=0;Mr<Xn.size();Mr++)ur[Mr]=Xn.get(Mr)?Jn++:0;return new wv(ln,ur,Kt,Bt,Xn)}return Xn?new N3(ln,Kt,Bt,Xn):new N3(ln,Kt,Bt)}(me,rn,Mn,tt,Me??Yt)}(W.name,I,F,W.nullable?S-1:S,te);case 0:return function(me,ve,Ae,We,Me){const Oe=pa(me,ve),tt=Oe.numValues,dt=ve.get(),Ct=I0(Me)?Me:void 0,Xt=A0(me,tt,Oe.byteLength,ve,Ct);ve.set(dt+Oe.byteLength);const Yt=new Gu(Xt,tt);return new d9(Ae.name,Yt,Me)}(I,F,W,0,pe);case 6:case 5:return function(me,ve,Ae,We,Me){const Oe=pa(me,ve),tt=F1(Oe,We,me,ve),dt=Me.physicalType===5;if(tt===so.FLAT){const Ct=M3(me,ve,Oe,dt,I0(We)?We:void 0);return new C3(Ae.name,Ct,We)}if(tt===so.SEQUENCE){const Ct=S3(me,ve,Oe);return new T3(Ae.name,Ct[0],Ct[1],Oe.numRleValues)}{const Ct=E3(me,ve,Oe,dt);return new F3(Ae.name,Ct,We)}}(I,F,W,pe,G);case 7:return function(me,ve,Ae,We){const Me=pa(me,ve),Oe=I0(We)?We:void 0,tt=function(dt,Ct,Xt,Yt){const rn=Ct.get(),Mn=rn+Xt*Float32Array.BYTES_PER_ELEMENT,ln=new Uint8Array(dt.subarray(rn,Mn)).buffer,Kt=new Float32Array(ln);return Ct.set(Mn),Yt?z1(Kt,Yt,0):Kt}(me,ve,Me.numValues,Oe);return new f9(Ae.name,tt,We)}(I,F,W,pe);case 8:return function(me,ve,Ae,We){const Me=pa(me,ve),Oe=I0(We)?We:void 0,tt=function(dt,Ct,Xt,Yt){const rn=Ct.get(),Mn=rn+Xt*Float64Array.BYTES_PER_ELEMENT,ln=new Uint8Array(dt.subarray(rn,Mn)).buffer,Kt=new Float64Array(ln);return Ct.set(Mn),Yt?z1(Kt,Yt,0):Kt}(me,ve,Me.numValues,Oe);return new k2(Ae.name,tt,We)}(I,F,W,pe);default:throw new Error(`The specified data type for the field is currently not supported: ${G}`)}}(f,h,i,v,c.scalarType,c):f===0?null:function(S,I,F,$){let G=null,W=null,te=null,ie=null,pe=!1;for(;!pe;){const We=pa(S,I);switch(We.physicalStreamType){case As.LENGTH:pl.DICTIONARY===We.logicalStreamType.lengthType?G=Sp(S,I,We):te=Sp(S,I,We);break;case As.DATA:Hu.SINGLE===We.logicalStreamType.dictionaryType||Hu.SHARED===We.logicalStreamType.dictionaryType?(W=S.subarray(I.get(),I.get()+We.byteLength),pe=!0):ie=S.subarray(I.get(),I.get()+We.byteLength),I.add(We.byteLength)}}const me=F.complexType.children,ve=[];let Ae=0;for(const We of me){const Me=Hs(S,I,1)[0];if(Me==0)continue;const Oe=We.name?`${F.name}${We.name}`:F.name;if(Me!==2||We.type!=="scalarField"||We.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const tt=pa(S,I),dt=A0(S,tt.numValues,tt.byteLength,I),Ct=pa(S,I),Xt=ma(S,I,Ct,!1,0,Ct.decompressedCount!==$?new Gu(dt,tt.numValues):void 0);ve[Ae++]=ie?new B3(Oe,Xt,G,W,te,ie,new Gu(dt,tt.numValues)):new wv(Oe,Xt,G,W,new Gu(dt,tt.numValues))}return ve}(h,i,c,v)}function I0(h){return h instanceof Gu}function U3(h){switch(h){case 0:case 1:case 2:case 3:{const i={};i.nullable=!!(1&h),i.columnScope=0;const c={};return c.physicalType=h>1?6:4,c.type="physicalType",i.scalarType=c,i.type="scalarType",i}case 4:{const i={nullable:!1,columnScope:0},c={type:"physicalType",physicalType:0};return i.type="complexType",i.complexType=c,i}case 30:{const i={nullable:!1,columnScope:0},c={type:"physicalType",physicalType:1};return i.type="complexType",i.complexType=c,i}default:return function(i){let c=null;switch(i){case 10:case 11:c=0;break;case 12:case 13:c=1;break;case 14:case 15:c=2;break;case 16:case 17:c=3;break;case 18:case 19:c=4;break;case 20:case 21:c=5;break;case 22:case 23:c=6;break;case 24:case 25:c=7;break;case 26:case 27:c=8;break;case 28:case 29:c=9;break;default:return null}const f={};f.nullable=!!(1&i),f.columnScope=0;const v={type:"physicalType"};return v.physicalType=c,f.type="scalarType",f.scalarType=v,f}(h)}}function $3(h){return h>=10}function V3(h){return h===30}function g9(h){if(h.name==="id")return!1;if(h.type==="scalarType"){const i=h.scalarType;if(i.type==="physicalType")switch(i.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(i.type==="logicalType")return!1}else if(h.type==="complexType"){const i=h.complexType;if(i.type==="physicalType")switch(i.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",h),!1}const v9=new TextDecoder;function q2(h,i){const c=Hs(h,i,1)[0];if(c===0)return"";const f=i.get(),v=h.subarray(f,f+c);return i.add(c),v9.decode(v)}function j3(h,i){const c=Hs(h,i,1)[0]>>>0;if(c<10||c>30)throw new Error(`Unsupported field type code ${c}. Supported: 10-29(scalars), 30(STRUCT)`);const f=U3(c);if($3(c)&&(f.name=q2(h,i)),V3(c)){const v=Hs(h,i,1)[0]>>>0;f.complexType.children=new Array(v);for(let w=0;w<v;w++)f.complexType.children[w]=j3(h,i)}return function(v){return{name:v.name,nullable:v.nullable,scalarField:v.scalarType,complexField:v.complexType,type:v.type==="scalarType"?"scalarField":"complexField"}}(f)}function y9(h,i){const c=Hs(h,i,1)[0]>>>0,f=U3(c);if(!f)throw new Error(`Unsupported column type code ${c}. Supported: 0-3(ID), 4(GEOMETRY), 10-29(scalars), 30(STRUCT)`);if($3(c)?f.name=q2(h,i):c>=0&&c<=3?f.name="id":c===4&&(f.name="geometry"),V3(c)){const v=Hs(h,i,1)[0]>>>0,w=f.complexType;w.children=new Array(v);for(let S=0;S<v;S++)w.children[S]=j3(h,i)}return f}function _9(h,i){const c={featureTables:[]},f={};f.name=q2(h,i);const v=Hs(h,i,1)[0]>>>0,w=Hs(h,i,1)[0]>>>0;f.columns=new Array(w);for(let S=0;S<w;S++)f.columns[S]=y9(h,i);return c.featureTables.push(f),[c,v]}function x9(h,i,c,f,v,w,S=!1){const I=i.scalarType.physicalType,F=F1(v,w,h,c);if(I===4)switch(F){case so.FLAT:{const $=ma(h,c,v,!1);return new L2(f,$,w)}case so.SEQUENCE:{const $=w3(h,c,v);return new z2(f,$[0],$[1],v.numRleValues)}case so.CONST:{const $=B2(h,c,v,!1);return new O2(f,$,w)}}else switch(F){case so.FLAT:{if(S){const G=function(W,te,ie){const pe=function(me,ve,Ae){const We=new Float64Array(Ae);for(let Me=0;Me<Ae;Me++)We[Me]=a9(me,ve);return We}(W,te,ie.numValues);return function(me,ve){switch(ve.logicalLevelTechnique1){case ai.DELTA:return ve.logicalLevelTechnique2===ai.RLE&&(me=x3(me,ve.runs,ve.numRleValues)),function(Ae){Ae[0]=xv(Ae[0]);const We=Ae.length/4*4;let Me=1;if(We>=4)for(;Me<We-4;Me+=4){const Oe=Ae[Me+1],tt=Ae[Me+2],dt=Ae[Me+3];Ae[Me]=xv(Ae[Me])+Ae[Me-1],Ae[Me+1]=xv(Oe)+Ae[Me],Ae[Me+2]=xv(tt)+Ae[Me+1],Ae[Me+3]=xv(dt)+Ae[Me+2]}for(;Me!=Ae.length;++Me)Ae[Me]=xv(Ae[Me])+Ae[Me-1]}(me),me;case ai.RLE:return function(Ae,We){return x3(Ae,We.runs,We.numRleValues)}(me,ve);case ai.NONE:return me;default:throw new Error(`The specified Logical level technique is not supported: ${ve.logicalLevelTechnique1}`)}}(pe,ie)}(h,c,v);return new k2(f,G,w)}const $=M3(h,c,v,!1);return new C3(f,$,w)}case so.SEQUENCE:{const $=S3(h,c,v);return new T3(f,$[0],$[1],v.numRleValues)}case so.CONST:{const $=E3(h,c,v,!1);return new F3(f,$,w)}}throw new Error("Vector type not supported for id column.")}class b9{constructor(i,c){var f;switch(this._featureData=i,this.properties=this._featureData.properties||{},(f=this._featureData.geometry)===null||f===void 0?void 0:f.type){case Jo.POINT:case Jo.MULTIPOINT:this.type=1;break;case Jo.LINESTRING:case Jo.MULTILINESTRING:this.type=2;break;case Jo.POLYGON:case Jo.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=c,this.id=Number(this._featureData.id)}loadGeometry(){const i=[];for(const c of this._featureData.geometry.coordinates){const f=[];for(const v of c)f.push(new m(v.x,v.y));i.push(f)}return i}}class w9{constructor(i){this.features=[],this.featureTable=i,this.name=i.name,this.extent=i.extent,this.version=2,this.features=i.getFeatures(),this.length=this.features.length}feature(i){return new b9(this.features[i],this.extent)}}class H3{constructor(i){this.layers={};const c=function(f,v,w=!0){const S=new o9(0),I=[];for(;S.get()<f.length;){const F=Hs(f,S,1)[0]>>>0,$=S.get()+F;if($>f.length)throw new Error(`Block overruns tile: ${$} > ${f.length}`);if(Hs(f,S,1)[0]>>>0!=1){S.set($);continue}const G=_9(f,S),W=G[1],te=G[0].featureTables[0];let ie=null,pe=null;const me=[];let ve=0;for(const We of te.columns){const Me=We.name;if(Me==="id"){let Oe=null;if(We.nullable){const dt=pa(f,S),Ct=S.get(),Xt=A0(f,dt.numValues,dt.byteLength,S);S.set(Ct+dt.byteLength),Oe=new Gu(Xt,dt.numValues)}const tt=pa(f,S);ve=tt.decompressedCount,ie=x9(f,We,S,Me,tt,Oe??ve,w)}else if(Me==="geometry"){const Oe=Hs(f,S,1)[0];if(ve===0){const tt=S.get();ve=pa(f,S).decompressedCount,S.set(tt)}pe=h9(f,Oe,S,ve)}else{const Oe=g9(We)?Hs(f,S,1)[0]:1;if(Oe===0)continue;const tt=m9(f,S,We,Oe,ve);if(tt)if(Array.isArray(tt))for(const dt of tt)me.push(dt);else me.push(tt)}}const Ae=new i9(te.name,pe,ie,me,W);I.push(Ae),S.set($)}return I}(new Uint8Array(i));this.layers=c.reduce((f,v)=>Object.assign(Object.assign({},f),{[v.name]:new w9(v)}),{})}}class S9{constructor(i,c){this.feature=i,this.type=i.type,this.properties=i.tags?i.tags:{},this.extent=c,"id"in i&&(typeof i.id=="string"?this.id=parseInt(i.id,10):typeof i.id!="number"||isNaN(i.id)||(this.id=i.id))}loadGeometry(){const i=[],c=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const f of c){const v=[];for(const w of f)v.push(new m(w[0],w[1]));i.push(v)}return i}}const R0="_geojsonTileLayer";function M9(h,i){i.writeVarintField(15,h.version||1),i.writeStringField(1,h.name||""),i.writeVarintField(5,h.extent||4096);const c={keys:[],values:[],keycache:{},valuecache:{}};for(let w=0;w<h.length;w++)c.feature=h.feature(w),i.writeMessage(2,E9,c);const f=c.keys;for(const w of f)i.writeStringField(3,w);const v=c.values;for(const w of v)i.writeMessage(4,P9,w)}function E9(h,i){if(!h.feature)return;const c=h.feature;c.id!==void 0&&i.writeVarintField(1,c.id),i.writeMessage(2,C9,h),i.writeVarintField(3,c.type),i.writeMessage(4,T9,c)}function C9(h,i){for(const c in h.feature?.properties){let f=h.feature.properties[c],v=h.keycache[c];if(f==null)continue;v===void 0&&(h.keys.push(c),v=h.keys.length-1,h.keycache[c]=v),i.writeVarint(v),typeof f!="string"&&typeof f!="boolean"&&typeof f!="number"&&(f=JSON.stringify(f));const w=typeof f+":"+f;let S=h.valuecache[w];S===void 0&&(h.values.push(f),S=h.values.length-1,h.valuecache[w]=S),i.writeVarint(S)}}function X2(h,i){return(i<<3)+(7&h)}function G3(h){return h<<1^h>>31}function T9(h,i){const c=h.loadGeometry(),f=h.type;let v=0,w=0;for(const S of c){let I=1;f===1&&(I=S.length),i.writeVarint(X2(1,I));const F=f===3?S.length-1:S.length;for(let $=0;$<F;$++){$===1&&f!==1&&i.writeVarint(X2(2,F-1));const G=S[$].x-v,W=S[$].y-w;i.writeVarint(G3(G)),i.writeVarint(G3(W)),v+=G,w+=W}h.type===3&&i.writeVarint(X2(7,1))}}function P9(h,i){const c=typeof h;c==="string"?i.writeStringField(1,h):c==="boolean"?i.writeBooleanField(7,h):c==="number"&&(h%1!=0?i.writeDoubleField(3,h):h<0?i.writeSVarintField(6,h):i.writeVarintField(5,h))}class W3{constructor(i,c){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new ws(Ue,16,0),this.grid3D=new ws(Ue,16,0),this.featureIndexArray=new be,this.promoteId=c}insert(i,c,f,v,w,S){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,v,w);const F=S?this.grid3D:this.grid;for(let $=0;$<c.length;$++){const G=c[$],W=[1/0,1/0,-1/0,-1/0];for(let te=0;te<G.length;te++){const ie=G[te];W[0]=Math.min(W[0],ie.x),W[1]=Math.min(W[1],ie.y),W[2]=Math.max(W[2],ie.x),W[3]=Math.max(W[3],ie.y)}W[0]<Ue&&W[1]<Ue&&W[2]>=0&&W[3]>=0&&F.insert(I,W[0],W[1],W[2],W[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new v1(new p(this.rawTileData)).layers:new H3(this.rawTileData).layers,this.sourceLayerCoder=new p3(this.vtLayers?Object.keys(this.vtLayers).sort():[R0])),this.vtLayers}query(i,c,f,v){this.loadVTLayers();const w=i.params,S=Ue/i.tileSize/i.scale,I=Mu(w.filter,w.globalState),F=i.queryGeometry,$=i.queryPadding*S,G=tg.fromPoints(F),W=this.grid.query(G.minX-$,G.minY-$,G.maxX+$,G.maxY+$),te=tg.fromPoints(i.cameraQueryGeometry).expandBy($),ie=this.grid3D.query(te.minX,te.minY,te.maxX,te.maxY,(ve,Ae,We,Me)=>function(Oe,tt,dt,Ct,Xt){for(const rn of Oe)if(tt<=rn.x&&dt<=rn.y&&Ct>=rn.x&&Xt>=rn.y)return!0;const Yt=[new m(tt,dt),new m(tt,Xt),new m(Ct,Xt),new m(Ct,dt)];if(Oe.length>2){for(const rn of Yt)if(Nu(Oe,rn))return!0}for(let rn=0;rn<Oe.length-1;rn++)if(Bu(Oe[rn],Oe[rn+1],Yt))return!0;return!1}(i.cameraQueryGeometry,ve-$,Ae-$,We+$,Me+$));for(const ve of ie)W.push(ve);W.sort(A9);const pe={};let me;for(let ve=0;ve<W.length;ve++){const Ae=W[ve];if(Ae===me)continue;me=Ae;const We=this.featureIndexArray.get(Ae);let Me=null;this.loadMatchingFeature(pe,We.bucketIndex,We.sourceLayerIndex,We.featureIndex,I,w.layers,w.availableImages,c,f,v,(Oe,tt,dt)=>(Me||(Me=cl(Oe)),tt.queryIntersectsFeature({queryGeometry:F,feature:Oe,featureState:dt,geometry:Me,zoom:this.z,transform:i.transform,pixelsToTileUnits:S,pixelPosMatrix:i.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:i.getElevation})))}return pe}loadMatchingFeature(i,c,f,v,w,S,I,F,$,G,W){const te=this.bucketLayerIDs[c];if(S&&!te.some(ve=>S.has(ve)))return;const ie=this.sourceLayerCoder.decode(f),pe=this.vtLayers[ie].feature(v);if(w.needGeometry){const ve=Wl(pe,!0);if(!w.filter(new Jr(this.tileID.overscaledZ),ve,this.tileID.canonical))return}else if(!w.filter(new Jr(this.tileID.overscaledZ),pe))return;const me=this.getId(pe,ie);for(let ve=0;ve<te.length;ve++){const Ae=te[ve];if(S&&!S.has(Ae))continue;const We=F[Ae];if(!We)continue;let Me={};me&&G&&(Me=G.getState(We.sourceLayer||R0,me));const Oe=et({},$[Ae]);Oe.paint=q3(Oe.paint,We.paint,pe,Me,I),Oe.layout=q3(Oe.layout,We.layout,pe,Me,I);const tt=!W||W(pe,We,Me);if(!tt)continue;const dt=new m3(pe,this.z,this.x,this.y,me);dt.layer=Oe;let Ct=i[Ae];Ct===void 0&&(Ct=i[Ae]=[]),Ct.push({featureIndex:v,feature:dt,intersectionZ:tt})}}lookupSymbolFeatures(i,c,f,v,w,S,I,F){const $={};this.loadVTLayers();const G=Mu(w.filterSpec,w.globalState);for(const W of i)this.loadMatchingFeature($,f,v,W,G,S,I,F,c);return $}hasLayer(i){for(const c of this.bucketLayerIDs)for(const f of c)if(i===f)return!0;return!1}getId(i,c){var f;let v=i.id;return this.promoteId&&(v=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[c]],typeof v=="boolean"&&(v=Number(v)),v===void 0&&(!((f=i.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(v=Number(i.properties.cluster_id))),v}}function q3(h,i,c,f,v){return Tt(h,(w,S)=>{const I=i instanceof tl?i.get(S):null;return I&&I.evaluate?I.evaluate(c,f,v):I})}function A9(h,i){return i-h}function X3(h,i,c,f,v){const w=[];for(let S=0;S<h.length;S++){const I=h[S];let F;for(let $=0;$<I.length-1;$++){let G=I[$],W=I[$+1];G.x<i&&W.x<i||(G.x<i?G=new m(i,G.y+(i-G.x)/(W.x-G.x)*(W.y-G.y))._round():W.x<i&&(W=new m(i,G.y+(i-G.x)/(W.x-G.x)*(W.y-G.y))._round()),G.y<c&&W.y<c||(G.y<c?G=new m(G.x+(c-G.y)/(W.y-G.y)*(W.x-G.x),c)._round():W.y<c&&(W=new m(G.x+(c-G.y)/(W.y-G.y)*(W.x-G.x),c)._round()),G.x>=f&&W.x>=f||(G.x>=f?G=new m(f,G.y+(f-G.x)/(W.x-G.x)*(W.y-G.y))._round():W.x>=f&&(W=new m(f,G.y+(f-G.x)/(W.x-G.x)*(W.y-G.y))._round()),G.y>=v&&W.y>=v||(G.y>=v?G=new m(G.x+(v-G.y)/(W.y-G.y)*(W.x-G.x),v)._round():W.y>=v&&(W=new m(G.x+(v-G.y)/(W.y-G.y)*(W.x-G.x),v)._round()),F&&G.equals(F[F.length-1])||(F=[G],w.push(F)),F.push(W)))))}}return w}function Z3(h,i,c,f,v){switch(i){case 1:return function(w,S,I,F){const $=[];for(const G of w)for(const W of G){const te=F===0?W.x:W.y;te>=S&&te<=I&&$.push([W])}return $}(h,c,f,v);case 2:return Y3(h,c,f,v,!1);case 3:return Y3(h,c,f,v,!0)}return[]}function I9(h,i,c,f,v){const w=f===0?R9:D9;let S=[];const I=[];for(let G=0;G<h.length-1;G++){const W=h[G],te=h[G+1],ie=f===0?W.x:W.y,pe=f===0?te.x:te.y;let me=!1;ie<i?pe>i&&S.push(w(W,te,i)):ie>c?pe<c&&S.push(w(W,te,c)):S.push(W),pe<i&&ie>=i&&(S.push(w(W,te,i)),me=!0),pe>c&&ie<=c&&(S.push(w(W,te,c)),me=!0),!v&&me&&(I.push(S),S=[])}const F=h.length-1,$=f===0?h[F].x:h[F].y;return $>=i&&$<=c&&S.push(h[F]),v&&S.length>0&&!S[0].equals(S[S.length-1])&&S.push(new m(S[0].x,S[0].y)),S.length>0&&I.push(S),I}function Y3(h,i,c,f,v){const w=[];for(const S of h){const I=I9(S,i,c,f,v);I.length>0&&w.push(...I)}return w}function R9(h,i,c){return new m(c,h.y+(c-h.x)/(i.x-h.x)*(i.y-h.y))}function D9(h,i,c){return new m(h.x+(c-h.y)/(i.y-h.y)*(i.x-h.x),c)}Nn("FeatureIndex",W3,{omit:["rawTileData","sourceLayerCoder"]});class Mp extends m{constructor(i,c,f,v){super(i,c),this.angle=f,v!==void 0&&(this.segment=v)}clone(){return new Mp(this.x,this.y,this.angle,this.segment)}}function K3(h,i,c,f,v){if(i.segment===void 0||c===0)return!0;let w=i,S=i.segment+1,I=0;for(;I>-c/2;){if(S--,S<0)return!1;I-=h[S].dist(w),w=h[S]}I+=h[S].dist(h[S+1]),S++;const F=[];let $=0;for(;I<c/2;){const G=h[S],W=h[S+1];if(!W)return!1;let te=h[S-1].angleTo(G)-G.angleTo(W);for(te=Math.abs((te+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:I,angleDelta:te}),$+=te;I-F[0].distance>f;)$-=F.shift().angleDelta;if($>v)return!1;S++,I+=G.dist(W)}return!0}function J3(h){let i=0;for(let c=0;c<h.length-1;c++)i+=h[c].dist(h[c+1]);return i}function Q3(h,i,c){return h?.6*i*c:0}function eD(h,i){return Math.max(h?h.right-h.left:0,i?i.right-i.left:0)}function L9(h,i,c,f,v,w){const S=Q3(c,v,w),I=eD(c,f)*w;let F=0;const $=J3(h)/2;for(let G=0;G<h.length-1;G++){const W=h[G],te=h[G+1],ie=W.dist(te);if(F+ie>$){const pe=($-F)/ie,me=Ai.number(W.x,te.x,pe),ve=Ai.number(W.y,te.y,pe),Ae=new Mp(me,ve,te.angleTo(W),G);return Ae._round(),!S||K3(h,Ae,I,S,i)?Ae:void 0}F+=ie}}function k9(h,i,c,f,v,w,S,I,F){const $=Q3(f,w,S),G=eD(f,v),W=G*S,te=h[0].x===0||h[0].x===F||h[0].y===0||h[0].y===F;return i-W<i/4&&(i=W+i/4),tD(h,te?i/2*I%i:(G/2+2*w)*S*I%i,i,$,c,W,te,!1,F)}function tD(h,i,c,f,v,w,S,I,F){const $=w/2,G=J3(h);let W=0,te=i-c,ie=[];for(let pe=0;pe<h.length-1;pe++){const me=h[pe],ve=h[pe+1],Ae=me.dist(ve),We=ve.angleTo(me);for(;te+c<W+Ae;){te+=c;const Me=(te-W)/Ae,Oe=Ai.number(me.x,ve.x,Me),tt=Ai.number(me.y,ve.y,Me);if(Oe>=0&&Oe<F&&tt>=0&&tt<F&&te-$>=0&&te+$<=G){const dt=new Mp(Oe,tt,We,pe);dt._round(),f&&!K3(h,dt,w,f,v)||ie.push(dt)}}W+=Ae}return I||ie.length||S||(ie=tD(h,W/2,c,f,v,w,S,!0,F)),ie}function nD(h,i,c,f){const v=[],w=h.image,S=w.pixelRatio,I=w.paddedRect.w-2,F=w.paddedRect.h-2;let $={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom};const G=w.stretchX||[[0,I]],W=w.stretchY||[[0,F]],te=(Bt,Hn)=>Bt+Hn[1]-Hn[0],ie=G.reduce(te,0),pe=W.reduce(te,0),me=I-ie,ve=F-pe;let Ae=0,We=ie,Me=0,Oe=pe,tt=0,dt=me,Ct=0,Xt=ve;if(w.content&&f){const Bt=w.content,Hn=Bt[2]-Bt[0],Xn=Bt[3]-Bt[1];(w.textFitWidth||w.textFitHeight)&&($=I1(h)),Ae=$1(G,0,Bt[0]),Me=$1(W,0,Bt[1]),We=$1(G,Bt[0],Bt[2]),Oe=$1(W,Bt[1],Bt[3]),tt=Bt[0]-Ae,Ct=Bt[1]-Me,dt=Hn-We,Xt=Xn-Oe}const Yt=$.x1,rn=$.y1,Mn=$.x2-Yt,ln=$.y2-rn,Kt=(Bt,Hn,Xn,ur)=>{const Jn=V1(Bt.stretch-Ae,We,Mn,Yt),Mr=j1(Bt.fixed-tt,dt,Bt.stretch,ie),ji=V1(Hn.stretch-Me,Oe,ln,rn),Ao=j1(Hn.fixed-Ct,Xt,Hn.stretch,pe),Rs=V1(Xn.stretch-Ae,We,Mn,Yt),Hc=j1(Xn.fixed-tt,dt,Xn.stretch,ie),ga=V1(ur.stretch-Me,Oe,ln,rn),fs=j1(ur.fixed-Ct,Xt,ur.stretch,pe),Ds=new m(Jn,ji),ao=new m(Rs,ji),ps=new m(Rs,ga),Gs=new m(Jn,ga),Ws=new m(Mr/S,Ao/S),Ua=new m(Hc/S,fs/S),Ls=i*Math.PI/180;if(Ls){const Qo=Math.sin(Ls),qi=Math.cos(Ls),Io=[qi,-Qo,Qo,qi];Ds._matMult(Io),ao._matMult(Io),Gs._matMult(Io),ps._matMult(Io)}const $a=Bt.stretch+Bt.fixed,Gc=Hn.stretch+Hn.fixed;return{tl:Ds,tr:ao,bl:Gs,br:ps,tex:{x:w.paddedRect.x+1+$a,y:w.paddedRect.y+1+Gc,w:Xn.stretch+Xn.fixed-$a,h:ur.stretch+ur.fixed-Gc},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ws,pixelOffsetBR:Ua,minFontScaleX:dt/S/Mn,minFontScaleY:Xt/S/ln,isSDF:c}};if(f&&(w.stretchX||w.stretchY)){const Bt=rD(G,me,ie),Hn=rD(W,ve,pe);for(let Xn=0;Xn<Bt.length-1;Xn++){const ur=Bt[Xn],Jn=Bt[Xn+1];for(let Mr=0;Mr<Hn.length-1;Mr++)v.push(Kt(ur,Hn[Mr],Jn,Hn[Mr+1]))}}else v.push(Kt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:F+1}));return v}function $1(h,i,c){let f=0;for(const v of h)f+=Math.max(i,Math.min(c,v[1]))-Math.max(i,Math.min(c,v[0]));return f}function rD(h,i,c){const f=[{fixed:-1,stretch:0}];for(const[v,w]of h){const S=f[f.length-1];f.push({fixed:v-S.stretch,stretch:S.stretch}),f.push({fixed:v-S.stretch,stretch:S.stretch+(w-v)})}return f.push({fixed:i+1,stretch:c}),f}function V1(h,i,c,f){return h/i*c+f}function j1(h,i,c,f){return h-i*c/f}Nn("Anchor",Mp);class H1{constructor(i,c,f,v,w,S,I,F,$,G){var W;if(this.boxStartIndex=i.length,$){let te=S.top,ie=S.bottom;const pe=S.collisionPadding;pe&&(te-=pe[1],ie+=pe[3]);let me=ie-te;me>0&&(me=Math.max(10,me),this.circleDiameter=me)}else{const te=!((W=S.image)===null||W===void 0)&&W.content&&(S.image.textFitWidth||S.image.textFitHeight)?I1(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};te.y1=te.y1*I-F[0],te.y2=te.y2*I+F[2],te.x1=te.x1*I-F[3],te.x2=te.x2*I+F[1];const ie=S.collisionPadding;if(ie&&(te.x1-=ie[0]*I,te.y1-=ie[1]*I,te.x2+=ie[2]*I,te.y2+=ie[3]*I),G){const pe=new m(te.x1,te.y1),me=new m(te.x2,te.y1),ve=new m(te.x1,te.y2),Ae=new m(te.x2,te.y2),We=G*Math.PI/180;pe._rotate(We),me._rotate(We),ve._rotate(We),Ae._rotate(We),te.x1=Math.min(pe.x,me.x,ve.x,Ae.x),te.x2=Math.max(pe.x,me.x,ve.x,Ae.x),te.y1=Math.min(pe.y,me.y,ve.y,Ae.y),te.y2=Math.max(pe.y,me.y,ve.y,Ae.y)}i.emplaceBack(c.x,c.y,te.x1,te.y1,te.x2,te.y2,f,v,w)}this.boxEndIndex=i.length}}class z9{constructor(i=[],c=(f,v)=>f<v?-1:f>v?1:0){if(this.data=i,this.length=this.data.length,this.compare=c,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:c,compare:f}=this,v=c[i];for(;i>0;){const w=i-1>>1,S=c[w];if(f(v,S)>=0)break;c[i]=S,i=w}c[i]=v}_down(i){const{data:c,compare:f}=this,v=this.length>>1,w=c[i];for(;i<v;){let S=1+(i<<1);const I=S+1;if(I<this.length&&f(c[I],c[S])<0&&(S=I),f(c[S],w)>=0)break;c[i]=c[S],i=S}c[i]=w}}function O9(h,i=1,c=!1){const f=tg.fromPoints(h[0]),v=Math.min(f.width(),f.height());let w=v/2;const S=new z9([],F9),{minX:I,minY:F,maxX:$,maxY:G}=f;if(v===0)return new m(I,F);for(let ie=I;ie<$;ie+=v)for(let pe=F;pe<G;pe+=v)S.push(new Sv(ie+w,pe+w,w,h));let W=function(ie){let pe=0,me=0,ve=0;const Ae=ie[0];for(let We=0,Me=Ae.length,Oe=Me-1;We<Me;Oe=We++){const tt=Ae[We],dt=Ae[Oe],Ct=tt.x*dt.y-dt.x*tt.y;me+=(tt.x+dt.x)*Ct,ve+=(tt.y+dt.y)*Ct,pe+=3*Ct}return new Sv(me/pe,ve/pe,0,ie)}(h),te=S.length;for(;S.length;){const ie=S.pop();(ie.d>W.d||!W.d)&&(W=ie,c&&console.log("found best %d after %d probes",Math.round(1e4*ie.d)/1e4,te)),ie.max-W.d<=i||(w=ie.h/2,S.push(new Sv(ie.p.x-w,ie.p.y-w,w,h)),S.push(new Sv(ie.p.x+w,ie.p.y-w,w,h)),S.push(new Sv(ie.p.x-w,ie.p.y+w,w,h)),S.push(new Sv(ie.p.x+w,ie.p.y+w,w,h)),te+=4)}return c&&(console.log(`num probes: ${te}`),console.log(`best distance: ${W.d}`)),W.p}function F9(h,i){return i.max-h.max}function Sv(h,i,c,f){this.p=new m(h,i),this.h=c,this.d=function(v,w){let S=!1,I=1/0;for(let F=0;F<w.length;F++){const $=w[F];for(let G=0,W=$.length,te=W-1;G<W;te=G++){const ie=$[G],pe=$[te];ie.y>v.y!=pe.y>v.y&&v.x<(pe.x-ie.x)*(v.y-ie.y)/(pe.y-ie.y)+ie.x&&(S=!S),I=Math.min(I,rv(v,ie,pe))}}return(S?1:-1)*Math.sqrt(I)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Is;u.aP=void 0,(Is=u.aP||(u.aP={}))[Is.center=1]="center",Is[Is.left=2]="left",Is[Is.right=3]="right",Is[Is.top=4]="top",Is[Is.bottom=5]="bottom",Is[Is["top-left"]=6]="top-left",Is[Is["top-right"]=7]="top-right",Is[Is["bottom-left"]=8]="bottom-left",Is[Is["bottom-right"]=9]="bottom-right";const Z2=Number.POSITIVE_INFINITY;function iD(h,i){return i[1]!==Z2?function(c,f,v){let w=0,S=0;switch(f=Math.abs(f),v=Math.abs(v),c){case"top-right":case"top-left":case"top":S=v-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-v}switch(c){case"top-right":case"bottom-right":case"right":w=-f;break;case"top-left":case"bottom-left":case"left":w=f}return[w,S]}(h,i[0],i[1]):function(c,f){let v=0,w=0;f<0&&(f=0);const S=f/Math.SQRT2;switch(c){case"top-right":case"top-left":w=S-7;break;case"bottom-right":case"bottom-left":w=7-S;break;case"bottom":w=7-f;break;case"top":w=f-7}switch(c){case"top-right":case"bottom-right":v=-S;break;case"top-left":case"bottom-left":v=S;break;case"left":v=f;break;case"right":v=-f}return[v,w]}(h,i[0])}function oD(h,i,c){var f;const v=h.layout,w=(f=v.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(i,{},c);if(w){const I=w.values,F=[];for(let $=0;$<I.length;$+=2){const G=F[$]=I[$],W=I[$+1].map(te=>te*Po);G.startsWith("top")?W[1]-=7:G.startsWith("bottom")&&(W[1]+=7),F[$+1]=W}return new os(F)}const S=v.get("text-variable-anchor");if(S){let I;I=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[v.get("text-radial-offset").evaluate(i,{},c)*Po,Z2]:v.get("text-offset").evaluate(i,{},c).map($=>$*Po);const F=[];for(const $ of S)F.push($,iD($,I));return new os(F)}return null}function Y2(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function N9(h,i,c,f,v,w,S,I,F,$,G,W){let te=w.textMaxSize.evaluate(i,{});te===void 0&&(te=S);const ie=h.layers[0].layout,pe=ie.get("icon-offset").evaluate(i,{},G),me=aD(c.horizontal),ve=S/24,Ae=h.tilePixelRatio*ve,We=h.tilePixelRatio*te/24,Me=h.tilePixelRatio*I,Oe=h.tilePixelRatio*ie.get("symbol-spacing"),tt=ie.get("text-padding")*h.tilePixelRatio,dt=function(Xn,ur,Jn,Mr=1){const ji=Xn.get("icon-padding").evaluate(ur,{},Jn),Ao=ji&&ji.values;return[Ao[0]*Mr,Ao[1]*Mr,Ao[2]*Mr,Ao[3]*Mr]}(ie,i,G,h.tilePixelRatio),Ct=ie.get("text-max-angle")/180*Math.PI,Xt=ie.get("text-rotation-alignment")!=="viewport"&&ie.get("symbol-placement")!=="point",Yt=ie.get("icon-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",rn=ie.get("symbol-placement"),Mn=Oe/2,ln=ie.get("icon-text-fit");let Kt;f&&ln!=="none"&&(h.allowVerticalPlacement&&c.vertical&&(Kt=JR(f,c.vertical,ln,ie.get("icon-text-fit-padding"),pe,ve)),me&&(f=JR(f,me,ln,ie.get("icon-text-fit-padding"),pe,ve)));const Bt=G?W.line.getGranularityForZoomLevel(G.z):1,Hn=(Xn,ur)=>{ur.x<0||ur.x>=Ue||ur.y<0||ur.y>=Ue||function(Jn,Mr,ji,Ao,Rs,Hc,ga,fs,Ds,ao,ps,Gs,Ws,Ua,Ls,$a,Gc,Qo,qi,Io,Ji,es,Xd,Wu,k0){const Ep=Jn.addToLineVertexArray(Mr,ji);let rg,Mv,Ev,Cv,hD=0,dD=0,fD=0,pD=0,iM=-1,oM=-1;const Zd={};let mD=qr("");if(Jn.allowVerticalPlacement&&Ao.vertical){const qs=fs.layout.get("text-rotate").evaluate(Ji,{},Wu)+90;Ev=new H1(Ds,Mr,ao,ps,Gs,Ao.vertical,Ws,Ua,Ls,qs),ga&&(Cv=new H1(Ds,Mr,ao,ps,Gs,ga,Gc,Qo,Ls,qs))}if(Rs){const qs=fs.layout.get("icon-rotate").evaluate(Ji,{}),Ql=fs.layout.get("icon-text-fit")!=="none",ig=nD(Rs,qs,Xd,Ql),Xu=ga?nD(ga,qs,Xd,Ql):void 0;Mv=new H1(Ds,Mr,ao,ps,Gs,Rs,Gc,Qo,!1,qs),hD=4*ig.length;const og=Jn.iconSizeData;let $h=null;og.kind==="source"?($h=[qd*fs.layout.get("icon-size").evaluate(Ji,{})],$h[0]>xp&&Ke(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):og.kind==="composite"&&($h=[qd*es.compositeIconSizes[0].evaluate(Ji,{},Wu),qd*es.compositeIconSizes[1].evaluate(Ji,{},Wu)],($h[0]>xp||$h[1]>xp)&&Ke(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Jn.addSymbols(Jn.icon,ig,$h,Io,qi,Ji,u.az.none,Mr,Ep.lineStartIndex,Ep.lineLength,-1,Wu),iM=Jn.icon.placedSymbolArray.length-1,Xu&&(dD=4*Xu.length,Jn.addSymbols(Jn.icon,Xu,$h,Io,qi,Ji,u.az.vertical,Mr,Ep.lineStartIndex,Ep.lineLength,-1,Wu),oM=Jn.icon.placedSymbolArray.length-1)}const gD=Object.keys(Ao.horizontal);for(const qs of gD){const Ql=Ao.horizontal[qs];if(!rg){mD=qr(Ql.text);const Xu=fs.layout.get("text-rotate").evaluate(Ji,{},Wu);rg=new H1(Ds,Mr,ao,ps,Gs,Ql,Ws,Ua,Ls,Xu)}const ig=Ql.positionedLines.length===1;if(fD+=sD(Jn,Mr,Ql,Hc,fs,Ls,Ji,$a,Ep,Ao.vertical?u.az.horizontal:u.az.horizontalOnly,ig?gD:[qs],Zd,iM,es,Wu),ig)break}Ao.vertical&&(pD+=sD(Jn,Mr,Ao.vertical,Hc,fs,Ls,Ji,$a,Ep,u.az.vertical,["vertical"],Zd,oM,es,Wu));const $9=rg?rg.boxStartIndex:Jn.collisionBoxArray.length,V9=rg?rg.boxEndIndex:Jn.collisionBoxArray.length,j9=Ev?Ev.boxStartIndex:Jn.collisionBoxArray.length,H9=Ev?Ev.boxEndIndex:Jn.collisionBoxArray.length,G9=Mv?Mv.boxStartIndex:Jn.collisionBoxArray.length,W9=Mv?Mv.boxEndIndex:Jn.collisionBoxArray.length,q9=Cv?Cv.boxStartIndex:Jn.collisionBoxArray.length,X9=Cv?Cv.boxEndIndex:Jn.collisionBoxArray.length;let qu=-1;const W1=(qs,Ql)=>qs&&qs.circleDiameter?Math.max(qs.circleDiameter,Ql):Ql;qu=W1(rg,qu),qu=W1(Ev,qu),qu=W1(Mv,qu),qu=W1(Cv,qu);const vD=qu>-1?1:0;vD&&(qu*=k0/Po),Jn.glyphOffsetArray.length>=vv.MAX_GLYPHS&&Ke("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ji.sortKey!==void 0&&Jn.addToSortKeyRanges(Jn.symbolInstances.length,Ji.sortKey);const Z9=oD(fs,Ji,Wu),[Y9,K9]=function(qs,Ql){const ig=qs.length,Xu=Ql?.values;if(Xu?.length>0)for(let og=0;og<Xu.length;og+=2){const $h=Xu[og+1];qs.emplaceBack(u.aP[Xu[og]],$h[0],$h[1])}return[ig,qs.length]}(Jn.textAnchorOffsets,Z9);Jn.symbolInstances.emplaceBack(Mr.x,Mr.y,Zd.right>=0?Zd.right:-1,Zd.center>=0?Zd.center:-1,Zd.left>=0?Zd.left:-1,Zd.vertical||-1,iM,oM,mD,$9,V9,j9,H9,G9,W9,q9,X9,ao,fD,pD,hD,dD,vD,0,Ws,qu,Y9,K9)}(h,ur,Xn,c,f,v,Kt,h.layers[0],h.collisionBoxArray,i.index,i.sourceLayerIndex,h.index,Ae,[tt,tt,tt,tt],Xt,F,Me,dt,Yt,pe,i,w,$,G,S)};if(rn==="line")for(const Xn of X3(i.geometry,0,0,Ue,Ue)){const ur=fa(Xn,Bt),Jn=k9(ur,Oe,Ct,c.vertical||me,f,24,We,h.overscaling,Ue);for(const Mr of Jn)me&&B9(h,me.text,Mn,Mr)||Hn(ur,Mr)}else if(rn==="line-center"){for(const Xn of i.geometry)if(Xn.length>1){const ur=fa(Xn,Bt),Jn=L9(ur,Ct,c.vertical||me,f,24,We);Jn&&Hn(ur,Jn)}}else if(i.type==="Polygon")for(const Xn of _d(i.geometry,0)){const ur=O9(Xn,16);Hn(fa(Xn[0],Bt,!0),new Mp(ur.x,ur.y,0))}else if(i.type==="LineString")for(const Xn of i.geometry){const ur=fa(Xn,Bt);Hn(ur,new Mp(ur[0].x,ur[0].y,0))}else if(i.type==="Point")for(const Xn of i.geometry)for(const ur of Xn)Hn([ur],new Mp(ur.x,ur.y,0))}function sD(h,i,c,f,v,w,S,I,F,$,G,W,te,ie,pe){const me=function(We,Me,Oe,tt,dt,Ct,Xt,Yt){const rn=tt.layout.get("text-rotate").evaluate(Ct,{})*Math.PI/180,Mn=[];for(const ln of Me.positionedLines)for(const Kt of ln.positionedGlyphs){if(!Kt.rect)continue;const Bt=Kt.rect||{};let Hn=4,Xn=!0,ur=1,Jn=0;const Mr=(dt||Yt)&&Kt.vertical,ji=Kt.metrics.advance*Kt.scale/2;if(Yt&&Me.verticalizable&&(Jn=ln.lineOffset/2-(Kt.imageName?-(Po-Kt.metrics.width*Kt.scale)/2:(Kt.scale-1)*Po)),Kt.imageName){const Qo=Xt[Kt.imageName];Xn=Qo.sdf,ur=Qo.pixelRatio,Hn=1/ur}const Ao=dt?[Kt.x+ji,Kt.y]:[0,0];let Rs=dt?[0,0]:[Kt.x+ji+Oe[0],Kt.y+Oe[1]-Jn],Hc=[0,0];Mr&&(Hc=Rs,Rs=[0,0]);const ga=Kt.metrics.isDoubleResolution?2:1,fs=(Kt.metrics.left-Hn)*Kt.scale-ji+Rs[0],Ds=(-Kt.metrics.top-Hn)*Kt.scale+Rs[1],ao=fs+Bt.w/ga*Kt.scale/ur,ps=Ds+Bt.h/ga*Kt.scale/ur,Gs=new m(fs,Ds),Ws=new m(ao,Ds),Ua=new m(fs,ps),Ls=new m(ao,ps);if(Mr){const Qo=new m(-ji,ji- -17),qi=-Math.PI/2,Io=12-ji,Ji=new m(22-Io,-(Kt.imageName?Io:0)),es=new m(...Hc);Gs._rotateAround(qi,Qo)._add(Ji)._add(es),Ws._rotateAround(qi,Qo)._add(Ji)._add(es),Ua._rotateAround(qi,Qo)._add(Ji)._add(es),Ls._rotateAround(qi,Qo)._add(Ji)._add(es)}if(rn){const Qo=Math.sin(rn),qi=Math.cos(rn),Io=[qi,-Qo,Qo,qi];Gs._matMult(Io),Ws._matMult(Io),Ua._matMult(Io),Ls._matMult(Io)}const $a=new m(0,0),Gc=new m(0,0);Mn.push({tl:Gs,tr:Ws,bl:Ua,br:Ls,tex:Bt,writingMode:Me.writingMode,glyphOffset:Ao,sectionIndex:Kt.sectionIndex,isSDF:Xn,pixelOffsetTL:$a,pixelOffsetBR:Gc,minFontScaleX:0,minFontScaleY:0})}return Mn}(0,c,I,v,w,S,f,h.allowVerticalPlacement),ve=h.textSizeData;let Ae=null;ve.kind==="source"?(Ae=[qd*v.layout.get("text-size").evaluate(S,{})],Ae[0]>xp&&Ke(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ve.kind==="composite"&&(Ae=[qd*ie.compositeTextSizes[0].evaluate(S,{},pe),qd*ie.compositeTextSizes[1].evaluate(S,{},pe)],(Ae[0]>xp||Ae[1]>xp)&&Ke(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),h.addSymbols(h.text,me,Ae,I,w,S,$,i,F.lineStartIndex,F.lineLength,te,pe);for(const We of G)W[We]=h.text.placedSymbolArray.length-1;return 4*me.length}function aD(h){for(const i in h)return h[i];return null}function B9(h,i,c,f){const v=h.compareText;if(i in v){const w=v[i];for(let S=w.length-1;S>=0;S--)if(f.dist(w[S])<c)return!0}else v[i]=[];return v[i].push(f),!1}const lD=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class K2{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,f]=new Uint8Array(i,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=f>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const w=lD[15&f];if(!w)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(i,2,1),[I]=new Uint32Array(i,4,1);return new K2(I,S,w,i)}constructor(i,c=64,f=Float64Array,v){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=f,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const w=lD.indexOf(this.ArrayType),S=2*i*this.ArrayType.BYTES_PER_ELEMENT,I=i*this.IndexArrayType.BYTES_PER_ELEMENT,F=(8-I%8)%8;if(w<0)throw new Error(`Unexpected typed array class: ${f}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+I+F,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+S+I+F),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+I+F,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+w]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=i)}add(i,c){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=i,this.coords[this._pos++]=c,f}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return J2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,c,f,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:w,coords:S,nodeSize:I}=this,F=[0,w.length-1,0],$=[];for(;F.length;){const G=F.pop()||0,W=F.pop()||0,te=F.pop()||0;if(W-te<=I){for(let ve=te;ve<=W;ve++){const Ae=S[2*ve],We=S[2*ve+1];Ae>=i&&Ae<=f&&We>=c&&We<=v&&$.push(w[ve])}continue}const ie=te+W>>1,pe=S[2*ie],me=S[2*ie+1];pe>=i&&pe<=f&&me>=c&&me<=v&&$.push(w[ie]),(G===0?i<=pe:c<=me)&&(F.push(te),F.push(ie-1),F.push(1-G)),(G===0?f>=pe:v>=me)&&(F.push(ie+1),F.push(W),F.push(1-G))}return $}within(i,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:w,nodeSize:S}=this,I=[0,v.length-1,0],F=[],$=f*f;for(;I.length;){const G=I.pop()||0,W=I.pop()||0,te=I.pop()||0;if(W-te<=S){for(let ve=te;ve<=W;ve++)uD(w[2*ve],w[2*ve+1],i,c)<=$&&F.push(v[ve]);continue}const ie=te+W>>1,pe=w[2*ie],me=w[2*ie+1];uD(pe,me,i,c)<=$&&F.push(v[ie]),(G===0?i-f<=pe:c-f<=me)&&(I.push(te),I.push(ie-1),I.push(1-G)),(G===0?i+f>=pe:c+f>=me)&&(I.push(ie+1),I.push(W),I.push(1-G))}return F}}function J2(h,i,c,f,v,w){if(v-f<=c)return;const S=f+v>>1;cD(h,i,S,f,v,w),J2(h,i,c,f,S-1,1-w),J2(h,i,c,S+1,v,1-w)}function cD(h,i,c,f,v,w){for(;v>f;){if(v-f>600){const $=v-f+1,G=c-f+1,W=Math.log($),te=.5*Math.exp(2*W/3),ie=.5*Math.sqrt(W*te*($-te)/$)*(G-$/2<0?-1:1);cD(h,i,c,Math.max(f,Math.floor(c-G*te/$+ie)),Math.min(v,Math.floor(c+($-G)*te/$+ie)),w)}const S=i[2*c+w];let I=f,F=v;for(D0(h,i,f,c),i[2*v+w]>S&&D0(h,i,f,v);I<F;){for(D0(h,i,I,F),I++,F--;i[2*I+w]<S;)I++;for(;i[2*F+w]>S;)F--}i[2*f+w]===S?D0(h,i,f,F):(F++,D0(h,i,F,v)),F<=c&&(f=F+1),c<=F&&(v=F-1)}}function D0(h,i,c,f){Q2(h,c,f),Q2(i,2*c,2*f),Q2(i,2*c+1,2*f+1)}function Q2(h,i,c){const f=h[i];h[i]=h[c],h[c]=f}function uD(h,i,c,f){const v=h-c,w=i-f;return v*v+w*w}var eM;u.cI=void 0,(eM=u.cI||(u.cI={})).create="create",eM.load="load",eM.fullLoad="fullLoad";let G1=null,L0=[];const tM=1e3/60,nM="loadTime",rM="fullLoadTime",U9={mark(h){performance.mark(h)},recordStartOfFrameAt(h){G1!=null&&L0.push(h-G1),G1=h},resetRuntimeMetrics(){G1=null,L0=[]},clearInitializationMetrics(){performance.clearMeasures(nM),performance.clearMeasures(rM);for(const h in u.cI)performance.clearMarks(u.cI[h])},remove(){this.resetRuntimeMetrics(),this.clearInitializationMetrics()},getPerformanceMetrics(){performance.measure(nM,u.cI.create,u.cI.load),performance.measure(rM,u.cI.create,u.cI.fullLoad);const h=performance.getEntriesByName(nM)[0].duration,i=performance.getEntriesByName(rM)[0].duration,c=L0.length;return{loadTimeMs:h,fullLoadTimeMs:i,averageFramesPerSecond:1/(L0.reduce((f,v)=>f+v,0)/c/1e3),virtualDroppedFramesCount:L0.filter(f=>f>tM).reduce((f,v)=>f+(v-tM)/tM,0),totalFramesCount:c}}};u.$=P,u.A=U,u.B=ca,u.C=$i,u.D=Vn,u.E=je,u.F=function([h,i,c]){return i+=90,i*=Math.PI/180,c*=Math.PI/180,{x:h*Math.cos(i)*Math.sin(c),y:h*Math.sin(i)*Math.sin(c),z:h*Math.cos(c)}},u.G=Ai,u.H=Jr,u.I=Yi,u.J=Ld,u.K=function(h){if(on==null){const i=h.navigator?h.navigator.userAgent:null;on=!!h.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return on},u.L=class{constructor(h,i){this.target=h,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new t9(()=>this.process()),this.subscription=bt(this.target,"message",c=>this.receive(c),!1),this.globalScope=Gt(self)?h:window}registerMessageHandler(h,i){this.messageHandlers[h]=i}unregisterMessageHandler(h){delete this.messageHandlers[h]}sendAsync(h,i){return new Promise((c,f)=>{const v=Math.round(1e18*Math.random()).toString(36).substring(0,10),w=i?bt(i.signal,"abort",()=>{w?.unsubscribe(),delete this.resolveRejects[v];const F={id:v,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)},n9):null;this.resolveRejects[v]={resolve:F=>{w?.unsubscribe(),c(F)},reject:F=>{w?.unsubscribe(),f(F)}};const S=[],I=Object.assign(Object.assign({},h),{id:v,sourceMapId:this.mapId,origin:location.origin,data:Fo(h.data,S)});this.target.postMessage(I,{transfer:S})})}receive(h){const i=h.data,c=i.id;if(!(i.origin!=="file://"&&location.origin!=="file://"&&i.origin!=="resource://android"&&location.origin!=="resource://android"&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if(i.type==="<cancel>"){delete this.tasks[c];const f=this.abortControllers[c];return delete this.abortControllers[c],void(f&&f.abort())}if(Gt(self)||i.mustQueue)return this.tasks[c]=i,this.taskQueue.push(c),void this.invoker.trigger();this.processTask(c,i)}}process(){if(this.taskQueue.length===0)return;const h=this.taskQueue.shift(),i=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(h,i)}processTask(h,i){return s(this,void 0,void 0,function*(){if(i.type==="<response>"){const v=this.resolveRejects[h];return delete this.resolveRejects[h],v?void(i.error?v.reject(No(i.error)):v.resolve(No(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const c=No(i.data),f=new AbortController;this.abortControllers[h]=f;try{const v=yield this.messageHandlers[i.type](i.sourceMapId,c,f);this.completeTask(h,null,v)}catch(v){this.completeTask(h,v)}})}completeTask(h,i,c){const f=[];delete this.abortControllers[h];const v={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?Fo(i):null,data:Fo(c,f)};this.target.postMessage(v,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},u.M=oe,u.N=function(){var h=new U(16);return U!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},u.O=function(h,i,c){var f,v,w,S,I,F,$,G,W,te,ie,pe,me=c[0],ve=c[1],Ae=c[2];return i===h?(h[12]=i[0]*me+i[4]*ve+i[8]*Ae+i[12],h[13]=i[1]*me+i[5]*ve+i[9]*Ae+i[13],h[14]=i[2]*me+i[6]*ve+i[10]*Ae+i[14],h[15]=i[3]*me+i[7]*ve+i[11]*Ae+i[15]):(v=i[1],w=i[2],S=i[3],I=i[4],F=i[5],$=i[6],G=i[7],W=i[8],te=i[9],ie=i[10],pe=i[11],h[0]=f=i[0],h[1]=v,h[2]=w,h[3]=S,h[4]=I,h[5]=F,h[6]=$,h[7]=G,h[8]=W,h[9]=te,h[10]=ie,h[11]=pe,h[12]=f*me+I*ve+W*Ae+i[12],h[13]=v*me+F*ve+te*Ae+i[13],h[14]=w*me+$*ve+ie*Ae+i[14],h[15]=S*me+G*ve+pe*Ae+i[15]),h},u.P=m,u.Q=function(h,i,c){var f=c[0],v=c[1],w=c[2];return h[0]=i[0]*f,h[1]=i[1]*f,h[2]=i[2]*f,h[3]=i[3]*f,h[4]=i[4]*v,h[5]=i[5]*v,h[6]=i[6]*v,h[7]=i[7]*v,h[8]=i[8]*w,h[9]=i[9]*w,h[10]=i[10]*w,h[11]=i[11]*w,h[12]=i[12],h[13]=i[13],h[14]=i[14],h[15]=i[15],h},u.R=Ts,u.S=function(h,i,c){var f=i[0],v=i[1],w=i[2],S=i[3],I=i[4],F=i[5],$=i[6],G=i[7],W=i[8],te=i[9],ie=i[10],pe=i[11],me=i[12],ve=i[13],Ae=i[14],We=i[15],Me=c[0],Oe=c[1],tt=c[2],dt=c[3];return h[0]=Me*f+Oe*I+tt*W+dt*me,h[1]=Me*v+Oe*F+tt*te+dt*ve,h[2]=Me*w+Oe*$+tt*ie+dt*Ae,h[3]=Me*S+Oe*G+tt*pe+dt*We,h[4]=(Me=c[4])*f+(Oe=c[5])*I+(tt=c[6])*W+(dt=c[7])*me,h[5]=Me*v+Oe*F+tt*te+dt*ve,h[6]=Me*w+Oe*$+tt*ie+dt*Ae,h[7]=Me*S+Oe*G+tt*pe+dt*We,h[8]=(Me=c[8])*f+(Oe=c[9])*I+(tt=c[10])*W+(dt=c[11])*me,h[9]=Me*v+Oe*F+tt*te+dt*ve,h[10]=Me*w+Oe*$+tt*ie+dt*Ae,h[11]=Me*S+Oe*G+tt*pe+dt*We,h[12]=(Me=c[12])*f+(Oe=c[13])*I+(tt=c[14])*W+(dt=c[15])*me,h[13]=Me*v+Oe*F+tt*te+dt*ve,h[14]=Me*w+Oe*$+tt*ie+dt*Ae,h[15]=Me*S+Oe*G+tt*pe+dt*We,h},u.T=Na,u.U=function(h,i){const c={};for(let f=0;f<i.length;f++){const v=i[f];v in h&&(c[v]=h[v])}return c},u.V=bp,u.W=ot,u.X=a3,u.Y=s3,u.Z=Fn,u._=s,u.a=qt,u.a$=H,u.a0=O,u.a1=dn,u.a2=fl,u.a3=c3,u.a4=L1,u.a5=Ue,u.a6=function(h,i,c){if(!h)return i||{};if(!i)return h||{};const f=f3(h),v=f3(i);(function(S,I){I.removeAll&&(S.add.clear(),S.update.clear(),S.remove.clear(),I.remove.clear());for(const F of I.remove)S.add.delete(F),S.update.delete(F);for(const[F,$]of I.update){const G=S.update.get(F);G&&(I.update.set(F,r9(G,$)),S.update.delete(F))}})(f,v);const w={};if((f.removeAll||v.removeAll)&&(w.removeAll=!0),w.remove=new Set([...f.remove,...v.remove]),w.add=new Map([...f.add,...v.add]),w.update=new Map([...f.update,...v.update]),w.remove.size&&w.add.size)for(const S of w.add.keys())w.remove.delete(S);return function(S){const I={};return S.removeAll&&(I.removeAll=S.removeAll),S.remove&&(I.remove=Array.from(S.remove)),S.add&&(I.add=Array.from(S.add.values())),S.update&&(I.update=Array.from(S.update.values())),I}(w)},u.a7=function(h,i){const c=new Map;if(h==null||h.type==null)return c;if(h.type==="Feature"){const f=D2(h,i);return f==null?void 0:(c.set(f,h),c)}if(h.type==="FeatureCollection"){const f=new Set;for(const v of h.features){const w=D2(v,i);if(w==null||f.has(w))return;f.add(w),c.set(w,v)}return c}},u.a8=function(h,i,c){var f,v;const w=[];if(i.removeAll)h.clear();else if(i.remove)for(const S of i.remove){const I=h.get(S);I&&(w.push(I.geometry),h.delete(S))}if(i.add)for(const S of i.add){const I=D2(S,c);if(I==null)continue;const F=h.get(I);F&&w.push(F.geometry),w.push(S.geometry),h.set(I,S)}if(i.update)for(const S of i.update){const I=h.get(S.id);if(!I)continue;const F=!!S.newGeometry,$=S.removeAllProperties||((f=S.removeProperties)===null||f===void 0?void 0:f.length)>0||((v=S.addOrUpdateProperties)===null||v===void 0?void 0:v.length)>0;if(!F&&!$)continue;w.push(I.geometry);const G=Object.assign({},I);if(h.set(S.id,G),F&&(w.push(S.newGeometry),G.geometry=S.newGeometry),$){if(G.properties=S.removeAllProperties?{}:Object.assign({},G.properties||{}),S.removeProperties)for(const W of S.removeProperties)delete G.properties[W];if(S.addOrUpdateProperties)for(const{key:W,value:te}of S.addOrUpdateProperties)G.properties[W]=te}}return w},u.a9=P0,u.aA=function(h,{uSize:i,uSizeT:c},{lowerSize:f,upperSize:v}){return h.kind==="source"?f/qd:h.kind==="composite"?Ai.number(f/qd,v/qd,c):i},u.aB=function(h,i){var c=i[0],f=i[1],v=i[2],w=i[3],S=i[4],I=i[5],F=i[6],$=i[7],G=i[8],W=i[9],te=i[10],ie=i[11],pe=i[12],me=i[13],ve=i[14],Ae=i[15],We=c*I-f*S,Me=c*F-v*S,Oe=c*$-w*S,tt=f*F-v*I,dt=f*$-w*I,Ct=v*$-w*F,Xt=G*me-W*pe,Yt=G*ve-te*pe,rn=G*Ae-ie*pe,Mn=W*ve-te*me,ln=W*Ae-ie*me,Kt=te*Ae-ie*ve,Bt=We*Kt-Me*ln+Oe*Mn+tt*rn-dt*Yt+Ct*Xt;return Bt?(h[0]=(I*Kt-F*ln+$*Mn)*(Bt=1/Bt),h[1]=(v*ln-f*Kt-w*Mn)*Bt,h[2]=(me*Ct-ve*dt+Ae*tt)*Bt,h[3]=(te*dt-W*Ct-ie*tt)*Bt,h[4]=(F*rn-S*Kt-$*Yt)*Bt,h[5]=(c*Kt-v*rn+w*Yt)*Bt,h[6]=(ve*Oe-pe*Ct-Ae*Me)*Bt,h[7]=(G*Ct-te*Oe+ie*Me)*Bt,h[8]=(S*ln-I*rn+$*Xt)*Bt,h[9]=(f*rn-c*ln-w*Xt)*Bt,h[10]=(pe*dt-me*Oe+Ae*We)*Bt,h[11]=(W*Oe-G*dt-ie*We)*Bt,h[12]=(I*Yt-S*Mn-F*Xt)*Bt,h[13]=(c*Mn-f*Yt+v*Xt)*Bt,h[14]=(me*Me-pe*tt-ve*We)*Bt,h[15]=(G*tt-W*Me+te*We)*Bt,h):null},u.aC=Ie,u.aD=function(h){var i=h[0],c=h[1];return Math.sqrt(i*i+c*c)},u.aE=function(h){return h[0]=0,h[1]=0,h},u.aF=function(h,i,c){return h[0]=i[0]*c,h[1]=i[1]*c,h},u.aG=C2,u.aH=Ze,u.aI=function(h,i,c,f){const v=i.y-h.y,w=i.x-h.x,S=f.y-c.y,I=f.x-c.x,F=S*w-I*v;if(F===0)return null;const $=(I*(h.y-c.y)-S*(h.x-c.x))/F;return new m(h.x+$*w,h.y+$*v)},u.aJ=X3,u.aK=Ah,u.aL=function(h){let i=1/0,c=1/0,f=-1/0,v=-1/0;for(const w of h)i=Math.min(i,w.x),c=Math.min(c,w.y),f=Math.max(f,w.x),v=Math.max(v,w.y);return[i,c,f,v]},u.aM=Po,u.aN=nt,u.aO=function(h,i,c,f,v=!1){if(!c[0]&&!c[1])return[0,0];const w=v?f==="map"?-h.bearingInRadians:0:f==="viewport"?h.bearingInRadians:0;if(w){const S=Math.sin(w),I=Math.cos(w);c=[c[0]*I-c[1]*S,c[0]*S+c[1]*I]}return[v?c[0]:nt(i,c[0],h.zoom),v?c[1]:nt(i,c[1],h.zoom)]},u.aQ=E2,u.aR=Y2,u.aS=zn,u.aT=K2,u.aU=Vi,u.aV=zh,u.aW=ze,u.aX=Dn,u.aY=Dt,u.aZ=jt,u.a_=u3,u.aa=tg,u.ab=25,u.ac=R2,u.ad=h=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(c=>{i.onloadstart=()=>{c(i)};for(const f of h){const v=window.document.createElement("source");Ye(f)||(i.crossOrigin="Anonymous"),v.src=f,i.appendChild(v)}})},u.ae=ft,u.af=function(){return Mt++},u.ag=x,u.ah=vv,u.ai=R0,u.aj=Mu,u.ak=Wl,u.al=m3,u.am=function(h){const i={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,f,v,w)=>{const S=v||w;return i[f]=!S||S.toLowerCase(),""}),i["max-age"]){const c=parseInt(i["max-age"],10);isNaN(c)?delete i["max-age"]:i["max-age"]=c}return i},u.an=_t,u.ao=85.051129,u.ap=Nt,u.aq=function(h){return Math.pow(2,h)},u.ar=K,u.as=l3,u.at=function(h){return Math.log(h)/Math.LN2},u.au=function(h){var i=h[0],c=h[1];return i*i+c*c},u.av=function(h){if(!h.length)return new Set;const i=Math.max(...h.map(F=>F.canonical.z));let c=1/0,f=-1/0,v=1/0,w=-1/0;const S=[];for(const F of h){const{x:$,y:G,z:W}=F.canonical,te=Math.pow(2,i-W),ie=$*te,pe=G*te;S.push({id:F,x:ie,y:pe}),ie<c&&(c=ie),ie>f&&(f=ie),pe<v&&(v=pe),pe>w&&(w=pe)}const I=new Set;for(const F of S)F.x!==c&&F.x!==f&&F.y!==v&&F.y!==w||I.add(F.id);return I},u.aw=function(h,i){const c=Math.abs(2*h.wrap)-+(h.wrap<0),f=Math.abs(2*i.wrap)-+(i.wrap<0);return h.overscaledZ-i.overscaledZ||f-c||i.canonical.y-h.canonical.y||i.canonical.x-h.canonical.x},u.ax=class{constructor(h,i){this.max=h,this.onRemove=i,this.reset()}reset(){for(const h in this.data)for(const i of this.data[h])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(h,i,c){const f=h.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const v={value:i,timeout:void 0};if(c!==void 0&&(v.timeout=setTimeout(()=>{this.remove(h,v)},c)),this.data[f].push(v),this.order.push(f),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(h){return h.wrapped().key in this.data}getAndRemove(h){return this.has(h)?this._getAndRemoveByKey(h.wrapped().key):null}_getAndRemoveByKey(h){const i=this.data[h].shift();return i.timeout&&clearTimeout(i.timeout),this.data[h].length===0&&delete this.data[h],this.order.splice(this.order.indexOf(h),1),i.value}getByKey(h){const i=this.data[h];return i?i[0].value:null}get(h){return this.has(h)?this.data[h.wrapped().key][0].value:null}remove(h,i){if(!this.has(h))return this;const c=h.wrapped().key,f=i===void 0?0:this.data[c].indexOf(i),v=this.data[c][f];return this.data[c].splice(f,1),v.timeout&&clearTimeout(v.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(v.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(h){for(this.max=h;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(h){const i=[];for(const c in this.data)for(const f of this.data[c])h(f.value)||i.push(f);for(const c of i)this.remove(c.value.tileID,c)}},u.ay=function(h,i){let c=0,f=0;if(h.kind==="constant")f=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:v,minZoom:w,maxZoom:S}=h,I=v?_t(So.interpolationFactor(v,i,w,S),0,1):0;h.kind==="camera"?f=Ai.number(h.minSize,h.maxSize,I):c=I}return{uSizeT:c,uSize:f}},u.b=Wt,u.b$=Hl,u.b0=ne,u.b1=function(h){var i=new U(3);return i[0]=h[0],i[1]=h[1],i[2]=h[2],i},u.b2=function(h,i,c){return h[0]=i[0]-c[0],h[1]=i[1]-c[1],h[2]=i[2]-c[2],h},u.b3=function(h,i){var c=i[0],f=i[1],v=i[2],w=c*c+f*f+v*v;return w>0&&(w=1/Math.sqrt(w)),h[0]=i[0]*w,h[1]=i[1]*w,h[2]=i[2]*w,h},u.b4=de,u.b5=function(h,i){return h[0]*i[0]+h[1]*i[1]+h[2]*i[2]},u.b6=function(h,i,c){return h[0]=i[0]*c[0],h[1]=i[1]*c[1],h[2]=i[2]*c[2],h[3]=i[3]*c[3],h},u.b7=J,u.b8=function(h,i,c){const f=i[0]*c[0]+i[1]*c[1]+i[2]*c[2];return f===0?null:(-(h[0]*c[0]+h[1]*c[1]+h[2]*c[2])-c[3])/f},u.b9=Pe,u.bA=function(){return new Float64Array(3)},u.bB=Te,u.bC=function(h,i,c){var f=c[0],v=c[1],w=c[2],S=c[3],I=i[0],F=i[1],$=i[2],G=v*$-w*F,W=w*I-f*$,te=f*F-v*I;return h[0]=I+S*(G+=G)+v*(te+=te)-w*(W+=W),h[1]=F+S*W+w*G-f*te,h[2]=$+S*te+f*W-v*G,h},u.bD=function(h,i,c){const f=(v=[h[0],h[1],h[2],i[0],i[1],i[2],c[0],c[1],c[2]])[0]*((G=v[8])*(S=v[4])-(I=v[5])*($=v[7]))+v[1]*(-G*(w=v[3])+I*(F=v[6]))+v[2]*($*w-S*F);var v,w,S,I,F,$,G;if(f===0)return null;const W=de([],[i[0],i[1],i[2]],[c[0],c[1],c[2]]),te=de([],[c[0],c[1],c[2]],[h[0],h[1],h[2]]),ie=de([],[h[0],h[1],h[2]],[i[0],i[1],i[2]]),pe=H([],W,-h[3]);return ne(pe,pe,H([],te,-i[3])),ne(pe,pe,H([],ie,-c[3])),H(pe,pe,1/f),pe},u.bE=I2,u.bF=function(){return new Float64Array(4)},u.bG=function(h,i,c,f){var v=[],w=[];return v[0]=i[0]-c[0],v[1]=i[1]-c[1],v[2]=i[2]-c[2],w[0]=v[0]*Math.cos(f)-v[1]*Math.sin(f),w[1]=v[0]*Math.sin(f)+v[1]*Math.cos(f),w[2]=v[2],h[0]=w[0]+c[0],h[1]=w[1]+c[1],h[2]=w[2]+c[2],h},u.bH=function(h,i,c,f){var v=[],w=[];return v[0]=i[0]-c[0],v[1]=i[1]-c[1],v[2]=i[2]-c[2],w[0]=v[0],w[1]=v[1]*Math.cos(f)-v[2]*Math.sin(f),w[2]=v[1]*Math.sin(f)+v[2]*Math.cos(f),h[0]=w[0]+c[0],h[1]=w[1]+c[1],h[2]=w[2]+c[2],h},u.bI=function(h,i,c,f){var v=[],w=[];return v[0]=i[0]-c[0],v[1]=i[1]-c[1],v[2]=i[2]-c[2],w[0]=v[2]*Math.sin(f)+v[0]*Math.cos(f),w[1]=v[1],w[2]=v[2]*Math.cos(f)-v[0]*Math.sin(f),h[0]=w[0]+c[0],h[1]=w[1]+c[1],h[2]=w[2]+c[2],h},u.bJ=function(h,i,c){var f=Math.sin(c),v=Math.cos(c),w=i[0],S=i[1],I=i[2],F=i[3],$=i[8],G=i[9],W=i[10],te=i[11];return i!==h&&(h[4]=i[4],h[5]=i[5],h[6]=i[6],h[7]=i[7],h[12]=i[12],h[13]=i[13],h[14]=i[14],h[15]=i[15]),h[0]=w*v-$*f,h[1]=S*v-G*f,h[2]=I*v-W*f,h[3]=F*v-te*f,h[8]=w*f+$*v,h[9]=S*f+G*v,h[10]=I*f+W*v,h[11]=F*f+te*v,h},u.bK=function(h,i){const c=Le(h,360),f=Le(i,360),v=f-c,w=f>c?v-360:v+360;return Math.abs(v)<Math.abs(w)?v:w},u.bL=function(h){return h[0]=0,h[1]=0,h[2]=0,h},u.bM=function(h,i,c,f){const v=Math.sqrt(h*h+i*i),w=Math.sqrt(c*c+f*f);h/=v,i/=v,c/=w,f/=w;const S=Math.acos(h*c+i*f);return-i*c+h*f>0?S:-S},u.bN=function(h,i){const c=Le(h,2*Math.PI),f=Le(i,2*Math.PI);return Math.min(Math.abs(c-f),Math.abs(c-f+2*Math.PI),Math.abs(c-f-2*Math.PI))},u.bO=function(){const h={},i=De.$version;for(const c in De.$root){const f=De.$root[c];if(f.required){let v=null;v=c==="version"?i:f.type==="array"?[]:{},v!=null&&(h[c]=v)}}return h},u.bP=he,u.bQ=_i,u.bR=function h(i,c){if(Array.isArray(i)){if(!Array.isArray(c)||i.length!==c.length)return!1;for(let f=0;f<i.length;f++)if(!h(i[f],c[f]))return!1;return!0}if(typeof i=="object"&&i!==null&&c!==null){if(typeof c!="object"||Object.keys(i).length!==Object.keys(c).length)return!1;for(const f in i)if(!h(i[f],c[f]))return!1;return!0}return i===c},u.bS=function(h){h=h.slice();const i=Object.create(null);for(let c=0;c<h.length;c++)i[h[c].id]=h[c];for(let c=0;c<h.length;c++)"ref"in h[c]&&(h[c]=fn(h[c],i[h[c].ref]));return h},u.bT=function(h,i){if(h.type==="custom")return new e9(h,i);switch(h.type){case"background":return new Qj(h,i);case"circle":return new dp(h,i);case"color-relief":return new x2(h,i);case"fill":return new m1(h,i);case"fill-extrusion":return new w2(h,i);case"heatmap":return new f0(h,i);case"hillshade":return new Ih(h,i);case"line":return new E0(h,i);case"raster":return new Nc(h,i);case"symbol":return new D1(h,i)}},u.bU=h=>h.type==="raster",u.bV=en,u.bW=function(h,i){if(!h)return[{command:"setStyle",args:[i]}];let c=[];try{if(!sn(h.version,i.version))return[{command:"setStyle",args:[i]}];sn(h.center,i.center)||c.push({command:"setCenter",args:[i.center]}),sn(h.state,i.state)||c.push({command:"setGlobalState",args:[i.state]}),sn(h.centerAltitude,i.centerAltitude)||c.push({command:"setCenterAltitude",args:[i.centerAltitude]}),sn(h.zoom,i.zoom)||c.push({command:"setZoom",args:[i.zoom]}),sn(h.bearing,i.bearing)||c.push({command:"setBearing",args:[i.bearing]}),sn(h.pitch,i.pitch)||c.push({command:"setPitch",args:[i.pitch]}),sn(h.roll,i.roll)||c.push({command:"setRoll",args:[i.roll]}),sn(h.sprite,i.sprite)||c.push({command:"setSprite",args:[i.sprite]}),sn(h.glyphs,i.glyphs)||c.push({command:"setGlyphs",args:[i.glyphs]}),sn(h.transition,i.transition)||c.push({command:"setTransition",args:[i.transition]}),sn(h.light,i.light)||c.push({command:"setLight",args:[i.light]}),sn(h.terrain,i.terrain)||c.push({command:"setTerrain",args:[i.terrain]}),sn(h.sky,i.sky)||c.push({command:"setSky",args:[i.sky]}),sn(h.projection,i.projection)||c.push({command:"setProjection",args:[i.projection]});const f={},v=[];(function(S,I,F,$){let G;for(G in I=I||{},S=S||{})Object.prototype.hasOwnProperty.call(S,G)&&(Object.prototype.hasOwnProperty.call(I,G)||Zn(G,F,$));for(G in I)Object.prototype.hasOwnProperty.call(I,G)&&(Object.prototype.hasOwnProperty.call(S,G)?sn(S[G],I[G])||(S[G].type==="geojson"&&I[G].type==="geojson"&&Ar(S,I,G)?Jt(F,{command:"setGeoJSONSourceData",args:[G,I[G].data]}):yr(G,I,F,$)):cn(G,I,F))})(h.sources,i.sources,v,f);const w=[];h.layers&&h.layers.forEach(S=>{"source"in S&&f[S.source]?c.push({command:"removeLayer",args:[S.id]}):w.push(S)}),c=c.concat(v),function(S,I,F){I=I||[];const $=(S=S||[]).map(gt),G=I.map(gt),W=S.reduce(St,{}),te=I.reduce(St,{}),ie=$.slice(),pe=Object.create(null);let me,ve,Ae,We,Me;for(let Oe=0,tt=0;Oe<$.length;Oe++)me=$[Oe],Object.prototype.hasOwnProperty.call(te,me)?tt++:(Jt(F,{command:"removeLayer",args:[me]}),ie.splice(ie.indexOf(me,tt),1));for(let Oe=0,tt=0;Oe<G.length;Oe++)me=G[G.length-1-Oe],ie[ie.length-1-Oe]!==me&&(Object.prototype.hasOwnProperty.call(W,me)?(Jt(F,{command:"removeLayer",args:[me]}),ie.splice(ie.lastIndexOf(me,ie.length-tt),1)):tt++,We=ie[ie.length-Oe],Jt(F,{command:"addLayer",args:[te[me],We]}),ie.splice(ie.length-Oe,0,me),pe[me]=!0);for(let Oe=0;Oe<G.length;Oe++)if(me=G[Oe],ve=W[me],Ae=te[me],!pe[me]&&!sn(ve,Ae))if(sn(ve.source,Ae.source)&&sn(ve["source-layer"],Ae["source-layer"])&&sn(ve.type,Ae.type)){for(Me in Je(ve.layout,Ae.layout,F,me,null,"setLayoutProperty"),Je(ve.paint,Ae.paint,F,me,null,"setPaintProperty"),sn(ve.filter,Ae.filter)||Jt(F,{command:"setFilter",args:[me,Ae.filter]}),sn(ve.minzoom,Ae.minzoom)&&sn(ve.maxzoom,Ae.maxzoom)||Jt(F,{command:"setLayerZoomRange",args:[me,Ae.minzoom,Ae.maxzoom]}),ve)Object.prototype.hasOwnProperty.call(ve,Me)&&Me!=="layout"&&Me!=="paint"&&Me!=="filter"&&Me!=="metadata"&&Me!=="minzoom"&&Me!=="maxzoom"&&(Me.indexOf("paint.")===0?Je(ve[Me],Ae[Me],F,me,Me.slice(6),"setPaintProperty"):sn(ve[Me],Ae[Me])||Jt(F,{command:"setLayerProperty",args:[me,Me,Ae[Me]]}));for(Me in Ae)Object.prototype.hasOwnProperty.call(Ae,Me)&&!Object.prototype.hasOwnProperty.call(ve,Me)&&Me!=="layout"&&Me!=="paint"&&Me!=="filter"&&Me!=="metadata"&&Me!=="minzoom"&&Me!=="maxzoom"&&(Me.indexOf("paint.")===0?Je(ve[Me],Ae[Me],F,me,Me.slice(6),"setPaintProperty"):sn(ve[Me],Ae[Me])||Jt(F,{command:"setLayerProperty",args:[me,Me,Ae[Me]]}))}else Jt(F,{command:"removeLayer",args:[me]}),We=ie[ie.lastIndexOf(me)+1],Jt(F,{command:"addLayer",args:[Ae,We]})}(w,i.layers,c)}catch(f){console.warn("Unable to compute style diff:",f),c=[{command:"setStyle",args:[i]}]}return c},u.bX=function(h){const i=[],c=h.id;return c===void 0&&i.push({message:`layers.${c}: missing required property "id"`}),h.render===void 0&&i.push({message:`layers.${c}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&i.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),i},u.bY=Tt,u.bZ=hn,u.b_=class extends cs{constructor(h,i){super(h,i),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},u.ba=function(h,i,c){return h[0]=i[0]*c,h[1]=i[1]*c,h[2]=i[2]*c,h[3]=i[3]*c,h},u.bb=function(h,i){return h[0]*i[0]+h[1]*i[1]+h[2]*i[2]+h[3]},u.bc=d3,u.bd=yv,u.be=function(h,i,c,f,v){var w=1/Math.tan(i/2);if(h[0]=w/c,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=w,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,v!=null&&v!==1/0){var S=1/(f-v);h[10]=(v+f)*S,h[14]=2*v*f*S}else h[10]=-1,h[14]=-2*f;return h},u.bf=function(h){var i=new U(16);return i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[3],i[4]=h[4],i[5]=h[5],i[6]=h[6],i[7]=h[7],i[8]=h[8],i[9]=h[9],i[10]=h[10],i[11]=h[11],i[12]=h[12],i[13]=h[13],i[14]=h[14],i[15]=h[15],i},u.bg=function(h,i,c){var f=Math.sin(c),v=Math.cos(c),w=i[0],S=i[1],I=i[2],F=i[3],$=i[4],G=i[5],W=i[6],te=i[7];return i!==h&&(h[8]=i[8],h[9]=i[9],h[10]=i[10],h[11]=i[11],h[12]=i[12],h[13]=i[13],h[14]=i[14],h[15]=i[15]),h[0]=w*v+$*f,h[1]=S*v+G*f,h[2]=I*v+W*f,h[3]=F*v+te*f,h[4]=$*v-w*f,h[5]=G*v-S*f,h[6]=W*v-I*f,h[7]=te*v-F*f,h},u.bh=function(h,i,c){var f=Math.sin(c),v=Math.cos(c),w=i[4],S=i[5],I=i[6],F=i[7],$=i[8],G=i[9],W=i[10],te=i[11];return i!==h&&(h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h[12]=i[12],h[13]=i[13],h[14]=i[14],h[15]=i[15]),h[4]=w*v+$*f,h[5]=S*v+G*f,h[6]=I*v+W*f,h[7]=F*v+te*f,h[8]=$*v-w*f,h[9]=G*v-S*f,h[10]=W*v-I*f,h[11]=te*v-F*f,h},u.bi=function(){const h=new Float32Array(16);return K(h),h},u.bj=function(){const h=new Float64Array(16);return K(h),h},u.bk=function(){return new Float64Array(16)},u.bl=function(h,i,c){const f=new Float64Array(4);return Te(f,h,i-90,c),f},u.bm=function(h,i,c,f){var v,w,S,I,F,$=i[0],G=i[1],W=i[2],te=i[3],ie=c[0],pe=c[1],me=c[2],ve=c[3];return(w=$*ie+G*pe+W*me+te*ve)<0&&(w=-w,ie=-ie,pe=-pe,me=-me,ve=-ve),1-w>j?(v=Math.acos(w),S=Math.sin(v),I=Math.sin((1-f)*v)/S,F=Math.sin(f*v)/S):(I=1-f,F=f),h[0]=I*$+F*ie,h[1]=I*G+F*pe,h[2]=I*W+F*me,h[3]=I*te+F*ve,h},u.bn=function(h){const i=new Float64Array(9);var c,f,v,w,S,I,F,$,G,W,te,ie,pe,me,ve,Ae,We,Me;W=(v=(f=h)[0])*(F=v+v),te=(w=f[1])*F,pe=(S=f[2])*F,me=S*($=w+w),Ae=(I=f[3])*F,We=I*$,Me=I*(G=S+S),(c=i)[0]=1-(ie=w*$)-(ve=S*G),c[3]=te-Me,c[6]=pe+We,c[1]=te+Me,c[4]=1-W-ve,c[7]=me-Ae,c[2]=pe-We,c[5]=me+Ae,c[8]=1-W-ie;const Oe=jt(-Math.asin(_t(i[2],-1,1)));let tt,dt;return Math.hypot(i[5],i[8])<.001?(tt=0,dt=-jt(Math.atan2(i[3],i[4]))):(tt=jt(i[5]===0&&i[8]===0?0:Math.atan2(i[5],i[8])),dt=jt(i[1]===0&&i[0]===0?0:Math.atan2(i[1],i[0]))),{roll:tt,pitch:Oe+90,bearing:dt}},u.bo=function(h,i){return h.roll==i.roll&&h.pitch==i.pitch&&h.bearing==i.bearing},u.bp=_r,u.bq=jl,u.br=Oh,u.bs=Fh,u.bt=Vu,u.bu=lt,u.bv=Ht,u.bw=wo,u.bx=function(h,i,c,f,v){return lt(f,v,_t((h-i)/(c-i),0,1))},u.by=function(h,i,c,f){return h[0]=i[0]+c[0]*f,h[1]=i[1]+c[1]*f,h[2]=i[2]+c[2]*f,h},u.bz=Le,u.c=Be,u.c$=class{constructor(h){this.start=`${h}#start`,this.end=`${h}#end`,this.measure=h,performance.mark(this.start)}finish(){performance.mark(this.end);let h=performance.getEntriesByName(this.measure);return h.length===0&&(performance.measure(this.measure,this.start,this.end),h=performance.getEntriesByName(this.measure),performance.clearMarks(this.start),performance.clearMarks(this.end),performance.clearMeasures(this.measure)),h}},u.c0=class extends cs{constructor(h,i){super(h,i),this.current=Es}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let i=1;i<16;i++)if(h[i]!==this.current[i]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},u.c1=al,u.c2=class extends cs{constructor(h,i){super(h,i),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},u.c3=class extends cs{constructor(h,i){super(h,i),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},u.c4=X,u.c5=function(h,i){var c=Math.sin(i),f=Math.cos(i);return h[0]=f,h[1]=c,h[2]=0,h[3]=-c,h[4]=f,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},u.c6=function(h,i,c){var f=i[0],v=i[1],w=i[2];return h[0]=f*c[0]+v*c[3]+w*c[6],h[1]=f*c[1]+v*c[4]+w*c[7],h[2]=f*c[2]+v*c[5]+w*c[8],h},u.c7=function(h,i,c,f,v,w,S){var I=1/(i-c),F=1/(f-v),$=1/(w-S);return h[0]=-2*I,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*F,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*$,h[11]=0,h[12]=(i+c)*I,h[13]=(v+f)*F,h[14]=(S+w)*$,h[15]=1,h},u.c8=class extends cs{constructor(h,i){super(h,i),this.current=new Array}set(h){if(h!=this.current){this.current=h;const i=new Float32Array(4*h.length);for(let c=0;c<h.length;c++)i[4*c]=h[c].r,i[4*c+1]=h[c].g,i[4*c+2]=h[c].b,i[4*c+3]=h[c].a;this.gl.uniform4fv(this.location,i)}}},u.c9=class extends cs{constructor(h,i){super(h,i),this.current=new Array}set(h){if(h!=this.current){this.current=h;const i=new Float32Array(h);this.gl.uniform1fv(this.location,i)}}},u.cA=function(h,i){var c;if(!yn[i])return!1;const f=h?.target,v=((c=f?.ownerDocument)===null||c===void 0?void 0:c.defaultView)||window;return h instanceof v.MouseEvent||h instanceof v.WheelEvent},u.cB=function(h,i){return Ut[i]&&"touches"in h},u.cC=function(h){return Ut[h]||yn[h]},u.cD=function(h,i,c){var f=i[0],v=i[1];return h[0]=c[0]*f+c[4]*v+c[12],h[1]=c[1]*f+c[5]*v+c[13],h},u.cE=function(h,i){const{x:c,y:f}=P0.fromLngLat(i);return!(h<0||h>25||f<0||f>=1||c<0||c>=1)},u.cF=function(h,i){return h[0]=i[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=i[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=i[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},u.cG=class extends Bc{},u.cH=U9,u.cJ=fe,u.cK=function(h,i){Be.REGISTERED_PROTOCOLS[h]=i},u.cL=function(h){delete Be.REGISTERED_PROTOCOLS[h]},u.cM=function(h,i){const c={};for(let v=0;v<h.length;v++){const w=i&&i[h[v].id]||Fl(h[v]);i&&(i[h[v].id]=w);let S=c[w];S||(S=c[w]=[]),S.push(h[v])}const f=[];for(const v in c)f.push(c[v]);return f},u.cN=Nn,u.cO=p3,u.cP=W3,u.cQ=kt,u.cR=function(h){var i;h.bucket.createArrays(),h.bucket.tilePixelRatio=Ue/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const c=h.bucket.layers[0],f=c.layout,v=c._unevaluatedLayout._values,w={layoutIconSize:v["icon-size"].possiblyEvaluate(new Jr(h.bucket.zoom+1),h.canonical),layoutTextSize:v["text-size"].possiblyEvaluate(new Jr(h.bucket.zoom+1),h.canonical),textMaxSize:v["text-size"].possiblyEvaluate(new Jr(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:W}=h.bucket.textSizeData;w.compositeTextSizes=[v["text-size"].possiblyEvaluate(new Jr(G),h.canonical),v["text-size"].possiblyEvaluate(new Jr(W),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:W}=h.bucket.iconSizeData;w.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new Jr(G),h.canonical),v["icon-size"].possiblyEvaluate(new Jr(W),h.canonical)]}const S=f.get("text-line-height")*Po,I=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",F=f.get("text-keep-upright"),$=f.get("text-size");for(const G of h.bucket.features){const W=f.get("text-font").evaluate(G,{},h.canonical).join(","),te=$.evaluate(G,{},h.canonical),ie=w.layoutTextSize.evaluate(G,{},h.canonical),pe=w.layoutIconSize.evaluate(G,{},h.canonical),me={horizontal:{},vertical:void 0},ve=G.text;let Ae,We=[0,0];if(ve){const tt=ve.toString(),dt=f.get("text-letter-spacing").evaluate(G,{},h.canonical)*Po,Ct=Fm(tt)?dt:0,Xt=f.get("text-anchor").evaluate(G,{},h.canonical),Yt=oD(c,G,h.canonical);if(!Yt){const Kt=f.get("text-radial-offset").evaluate(G,{},h.canonical);We=Kt?iD(Xt,[Kt*Po,Z2]):f.get("text-offset").evaluate(G,{},h.canonical).map(Bt=>Bt*Po)}let rn=I?"center":f.get("text-justify").evaluate(G,{},h.canonical);const Mn=f.get("symbol-placement")==="point"?f.get("text-max-width").evaluate(G,{},h.canonical)*Po:1/0,ln=()=>{h.bucket.allowVerticalPlacement&&zc(tt)&&(me.vertical=Ft(ve,h.glyphMap,h.glyphPositions,h.imagePositions,W,Mn,S,Xt,"left",Ct,We,u.az.vertical,!0,ie,te))};if(!I&&Yt){const Kt=new Set;if(rn==="auto")for(let Hn=0;Hn<Yt.values.length;Hn+=2)Kt.add(Y2(Yt.values[Hn]));else Kt.add(rn);let Bt=!1;for(const Hn of Kt)if(!me.horizontal[Hn])if(Bt)me.horizontal[Hn]=me.horizontal[0];else{const Xn=Ft(ve,h.glyphMap,h.glyphPositions,h.imagePositions,W,Mn,S,"center",Hn,Ct,We,u.az.horizontal,!1,ie,te);Xn&&(me.horizontal[Hn]=Xn,Bt=Xn.positionedLines.length===1)}ln()}else{rn==="auto"&&(rn=Y2(Xt));const Kt=Ft(ve,h.glyphMap,h.glyphPositions,h.imagePositions,W,Mn,S,Xt,rn,Ct,We,u.az.horizontal,!1,ie,te);Kt&&(me.horizontal[rn]=Kt),ln(),zc(tt)&&I&&F&&(me.vertical=Ft(ve,h.glyphMap,h.glyphPositions,h.imagePositions,W,Mn,S,Xt,rn,Ct,We,u.az.vertical,!1,ie,te))}}let Me=!1;if(G.icon&&G.icon.name){const tt=h.imageMap[G.icon.name];tt&&(Ae=Uh(h.imagePositions[G.icon.name],f.get("icon-offset").evaluate(G,{},h.canonical),f.get("icon-anchor").evaluate(G,{},h.canonical)),Me=!!tt.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=Me:h.bucket.sdfIcons!==Me&&Ke("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tt.pixelRatio!==h.bucket.pixelRatio||f.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const Oe=aD(me.horizontal)||me.vertical;(i=h.bucket).iconsInText||(i.iconsInText=!!Oe&&Oe.iconsInText),(Oe||Ae)&&N9(h.bucket,G,me,Ae,h.imageMap,w,ie,pe,We,Me,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},u.cS=Xm,u.cT=b0,u.cU=vp,u.cV=function(h){const i=new p;return function(c,f){for(const v in c.layers)f.writeMessage(3,M9,c.layers[v])}(h,i),i.finish()},u.cW=function(h,i,c,f,v,w){let S=Z3(h,i,c,v,0);return S=Z3(S,i,f,w,1),S},u.cX=class{constructor(h){this.maxEntries=h,this.map=new Map}get(h){const i=this.map.get(h);return i!==void 0&&(this.map.delete(h),this.map.set(h,i)),i}set(h,i){if(this.map.has(h))this.map.delete(h);else if(this.map.size>=this.maxEntries){const c=this.map.keys().next().value;this.map.delete(c)}this.map.set(h,i)}clear(){this.map.clear()}},u.cY=v1,u.cZ=p,u.c_=H3,u.ca=class extends $l{},u.cb=C1,u.cc=class extends hi{},u.cd=Gm,u.ce=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},u.cf=d0,u.cg=function(h,i,c){var f=i[0],v=i[1],w=i[2],S=c[3]*f+c[7]*v+c[11]*w+c[15];return h[0]=(c[0]*f+c[4]*v+c[8]*w+c[12])/(S=S||1),h[1]=(c[1]*f+c[5]*v+c[9]*w+c[13])/S,h[2]=(c[2]*f+c[6]*v+c[10]*w+c[14])/S,h},u.ch=class extends Lu{},u.ci=class extends o{},u.cj=function(h,i){return h[0]===i[0]&&h[1]===i[1]&&h[2]===i[2]&&h[3]===i[3]&&h[4]===i[4]&&h[5]===i[5]&&h[6]===i[6]&&h[7]===i[7]&&h[8]===i[8]&&h[9]===i[9]&&h[10]===i[10]&&h[11]===i[11]&&h[12]===i[12]&&h[13]===i[13]&&h[14]===i[14]&&h[15]===i[15]},u.ck=function(h,i){var c=h[0],f=h[1],v=h[2],w=h[3],S=h[4],I=h[5],F=h[6],$=h[7],G=h[8],W=h[9],te=h[10],ie=h[11],pe=h[12],me=h[13],ve=h[14],Ae=h[15],We=i[0],Me=i[1],Oe=i[2],tt=i[3],dt=i[4],Ct=i[5],Xt=i[6],Yt=i[7],rn=i[8],Mn=i[9],ln=i[10],Kt=i[11],Bt=i[12],Hn=i[13],Xn=i[14],ur=i[15];return Math.abs(c-We)<=j*Math.max(1,Math.abs(c),Math.abs(We))&&Math.abs(f-Me)<=j*Math.max(1,Math.abs(f),Math.abs(Me))&&Math.abs(v-Oe)<=j*Math.max(1,Math.abs(v),Math.abs(Oe))&&Math.abs(w-tt)<=j*Math.max(1,Math.abs(w),Math.abs(tt))&&Math.abs(S-dt)<=j*Math.max(1,Math.abs(S),Math.abs(dt))&&Math.abs(I-Ct)<=j*Math.max(1,Math.abs(I),Math.abs(Ct))&&Math.abs(F-Xt)<=j*Math.max(1,Math.abs(F),Math.abs(Xt))&&Math.abs($-Yt)<=j*Math.max(1,Math.abs($),Math.abs(Yt))&&Math.abs(G-rn)<=j*Math.max(1,Math.abs(G),Math.abs(rn))&&Math.abs(W-Mn)<=j*Math.max(1,Math.abs(W),Math.abs(Mn))&&Math.abs(te-ln)<=j*Math.max(1,Math.abs(te),Math.abs(ln))&&Math.abs(ie-Kt)<=j*Math.max(1,Math.abs(ie),Math.abs(Kt))&&Math.abs(pe-Bt)<=j*Math.max(1,Math.abs(pe),Math.abs(Bt))&&Math.abs(me-Hn)<=j*Math.max(1,Math.abs(me),Math.abs(Hn))&&Math.abs(ve-Xn)<=j*Math.max(1,Math.abs(ve),Math.abs(Xn))&&Math.abs(Ae-ur)<=j*Math.max(1,Math.abs(Ae),Math.abs(ur))},u.cl=function(h,i){return h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h[4]=i[4],h[5]=i[5],h[6]=i[6],h[7]=i[7],h[8]=i[8],h[9]=i[9],h[10]=i[10],h[11]=i[11],h[12]=i[12],h[13]=i[13],h[14]=i[14],h[15]=i[15],h},u.cm=h=>h.type==="symbol",u.cn=h=>h.type==="circle",u.co=h=>h.type==="heatmap",u.cp=h=>h.type==="line",u.cq=h=>h.type==="fill",u.cr=h=>h.type==="fill-extrusion",u.cs=h=>h.type==="hillshade",u.ct=h=>h.type==="color-relief",u.cu=h=>h.type==="background",u.cv=h=>h.type==="custom",u.cw=He,u.cx=function(h,i,c){if(i<=0)return h;const f=1/i;return c===void 0||Math.abs(c)<1e-10?Math.round(h*f)/f:(c>0?Math.ceil(h*f-1e-9):Math.floor(h*f+1e-10))/f},u.cy=function(h,i,c){const f=Ce(i.x-c.x,i.y-c.y),v=Ce(h.x-c.x,h.y-c.y);var w,S;return jt(Math.atan2(f[0]*v[1]-f[1]*v[0],(w=f)[0]*(S=v)[0]+w[1]*S[1]))},u.cz=pt,u.d=Ye,u.d0=function(h,i,c,f,v){return s(this,void 0,void 0,function*(){if(O())try{return yield dn(h,i,c,f,v)}catch{}return function(w,S,I,F,$){const G=w.width,W=w.height;Ve&&Se||(Ve=new OffscreenCanvas(G,W),Se=Ve.getContext("2d",{willReadFrequently:!0})),Ve.width=G,Ve.height=W,Se.drawImage(w,0,0,G,W);const te=Se.getImageData(S,I,F,$);return Se.clearRect(0,0,G,W),te.data}(h,i,c,f,v)})},u.d1=m0,u.d2=_,u.d3=class{constructor(h,i){this.layers={[R0]:this},this.name=R0,this.version=i?i.version:1,this.extent=i?i.extent:4096,this.length=h.length,this.features=h}feature(h){return new S9(this.features[h],this.extent)}},u.d4=Su,u.d5=Bl,u.e=et,u.f=h=>s(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(i)}catch(c){throw new Error(`Could not load image because of ${c.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),u.g=ee,u.h=h=>new Promise((i,c)=>{const f=new Image;f.onload=()=>{i(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Gn})},f.onerror=()=>c(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const v=new Blob([new Uint8Array(h)],{type:"image/png"});f.src=h.byteLength?URL.createObjectURL(v):Gn}),u.i=Gt,u.j=(h,i)=>xe(et(h,{type:"json"}),i),u.k=Ge,u.l=Fe,u.m=xe,u.n=(h,i)=>xe(et(h,{type:"arrayBuffer"}),i),u.o=function(h){return new p(h).readFields(bn,[])},u.p=cr,u.q=function(h){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(h))},u.r=fp,u.s=bt,u.t=Wi,u.u=De,u.v=el,u.w=Ke,u.x=Fc,u.y=Lc,u.z=Ch}),a("worker",["./shared"],function(u){class s{constructor(ee,oe){this.keyCache={},ee&&this.replace(ee,oe)}replace(ee,oe){this._layerConfigs={},this._layers={},this.update(ee,[],oe)}update(ee,oe,fe){for(const xe of ee){this._layerConfigs[xe.id]=xe;const Ye=this._layers[xe.id]=u.bT(xe,fe);Ye._featureFilter=u.aj(Ye.filter,fe),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(const xe of oe)delete this.keyCache[xe],delete this._layerConfigs[xe],delete this._layers[xe];this.familiesBySource={};const he=u.cM(Object.values(this._layerConfigs),this.keyCache);for(const xe of he){const Ye=xe.map(De=>this._layers[De.id]),st=Ye[0];if(st.isHidden())continue;const _e=st.source||"";let Fe=this.familiesBySource[_e];Fe||(Fe=this.familiesBySource[_e]={});const Ge=st.sourceLayer||u.ai;let je=Fe[Ge];je||(je=Fe[Ge]=[]),je.push(Ye)}}}class m{constructor(ee){const oe={},fe=[];for(const st in ee){const _e=ee[st],Fe=oe[st]={};for(const Ge in _e){const je=_e[+Ge];if(!je||je.bitmap.width===0||je.bitmap.height===0)continue;const De={x:0,y:0,w:je.bitmap.width+2,h:je.bitmap.height+2};fe.push(De),Fe[Ge]={rect:De,metrics:je.metrics}}}const{w:he,h:xe}=u.p(fe),Ye=new u.r({width:he||1,height:xe||1});for(const st in ee){const _e=ee[st];for(const Fe in _e){const Ge=_e[+Fe];if(!Ge||Ge.bitmap.width===0||Ge.bitmap.height===0)continue;const je=oe[st][Fe].rect;u.r.copy(Ge.bitmap,Ye,{x:0,y:0},{x:je.x+1,y:je.y+1},Ge.bitmap)}}this.image=Ye,this.positions=oe}}u.cN("GlyphAtlas",m);class _{constructor(ee){this.tileID=new u.a2(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,oe,fe,he,xe){return u._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new u.ag;const Ye=new u.cO(Object.keys(ee.layers).sort()),st=new u.cP(this.tileID,this.promoteId);st.bucketLayerIDs=[];const _e={},Fe={featureIndex:st,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:fe,subdivisionGranularity:xe},Ge=oe.familiesBySource[this.source];for(const Qt in Ge){const Sn=ee.layers[Qt];if(!Sn)continue;Sn.version===1&&u.w(`Vector tile source "${this.source}" layer "${Qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Un=Ye.encode(Qt),kn=[];for(let Rt=0;Rt<Sn.length;Rt++){const ct=Sn.feature(Rt),ut=st.getId(ct,Qt);kn.push({feature:ct,id:ut,index:Rt,sourceLayerIndex:Un})}for(const Rt of Ge[Qt]){const ct=Rt[0];ct.source!==this.source&&u.w(`layer.source = ${ct.source} does not equal this.source = ${this.source}`),ct.isHidden(this.zoom,!0)||(b(Rt,this.zoom,fe),(_e[ct.id]=ct.createBucket({index:st.bucketLayerIDs.length,layers:Rt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Un,sourceID:this.source})).populate(kn,Fe,this.tileID.canonical),st.bucketLayerIDs.push(Rt.map(ut=>ut.id)))}}const je=u.bY(Fe.glyphDependencies,Qt=>Object.keys(Qt).map(Number));this.inFlightDependencies.forEach(Qt=>Qt?.abort()),this.inFlightDependencies=[];let De=Promise.resolve({});if(Object.keys(je).length){const Qt=new AbortController;this.inFlightDependencies.push(Qt),De=he.sendAsync({type:"GG",data:{stacks:je,source:this.source,tileID:this.tileID,type:"glyphs"}},Qt)}const zt=Object.keys(Fe.iconDependencies);let fn=Promise.resolve({});if(zt.length){const Qt=new AbortController;this.inFlightDependencies.push(Qt),fn=he.sendAsync({type:"GI",data:{icons:zt,source:this.source,tileID:this.tileID,type:"icons"}},Qt)}const sn=Object.keys(Fe.patternDependencies);let Jt=Promise.resolve({});if(sn.length){const Qt=new AbortController;this.inFlightDependencies.push(Qt),Jt=he.sendAsync({type:"GI",data:{icons:sn,source:this.source,tileID:this.tileID,type:"patterns"}},Qt)}const cn=Fe.dashDependencies;let Zn=Promise.resolve({});if(Object.keys(cn).length){const Qt=new AbortController;this.inFlightDependencies.push(Qt),Zn=he.sendAsync({type:"GDA",data:{dashes:cn}},Qt)}const[yr,Ar,Je,gt]=yield Promise.all([De,fn,Jt,Zn]),St=new m(yr),ft=new u.cQ(Ar,Je);for(const Qt in _e){const Sn=_e[Qt];Sn instanceof u.ah?(b(Sn.layers,this.zoom,fe),u.cR({bucket:Sn,glyphMap:yr,glyphPositions:St.positions,imageMap:Ar,imagePositions:ft.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Fe.subdivisionGranularity})):Sn.hasDependencies&&(Sn instanceof u.cS||Sn instanceof u.cT||Sn instanceof u.cU)&&(b(Sn.layers,this.zoom,fe),Sn.addFeatures(Fe,this.tileID.canonical,ft.patternPositions,gt))}return this.status="done",{buckets:Object.values(_e).filter(Qt=>!Qt.isEmpty()),featureIndex:st,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:St.image,imageAtlas:ft,dashPositions:gt,glyphMap:this.returnDependencies?yr:null,iconMap:this.returnDependencies?Ar:null,glyphPositions:this.returnDependencies?St.positions:null}})}}function b(Be,ee,oe){const fe=new u.H(ee);for(const he of Be)he.recalculate(fe,oe)}class M{constructor(){this.loading={},this.loaded={},this.parsing={}}startLoading(ee,oe){this.loading[ee]=oe}finishLoading(ee){delete this.loading[ee]}abort(ee){const oe=this.loading[ee];oe?.abort&&(oe.abort.abort(),delete this.loading[ee])}setParsing(ee,oe){this.parsing[ee]=oe}consumeParsing(ee){const oe=this.parsing[ee];if(oe)return delete this.parsing[ee],oe}clearParsing(ee){delete this.parsing[ee]}markLoaded(ee,oe){this.loaded[ee]=oe}getLoaded(ee){const oe=this.loaded[ee];if(oe)return oe}removeLoaded(ee){delete this.loaded[ee]}clearLoaded(){this.loaded={}}}class C{constructor(ee,oe,fe,he,xe){this.type=ee,this.properties=fe||{},this.extent=xe,this.pointsArray=oe,this.id=he}loadGeometry(){return this.pointsArray.map(ee=>ee.map(oe=>new u.P(oe.x,oe.y)))}}class A{constructor(ee,oe,fe){this.version=2,this._myFeatures=ee,this.name=oe,this.length=ee.length,this.extent=fe}feature(ee){return this._myFeatures[ee]}}class k{constructor(){this.layers={}}addLayer(ee){this.layers[ee.name]=ee}}function z(Be){let ee=u.cV(Be);return ee.byteOffset===0&&ee.byteLength===ee.buffer.byteLength||(ee=new Uint8Array(ee)),{vectorTile:Be,rawData:ee.buffer}}function P(Be,ee,oe){const{extent:fe}=Be,he=Math.pow(2,oe.z-ee.z),xe=(oe.x-ee.x*he)*fe,Ye=(oe.y-ee.y*he)*fe,st=[];for(let _e=0;_e<Be.length;_e++){const Fe=Be.feature(_e);let Ge=Fe.loadGeometry();for(const De of Ge)for(const zt of De)zt.x=zt.x*he-xe,zt.y=zt.y*he-Ye;const je=128;Ge=u.cW(Ge,Fe.type,-je,-je,fe+je,fe+je),Ge.length!==0&&st.push(new C(Fe.type,Ge,Fe.properties,Fe.id,fe))}return new A(st,Be.name,fe)}class O{constructor(ee,oe,fe){this.actor=ee,this.layerIndex=oe,this.availableImages=fe,this.tileState=new M,this.overzoomedTileResultCache=new u.cX(1e3)}loadVectorTile(ee,oe){return u._(this,void 0,void 0,function*(){const fe=yield u.n(ee.request,oe);try{return{vectorTile:ee.encoding!=="mlt"?new u.cY(new u.cZ(fe.data)):new u.c_(fe.data),rawData:fe.data,cacheControl:fe.cacheControl,expires:fe.expires}}catch(he){const xe=new Uint8Array(fe.data);let Ye=`Unable to parse the tile at ${ee.request.url}, `;throw Ye+=xe[0]===31&&xe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${he.message}`,new Error(Ye)}})}loadTile(ee){return u._(this,void 0,void 0,function*(){const{uid:oe,overzoomParameters:fe}=ee;fe&&(ee.request=fe.overzoomRequest);const he=this._startRequestTiming(ee),xe=new _(ee);this.tileState.startLoading(oe,xe);const Ye=new AbortController;xe.abort=Ye;try{const st=yield this.loadVectorTile(ee,Ye);if(this.tileState.finishLoading(oe),!st)return null;let{vectorTile:_e,rawData:Fe}=st;fe&&({vectorTile:_e,rawData:Fe}=this._getOverzoomTile(ee,st.vectorTile));const Ge=this._getExpiryData(st),je=this._finishRequestTiming(he);xe.vectorTile=_e,this.tileState.markLoaded(oe,xe);const De={rawData:Fe,cacheControl:Ge,resourceTiming:je};this.tileState.setParsing(oe,De);try{return yield this._parseWorkerTile(xe,ee,De)}finally{this.tileState.clearParsing(oe)}}catch(st){throw this.tileState.finishLoading(oe),xe.status="done",this.tileState.markLoaded(oe,xe),st}})}_parseWorkerTile(ee,oe,fe){return u._(this,void 0,void 0,function*(){let he=yield ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,oe.subdivisionGranularity);if(fe){const{rawData:xe,cacheControl:Ye,resourceTiming:st}=fe;he=u.e({rawTileData:xe.slice(0),encoding:oe.encoding},he,Ye,st)}return he})}_getExpiryData(ee){const{expires:oe,cacheControl:fe}=ee,he={};return oe&&(he.expires=oe),fe&&(he.cacheControl=fe),he}_startRequestTiming(ee){var oe;if(!((oe=ee.request)===null||oe===void 0)&&oe.collectResourceTiming)return new u.c$(ee.request.url)}_finishRequestTiming(ee){const oe=ee?.finish();return oe?{resourceTiming:JSON.parse(JSON.stringify(oe))}:{}}_getOverzoomTile(ee,oe){const{tileID:fe,source:he,overzoomParameters:xe}=ee,{maxZoomTileID:Ye}=xe,st=`${Ye.key}_${fe.key}`,_e=this.overzoomedTileResultCache.get(st);if(_e)return _e;const Fe=new k,Ge=this.layerIndex.familiesBySource[he];for(const De in Ge){const zt=oe.layers[De];if(!zt)continue;const fn=P(zt,Ye,fe.canonical);fn.length>0&&Fe.addLayer(fn)}const je=z(Fe);return this.overzoomedTileResultCache.set(st,je),je}reloadTile(ee){return u._(this,void 0,void 0,function*(){const oe=ee.uid,fe=this.tileState.getLoaded(oe);if(!fe)throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");if(fe.showCollisionBoxes=ee.showCollisionBoxes,fe.status==="parsing"){const he=this.tileState.consumeParsing(oe);return yield this._parseWorkerTile(fe,ee,he)}if(fe.status==="done"&&fe.vectorTile)return yield this._parseWorkerTile(fe,ee)})}abortTile(ee){return u._(this,void 0,void 0,function*(){this.tileState.abort(ee.uid)})}removeTile(ee){return u._(this,void 0,void 0,function*(){this.tileState.removeLoaded(ee.uid)})}}class j{constructor(){this.loaded={}}loadTile(ee){return u._(this,void 0,void 0,function*(){const{uid:oe,encoding:fe,rawImageData:he,redFactor:xe,greenFactor:Ye,blueFactor:st,baseShift:_e}=ee,Fe=he.width+2,Ge=he.height+2,je=u.b(he)?new u.R({width:Fe,height:Ge},yield u.d0(he,-1,-1,Fe,Ge)):he,De=new u.d1(oe,je,fe,xe,Ye,st,_e);return this.loaded=this.loaded||{},this.loaded[oe]=De,De})}removeTile(ee){const oe=this.loaded,fe=ee.uid;oe&&oe[fe]&&delete oe[fe]}}var U,X,K=function(){if(X)return U;function Be(oe,fe){if(oe.length!==0){ee(oe[0],fe);for(var he=1;he<oe.length;he++)ee(oe[he],!fe)}}function ee(oe,fe){for(var he=0,xe=0,Ye=0,st=oe.length,_e=st-1;Ye<st;_e=Ye++){var Fe=(oe[Ye][0]-oe[_e][0])*(oe[_e][1]+oe[Ye][1]),Ge=he+Fe;xe+=Math.abs(he)>=Math.abs(Fe)?he-Ge+Fe:Fe-Ge+he,he=Ge}he+xe>=0!=!!fe&&oe.reverse()}return X=1,U=function oe(fe,he){var xe,Ye=fe&&fe.type;if(Ye==="FeatureCollection")for(xe=0;xe<fe.features.length;xe++)oe(fe.features[xe],he);else if(Ye==="GeometryCollection")for(xe=0;xe<fe.geometries.length;xe++)oe(fe.geometries[xe],he);else if(Ye==="Feature")oe(fe.geometry,he);else if(Ye==="Polygon")Be(fe.coordinates,he);else if(Ye==="MultiPolygon")for(xe=0;xe<fe.coordinates.length;xe++)Be(fe.coordinates[xe],he);return fe}}(),se=u.d2(K);const J={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Be=>Be},ue=Math.fround||(ne=new Float32Array(1),Be=>(ne[0]=+Be,ne[0]));var ne;class H{constructor(ee){this.options=Object.assign(Object.create(J),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:oe,minZoom:fe,maxZoom:he}=this.options;oe&&console.time("total time");const xe=`prepare ${ee.length} points`;oe&&console.time(xe),this.points=ee;const Ye=[];for(let _e=0;_e<ee.length;_e++){const Fe=ee[_e];if(!Fe.geometry)continue;const[Ge,je]=Fe.geometry.coordinates,De=ue(Pe(Ge)),zt=ue(Ze(je));Ye.push(De,zt,1/0,_e,-1,1),this.options.reduce&&Ye.push(0)}let st=this.trees[he+1]=this._createTree(Ye);oe&&console.timeEnd(xe);for(let _e=he;_e>=fe;_e--){const Fe=+Date.now();st=this.trees[_e]=this._createTree(this._cluster(st,_e)),oe&&console.log("z%d: %d clusters in %dms",_e,st.numItems,+Date.now()-Fe)}return oe&&console.timeEnd("total time"),this}getClusters(ee,oe){let fe=((ee[0]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,ee[1]));let xe=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)fe=-180,xe=180;else if(fe>xe){const je=this.getClusters([fe,he,180,Ye],oe),De=this.getClusters([-180,he,xe,Ye],oe);return je.concat(De)}const st=this.trees[this._limitZoom(oe)],_e=st.range(Pe(fe),Ze(Ye),Pe(xe),Ze(he)),Fe=st.data,Ge=[];for(const je of _e){const De=this.stride*je;Ge.push(Fe[De+5]>1?de(Fe,De,this.clusterProps):this.points[Fe[De+3]])}return Ge}getChildren(ee){const oe=this._getOriginId(ee),fe=this._getOriginZoom(ee),he="No cluster with the specified id.",xe=this.trees[fe];if(!xe)throw new Error(he);const Ye=xe.data;if(oe*this.stride>=Ye.length)throw new Error(he);const st=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),_e=xe.within(Ye[oe*this.stride],Ye[oe*this.stride+1],st),Fe=[];for(const Ge of _e){const je=Ge*this.stride;Ye[je+4]===ee&&Fe.push(Ye[je+5]>1?de(Ye,je,this.clusterProps):this.points[Ye[je+3]])}if(Fe.length===0)throw new Error(he);return Fe}getLeaves(ee,oe,fe){const he=[];return this._appendLeaves(he,ee,oe=oe||10,fe=fe||0,0),he}getTile(ee,oe,fe){const he=this.trees[this._limitZoom(ee)],xe=Math.pow(2,ee),{extent:Ye,radius:st}=this.options,_e=st/Ye,Fe=(fe-_e)/xe,Ge=(fe+1+_e)/xe,je={features:[]};return this._addTileFeatures(he.range((oe-_e)/xe,Fe,(oe+1+_e)/xe,Ge),he.data,oe,fe,xe,je),oe===0&&this._addTileFeatures(he.range(1-_e/xe,Fe,1,Ge),he.data,xe,fe,xe,je),oe===xe-1&&this._addTileFeatures(he.range(0,Fe,_e/xe,Ge),he.data,-1,fe,xe,je),je.features.length?je:null}getClusterExpansionZoom(ee){let oe=this._getOriginZoom(ee)-1;for(;oe<=this.options.maxZoom;){const fe=this.getChildren(ee);if(oe++,fe.length!==1)break;ee=fe[0].properties.cluster_id}return oe}_appendLeaves(ee,oe,fe,he,xe){const Ye=this.getChildren(oe);for(const st of Ye){const _e=st.properties;if(_e&&_e.cluster?xe+_e.point_count<=he?xe+=_e.point_count:xe=this._appendLeaves(ee,_e.cluster_id,fe,he,xe):xe<he?xe++:ee.push(st),ee.length===fe)break}return xe}_createTree(ee){const oe=new u.aT(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let fe=0;fe<ee.length;fe+=this.stride)oe.add(ee[fe],ee[fe+1]);return oe.finish(),oe.data=ee,oe}_addTileFeatures(ee,oe,fe,he,xe,Ye){for(const st of ee){const _e=st*this.stride,Fe=oe[_e+5]>1;let Ge,je,De;if(Fe)Ge=Ee(oe,_e,this.clusterProps),je=oe[_e],De=oe[_e+1];else{const sn=this.points[oe[_e+3]];Ge=sn.properties;const[Jt,cn]=sn.geometry.coordinates;je=Pe(Jt),De=Ze(cn)}const zt={type:1,geometry:[[Math.round(this.options.extent*(je*xe-fe)),Math.round(this.options.extent*(De*xe-he))]],tags:Ge};let fn;fn=Fe||this.options.generateId?oe[_e+3]:this.points[oe[_e+3]].id,fn!==void 0&&(zt.id=fn),Ye.features.push(zt)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,oe){const{radius:fe,extent:he,reduce:xe,minPoints:Ye}=this.options,st=fe/(he*Math.pow(2,oe)),_e=ee.data,Fe=[],Ge=this.stride;for(let je=0;je<_e.length;je+=Ge){if(_e[je+2]<=oe)continue;_e[je+2]=oe;const De=_e[je],zt=_e[je+1],fn=ee.within(_e[je],_e[je+1],st),sn=_e[je+5];let Jt=sn;for(const cn of fn){const Zn=cn*Ge;_e[Zn+2]>oe&&(Jt+=_e[Zn+5])}if(Jt>sn&&Jt>=Ye){let cn,Zn=De*sn,yr=zt*sn,Ar=-1;const Je=(je/Ge<<5)+(oe+1)+this.points.length;for(const gt of fn){const St=gt*Ge;if(_e[St+2]<=oe)continue;_e[St+2]=oe;const ft=_e[St+5];Zn+=_e[St]*ft,yr+=_e[St+1]*ft,_e[St+4]=Je,xe&&(cn||(cn=this._map(_e,je,!0),Ar=this.clusterProps.length,this.clusterProps.push(cn)),xe(cn,this._map(_e,St)))}_e[je+4]=Je,Fe.push(Zn/Jt,yr/Jt,1/0,Je,-1,Jt),xe&&Fe.push(Ar)}else{for(let cn=0;cn<Ge;cn++)Fe.push(_e[je+cn]);if(Jt>1)for(const cn of fn){const Zn=cn*Ge;if(!(_e[Zn+2]<=oe)){_e[Zn+2]=oe;for(let yr=0;yr<Ge;yr++)Fe.push(_e[Zn+yr])}}}}return Fe}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,oe,fe){if(ee[oe+5]>1){const Ye=this.clusterProps[ee[oe+6]];return fe?Object.assign({},Ye):Ye}const he=this.points[ee[oe+3]].properties,xe=this.options.map(he);return fe&&xe===he?Object.assign({},xe):xe}}function de(Be,ee,oe){return{type:"Feature",id:Be[ee+3],properties:Ee(Be,ee,oe),geometry:{type:"Point",coordinates:[(fe=Be[ee],360*(fe-.5)),ke(Be[ee+1])]}};var fe}function Ee(Be,ee,oe){const fe=Be[ee+5],he=fe>=1e4?`${Math.round(fe/1e3)}k`:fe>=1e3?Math.round(fe/100)/10+"k":fe,xe=Be[ee+6],Ye=xe===-1?{}:Object.assign({},oe[xe]);return Object.assign(Ye,{cluster:!0,cluster_id:Be[ee+3],point_count:fe,point_count_abbreviated:he})}function Pe(Be){return Be/360+.5}function Ze(Be){const ee=Math.sin(Be*Math.PI/180),oe=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return oe<0?0:oe>1?1:oe}function ke(Be){const ee=(180-360*Be)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Te(Be,ee,oe,fe){let he=fe;const xe=ee+(oe-ee>>1);let Ye,st=oe-ee;const _e=Be[ee],Fe=Be[ee+1],Ge=Be[oe],je=Be[oe+1];for(let De=ee+3;De<oe;De+=3){const zt=Ie(Be[De],Be[De+1],_e,Fe,Ge,je);if(zt>he)Ye=De,he=zt;else if(zt===he){const fn=Math.abs(De-xe);fn<st&&(Ye=De,st=fn)}}he>fe&&(Ye-ee>3&&Te(Be,ee,Ye,fe),Be[Ye+2]=he,oe-Ye>3&&Te(Be,Ye,oe,fe))}function Ie(Be,ee,oe,fe,he,xe){let Ye=he-oe,st=xe-fe;if(Ye!==0||st!==0){const _e=((Be-oe)*Ye+(ee-fe)*st)/(Ye*Ye+st*st);_e>1?(oe=he,fe=xe):_e>0&&(oe+=Ye*_e,fe+=st*_e)}return Ye=Be-oe,st=ee-fe,Ye*Ye+st*st}function Ce(Be,ee,oe,fe){const he={type:ee,geom:oe},xe={id:Be??null,type:he.type,geometry:he.geom,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};switch(he.type){case"Point":case"MultiPoint":case"LineString":Ue(xe,he.geom);break;case"Polygon":Ue(xe,he.geom[0]);break;case"MultiLineString":for(const Ye of he.geom)Ue(xe,Ye);break;case"MultiPolygon":for(const Ye of he.geom)Ue(xe,Ye[0])}return xe}function Ue(Be,ee){for(let oe=0;oe<ee.length;oe+=3)Be.minX=Math.min(Be.minX,ee[oe]),Be.minY=Math.min(Be.minY,ee[oe+1]),Be.maxX=Math.max(Be.maxX,ee[oe]),Be.maxY=Math.max(Be.maxY,ee[oe+1])}function nt(Be,ee){const oe=[];switch(Be.type){case"FeatureCollection":for(let fe=0;fe<Be.features.length;fe++)Le(oe,Be.features[fe],ee,fe);break;case"Feature":Le(oe,Be,ee);break;default:Le(oe,{geometry:Be,properties:void 0},ee)}return oe}function Le(Be,ee,oe,fe){if(!ee.geometry)return;if(ee.geometry.type==="GeometryCollection"){for(const st of ee.geometry.geometries)Le(Be,{id:ee.id,geometry:st,properties:ee.properties},oe,fe);return}if(!ee.geometry.coordinates?.length)return;const xe=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2);let Ye=ee.id;switch(oe.promoteId?Ye=ee.properties?.[oe.promoteId]:oe.generateId&&(Ye=fe||0),ee.geometry.type){case"Point":{const st=[];return lt(ee.geometry.coordinates,st),void Be.push(Ce(Ye,ee.geometry.type,st,ee.properties))}case"MultiPoint":{const st=[];for(const _e of ee.geometry.coordinates)lt(_e,st);return void Be.push(Ce(Ye,ee.geometry.type,st,ee.properties))}case"LineString":{const st=[];return Ht(ee.geometry.coordinates,st,xe,!1),void Be.push(Ce(Ye,ee.geometry.type,st,ee.properties))}case"MultiLineString":{if(oe.lineMetrics){for(const _e of ee.geometry.coordinates){const Fe=[];Ht(_e,Fe,xe,!1),Be.push(Ce(Ye,"LineString",Fe,ee.properties))}return}const st=[];return He(ee.geometry.coordinates,st,xe,!1),void Be.push(Ce(Ye,ee.geometry.type,st,ee.properties))}case"Polygon":{const st=[];return He(ee.geometry.coordinates,st,xe,!0),void Be.push(Ce(Ye,ee.geometry.type,st,ee.properties))}case"MultiPolygon":{const st=[];for(const _e of ee.geometry.coordinates){const Fe=[];He(_e,Fe,xe,!0),st.push(Fe)}return void Be.push(Ce(Ye,ee.geometry.type,st,ee.properties))}default:throw new Error("Input data is not a valid GeoJSON object.")}}function lt(Be,ee){ee.push(pt(Be[0]),_t(Be[1]),0)}function Ht(Be,ee,oe,fe){let he,xe,Ye=0;for(let _e=0;_e<Be.length;_e++){const Fe=pt(Be[_e][0]),Ge=_t(Be[_e][1]);ee.push(Fe,Ge,0),_e>0&&(Ye+=fe?(he*Ge-Fe*xe)/2:Math.sqrt(Math.pow(Fe-he,2)+Math.pow(Ge-xe,2))),he=Fe,xe=Ge}const st=ee.length-3;ee[2]=1,oe>0&&Te(ee,0,st,oe),ee[st+2]=1,ee.size=Math.abs(Ye),ee.start=0,ee.end=ee.size}function He(Be,ee,oe,fe){for(let he=0;he<Be.length;he++){const xe=[];Ht(Be[he],xe,oe,fe),ee.push(xe)}}function pt(Be){return Be/360+.5}function _t(Be){const ee=Math.sin(Be*Math.PI/180),oe=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return oe<0?0:oe>1?1:oe}function ot(Be,ee,oe,fe,he,xe,Ye,st){if(fe/=ee,xe>=(oe/=ee)&&Ye<fe)return Be;if(Ye<oe||xe>=fe)return null;const _e=[];for(const Fe of Be){const Ge=he===0?Fe.minX:Fe.minY,je=he===0?Fe.maxX:Fe.maxY;if(Ge>=oe&&je<fe)_e.push(Fe);else if(!(je<oe||Ge>=fe))switch(Fe.type){case"Point":case"MultiPoint":{const De=[];if(et(Fe.geometry,De,oe,fe,he),!De.length)continue;_e.push(Ce(Fe.id,De.length===3?"Point":"MultiPoint",De,Fe.tags));continue}case"LineString":{const De=[];if(Mt(Fe.geometry,De,oe,fe,he,!1,st.lineMetrics),!De.length)continue;if(st.lineMetrics){for(const zt of De)_e.push(Ce(Fe.id,Fe.type,zt,Fe.tags));continue}if(De.length>1){_e.push(Ce(Fe.id,"MultiLineString",De,Fe.tags));continue}_e.push(Ce(Fe.id,Fe.type,De[0],Fe.tags));continue}case"MultiLineString":{const De=[];if(hn(Fe.geometry,De,oe,fe,he,!1),!De.length)continue;if(De.length===1){_e.push(Ce(Fe.id,"LineString",De[0],Fe.tags));continue}_e.push(Ce(Fe.id,Fe.type,De,Fe.tags));continue}case"Polygon":{const De=[];if(hn(Fe.geometry,De,oe,fe,he,!0),!De.length)continue;_e.push(Ce(Fe.id,Fe.type,De,Fe.tags));continue}case"MultiPolygon":{const De=[];for(const zt of Fe.geometry){const fn=[];hn(zt,fn,oe,fe,he,!0),fn.length&&De.push(fn)}if(!De.length)continue;_e.push(Ce(Fe.id,Fe.type,De,Fe.tags));continue}}}return _e.length?_e:null}function et(Be,ee,oe,fe,he){for(let xe=0;xe<Be.length;xe+=3){const Ye=Be[xe+he];Ye>=oe&&Ye<=fe&&en(ee,Be[xe],Be[xe+1],Be[xe+2])}}function Mt(Be,ee,oe,fe,he,xe,Ye){let st=Tt(Be);const _e=he===0?an:Ke;let Fe,Ge,je=Be.start;for(let Jt=0;Jt<Be.length-3;Jt+=3){const cn=Be[Jt],Zn=Be[Jt+1],yr=Be[Jt+2],Ar=Be[Jt+3],Je=Be[Jt+4],gt=he===0?cn:Zn,St=he===0?Ar:Je;let ft=!1;Ye&&(Fe=Math.sqrt(Math.pow(cn-Ar,2)+Math.pow(Zn-Je,2))),gt<oe?St>oe&&(Ge=_e(st,cn,Zn,Ar,Je,oe),Ye&&(st.start=je+Fe*Ge)):gt>fe?St<fe&&(Ge=_e(st,cn,Zn,Ar,Je,fe),Ye&&(st.start=je+Fe*Ge)):en(st,cn,Zn,yr),St<oe&&gt>=oe&&(Ge=_e(st,cn,Zn,Ar,Je,oe),ft=!0),St>fe&&gt<=fe&&(Ge=_e(st,cn,Zn,Ar,Je,fe),ft=!0),!xe&&ft&&(Ye&&(st.end=je+Fe*Ge),ee.push(st),st=Tt(Be)),Ye&&(je+=Fe)}let De=Be.length-3;const zt=Be[De],fn=Be[De+1],sn=he===0?zt:fn;sn>=oe&&sn<=fe&&en(st,zt,fn,Be[De+2]),De=st.length-3,xe&&De>=3&&(st[De]!==st[0]||st[De+1]!==st[1])&&en(st,st[0],st[1],st[2]),st.length&&ee.push(st)}function Tt(Be){const ee=[];return ee.size=Be.size,ee.start=Be.start,ee.end=Be.end,ee}function hn(Be,ee,oe,fe,he,xe){for(const Ye of Be)Mt(Ye,ee,oe,fe,he,xe,!1)}function en(Be,ee,oe,fe){Be.push(ee,oe,fe)}function an(Be,ee,oe,fe,he,xe){const Ye=(xe-ee)/(fe-ee);return en(Be,xe,oe+(he-oe)*Ye,1),Ye}function Ke(Be,ee,oe,fe,he,xe){const Ye=(xe-oe)/(he-oe);return en(Be,ee+(fe-ee)*Ye,xe,1),Ye}function An(Be,ee){const oe=ee.buffer/ee.extent;let fe=Be;const he=ot(Be,1,-1-oe,oe,0,-1,2,ee),xe=ot(Be,1,1-oe,2+oe,0,-1,2,ee);return(he||xe)&&(fe=ot(Be,1,-oe,1+oe,0,-1,2,ee)||[],he&&(fe=Gt(he,1).concat(fe)),xe&&(fe=fe.concat(Gt(xe,-1)))),fe}function Gt(Be,ee){const oe=[];for(const fe of Be)switch(fe.type){case"Point":case"MultiPoint":case"LineString":{const he=on(fe.geometry,ee);oe.push(Ce(fe.id,fe.type,he,fe.tags));continue}case"MultiLineString":case"Polygon":{const he=[];for(const xe of fe.geometry)he.push(on(xe,ee));oe.push(Ce(fe.id,fe.type,he,fe.tags));continue}case"MultiPolygon":{const he=[];for(const xe of fe.geometry){const Ye=[];for(const st of xe)Ye.push(on(st,ee));he.push(Ye)}oe.push(Ce(fe.id,fe.type,he,fe.tags));continue}}return oe}function on(Be,ee){const oe=[];oe.size=Be.size,Be.start!==void 0&&(oe.start=Be.start,oe.end=Be.end);for(let fe=0;fe<Be.length;fe+=3)oe.push(Be[fe]+ee,Be[fe+1],Be[fe+2]);return oe}function Wt(Be,ee){if(Be.transformed)return Be;const oe=1<<Be.z,fe=Be.x,he=Be.y;for(const xe of Be.features){if(xe.type===1){const st=[];for(let _e=0;_e<xe.geometry.length;_e+=2)st.push(Gn(xe.geometry[_e],xe.geometry[_e+1],ee,oe,fe,he));xe.geometry=st;continue}const Ye=[];for(const st of xe.geometry){const _e=[];for(let Fe=0;Fe<st.length;Fe+=2)_e.push(Gn(st[Fe],st[Fe+1],ee,oe,fe,he));Ye.push(_e)}xe.geometry=Ye}return Be.transformed=!0,Be}function Gn(Be,ee,oe,fe,he,xe){return[Math.round(oe*(Be*fe-he)),Math.round(oe*(ee*fe-xe))]}function dn(Be,ee,oe,fe,he){const xe=ee===he.maxZoom?0:he.tolerance/((1<<ee)*he.extent),Ye={features:[],numPoints:0,numSimplified:0,numFeatures:Be.length,source:null,x:oe,y:fe,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const st of Be)Ve(Ye,st,xe,he);return Ye}function Ve(Be,ee,oe,fe){Be.minX=Math.min(Be.minX,ee.minX),Be.minY=Math.min(Be.minY,ee.minY),Be.maxX=Math.max(Be.maxX,ee.maxX),Be.maxY=Math.max(Be.maxY,ee.maxY);let he,xe=ee.tags||null;switch(ee.type){case"Point":case"MultiPoint":{const Ye=[];for(let st=0;st<ee.geometry.length;st+=3)Ye.push(ee.geometry[st],ee.geometry[st+1]),Be.numPoints++,Be.numSimplified++;if(!Ye.length)return;he={type:1,tags:xe,geometry:Ye};break}case"LineString":{const Ye=[];if(Se(Ye,ee.geometry,Be,oe,!1,!1),!Ye.length)return;if(fe.lineMetrics){xe={};for(const st in ee.tags)xe[st]=ee.tags[st];xe.mapbox_clip_start=ee.geometry.start/ee.geometry.size,xe.mapbox_clip_end=ee.geometry.end/ee.geometry.size}he={type:2,tags:xe,geometry:Ye};break}case"MultiLineString":case"Polygon":{const Ye=[];for(let st=0;st<ee.geometry.length;st++)Se(Ye,ee.geometry[st],Be,oe,ee.type==="Polygon",st===0);if(!Ye.length)return;he={type:ee.type==="Polygon"?3:2,tags:xe,geometry:Ye};break}case"MultiPolygon":{const Ye=[];for(let st=0;st<ee.geometry.length;st++){const _e=ee.geometry[st];for(let Fe=0;Fe<_e.length;Fe++)Se(Ye,_e[Fe],Be,oe,!0,Fe===0)}if(!Ye.length)return;he={type:3,tags:xe,geometry:Ye};break}}ee.id!==null&&(he.id=ee.id),Be.features.push(he)}function Se(Be,ee,oe,fe,he,xe){const Ye=fe*fe;if(fe>0&&ee.size<(he?Ye:fe))return void(oe.numPoints+=ee.length/3);const st=[];for(let _e=0;_e<ee.length;_e+=3)(fe===0||ee[_e+2]>Ye)&&(oe.numSimplified++,st.push(ee[_e],ee[_e+1])),oe.numPoints++;he&&function(_e,Fe){let Ge=0;for(let je=0,De=_e.length,zt=De-2;je<De;zt=je,je+=2)Ge+=(_e[je]-_e[zt])*(_e[je+1]+_e[zt+1]);if(Ge>0===Fe)for(let je=0,De=_e.length;je<De/2;je+=2){const zt=_e[je],fn=_e[je+1];_e[je]=_e[De-2-je],_e[je+1]=_e[De-1-je],_e[De-2-je]=zt,_e[De-1-je]=fn}}(st,xe),Be.push(st)}function bt(Be,ee,oe){const fe=!!ee.newGeometry,he=ee.removeAllProperties||ee.removeProperties?.length>0||ee.addOrUpdateProperties?.length>0;if(fe){let xe=nt({type:"FeatureCollection",features:[{type:"Feature",id:Be.id,geometry:ee.newGeometry,properties:he?Nt(Be.tags,ee):Be.tags}]},oe);return xe=An(xe,oe),xe[0]}if(he){const xe={...Be};return xe.tags=Nt(xe.tags,ee),xe}return null}function Nt(Be,ee){if(ee.removeAllProperties)return{};const oe={...Be||{}};if(ee.removeProperties)for(const fe of ee.removeProperties)delete oe[fe];if(ee.addOrUpdateProperties)for(const{key:fe,value:he}of ee.addOrUpdateProperties)oe[fe]=he;return oe}const jt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,updateable:!1,debug:0};class Ut{options;tiles;tileCoords;stats={};total=0;source;constructor(ee,oe){const fe=(oe=this.options=Object.assign({},jt,oe)).debug;if(fe&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");let he=nt(ee,oe);this.tiles={},this.tileCoords=[],fe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=An(he,oe),he.length&&this.splitTile(he,0,0,0),oe.updateable&&(this.source=he),fe&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,oe,fe,he,xe,Ye,st){const _e=[ee,oe,fe,he],Fe=this.options,Ge=Fe.debug;for(;_e.length;){he=_e.pop(),fe=_e.pop(),oe=_e.pop(),ee=_e.pop();const je=1<<oe,De=yn(oe,fe,he);let zt=this.tiles[De];if(!zt&&(Ge>1&&console.time("creation"),zt=this.tiles[De]=dn(ee,oe,fe,he,Fe),this.tileCoords.push({z:oe,x:fe,y:he,id:De}),Ge)){Ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,fe,he,zt.numFeatures,zt.numPoints,zt.numSimplified),console.timeEnd("creation"));const ft=`z${oe}`;this.stats[ft]=(this.stats[ft]||0)+1,this.total++}if(zt.source=ee,xe==null){if(oe===Fe.indexMaxZoom||zt.numPoints<=Fe.indexMaxPoints)continue}else{if(oe===Fe.maxZoom||oe===xe)continue;if(xe!=null){const ft=xe-oe;if(fe!==Ye>>ft||he!==st>>ft)continue}}if(zt.source=null,!ee.length)continue;Ge>1&&console.time("clipping");const fn=.5*Fe.buffer/Fe.extent,sn=.5-fn,Jt=.5+fn,cn=1+fn;let Zn=null,yr=null,Ar=null,Je=null;const gt=ot(ee,je,fe-fn,fe+Jt,0,zt.minX,zt.maxX,Fe),St=ot(ee,je,fe+sn,fe+cn,0,zt.minX,zt.maxX,Fe);gt&&(Zn=ot(gt,je,he-fn,he+Jt,1,zt.minY,zt.maxY,Fe),yr=ot(gt,je,he+sn,he+cn,1,zt.minY,zt.maxY,Fe)),St&&(Ar=ot(St,je,he-fn,he+Jt,1,zt.minY,zt.maxY,Fe),Je=ot(St,je,he+sn,he+cn,1,zt.minY,zt.maxY,Fe)),Ge>1&&console.timeEnd("clipping"),_e.push(Zn||[],oe+1,2*fe,2*he),_e.push(yr||[],oe+1,2*fe,2*he+1),_e.push(Ar||[],oe+1,2*fe+1,2*he),_e.push(Je||[],oe+1,2*fe+1,2*he+1)}}getTile(ee,oe,fe){ee=+ee,oe=+oe,fe=+fe;const he=this.options,{extent:xe,debug:Ye}=he;if(ee<0||ee>24)return null;const st=1<<ee,_e=yn(ee,oe=oe+st&st-1,fe);if(this.tiles[_e])return Wt(this.tiles[_e],xe);Ye>1&&console.log("drilling down to z%d-%d-%d",ee,oe,fe);let Fe,Ge=ee,je=oe,De=fe;for(;!Fe&&Ge>0;)Ge--,je>>=1,De>>=1,Fe=this.tiles[yn(Ge,je,De)];return Fe?.source?(Ye>1&&(console.log("found parent tile z%d-%d-%d",Ge,je,De),console.time("drilling down")),this.splitTile(Fe.source,Ge,je,De,ee,oe,fe),Ye>1&&console.timeEnd("drilling down"),this.tiles[_e]?Wt(this.tiles[_e],xe):null):null}invalidateTiles(ee){const oe=this.options,{debug:fe}=oe;let he=1/0,xe=-1/0,Ye=1/0,st=-1/0;for(const Ge of ee)he=Math.min(he,Ge.minX),xe=Math.max(xe,Ge.maxX),Ye=Math.min(Ye,Ge.minY),st=Math.max(st,Ge.maxY);const _e=oe.buffer/oe.extent,Fe=new Set;for(const Ge in this.tiles){const je=this.tiles[Ge],De=1<<je.z,zt=(je.x-_e)/De,fn=(je.x+1+_e)/De,sn=(je.y-_e)/De,Jt=(je.y+1+_e)/De;if(xe<zt||he>=fn||st<sn||Ye>=Jt)continue;let cn=!1;for(const Zn of ee)if(Zn.maxX>=zt&&Zn.minX<fn&&Zn.maxY>=sn&&Zn.minY<Jt){cn=!0;break}if(cn){if(fe){fe>1&&console.log("invalidate tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",je.z,je.x,je.y,je.numFeatures,je.numPoints,je.numSimplified);const Zn=`z${je.z}`;this.stats[Zn]=(this.stats[Zn]||0)-1,this.total--}delete this.tiles[Ge],Fe.add(Ge)}}Fe.size&&(this.tileCoords=this.tileCoords.filter(Ge=>!Fe.has(Ge.id)))}updateData(ee){const oe=this.options,fe=oe.debug;if(!oe.updateable)throw new Error("to update tile geojson `updateable` option must be set to true");const{affected:he,source:xe}=function(je,De,zt){const fn=function(Jt){return Jt?{removeAll:Jt.removeAll,remove:new Set(Jt.remove||[]),add:new Map(Jt.add?.map(cn=>[cn.id,cn])),update:new Map(Jt.update?.map(cn=>[cn.id,cn]))}:{remove:new Set,add:new Map,update:new Map}}(De);let sn=[];if(fn.removeAll&&(sn=je,je=[]),fn.remove.size||fn.add.size){const Jt=[];for(const cn of je){const{id:Zn}=cn;(fn.remove.has(Zn)||fn.add.has(Zn))&&Jt.push(cn)}if(Jt.length){sn.push(...Jt);const cn=new Set(Jt.map(Zn=>Zn.id));je=je.filter(Zn=>!cn.has(Zn.id))}if(fn.add.size){let cn=nt({type:"FeatureCollection",features:Array.from(fn.add.values())},zt);cn=An(cn,zt),sn.push(...cn),je.push(...cn)}}if(fn.update.size)for(const[Jt,cn]of fn.update){const Zn=je.findIndex(Je=>Je.id===Jt);if(Zn===-1)continue;const yr=je[Zn],Ar=bt(yr,cn,zt);Ar&&(sn.push(yr,Ar),je[Zn]=Ar)}return{affected:sn,source:je}}(this.source,ee,oe);if(!he.length)return;this.source=xe,fe>1&&(console.log("invalidating tiles"),console.time("invalidating")),this.invalidateTiles(he),fe>1&&console.timeEnd("invalidating");const[Ye,st,_e]=[0,0,0],Fe=dn(this.source,Ye,st,_e,this.options);Fe.source=this.source;const Ge=yn(Ye,st,_e);if(this.tiles[Ge]=Fe,this.tileCoords.push({z:Ye,x:st,y:_e,id:Ge}),fe){const je=`z${Ye}`;this.stats[je]=(this.stats[je]||0)+1,this.total++}}}function yn(Be,ee,oe){return 32*((1<<Be)*oe+ee)+Be}class Zt{constructor(ee,oe,fe,he=qt){this._dataUpdateable=new Map,this.actor=ee,this.layerIndex=oe,this.availableImages=fe,this.tileState=new M,this._createGeoJSONIndex=he}loadVectorTile(ee){if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const{z:oe,x:fe,y:he}=ee.tileID.canonical,xe=this._geoJSONIndex.getTile(oe,fe,he);return xe?z(new u.d3(xe.features,{version:2,extent:u.a5})):null}loadTile(ee){return u._(this,void 0,void 0,function*(){const{uid:oe}=ee,fe=new _(ee);fe.abort=new AbortController;try{const he=this.loadVectorTile(ee);if(!he)return null;const{vectorTile:xe,rawData:Ye}=he;fe.vectorTile=xe,this.tileState.markLoaded(oe,fe);const st={rawData:Ye};this.tileState.setParsing(oe,st);try{return yield this._parseWorkerTile(fe,ee,st)}finally{this.tileState.clearParsing(oe)}}catch(he){throw fe.status="done",this.tileState.markLoaded(oe,fe),he}})}_reloadLoadedTile(ee){return u._(this,void 0,void 0,function*(){const oe=ee.uid,fe=this.tileState.getLoaded(oe);if(!fe)throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");if(fe.showCollisionBoxes=ee.showCollisionBoxes,fe.status==="parsing"){const he=this.tileState.consumeParsing(oe);return yield this._parseWorkerTile(fe,ee,he)}if(fe.status==="done"&&fe.vectorTile)return yield this._parseWorkerTile(fe,ee)})}_parseWorkerTile(ee,oe,fe){return u._(this,void 0,void 0,function*(){let he=yield ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,oe.subdivisionGranularity);if(fe){const{rawData:xe}=fe;he=u.e({rawTileData:xe.slice(0)},he)}return he})}abortTile(ee){return u._(this,void 0,void 0,function*(){this.tileState.abort(ee.uid)})}removeTile(ee){return u._(this,void 0,void 0,function*(){this.tileState.removeLoaded(ee.uid)})}loadData(ee){return u._(this,void 0,void 0,function*(){var oe;(oe=this._pendingRequest)===null||oe===void 0||oe.abort();const fe=this._startRequestTiming(ee);this._pendingRequest=new AbortController;try{(!this._pendingData||ee.request||ee.data||ee.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest));const he=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(he,ee),this.tileState.clearLoaded();const xe={};return ee.request&&(xe.data=he),this._finishRequestTiming(fe,ee,xe),xe}catch(he){if(delete this._pendingRequest,u.Z(he))return{abandoned:!0};throw he}})}_startRequestTiming(ee){var oe;if(!((oe=ee.request)===null||oe===void 0)&&oe.collectResourceTiming)return new u.c$(ee.request.url)}_finishRequestTiming(ee,oe,fe){const he=ee?.finish();he&&(fe.resourceTiming={[oe.source]:JSON.parse(JSON.stringify(he))})}getData(){return u._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){return this.tileState.getLoaded(ee.uid)?this._reloadLoadedTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,oe){return u._(this,void 0,void 0,function*(){let fe;if(ee.request?fe=yield this.loadGeoJSONFromUrl(ee.request,ee.promoteId,oe):ee.data?fe=this._loadGeoJSONFromObject(ee.data,ee.promoteId):ee.dataDiff&&(fe=this._loadGeoJSONFromDiff(ee.dataDiff,ee.promoteId,ee.source)),delete this._pendingRequest,typeof fe!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);return se(fe,!0),ee.filter&&(fe=this._filterGeoJSON(fe,ee.filter)),fe})}loadGeoJSONFromUrl(ee,oe,fe){return u._(this,void 0,void 0,function*(){const he=yield u.j(ee,fe);return this._dataUpdateable=u.a7(he.data,oe),he.data})}_loadGeoJSONFromObject(ee,oe){return this._dataUpdateable=u.a7(ee,oe),ee}_loadGeoJSONFromDiff(ee,oe,fe){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${fe}`);u.a8(this._dataUpdateable,ee,oe);const he=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(he)}_filterGeoJSON(ee,oe){const fe=u.d4(oe,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(xe=>`${xe.key}: ${xe.message}`).join(", "));const he=ee.features.filter(xe=>fe.value.evaluate({zoom:0},xe));return this._toFeatureCollection(he)}_toFeatureCollection(ee){return{type:"FeatureCollection",features:ee}}removeSource(ee){return u._(this,void 0,void 0,function*(){var oe;(oe=this._pendingRequest)===null||oe===void 0||oe.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}function qt(Be,ee){return ee.cluster?new H(function({superclusterOptions:oe,clusterProperties:fe}){if(!fe||!oe)return oe;const he={},xe={},Ye={accumulated:null,zoom:0},st={properties:null},_e=Object.keys(fe);for(const Fe of _e){const[Ge,je]=fe[Fe],De=u.d4(je),zt=u.d4(typeof Ge=="string"?[Ge,["accumulated"],["get",Fe]]:Ge);he[Fe]=De.value,xe[Fe]=zt.value}return oe.map=Fe=>{st.properties=Fe;const Ge={};for(const je of _e)Ge[je]=he[je].evaluate(Ye,st);return Ge},oe.reduce=(Fe,Ge)=>{st.properties=Ge;for(const je of _e)Ye.accumulated=Fe[je],Fe[je]=xe[je].evaluate(Ye,st)},oe}(ee)).load(Be.features):function(oe,fe){return new Ut(oe,fe)}(Be,ee.geojsonVtOptions)}class Fn{constructor(ee){this.self=ee,this.actor=new u.L(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(oe,fe)=>{if(this.externalWorkerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.externalWorkerSourceTypes[oe]=fe},this.self.addProtocol=u.cK,this.self.removeProtocol=u.cL,this.self.registerRTLTextPlugin=oe=>{u.d5.setMethods(oe)},this.actor.registerMessageHandler("LDT",(oe,fe)=>this._getDEMWorkerSource(oe,fe.source).loadTile(fe)),this.actor.registerMessageHandler("RDT",(oe,fe)=>u._(this,void 0,void 0,function*(){this._getDEMWorkerSource(oe,fe.source).removeTile(fe)})),this.actor.registerMessageHandler("GCEZ",(oe,fe)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(oe,fe.type,fe.source).getClusterExpansionZoom(fe)})),this.actor.registerMessageHandler("GCC",(oe,fe)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(oe,fe.type,fe.source).getClusterChildren(fe)})),this.actor.registerMessageHandler("GCL",(oe,fe)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(oe,fe.type,fe.source).getClusterLeaves(fe)})),this.actor.registerMessageHandler("LD",(oe,fe)=>this._getWorkerSource(oe,fe.type,fe.source).loadData(fe)),this.actor.registerMessageHandler("GD",(oe,fe)=>this._getWorkerSource(oe,fe.type,fe.source).getData()),this.actor.registerMessageHandler("LT",(oe,fe)=>this._getWorkerSource(oe,fe.type,fe.source).loadTile(fe)),this.actor.registerMessageHandler("RT",(oe,fe)=>this._getWorkerSource(oe,fe.type,fe.source).reloadTile(fe)),this.actor.registerMessageHandler("AT",(oe,fe)=>this._getWorkerSource(oe,fe.type,fe.source).abortTile(fe)),this.actor.registerMessageHandler("RMT",(oe,fe)=>this._getWorkerSource(oe,fe.type,fe.source).removeTile(fe)),this.actor.registerMessageHandler("RS",(oe,fe)=>u._(this,void 0,void 0,function*(){if(!this.workerSources[oe]||!this.workerSources[oe][fe.type]||!this.workerSources[oe][fe.type][fe.source])return;const he=this.workerSources[oe][fe.type][fe.source];delete this.workerSources[oe][fe.type][fe.source],he.removeSource!==void 0&&he.removeSource(fe)})),this.actor.registerMessageHandler("RM",oe=>u._(this,void 0,void 0,function*(){delete this.layerIndexes[oe],delete this.availableImages[oe],delete this.workerSources[oe],delete this.demWorkerSources[oe],this.globalStates.delete(oe)})),this.actor.registerMessageHandler("SR",(oe,fe)=>u._(this,void 0,void 0,function*(){this.referrer=fe})),this.actor.registerMessageHandler("SRPS",(oe,fe)=>this._syncRTLPluginState(oe,fe)),this.actor.registerMessageHandler("IS",(oe,fe)=>u._(this,void 0,void 0,function*(){this.self.importScripts(fe)})),this.actor.registerMessageHandler("SI",(oe,fe)=>this._setImages(oe,fe)),this.actor.registerMessageHandler("UL",(oe,fe)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(oe).update(fe.layers,fe.removedIds,this._getGlobalState(oe))})),this.actor.registerMessageHandler("UGS",(oe,fe)=>u._(this,void 0,void 0,function*(){const he=this._getGlobalState(oe);for(const xe in fe)he[xe]=fe[xe]})),this.actor.registerMessageHandler("SL",(oe,fe)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(oe).replace(fe,this._getGlobalState(oe))}))}_getGlobalState(ee){let oe=this.globalStates.get(ee);return oe||(oe={},this.globalStates.set(ee,oe)),oe}_setImages(ee,oe){return u._(this,void 0,void 0,function*(){this.availableImages[ee]=oe;for(const fe in this.workerSources[ee]){const he=this.workerSources[ee][fe];for(const xe in he)he[xe].availableImages=oe}})}_syncRTLPluginState(ee,oe){return u._(this,void 0,void 0,function*(){return yield u.d5.syncState(oe,this.self.importScripts)})}_getAvailableImages(ee){let oe=this.availableImages[ee];return oe||(oe=[]),oe}_getLayerIndex(ee){let oe=this.layerIndexes[ee];return oe||(oe=this.layerIndexes[ee]=new s),oe}_getWorkerSource(ee,oe,fe){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][oe]||(this.workerSources[ee][oe]={}),!this.workerSources[ee][oe][fe]){const he={sendAsync:(xe,Ye)=>(xe.targetMapId=ee,this.actor.sendAsync(xe,Ye))};switch(oe){case"vector":this.workerSources[ee][oe][fe]=new O(he,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][oe][fe]=new Zt(he,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][oe][fe]=new this.externalWorkerSourceTypes[oe](he,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][oe][fe]}_getDEMWorkerSource(ee,oe){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][oe]||(this.demWorkerSources[ee][oe]=new j),this.demWorkerSources[ee][oe]}}return u.i(self)&&(self.worker=new Fn(self)),Fn}),a("index",["exports","./shared"],function(u,s){var m="5.18.0";function _(){var E=new s.A(4);return s.A!=Float32Array&&(E[1]=0,E[2]=0),E[0]=1,E[3]=1,E}let b,M,C;const A={frame(E,o,d,g){const x=g||window,T=x.requestAnimationFrame(N=>{D(),o(N)}),{unsubscribe:D}=s.s(E.signal,"abort",()=>{D(),x.cancelAnimationFrame(T),d(new s.a(E.signal.reason))},!1)},frameAsync(E,o){return new Promise((d,g)=>{this.frame(E,d,g,o)})},getImageData(E,o=0){return this.getImageCanvasContext(E).getImageData(-o,-o,E.width+2*o,E.height+2*o)},getImageCanvasContext(E){const o=window.document.createElement("canvas"),d=o.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return o.width=E.width,o.height=E.height,d.drawImage(E,0,0,E.width,E.height),d},resolveURL:E=>(b||(b=document.createElement("a")),b.href=E,b.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return C!==void 0?C:!!matchMedia&&(M==null&&(M=matchMedia("(prefers-reduced-motion: reduce)")),M.matches)},set prefersReducedMotion(E){C=E}},k=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(E){this._frozenAt=E}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function z(){return k.getCurrentTime()}class P{static testProp(o){if(!P.docStyle)return o[0];for(let d=0;d<o.length;d++)if(o[d]in P.docStyle)return o[d];return o[0]}static create(o,d,g){const x=window.document.createElement(o);return d!==void 0&&(x.className=d),g&&g.appendChild(x),x}static createNS(o,d){return window.document.createElementNS(o,d)}static disableDrag(){P.docStyle&&P.selectProp&&(P.userSelect=P.docStyle[P.selectProp],P.docStyle[P.selectProp]="none")}static enableDrag(){P.docStyle&&P.selectProp&&(P.docStyle[P.selectProp]=P.userSelect)}static setTransform(o,d){o.style[P.transformProp]=d}static addEventListener(o,d,g,x={}){o.addEventListener(d,g,"passive"in x?x:x.capture)}static removeEventListener(o,d,g,x={}){o.removeEventListener(d,g,"passive"in x?x:x.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",P.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",P.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",P.suppressClickInternal,!0)},0)}static getScale(o){const d=o.getBoundingClientRect();return{x:d.width/o.offsetWidth||1,y:d.height/o.offsetHeight||1,boundingClientRect:d}}static getPoint(o,d,g){const x=d.boundingClientRect;return new s.P((g.clientX-x.left)/d.x-o.clientLeft,(g.clientY-x.top)/d.y-o.clientTop)}static mousePos(o,d){const g=P.getScale(o);return P.getPoint(o,g,d)}static touchPos(o,d){const g=[],x=P.getScale(o);for(let T=0;T<d.length;T++)g.push(P.getPoint(o,x,d[T]));return g}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}static sanitize(o){const d=new DOMParser().parseFromString(o,"text/html").body||document.createElement("body"),g=d.querySelectorAll("script");for(const x of g)x.remove();return P.clean(d),d.innerHTML}static isPossiblyDangerous(o,d){const g=d.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(o)||!g.includes("javascript:")&&!g.includes("data:"))||!!o.startsWith("on")||void 0}static clean(o){const d=o.children;for(const g of d)P.removeAttributes(g),P.clean(g)}static removeAttributes(o){for(const{name:d,value:g}of o.attributes)P.isPossiblyDangerous(d,g)&&o.removeAttribute(d)}}P.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,P.selectProp=P.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),P.transformProp=P.testProp(["transform","WebkitTransform"]);const O={supported:!1,testSupport:function(E){!X&&U&&(K?se(E):j=E)}};let j,U,X=!1,K=!1;function se(E){const o=E.createTexture();E.bindTexture(E.TEXTURE_2D,o);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,U),E.isContextLost())return;O.supported=!0}catch{}E.deleteTexture(o),X=!0}var J;typeof document<"u"&&(U=document.createElement("img"),U.onload=()=>{j&&se(j),j=null,K=!0},U.onerror=()=>{X=!0,j=null},U.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(E){let o,d,g,x;E.resetRequestQueue=()=>{o=[],d=0,g=0,x={}},E.addThrottleControl=V=>{const Z=g++;return x[Z]=V,Z},E.removeThrottleControl=V=>{delete x[V],D()},E.getImage=(V,Z,Q=!0)=>new Promise((ce,le)=>{O.supported&&(V.headers||(V.headers={}),V.headers.accept="image/webp,*/*"),s.e(V,{type:"image"}),o.push({abortController:Z,requestParameters:V,supportImageRefresh:Q,state:"queued",onError:ge=>{le(ge)},onSuccess:ge=>{ce(ge)}}),D()});const T=V=>s._(this,void 0,void 0,function*(){V.state="running";const{requestParameters:Z,supportImageRefresh:Q,onError:ce,onSuccess:le,abortController:ge}=V,be=Q===!1&&!s.i(self)&&!s.g(Z.url)&&(!Z.headers||Object.keys(Z.headers).reduce((Ne,qe)=>Ne&&qe==="accept",!0));d++;const ze=be?N(Z,ge):s.m(Z,ge);try{const Ne=yield ze;delete V.abortController,V.state="completed",Ne.data instanceof HTMLImageElement||s.b(Ne.data)?le(Ne):Ne.data&&le({data:yield($e=Ne.data,typeof createImageBitmap=="function"?s.f($e):s.h($e)),cacheControl:Ne.cacheControl,expires:Ne.expires})}catch(Ne){delete V.abortController,ce(Ne)}finally{d--,D()}var $e}),D=()=>{const V=(()=>{for(const Z of Object.keys(x))if(x[Z]())return!0;return!1})()?s.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let Z=d;Z<V&&o.length>0;Z++){const Q=o.shift();Q.abortController.signal.aborted?Z--:T(Q)}},N=(V,Z)=>new Promise((Q,ce)=>{const le=new Image,ge=V.url,be=V.credentials;be&&be==="include"?le.crossOrigin="use-credentials":(be&&be==="same-origin"||!s.d(ge))&&(le.crossOrigin="anonymous"),Z.signal.addEventListener("abort",()=>{le.src="",ce(new s.a(Z.signal.reason))}),le.fetchPriority="high",le.onload=()=>{le.onerror=le.onload=null,Q({data:le})},le.onerror=()=>{le.onerror=le.onload=null,Z.signal.aborted||ce(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},le.src=ge})}(J||(J={})),J.resetRequestQueue();class ue{constructor(o){this._transformRequestFn=o??null}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function ne(E){const o=[];if(typeof E=="string")o.push({id:"default",url:E});else if(E&&E.length>0){const d=[];for(const{id:g,url:x}of E){const T=`${g}${x}`;d.indexOf(T)===-1&&(d.push(T),o.push({id:g,url:x}))}}return o}function H(E,o,d){try{const g=new URL(E);return g.pathname+=`${o}${d}`,g.toString()}catch{throw new Error(`Invalid sprite URL "${E}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function de(E){const{userImage:o}=E;return!!(o&&o.render&&o.render())&&(E.data.replace(new Uint8Array(o.data.buffer)),!0)}class Ee extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const o of Object.keys(this.images))this.removeImage(o);this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,promiseResolve:g}of this.requestors)g(this._getImagesForIds(d));this.requestors=[]}}getImage(o){const d=this.images[o];if(d&&!d.data&&d.spriteData){const g=d.spriteData;d.data=new s.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),d.spriteData=null}return d}addImage(o,d){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let g=!0;const x=d.data||d.spriteData;return this._validateStretch(d.stretchX,x&&x.width)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(d.stretchY,x&&x.height)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(d.content,d)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,d){if(!o)return!0;let g=0;for(const x of o){if(x[0]<g||x[1]<x[0]||d<x[1])return!1;g=x[1]}return!0}_validateContent(o,d){if(!o)return!0;if(o.length!==4)return!1;const g=d.spriteData,x=g&&g.width||d.data.width,T=g&&g.height||d.data.height;return!(o[0]<0||x<o[0]||o[1]<0||T<o[1]||o[2]<0||x<o[2]||o[3]<0||T<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,d,g=!0){const x=this.getImage(o);if(g&&(x.data.width!==d.data.width||x.data.height!==d.data.height))throw new Error(`size mismatch between old image (${x.data.width}x${x.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=x.version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((d,g)=>{let x=!0;if(!this.isLoaded())for(const T of o)this.images[T]||(x=!1);this.isLoaded()||x?d(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:d})})}_getImagesForIds(o){const d={};for(const g of o){let x=this.getImage(g);x||(this.fire(new s.l("styleimagemissing",{id:g})),x=this.getImage(g)),x?d[g]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,textFitWidth:x.textFitWidth,textFitHeight:x.textFitHeight,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:s.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],g=this.getImage(o);if(!g)return null;if(d&&d.position.version===g.version)return d.position;if(d)d.position.version=g.version;else{const x={w:g.data.width+2,h:g.data.height+2,x:0,y:0},T=new s.I(x,g);this.patterns[o]={bin:x,position:T}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const T in this.patterns)o.push(this.patterns[T].bin);const{w:d,h:g}=s.p(o),x=this.atlasImage;x.resize({width:d||1,height:g||1});for(const T in this.patterns){const{bin:D}=this.patterns[T],N=D.x+1,V=D.y+1,Z=this.getImage(T).data,Q=Z.width,ce=Z.height;s.R.copy(Z,x,{x:0,y:0},{x:N,y:V},{width:Q,height:ce}),s.R.copy(Z,x,{x:0,y:ce-1},{x:N,y:V-1},{width:Q,height:1}),s.R.copy(Z,x,{x:0,y:0},{x:N,y:V+ce},{width:Q,height:1}),s.R.copy(Z,x,{x:Q-1,y:0},{x:N-1,y:V},{width:1,height:ce}),s.R.copy(Z,x,{x:0,y:0},{x:N+Q,y:V},{width:1,height:ce})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const g=this.getImage(d);g||s.w(`Image with ID: "${d}" was not found`),de(g)&&this.updateImage(d,g)}}cloneImages(){const o={};for(const d in this.images){const g=this.images[d];o[d]=Object.assign(Object.assign({},g),{data:g.data?g.data.clone():null})}return o}}const Pe=1e20;function Ze(E,o,d,g,x,T,D,N,V){for(let Z=o;Z<o+g;Z++)ke(E,d*T+Z,T,x,D,N,V);for(let Z=d;Z<d+x;Z++)ke(E,Z*T+o,1,g,D,N,V)}function ke(E,o,d,g,x,T,D){T[0]=0,D[0]=-Pe,D[1]=Pe,x[0]=E[o];for(let N=1,V=0,Z=0;N<g;N++){x[N]=E[o+N*d];const Q=N*N;do{const ce=T[V];Z=(x[N]-x[ce]+Q-ce*ce)/(N-ce)/2}while(Z<=D[V]&&--V>-1);V++,T[V]=N,D[V]=Z,D[V+1]=Pe}for(let N=0,V=0;N<g;N++){for(;D[V+1]<N;)V++;const Z=T[V],Q=N-Z;E[o+N*d]=x[Z]+Q*Q}}const Te=s.v.layout_symbol["text-font"].default.join(",");class Ie{constructor(o,d,g){this.requestManager=o,this.localIdeographFontFamily=d,this.entries={},this.lang=g}setURL(o){this.url=o}getGlyphs(o){return s._(this,void 0,void 0,function*(){const d=[];for(const T in o)for(const D of o[T])d.push(this._getAndCacheGlyphsPromise(T,D));const g=yield Promise.all(d),x={};for(const{stack:T,id:D,glyph:N}of g)x[T]||(x[T]={}),x[T][D]=N&&{id:N.id,bitmap:N.bitmap.clone(),metrics:N.metrics};return x})}_getAndCacheGlyphsPromise(o,d){return s._(this,void 0,void 0,function*(){let g=this.entries[o];g||(g=this.entries[o]={glyphs:{},requests:{},ranges:{}});let x=g.glyphs[d];return x!==void 0?{stack:o,id:d,glyph:x}:!this.url||this._charUsesLocalIdeographFontFamily(d)?(x=g.glyphs[d]=this._drawGlyph(g,o,d),{stack:o,id:d,glyph:x}):yield this._downloadAndCacheRangePromise(o,d)})}_downloadAndCacheRangePromise(o,d){return s._(this,void 0,void 0,function*(){const g=this.entries[o],x=Math.floor(d/256);if(g.ranges[x])return{stack:o,id:d,glyph:null};if(!g.requests[x]){const T=Ie.loadGlyphRange(o,x,this.url,this.requestManager);g.requests[x]=T}try{const T=yield g.requests[x];for(const D in T)g.glyphs[+D]=T[+D];return g.ranges[x]=!0,{stack:o,id:d,glyph:T[d]||null}}catch(T){const D=g.glyphs[d]=this._drawGlyph(g,o,d);return this._warnOnMissingGlyphRange(D,x,d,T),{stack:o,id:d,glyph:D}}})}_warnOnMissingGlyphRange(o,d,g,x){const T=256*d,D=T+255,N=g.toString(16).padStart(4,"0").toUpperCase();s.w(`Unable to load glyph range ${d}, ${T}-${D}. Rendering codepoint U+${N} locally instead. ${x}`)}_charUsesLocalIdeographFontFamily(o){return!!this.localIdeographFontFamily&&s.q(o)}_drawGlyph(o,d,g){const x=d===Te&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(g),T=x?"ideographTinySDF":"tinySDF";o[T]||(o[T]=this._createTinySDF(x?this.localIdeographFontFamily:d));const D=o[T].draw(String.fromCodePoint(g)),N=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(g));return{id:g,bitmap:new s.r({width:D.width||60,height:D.height||60},D.data),metrics:{width:N?0:D.glyphWidth/2||24,height:D.glyphHeight/2||24,left:D.glyphLeft/2+.5||0,top:D.glyphTop/2-27.5||-8,advance:N?0:D.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(o){const d=o?o.split(","):[];d.push("sans-serif");const g=d.map(x=>/[-\w]+/.test(x)?x:`'${CSS.escape(x)}'`).join(",");return new Ie.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:this._fontWeight(d[0]),fontStyle:this._fontStyle(d[0]),lang:this.lang})}_fontStyle(o){return/italic/i.test(o)?"italic":/oblique/i.test(o)?"oblique":"normal"}_fontWeight(o){const d={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let g;for(const[x,T]of Object.entries(d))new RegExp(`\\b${x}\\b`,"i").test(o)&&(g=`${T}`);return g}destroy(){for(const o in this.entries){const d=this.entries[o];d.tinySDF&&(d.tinySDF=null),d.ideographTinySDF&&(d.ideographTinySDF=null),d.glyphs={},d.requests={},d.ranges={}}this.entries={}}}Ie.loadGlyphRange=function(E,o,d,g){return s._(this,void 0,void 0,function*(){const x=256*o,T=x+255,D=g.transformRequest(d.replace("{fontstack}",E).replace("{range}",`${x}-${T}`),"Glyphs"),N=yield s.n(D,new AbortController);if(!N||!N.data)throw new Error(`Could not load glyph range. range: ${o}, ${x}-${T}`);const V={};for(const Z of s.o(N.data))V[Z.id]=Z;return V})},Ie.TinySDF=class{constructor({fontSize:E=24,buffer:o=3,radius:d=8,cutoff:g=.25,fontFamily:x="sans-serif",fontWeight:T="normal",fontStyle:D="normal",lang:N=null}={}){this.buffer=o,this.cutoff=g,this.radius=d,this.lang=N;const V=this.size=E+4*o,Z=this._createCanvas(V),Q=this.ctx=Z.getContext("2d",{willReadFrequently:!0});Q.font=`${D} ${T} ${E}px ${x}`,Q.textBaseline="alphabetic",Q.textAlign="left",Q.fillStyle="black",this.gridOuter=new Float64Array(V*V),this.gridInner=new Float64Array(V*V),this.f=new Float64Array(V),this.z=new Float64Array(V+1),this.v=new Uint16Array(V)}_createCanvas(E){const o=document.createElement("canvas");return o.width=o.height=E,o}draw(E){const{width:o,actualBoundingBoxAscent:d,actualBoundingBoxDescent:g,actualBoundingBoxLeft:x,actualBoundingBoxRight:T}=this.ctx.measureText(E),D=Math.ceil(d),N=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(T-x))),V=Math.min(this.size-this.buffer,D+Math.ceil(g)),Z=N+2*this.buffer,Q=V+2*this.buffer,ce=Math.max(Z*Q,0),le=new Uint8ClampedArray(ce),ge={data:le,width:Z,height:Q,glyphWidth:N,glyphHeight:V,glyphTop:D,glyphLeft:0,glyphAdvance:o};if(N===0||V===0)return ge;const{ctx:be,buffer:ze,gridInner:$e,gridOuter:Ne}=this;this.lang&&(be.lang=this.lang),be.clearRect(ze,ze,N,V),be.fillText(E,ze,ze+D);const qe=be.getImageData(ze,ze,N,V);Ne.fill(Pe,0,ce),$e.fill(0,0,ce);for(let it=0;it<V;it++)for(let Xe=0;Xe<N;Xe++){const rt=qe.data[4*(it*N+Xe)+3]/255;if(rt===0)continue;const ht=(it+ze)*Z+Xe+ze;if(rt===1)Ne[ht]=0,$e[ht]=Pe;else{const Qe=.5-rt;Ne[ht]=Qe>0?Qe*Qe:0,$e[ht]=Qe<0?Qe*Qe:0}}Ze(Ne,0,0,Z,Q,Z,this.f,this.v,this.z),Ze($e,ze,ze,N,V,Z,this.f,this.v,this.z);for(let it=0;it<ce;it++){const Xe=Math.sqrt(Ne[it])-Math.sqrt($e[it]);le[it]=Math.round(255-255*(Xe/this.radius+this.cutoff))}return ge}};class Ce{constructor(){this.specification=s.u.light.position}possiblyEvaluate(o,d){return s.F(o.expression.evaluate(d))}interpolate(o,d,g){return{x:s.G.number(o.x,d.x,g),y:s.G.number(o.y,d.y,g),z:s.G.number(o.z,d.z,g)}}}let Ue;class nt extends s.E{constructor(o){super(),Ue=Ue||new s.t({anchor:new s.D(s.u.light.anchor),position:new Ce,color:new s.D(s.u.light.color),intensity:new s.D(s.u.light.intensity)}),this._transitionable=new s.x(Ue,void 0),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(s.y,o,d))for(const g in o){const x=o[g];g.endsWith(s.z)?this._transitionable.setTransition(g.slice(0,-s.z.length),x):this._transitionable.setValue(g,x)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,g){return(!g||g.validate!==!1)&&s.B(this,o.call(s.C,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.u}))}}const Le=new s.t({"sky-color":new s.D(s.u.sky["sky-color"]),"horizon-color":new s.D(s.u.sky["horizon-color"]),"fog-color":new s.D(s.u.sky["fog-color"]),"fog-ground-blend":new s.D(s.u.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.u.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.u.sky["atmosphere-blend"])});class lt extends s.E{constructor(o){super(),this._transitionable=new s.x(Le,void 0),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.H(0))}setSky(o,d={}){if(!this._validate(s.J,o,d)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in o){const x=o[g];g.endsWith(s.z)?this._transitionable.setTransition(g.slice(0,-s.z.length),x):this._transitionable.setValue(g,x)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,g={}){return g?.validate!==!1&&s.B(this,o.call(s.C,s.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.u})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class Ht{constructor(o,d){this.width=o,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,d){const g=o.join(",")+String(d);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(o,d)),this.dashEntry[g]}getDashRanges(o,d,g){const x=[];let T=o.length%2==1?-o[o.length-1]*g:0,D=o[0]*g,N=!0;x.push({left:T,right:D,isDash:N,zeroLength:o[0]===0});let V=o[0];for(let Z=1;Z<o.length;Z++){N=!N;const Q=o[Z];T=V*g,V+=Q,D=V*g,x.push({left:T,right:D,isDash:N,zeroLength:Q===0})}return x}addRoundDash(o,d,g){const x=d/2;for(let T=-g;T<=g;T++){const D=this.width*(this.nextRow+g+T);let N=0,V=o[N];for(let Z=0;Z<this.width;Z++){Z/V.right>1&&(V=o[++N]);const Q=Math.abs(Z-V.left),ce=Math.abs(Z-V.right),le=Math.min(Q,ce);let ge;const be=T/g*(x+1);if(V.isDash){const ze=x-Math.abs(be);ge=Math.sqrt(le*le+ze*ze)}else ge=x-Math.sqrt(le*le+be*be);this.data[D+Z]=Math.max(0,Math.min(255,ge+128))}}}addRegularDash(o){for(let N=o.length-1;N>=0;--N){const V=o[N],Z=o[N+1];V.zeroLength?o.splice(N,1):Z&&Z.isDash===V.isDash&&(Z.left=V.left,o.splice(N,1))}const d=o[0],g=o[o.length-1];d.isDash===g.isDash&&(d.left=g.left-this.width,g.right=d.right+this.width);const x=this.width*this.nextRow;let T=0,D=o[T];for(let N=0;N<this.width;N++){N/D.right>1&&(D=o[++T]);const V=Math.abs(N-D.left),Z=Math.abs(N-D.right),Q=Math.min(V,Z);this.data[x+N]=Math.max(0,Math.min(255,(D.isDash?Q:-Q)+128))}}addDash(o,d){const g=d?7:0,x=2*g+1;if(this.nextRow+x>this.height)return s.w("LineAtlas out of space"),null;let T=0;for(let N=0;N<o.length;N++)T+=o[N];if(T!==0){const N=this.width/T,V=this.getDashRanges(o,this.width,N);d?this.addRoundDash(V,N,g):this.addRegularDash(V)}const D={y:this.nextRow+g,height:2*g,width:T};return this.nextRow+=x,this.dirty=!0,D}bind(o){const d=o.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const He="maplibre_preloaded_worker_pool";class pt{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<pt.workerCount;)this.workers.push(new Worker(s.c.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[He]}numActive(){return Object.keys(this.active).length}}const _t=Math.floor(A.hardwareConcurrency/2);let ot,et;function Mt(){return ot||(ot=new pt),ot}pt.workerCount=s.K(globalThis)?Math.max(Math.min(_t,3),1):1;class Tt{constructor(o,d){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=d;const g=this.workerPool.acquire(d);for(let x=0;x<g.length;x++){const T=new s.L(g[x],d);T.name=`Worker ${x}`,this.actors.push(T)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,d){const g=[];for(const x of this.actors)g.push(x.sendAsync({type:o,data:d}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,d){for(const g of this.actors)g.registerMessageHandler(o,d)}unregisterMessageHandler(o){for(const d of this.actors)d.unregisterMessageHandler(o)}}function hn(){return et||(et=new Tt(Mt(),s.M),et.registerMessageHandler("GR",(E,o,d)=>s.m(o,d))),et}function en(E,o){const d=s.N();return s.O(d,d,[1,1,0]),s.Q(d,d,[.5*E.width,.5*E.height,1]),E.calculatePosMatrix?s.S(d,d,E.calculatePosMatrix(o.toUnwrapped())):d}function an(E,o,d,g,x,T,D){var N;const V=function(le,ge,be){if(le)for(const ze of le){const $e=ge[ze];if($e&&$e.source===be&&$e.type==="fill-extrusion")return!0}else for(const ze in ge){const $e=ge[ze];if($e.source===be&&$e.type==="fill-extrusion")return!0}return!1}((N=x?.layers)!==null&&N!==void 0?N:null,o,E.id),Z=T.maxPitchScaleFactor(),Q=E.tilesIn(g,Z,V);Q.sort(Ke);const ce=[];for(const le of Q)ce.push({wrappedTileID:le.tileID.wrapped().key,queryResults:le.tile.queryRenderedFeatures(o,d,E.getState(),le.queryGeometry,le.cameraQueryGeometry,le.scale,x,T,Z,en(T,le.tileID),D?(ge,be)=>D(le.tileID,ge,be):void 0)});return function(le,ge){for(const be in le)for(const ze of le[be])An(ze,ge);return le}(function(le){const ge={},be={};for(const ze of le){const $e=ze.queryResults,Ne=ze.wrappedTileID,qe=be[Ne]=be[Ne]||{};for(const it in $e){const Xe=$e[it],rt=qe[it]=qe[it]||{},ht=ge[it]=ge[it]||[];for(const Qe of Xe)rt[Qe.featureIndex]||(rt[Qe.featureIndex]=!0,ht.push(Qe))}}return ge}(ce),E)}function Ke(E,o){const d=E.tileID,g=o.tileID;return d.overscaledZ-g.overscaledZ||d.canonical.y-g.canonical.y||d.wrap-g.wrap||d.canonical.x-g.canonical.x}function An(E,o){const d=E.feature,g=o.getFeatureState(d.layer["source-layer"],d.id);d.source=d.layer.source,d.layer["source-layer"]&&(d.sourceLayer=d.layer["source-layer"]),d.state=g}function Gt(E,o,d,g){return s._(this,void 0,void 0,function*(){let x=E;if(E.url?x=(yield s.j(o.transformRequest(E.url,"Source"),d)).data:yield A.frameAsync(d,g),!x)return null;const T=s.U(s.e(x,E),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in x&&x.vector_layers&&(T.vectorLayerIds=x.vector_layers.map(D=>D.id)),T})}class on{constructor(o,d){o&&(d?this.setSouthWest(o).setNorthEast(d):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof s.V?new s.V(o.lng,o.lat):s.V.convert(o),this}setSouthWest(o){return this._sw=o instanceof s.V?new s.V(o.lng,o.lat):s.V.convert(o),this}extend(o){const d=this._sw,g=this._ne;let x,T;if(o instanceof s.V)x=o,T=o;else{if(!(o instanceof on))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(on.convert(o)):this.extend(s.V.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(s.V.convert(o)):this;if(x=o._sw,T=o._ne,!x||!T)return this}return d||g?(d.lng=Math.min(x.lng,d.lng),d.lat=Math.min(x.lat,d.lat),g.lng=Math.max(T.lng,g.lng),g.lat=Math.max(T.lat,g.lat)):(this._sw=new s.V(x.lng,x.lat),this._ne=new s.V(T.lng,T.lat)),this}getCenter(){return new s.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.V(this.getWest(),this.getNorth())}getSouthEast(){return new s.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:d,lat:g}=s.V.convert(o);let x=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(x=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&x}intersects(o){if(!((o=on.convert(o)).getNorth()>=this.getSouth()&&o.getSouth()<=this.getNorth()))return!1;const d=Math.abs(this.getEast()-this.getWest()),g=Math.abs(o.getEast()-o.getWest());if(d>=360||g>=360)return!0;const x=s.W(this.getWest(),-180,180),T=s.W(this.getEast(),-180,180),D=s.W(o.getWest(),-180,180),N=s.W(o.getEast(),-180,180),V=x>T,Z=D>N;return!(!V||!Z)||(V?N>=x||D<=T:Z?T>=D||x<=N:D<=T&&N>=x)}static convert(o){return o instanceof on?o:o&&new on(o)}static fromLngLat(o,d=0){const g=360*d/40075017,x=g/Math.cos(Math.PI/180*o.lat);return new on(new s.V(o.lng-x,o.lat-g),new s.V(o.lng+x,o.lat+g))}adjustAntiMeridian(){const o=new s.V(this._sw.lng,this._sw.lat),d=new s.V(this._ne.lng,this._ne.lat);return new on(o,o.lng>d.lng?new s.V(d.lng+360,d.lat):d)}}class Wt{constructor(o,d,g){this.bounds=on.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),g=Math.floor(s.Y(this.bounds.getWest())*d),x=Math.floor(s.X(this.bounds.getNorth())*d),T=Math.ceil(s.Y(this.bounds.getEast())*d),D=Math.ceil(s.X(this.bounds.getSouth())*d);return o.x>=g&&o.x<T&&o.y>=x&&o.y<D}}class Gn extends s.E{constructor(o,d,g,x){if(super(),this.id=o,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.U(d,["url","scheme","tileSize","promoteId","encoding"])),this._options=s.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield Gt(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),o&&(s.e(this,o),o.bounds&&(this.tileBounds=new Wt(o.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this._loaded=!0,s.Z(o)||this.fire(new s.k(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(o){return s._(this,void 0,void 0,function*(){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(d,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(o)};g.request.collectResourceTiming=this._collectResourceTiming;let x="RT";if(o.actor&&o.state!=="expired"){if(o.state==="loading")return new Promise((T,D)=>{o.reloadPromise={resolve:T,reject:D}})}else o.actor=this.dispatcher.getActor(),x="LT";o.abortController=new AbortController;try{const T=yield o.actor.sendAsync({type:x,data:g},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,T)}catch(T){if(delete o.abortController,o.aborted)return;if(T&&T.status!==404)throw T;this._afterTileLoadWorkerResponse(o,null)}})}_getOverzoomParameters(o){if(o.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const d=o.tileID.scaledTo(this.maxzoom).canonical,g=d.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:d,overzoomRequest:this.map._requestManager.transformRequest(g,"Tile")}}_afterTileLoadWorkerResponse(o,d){if(d&&d.resourceTiming&&(o.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&o.setExpiryData(d),o.loadVectorData(d,this.map.painter),o.reloadPromise){const g=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(g.resolve).catch(g.reject)}}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class dn extends s.E{constructor(o,d,g,x){super(),this.id=o,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},d),s.e(this,s.U(d,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(o=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const d=yield Gt(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,d&&(s.e(this,d),d.bounds&&(this.tileBounds=new Wt(d.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:o})))}catch(d){this._tileJSONRequest=null,this._loaded=!0,s.Z(d)||this.fire(new s.k(d))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load(!0)}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return s.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return s._(this,void 0,void 0,function*(){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const g=yield J.getImage(this.map._requestManager.transformRequest(d,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&o.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const x=this.map.painter.context,T=x.gl,D=g.data;o.texture=this.map.painter.getTileTexture(D.width),o.texture?o.texture.update(D,{useMipmap:!0}):(o.texture=new s.T(x,D,T.RGBA,{useMipmap:!0}),o.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(g){if(delete o.abortController,o.aborted)o.state="unloaded";else if(g)throw o.state="errored",g}})}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class Ve extends dn{constructor(o,d,g,x){super(o,d,g,x),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(o){return s._(this,void 0,void 0,function*(){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(d,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const x=yield J.getImage(g,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(x&&x.data){const T=x.data;this.map._refreshExpiredTiles&&(x.cacheControl||x.expires)&&o.setExpiryData({cacheControl:x.cacheControl,expires:x.expires});const D=s.b(T)&&s.$()?T:yield this.readImageNow(T),N={type:this.type,uid:o.uid,source:this.id,rawImageData:D,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||o.state==="expired"){o.actor=this.dispatcher.getActor();const V=yield o.actor.sendAsync({type:"LDT",data:N});o.dem=V,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(x){if(delete o.abortController,o.aborted)o.state="unloaded";else if(x)throw o.state="errored",x}})}readImageNow(o){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.a0()){const d=o.width+2,g=o.height+2;try{return new s.R({width:d,height:g},yield s.a1(o,-1,-1,d,g))}catch{}}return A.getImageData(o,1)})}_getNeighboringTiles(o){const d=o.canonical,g=Math.pow(2,d.z),x=(d.x-1+g)%g,T=d.x===0?o.wrap-1:o.wrap,D=(d.x+1+g)%g,N=d.x+1===g?o.wrap+1:o.wrap,V={};return V[new s.a2(o.overscaledZ,T,d.z,x,d.y).key]={backfilled:!1},V[new s.a2(o.overscaledZ,N,d.z,D,d.y).key]={backfilled:!1},d.y>0&&(V[new s.a2(o.overscaledZ,T,d.z,x,d.y-1).key]={backfilled:!1},V[new s.a2(o.overscaledZ,o.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},V[new s.a2(o.overscaledZ,N,d.z,D,d.y-1).key]={backfilled:!1}),d.y+1<g&&(V[new s.a2(o.overscaledZ,T,d.z,x,d.y+1).key]={backfilled:!1},V[new s.a2(o.overscaledZ,o.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},V[new s.a2(o.overscaledZ,N,d.z,D,d.y+1).key]={backfilled:!1}),V}unloadTile(o){return s._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}function Se(E){return E.type==="GeometryCollection"?E.geometries.map(o=>o.coordinates).flat(1/0):E.coordinates.flat(1/0)}function bt(E){const o=new on;let d;switch(E.type){case"FeatureCollection":d=E.features.map(g=>Se(g.geometry)).flat(1/0);break;case"Feature":d=Se(E.geometry);break;default:d=Se(E)}if(d.length==0)return o;for(let g=0;g<d.length-1;g+=2)o.extend([d[g],d[g+1]]);return o}class Nt extends s.E{constructor(o,d,g,x){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:d.data},this.actor=g.getActor(),this.setEventedParent(x),this._data=typeof d.data=="string"?{url:d.data}:{geojson:d.data},this._options=s.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId,d.clusterMaxZoom!==void 0&&this.maxzoom<=d.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${d.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(d.buffer!==void 0?d.buffer:128),tolerance:this._pixelsToTileUnits(d.tolerance!==void 0?d.tolerance:.375),extent:s.a5,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(d.clusterMaxZoom),minPoints:Math.max(2,d.clusterMinPoints||2),extent:s.a5,radius:this._pixelsToTileUnits(d.clusterRadius||50),log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(o){return o*(s.a5/this.tileSize)}_getClusterMaxZoom(o){const d=o?Math.round(o):this.maxzoom-1;return Number.isInteger(o)||o===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${o}" rounded to "${d}"`),d}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o,d){this._data=typeof o=="string"?{url:o}:{geojson:o},this._pendingWorkerUpdate={data:o};const g=this._updateWorkerData();return d?g:this}updateData(o,d){this._pendingWorkerUpdate.diff=s.a6(this._pendingWorkerUpdate.diff,o);const g=this._updateWorkerData();return d?g:this}getData(){return s._(this,void 0,void 0,function*(){const o=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}getBounds(){return s._(this,void 0,void 0,function*(){return bt(yield this.getData())})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(o.clusterRadius)),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(o.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,d,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:d,offset:g}})}_updateWorkerData(){return s._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void s.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:o,diff:d}=this._pendingWorkerUpdate,g=this._getLoadGeoJSONParameters(o,d);o!==void 0?this._pendingWorkerUpdate.data=void 0:d&&(this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,yield this._dispatchWorkerUpdate(g)})}_getLoadGeoJSONParameters(o,d){const g=s.e({type:this.type},this.workerOptions);return typeof o=="string"?(g.request=this.map._requestManager.transformRequest(A.resolveURL(o),"Source"),g.request.collectResourceTiming=this._collectResourceTiming,g):o!==void 0?(g.data=o,g):(d&&(g.dataDiff=d),g)}_dispatchWorkerUpdate(o){return s._(this,void 0,void 0,function*(){this._isUpdatingWorker=!0,this.fire(new s.l("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:o});if(this._isUpdatingWorker=!1,this._removed||d.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));d.data&&(this._data={geojson:d.data});const g=this._applyDiffToSource(o.dataDiff),x=this._getShouldReloadTileOptions(g),T={dataType:"source"};this._applyResourceTiming(T,d),this.fire(new s.l("data",Object.assign(Object.assign({},T),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},T),{sourceDataType:"content",shouldReloadTileOptions:x})))}catch(d){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(d))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}_applyResourceTiming(o,d){var g;if(!this._collectResourceTiming)return;const x=(g=d.resourceTiming)===null||g===void 0?void 0:g[this.id];if(!x)return;const T=x.slice(0);T?.length&&s.e(o,{resourceTiming:T})}_applyDiffToSource(o){if(!o)return;const d=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const x=s.a7(this._data.geojson,d);if(!x)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:x}}if(!this._data.updateable)return;const g=s.a8(this._data.updateable,o,d);return o.removeAll||this._options.cluster?void 0:g}_getShouldReloadTileOptions(o){if(o)return{affectedBounds:o.filter(Boolean).map(d=>bt(d))}}shouldReloadTile(o,{affectedBounds:d}){if(o.state==="loading")return!0;if(o.state==="unloaded")return!1;const{buffer:g,extent:x}=this.workerOptions.geojsonVtOptions,T=function({x:D,y:N,z:V},Z=0){const Q=s.a3((D-Z)/Math.pow(2,V)),ce=s.a4((N+1+Z)/Math.pow(2,V)),le=s.a3((D+1+Z)/Math.pow(2,V)),ge=s.a4((N-Z)/Math.pow(2,V));return new on([Q,ce],[le,ge])}(o.tileID.canonical,g/x);for(const D of d)if(T.intersects(D))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(o){return s._(this,void 0,void 0,function*(){const d=o.actor?"RT":"LT";o.actor=this.actor;const g={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};o.abortController=new AbortController;const x=yield this.actor.sendAsync({type:d,data:g},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(x,this.map.painter,d==="RT")})}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class jt extends s.E{constructor(o,d,g,x){super(),this.flippedWindingOrder=!1,this.id=o,this.dispatcher=g,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=d}load(o){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield J.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,o&&(this.coordinates=o),this._finishLoading())}catch(d){this._request=null,this._loaded=!0,s.Z(d)||this.fire(new s.k(d))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const d=o.map(s.a9.fromLngLat);var g;return this.tileID=function(x){const T=s.aa.fromPoints(x),D=T.width(),N=T.height(),V=Math.max(D,N),Z=Math.max(0,Math.floor(-Math.log(V)/Math.LN2)),Q=Math.pow(2,Z);return new s.ac(Z,Math.floor((T.minX+T.maxX)/2*Q),Math.floor((T.minY+T.maxY)/2*Q))}(d),this.terrainTileRanges=this._getOverlappingTileRanges(d),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=d.map(x=>this.tileID.getTilePoint(x)._round()),this.flippedWindingOrder=((g=this.tileCoords)[1].x-g[0].x)*(g[2].y-g[0].y)-(g[1].y-g[0].y)*(g[2].x-g[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,d=o.gl;this.texture||(this.texture=new s.T(o,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let g=!1;for(const x in this.tiles){const T=this.tiles[x];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(o){const{minX:d,minY:g,maxX:x,maxY:T}=s.aa.fromPoints(o),D={};for(let N=0;N<=s.ab;N++){const V=Math.pow(2,N),Z=Math.floor(d*V),Q=Math.floor(g*V),ce=Math.floor(x*V),le=Math.floor(T*V),ge=(Z%V+V)%V,be=ce%V,ze=Math.floor(Z/V),$e=Math.floor(ce/V);D[N]={minWrap:ze,maxWrap:$e,minTileXWrapped:ge,maxTileXWrapped:be,minTileY:Q,maxTileY:le}}return D}}class Ut extends jt{constructor(o,d,g,x){super(o,d,g,x),this.roundZoom=!0,this.type="video",this.options=d}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const d of o.urls)this.urls.push(this.map._requestManager.transformRequest(d,"Source").url);try{const d=yield s.ad(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new s.k(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const d=this.video.seekable;o<d.start(0)||o>d.end(0)?this.fire(new s.k(new s.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,d=o.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(o,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let g=!1;for(const x in this.tiles){const T=this.tiles[x];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class yn extends jt{constructor(o,d,g,x){super(o,d,g,x),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(T=>!Array.isArray(T)||T.length!==2||T.some(D=>typeof D!="number"))||this.fire(new s.k(new s.ae(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.ae(`sources.${o}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new s.k(new s.ae(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.ae(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.ae(`sources.${o}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,g=d.gl;this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new s.T(d,this.canvas,g.RGBA,{premultiply:!0}),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));let x=!1;for(const T in this.tiles){const D=this.tiles[T];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture,x=!0)}x&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Zt={},qt=E=>{switch(E){case"geojson":return Nt;case"image":return jt;case"raster":return dn;case"raster-dem":return Ve;case"vector":return Gn;case"video":return Ut;case"canvas":return yn}return Zt[E]},Fn="RTLPluginLoaded";class Be extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=hn()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return s._(this,arguments,void 0,function*(d,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=A.resolveURL(d),!this.url)throw new Error(`requested url ${d} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(Fn))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ee=null;function oe(){return ee||(ee=new Be),ee}var fe,he;(function(E){E[E.Base=0]="Base",E[E.Parent=1]="Parent"})(fe||(fe={})),function(E){E[E.Departing=0]="Departing",E[E.Incoming=1]="Incoming"}(he||(he={}));class xe{constructor(o,d){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=o,this.uid=s.af(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttFingerprint={},this.expiredRequestCount=0,this.state="loading"}isRenderable(o){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(o||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:o,fadingDirection:d,fadingParentID:g,fadeEndTime:x}){this.resetFadeLogic(),this.fadingRole=o,this.fadingDirection=d,this.fadingParentID=g,this.fadeEndTime=x}setSelfFadeLogic(o){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=o}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=z(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,d,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData,this.latestFeatureIndex.encoding=o.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(x,T){const D={};if(!T)return D;for(const N of x){const V=N.layerIds.map(Z=>T.getLayer(Z)).filter(Boolean);if(V.length!==0){N.layers=V,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map(Z=>V.filter(Q=>Q.id===Z)[0]));for(const Z of V)D[Z.id]=N}}return D}(o.buckets,d?.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const T=this.buckets[x];if(T instanceof s.ah){if(this.hasSymbolBuckets=!0,!g)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const T=this.buckets[x];if(T instanceof s.ah&&T.hasRTLText){this.hasRTLText=!0,oe().lazyLoad();break}}this.queryPadding=0;for(const x in this.buckets){const T=this.buckets[x];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(x).queryRadius(T))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),this.dashPositions=o.dashPositions}else this.collisionBoxArray=new s.ag}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const g in this.buckets){const x=this.buckets[g];x.uploadPending()&&x.upload(o)}const d=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(o,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(o,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,d,g,x,T,D,N,V,Z,Q,ce){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:x,cameraQueryGeometry:T,scale:D,tileSize:this.tileSize,pixelPosMatrix:Q,transform:V,params:N,queryPadding:this.queryPadding*Z,getElevation:ce},o,d,g):{}}querySourceFeatures(o,d){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),T=d&&d.sourceLayer?d.sourceLayer:"",D=x[s.ai]||x[T];if(!D)return;const N=s.aj(d?.filter,d?.globalState),{z:V,x:Z,y:Q}=this.tileID.canonical,ce={z:V,x:Z,y:Q};for(let le=0;le<D.length;le++){const ge=D.feature(le);if(N.needGeometry){const $e=s.ak(ge,!0);if(!N.filter(new s.H(this.tileID.overscaledZ),$e,this.tileID.canonical))continue}else if(!N.filter(new s.H(this.tileID.overscaledZ),ge))continue;const be=g.getId(ge,T),ze=new s.al(ge,V,Z,Q,be);ze.tile=ce,o.push(ze)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const g=s.am(o.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(d)if(this.expirationTime<d)x=!0;else{const T=this.expirationTime-d;T?this.expirationTime=g+Math.max(T,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const x in this.buckets){if(!d.style.hasLayer(x))continue;const T=this.buckets[x],D=T.layers[0].sourceLayer||s.ai,N=g[D],V=o[D];if(!N||!V||Object.keys(V).length===0)continue;T.update(V,N,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const Z=d&&d.style&&d.style.getLayer(x);Z&&(this.queryPadding=Math.max(this.queryPadding,Z.queryRadius(T)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(o){this.symbolFadeHoldUntil=z()+o}setDependencies(o,d){const g={};for(const x of d)g[x]=!0;this.dependencies[o]=g}hasDependency(o,d){for(const g of o){const x=this.dependencies[g];if(x){for(const T of d)if(x[T])return!0}}return!1}}class Ye{constructor(){this.state={},this.stateChanges={},this.deletedStates={},this.revision=0}updateState(o,d,g){const x=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][x]=this.stateChanges[o][x]||{},s.e(this.stateChanges[o][x],g),this.deletedStates[o]===null){this.deletedStates[o]={};for(const T in this.state[o])T!==x&&(this.deletedStates[o][T]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][x]===null){this.deletedStates[o][x]={};for(const T in this.state[o][x])g[T]||(this.deletedStates[o][x][T]=null)}else for(const T in g)this.deletedStates[o]&&this.deletedStates[o][x]&&this.deletedStates[o][x][T]===null&&delete this.deletedStates[o][x][T]}removeFeatureState(o,d,g){if(this.deletedStates[o]===null)return;const x=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},g&&d!==void 0)this.deletedStates[o][x]!==null&&(this.deletedStates[o][x]=this.deletedStates[o][x]||{},this.deletedStates[o][x][g]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][x])for(g in this.deletedStates[o][x]={},this.stateChanges[o][x])this.deletedStates[o][x][g]=null;else this.deletedStates[o][x]=null;else this.deletedStates[o]=null}getState(o,d){const g=String(d),x=s.e({},(this.state[o]||{})[g],(this.stateChanges[o]||{})[g]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const T=this.deletedStates[o][d];if(T===null)return{};for(const D in T)delete x[D]}return x}initializeTileState(o,d){o.setFeatureState(this.state,d)}coalesceChanges(o,d){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const T={};for(const D in this.stateChanges[x])this.state[x][D]||(this.state[x][D]={}),s.e(this.state[x][D],this.stateChanges[x][D]),T[D]=this.state[x][D];g[x]=T}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const T={};if(this.deletedStates[x]===null)for(const D in this.state[x])T[D]={},this.state[x][D]={};else for(const D in this.deletedStates[x]){if(this.deletedStates[x][D]===null)this.state[x][D]={};else for(const N of Object.keys(this.deletedStates[x][D]))delete this.state[x][D][N];T[D]=this.state[x][D]}g[x]=g[x]||{},s.e(g[x],T)}this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0&&(this.revision++,o.setFeatureState(g,d))}}const st=89.25;function _e(E,o){const d=s.an(o.lat,-s.ao,s.ao);return new s.P(s.Y(o.lng)*E,s.X(d)*E)}function Fe(E,o){return new s.a9(o.x/E,o.y/E).toLngLat()}function Ge(E){return E.cameraToCenterDistance*Math.min(.85*Math.tan(s.ap(90-E.pitch)),Math.tan(s.ap(st-E.pitch)))}function je(E,o){const d=E.canonical,g=o/s.aq(d.z),x=d.x+Math.pow(2,d.z)*E.wrap,T=s.ar(new Float64Array(16));return s.O(T,T,[x*g,d.y*g,0]),s.Q(T,T,[g/s.a5,g/s.a5,1]),T}function De(E,o,d,g,x){const T=s.a9.fromLngLat(E,o),D=x*s.as(1,E.lat),{x:N,y:V,z:Z}=zt(d,g);return new s.a9(T.x+D*-N,T.y+D*-V,T.z+D*-Z)}function zt(E,o){const d=s.ap(E),g=s.ap(o),x=Math.cos(-d),T=Math.sin(d);return{x:T*Math.sin(g),y:-T*Math.cos(g),z:x}}function fn(E,o,d){const g=o.intersectsFrustum(E);if(!d||g===0)return g;const x=o.intersectsPlane(d);return x===0?0:g===2&&x===2?2:1}function sn(E,o,d){let g=0;const x=(d-o)/10;for(let T=0;T<10;T++)g+=x*Math.pow(Math.cos(o+(T+.5)/10*(d-o)),E);return g}function Jt(E,o){return function(d,g,x,T,D){const N=2*((E-1)/s.at(Math.cos(s.ap(st-D))/Math.cos(s.ap(st)))-1),V=Math.acos(x/T),Z=2*sn(N-1,0,s.ap(D/2)),Q=Math.min(s.ap(st),V+s.ap(D/2)),ce=sn(N-1,Math.min(Q,V-s.ap(D/2)),Q),le=Math.atan(g/x),ge=Math.hypot(g,x);let be=d;return be+=s.at(T/ge/Math.max(.5,Math.cos(s.ap(D/2)))),be+=N*s.at(Math.cos(le))/2,be-=s.at(Math.max(1,ce/Z/o))/2,be}}const cn=Jt(9.314,3);function Zn(E,o){const d=(o.roundZoom?Math.round:Math.floor)(E.zoom+s.at(E.tileSize/o.tileSize));return Math.max(0,d)}function yr(E,o){const d=E.getCameraFrustum(),g=E.getClippingPlane(),x=E.screenPointToMercatorCoordinate(E.getCameraPoint()),T=s.a9.fromLngLat(E.center,E.elevation);x.z=T.z+Math.cos(E.pitchInRadians)*E.cameraToCenterDistance/E.worldSize;const D=E.getCoveringTilesDetailsProvider(),N=D.allowVariableZoom(E,o),V=Zn(E,o),Z=o.minzoom||0,Q=o.maxzoom!==void 0?o.maxzoom:E.maxZoom,ce=Math.min(Math.max(0,V),Q),le=Math.pow(2,ce),ge=[le*x.x,le*x.y,0],be=[le*T.x,le*T.y,0],ze=Math.hypot(T.x-x.x,T.y-x.y),$e=Math.abs(T.z-x.z),Ne=Math.hypot(ze,$e),qe=rt=>({zoom:0,x:0,y:0,wrap:rt,fullyVisible:!1}),it=[],Xe=[];if(E.renderWorldCopies&&D.allowWorldCopies())for(let rt=1;rt<=3;rt++)it.push(qe(-rt)),it.push(qe(rt));for(it.push(qe(0));it.length>0;){const rt=it.pop(),ht=rt.x,Qe=rt.y;let yt=rt.fullyVisible;const Ot={x:ht,y:Qe,z:rt.zoom},Pt=D.getTileBoundingVolume(Ot,rt.wrap,E.elevation,o);if(!yt){const xn=fn(d,Pt,g);if(xn===0)continue;yt=xn===2}const It=D.distanceToTile2d(x.x,x.y,Ot,Pt);let Dt=V;N&&(Dt=(o.calculateTileZoom||cn)(E.zoom+s.at(E.tileSize/o.tileSize),It,$e,Ne,E.fov)),Dt=(o.roundZoom?Math.round:Math.floor)(Dt),Dt=Math.max(0,Dt);const gn=Math.min(Dt,Q);if(rt.wrap=D.getWrap(T,Ot,rt.wrap),rt.zoom>=gn){if(rt.zoom<Z)continue;const xn=ce-rt.zoom,tn=ge[0]-.5-(ht<<xn),Dn=ge[1]-.5-(Qe<<xn),gr=o.reparseOverscaled?Math.max(rt.zoom,Dt):rt.zoom;Xe.push({tileID:new s.a2(rt.zoom===Q?gr:rt.zoom,rt.wrap,rt.zoom,ht,Qe),distanceSq:s.au([be[0]-.5-ht,be[1]-.5-Qe]),tileDistanceToCamera:Math.sqrt(tn*tn+Dn*Dn)})}else for(let xn=0;xn<4;xn++)it.push({zoom:rt.zoom+1,x:(ht<<1)+xn%2,y:(Qe<<1)+(xn>>1),wrap:rt.wrap,fullyVisible:yt})}return Xe.sort((rt,ht)=>rt.distanceSq-ht.distanceSq).map(rt=>rt.tileID)}const Ar=s.aa.fromPoints([new s.P(0,0),new s.P(s.a5,s.a5)]);function Je(E){return E==="raster"||E==="image"||E==="video"}function gt(E,o,d,g,x,T,D){if(!o.hasData())return!1;const{tileID:N,fadingRole:V,fadingDirection:Z,fadingParentID:Q}=o;if(V===fe.Base&&Z===he.Incoming&&Q)return d[Q.key]=Q,!0;const ce=Math.max(N.overscaledZ-x,T);for(let le=N.overscaledZ-1;le>=ce;le--){const ge=N.scaledTo(le),be=E.getLoadedTile(ge);if(be)return o.setCrossFadeLogic({fadingRole:fe.Base,fadingDirection:he.Incoming,fadingParentID:be.tileID,fadeEndTime:g+D}),be.setCrossFadeLogic({fadingRole:fe.Parent,fadingDirection:he.Departing,fadeEndTime:g+D}),d[ge.key]=ge,!0}return!1}function St(E,o,d,g,x,T){if(!o.hasData())return!1;const D=o.tileID.children(x);let N=ft(E,o,D,d,g,x,T);if(N)return!0;for(const V of D)ft(E,o,V.children(x),d,g,x,T)&&(N=!0);return N}function ft(E,o,d,g,x,T,D){if(d[0].overscaledZ>=T)return!1;let N=!1;for(const V of d){const Z=E.getLoadedTile(V);if(!Z)continue;const{fadingRole:Q,fadingDirection:ce,fadingParentID:le}=Z;Q===fe.Base&&ce===he.Departing&&le||(Z.setCrossFadeLogic({fadingRole:fe.Base,fadingDirection:he.Departing,fadingParentID:o.tileID,fadeEndTime:x+D}),o.setCrossFadeLogic({fadingRole:fe.Parent,fadingDirection:he.Incoming,fadeEndTime:x+D})),g[V.key]=V,N=!0}return N}function Qt(E,o,d,g){const x=E.tileID;return!!E.selfFading||!E.hasData()&&!!o.has(x)&&(E.setSelfFadeLogic(d+g),!0)}function Sn(E,o){var d;E.needsHillshadePrepare=!0,E.needsTerrainPrepare=!0;let g=o.tileID.canonical.x-E.tileID.canonical.x;const x=o.tileID.canonical.y-E.tileID.canonical.y,T=Math.pow(2,E.tileID.canonical.z),D=o.tileID.key;g===0&&x===0||Math.abs(x)>1||(Math.abs(g)>1&&(Math.abs(g+T)===1?g+=T:Math.abs(g-T)===1&&(g-=T)),o.dem&&E.dem&&(E.dem.backfillBorder(o.dem,g,x),!((d=E.neighboringTiles)===null||d===void 0)&&d[D]&&(E.neighboringTiles[D].backfilled=!0)))}class Un{constructor(){this._tiles={}}handleWrapJump(o){const d={};for(const g in this._tiles){const x=this._tiles[g];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+o),d[x.tileID.key]=x}this._tiles=d}setFeatureState(o,d){for(const g in this._tiles)this._tiles[g].setFeatureState(o,d)}getAllTiles(){return Object.values(this._tiles)}getAllIds(o=!1){return o?Object.values(this._tiles).map(d=>d.tileID).sort(s.aw).map(d=>d.key):Object.keys(this._tiles)}getTileById(o){return this._tiles[o]}setTile(o,d){this._tiles[o]=d}deleteTileById(o){delete this._tiles[o]}getLoadedTile(o){const d=this.getTileById(o.key);return d?.hasData()?d:null}isIdRenderable(o,d=!1){var g;return(g=this.getTileById(o))===null||g===void 0?void 0:g.isRenderable(d)}getRenderableIds(o=0,d){const g=[];for(const x of this.getAllIds())this.isIdRenderable(x,d)&&g.push(this.getTileById(x));return d?g.sort((x,T)=>{const D=x.tileID,N=T.tileID,V=new s.P(D.canonical.x,D.canonical.y)._rotate(-o),Z=new s.P(N.canonical.x,N.canonical.y)._rotate(-o);return D.overscaledZ-N.overscaledZ||Z.y-V.y||Z.x-V.x}).map(x=>x.tileID.key):g.map(x=>x.tileID).sort(s.aw).map(x=>x.key)}}class kn extends s.E{constructor(o,d,g){super(),this.id=o,this.dispatcher=g,this.on("data",x=>this._dataHandler(x)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((x,T,D,N)=>{const V=new(qt(T.type))(x,T,D,N);if(V.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${V.id}`);return V})(o,d,g,this),this._inViewTiles=new Un,this._outOfViewCache=new s.ax(0,x=>this._unloadTile(x)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Ye,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){for(const d of this._inViewTiles.getAllTiles())d.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o),this._inViewTiles=new Un}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o of this._inViewTiles.getAllTiles())if(o.state!=="loaded"&&o.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,d,g){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,d,g)}catch(x){o.state="errored",x.status!==404?this._source.fire(new s.k(x,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new s.l("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const d of this._inViewTiles.getAllTiles())d.upload(o),d.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(o){var d;return this._inViewTiles.getRenderableIds((d=this.transform)===null||d===void 0?void 0:d.bearingInRadians,o)}hasRenderableParent(o){const d=o.overscaledZ-1;if(d>=this._source.minzoom){const g=this.getLoadedTile(o.scaledTo(d));if(g)return this._inViewTiles.isIdRenderable(g.tileID.key)}return!1}reload(o,d=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const g of this._inViewTiles.getAllIds()){const x=this._inViewTiles.getTileById(g);d&&!this._source.shouldReloadTile(x,d)||(o?this._reloadTile(g,"expired"):x.state!=="errored"&&this._reloadTile(g,"reloading"))}}}_reloadTile(o,d){return s._(this,void 0,void 0,function*(){const g=this._inViewTiles.getTileById(o);g&&(g.state!=="loading"&&(g.state=d),yield this._loadTile(g,o,d))})}_tileLoaded(o,d,g){o.timeAdded=z(),o.selfFading&&(o.fadeEndTime=o.timeAdded+this._rasterFadeDuration),g==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this.getSource().type==="raster-dem"&&o.dem&&function(x,T){var D,N;const V=T.getRenderableIds();for(const Z of V){if(!x.neighboringTiles||!x.neighboringTiles[Z])continue;const Q=T.getTileById(Z);x.neighboringTiles[Z].backfilled||Sn(x,Q),!((N=(D=Q.neighboringTiles)===null||D===void 0?void 0:D[x.tileID.key])===null||N===void 0)&&N.backfilled||Sn(Q,x)}}(o,this._inViewTiles),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:o,coord:o.tileID}))}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._inViewTiles.getTileById(o)}_retainLoadedChildren(o,d){const g=this._getLoadedDescendents(d),x=new Set;for(const T of d){const D=g[T.key];if(!D?.length){x.add(T);continue}const N=T.overscaledZ+kn.maxOverzooming,V=D.filter(ce=>ce.tileID.overscaledZ<=N);if(!V.length){x.add(T);continue}const Z=Math.min(...V.map(ce=>ce.tileID.overscaledZ)),Q=V.filter(ce=>ce.tileID.overscaledZ===Z).map(ce=>ce.tileID);for(const ce of Q)o[ce.key]=ce;this._areDescendentsComplete(Q,Z,T.overscaledZ)||x.add(T)}return x}_getLoadedDescendents(o){var d;const g={};for(const x of this._inViewTiles.getAllTiles().filter(T=>T.hasData()))for(const T of o)x.tileID.isChildOf(T)&&(g[d=T.key]||(g[d]=[])).push(x);return g}_areDescendentsComplete(o,d,g){return o.length===1&&o[0].isOverscaled()?o[0].overscaledZ===d:Math.pow(4,d-g)===o.length}getLoadedTile(o){return this._inViewTiles.getLoadedTile(o)}updateCacheSize(o){const d=Math.ceil(o.width/this._source.tileSize)+1,g=Math.ceil(o.height/this._source.tileSize)+1,x=Math.floor(d*g*(this._maxTileCacheZoomLevels===null?s.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._outOfViewCache.setMaxSize(T)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);this._prevLng=o,d&&(this._inViewTiles.handleWrapJump(d),this._resetTileReloadTimers())}update(o,d){if(!this._sourceLoaded||this._paused)return;let g;this.transform=o,this.terrain=d,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?g=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(V=>new s.a2(V.canonical.z,V.wrap,V.canonical.z,V.canonical.x,V.canonical.y)):(g=yr(o,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?o.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(g=g.filter(V=>this._source.hasTile(V)))):g=[],this.usedForTerrain&&(g=this._addTerrainIdealTiles(g));const x=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=Zn(o,this._source),D=this._updateRetainedTiles(g,T),N=Je(this._source.type);N&&this._rasterFadeDuration>0&&!d&&function(V,Z,Q,ce,le,ge,be){const ze=z(),$e=s.av(Z);for(const Ne of Z){const qe=V.getTileById(Ne.key);qe.fadingDirection!==he.Departing&&qe.fadeOpacity!==0||qe.resetFadeLogic(),gt(V,qe,Q,ze,ce,le,be)||St(V,qe,Q,ze,ge,be)||Qt(qe,$e,ze,be)||qe.resetFadeLogic()}}(this._inViewTiles,g,D,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),N?this._cleanUpRasterTiles(D):this._cleanUpVectorTiles(D)}_cleanUpRasterTiles(o){for(const d of this._inViewTiles.getAllIds())o[d]||this._removeTile(d)}_cleanUpVectorTiles(o){for(const d of this._inViewTiles.getAllIds()){const g=this._inViewTiles.getTileById(d);o[d]?g.clearSymbolFadeHold():g.hasSymbolBuckets?g.holdingForSymbolFade()?g.symbolFadeFinished()&&this._removeTile(d):g.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(d)}}_addTerrainIdealTiles(o){const d=[];for(const g of o)if(g.canonical.z>this._source.minzoom){const x=g.scaledTo(g.canonical.z-1);d.push(x);const T=g.scaledTo(Math.max(this._source.minzoom,Math.min(g.canonical.z,5)));d.push(T)}return o.concat(d)}releaseSymbolFadeTiles(){for(const o of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(o).holdingForSymbolFade()&&this._removeTile(o)}_updateRetainedTiles(o,d){var g;const x=new Set;for(const Z of o)this._addTile(Z).hasData()||x.add(Z);const T=o.reduce((Z,Q)=>(Z[Q.key]=Q,Z),{}),D=this._retainLoadedChildren(T,x),N={},V=Math.max(d-kn.maxUnderzooming,this._source.minzoom);for(const Z of D){let Q=this._inViewTiles.getTileById(Z.key),ce=Q?.wasRequested();for(let le=Z.overscaledZ-1;le>=V;--le){const ge=Z.scaledTo(le);if(N[ge.key])break;if(N[ge.key]=!0,Q=this.getTile(ge),!Q&&ce&&(Q=this._addTile(ge)),Q){const be=Q.hasData();if((be||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||ce)&&(T[ge.key]=ge),ce=Q.wasRequested(),be)break}}}return T}_addTile(o){let d=this._inViewTiles.getTileById(o.key);if(d)return d;d=this._outOfViewCache.getAndRemove(o),d&&(d.resetFadeLogic(),this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null));const g=d;return d||(d=new xe(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(d,o.key,d.state)),d.uses++,this._inViewTiles.setTile(o.key,d),g||this._source.fire(new s.l("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(o,d){this._clearTileReloadTimer(o);const g=d.getExpiryTimeout();g&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},g))}_clearTileReloadTimer(o){const d=this._timers[o];d&&(clearTimeout(d),delete this._timers[o])}_resetTileReloadTimers(){for(const o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(const o of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(o);this._setTileReloadTimer(o,d)}}refreshTiles(o){for(const d of this._inViewTiles.getAllIds()){const g=this._inViewTiles.getTileById(d);(this._inViewTiles.isIdRenderable(d)||g.state=="errored")&&o.some(x=>x.equals(g.tileID.canonical))&&this._reloadTile(d,"expired")}}_removeTile(o){const d=this._inViewTiles.getTileById(o);d&&(d.uses--,this._inViewTiles.deleteTileById(o),this._clearTileReloadTimer(o),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._outOfViewCache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}_dataHandler(o){o.dataType==="source"&&(o.sourceDataType!=="metadata"?o.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(o.sourceDataChanged,o.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o of this._inViewTiles.getAllIds())this._removeTile(o);this._outOfViewCache.reset()}tilesIn(o,d,g){const x=[],T=this.transform;if(!T)return x;const D=T.getCoveringTilesDetailsProvider().allowWorldCopies(),N=g?T.getCameraQueryGeometry(o):o,V=ge=>T.screenPointToMercatorCoordinate(ge,this.terrain),Z=this.transformBbox(o,V,!D),Q=this.transformBbox(N,V,!D),ce=this.getIds(),le=s.aa.fromPoints(Q);for(let ge=0;ge<ce.length;ge++){const be=this._inViewTiles.getTileById(ce[ge]);if(be.holdingForSymbolFade())continue;const ze=D?[be.tileID]:[be.tileID.unwrapTo(-1),be.tileID.unwrapTo(0)],$e=Math.pow(2,T.zoom-be.tileID.overscaledZ),Ne=d*be.queryPadding*s.a5/be.tileSize/$e;for(const qe of ze){const it=le.map(Xe=>qe.getTilePoint(new s.a9(Xe.x,Xe.y)));if(it.expandBy(Ne),it.intersects(Ar)){const Xe=Z.map(ht=>qe.getTilePoint(ht)),rt=Q.map(ht=>qe.getTilePoint(ht));x.push({tile:be,tileID:D?qe:qe.unwrapTo(0),queryGeometry:Xe,cameraQueryGeometry:rt,scale:$e})}}}return x}transformBbox(o,d,g){let x=o.map(d);if(g){const T=s.aa.fromPoints(o);T.shrinkBy(.001*Math.min(T.width(),T.height()));const D=T.map(d);s.aa.fromPoints(x).covers(D)||(x=x.map(N=>N.x>.5?new s.a9(N.x-1,N.y,N.z):N))}return x}getVisibleCoordinates(o){const d=this.getRenderableIds(o).map(g=>this._inViewTiles.getTileById(g).tileID);return this.transform&&this.transform.populateCache(d),d}hasTransition(){return!!this._source.hasTransition()||!(!Je(this._source.type)||!function(o,d){if(d<=0)return!1;const g=z();for(const x of o.getAllTiles())if(x.fadeEndTime>=g)return!0;return!1}(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(o){this._rasterFadeDuration=o}setFeatureState(o,d,g){this._state.updateState(o=o||s.ai,d,g)}removeFeatureState(o,d,g){this._state.removeFeatureState(o=o||s.ai,d,g)}getFeatureState(o,d){return this._state.getState(o=o||s.ai,d)}setDependencies(o,d,g){const x=this._inViewTiles.getTileById(o);x&&x.setDependencies(d,g)}reloadTilesForDependencies(o,d){for(const g of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(g).hasDependency(o,d)&&this._reloadTile(g,"reloading");this._outOfViewCache.filter(g=>!g.hasDependency(o,d))}areTilesLoaded(){for(const o of this._inViewTiles.getAllTiles())if(o.state!=="loaded"&&o.state!=="errored")return!1;return!0}}kn.maxUnderzooming=10,kn.maxOverzooming=3;class Rt{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=s.an(o,0,1);let d=1,g=this._distances[d];const x=o*this.paddedLength+this.padding;for(;g<x&&d<this._distances.length;)g=this._distances[++d];const T=d-1,D=this._distances[T],N=g-D,V=N>0?(x-D)/N:0;return this.points[T].mult(1-V).add(this.points[d].mult(V))}}function ct(E,o){let d=!0;return E==="always"||E!=="never"&&o!=="never"||(d=!1),d}class ut{constructor(o,d,g){const x=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(d/g);for(let D=0;D<this.xCellCount*this.yCellCount;D++)x.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,g,x,T){this._forEachCell(d,g,x,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(T)}insertCircle(o,d,g,x){this._forEachCell(d-x,g-x,d+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(g),this.circles.push(x)}_insertBoxCell(o,d,g,x,T,D){this.boxCells[T].push(D)}_insertCircleCell(o,d,g,x,T,D){this.circleCells[T].push(D)}_query(o,d,g,x,T,D,N){if(g<0||o>this.width||x<0||d>this.height)return[];const V=[];if(o<=0&&d<=0&&this.width<=g&&this.height<=x){if(T)return[{key:null,x1:o,y1:d,x2:g,y2:x}];for(let Z=0;Z<this.boxKeys.length;Z++)V.push({key:this.boxKeys[Z],x1:this.bboxes[4*Z],y1:this.bboxes[4*Z+1],x2:this.bboxes[4*Z+2],y2:this.bboxes[4*Z+3]});for(let Z=0;Z<this.circleKeys.length;Z++){const Q=this.circles[3*Z],ce=this.circles[3*Z+1],le=this.circles[3*Z+2];V.push({key:this.circleKeys[Z],x1:Q-le,y1:ce-le,x2:Q+le,y2:ce+le})}}else this._forEachCell(o,d,g,x,this._queryCell,V,{hitTest:T,overlapMode:D,seenUids:{box:{},circle:{}}},N);return V}query(o,d,g,x){return this._query(o,d,g,x,!1,null)}hitTest(o,d,g,x,T,D){return this._query(o,d,g,x,!0,T,D).length>0}hitTestCircle(o,d,g,x,T){const D=o-g,N=o+g,V=d-g,Z=d+g;if(N<0||D>this.width||Z<0||V>this.height)return!1;const Q=[];return this._forEachCell(D,V,N,Z,this._queryCellCircle,Q,{hitTest:!0,overlapMode:x,circle:{x:o,y:d,radius:g},seenUids:{box:{},circle:{}}},T),Q.length>0}_queryCell(o,d,g,x,T,D,N,V){const{seenUids:Z,hitTest:Q,overlapMode:ce}=N,le=this.boxCells[T];if(le!==null){const be=this.bboxes;for(const ze of le)if(!Z.box[ze]){Z.box[ze]=!0;const $e=4*ze,Ne=this.boxKeys[ze];if(o<=be[$e+2]&&d<=be[$e+3]&&g>=be[$e+0]&&x>=be[$e+1]&&(!V||V(Ne))&&(!Q||!ct(ce,Ne.overlapMode))&&(D.push({key:Ne,x1:be[$e],y1:be[$e+1],x2:be[$e+2],y2:be[$e+3]}),Q))return!0}}const ge=this.circleCells[T];if(ge!==null){const be=this.circles;for(const ze of ge)if(!Z.circle[ze]){Z.circle[ze]=!0;const $e=3*ze,Ne=this.circleKeys[ze];if(this._circleAndRectCollide(be[$e],be[$e+1],be[$e+2],o,d,g,x)&&(!V||V(Ne))&&(!Q||!ct(ce,Ne.overlapMode))){const qe=be[$e],it=be[$e+1],Xe=be[$e+2];if(D.push({key:Ne,x1:qe-Xe,y1:it-Xe,x2:qe+Xe,y2:it+Xe}),Q)return!0}}}return!1}_queryCellCircle(o,d,g,x,T,D,N,V){const{circle:Z,seenUids:Q,overlapMode:ce}=N,le=this.boxCells[T];if(le!==null){const be=this.bboxes;for(const ze of le)if(!Q.box[ze]){Q.box[ze]=!0;const $e=4*ze,Ne=this.boxKeys[ze];if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,be[$e+0],be[$e+1],be[$e+2],be[$e+3])&&(!V||V(Ne))&&!ct(ce,Ne.overlapMode))return D.push(!0),!0}}const ge=this.circleCells[T];if(ge!==null){const be=this.circles;for(const ze of ge)if(!Q.circle[ze]){Q.circle[ze]=!0;const $e=3*ze,Ne=this.circleKeys[ze];if(this._circlesCollide(be[$e],be[$e+1],be[$e+2],Z.x,Z.y,Z.radius)&&(!V||V(Ne))&&!ct(ce,Ne.overlapMode))return D.push(!0),!0}}}_forEachCell(o,d,g,x,T,D,N,V){const Z=this._convertToXCellCoord(o),Q=this._convertToYCellCoord(d),ce=this._convertToXCellCoord(g),le=this._convertToYCellCoord(x);for(let ge=Z;ge<=ce;ge++)for(let be=Q;be<=le;be++)if(T.call(this,o,d,g,x,this.xCellCount*be+ge,D,N,V))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,g,x,T,D){const N=x-o,V=T-d,Z=g+D;return Z*Z>N*N+V*V}_circleAndRectCollide(o,d,g,x,T,D,N){const V=(D-x)/2,Z=Math.abs(o-(x+V));if(Z>V+g)return!1;const Q=(N-T)/2,ce=Math.abs(d-(T+Q));if(ce>Q+g)return!1;if(Z<=V||ce<=Q)return!0;const le=Z-V,ge=ce-Q;return le*le+ge*ge<=g*g}}function Vt(E,o,d){const g=s.N();if(!E){const{vecSouth:ce,vecEast:le}=Bn(o),ge=_();ge[0]=le[0],ge[1]=le[1],ge[2]=ce[0],ge[3]=ce[1],x=ge,(Q=(D=(T=ge)[0])*(Z=T[3])-(V=T[2])*(N=T[1]))&&(x[0]=Z*(Q=1/Q),x[1]=-N*Q,x[2]=-V*Q,x[3]=D*Q),g[0]=ge[0],g[1]=ge[1],g[4]=ge[2],g[5]=ge[3]}var x,T,D,N,V,Z,Q;return s.Q(g,g,[1/d,1/d,1]),g}function En(E,o,d,g){if(E){const x=s.N();if(!o){const{vecSouth:T,vecEast:D}=Bn(d);x[0]=D[0],x[1]=D[1],x[4]=T[0],x[5]=T[1]}return s.Q(x,x,[g,g,1]),x}return d.pixelsToClipSpaceMatrix}function Bn(E){const o=Math.cos(E.rollInRadians),d=Math.sin(E.rollInRadians),g=Math.cos(E.pitchInRadians),x=Math.cos(E.bearingInRadians),T=Math.sin(E.bearingInRadians),D=s.aC();D[0]=-x*g*d-T*o,D[1]=-T*g*d+x*o;const N=s.aD(D);N<1e-9?s.aE(D):s.aF(D,D,1/N);const V=s.aC();V[0]=x*g*o-T*d,V[1]=T*g*o+x*d;const Z=s.aD(V);return Z<1e-9?s.aE(V):s.aF(V,V,1/Z),{vecEast:V,vecSouth:D}}function In(E,o,d,g){let x;g?(x=[E,o,g(E,o),1],s.aH(x,x,d)):(x=[E,o,0,1],wr(x,x,d));const T=x[3];return{point:new s.P(x[0]/T,x[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}function fr(E,o){return .5+E/o*.5}function Re(E,o){return E.x>=-o[0]&&E.x<=o[0]&&E.y>=-o[1]&&E.y<=o[1]}function mt(E,o,d,g,x,T,D,N,V,Z,Q,ce,le){const ge=d?E.textSizeData:E.iconSizeData,be=s.ay(ge,o.transform.zoom),ze=[256/o.width*2+1,256/o.height*2+1],$e=d?E.text.dynamicLayoutVertexArray:E.icon.dynamicLayoutVertexArray;$e.clear();const Ne=E.lineVertexArray,qe=d?E.text.placedSymbolArray:E.icon.placedSymbolArray,it=o.transform.width/o.transform.height;let Xe=!1;for(let rt=0;rt<qe.length;rt++){const ht=qe.get(rt);if(ht.hidden||ht.writingMode===s.az.vertical&&!Xe){Ir(ht.numGlyphs,$e);continue}Xe=!1;const Qe=new s.P(ht.anchorX,ht.anchorY),yt={getElevation:le,pitchedLabelPlaneMatrix:g,lineVertexArray:Ne,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:o.transform,tileAnchorPoint:Qe,unwrappedTileID:V,width:Z,height:Q,translation:ce},Ot=mn(ht.anchorX,ht.anchorY,yt);if(!Re(Ot.point,ze)){Ir(ht.numGlyphs,$e);continue}const Pt=fr(o.transform.cameraToCenterDistance,Ot.signedDistanceFromCamera),It=s.aA(ge,be,ht),Dt=T?It*o.transform.getPitchedTextCorrection(ht.anchorX,ht.anchorY,V)/Pt:It*Pt,gn=wt({projectionContext:yt,pitchedLabelPlaneMatrixInverse:x,symbol:ht,fontSize:Dt,flip:!1,keepUpright:D,glyphOffsetArray:E.glyphOffsetArray,dynamicLayoutVertexArray:$e,aspectRatio:it,rotateToLine:N});Xe=gn.useVertical,(gn.notEnoughRoom||Xe||gn.needsFlipping&&wt({projectionContext:yt,pitchedLabelPlaneMatrixInverse:x,symbol:ht,fontSize:Dt,flip:!0,keepUpright:D,glyphOffsetArray:E.glyphOffsetArray,dynamicLayoutVertexArray:$e,aspectRatio:it,rotateToLine:N}).notEnoughRoom)&&Ir(ht.numGlyphs,$e)}d?E.text.dynamicLayoutVertexBuffer.updateData($e):E.icon.dynamicLayoutVertexBuffer.updateData($e)}function Lt(E,o,d,g,x,T,D,N){const V=T.glyphStartIndex+T.numGlyphs,Z=T.lineStartIndex,Q=T.lineStartIndex+T.lineLength,ce=o.getoffsetX(T.glyphStartIndex),le=o.getoffsetX(V-1),ge=Rn(E*ce,d,g,x,T.segment,Z,Q,N,D);if(!ge)return null;const be=Rn(E*le,d,g,x,T.segment,Z,Q,N,D);return be?N.projectionCache.anyProjectionOccluded?null:{first:ge,last:be}:null}function Et(E,o,d,g){return E===s.az.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*g?{useVertical:!0}:(E===s.az.vertical?o.y<d.y:o.x>d.x)?{needsFlipping:!0}:null}function wt(E){const{projectionContext:o,pitchedLabelPlaneMatrixInverse:d,symbol:g,fontSize:x,flip:T,keepUpright:D,glyphOffsetArray:N,dynamicLayoutVertexArray:V,aspectRatio:Z,rotateToLine:Q}=E,ce=x/24,le=g.lineOffsetX*ce,ge=g.lineOffsetY*ce;let be;if(g.numGlyphs>1){const ze=g.glyphStartIndex+g.numGlyphs,$e=g.lineStartIndex,Ne=g.lineStartIndex+g.lineLength,qe=Lt(ce,N,le,ge,T,g,Q,o);if(!qe)return{notEnoughRoom:!0};const it=jn(qe.first.point.x,qe.first.point.y,o,d),Xe=jn(qe.last.point.x,qe.last.point.y,o,d);if(D&&!T){const rt=Et(g.writingMode,it,Xe,Z);if(rt)return rt}be=[qe.first];for(let rt=g.glyphStartIndex+1;rt<ze-1;rt++){const ht=Rn(ce*N.getoffsetX(rt),le,ge,T,g.segment,$e,Ne,o,Q);if(!ht)return{notEnoughRoom:!0};be.push(ht)}be.push(qe.last)}else{if(D&&!T){const $e=pn(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,Ne=g.lineStartIndex+g.segment+1,qe=new s.P(o.lineVertexArray.getx(Ne),o.lineVertexArray.gety(Ne)),it=pn(qe.x,qe.y,o),Xe=it.signedDistanceFromCamera>0?it.point:un(o.tileAnchorPoint,qe,$e,1,o),rt=jn($e.x,$e.y,o,d),ht=jn(Xe.x,Xe.y,o,d),Qe=Et(g.writingMode,rt,ht,Z);if(Qe)return Qe}const ze=Rn(ce*N.getoffsetX(g.glyphStartIndex),le,ge,T,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,o,Q);if(!ze||o.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};be=[ze]}for(const ze of be)s.aG(V,ze.point,ze.angle);return{}}function un(E,o,d,g,x){const T=E.add(E.sub(o)._unit()),D=pn(T.x,T.y,x).point,N=d.sub(D);return d.add(N._mult(g/N.mag()))}function _n(E,o,d){const g=o.projectionCache;if(g.projections[E])return g.projections[E];const x=new s.P(o.lineVertexArray.getx(E),o.lineVertexArray.gety(E)),T=pn(x.x,x.y,o);if(T.signedDistanceFromCamera>0)return g.projections[E]=T.point,g.anyProjectionOccluded=g.anyProjectionOccluded||T.isOccluded,T.point;const D=E-d.direction;return un(d.distanceFromAnchor===0?o.tileAnchorPoint:new s.P(o.lineVertexArray.getx(D),o.lineVertexArray.gety(D)),x,d.previousVertex,d.absOffsetX-d.distanceFromAnchor+1,o)}function pn(E,o,d){const g=E+d.translation[0],x=o+d.translation[1];let T;return d.pitchWithMap?(T=In(g,x,d.pitchedLabelPlaneMatrix,d.getElevation),T.isOccluded=!1):(T=d.transform.projectTileCoordinates(g,x,d.unwrappedTileID,d.getElevation),T.point.x=(.5*T.point.x+.5)*d.width,T.point.y=(.5*-T.point.y+.5)*d.height),T}function jn(E,o,d,g){if(d.pitchWithMap){const x=[E,o,0,1];return s.aH(x,x,g),d.transform.projectTileCoordinates(x[0]/x[3],x[1]/x[3],d.unwrappedTileID,d.getElevation).point}return{x:E/d.width*2-1,y:1-o/d.height*2}}function mn(E,o,d){return d.transform.projectTileCoordinates(E,o,d.unwrappedTileID,d.getElevation)}function Wn(E,o,d){return E._unit()._perp()._mult(o*d)}function Pn(E,o,d,g,x,T,D,N,V){if(N.projectionCache.offsets[E])return N.projectionCache.offsets[E];const Z=d.add(o);if(E+V.direction<g||E+V.direction>=x)return N.projectionCache.offsets[E]=Z,Z;const Q=_n(E+V.direction,N,V),ce=Wn(Q.sub(d),D,V.direction),le=d.add(ce),ge=Q.add(ce);return N.projectionCache.offsets[E]=s.aI(T,Z,le,ge)||Z,N.projectionCache.offsets[E]}function Rn(E,o,d,g,x,T,D,N,V){const Z=g?E-o:E+o;let Q=Z>0?1:-1,ce=0;g&&(Q*=-1,ce=Math.PI),Q<0&&(ce+=Math.PI);let le,ge=Q>0?T+x:T+x+1;N.projectionCache.cachedAnchorPoint?le=N.projectionCache.cachedAnchorPoint:(le=pn(N.tileAnchorPoint.x,N.tileAnchorPoint.y,N).point,N.projectionCache.cachedAnchorPoint=le);let be,ze,$e=le,Ne=le,qe=0,it=0;const Xe=Math.abs(Z),rt=[];let ht;for(;qe+it<=Xe;){if(ge+=Q,ge<T||ge>=D)return null;qe+=it,Ne=$e,ze=be;const Ot={absOffsetX:Xe,direction:Q,distanceFromAnchor:qe,previousVertex:Ne};if($e=_n(ge,N,Ot),d===0)rt.push(Ne),ht=$e.sub(Ne);else{let Pt;const It=$e.sub(Ne);Pt=It.mag()===0?Wn(_n(ge+Q,N,Ot).sub($e),d,Q):Wn(It,d,Q),ze||(ze=Ne.add(Pt)),be=Pn(ge,Pt,$e,T,D,ze,d,N,Ot),rt.push(ze),ht=be.sub(ze)}it=ht.mag()}const Qe=ht._mult((Xe-qe)/it)._add(ze||Ne),yt=ce+Math.atan2($e.y-Ne.y,$e.x-Ne.x);return rt.push(Qe),{point:Qe,angle:V?yt:0,path:rt}}const Qn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ir(E,o){for(let d=0;d<E;d++){const g=o.length;o.resize(g+4),o.float32.set(Qn,3*g)}}function wr(E,o,d){const g=o[0],x=o[1];return E[0]=d[0]*g+d[4]*x+d[12],E[1]=d[1]*g+d[5]*x+d[13],E[3]=d[3]*g+d[7]*x+d[15],E}const On=100;class or{constructor(o,d=new ut(o.width+200,o.height+200,25),g=new ut(o.width+200,o.height+200,25)){this.transform=o,this.grid=d,this.ignoredGrid=g,this.pitchFactor=Math.cos(o.pitch*Math.PI/180)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+On,this.screenBottomBoundary=o.height+On,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,d,g,x,T,D,N,V,Z,Q,ce,le){const ge=this.projectAndGetPerspectiveRatio(o.anchorPointX+V[0],o.anchorPointY+V[1],T,Q,le),be=g*ge.perspectiveRatio;let ze;if(D||N)ze=this._projectCollisionBox(o,be,x,T,D,N,V,ge,Q,ce,le);else{const ht=ge.x+(ce?ce.x*be:0),Qe=ge.y+(ce?ce.y*be:0);ze={allPointsOccluded:!1,box:[ht+o.x1*be,Qe+o.y1*be,ht+o.x2*be,Qe+o.y2*be]}}const[$e,Ne,qe,it]=ze.box,Xe=D?ze.allPointsOccluded:ge.isOccluded;let rt=Xe;return rt||(rt=ge.perspectiveRatio<this.perspectiveRatioCutoff),rt||(rt=!this.isInsideGrid($e,Ne,qe,it)),rt||d!=="always"&&this.grid.hitTest($e,Ne,qe,it,d,Z)?{box:[$e,Ne,qe,it],placeable:!1,offscreen:!1,occluded:Xe}:{box:[$e,Ne,qe,it],placeable:!0,offscreen:this.isOffscreen($e,Ne,qe,it),occluded:Xe}}placeCollisionCircles(o,d,g,x,T,D,N,V,Z,Q,ce,le,ge,be){const ze=[],$e=new s.P(d.anchorX,d.anchorY),Ne=this.getPerspectiveRatio($e.x,$e.y,D,be),qe=(Z?T*this.transform.getPitchedTextCorrection(d.anchorX,d.anchorY,D)/Ne:T*Ne)/s.aM,it={getElevation:be,pitchedLabelPlaneMatrix:N,lineVertexArray:g,pitchWithMap:Z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:$e,unwrappedTileID:D,width:this.transform.width,height:this.transform.height,translation:ge},Xe=Lt(qe,x,d.lineOffsetX*qe,d.lineOffsetY*qe,!1,d,!1,it);let rt=!1,ht=!1,Qe=!0;if(Xe){const yt=.5*ce*Ne+le,Ot=new s.P(-100,-100),Pt=new s.P(this.screenRightBoundary,this.screenBottomBoundary),It=new Rt,Dt=Xe.first,gn=Xe.last;let xn=[];for(let gr=Dt.path.length-1;gr>=1;gr--)xn.push(Dt.path[gr]);for(let gr=1;gr<gn.path.length;gr++)xn.push(gn.path[gr]);const tn=2.5*yt;if(Z){const gr=this.projectPathToScreenSpace(xn,it);xn=gr.some(Yr=>Yr.signedDistanceFromCamera<=0)?[]:gr.map(Yr=>Yr.point)}let Dn=[];if(xn.length>0){const gr=xn[0].clone(),Yr=xn[0].clone();for(let xi=1;xi<xn.length;xi++)gr.x=Math.min(gr.x,xn[xi].x),gr.y=Math.min(gr.y,xn[xi].y),Yr.x=Math.max(Yr.x,xn[xi].x),Yr.y=Math.max(Yr.y,xn[xi].y);Dn=gr.x>=Ot.x&&Yr.x<=Pt.x&&gr.y>=Ot.y&&Yr.y<=Pt.y?[xn]:Yr.x<Ot.x||gr.x>Pt.x||Yr.y<Ot.y||gr.y>Pt.y?[]:s.aJ([xn],Ot.x,Ot.y,Pt.x,Pt.y)}for(const gr of Dn){It.reset(gr,.25*yt);let Yr=0;Yr=It.length<=.5*yt?1:Math.ceil(It.paddedLength/tn)+1;for(let xi=0;xi<Yr;xi++){const ni=xi/Math.max(Yr-1,1),bi=It.lerp(ni),ri=bi.x+On,wi=bi.y+On;ze.push(ri,wi,yt,0);const Di=ri-yt,Co=wi-yt,Xi=ri+yt,qr=wi+yt;if(Qe=Qe&&this.isOffscreen(Di,Co,Xi,qr),ht=ht||this.isInsideGrid(Di,Co,Xi,qr),o!=="always"&&this.grid.hitTestCircle(ri,wi,yt,o,Q)&&(rt=!0,!V))return{circles:[],offscreen:!1,collisionDetected:rt}}}}return{circles:!V&&rt||!ht||Ne<this.perspectiveRatioCutoff?[]:ze,offscreen:Qe,collisionDetected:rt}}projectPathToScreenSpace(o,d){const g=function(x,T){const D=s.N();return s.aB(D,T.pitchedLabelPlaneMatrix),x.map(N=>{const V=In(N.x,N.y,D,T.getElevation),Z=T.transform.projectTileCoordinates(V.point.x,V.point.y,T.unwrappedTileID,T.getElevation);return Z.point.x=(.5*Z.point.x+.5)*T.width,Z.point.y=(.5*-Z.point.y+.5)*T.height,Z})}(o,d);return function(x){let T=0,D=0,N=0,V=0;for(let Z=0;Z<x.length;Z++)x[Z].isOccluded?(N=Z+1,V=0):(V++,V>D&&(D=V,T=N));return x.slice(T,T+D)}(g)}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[],g=new s.aa;for(const ce of o){const le=new s.P(ce.x+On,ce.y+On);g.extend(le),d.push(le)}const{minX:x,minY:T,maxX:D,maxY:N}=g,V=this.grid.query(x,T,D,N).concat(this.ignoredGrid.query(x,T,D,N)),Z={},Q={};for(const ce of V){const le=ce.key;if(Z[le.bucketInstanceId]===void 0&&(Z[le.bucketInstanceId]={}),Z[le.bucketInstanceId][le.featureIndex])continue;const ge=[new s.P(ce.x1,ce.y1),new s.P(ce.x2,ce.y1),new s.P(ce.x2,ce.y2),new s.P(ce.x1,ce.y2)];s.aK(d,ge)&&(Z[le.bucketInstanceId][le.featureIndex]=!0,Q[le.bucketInstanceId]===void 0&&(Q[le.bucketInstanceId]=[]),Q[le.bucketInstanceId].push(le.featureIndex))}return Q}insertCollisionBox(o,d,g,x,T,D){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:T,collisionGroupID:D,overlapMode:d},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,g,x,T,D){const N=g?this.ignoredGrid:this.grid,V={bucketInstanceId:x,featureIndex:T,collisionGroupID:D,overlapMode:d};for(let Z=0;Z<o.length;Z+=4)N.insertCircle(V,o[Z],o[Z+1],o[Z+2])}projectAndGetPerspectiveRatio(o,d,g,x,T){if(T){let D;x?(D=[o,d,x(o,d),1],s.aH(D,D,T)):(D=[o,d,0,1],wr(D,D,T));const N=D[3];return{x:(D[0]/N+1)/2*this.transform.width+On,y:(-D[1]/N+1)/2*this.transform.height+On,perspectiveRatio:.5+this.transform.cameraToCenterDistance/N*.5,isOccluded:!1,signedDistanceFromCamera:N}}{const D=this.transform.projectTileCoordinates(o,d,g,x);return{x:(D.point.x+1)/2*this.transform.width+On,y:(1-D.point.y)/2*this.transform.height+On,perspectiveRatio:.5+this.transform.cameraToCenterDistance/D.signedDistanceFromCamera*.5,isOccluded:D.isOccluded,signedDistanceFromCamera:D.signedDistanceFromCamera}}}getPerspectiveRatio(o,d,g,x){const T=this.transform.projectTileCoordinates(o,d,g,x);return .5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5}isOffscreen(o,d,g,x){return g<On||o>=this.screenRightBoundary||x<On||d>this.screenBottomBoundary}isInsideGrid(o,d,g,x){return g>=0&&o<this.gridRightBoundary&&x>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=s.ar([]);return s.O(o,o,[-100,-100,0]),o}_projectCollisionBox(o,d,g,x,T,D,N,V,Z,Q,ce){let le=1,ge=0,be=0,ze=1;const $e=o.anchorPointX+N[0],Ne=o.anchorPointY+N[1];if(D&&!T){const xn=this.projectAndGetPerspectiveRatio($e+1,Ne,x,Z,ce),tn=xn.x-V.x,Dn=Math.atan((xn.y-V.y)/tn)+(tn<0?Math.PI:0),gr=Math.sin(Dn),Yr=Math.cos(Dn);le=Yr,ge=gr,be=-gr,ze=Yr}else if(!D&&T){const xn=Bn(this.transform);le=xn.vecEast[0],ge=xn.vecEast[1],be=xn.vecSouth[0],ze=xn.vecSouth[1]}let qe=V.x,it=V.y,Xe=d;T&&(qe=$e,it=Ne,Xe=Math.pow(2,-(this.transform.zoom-g.overscaledZ)),Xe*=this.transform.getPitchedTextCorrection($e,Ne,x),Q||(Xe*=s.an(.5+V.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),Q&&(qe+=le*Q.x*Xe+be*Q.y*Xe,it+=ge*Q.x*Xe+ze*Q.y*Xe);const rt=o.x1*Xe,ht=o.x2*Xe,Qe=(rt+ht)/2,yt=o.y1*Xe,Ot=o.y2*Xe,Pt=(yt+Ot)/2,It=[{offsetX:rt,offsetY:yt},{offsetX:Qe,offsetY:yt},{offsetX:ht,offsetY:yt},{offsetX:ht,offsetY:Pt},{offsetX:ht,offsetY:Ot},{offsetX:Qe,offsetY:Ot},{offsetX:rt,offsetY:Ot},{offsetX:rt,offsetY:Pt}];let Dt=[];for(const{offsetX:xn,offsetY:tn}of It)Dt.push(new s.P(qe+le*xn+be*tn,it+ge*xn+ze*tn));let gn=!1;if(T){const xn=Dt.map(tn=>this.projectAndGetPerspectiveRatio(tn.x,tn.y,x,Z,ce));gn=xn.some(tn=>!tn.isOccluded),Dt=xn.map(tn=>new s.P(tn.x,tn.y))}else gn=!0;return{box:s.aL(Dt),allPointsOccluded:!gn}}}class gi{constructor(o,d,g,x){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Cr{constructor(o,d,g,x,T){this.text=new gi(o?o.text:null,d,g,T),this.icon=new gi(o?o.icon:null,d,x,T)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zo{constructor(o,d,g){this.text=o,this.icon=d,this.skipFade=g}}class Ll{constructor(o,d,g,x,T){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=T}}class Go{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:g=>g.collisionGroupID===d}}return this.collisionGroups[o]}}function ea(E,o,d,g,x){const{horizontalAlign:T,verticalAlign:D}=s.aS(E);return new s.P(-(T-.5)*o+g[0]*x,-(D-.5)*d+g[1]*x)}class ei{constructor(o,d,g,x,T){this.transform=o.clone(),this.terrain=d,this.collisionIndex=new or(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Go(x),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const d=this.terrain;return d?(g,x)=>d.getElevation(o,g,x):null}getBucketParts(o,d,g,x){const T=g.getBucket(d),D=g.latestFeatureIndex;if(!T||!D||d.id!==T.layerIds[0])return;const N=g.collisionBoxArray,V=T.layers[0].layout,Z=T.layers[0].paint,Q=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),ce=g.tileSize/s.a5,le=g.tileID.toUnwrapped(),ge=V.get("text-rotation-alignment")==="map",be=s.aN(g,1,this.transform.zoom),ze=s.aO(this.collisionIndex.transform,g,Z.get("text-translate"),Z.get("text-translate-anchor")),$e=s.aO(this.collisionIndex.transform,g,Z.get("icon-translate"),Z.get("icon-translate-anchor")),Ne=Vt(ge,this.transform,be);this.retainedQueryData[T.bucketInstanceId]=new Ll(T.bucketInstanceId,D,T.sourceLayerIndex,T.index,g.tileID);const qe={bucket:T,layout:V,translationText:ze,translationIcon:$e,unwrappedTileID:le,pitchedLabelPlaneMatrix:Ne,scale:Q,textPixelRatio:ce,holdingForFade:g.holdingForSymbolFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:s.ay(T.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(x)for(const it of T.sortKeyRanges){const{sortKey:Xe,symbolInstanceStart:rt,symbolInstanceEnd:ht}=it;o.push({sortKey:Xe,symbolInstanceStart:rt,symbolInstanceEnd:ht,parameters:qe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:qe})}attemptAnchorPlacement(o,d,g,x,T,D,N,V,Z,Q,ce,le,ge,be,ze,$e,Ne,qe,it,Xe){const rt=s.aP[o.textAnchor],ht=[o.textOffset0,o.textOffset1],Qe=ea(rt,g,x,ht,T),yt=this.collisionIndex.placeCollisionBox(d,le,V,Z,Q,N,D,$e,ce.predicate,it,Qe,Xe);if((!qe||this.collisionIndex.placeCollisionBox(qe,le,V,Z,Q,N,D,Ne,ce.predicate,it,Qe,Xe).placeable)&&yt.placeable){let Ot;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ge.crossTileID]&&this.prevPlacement.placements[ge.crossTileID]&&this.prevPlacement.placements[ge.crossTileID].text&&(Ot=this.prevPlacement.variableOffsets[ge.crossTileID].anchor),ge.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ge.crossTileID]={textOffset:ht,width:g,height:x,anchor:rt,textBoxScale:T,prevAnchor:Ot},this.markUsedJustification(be,rt,ge,ze),be.allowVerticalPlacement&&(this.markUsedOrientation(be,ze,ge),this.placedOrientations[ge.crossTileID]=ze),{shift:Qe,placedGlyphBoxes:yt}}}placeLayerBucketPart(o,d,g){const{bucket:x,layout:T,translationText:D,translationIcon:N,unwrappedTileID:V,pitchedLabelPlaneMatrix:Z,textPixelRatio:Q,holdingForFade:ce,collisionBoxArray:le,partiallyEvaluatedTextSize:ge,collisionGroup:be}=o.parameters,ze=T.get("text-optional"),$e=T.get("icon-optional"),Ne=s.aQ(T,"text-overlap","text-allow-overlap"),qe=Ne==="always",it=s.aQ(T,"icon-overlap","icon-allow-overlap"),Xe=it==="always",rt=T.get("text-rotation-alignment")==="map",ht=T.get("text-pitch-alignment")==="map",Qe=T.get("icon-text-fit")!=="none",yt=T.get("symbol-z-order")==="viewport-y",Ot=qe&&(Xe||!x.hasIconData()||$e),Pt=Xe&&(qe||!x.hasTextData()||ze);!x.collisionArrays&&le&&x.deserializeCollisionBoxes(le);const It=this.retainedQueryData[x.bucketInstanceId].tileID,Dt=this._getTerrainElevationFunc(It),gn=this.transform.getFastPathSimpleProjectionMatrix(It),xn=(tn,Dn,gr)=>{var Yr,xi;if(d[tn.crossTileID])return;if(ce)return void(this.placements[tn.crossTileID]=new zo(!1,!1,!1));let ni=!1,bi=!1,ri=!0,wi=null,Di={box:null,placeable:!1,offscreen:null,occluded:!1},Co={placeable:!1},Xi=null,qr=null,fo=null,Oa=0,sl=0,Fa=0;Dn.textFeatureIndex?Oa=Dn.textFeatureIndex:tn.useRuntimeCollisionCircles&&(Oa=tn.featureIndex),Dn.verticalTextFeatureIndex&&(sl=Dn.verticalTextFeatureIndex);const cs=Dn.textBox;if(cs){const Es=si=>{let ii=s.az.horizontal;if(x.allowVerticalPlacement&&!si&&this.prevPlacement){const oo=this.prevPlacement.placedOrientations[tn.crossTileID];oo&&(this.placedOrientations[tn.crossTileID]=oo,ii=oo,this.markUsedOrientation(x,ii,tn))}return ii},ll=(si,ii)=>{if(x.allowVerticalPlacement&&tn.numVerticalGlyphVertices>0&&Dn.verticalTextBox){for(const oo of x.writingModes)if(oo===s.az.vertical?(Di=ii(),Co=Di):Di=si(),Di&&Di.placeable)break}else Di=si()},ha=tn.textAnchorOffsetStartIndex,da=tn.textAnchorOffsetEndIndex;if(da===ha){const si=(ii,oo)=>{const po=this.collisionIndex.placeCollisionBox(ii,Ne,Q,It,V,ht,rt,D,be.predicate,Dt,void 0,gn);return po&&po.placeable&&(this.markUsedOrientation(x,oo,tn),this.placedOrientations[tn.crossTileID]=oo),po};ll(()=>si(cs,s.az.horizontal),()=>{const ii=Dn.verticalTextBox;return x.allowVerticalPlacement&&tn.numVerticalGlyphVertices>0&&ii?si(ii,s.az.vertical):{box:null,offscreen:null}}),Es(Di&&Di.placeable)}else{let si=s.aP[(xi=(Yr=this.prevPlacement)===null||Yr===void 0?void 0:Yr.variableOffsets[tn.crossTileID])===null||xi===void 0?void 0:xi.anchor];const ii=(po,us,Xo)=>{const $c=po.x2-po.x1,tv=po.y2-po.y1,Um=tn.textBoxScale,op=Qe&&it==="never"?us:null;let Gl=null,cl=Ne==="never"?1:2,Wl="never";si&&cl++;for(let $d=0;$d<cl;$d++){for(let sp=ha;sp<da;sp++){const Vd=x.textAnchorOffsets.get(sp);if(si&&Vd.textAnchor!==si)continue;const Ah=this.attemptAnchorPlacement(Vd,po,$c,tv,Um,rt,ht,Q,It,V,be,Wl,tn,x,Xo,D,N,op,Dt);if(Ah&&(Gl=Ah.placedGlyphBoxes,Gl&&Gl.placeable))return ni=!0,wi=Ah.shift,Gl}si?si=null:Wl=Ne}return g&&!Gl&&(Gl={box:this.collisionIndex.placeCollisionBox(cs,"always",Q,It,V,ht,rt,D,be.predicate,Dt,void 0,gn).box,offscreen:!1,placeable:!1,occluded:!1}),Gl};ll(()=>ii(cs,Dn.iconBox,s.az.horizontal),()=>{const po=Dn.verticalTextBox;return x.allowVerticalPlacement&&(!Di||!Di.placeable)&&tn.numVerticalGlyphVertices>0&&po?ii(po,Dn.verticalIconBox,s.az.vertical):{box:null,occluded:!0,offscreen:null}}),Di&&(ni=Di.placeable,ri=Di.offscreen);const oo=Es(Di&&Di.placeable);if(!ni&&this.prevPlacement){const po=this.prevPlacement.variableOffsets[tn.crossTileID];po&&(this.variableOffsets[tn.crossTileID]=po,this.markUsedJustification(x,po.anchor,tn,oo))}}}if(Xi=Di,ni=Xi&&Xi.placeable,ri=Xi&&Xi.offscreen,tn.useRuntimeCollisionCircles&&tn.centerJustifiedTextSymbolIndex>=0){const Es=x.text.placedSymbolArray.get(tn.centerJustifiedTextSymbolIndex),ll=s.aA(x.textSizeData,ge,Es),ha=T.get("text-padding");qr=this.collisionIndex.placeCollisionCircles(Ne,Es,x.lineVertexArray,x.glyphOffsetArray,ll,V,Z,g,ht,be.predicate,tn.collisionCircleDiameter,ha,D,Dt),qr.circles.length&&qr.collisionDetected&&!g&&s.w("Collisions detected, but collision boxes are not shown"),ni=qe||qr.circles.length>0&&!qr.collisionDetected,ri=ri&&qr.offscreen}if(Dn.iconFeatureIndex&&(Fa=Dn.iconFeatureIndex),Dn.iconBox){const Es=ll=>this.collisionIndex.placeCollisionBox(ll,it,Q,It,V,ht,rt,N,be.predicate,Dt,Qe&&wi?wi:void 0,gn);Co&&Co.placeable&&Dn.verticalIconBox?(fo=Es(Dn.verticalIconBox),bi=fo.placeable):(fo=Es(Dn.iconBox),bi=fo.placeable),ri=ri&&fo.offscreen}const jl=ze||tn.numHorizontalGlyphVertices===0&&tn.numVerticalGlyphVertices===0,al=$e||tn.numIconVertices===0;jl||al?al?jl||(bi=bi&&ni):ni=bi&&ni:bi=ni=bi&&ni;const Hl=bi&&fo.placeable;if(ni&&Xi.placeable&&this.collisionIndex.insertCollisionBox(Xi.box,Ne,T.get("text-ignore-placement"),x.bucketInstanceId,Co&&Co.placeable&&sl?sl:Oa,be.ID),Hl&&this.collisionIndex.insertCollisionBox(fo.box,it,T.get("icon-ignore-placement"),x.bucketInstanceId,Fa,be.ID),qr&&ni&&this.collisionIndex.insertCollisionCircles(qr.circles,Ne,T.get("text-ignore-placement"),x.bucketInstanceId,Oa,be.ID),g&&this.storeCollisionData(x.bucketInstanceId,gr,Dn,Xi,fo,qr),tn.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(x.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[tn.crossTileID]=new zo((ni||Ot)&&!Xi?.occluded,(bi||Pt)&&!fo?.occluded,ri||x.justReloaded),d[tn.crossTileID]=!0};if(yt){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const tn=x.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Dn=tn.length-1;Dn>=0;--Dn){const gr=tn[Dn];xn(x.symbolInstances.get(gr),x.collisionArrays[gr],gr)}}else for(let tn=o.symbolInstanceStart;tn<o.symbolInstanceEnd;tn++)xn(x.symbolInstances.get(tn),x.collisionArrays[tn],tn);x.justReloaded=!1}storeCollisionData(o,d,g,x,T,D){if(g.textBox||g.iconBox){let N,V;this.collisionBoxArrays.has(o)?N=this.collisionBoxArrays.get(o):(N=new Map,this.collisionBoxArrays.set(o,N)),N.has(d)?V=N.get(d):(V={text:null,icon:null},N.set(d,V)),g.textBox&&(V.text=x.box),g.iconBox&&(V.icon=T.box)}if(D){let N=this.collisionCircleArrays[o];N===void 0&&(N=this.collisionCircleArrays[o]=[]);for(let V=0;V<D.circles.length;V+=4)N.push(D.circles[V+0]-On),N.push(D.circles[V+1]-On),N.push(D.circles[V+2]),N.push(D.collisionDetected?1:0)}}markUsedJustification(o,d,g,x){let T;T=x===s.az.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[s.aR(d)];const D=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const N of D)N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=T>=0&&N!==T?0:g.crossTileID)}markUsedOrientation(o,d,g){const x=d===s.az.horizontal||d===s.az.horizontalOnly?d:0,T=d===s.az.vertical?d:0,D=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const N of D)o.text.placedSymbolArray.get(N).placedOrientation=x;g.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let g=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const x=d?d.symbolFadeChange(o):1,T=d?d.opacities:{},D=d?d.variableOffsets:{},N=d?d.placedOrientations:{};for(const V in this.placements){const Z=this.placements[V],Q=T[V];Q?(this.opacities[V]=new Cr(Q,x,Z.text,Z.icon),g=g||Z.text!==Q.text.placed||Z.icon!==Q.icon.placed):(this.opacities[V]=new Cr(null,x,Z.text,Z.icon,Z.skipFade),g=g||Z.text||Z.icon)}for(const V in T){const Z=T[V];if(!this.opacities[V]){const Q=new Cr(Z,x,!1,!1);Q.isHidden()||(this.opacities[V]=Q,g=g||Z.text.placed||Z.icon.placed)}}for(const V in D)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=D[V]);for(const V in N)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=N[V]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const g={};for(const x of d){const T=x.getBucket(o);T&&x.latestFeatureIndex&&o.id===T.layerIds[0]&&this.updateBucketOpacities(T,x.tileID,g,x.collisionBoxArray)}}updateBucketOpacities(o,d,g,x){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const T=o.layers[0],D=T.layout,N=new Cr(null,0,!1,!1,!0),V=D.get("text-allow-overlap"),Z=D.get("icon-allow-overlap"),Q=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ce=D.get("text-rotation-alignment")==="map",le=D.get("text-pitch-alignment")==="map",ge=D.get("icon-text-fit")!=="none",be=new Cr(null,0,V&&(Z||!o.hasIconData()||D.get("icon-optional")),Z&&(V||!o.hasTextData()||D.get("text-optional")),!0);!o.collisionArrays&&x&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(x);const ze=(Ne,qe,it)=>{for(let Xe=0;Xe<qe/4;Xe++)Ne.opacityVertexArray.emplaceBack(it);Ne.hasVisibleVertices=Ne.hasVisibleVertices||it!==ch},$e=this.collisionBoxArrays.get(o.bucketInstanceId);for(let Ne=0;Ne<o.symbolInstances.length;Ne++){const qe=o.symbolInstances.get(Ne),{numHorizontalGlyphVertices:it,numVerticalGlyphVertices:Xe,crossTileID:rt}=qe;let ht=this.opacities[rt];g[rt]?ht=N:ht||(ht=be,this.opacities[rt]=ht),g[rt]=!0;const Qe=qe.numIconVertices>0,yt=this.placedOrientations[qe.crossTileID],Ot=yt===s.az.vertical,Pt=yt===s.az.horizontal||yt===s.az.horizontalOnly;if(it>0||Xe>0){const Dt=Mf(ht.text);ze(o.text,it,Ot?ch:Dt),ze(o.text,Xe,Pt?ch:Dt);const gn=ht.text.isHidden();[qe.rightJustifiedTextSymbolIndex,qe.centerJustifiedTextSymbolIndex,qe.leftJustifiedTextSymbolIndex].forEach(Dn=>{Dn>=0&&(o.text.placedSymbolArray.get(Dn).hidden=gn||Ot?1:0)}),qe.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(qe.verticalPlacedTextSymbolIndex).hidden=gn||Pt?1:0);const xn=this.variableOffsets[qe.crossTileID];xn&&this.markUsedJustification(o,xn.anchor,qe,yt);const tn=this.placedOrientations[qe.crossTileID];tn&&(this.markUsedJustification(o,"left",qe,tn),this.markUsedOrientation(o,tn,qe))}if(Qe){const Dt=Mf(ht.icon),gn=!(ge&&qe.verticalPlacedIconSymbolIndex&&Ot);qe.placedIconSymbolIndex>=0&&(ze(o.icon,qe.numIconVertices,gn?Dt:ch),o.icon.placedSymbolArray.get(qe.placedIconSymbolIndex).hidden=ht.icon.isHidden()),qe.verticalPlacedIconSymbolIndex>=0&&(ze(o.icon,qe.numVerticalIconVertices,gn?ch:Dt),o.icon.placedSymbolArray.get(qe.verticalPlacedIconSymbolIndex).hidden=ht.icon.isHidden())}const It=$e&&$e.has(Ne)?$e.get(Ne):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Dt=o.collisionArrays[Ne];if(Dt){let gn=new s.P(0,0);if(Dt.textBox||Dt.verticalTextBox){let xn=!0;if(Q){const tn=this.variableOffsets[rt];tn?(gn=ea(tn.anchor,tn.width,tn.height,tn.textOffset,tn.textBoxScale),ce&&gn._rotate(le?-this.transform.bearingInRadians:this.transform.bearingInRadians)):xn=!1}if(Dt.textBox||Dt.verticalTextBox){let tn;Dt.textBox&&(tn=Ot),Dt.verticalTextBox&&(tn=Pt),_o(o.textCollisionBox.collisionVertexArray,ht.text.placed,!xn||tn,It.text,gn.x,gn.y)}}if(Dt.iconBox||Dt.verticalIconBox){const xn=!!(!Pt&&Dt.verticalIconBox);let tn;Dt.iconBox&&(tn=xn),Dt.verticalIconBox&&(tn=!xn),_o(o.iconCollisionBox.collisionVertexArray,ht.icon.placed,tn,It.icon,ge?gn.x:0,ge?gn.y:0)}}}}if(o.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);o.bucketInstanceId in this.collisionCircleArrays&&(o.collisionCircleArray=this.collisionCircleArrays[o.bucketInstanceId],delete this.collisionCircleArrays[o.bucketInstanceId])}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const g=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function _o(E,o,d,g,x,T){g&&g.length!==0||(g=[0,0,0,0]);const D=g[0]-On,N=g[1]-On,V=g[2]-On,Z=g[3]-On;E.emplaceBack(o?1:0,d?1:0,x||0,T||0,D,N),E.emplaceBack(o?1:0,d?1:0,x||0,T||0,V,N),E.emplaceBack(o?1:0,d?1:0,x||0,T||0,V,Z),E.emplaceBack(o?1:0,d?1:0,x||0,T||0,D,Z)}const eo=Math.pow(2,25),uo=Math.pow(2,24),xo=Math.pow(2,17),kr=Math.pow(2,16),Us=Math.pow(2,9),gm=Math.pow(2,8),yc=Math.pow(2,1);function Mf(E){if(E.opacity===0&&!E.placed)return 0;if(E.opacity===1&&E.placed)return 4294967295;const o=E.placed?1:0,d=Math.floor(127*E.opacity);return d*eo+o*uo+d*xo+o*kr+d*Us+o*gm+d*yc+o}const ch=0;class kl{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,g,x,T){const D=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(D,x,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((N,V)=>N.sortKey-V.sortKey));this._currentPartIndex<D.length;)if(d.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,T())return!0;return!1}}class _c{constructor(o,d,g,x,T,D,N,V){this.placement=new ei(o,d,D,N,V),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(o,d,g){const x=z(),T=()=>!this._forceFullPlacement&&z()-x>2;for(;this._currentPlacementIndex>=0;){const D=d[o[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=N)&&(!D.maxzoom||D.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new kl(D)),this._inProgressLayer.continuePlacement(g[D.source],this.placement,this._showCollisionBoxes,D,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const _r=512/s.a5/2;class Za{constructor(o,d,g){this.tileID=o,this.bucketInstanceId=g,this._symbolsByKey={};const x=new Map;for(let T=0;T<d.length;T++){const D=d.get(T),N=D.key,V=x.get(N);V?V.push(D):x.set(N,[D])}for(const[T,D]of x){const N={positions:D.map(V=>({x:Math.floor(V.anchorX*_r),y:Math.floor(V.anchorY*_r)})),crossTileIDs:D.map(V=>V.crossTileID)};if(N.positions.length>128){const V=new s.aT(N.positions.length,16,Uint16Array);for(const{x:Z,y:Q}of N.positions)V.add(Z,Q);V.finish(),delete N.positions,N.index=V}this._symbolsByKey[T]=N}}getScaledCoordinates(o,d){const{x:g,y:x,z:T}=this.tileID.canonical,{x:D,y:N,z:V}=d.canonical,Z=_r/Math.pow(2,V-T),Q=(N*s.a5+o.anchorY)*Z,ce=x*s.a5*_r;return{x:Math.floor((D*s.a5+o.anchorX)*Z-g*s.a5*_r),y:Math.floor(Q-ce)}}findMatches(o,d,g){const x=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let T=0;T<o.length;T++){const D=o.get(T);if(D.crossTileID)continue;const N=this._symbolsByKey[D.key];if(!N)continue;const V=this.getScaledCoordinates(D,d);if(N.index){const Z=N.index.range(V.x-x,V.y-x,V.x+x,V.y+x).sort();for(const Q of Z){const ce=N.crossTileIDs[Q];if(!g[ce]){g[ce]=!0,D.crossTileID=ce;break}}}else if(N.positions)for(let Z=0;Z<N.positions.length;Z++){const Q=N.positions[Z],ce=N.crossTileIDs[Z];if(Math.abs(Q.x-V.x)<=x&&Math.abs(Q.y-V.y)<=x&&!g[ce]){g[ce]=!0,D.crossTileID=ce;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class xc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ya{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const g in this.indexes){const x=this.indexes[g],T={};for(const D in x){const N=x[D];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+d),T[N.tileID.key]=N}this.indexes[g]=T}this.lng=o}addBucket(o,d,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let T=0;T<d.symbolInstances.length;T++)d.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const x=this.usedCrossTileIDs[o.overscaledZ];for(const T in this.indexes){const D=this.indexes[T];if(Number(T)>o.overscaledZ)for(const N in D){const V=D[N];V.tileID.isChildOf(o)&&V.findMatches(d.symbolInstances,o,x)}else{const N=D[o.scaledTo(Number(T)).key];N&&N.findMatches(d.symbolInstances,o,x)}}for(let T=0;T<d.symbolInstances.length;T++){const D=d.symbolInstances.get(T);D.crossTileID||(D.crossTileID=g.generate(),x[D.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Za(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const g of d.getCrossTileIDsLists())for(const x of g)delete this.usedCrossTileIDs[o][x]}removeStaleBuckets(o){let d=!1;for(const g in this.indexes){const x=this.indexes[g];for(const T in x)o[x[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[T]),delete x[T],d=!0)}return d}}class bo{constructor(){this.layerIndexes={},this.crossTileIDs=new xc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,g){let x=this.layerIndexes[o.id];x===void 0&&(x=this.layerIndexes[o.id]=new Ya);let T=!1;const D={};x.handleWrapJump(g);for(const N of d){const V=N.getBucket(o);V&&o.id===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(N.tileID,V,this.crossTileIDs)&&(T=!0),D[V.bucketInstanceId]=!0)}return x.removeStaleBuckets(D)&&(T=!0),T}pruneUnusedLayers(o){const d={};o.forEach(g=>{d[g]=!0});for(const g in this.layerIndexes)d[g]||delete this.layerIndexes[g]}}var to="void main() {fragColor=vec4(1.0);}";const Zr={prelude:dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:dr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:dr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:dr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:dr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:dr(to,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:dr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:dr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:dr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:dr(to,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:dr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:dr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:dr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:dr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:dr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:dr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:dr(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:dr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:dr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:dr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:dr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:dr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:dr(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:dr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function dr(E,o){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=o.match(/in ([\w]+) ([\w]+)/g),x=E.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=T?T.concat(x):x,N={};return{fragmentSource:E=E.replace(d,(V,Z,Q,ce,le)=>(N[le]=!0,Z==="define"?`
#ifndef HAS_UNIFORM_u_${le}
in ${Q} ${ce} ${le};
#else
uniform ${Q} ${ce} u_${le};
#endif
`:`
#ifdef HAS_UNIFORM_u_${le}
    ${Q} ${ce} ${le} = u_${le};
#endif
`)),vertexSource:o=o.replace(d,(V,Z,Q,ce,le)=>{const ge=ce==="float"?"vec2":"vec4",be=le.match(/color/)?"color":ge;return N[le]?Z==="define"?`
#ifndef HAS_UNIFORM_u_${le}
uniform lowp float u_${le}_t;
in ${Q} ${ge} a_${le};
out ${Q} ${ce} ${le};
#else
uniform ${Q} ${ce} u_${le};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${le}
    ${le} = a_${le};
#else
    ${Q} ${ce} ${le} = u_${le};
#endif
`:`
#ifndef HAS_UNIFORM_u_${le}
    ${le} = unpack_mix_${be}(a_${le}, u_${le}_t);
#else
    ${Q} ${ce} ${le} = u_${le};
#endif
`:Z==="define"?`
#ifndef HAS_UNIFORM_u_${le}
uniform lowp float u_${le}_t;
in ${Q} ${ge} a_${le};
#else
uniform ${Q} ${ce} u_${le};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${le}
    ${Q} ${ce} ${le} = a_${le};
#else
    ${Q} ${ce} ${le} = u_${le};
#endif
`:`
#ifndef HAS_UNIFORM_u_${le}
    ${Q} ${ce} ${le} = unpack_mix_${be}(a_${le}, u_${le}_t);
#else
    ${Q} ${ce} ${le} = u_${le};
#endif
`}),staticAttributes:g,staticUniforms:D}}class ti{constructor(o,d,g){this.vertexBuffer=o,this.indexBuffer=d,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ta=s.aU([{name:"a_pos",type:"Int16",components:2}]);const os="#define PROJECTION_MERCATOR",_s="mercator";class wo{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return _s}get shaderDefine(){return os}get shaderPreludeCode(){return Zr.projectionMercator}get vertexShaderPreludeCode(){return Zr.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(o){}getMeshFromTileID(o,d,g,x,T){if(this._cachedMesh)return this._cachedMesh;const D=new s.aW;D.emplaceBack(0,0),D.emplaceBack(s.a5,0),D.emplaceBack(0,s.a5),D.emplaceBack(s.a5,s.a5);const N=o.createVertexBuffer(D,ta.members),V=s.aX.simpleSegment(0,0,4,2),Z=new s.aY;Z.emplaceBack(1,0,2),Z.emplaceBack(1,2,3);const Q=o.createIndexBuffer(Z);return this._cachedMesh=new ti(N,Q,V),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(o){}}class lu{constructor(o=0,d=0,g=0,x=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=g,this.right=x}interpolate(o,d,g){return d.top!=null&&o.top!=null&&(this.top=s.G.number(o.top,d.top,g)),d.bottom!=null&&o.bottom!=null&&(this.bottom=s.G.number(o.bottom,d.bottom,g)),d.left!=null&&o.left!=null&&(this.left=s.G.number(o.left,d.left,g)),d.right!=null&&o.right!=null&&(this.right=s.G.number(o.right,d.right,g)),this}getCenter(o,d){const g=s.an((this.left+o-this.right)/2,0,o),x=s.an((this.top+d-this.bottom)/2,0,d);return new s.P(g,x)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new lu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function bc(E,o){if(!E.renderWorldCopies||E.lngRange)return;const d=o.lng-E.center.lng;o.lng+=d>180?-360:d<-180?360:0}function vi(E){return Math.max(0,Math.floor(E))}class Ea{constructor(o,d){var g;this.applyConstrain=(x,T)=>this._constrainOverride!==null?this._constrainOverride(x,T):this._callbacks.defaultConstrain(x,T),this._callbacks=o,this._tileSize=512,this._renderWorldCopies=d?.renderWorldCopies===void 0||!!d?.renderWorldCopies,this._minZoom=d?.minZoom||0,this._maxZoom=d?.maxZoom||22,this._minPitch=d?.minPitch==null?0:d?.minPitch,this._maxPitch=d?.maxPitch==null?60:d?.maxPitch,this._constrainOverride=(g=d?.constrainOverride)!==null&&g!==void 0?g:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=vi(this._zoom),this._scale=s.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new lu,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(o,d,g){this._constrainOverride=o.constrainOverride,this._latRange=o.latRange,this._lngRange=o.lngRange,this._width=o.width,this._height=o.height,this._center=o.center,this._elevation=o.elevation,this._minElevationForCurrentTile=o.minElevationForCurrentTile,this._zoom=o.zoom,this._tileZoom=vi(this._zoom),this._scale=s.aq(this._zoom),this._bearingInRadians=o.bearingInRadians,this._fovInRadians=o.fovInRadians,this._pitchInRadians=o.pitchInRadians,this._rollInRadians=o.rollInRadians,this._unmodified=o.unmodified,this._edgeInsets=new lu(o.padding.top,o.padding.bottom,o.padding.left,o.padding.right),this._minZoom=o.minZoom,this._maxZoom=o.maxZoom,this._minPitch=o.minPitch,this._maxPitch=o.maxPitch,this._renderWorldCopies=o.renderWorldCopies,this._cameraToCenterDistance=o.cameraToCenterDistance,this._nearZ=o.nearZ,this._farZ=o.farZ,this._autoCalculateNearFarZ=!g&&o.autoCalculateNearFarZ,d&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(o){this._minElevationForCurrentTile=o}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(o){this._minZoom!==o&&(this._minZoom=o,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(o){this._minPitch!==o&&(this._minPitch=o,this.setPitch(Math.max(this.pitch,o)))}get maxPitch(){return this._maxPitch}setMaxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.setPitch(Math.min(this.pitch,o)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get constrainOverride(){return this._constrainOverride}setConstrainOverride(o){o===void 0&&(o=null),this._constrainOverride!==o&&(this._constrainOverride=o,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(o){const d=s.W(o,-180,180)*Math.PI/180;var g,x,T,D,N,V,Z,Q,ce;this._bearingInRadians!==d&&(this._unmodified=!1,this._bearingInRadians=d,this._calcMatrices(),this._rotationMatrix=_(),g=this._rotationMatrix,T=-this._bearingInRadians,D=(x=this._rotationMatrix)[0],N=x[1],V=x[2],Z=x[3],Q=Math.sin(T),ce=Math.cos(T),g[0]=D*ce+V*Q,g[1]=N*ce+Z*Q,g[2]=D*-Q+V*ce,g[3]=N*-Q+Z*ce)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(o){const d=s.an(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==d&&(this._unmodified=!1,this._pitchInRadians=d,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(o){const d=o/180*Math.PI;this._rollInRadians!==d&&(this._unmodified=!1,this._rollInRadians=d,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aZ(this._fovInRadians)}setFov(o){o=s.an(o,.1,150),this.fov!==o&&(this._unmodified=!1,this._fovInRadians=s.ap(o),this._calcMatrices())}get zoom(){return this._zoom}setZoom(o){const d=this.applyConstrain(this._center,o).zoom;this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this._tileZoom=Math.max(0,Math.floor(d)),this._scale=s.aq(d),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(o){o!==this._elevation&&(this._elevation=o,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(o,d){this._autoCalculateNearFarZ=!1,this._nearZ=o,this._farZ=d,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,g){this._unmodified=!1,this._edgeInsets.interpolate(o,d,g),this.constrainInternal(),this._calcMatrices()}resize(o,d,g=!0){this._width=o,this._height=d,g&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new on([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(o){o?(this._lngRange=[o.getWest(),o.getEast()],this._latRange=[o.getSouth(),o.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-s.ao,s.ao])}getCameraQueryGeometry(o,d){if(d.length===1)return[d[0],o];{const{minX:g,minY:x,maxX:T,maxY:D}=s.aa.fromPoints(d).extend(o);return[new s.P(g,x),new s.P(T,x),new s.P(T,D),new s.P(g,D),new s.P(g,x)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:d,zoom:g}=this.applyConstrain(this.center,this.zoom);this.setCenter(d),this.setZoom(g),this._unmodified=o,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let o=s.ar(new Float64Array(16));s.Q(o,o,[this._width/2,-this._height/2,1]),s.O(o,o,[1,-1,0]),this._clipSpaceToPixelsMatrix=o,o=s.ar(new Float64Array(16)),s.Q(o,o,[1,-1,1]),s.O(o,o,[-1,-1,0]),s.Q(o,o,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=o,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(o,d,g,x){const T=g!==void 0?g:this.bearing,D=x=x!==void 0?x:this.pitch,{distanceToCenter:N,clampedElevation:V}=this._distanceToCenterFromAltElevationPitch(d,this.elevation,D),{x:Z,y:Q}=zt(D,T),ce=s.a9.fromLngLat(o,d);let le,ge,be=s.a_(1,ce.y),ze=0;do{if(ze+=1,ze>10)break;ge=N/be,le=new s.a9(ce.x+Z*ge,ce.y+Q*ge),be=1/le.meterInMercatorCoordinateUnits()}while(Math.abs(N-ge*be)>1e-12);return{center:le.toLngLat(),elevation:V,zoom:s.at(this.height/2/Math.tan(this.fovInRadians/2)/ge/this.tileSize)}}recalculateZoomAndCenter(o){if(this.elevation-o==0)return;const d=1/this.worldSize,g=s.as(1,this.center.lat)*this.worldSize,x=s.a9.fromLngLat(this.center,this.elevation),T=x.x/d,D=x.y/d,N=x.z/d,V=this.pitch,Z=this.bearing,{x:Q,y:ce,z:le}=zt(V,Z),ge=this.cameraToCenterDistance,be=T+ge*-Q,ze=D+ge*-ce,$e=N+ge*le,{distanceToCenter:Ne,clampedElevation:qe}=this._distanceToCenterFromAltElevationPitch($e/g,o,V),it=Ne*g,Xe=new s.a9((be+Q*it)*d,(ze+ce*it)*d,0).toLngLat(),rt=s.as(1,Xe.lat),ht=s.at(this.height/2/Math.tan(this.fovInRadians/2)/Ne/rt/this.tileSize);this._elevation=qe,this._center=Xe,this.setZoom(ht)}_distanceToCenterFromAltElevationPitch(o,d,g){const x=-Math.cos(s.ap(g)),T=o-d;let D,N=d;return x*T>=0||Math.abs(x)<.1?(D=1e4,N=o+D*x):D=-T/x,{distanceToCenter:D,clampedElevation:N}}getCameraPoint(){const o=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(o*Math.sin(this.rollInRadians),o*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const o=s.as(1,this.center.lat)*this.worldSize;return De(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/o).toLngLat()}getMercatorTileCoordinates(o){if(!o)return[0,0,1,1];const d=o.canonical.z>=0?1<<o.canonical.z:Math.pow(2,o.canonical.z);return[o.canonical.x/d,o.canonical.y/d,1/d/s.a5,1/d/s.a5]}}class ss{constructor(o,d){this.min=o,this.max=d,this.center=s.a$([],s.b0([],this.min,this.max),.5)}quadrant(o){const d=[o%2==0,o<2],g=s.b1(this.min),x=s.b1(this.max);for(let T=0;T<d.length;T++)g[T]=d[T]?this.min[T]:this.center[T],x[T]=d[T]?this.center[T]:this.max[T];return x[2]=this.max[2],new ss(g,x)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersectsFrustum(o){let d=!0;for(let g=0;g<o.planes.length;g++){const x=this.intersectsPlane(o.planes[g]);if(x===0)return 0;x===1&&(d=!1)}return d?2:o.aabb.min[0]>this.max[0]||o.aabb.min[1]>this.max[1]||o.aabb.min[2]>this.max[2]||o.aabb.max[0]<this.min[0]||o.aabb.max[1]<this.min[1]||o.aabb.max[2]<this.min[2]?0:1}intersectsPlane(o){let d=o[3],g=o[3];for(let x=0;x<3;x++)o[x]>0?(d+=o[x]*this.min[x],g+=o[x]*this.max[x]):(g+=o[x]*this.min[x],d+=o[x]*this.max[x]);return d>=0?2:g<0?0:1}}class cu{distanceToTile2d(o,d,g,x){const T=x.distanceX([o,d]),D=x.distanceY([o,d]);return Math.hypot(T,D)}getWrap(o,d,g){return g}getTileBoundingVolume(o,d,g,x){var T,D;let N=0,V=0;if(x?.terrain){const Q=new s.a2(o.z,d,o.z,o.x,o.y),ce=x.terrain.getMinMaxElevation(Q);N=(T=ce.minElevation)!==null&&T!==void 0?T:Math.min(0,g),V=(D=ce.maxElevation)!==null&&D!==void 0?D:Math.max(0,g)}const Z=1<<o.z;return new ss([d+o.x/Z,o.y/Z,N],[d+(o.x+1)/Z,(o.y+1)/Z,V])}allowVariableZoom(o,d){const g=o.fov*(Math.abs(Math.cos(o.rollInRadians))*o.height+Math.abs(Math.sin(o.rollInRadians))*o.width)/o.height,x=s.an(78.5-g/2,0,60);return!!d.terrain||o.pitch>x}allowWorldCopies(){return!0}prepareNextFrame(){}}class xs{constructor(o,d,g){this.points=o,this.planes=d,this.aabb=g}static fromInvProjectionMatrix(o,d=1,g=0,x,T){const D=T?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],N=Math.pow(2,g),V=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(le=>function(ge,be,ze,$e){const Ne=s.aH([],ge,be),qe=1/Ne[3]/ze*$e;return s.b6(Ne,Ne,[qe,qe,1/Ne[3],qe])}(le,o,d,N));x&&function(le,ge,be,ze){const $e=ze?4:0,Ne=ze?0:4;let qe=0;const it=[],Xe=[];for(let Qe=0;Qe<4;Qe++){const yt=s.b2([],le[Qe+Ne],le[Qe+$e]),Ot=s.b7(yt);s.a$(yt,yt,1/Ot),it.push(Ot),Xe.push(yt)}for(let Qe=0;Qe<4;Qe++){const yt=s.b8(le[Qe+$e],Xe[Qe],be);qe=yt!==null&&yt>=0?Math.max(qe,yt):Math.max(qe,it[Qe])}const rt=function(Qe,yt){const Ot=s.b2([],Qe[yt[0]],Qe[yt[1]]),Pt=s.b2([],Qe[yt[2]],Qe[yt[1]]),It=[0,0,0,0];return s.b3(It,s.b4([],Ot,Pt)),It[3]=-s.b5(It,Qe[yt[0]]),It}(le,ge),ht=function(Qe,yt){const Ot=s.b9(Qe),Pt=s.ba([],Qe,1/Ot),It=s.b2([],yt,s.a$([],Pt,s.b5(yt,Pt))),Dt=s.b9(It);if(Dt>0){const gn=Math.sqrt(1-Pt[3]*Pt[3]),xn=s.a$([],Pt,-Pt[3]),tn=s.b0([],xn,s.a$([],It,gn/Dt));return s.bb(yt,tn)}return null}(be,rt);if(ht!==null){const Qe=ht/s.b5(Xe[0],rt);qe=Math.min(qe,Qe)}for(let Qe=0;Qe<4;Qe++){const yt=Math.min(qe,it[Qe]);le[Qe+Ne]=[le[Qe+$e][0]+Xe[Qe][0]*yt,le[Qe+$e][1]+Xe[Qe][1]*yt,le[Qe+$e][2]+Xe[Qe][2]*yt,1]}}(V,D[0],x,T);const Z=D.map(le=>{const ge=s.b2([],V[le[0]],V[le[1]]),be=s.b2([],V[le[2]],V[le[1]]),ze=s.b3([],s.b4([],ge,be)),$e=-s.b5(ze,V[le[1]]);return ze.concat($e)}),Q=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],ce=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const le of V)for(let ge=0;ge<3;ge++)Q[ge]=Math.min(Q[ge],le[ge]),ce[ge]=Math.max(ce[ge],le[ge]);return new xs(V,Z,new ss(Q,ce))}}class uu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,d,g){return this._helper.interpolatePadding(o,d,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,d,g=!0){this._helper.resize(o,d,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrainOverride(o){this._helper.setConstrainOverride(o)}overrideNearFarZ(o,d){this._helper.overrideNearFarZ(o,d)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o,d){}constructor(o){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(d,g)=>{g=s.an(+g,this.minZoom,this.maxZoom);const x={center:new s.V(d.lng,d.lat),zoom:g};let T=this._helper._lngRange;if(!this._helper._renderWorldCopies&&T===null){const Xe=179.9999999999;T=[-Xe,Xe]}const D=this.tileSize*s.aq(x.zoom);let N=0,V=D,Z=0,Q=D,ce=0,le=0;const{x:ge,y:be}=this.size;if(this._helper._latRange){const Xe=this._helper._latRange;N=s.X(Xe[1])*D,V=s.X(Xe[0])*D,V-N<be&&(ce=be/(V-N))}T&&(Z=s.W(s.Y(T[0])*D,0,D),Q=s.W(s.Y(T[1])*D,0,D),Q<Z&&(Q+=D),Q-Z<ge&&(le=ge/(Q-Z)));const{x:ze,y:$e}=_e(D,d);let Ne,qe;const it=Math.max(le||0,ce||0);if(it){const Xe=new s.P(le?(Q+Z)/2:ze,ce?(V+N)/2:$e);return x.center=Fe(D,Xe).wrap(),x.zoom+=s.at(it),x}if(this._helper._latRange){const Xe=be/2;$e-Xe<N&&(qe=N+Xe),$e+Xe>V&&(qe=V-Xe)}if(T){const Xe=(Z+Q)/2;let rt=ze;this._helper._renderWorldCopies&&(rt=s.W(ze,Xe-D/2,Xe+D/2));const ht=ge/2;rt-ht<Z&&(Ne=Z+ht),rt+ht>Q&&(Ne=Q-ht)}if(Ne!==void 0||qe!==void 0){const Xe=new s.P(Ne??ze,qe??$e);x.center=Fe(D,Xe).wrap()}return x},this.applyConstrain=(d,g)=>this._helper.applyConstrain(d,g),this._helper=new Ea({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(d,g)=>this.defaultConstrain(d,g)},o),this._coveringTilesDetailsProvider=new cu}clone(){const o=new uu;return o.apply(this,!1),o}apply(o,d,g){this._helper.apply(o,d,g)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(o){const d=[new s.bc(0,o)];if(this._helper._renderWorldCopies){const g=this.screenPointToMercatorCoordinate(new s.P(0,0)),x=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),T=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),D=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),N=Math.floor(Math.min(g.x,x.x,T.x,D.x)),V=Math.floor(Math.max(g.x,x.x,T.x,D.x)),Z=1;for(let Q=N-Z;Q<=V+Z;Q++)Q!==0&&d.push(new s.bc(Q,o))}return d}getCameraFrustum(){return xs.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){const d=this.screenPointToLocation(this.centerPoint,o),g=o?o.getElevationForLngLatZoom(d,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(g)}setLocationAtPoint(o,d){const g=s.as(this.elevation,this.center.lat),x=this.screenPointToMercatorCoordinateAtZ(d,g),T=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,g),D=s.a9.fromLngLat(o),N=new s.a9(D.x-(x.x-T.x),D.y-(x.y-T.y));this.setCenter(N?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(o,d){return d?this.coordinatePoint(s.a9.fromLngLat(o),d.getElevationForLngLat(o,this),this._pixelMatrix3D):this.coordinatePoint(s.a9.fromLngLat(o))}screenPointToLocation(o,d){var g;return(g=this.screenPointToMercatorCoordinate(o,d))===null||g===void 0?void 0:g.toLngLat()}screenPointToMercatorCoordinate(o,d){if(d){const g=d.pointCoordinate(o);if(g!=null)return g}return this.screenPointToMercatorCoordinateAtZ(o)}screenPointToMercatorCoordinateAtZ(o,d){const g=d||0,x=[o.x,o.y,0,1],T=[o.x,o.y,1,1];s.aH(x,x,this._pixelMatrixInverse),s.aH(T,T,this._pixelMatrixInverse);const D=x[3],N=T[3],V=x[1]/D,Z=T[1]/N,Q=x[2]/D,ce=T[2]/N,le=Q===ce?0:(g-Q)/(ce-Q);return new s.a9(s.G.number(x[0]/D,T[0]/N,le)/this.worldSize,s.G.number(V,Z,le)/this.worldSize,g)}coordinatePoint(o,d=0,g=this._pixelMatrix){const x=[o.x*this.worldSize,o.y*this.worldSize,d,1];return s.aH(x,x,g),new s.P(x[0]/x[3],x[1]/x[3])}getBounds(){const o=Math.max(0,this._helper._height/2-Ge(this));return new on().extend(this.screenPointToLocation(new s.P(0,o))).extend(this.screenPointToLocation(new s.P(this._helper._width,o))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(o,d){return d?d.pointCoordinate(o)!=null:o.y>this.height/2-Ge(this)}calculatePosMatrix(o,d=!1,g){var x;const T=(x=o.key)!==null&&x!==void 0?x:s.bd(o.wrap,o.canonical.z,o.canonical.z,o.canonical.x,o.canonical.y),D=d?this._alignedPosMatrixCache:this._posMatrixCache;if(D.has(T)){const Z=D.get(T);return g?Z.f32:Z.f64}const N=je(o,this.worldSize);s.S(N,d?this._alignedProjMatrix:this._viewProjMatrix,N);const V={f64:N,f32:new Float32Array(N)};return D.set(T,V),g?V.f32:V.f64}calculateFogMatrix(o){const d=o.key,g=this._fogMatrixCacheF32;if(g.has(d))return g.get(d);const x=je(o,this.worldSize);return s.S(x,this._fogMatrix,x),g.set(d,new Float32Array(x)),g.get(d)}calculateCenterFromCameraLngLatAlt(o,d,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(o,d,g,x)}_calculateNearFarZIfNeeded(o,d,g){if(!this._helper.autoCalculateNearFarZ)return;const x=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),T=o-x*this._helper._pixelPerMeter/Math.cos(d),D=x<0?T:o,N=Math.PI/2+this.pitchInRadians,V=s.ap(this.fov)*(Math.abs(Math.cos(s.ap(this.roll)))*this.height+Math.abs(Math.sin(s.ap(this.roll)))*this.width)/this.height*(.5+g.y/this.height),Z=Math.sin(V)*D/Math.sin(s.an(Math.PI-N-V,.01,Math.PI-.01)),Q=Ge(this),ce=Math.atan(Q/this._helper.cameraToCenterDistance),le=s.ap(.75),ge=ce>le?2*ce*(.5+g.y/(2*Q)):le,be=Math.sin(ge)*D/Math.sin(s.an(Math.PI-N-ge,.01,Math.PI-.01)),ze=Math.min(Z,be);this._helper._farZ=1.01*(Math.cos(Math.PI/2-d)*ze+D),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const o=this.centerOffset,d=_e(this.worldSize,this.center),g=d.x,x=d.y;this._helper._pixelPerMeter=s.as(1,this.center.lat)*this.worldSize;const T=s.ap(Math.min(this.pitch,st)),D=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(T));let N;this._calculateNearFarZIfNeeded(D,T,o),N=new Float64Array(16),s.be(N,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.aB(this._invProjMatrix,N),N[8]=2*-o.x/this._helper._width,N[9]=2*o.y/this._helper._height,this._projectionMatrix=s.bf(N),s.Q(N,N,[1,-1,1]),s.O(N,N,[0,0,-this._helper.cameraToCenterDistance]),s.bg(N,N,-this.rollInRadians),s.bh(N,N,this.pitchInRadians),s.bg(N,N,-this.bearingInRadians),s.O(N,N,[-g,-x,0]),this._mercatorMatrix=s.Q([],N,[this.worldSize,this.worldSize,this.worldSize]),s.Q(N,N,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,N),s.O(N,N,[0,0,-this.elevation]),this._viewProjMatrix=N,this._invViewProjMatrix=s.aB([],N);const V=[0,0,-1,1];s.aH(V,V,this._invViewProjMatrix),this._cameraPosition=[V[0]/V[3],V[1]/V[3],V[2]/V[3]],this._fogMatrix=new Float64Array(16),s.be(this._fogMatrix,this.fovInRadians,this.width/this.height,D,this._helper._farZ),this._fogMatrix[8]=2*-o.x/this.width,this._fogMatrix[9]=2*o.y/this.height,s.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.O(this._fogMatrix,this._fogMatrix,[-g,-x,0]),s.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,N);const Z=this._helper._width%2/2,Q=this._helper._height%2/2,ce=Math.cos(this.bearingInRadians),le=Math.sin(-this.bearingInRadians),ge=g-Math.round(g)+ce*Z+le*Q,be=x-Math.round(x)+ce*Q+le*Z,ze=new Float64Array(N);if(s.O(ze,ze,[ge>.5?ge-1:ge,be>.5?be-1:be,0]),this._alignedProjMatrix=ze,N=s.aB(new Float64Array(16),this._pixelMatrix),!N)throw new Error("failed to invert matrix");this._pixelMatrixInverse=N,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const o=this.screenPointToMercatorCoordinate(new s.P(0,0)),d=[o.x*this.worldSize,o.y*this.worldSize,0,1];return s.aH(d,d,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const o=s.as(1,this.center.lat)*this.worldSize;return De(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/o).toLngLat()}lngLatToCameraDepth(o,d){const g=s.a9.fromLngLat(o),x=[g.x*this.worldSize,g.y*this.worldSize,d,1];return s.aH(x,x,this._viewProjMatrix),x[2]/x[3]}getProjectionData(o){const{overscaledTileID:d,aligned:g,applyTerrainMatrix:x}=o,T=this._helper.getMercatorTileCoordinates(d),D=d?this.calculatePosMatrix(d,g,!0):null;let N;return N=d&&d.terrainRttPosMatrix32f&&x?d.terrainRttPosMatrix32f:D||s.bi(),{mainMatrix:N,tileMercatorCoords:T,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:N}}isLocationOccluded(o){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(o,d,g){return 1}transformLightDirection(o){return s.b1(o)}getRayDirectionFromPixel(o){throw new Error("Not implemented.")}projectTileCoordinates(o,d,g,x){const T=this.calculatePosMatrix(g);let D;x?(D=[o,d,x(o,d),1],s.aH(D,D,T)):(D=[o,d,0,1],wr(D,D,T));const N=D[3];return{point:new s.P(D[0]/N,D[1]/N),signedDistanceFromCamera:N,isOccluded:!1}}populateCache(o){for(const d of o)this.calculatePosMatrix(d)}getMatrixForModel(o,d){const g=s.a9.fromLngLat(o,d),x=g.meterInMercatorCoordinateUnits(),T=s.bj();return s.O(T,T,[g.x,g.y,g.z]),s.bg(T,T,Math.PI),s.bh(T,T,Math.PI/2),s.Q(T,T,[-x,x,x]),T}getProjectionDataForCustomLayer(o=!0){const d=new s.a2(0,0,0,0,0),g=this.getProjectionData({overscaledTileID:d,applyGlobeMatrix:o}),x=je(d,this.worldSize);s.S(x,this._viewProjMatrix,x),g.tileMercatorCoords=[0,0,1,1];const T=[s.a5,s.a5,this.worldSize/this._helper.pixelsPerMeter],D=s.bk();return s.Q(D,x,T),g.fallbackMatrix=D,g.mainMatrix=D,g}getFastPathSimpleProjectionMatrix(o){return this.calculatePosMatrix(o)}}function Ca(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function fd(E){if(E.useSlerp)if(E.k<1){const o=s.bl(E.startEulerAngles.roll,E.startEulerAngles.pitch,E.startEulerAngles.bearing),d=s.bl(E.endEulerAngles.roll,E.endEulerAngles.pitch,E.endEulerAngles.bearing),g=new Float64Array(4);s.bm(g,o,d,E.k);const x=s.bn(g);E.tr.setRoll(x.roll),E.tr.setPitch(x.pitch),E.tr.setBearing(x.bearing)}else E.tr.setRoll(E.endEulerAngles.roll),E.tr.setPitch(E.endEulerAngles.pitch),E.tr.setBearing(E.endEulerAngles.bearing);else E.tr.setRoll(s.G.number(E.startEulerAngles.roll,E.endEulerAngles.roll,E.k)),E.tr.setPitch(s.G.number(E.startEulerAngles.pitch,E.endEulerAngles.pitch,E.k)),E.tr.setBearing(s.G.number(E.startEulerAngles.bearing,E.endEulerAngles.bearing,E.k))}function pd(E,o,d,g,x){const T=x.padding,D=_e(x.worldSize,d.getNorthWest()),N=_e(x.worldSize,d.getNorthEast()),V=_e(x.worldSize,d.getSouthEast()),Z=_e(x.worldSize,d.getSouthWest()),Q=s.ap(-g),ce=D.rotate(Q),le=N.rotate(Q),ge=V.rotate(Q),be=Z.rotate(Q),ze=new s.P(Math.max(ce.x,le.x,be.x,ge.x),Math.max(ce.y,le.y,be.y,ge.y)),$e=new s.P(Math.min(ce.x,le.x,be.x,ge.x),Math.min(ce.y,le.y,be.y,ge.y)),Ne=ze.sub($e),qe=(x.width-(T.left+T.right+o.left+o.right))/Ne.x,it=(x.height-(T.top+T.bottom+o.top+o.bottom))/Ne.y;if(it<0||qe<0)return void Ca();const Xe=Math.min(s.at(x.scale*Math.min(qe,it)),E.maxZoom),rt=s.P.convert(E.offset),ht=new s.P((o.left-o.right)/2,(o.top-o.bottom)/2).rotate(s.ap(g)),Qe=rt.add(ht).mult(x.scale/s.aq(Xe));return{center:Fe(x.worldSize,D.add(V).div(2).sub(Qe)),zoom:Xe,bearing:g}}class wc{get useGlobeControls(){return!1}handlePanInertia(o,d){const g=o.mag(),x=Math.abs(Ge(d));return{easingOffset:o.mult(Math.min(.75*x/g,1)),easingCenter:d.center}}handleMapControlsRollPitchBearingZoom(o,d){o.bearingDelta&&d.setBearing(d.bearing+o.bearingDelta),o.pitchDelta&&d.setPitch(d.pitch+o.pitchDelta),o.rollDelta&&d.setRoll(d.roll+o.rollDelta),o.zoomDelta&&d.setZoom(d.zoom+o.zoomDelta)}handleMapControlsPan(o,d,g){o.around.distSqr(d.centerPoint)<.01||d.setLocationAtPoint(g,o.around)}cameraForBoxAndBearing(o,d,g,x,T){return pd(o,d,g,x,T)}handleJumpToCenterZoom(o,d){o.zoom!==(d.zoom!==void 0?+d.zoom:o.zoom)&&o.setZoom(+d.zoom),d.center!==void 0&&o.setCenter(s.V.convert(d.center))}handleEaseTo(o,d){const g=o.zoom,x=o.padding,T={roll:o.roll,pitch:o.pitch,bearing:o.bearing},D={roll:d.roll===void 0?o.roll:d.roll,pitch:d.pitch===void 0?o.pitch:d.pitch,bearing:d.bearing===void 0?o.bearing:d.bearing},N=d.zoom!==void 0,V=!o.isPaddingEqual(d.padding);let Z=!1;const Q=N?+d.zoom:o.zoom;let ce=o.centerPoint.add(d.offsetAsPoint);const le=o.screenPointToLocation(ce),{center:ge,zoom:be}=o.applyConstrain(s.V.convert(d.center||le),Q??g);bc(o,ge);const ze=_e(o.worldSize,le),$e=_e(o.worldSize,ge).sub(ze),Ne=s.aq(be-g);return Z=be!==g,{easeFunc:qe=>{if(Z&&o.setZoom(s.G.number(g,be,qe)),s.bo(T,D)||fd({startEulerAngles:T,endEulerAngles:D,tr:o,k:qe,useSlerp:T.roll!=D.roll}),V&&(o.interpolatePadding(x,d.padding,qe),ce=o.centerPoint.add(d.offsetAsPoint)),d.around)o.setLocationAtPoint(d.around,d.aroundPoint);else{const it=s.aq(o.zoom-g),Xe=be>g?Math.min(2,Ne):Math.max(.5,Ne),rt=Math.pow(Xe,1-qe),ht=Fe(o.worldSize,ze.add($e.mult(qe*rt)).mult(it));o.setLocationAtPoint(o.renderWorldCopies?ht.wrap():ht,ce)}},isZooming:Z,elevationCenter:ge}}handleFlyTo(o,d){const g=d.zoom!==void 0,x=o.zoom,T=o.applyConstrain(s.V.convert(d.center||d.locationAtOffset),g?+d.zoom:x),D=T.center,N=T.zoom;bc(o,D);const V=_e(o.worldSize,d.locationAtOffset),Z=_e(o.worldSize,D).sub(V),Q=Z.mag(),ce=s.aq(N-x);let le;if(d.minZoom!==void 0){const ge=Math.min(+d.minZoom,x,N),be=o.applyConstrain(D,ge).zoom;le=s.aq(be-x)}return{easeFunc:(ge,be,ze,$e)=>{o.setZoom(ge===1?N:x+s.at(be));const Ne=ge===1?D:Fe(o.worldSize,V.add(Z.mult(ze)).mult(be));o.setLocationAtPoint(o.renderWorldCopies?Ne.wrap():Ne,$e)},scaleOfZoom:ce,targetCenter:D,scaleOfMinZoom:le,pixelPathLength:Q}}}class Br{constructor(o,d,g){this.blendFunction=o,this.blendColor=d,this.mask=g}}Br.Replace=[1,0],Br.disabled=new Br(Br.Replace,s.bp.transparent,[!1,!1,!1,!1]),Br.unblended=new Br(Br.Replace,s.bp.transparent,[!0,!0,!0,!0]),Br.alphaBlended=new Br([1,771],s.bp.transparent,[!0,!0,!0,!0]);const Sc=2305;class Pr{constructor(o,d,g){this.enable=o,this.mode=d,this.frontFace=g}}Pr.disabled=new Pr(!1,1029,Sc),Pr.backCCW=new Pr(!0,1029,Sc),Pr.frontCCW=new Pr(!0,1028,Sc);class xr{constructor(o,d,g){this.func=o,this.mask=d,this.range=g}}xr.ReadOnly=!1,xr.ReadWrite=!0,xr.disabled=new xr(519,xr.ReadOnly,[0,1]);const zl=7680;class Rr{constructor(o,d,g,x,T,D){this.test=o,this.ref=d,this.mask=g,this.fail=x,this.depthFail=T,this.pass=D}}Rr.disabled=new Rr({func:519,mask:0},0,0,zl,zl,zl);const uh=new WeakMap;function zi(E){var o;if(uh.has(E))return uh.get(E);{const d=(o=E.getParameter(E.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return uh.set(E,d),d}}class Ta{get awaitingQuery(){return!!this._readbackQueue}constructor(o){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=o;const d=o.context,g=d.gl;this._texFormat=g.RGBA,this._texType=g.UNSIGNED_BYTE;const x=new s.aW;x.emplaceBack(-1,-1),x.emplaceBack(2,-1),x.emplaceBack(-1,2);const T=new s.aY;T.emplaceBack(0,1,2),this._fullscreenTriangle=new ti(d.createVertexBuffer(x,ta.members),d.createIndexBuffer(T),s.aX.simpleSegment(0,0,x.length,T.length)),this._resultBuffer=new Uint8Array(4),d.activeTexture.set(g.TEXTURE1);const D=g.createTexture();g.bindTexture(g.TEXTURE_2D,D),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texImage2D(g.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=d.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(D),zi(g)&&(this._pbo=g.createBuffer(),g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.bufferData(g.PIXEL_PACK_BUFFER,4,g.STREAM_READ),g.bindBuffer(g.PIXEL_PACK_BUFFER,null))}destroy(){const o=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),o.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(o,d){const g=this._updateCount;return this._readbackQueue?g>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():g>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(o,d),this._updateCount++,this._measuredError}_bindFramebuffer(){const o=this._cachedRenderContext.context,d=o.gl;o.activeTexture.set(d.TEXTURE1),d.bindTexture(d.TEXTURE_2D,this._fbo.colorAttachment.get()),o.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(o,d){const g=this._cachedRenderContext.context,x=g.gl;if(this._bindFramebuffer(),g.viewport.set([0,0,this._texWidth,this._texHeight]),g.clear({color:s.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(g,x.TRIANGLES,xr.disabled,Rr.disabled,Br.unblended,Pr.disabled,((T,D)=>({u_input:T,u_output_expected:D}))(o,d),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&zi(x)){x.bindBuffer(x.PIXEL_PACK_BUFFER,this._pbo),x.readBuffer(x.COLOR_ATTACHMENT0),x.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),x.bindBuffer(x.PIXEL_PACK_BUFFER,null);const T=x.fenceSync(x.SYNC_GPU_COMMANDS_COMPLETE,0);x.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:T}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const o=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&zi(o)){const d=o.clientWaitSync(this._readbackQueue.sync,0,0);if(d===o.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(d===o.TIMEOUT_EXPIRED)return;o.bindBuffer(o.PIXEL_PACK_BUFFER,this._pbo),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),o.bindBuffer(o.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),o.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ta._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(o){let d=0;return d+=o[0]/256,d+=o[1]/65536,d+=o[2]/16777216,o[3]<127&&(d=-d),d/128}}const Ka=s.a5/128;function hh(E,o){const d=E.granularity!==void 0?Math.max(E.granularity,1):1,g=d+(E.generateBorders?2:0),x=d+(E.extendToNorthPole||E.generateBorders?1:0)+(E.extendToSouthPole||E.generateBorders?1:0),T=g+1,D=x+1,N=E.generateBorders?-1:0,V=E.generateBorders||E.extendToNorthPole?-1:0,Z=d+(E.generateBorders?1:0),Q=d+(E.generateBorders||E.extendToSouthPole?1:0),ce=T*D,le=g*x*6,ge=T*D>65536;if(ge&&o==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const be=ge||o==="32bit",ze=new Int16Array(2*ce);let $e=0;for(let it=V;it<=Q;it++)for(let Xe=N;Xe<=Z;Xe++){let rt=Xe/d*s.a5;Xe===-1&&(rt=-Ka),Xe===d+1&&(rt=s.a5+Ka);let ht=it/d*s.a5;it===-1&&(ht=E.extendToNorthPole?s.br:-Ka),it===d+1&&(ht=E.extendToSouthPole?s.bs:s.a5+Ka),ze[$e++]=rt,ze[$e++]=ht}const Ne=be?new Uint32Array(le):new Uint16Array(le);let qe=0;for(let it=0;it<x;it++)for(let Xe=0;Xe<g;Xe++){const rt=Xe+1+it*T,ht=Xe+(it+1)*T,Qe=Xe+1+(it+1)*T;Ne[qe++]=Xe+it*T,Ne[qe++]=ht,Ne[qe++]=rt,Ne[qe++]=rt,Ne[qe++]=ht,Ne[qe++]=Qe}return{vertices:ze.buffer.slice(0),indices:Ne.buffer.slice(0),uses32bitIndices:be}}const md=new s.aV({fill:new s.bt(128,2),line:new s.bt(512,0),tile:new s.bt(128,32),stencil:new s.bt(128,1),circle:3});class gd{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Zr.projectionGlobe}get vertexShaderPreludeCode(){return Zr.projectionMercator.vertexSource}get subdivisionGranularity(){return md}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(o){this._errorMeasurement||(this._errorMeasurement=new Ta(o));const d=s.X(this._errorQueryLatitudeDegrees),g=2*Math.atan(Math.exp(Math.PI-d*Math.PI*2))-.5*Math.PI,x=this._errorMeasurement.updateErrorLoop(d,g),T=z();x!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=x,this._errorMeasurementLastChangeTime=T);const D=Math.min(Math.max((T-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bv(D))}_getMeshKey(o){return`${o.granularity.toString(36)}_${o.generateBorders?"b":""}${o.extendToNorthPole?"n":""}${o.extendToSouthPole?"s":""}`}getMeshFromTileID(o,d,g,x,T){const D=(T==="stencil"?md.stencil:md.tile).getGranularityForZoomLevel(d.z);return this._getMesh(o,{granularity:D,generateBorders:g,extendToNorthPole:d.y===0&&x,extendToSouthPole:d.y===(1<<d.z)-1&&x})}_getMesh(o,d){const g=this._getMeshKey(d);if(g in this._tileMeshCache)return this._tileMeshCache[g];const x=function(T,D){const N=hh(D,"16bit"),V=s.aW.deserialize({arrayBuffer:N.vertices,length:N.vertices.byteLength/2/2}),Z=s.aY.deserialize({arrayBuffer:N.indices,length:N.indices.byteLength/2/3});return new ti(T.createVertexBuffer(V,ta.members),T.createIndexBuffer(Z),s.aX.simpleSegment(0,0,V.length,Z.length))}(o,d);return this._tileMeshCache[g]=x,x}recalculate(o){}hasTransition(){const o=z();let d=!1;return d=d||(o-this._errorMeasurementLastChangeTime)/1e3<.7,d=d||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,d}setErrorQueryLatitudeDegrees(o){this._errorQueryLatitudeDegrees=o}}const vm=new s.t({type:new s.D(s.u.projection.type)});class dh extends s.E{constructor(o){super(),this._transitionable=new s.x(vm,void 0),this.setProjection(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.H(0)),this._mercatorProjection=new wo,this._verticalPerspectiveProjection=new gd}get transitionState(){const o=this.properties.get("type");if(typeof o=="string"&&o==="mercator")return 0;if(typeof o=="string"&&o==="vertical-perspective")return 1;if(o instanceof s.bw){if(o.from==="vertical-perspective"&&o.to==="mercator")return 1-o.transition;if(o.from==="mercator"&&o.to==="vertical-perspective")return o.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(o){this._mercatorProjection.updateGPUdependent(o),this._verticalPerspectiveProjection.updateGPUdependent(o)}getMeshFromTileID(o,d,g,x,T){return this.currentProjection.getMeshFromTileID(o,d,g,x,T)}setProjection(o){this._transitionable.setValue("type",o?.type||"mercator")}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}setErrorQueryLatitudeDegrees(o){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(o),this._mercatorProjection.setErrorQueryLatitudeDegrees(o)}}function So(E){const o=hu(E.worldSize,E.center.lat);return 2*Math.PI*o}function Pa(E,o,d,g,x){const T=1/(1<<x),D=o/s.a5*T+g*T,N=s.bz((E/s.a5*T+d*T)*Math.PI*2+Math.PI,2*Math.PI),V=2*Math.atan(Math.exp(Math.PI-D*Math.PI*2))-.5*Math.PI,Z=Math.cos(V),Q=new Float64Array(3);return Q[0]=Math.sin(N)*Z,Q[1]=Math.sin(V),Q[2]=Math.cos(N)*Z,Q}function Ai(E){return function(o,d){const g=Math.cos(d),x=new Float64Array(3);return x[0]=Math.sin(o)*g,x[1]=Math.sin(d),x[2]=Math.cos(o)*g,x}(E.lng*Math.PI/180,E.lat*Math.PI/180)}function hu(E,o){return E/(2*Math.PI)/Math.cos(o*Math.PI/180)}function ym(E){const o=Math.asin(E[1])/Math.PI*180,d=Math.sqrt(E[0]*E[0]+E[2]*E[2]);if(d>1e-6){const g=E[0]/d,x=Math.acos(E[2]/d),T=(g>0?x:-x)/Math.PI*180;return new s.V(s.W(T,-180,180),o)}return new s.V(0,o)}function du(E){return Math.cos(E*Math.PI/180)}function Ui(E,o){const d=du(E),g=du(o);return s.at(g/d)}function jg(E,o){const d=E.rotate(o.bearingInRadians),g=o.zoom+Ui(o.center.lat,0),x=s.bu(1/du(o.center.lat),1/du(Math.min(Math.abs(o.center.lat),60)),s.bx(g,7,3,0,1)),T=360/So({worldSize:o.worldSize,center:{lat:o.center.lat}});return new s.V(o.center.lng-d.x*T*x,s.an(o.center.lat+d.y*T,-s.ao,s.ao))}function _m(E){const o=.5*E,d=Math.sin(o),g=Math.cos(o);return Math.log(d+g)-Math.log(g-d)}function Hg(E,o,d,g){const x=E.lat+d*g;if(Math.abs(d)>1){const T=(Math.sign(E.lat+d)!==Math.sign(E.lat)?-Math.abs(E.lat):Math.abs(E.lat))*Math.PI/180,D=Math.abs(E.lat+d)*Math.PI/180,N=_m(T+g*(D-T)),V=_m(T),Z=_m(D);return new s.V(E.lng+o*((N-V)/(Z-V)),x)}return new s.V(E.lng+o*g,x)}class i0{constructor(o){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=o}swapBuffers(){if(!this._hadAnyChanges)return;const o=this._cachePrevious;this._cachePrevious=this._cache,this._cache=o,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(o,d,g,x){const T=`${o.z}_${o.x}_${o.y}_${x?.terrain?"t":""}`,D=this._cache.get(T);if(D)return D;const N=this._cachePrevious.get(T);if(N)return this._cache.set(T,N),N;const V=this._boundingVolumeFactory(o,d,g,x);return this._cache.set(T,V),this._hadAnyChanges=!0,V}}class fu{constructor(o,d,g,x){this.min=g,this.max=x,this.points=o,this.planes=d}static fromAabb(o,d){const g=[];for(let x=0;x<8;x++)g.push([1&~x?o[0]:d[0],(x>>1&1)==1?d[1]:o[1],(x>>2&1)==1?d[2]:o[2]]);return new fu(g,[[-1,0,0,d[0]],[1,0,0,-o[0]],[0,-1,0,d[1]],[0,1,0,-o[1]],[0,0,-1,d[2]],[0,0,1,-o[2]]],o,d)}static fromCenterSizeAngles(o,d,g){const x=s.bB([],g[0],g[1],g[2]),T=s.bC([],[d[0],0,0],x),D=s.bC([],[0,d[1],0],x),N=s.bC([],[0,0,d[2]],x),V=[...o],Z=[...o];for(let ce=0;ce<8;ce++)for(let le=0;le<3;le++){const ge=o[le]+T[le]*(1&~ce?-1:1)+D[le]*((ce>>1&1)==1?1:-1)+N[le]*((ce>>2&1)==1?1:-1);V[le]=Math.min(V[le],ge),Z[le]=Math.max(Z[le],ge)}const Q=[];for(let ce=0;ce<8;ce++){const le=[...o];s.b0(le,le,s.a$([],T,1&~ce?-1:1)),s.b0(le,le,s.a$([],D,(ce>>1&1)==1?1:-1)),s.b0(le,le,s.a$([],N,(ce>>2&1)==1?1:-1)),Q.push(le)}return new fu(Q,[[...T,-s.b5(T,Q[0])],[...D,-s.b5(D,Q[0])],[...N,-s.b5(N,Q[0])],[-T[0],-T[1],-T[2],-s.b5(T,Q[7])],[-D[0],-D[1],-D[2],-s.b5(D,Q[7])],[-N[0],-N[1],-N[2],-s.b5(N,Q[7])]],V,Z)}intersectsFrustum(o){let d=!0;const g=this.points.length,x=this.planes.length,T=o.planes.length,D=o.points.length;for(let N=0;N<T;N++){const V=o.planes[N];let Z=0;for(let Q=0;Q<g;Q++){const ce=this.points[Q];V[0]*ce[0]+V[1]*ce[1]+V[2]*ce[2]+V[3]>=0&&Z++}if(Z===0)return 0;Z<g&&(d=!1)}if(d)return 2;for(let N=0;N<x;N++){const V=this.planes[N];let Z=0;for(let Q=0;Q<D;Q++){const ce=o.points[Q];V[0]*ce[0]+V[1]*ce[1]+V[2]*ce[2]+V[3]>=0&&Z++}if(Z===0)return 0}return 1}intersectsPlane(o){const d=this.points.length;let g=0;for(let x=0;x<d;x++){const T=this.points[x];o[0]*T[0]+o[1]*T[1]+o[2]*T[2]+o[3]>=0&&g++}return g===d?2:g===0?0:1}}function Ef(E,o,d){const g=E-o;return g<0?-g:Math.max(0,g-d)}function fh(E,o,d,g,x){const T=E-d;let D;return D=T<0?Math.min(-T,1+T-x):T>1?Math.min(Math.max(T-x,0),1-T):0,Math.max(D,Ef(o,g,x))}class xm{constructor(){this._boundingVolumeCache=new i0(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(o,d,g,x){const T=1<<g.z,D=1/T,N=g.x/T,V=g.y/T;let Z=2;return Z=Math.min(Z,fh(o,d,N,V,D)),Z=Math.min(Z,fh(o,d,N+.5,-V-D,D)),Z=Math.min(Z,fh(o,d,N+.5,2-V-D,D)),Z}getWrap(o,d,g){const x=1<<d.z,T=1/x,D=d.x/x,N=Ef(o.x,D,T),V=Ef(o.x,D-1,T),Z=Ef(o.x,D+1,T),Q=Math.min(N,V,Z);return Q===Z?1:Q===V?-1:0}allowVariableZoom(o,d){return Zn(o,d)>4}allowWorldCopies(){return!1}getTileBoundingVolume(o,d,g,x){return this._boundingVolumeCache.getTileBoundingVolume(o,d,g,x)}_computeTileBoundingVolume(o,d,g,x){var T,D;let N=0,V=0;if(x?.terrain){const Z=new s.a2(o.z,d,o.z,o.x,o.y),Q=x.terrain.getMinMaxElevation(Z);N=(T=Q.minElevation)!==null&&T!==void 0?T:Math.min(0,g),V=(D=Q.maxElevation)!==null&&D!==void 0?D:Math.max(0,g)}if(N/=s.bE,V/=s.bE,N+=1,V+=1,o.z<=0)return fu.fromAabb([-V,-V,-V],[V,V,V]);if(o.z===1)return fu.fromAabb([o.x===0?-V:0,o.y===0?0:-V,-V],[o.x===0?0:V,o.y===0?V:0,V]);{const Z=[Pa(0,0,o.x,o.y,o.z),Pa(s.a5,0,o.x,o.y,o.z),Pa(s.a5,s.a5,o.x,o.y,o.z),Pa(0,s.a5,o.x,o.y,o.z)],Q=[];for(const It of Z)Q.push(s.a$([],It,V));if(V!==N)for(const It of Z)Q.push(s.a$([],It,N));o.y===0&&Q.push([0,1,0]),o.y===(1<<o.z)-1&&Q.push([0,-1,0]);const ce=[1,1,1],le=[-1,-1,-1];for(const It of Q)for(let Dt=0;Dt<3;Dt++)ce[Dt]=Math.min(ce[Dt],It[Dt]),le[Dt]=Math.max(le[Dt],It[Dt]);const ge=Pa(s.a5/2,s.a5/2,o.x,o.y,o.z),be=s.b4([],[0,1,0],ge);s.b3(be,be);const ze=s.b4([],ge,be);s.b3(ze,ze);const $e=s.b4([],Z[2],Z[1]);s.b3($e,$e);const Ne=s.b4([],Z[0],Z[3]);s.b3(Ne,Ne),Q.push(s.a$([],ge,V)),o.y>=(1<<o.z)/2&&Q.push(s.a$([],Pa(s.a5/2,0,o.x,o.y,o.z),V)),o.y<(1<<o.z)/2&&Q.push(s.a$([],Pa(s.a5/2,s.a5,o.x,o.y,o.z),V));const qe=vd(ge,Q),it=vd(ze,Q),Xe=[-ge[0],-ge[1],-ge[2],qe.max],rt=[ge[0],ge[1],ge[2],-qe.min],ht=[-ze[0],-ze[1],-ze[2],it.max],Qe=[ze[0],ze[1],ze[2],-it.min],yt=[...$e,0],Ot=[...Ne,0],Pt=[];return o.y===0?Pt.push(s.bD(Ot,yt,Xe),s.bD(Ot,yt,rt)):Pt.push(s.bD(ht,yt,Xe),s.bD(ht,yt,rt),s.bD(ht,Ot,Xe),s.bD(ht,Ot,rt)),o.y===(1<<o.z)-1?Pt.push(s.bD(Ot,yt,Xe),s.bD(Ot,yt,rt)):Pt.push(s.bD(Qe,yt,Xe),s.bD(Qe,yt,rt),s.bD(Qe,Ot,Xe),s.bD(Qe,Ot,rt)),new fu(Pt,[Xe,rt,ht,Qe,yt,Ot],ce,le)}}}function vd(E,o){let d=1/0,g=-1/0;for(const x of o){const T=s.b5(E,x);d=Math.min(d,T),g=Math.max(g,T)}return{min:d,max:g}}class Mc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,d,g){return this._helper.interpolatePadding(o,d,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,d){this._helper.resize(o,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrainOverride(o){this._helper.setConstrainOverride(o)}overrideNearFarZ(o,d){this._helper.overrideNearFarZ(o,d)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o){}constructor(o){this._cachedClippingPlane=s.bF(),this._projectionMatrix=s.bj(),this._globeViewProjMatrix32f=s.bi(),this._globeViewProjMatrixNoCorrection=s.bj(),this._globeViewProjMatrixNoCorrectionInverted=s.bj(),this._globeProjMatrixInverted=s.bj(),this._cameraPosition=s.bA(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(d,g)=>{const x=s.an(d.lat,-s.ao,s.ao),T=s.an(+g,this.minZoom+Ui(0,x),this.maxZoom);return{center:new s.V(d.lng,x),zoom:T}},this.applyConstrain=(d,g)=>this._helper.applyConstrain(d,g),this._helper=new Ea({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(d,g)=>this.defaultConstrain(d,g)},o),this._coveringTilesDetailsProvider=new xm}clone(){const o=new Mc;return o.apply(this,!1),o}apply(o,d,g){this._globeLatitudeErrorCorrectionRadians=g||0,this._helper.apply(o,d)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const o=s.bA();return o[0]=this._cameraPosition[0],o[1]=this._cameraPosition[1],o[2]=this._cameraPosition[2],o}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(o){const{overscaledTileID:d,applyGlobeMatrix:g}=o,x=this._helper.getMercatorTileCoordinates(d);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:x,clippingPlane:this._cachedClippingPlane,projectionTransition:g?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(o){const d=this.pitchInRadians,g=this.cameraToCenterDistance/o,x=Math.sin(d)*g,T=Math.cos(d)*g+1,D=1/Math.sqrt(x*x+T*T)*1;let N=-x,V=T;const Z=Math.sqrt(N*N+V*V);N/=Z,V/=Z;const Q=[0,N,V];s.bG(Q,Q,[0,0,0],-this.bearingInRadians),s.bH(Q,Q,[0,0,0],-1*this.center.lat*Math.PI/180),s.bI(Q,Q,[0,0,0],this.center.lng*Math.PI/180);const ce=1/s.b7(Q);return s.a$(Q,Q,ce),[...Q,-D*ce]}isLocationOccluded(o){return!this.isSurfacePointVisible(Ai(o))}transformLightDirection(o){const d=this._helper._center.lng*Math.PI/180,g=this._helper._center.lat*Math.PI/180,x=Math.cos(g),T=[Math.sin(d)*x,Math.sin(g),Math.cos(d)*x],D=[T[2],0,-T[0]],N=[0,0,0];s.b4(N,D,T),s.b3(D,D),s.b3(N,N);const V=[0,0,0];return s.b3(V,[D[0]*o[0]+N[0]*o[1]+T[0]*o[2],D[1]*o[0]+N[1]*o[1]+T[1]*o[2],D[2]*o[0]+N[2]*o[1]+T[2]*o[2]]),V}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(o,d,g){const x=function(N,V,Z){const Q=1/(1<<Z.z);return new s.a9(N/s.a5*Q+Z.x*Q,V/s.a5*Q+Z.y*Q)}(o,d,g.canonical),T=(D=x.y,[s.bz(x.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-D*Math.PI*2))-.5*Math.PI]);var D;return this.getCircleRadiusCorrection()/Math.cos(T[1])}projectTileCoordinates(o,d,g,x){const T=g.canonical,D=Pa(o,d,T.x,T.y,T.z),N=1+(x?x(o,d):0)/s.bE,V=[D[0]*N,D[1]*N,D[2]*N,1];s.aH(V,V,this._globeViewProjMatrixNoCorrection);const Z=this._cachedClippingPlane,Q=Z[0]*D[0]+Z[1]*D[1]+Z[2]*D[2]+Z[3]<0;return{point:new s.P(V[0]/V[3],V[1]/V[3]),signedDistanceFromCamera:V[3],isOccluded:Q}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const o=hu(this.worldSize,this.center.lat),d=s.bk(),g=s.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*o),s.be(d,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const x=this.centerOffset;d[8]=2*-x.x/this._helper._width,d[9]=2*x.y/this._helper._height,this._projectionMatrix=s.bf(d),this._globeProjMatrixInverted=s.bk(),s.aB(this._globeProjMatrixInverted,d),s.O(d,d,[0,0,-this.cameraToCenterDistance]),s.bg(d,d,this.rollInRadians),s.bh(d,d,-this.pitchInRadians),s.bg(d,d,this.bearingInRadians),s.O(d,d,[0,0,-o]);const T=s.bA();T[0]=o,T[1]=o,T[2]=o,s.bh(g,d,this.center.lat*Math.PI/180),s.bJ(g,g,-this.center.lng*Math.PI/180),s.Q(g,g,T),this._globeViewProjMatrixNoCorrection=g,s.bh(d,d,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.bJ(d,d,-this.center.lng*Math.PI/180),s.Q(d,d,T),this._globeViewProjMatrix32f=new Float32Array(d),this._globeViewProjMatrixNoCorrectionInverted=s.bk(),s.aB(this._globeViewProjMatrixNoCorrectionInverted,g);const D=s.bA();this._cameraPosition=s.bA(),this._cameraPosition[2]=this.cameraToCenterDistance/o,s.bG(this._cameraPosition,this._cameraPosition,D,-this.rollInRadians),s.bH(this._cameraPosition,this._cameraPosition,D,this.pitchInRadians),s.bG(this._cameraPosition,this._cameraPosition,D,-this.bearingInRadians),s.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bH(this._cameraPosition,this._cameraPosition,D,-this.center.lat*Math.PI/180),s.bI(this._cameraPosition,this._cameraPosition,D,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(o);const N=s.bf(this._globeViewProjMatrixNoCorrectionInverted);s.Q(N,N,[1,1,-1]),this._cachedFrustum=xs.fromInvProjectionMatrix(N,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(o){s.w("calculateFogMatrix is not supported on globe projection.");const d=s.bk();return s.ar(d),d}getVisibleUnwrappedCoordinates(o){return[new s.bc(0,o)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){o&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,d){if(!this._globeViewProjMatrixNoCorrection)return 1;const g=Ai(o);s.a$(g,g,1+d/s.bE);const x=s.bF();return s.aH(x,[g[0],g[1],g[2],1],this._globeViewProjMatrixNoCorrection),x[2]/x[3]}populateCache(o){}getBounds(){const o=.5*this.width,d=.5*this.height,g=[new s.P(0,0),new s.P(o,0),new s.P(this.width,0),new s.P(this.width,d),new s.P(this.width,this.height),new s.P(o,this.height),new s.P(0,this.height),new s.P(0,d)],x=[];for(const ce of g)x.push(this.unprojectScreenPoint(ce));let T=0,D=0,N=0,V=0;const Z=this.center;for(const ce of x){const le=s.bK(Z.lng,ce.lng),ge=s.bK(Z.lat,ce.lat);le<D&&(D=le),le>T&&(T=le),ge<V&&(V=ge),ge>N&&(N=ge)}const Q=[Z.lng+D,Z.lat+V,Z.lng+T,Z.lat+N];return this.isSurfacePointOnScreen([0,1,0])&&(Q[3]=90,Q[0]=-180,Q[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(Q[1]=-90,Q[0]=-180,Q[2]=180),new on(Q)}calculateCenterFromCameraLngLatAlt(o,d,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(o,d,g,x)}setLocationAtPoint(o,d){const g=Ai(this.unprojectScreenPoint(d)),x=Ai(o),T=s.bA();s.bL(T);const D=s.bA();s.bI(D,g,T,-this.center.lng*Math.PI/180),s.bH(D,D,T,this.center.lat*Math.PI/180);const N=x[0]*x[0]+x[2]*x[2],V=D[0]*D[0];if(N<V)return;const Z=Math.sqrt(N-V),Q=-Z,ce=s.bM(x[0],x[2],D[0],Z),le=s.bM(x[0],x[2],D[0],Q),ge=s.bA();s.bI(ge,x,T,-ce);const be=s.bM(ge[1],ge[2],D[1],D[2]),ze=s.bA();s.bI(ze,x,T,-le);const $e=s.bM(ze[1],ze[2],D[1],D[2]),Ne=.5*Math.PI,qe=be>=-Ne&&be<=Ne,it=$e>=-Ne&&$e<=Ne;let Xe,rt;if(qe&&it){const Ot=this.center.lng*Math.PI/180,Pt=this.center.lat*Math.PI/180;s.bN(ce,Ot)+s.bN(be,Pt)<s.bN(le,Ot)+s.bN($e,Pt)?(Xe=ce,rt=be):(Xe=le,rt=$e)}else if(qe)Xe=ce,rt=be;else{if(!it)return;Xe=le,rt=$e}const ht=Xe/Math.PI*180,Qe=rt/Math.PI*180,yt=this.center.lat;this.setCenter(new s.V(ht,s.an(Qe,-90,90))),this.setZoom(this.zoom+Ui(yt,this.center.lat))}locationToScreenPoint(o,d){const g=Ai(o);if(d){const x=d.getElevationForLngLatZoom(o,this._helper._tileZoom);s.a$(g,g,1+x/s.bE)}return this._projectSurfacePointToScreen(g)}_projectSurfacePointToScreen(o){const d=s.bF();return s.aH(d,[...o,1],this._globeViewProjMatrixNoCorrection),d[0]/=d[3],d[1]/=d[3],new s.P((.5*d[0]+.5)*this.width,(.5*-d[1]+.5)*this.height)}screenPointToMercatorCoordinate(o,d){if(d){const g=d.pointCoordinate(o);if(g)return g}return s.a9.fromLngLat(this.unprojectScreenPoint(o))}screenPointToLocation(o,d){var g;return(g=this.screenPointToMercatorCoordinate(o,d))===null||g===void 0?void 0:g.toLngLat()}isPointOnMapSurface(o,d){const g=this._cameraPosition,x=this.getRayDirectionFromPixel(o);return!!this.rayPlanetIntersection(g,x)}getRayDirectionFromPixel(o){const d=s.bF();d[0]=o.x/this.width*2-1,d[1]=-1*(o.y/this.height*2-1),d[2]=1,d[3]=1,s.aH(d,d,this._globeViewProjMatrixNoCorrectionInverted),d[0]/=d[3],d[1]/=d[3],d[2]/=d[3];const g=s.bA();g[0]=d[0]-this._cameraPosition[0],g[1]=d[1]-this._cameraPosition[1],g[2]=d[2]-this._cameraPosition[2];const x=s.bA();return s.b3(x,g),x}isSurfacePointVisible(o){const d=this._cachedClippingPlane;return d[0]*o[0]+d[1]*o[1]+d[2]*o[2]+d[3]>=0}isSurfacePointOnScreen(o){if(!this.isSurfacePointVisible(o))return!1;const d=s.bF();return s.aH(d,[...o,1],this._globeViewProjMatrixNoCorrection),d[0]/=d[3],d[1]/=d[3],d[2]/=d[3],d[0]>-1&&d[0]<1&&d[1]>-1&&d[1]<1&&d[2]>-1&&d[2]<1}rayPlanetIntersection(o,d){const g=s.b5(o,d),x=s.bA(),T=s.bA();s.a$(T,d,g),s.b2(x,o,T);const D=1-s.b5(x,x);if(D<0)return null;const N=s.b5(o,o)-1,V=-g+(g<0?1:-1)*Math.sqrt(D),Z=N/V,Q=V;return{tMin:Math.min(Z,Q),tMax:Math.max(Z,Q)}}unprojectScreenPoint(o){const d=this._cameraPosition,g=this.getRayDirectionFromPixel(o),x=this.rayPlanetIntersection(d,g);if(x){const Q=s.bA();s.b0(Q,d,[g[0]*x.tMin,g[1]*x.tMin,g[2]*x.tMin]);const ce=s.bA();return s.b3(ce,Q),ym(ce)}const T=this._cachedClippingPlane,D=T[0]*g[0]+T[1]*g[1]+T[2]*g[2],N=-s.bb(T,d)/D,V=s.bA();if(N>0)s.b0(V,d,[g[0]*N,g[1]*N,g[2]*N]);else{const Q=s.bA();s.b0(Q,d,[2*g[0],2*g[1],2*g[2]]);const ce=s.bb(this._cachedClippingPlane,Q);s.b2(V,Q,[this._cachedClippingPlane[0]*ce,this._cachedClippingPlane[1]*ce,this._cachedClippingPlane[2]*ce])}const Z=function(Q){const ce=s.bA();return ce[0]=Q[0]*-Q[3],ce[1]=Q[1]*-Q[3],ce[2]=Q[2]*-Q[3],{center:ce,radius:Math.sqrt(1-Q[3]*Q[3])}}(T);return ym(function(Q,ce,le){const ge=s.bA();s.b2(ge,le,Q);const be=s.bA();return s.by(be,Q,ge,ce/s.b9(ge)),be}(Z.center,Z.radius,V))}getMatrixForModel(o,d){const g=s.V.convert(o),x=1/s.bE,T=s.bj();return s.bJ(T,T,g.lng/180*Math.PI),s.bh(T,T,-g.lat/180*Math.PI),s.O(T,T,[0,0,1+d/s.bE]),s.bh(T,T,.5*Math.PI),s.Q(T,T,[x,x,x]),T}getProjectionDataForCustomLayer(o=!0){const d=this.getProjectionData({overscaledTileID:new s.a2(0,0,0,0,0),applyGlobeMatrix:o});return d.tileMercatorCoords=[0,0,1,1],d}getFastPathSimpleProjectionMatrix(o){}}class ph{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,d,g){return this._helper.interpolatePadding(o,d,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,d,g=!0){this._helper.resize(o,d,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrainOverride(o){this._helper.setConstrainOverride(o)}overrideNearFarZ(o,d){this._helper.overrideNearFarZ(o,d)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(o,d){this._globeness=o,this._globeLatitudeErrorCorrectionRadians=d,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(o){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(d,g)=>this.currentTransform.defaultConstrain(d,g),this.applyConstrain=(d,g)=>this._helper.applyConstrain(d,g),this._helper=new Ea({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(d,g)=>this.defaultConstrain(d,g)},o),this._globeness=1,this._mercatorTransform=new uu,this._verticalPerspectiveTransform=new Mc}clone(){const o=new ph;return o._globeness=this._globeness,o._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,o.apply(this,!1),o}apply(o,d){this._helper.apply(o,d),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(o){const d=this._mercatorTransform.getProjectionData(o),g=this._verticalPerspectiveTransform.getProjectionData(o);return{mainMatrix:this.isGlobeRendering?g.mainMatrix:d.mainMatrix,clippingPlane:g.clippingPlane,tileMercatorCoords:g.tileMercatorCoords,projectionTransition:o.applyGlobeMatrix?this._globeness:0,fallbackMatrix:d.fallbackMatrix}}isLocationOccluded(o){return this.currentTransform.isLocationOccluded(o)}transformLightDirection(o){return this.currentTransform.transformLightDirection(o)}getPixelScale(){return s.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(o,d,g){const x=this._mercatorTransform.getPitchedTextCorrection(o,d,g),T=this._verticalPerspectiveTransform.getPitchedTextCorrection(o,d,g);return s.bu(x,T,this._globeness)}projectTileCoordinates(o,d,g,x){return this.currentTransform.projectTileCoordinates(o,d,g,x)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(o){return this.currentTransform.calculateFogMatrix(o)}getVisibleUnwrappedCoordinates(o){return this.currentTransform.getVisibleUnwrappedCoordinates(o)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(o){this._mercatorTransform.recalculateZoomAndCenter(o),this._verticalPerspectiveTransform.recalculateZoomAndCenter(o)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,d){return this.currentTransform.lngLatToCameraDepth(o,d)}populateCache(o){this._mercatorTransform.populateCache(o),this._verticalPerspectiveTransform.populateCache(o)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(o,d,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(o,d,g,x)}setLocationAtPoint(o,d){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(o,d),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(o,d),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(o,d){return this.currentTransform.locationToScreenPoint(o,d)}screenPointToMercatorCoordinate(o,d){return this.currentTransform.screenPointToMercatorCoordinate(o,d)}screenPointToLocation(o,d){return this.currentTransform.screenPointToLocation(o,d)}isPointOnMapSurface(o,d){return this.currentTransform.isPointOnMapSurface(o,d)}getRayDirectionFromPixel(o){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(o)}getMatrixForModel(o,d){return this.currentTransform.getMatrixForModel(o,d)}getProjectionDataForCustomLayer(o=!0){const d=this._mercatorTransform.getProjectionDataForCustomLayer(o);if(!this.isGlobeRendering)return d;const g=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(o);return g.fallbackMatrix=d.mainMatrix,g}getFastPathSimpleProjectionMatrix(o){return this.currentTransform.getFastPathSimpleProjectionMatrix(o)}}class no{get useGlobeControls(){return!0}handlePanInertia(o,d){const g=jg(o,d);return Math.abs(g.lng-d.center.lng)>180&&(g.lng=d.center.lng+179.5*Math.sign(g.lng-d.center.lng)),{easingCenter:g,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(o,d){const g=o.around,x=d.screenPointToLocation(g);o.bearingDelta&&d.setBearing(d.bearing+o.bearingDelta),o.pitchDelta&&d.setPitch(d.pitch+o.pitchDelta),o.rollDelta&&d.setRoll(d.roll+o.rollDelta);const T=d.zoom;o.zoomDelta&&d.setZoom(d.zoom+o.zoomDelta);const D=d.zoom-T;if(D===0)return;const N=s.bK(d.center.lng,x.lng),V=N/(Math.abs(N/180)+1),Z=s.bK(d.center.lat,x.lat),Q=d.getRayDirectionFromPixel(g),ce=d.cameraPosition,le=-1*s.b5(ce,Q),ge=s.bA();s.b0(ge,ce,[Q[0]*le,Q[1]*le,Q[2]*le]);const be=s.b7(ge)-1,ze=Math.exp(.5*-Math.max(be-.3,0)),$e=hu(d.worldSize,d.center.lat)/Math.min(d.width,d.height),Ne=s.bx($e,.9,.5,1,.25),qe=(1-s.aq(-D))*Math.min(ze,Ne),it=d.center.lat,Xe=d.zoom,rt=new s.V(d.center.lng+V*qe,s.an(d.center.lat+Z*qe,-s.ao,s.ao));d.setLocationAtPoint(x,g);const ht=d.center,Qe=s.bx(Math.abs(N),45,85,0,1),yt=s.bx($e,.75,.35,0,1),Ot=Math.pow(Math.max(Qe,yt),.25),Pt=s.bK(ht.lng,rt.lng),It=s.bK(ht.lat,rt.lat);d.setCenter(new s.V(ht.lng+Pt*Ot,ht.lat+It*Ot).wrap()),d.setZoom(Xe+Ui(it,d.center.lat))}handleMapControlsPan(o,d,g){if(!o.panDelta)return;const x=d.center.lat,T=d.zoom;d.setCenter(jg(o.panDelta,d).wrap()),d.setZoom(T+Ui(x,d.center.lat))}cameraForBoxAndBearing(o,d,g,x,T){const D=pd(o,d,g,x,T),N=d.left/T.width*2-1,V=(T.width-d.right)/T.width*2-1,Z=d.top/T.height*-2+1,Q=(T.height-d.bottom)/T.height*-2+1,ce=s.bK(g.getWest(),g.getEast())<0,le=ce?g.getEast():g.getWest(),ge=ce?g.getWest():g.getEast(),be=Math.max(g.getNorth(),g.getSouth()),ze=Math.min(g.getNorth(),g.getSouth()),$e=le+.5*s.bK(le,ge),Ne=be+.5*s.bK(be,ze),qe=T.clone();qe.setCenter(D.center),qe.setBearing(D.bearing),qe.setPitch(0),qe.setRoll(0),qe.setZoom(D.zoom);const it=qe.modelViewProjectionMatrix,Xe=[Ai(g.getNorthWest()),Ai(g.getNorthEast()),Ai(g.getSouthWest()),Ai(g.getSouthEast()),Ai(new s.V(ge,Ne)),Ai(new s.V(le,Ne)),Ai(new s.V($e,be)),Ai(new s.V($e,ze))],rt=Ai(D.center);let ht=Number.POSITIVE_INFINITY;for(const Qe of Xe)N<0&&(ht=no.getLesserNonNegativeNonNull(ht,no.solveVectorScale(Qe,rt,it,"x",N))),V>0&&(ht=no.getLesserNonNegativeNonNull(ht,no.solveVectorScale(Qe,rt,it,"x",V))),Z>0&&(ht=no.getLesserNonNegativeNonNull(ht,no.solveVectorScale(Qe,rt,it,"y",Z))),Q<0&&(ht=no.getLesserNonNegativeNonNull(ht,no.solveVectorScale(Qe,rt,it,"y",Q)));if(Number.isFinite(ht)&&ht!==0)return D.zoom=qe.zoom+s.at(ht),D;Ca()}handleJumpToCenterZoom(o,d){const g=o.center.lat,x=o.applyConstrain(d.center?s.V.convert(d.center):o.center,o.zoom).center;o.setCenter(x.wrap());const T=d.zoom!==void 0?+d.zoom:o.zoom+Ui(g,x.lat);o.zoom!==T&&o.setZoom(T)}handleEaseTo(o,d){const g=o.zoom,x=o.center,T=o.padding,D={roll:o.roll,pitch:o.pitch,bearing:o.bearing},N={roll:d.roll===void 0?o.roll:d.roll,pitch:d.pitch===void 0?o.pitch:d.pitch,bearing:d.bearing===void 0?o.bearing:d.bearing},V=d.zoom!==void 0,Z=!o.isPaddingEqual(d.padding);let Q=!1;const ce=d.center?s.V.convert(d.center):x,le=o.applyConstrain(ce,g).center;bc(o,le);const ge=o.clone();ge.setCenter(le),ge.setZoom(V?+d.zoom:g+Ui(x.lat,ce.lat)),ge.setBearing(d.bearing);const be=new s.P(s.an(o.centerPoint.x+d.offsetAsPoint.x,0,o.width),s.an(o.centerPoint.y+d.offsetAsPoint.y,0,o.height));ge.setLocationAtPoint(le,be);const ze=(d.offset&&d.offsetAsPoint.mag())>0?ge.center:le,$e=V?+d.zoom:g+Ui(x.lat,ze.lat),Ne=g+Ui(x.lat,0),qe=$e+Ui(ze.lat,0),it=s.bK(x.lng,ze.lng),Xe=s.bK(x.lat,ze.lat),rt=s.aq(qe-Ne);return Q=$e!==g,{easeFunc:ht=>{if(s.bo(D,N)||fd({startEulerAngles:D,endEulerAngles:N,tr:o,k:ht,useSlerp:D.roll!=N.roll}),Z&&o.interpolatePadding(T,d.padding,ht),d.around)s.w("Easing around a point is not supported under globe projection."),o.setLocationAtPoint(d.around,d.aroundPoint);else{const Qe=qe>Ne?Math.min(2,rt):Math.max(.5,rt),yt=Math.pow(Qe,1-ht),Ot=Hg(x,it,Xe,ht*yt);o.setCenter(Ot.wrap())}if(Q){const Qe=s.G.number(Ne,qe,ht)+Ui(0,o.center.lat);o.setZoom(Qe)}},isZooming:Q,elevationCenter:ze}}handleFlyTo(o,d){const g=d.zoom!==void 0,x=o.center,T=o.zoom,D=o.padding,N=!o.isPaddingEqual(d.padding),V=o.applyConstrain(s.V.convert(d.center||d.locationAtOffset),T).center,Z=g?+d.zoom:o.zoom+Ui(o.center.lat,V.lat),Q=o.clone();Q.setCenter(V),Q.setZoom(Z),Q.setBearing(d.bearing);const ce=new s.P(s.an(o.centerPoint.x+d.offsetAsPoint.x,0,o.width),s.an(o.centerPoint.y+d.offsetAsPoint.y,0,o.height));Q.setLocationAtPoint(V,ce);const le=Q.center;bc(o,le);const ge=function(Xe,rt,ht){const Qe=Ai(rt),yt=Ai(ht),Ot=s.b5(Qe,yt),Pt=Math.acos(Ot),It=So(Xe);return Pt/(2*Math.PI)*It}(o,x,le),be=T+Ui(x.lat,0),ze=Z+Ui(le.lat,0),$e=s.aq(ze-be);let Ne;if(typeof d.minZoom=="number"){const Xe=+d.minZoom+Ui(le.lat,0),rt=Math.min(Xe,be,ze)+Ui(0,le.lat),ht=o.applyConstrain(le,rt).zoom+Ui(le.lat,0);Ne=s.aq(ht-be)}const qe=s.bK(x.lng,le.lng),it=s.bK(x.lat,le.lat);return{easeFunc:(Xe,rt,ht,Qe)=>{const yt=Hg(x,qe,it,ht);N&&o.interpolatePadding(D,d.padding,Xe);const Ot=Xe===1?le:yt;o.setCenter(Ot.wrap());const Pt=be+s.at(rt);o.setZoom(Xe===1?Z:Pt+Ui(0,Ot.lat))},scaleOfZoom:$e,targetCenter:le,scaleOfMinZoom:Ne,pixelPathLength:ge}}static solveVectorScale(o,d,g,x,T){const D=x==="x"?[g[0],g[4],g[8],g[12]]:[g[1],g[5],g[9],g[13]],N=[g[3],g[7],g[11],g[15]],V=o[0]*D[0]+o[1]*D[1]+o[2]*D[2],Z=o[0]*N[0]+o[1]*N[1]+o[2]*N[2],Q=d[0]*D[0]+d[1]*D[1]+d[2]*D[2],ce=d[0]*N[0]+d[1]*N[1]+d[2]*N[2];return Q+T*Z===V+T*ce||N[3]*(V-Q)+D[3]*(ce-Z)+V*ce==Q*Z?null:(Q+D[3]-T*ce-T*N[3])/(Q-V-T*ce+T*Z)}static getLesserNonNegativeNonNull(o,d){return d!==null&&d>=0&&d<o?d:o}}class Gg{constructor(o){this._globe=o,this._mercatorCameraHelper=new wc,this._verticalPerspectiveCameraHelper=new no}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(o,d){return this.currentHelper.handlePanInertia(o,d)}handleMapControlsRollPitchBearingZoom(o,d){return this.currentHelper.handleMapControlsRollPitchBearingZoom(o,d)}handleMapControlsPan(o,d,g){this.currentHelper.handleMapControlsPan(o,d,g)}cameraForBoxAndBearing(o,d,g,x,T){return this.currentHelper.cameraForBoxAndBearing(o,d,g,x,T)}handleJumpToCenterZoom(o,d){this.currentHelper.handleJumpToCenterZoom(o,d)}handleEaseTo(o,d){return this.currentHelper.handleEaseTo(o,d)}handleFlyTo(o,d){return this.currentHelper.handleFlyTo(o,d)}}const pu=(E,o)=>s.B(E,o&&o.filter(d=>d.identifier!=="source.canvas")),yd=s.bO();class mu extends s.E{constructor(o,d={}){var g,x;super(),this._rtlPluginLoaded=()=>{for(const D in this.tileManagers){const N=this.tileManagers[D].getSource().type;N!=="vector"&&N!=="geojson"||this.tileManagers[D].reload()}},this.map=o,this.dispatcher=new Tt(Mt(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(D,N)=>this.getGlyphs(D,N)),this.dispatcher.registerMessageHandler("GI",(D,N)=>this.getImages(D,N)),this.dispatcher.registerMessageHandler("GDA",(D,N)=>this.getDashes(D,N)),this.imageManager=new Ee,this.imageManager.setEventedParent(this);const T=((g=o._container)===null||g===void 0?void 0:g.lang)||typeof document<"u"&&((x=document.documentElement)===null||x===void 0?void 0:x.lang)||void 0;this.glyphManager=new Ie(o._requestManager,d.localIdeographFontFamily,T),this.lineAtlas=new Ht(256,512),this.crossTileSymbolIndex=new bo,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",s.bP()),oe().on(Fn,this._rtlPluginLoaded),this.on("data",D=>{if(D.dataType!=="source"||D.sourceDataType!=="metadata")return;const N=this.tileManagers[D.sourceId];if(!N)return;const V=N.getSource();if(V&&V.vectorLayerIds)for(const Z in this._layers){const Q=this._layers[Z];Q.source===V.id&&this._validateLayer(Q)}})}_setInitialValues(){var o;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new s.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((o=this.crossTileSymbolIndex)===null||o===void 0?void 0:o.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(o,d){var g,x,T;this._checkLoaded();const D=d===null?(T=(x=(g=this.stylesheet.state)===null||g===void 0?void 0:g[o])===null||x===void 0?void 0:x.default)!==null&&T!==void 0?T:null:d;if(s.bR(D,this._globalState[o]))return this;this._globalState[o]=D,this._applyGlobalStateChanges([o])}getGlobalState(){return this._globalState}setGlobalState(o){this._checkLoaded();const d=[];for(const g in o)!s.bR(this._globalState[g],o[g].default)&&(d.push(g),this._globalState[g]=o[g].default);this._applyGlobalStateChanges(d)}_applyGlobalStateChanges(o){if(o.length===0)return;const d=new Set,g={};for(const x of o){g[x]=this._globalState[x];for(const T in this._layers){const D=this._layers[T],N=D.getLayoutAffectingGlobalStateRefs(),V=D.getPaintAffectingGlobalStateRefs(),Z=D.getVisibilityAffectingGlobalStateRefs();if(N.has(x)&&d.add(D.source),V.has(x))for(const{name:Q,value:ce}of V.get(x))this._updatePaintProperty(D,Q,ce);Z?.has(x)&&(D.recalculateVisibility(),this._updateLayer(D))}}this.dispatcher.broadcast("UGS",g);for(const x in this.tileManagers)d.has(x)&&(this._reloadSource(x),this._changed=!0)}loadURL(o,d={},g){this.fire(new s.l("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const x=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const T=this._loadStyleRequest;s.j(x,this._loadStyleRequest).then(D=>{this._loadStyleRequest=null,this._load(D.data,d,g)}).catch(D=>{this._loadStyleRequest=null,D&&!T.signal.aborted&&this.fire(new s.k(D))})}loadJSON(o,d={},g){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,A.frameAsync(this._frameRequest,this.map._ownerWindow).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(o,d,g)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(yd,{validate:!1})}_load(o,d,g){var x,T;let D=d.transformStyle?d.transformStyle(g,o):o;if(!d.validate||!pu(this,s.C(D))){D=Object.assign({},D),this._loaded=!0,this.stylesheet=D;for(const N in D.sources)this.addSource(N,D.sources[N],{validate:!1});D.sprite?this._loadSprite(D.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(D.glyphs),this._createLayers(),this.light=new nt(this.stylesheet.light),this._setProjectionInternal(((x=this.stylesheet.projection)===null||x===void 0?void 0:x.type)||"mercator"),this.sky=new lt(this.stylesheet.sky),this.map.setTerrain((T=this.stylesheet.terrain)!==null&&T!==void 0?T:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){var o,d,g;const x=s.bS(this.stylesheet.layers);this.setGlobalState((o=this.stylesheet.state)!==null&&o!==void 0?o:null),this.dispatcher.broadcast("SL",x),this._order=x.map(T=>T.id),this._layers={},this._serializedLayers=null;for(const T of x){const D=s.bT(T,this._globalState);if(D.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=D,s.bU(D)&&this.tileManagers[D.source]){const N=(g=(d=T.paint)===null||d===void 0?void 0:d["raster-fade-duration"])!==null&&g!==void 0?g:D.paint.get("raster-fade-duration");this.tileManagers[D.source].setRasterFadeDuration(N)}}}_loadSprite(o,d=!1,g=void 0){this.imageManager.setLoaded(!1);const x=new AbortController;let T;this._spriteRequest=x,function(D,N,V,Z){return s._(this,void 0,void 0,function*(){const Q=ne(D),ce=V>1?"@2x":"",le={},ge={};for(const{id:be,url:ze}of Q){const $e=N.transformRequest(H(ze,ce,".json"),"SpriteJSON");le[be]=s.j($e,Z);const Ne=N.transformRequest(H(ze,ce,".png"),"SpriteImage");ge[be]=J.getImage(Ne,Z)}return yield Promise.all([...Object.values(le),...Object.values(ge)]),function(be,ze){return s._(this,void 0,void 0,function*(){const $e={};for(const Ne in be){$e[Ne]={};const qe=A.getImageCanvasContext((yield ze[Ne]).data),it=(yield be[Ne]).data;for(const Xe in it){const{width:rt,height:ht,x:Qe,y:yt,sdf:Ot,pixelRatio:Pt,stretchX:It,stretchY:Dt,content:gn,textFitWidth:xn,textFitHeight:tn}=it[Xe];$e[Ne][Xe]={data:null,pixelRatio:Pt,sdf:Ot,stretchX:It,stretchY:Dt,content:gn,textFitWidth:xn,textFitHeight:tn,spriteData:{width:rt,height:ht,x:Qe,y:yt,context:qe}}}}return $e})}(le,ge)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(D=>{if(this._spriteRequest=null,D)for(const N in D){this._spritesImagesIds[N]=[];const V=this._spritesImagesIds[N]?this._spritesImagesIds[N].filter(Z=>!(Z in D)):[];for(const Z of V)this.imageManager.removeImage(Z),this._changedImages[Z]=!0;for(const Z in D[N]){const Q=N==="default"?Z:`${N}:${Z}`;this._spritesImagesIds[N].push(Q),Q in this.imageManager.images?this.imageManager.updateImage(Q,D[N][Z],!1):this.imageManager.addImage(Q,D[N][Z]),d&&(this._changedImages[Q]=!0)}}}).catch(D=>{this._spriteRequest=null,T=D,x.signal.aborted||this.fire(new s.k(T))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),g&&g(T)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(o){const d=this.tileManagers[o.source];if(!d)return;const g=o.sourceLayer;if(!g)return;const x=d.getSource();(x.type==="geojson"||x.vectorLayerIds&&x.vectorLayerIds.indexOf(g)===-1)&&this.fire(new s.k(new Error(`Source layer "${g}" does not exist on source "${x.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.tileManagers)if(!this.tileManagers[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,d=!1){const g=this._serializedAllLayers();if(!o||o.length===0)return Object.values(d?s.bV(g):g);const x=[];for(const T of o)if(g[T]){const D=d?s.bV(g[T]):g[T];x.push(D)}return x}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const d=Object.keys(this._layers);for(const g of d){const x=this._layers[g];x.type!=="custom"&&(o[g]=x.serialize())}return o}hasTransitions(){var o,d,g;if(!((o=this.light)===null||o===void 0)&&o.hasTransition()||!((d=this.sky)===null||d===void 0)&&d.hasTransition()||!((g=this.projection)===null||g===void 0)&&g.hasTransition())return!0;for(const x in this.tileManagers)if(this.tileManagers[x].hasTransition())return!0;for(const x in this._layers)if(this._layers[x].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const d=this._changed;if(d){const x=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(x.length||T.length)&&this._updateWorkerLayers(x,T);for(const D in this._updatedSources){const N=this._updatedSources[D];if(N==="reload")this._reloadSource(D);else{if(N!=="clear")throw new Error(`Invalid action ${N}`);this._clearSource(D)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const g={};for(const x in this.tileManagers){const T=this.tileManagers[x];g[x]=T.used,T.used=!1}for(const x of this._order){const T=this._layers[x];T.recalculate(o,this._availableImages),!T.isHidden(o.zoom)&&T.source&&(this.tileManagers[T.source].used=!0)}for(const x in g){const T=this.tileManagers[x];!!g[x]!=!!T.used&&T.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:x}))}this.light.recalculate(o),this.sky.recalculate(o),this.projection.recalculate(o),this.z=o.zoom,d&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this.tileManagers)this.tileManagers[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.tileManagers)this.tileManagers[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,d={}){var g;this._checkLoaded();const x=this.serialize();if(o=d.transformStyle?d.transformStyle(x,o):o,((g=d.validate)===null||g===void 0||g)&&pu(this,s.C(o)))return!1;(o=s.bV(o)).layers=s.bS(o.layers);const T=s.bW(x,o),D=this._getOperationsToPerform(T);if(D.unimplemented.length>0)throw new Error(`Unimplemented: ${D.unimplemented.join(", ")}.`);if(D.operations.length===0)return!1;for(const N of D.operations)N();return this.stylesheet=o,this._serializedLayers=null,this.fire(new s.l("style.load",{style:this})),!0}_getOperationsToPerform(o){const d=[],g=[];for(const x of o)switch(x.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,x.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,x.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,x.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,x.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,x.args));break;case"addSource":d.push(()=>this.addSource.apply(this,x.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,x.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,x.args));break;case"setLight":d.push(()=>this.setLight.apply(this,x.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,x.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,x.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,x.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,x.args));break;case"setSky":d.push(()=>this.setSky.apply(this,x.args));break;case"setProjection":this.setProjection.apply(this,x.args);break;case"setGlobalState":d.push(()=>this.setGlobalState.apply(this,x.args));break;case"setTransition":d.push(()=>{});break;default:g.push(x.command)}return{operations:d,unimplemented:g}}addImage(o,d){if(this.getImage(o))return this.fire(new s.k(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,d),this._afterImageUpdated(o)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new s.k(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,d,g={}){if(this._checkLoaded(),this.tileManagers[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(s.C.source,`sources.${o}`,d,null,g))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const x=this.tileManagers[o]=new kn(o,d,this.dispatcher);x.style=this,x.setEventedParent(this,()=>({isSourceLoaded:x.loaded(),source:x.serialize(),sourceId:o})),x.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.tileManagers[o]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===o)return this.fire(new s.k(new Error(`Source "${o}" cannot be removed while layer "${g}" is using it.`)));const d=this.tileManagers[o];delete this.tileManagers[o],delete this._updatedSources[o],d.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,d){if(this._checkLoaded(),this.tileManagers[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const g=this.tileManagers[o].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(d),this._changed=!0}getSource(o){return this.tileManagers[o]&&this.tileManagers[o].getSource()}addLayer(o,d,g={}){this._checkLoaded();const x=o.id;if(this.getLayer(x))return void this.fire(new s.k(new Error(`Layer "${x}" already exists on this map.`)));let T;if(o.type==="custom"){if(pu(this,s.bX(o)))return;T=s.bT(o,this._globalState)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(x,o.source),o=s.bV(o),o=s.e(o,{source:x})),this._validate(s.C.layer,`layers.${x}`,o,{arrayIndex:-1},g))return;T=s.bT(o,this._globalState),this._validateLayer(T),T.setEventedParent(this,{layer:{id:x}})}const D=d?this._order.indexOf(d):this._order.length;if(d&&D===-1)this.fire(new s.k(new Error(`Cannot add layer "${x}" before non-existing layer "${d}".`)));else{if(this._order.splice(D,0,x),this._layerOrderChanged=!0,this._layers[x]=T,this._removedLayers[x]&&T.source&&T.type!=="custom"){const N=this._removedLayers[x];delete this._removedLayers[x],N.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.tileManagers[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new s.k(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const g=this._order.indexOf(o);this._order.splice(g,1);const x=d?this._order.indexOf(d):this._order.length;d&&x===-1?this.fire(new s.k(new Error(`Cannot move layer "${o}" before non-existing layer "${d}".`))):(this._order.splice(x,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${o}".`)));d.setEventedParent(null);const g=this._order.indexOf(o);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,d,g){this._checkLoaded();const x=this.getLayer(o);x?x.minzoom===d&&x.maxzoom===g||(d!=null&&(x.minzoom=d),g!=null&&(x.maxzoom=g),this._updateLayer(x)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,d,g={}){this._checkLoaded();const x=this.getLayer(o);if(x){if(!s.bR(x.filter,d))return d==null?(x.setFilter(void 0),void this._updateLayer(x)):void(this._validate(s.C.filter,`layers.${x.id}.filter`,d,null,g)||(x.setFilter(s.bV(d)),this._updateLayer(x)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return s.bV(this.getLayer(o).filter)}setLayoutProperty(o,d,g,x={}){this._checkLoaded();const T=this.getLayer(o);T?s.bR(T.getLayoutProperty(d),g)||(T.setLayoutProperty(d,g,x),this._updateLayer(T)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,d){const g=this.getLayer(o);if(g)return g.getLayoutProperty(d);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,d,g,x={}){this._checkLoaded();const T=this.getLayer(o);T?s.bR(T.getPaintProperty(d),g)||this._updatePaintProperty(T,d,g,x):this.fire(new s.k(new Error(`Cannot style non-existing layer "${o}".`)))}_updatePaintProperty(o,d,g,x={}){o.setPaintProperty(d,g,x)&&this._updateLayer(o),s.bU(o)&&d==="raster-fade-duration"&&this.tileManagers[o.source].setRasterFadeDuration(g),this._changed=!0,this._updatedPaintProps[o.id]=!0,this._serializedLayers=null}getPaintProperty(o,d){return this.getLayer(o).getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const g=o.source,x=o.sourceLayer,T=this.tileManagers[g];if(T===void 0)return void this.fire(new s.k(new Error(`The source '${g}' does not exist in the map's style.`)));const D=T.getSource().type;D==="geojson"&&x?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):D!=="vector"||x?(o.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),T.setFeatureState(x,o.id,d)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,d){this._checkLoaded();const g=o.source,x=this.tileManagers[g];if(x===void 0)return void this.fire(new s.k(new Error(`The source '${g}' does not exist in the map's style.`)));const T=x.getSource().type,D=T==="vector"?o.sourceLayer:void 0;T!=="vector"||D?d&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):x.removeFeatureState(D,o.id,d):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const d=o.source,g=o.sourceLayer,x=this.tileManagers[d];if(x!==void 0)return x.getSource().type!=="vector"||g?(o.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),x.getFeatureState(g,o.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=s.bY(this.tileManagers,T=>T.serialize()),d=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,x=this.stylesheet;return s.bZ({version:x.version,name:x.name,metadata:x.metadata,light:x.light,sky:x.sky,center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch,sprite:x.sprite,glyphs:x.glyphs,transition:x.transition,projection:x.projection,sources:o,layers:d,terrain:g},T=>T!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.tileManagers[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.tileManagers[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const d=D=>this._layers[D].type==="fill-extrusion",g={},x=[];for(let D=this._order.length-1;D>=0;D--){const N=this._order[D];if(d(N)){g[N]=D;for(const V of o){const Z=V[N];if(Z)for(const Q of Z)x.push(Q)}}}x.sort((D,N)=>N.intersectionZ-D.intersectionZ);const T=[];for(let D=this._order.length-1;D>=0;D--){const N=this._order[D];if(d(N))for(let V=x.length-1;V>=0;V--){const Z=x[V].feature;if(g[Z.layer.id]<D)break;T.push(Z),x.pop()}else for(const V of o){const Z=V[N];if(Z)for(const Q of Z)T.push(Q.feature)}}return T}queryRenderedFeatures(o,d,g){d&&d.filter&&this._validate(s.C.filter,"queryRenderedFeatures.filter",d.filter,null,d);const x={};if(d&&d.layers){if(!(Array.isArray(d.layers)||d.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const Z of d.layers){const Q=this._layers[Z];if(!Q)return this.fire(new s.k(new Error(`The layer '${Z}' does not exist in the map's style and cannot be queried for features.`))),[];x[Q.source]=!0}}const T=[];d.availableImages=this._availableImages;const D=this._serializedAllLayers(),N=d.layers instanceof Set?d.layers:Array.isArray(d.layers)?new Set(d.layers):null,V=Object.assign(Object.assign({},d),{layers:N,globalState:this._globalState});for(const Z in this.tileManagers)d.layers&&!x[Z]||T.push(an(this.tileManagers[Z],this._layers,D,o,V,g,this.map.terrain?(Q,ce,le)=>this.map.terrain.getElevation(Q,ce,le):void 0));return this.placement&&T.push(function(Z,Q,ce,le,ge,be,ze){const $e={},Ne=be.queryRenderedSymbols(le),qe=[];for(const it of Object.keys(Ne).map(Number))qe.push(ze[it]);qe.sort(Ke);for(const it of qe){const Xe=it.featureIndex.lookupSymbolFeatures(Ne[it.bucketInstanceId],Q,it.bucketIndex,it.sourceLayerIndex,{filterSpec:ge.filter,globalState:ge.globalState},ge.layers,ge.availableImages,Z);for(const rt in Xe){const ht=$e[rt]=$e[rt]||[],Qe=Xe[rt];Qe.sort((yt,Ot)=>{const Pt=it.featureSortOrder;if(Pt){const It=Pt.indexOf(yt.featureIndex);return Pt.indexOf(Ot.featureIndex)-It}return Ot.featureIndex-yt.featureIndex});for(const yt of Qe)ht.push(yt)}}return function(it,Xe,rt){for(const ht in it)for(const Qe of it[ht])An(Qe,rt[Xe[ht].source]);return it}($e,Z,ce)}(this._layers,D,this.tileManagers,o,V,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(o,d){d?.filter&&this._validate(s.C.filter,"querySourceFeatures.filter",d.filter,null,d);const g=this.tileManagers[o];return g?function(x,T){const D=x.getRenderableIds().map(Z=>x.getTileByID(Z)),N=[],V={};for(let Z=0;Z<D.length;Z++){const Q=D[Z],ce=Q.tileID.canonical.key;V[ce]||(V[ce]=!0,Q.querySourceFeatures(N,T))}return N}(g,d?Object.assign(Object.assign({},d),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const g=this.light.getLight();let x=!1;for(const D in o)if(!s.bR(o[D],g[D])){x=!0;break}if(!x)return;const T={now:z(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(T)}getProjection(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.projection}setProjection(o){if(this._checkLoaded(),this.stylesheet.projection=o,this.projection){if(this.projection.name===o.type)return;this.projection.destroy(),delete this.projection}this._setProjectionInternal(o.type)}getSky(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.sky}setSky(o,d={}){this._checkLoaded();const g=this.getSky();let x=!1;if(!o&&!g)return;if(o&&!g)x=!0;else if(!o&&g)x=!0;else for(const D in o)if(!s.bR(o[D],g[D])){x=!0;break}if(!x)return;const T={now:z(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,d),this.sky.updateTransitions(T)}_setProjectionInternal(o){const d=function(g,x){const T={constrainOverride:x};if(Array.isArray(g)){const D=new dh({type:g});return{projection:D,transform:new ph(T),cameraHelper:new Gg(D)}}switch(g){case"mercator":return{projection:new wo,transform:new uu(T),cameraHelper:new wc};case"globe":{const D=new dh({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:D,transform:new ph(T),cameraHelper:new Gg(D)}}case"vertical-perspective":return{projection:new gd,transform:new Mc(T),cameraHelper:new no};default:return s.w(`Unknown projection name: ${g}. Falling back to mercator projection.`),{projection:new wo,transform:new uu(T),cameraHelper:new wc}}}(o,this.map.transformConstrain);this.projection=d.projection,this.map.migrateProjection(d.transform,d.cameraHelper);for(const g in this.tileManagers)this.tileManagers[g].reload()}_validate(o,d,g,x,T={}){return(!T||T.validate!==!1)&&pu(this,o.call(s.C,s.e({key:d,style:this.serialize(),value:g,styleSpec:s.u},x)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),oe().off(Fn,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.tileManagers){const g=this.tileManagers[d];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.tileManagers[o].clearTiles()}_reloadSource(o){this.tileManagers[o].resume(),this.tileManagers[o].reload()}_updateSources(o){for(const d in this.tileManagers)this.tileManagers[d].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.tileManagers)this._reloadSource(o)}_updatePlacement(o,d,g,x,T=!1){let D=!1,N=!1;const V={};for(const Z of this._order){const Q=this._layers[Z];if(Q.type!=="symbol")continue;if(!V[Q.source]){const le=this.tileManagers[Q.source];V[Q.source]=le.getRenderableIds(!0).map(ge=>le.getTileByID(ge)).sort((ge,be)=>be.tileID.overscaledZ-ge.tileID.overscaledZ||(ge.tileID.isLessThan(be.tileID)?-1:1))}const ce=this.crossTileSymbolIndex.addLayer(Q,V[Q.source],o.center.lng);D=D||ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(z(),o.zoom))&&(this.pauseablePlacement=new _c(o,this.map.terrain,this._order,T,d,g,x,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,V),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(z()),N=!0),D&&this.pauseablePlacement.placement.setStale()),N||D)for(const Z of this._order){const Q=this._layers[Z];Q.type==="symbol"&&this.placement.updateLayerOpacities(Q,V[Q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(z())}_releaseSymbolFadeTiles(){for(const o in this.tileManagers)this.tileManagers[o].releaseSymbolFadeTiles()}getImages(o,d){return s._(this,void 0,void 0,function*(){const g=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const x=this.tileManagers[d.source];return x&&x.setDependencies(d.tileID.key,d.type,d.icons),g})}getGlyphs(o,d){return s._(this,void 0,void 0,function*(){const g=yield this.glyphManager.getGlyphs(d.stacks),x=this.tileManagers[d.source];return x&&x.setDependencies(d.tileID.key,d.type,[""]),g})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,d={}){this._checkLoaded(),o&&this._validate(s.C.glyphs,"glyphs",o,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}getDashes(o,d){return s._(this,void 0,void 0,function*(){const g={};for(const[x,T]of Object.entries(d.dashes))g[x]=this.lineAtlas.getDash(T.dasharray,T.round);return g})}addSprite(o,d,g={},x){this._checkLoaded();const T=[{id:o,url:d}],D=[...ne(this.stylesheet.sprite),...T];this._validate(s.C.sprite,"sprite",D,null,g)||(this.stylesheet.sprite=D,this._loadSprite(T,!0,x))}removeSprite(o){this._checkLoaded();const d=ne(this.stylesheet.sprite);if(d.find(g=>g.id===o)){if(this._spritesImagesIds[o])for(const g of this._spritesImagesIds[o])this.imageManager.removeImage(g),this._changedImages[g]=!0;d.splice(d.findIndex(g=>g.id===o),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return ne(this.stylesheet.sprite)}setSprite(o,d={},g){this._checkLoaded(),o&&this._validate(s.C.sprite,"sprite",o,null,d)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,g):(this._unloadSprite(),g&&g(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const o in this.tileManagers){const d=this.tileManagers[o];d.setEventedParent(null),d.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const o in this._layers){const d=this._layers[o];d.setEventedParent(null),d.onRemove&&d.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var o0=s.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Cf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,g,x,T,D,N,V,Z){this.context=o;let Q=this.boundPaintVertexBuffers.length!==x.length;for(let ce=0;!Q&&ce<x.length;ce++)this.boundPaintVertexBuffers[ce]!==x[ce]&&(Q=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==g||Q||this.boundIndexBuffer!==T||this.boundVertexOffset!==D||this.boundDynamicVertexBuffer!==N||this.boundDynamicVertexBuffer2!==V||this.boundDynamicVertexBuffer3!==Z?this.freshBind(d,g,x,T,D,N,V,Z):(o.bindVertexArray.set(this.vao),N&&N.bind(),T&&T.dynamicDraw&&T.bind(),V&&V.bind(),Z&&Z.bind())}freshBind(o,d,g,x,T,D,N,V){const Z=o.numAttributes,Q=this.context,ce=Q.gl;this.vao&&this.destroy(),this.vao=Q.createVertexArray(),Q.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=N,this.boundDynamicVertexBuffer3=V,d.enableAttributes(ce,o);for(const le of g)le.enableAttributes(ce,o);D&&D.enableAttributes(ce,o),N&&N.enableAttributes(ce,o),V&&V.enableAttributes(ce,o),d.bind(),d.setVertexAttribPointers(ce,o,T);for(const le of g)le.bind(),le.setVertexAttribPointers(ce,o,T);D&&(D.bind(),D.setVertexAttribPointers(ce,o,T)),x&&x.bind(),N&&(N.bind(),N.setVertexAttribPointers(ce,o,T)),V&&(V.bind(),V.setVertexAttribPointers(ce,o,T)),Q.currentNumAttributes=Z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const s0=(E,o,d,g,x)=>({u_texture:0,u_ele_delta:E,u_fog_matrix:o,u_fog_color:d?d.properties.get("fog-color"):s.bp.white,u_fog_ground_blend:d?d.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:x?0:d?d.calculateFogBlendOpacity(g):0,u_horizon_color:d?d.properties.get("horizon-color"):s.bp.white,u_horizon_fog_blend:d?d.properties.get("horizon-fog-blend"):1,u_is_globe_mode:x?1:0}),mh={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Tf(E){const o=[];for(let d=0;d<E.length;d++){if(E[d]===null)continue;const g=E[d].split(" ");o.push(g.pop())}return o}class Pf{constructor(o,d,g,x,T,D,N,V,Z=[]){const Q=o.gl;this.program=Q.createProgram();const ce=Tf(d.staticAttributes),le=g?g.getBinderAttributes():[],ge=ce.concat(le),be=Zr.prelude.staticUniforms?Tf(Zr.prelude.staticUniforms):[],ze=N.staticUniforms?Tf(N.staticUniforms):[],$e=d.staticUniforms?Tf(d.staticUniforms):[],Ne=g?g.getBinderUniforms():[],qe=be.concat(ze).concat($e).concat(Ne),it=[];for(const Pt of qe)it.indexOf(Pt)<0&&it.push(Pt);const Xe=g?g.defines():[];zi(Q)&&Xe.unshift("#version 300 es"),T&&Xe.push("#define OVERDRAW_INSPECTOR;"),D&&Xe.push("#define TERRAIN3D;"),V&&Xe.push(V),Z&&Xe.push(...Z);let rt=Xe.concat(Zr.prelude.fragmentSource,N.fragmentSource,d.fragmentSource).join(`
`),ht=Xe.concat(Zr.prelude.vertexSource,N.vertexSource,d.vertexSource).join(`
`);zi(Q)||(rt=function(Pt){return Pt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(rt),ht=function(Pt){return Pt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ht));const Qe=Q.createShader(Q.FRAGMENT_SHADER);if(Q.isContextLost())return void(this.failedToCreate=!0);if(Q.shaderSource(Qe,rt),Q.compileShader(Qe),!Q.getShaderParameter(Qe,Q.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${Q.getShaderInfoLog(Qe)}`);Q.attachShader(this.program,Qe);const yt=Q.createShader(Q.VERTEX_SHADER);if(Q.isContextLost())return void(this.failedToCreate=!0);if(Q.shaderSource(yt,ht),Q.compileShader(yt),!Q.getShaderParameter(yt,Q.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${Q.getShaderInfoLog(yt)}`);Q.attachShader(this.program,yt),this.attributes={};const Ot={};this.numAttributes=ge.length;for(let Pt=0;Pt<this.numAttributes;Pt++)ge[Pt]&&(Q.bindAttribLocation(this.program,Pt,ge[Pt]),this.attributes[ge[Pt]]=Pt);if(Q.linkProgram(this.program),!Q.getProgramParameter(this.program,Q.LINK_STATUS))throw new Error(`Program failed to link: ${Q.getProgramInfoLog(this.program)}`);Q.deleteShader(yt),Q.deleteShader(Qe);for(let Pt=0;Pt<it.length;Pt++){const It=it[Pt];if(It&&!Ot[It]){const Dt=Q.getUniformLocation(this.program,It);Dt&&(Ot[It]=Dt)}}this.fixedUniforms=x(o,Ot),this.terrainUniforms=((Pt,It)=>({u_depth:new s.b_(Pt,It.u_depth),u_terrain:new s.b_(Pt,It.u_terrain),u_terrain_dim:new s.bq(Pt,It.u_terrain_dim),u_terrain_matrix:new s.c0(Pt,It.u_terrain_matrix),u_terrain_unpack:new s.c1(Pt,It.u_terrain_unpack),u_terrain_exaggeration:new s.bq(Pt,It.u_terrain_exaggeration)}))(o,Ot),this.projectionUniforms=((Pt,It)=>({u_projection_matrix:new s.c0(Pt,It.u_projection_matrix),u_projection_tile_mercator_coords:new s.c1(Pt,It.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.c1(Pt,It.u_projection_clipping_plane),u_projection_transition:new s.bq(Pt,It.u_projection_transition),u_projection_fallback_matrix:new s.c0(Pt,It.u_projection_fallback_matrix)}))(o,Ot),this.binderUniforms=g?g.getUniforms(o,Ot):[]}draw(o,d,g,x,T,D,N,V,Z,Q,ce,le,ge,be,ze,$e,Ne,qe,it){const Xe=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(g),o.setStencilMode(x),o.setColorMode(T),o.setCullFace(D),V){o.activeTexture.set(Xe.TEXTURE2),Xe.bindTexture(Xe.TEXTURE_2D,V.depthTexture),o.activeTexture.set(Xe.TEXTURE3),Xe.bindTexture(Xe.TEXTURE_2D,V.texture);for(const ht in this.terrainUniforms)this.terrainUniforms[ht].set(V[ht])}if(Z)for(const ht in Z)this.projectionUniforms[mh[ht]].set(Z[ht]);if(N)for(const ht in this.fixedUniforms)this.fixedUniforms[ht].set(N[ht]);$e&&$e.setUniforms(o,this.binderUniforms,be,{zoom:ze});let rt=0;switch(d){case Xe.LINES:rt=2;break;case Xe.TRIANGLES:rt=3;break;case Xe.LINE_STRIP:rt=1}for(const ht of ge.get()){const Qe=ht.vaos||(ht.vaos={});(Qe[Q]||(Qe[Q]=new Cf)).bind(o,this,ce,$e?$e.getPaintVertexBuffers():[],le,ht.vertexOffset,Ne,qe,it),Xe.drawElements(d,ht.primitiveLength*rt,Xe.UNSIGNED_SHORT,ht.primitiveOffset*rt*2)}}}function gh(E,o,d){const g=1/s.aN(d,1,o.transform.tileZoom),x=Math.pow(2,d.tileID.overscaledZ),T=d.tileSize*Math.pow(2,o.transform.tileZoom)/x,D=T*(d.tileID.canonical.x+d.tileID.wrap*x),N=T*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[g,E.fromScale,E.toScale],u_fade:E.t,u_pixel_coord_upper:[D>>16,N>>16],u_pixel_coord_lower:[65535&D,65535&N]}}const bm=(E,o,d,g)=>{const x=E.style.light,T=x.properties.get("position"),D=[T.x,T.y,T.z],N=s.c4();x.properties.get("anchor")==="viewport"&&s.c5(N,E.transform.bearingInRadians),s.c6(D,D,N);const V=E.transform.transformLightDirection(D),Z=x.properties.get("color");return{u_lightpos:D,u_lightpos_globe:V,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+o,u_opacity:d,u_fill_translate:g}},Af=(E,o,d,g,x,T,D)=>s.e(bm(E,o,d,g),gh(T,E,D),{u_height_factor:-Math.pow(2,x.overscaledZ)/D.tileSize/8}),If=(E,o,d,g)=>s.e(gh(o,E,d),{u_fill_translate:g}),wm=(E,o)=>({u_world:E,u_fill_translate:o}),Sm=(E,o,d,g,x)=>s.e(If(E,o,d,x),{u_world:g}),Mm=(E,o,d,g,x)=>{const T=E.transform;let D,N,V=0;if(d.paint.get("circle-pitch-alignment")==="map"){const Z=s.aN(o,1,T.zoom);D=!0,N=[Z,Z],V=Z/(s.a5*Math.pow(2,o.tileID.overscaledZ))*2*Math.PI*x}else D=!1,N=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+D,u_device_pixel_ratio:E.pixelRatio,u_extrude_scale:N,u_globe_extrude_scale:V,u_translate:g}},na=E=>({u_pixel_extrude_scale:[1/E.width,1/E.height]}),Wg=E=>({u_viewport_size:[E.width,E.height]}),Em=(E,o=1)=>({u_color:E,u_overlay:0,u_overlay_scale:o}),vh=(E,o,d,g)=>{const x=s.aN(E,1,o)/(s.a5*Math.pow(2,E.tileID.overscaledZ))*2*Math.PI*g;return{u_extrude_scale:s.aN(E,1,o),u_intensity:d,u_globe_extrude_scale:x}},Cm=(E,o,d,g)=>{const x=s.N();s.c7(x,0,E.width,E.height,0,0,1);const T=E.context.gl;return{u_matrix:x,u_world:[T.drawingBufferWidth,T.drawingBufferHeight],u_image:d,u_color_ramp:g,u_opacity:o.paint.get("heatmap-opacity")}},_d=(E,o,d)=>{const g=d.paint.get("hillshade-accent-color");let x;switch(d.paint.get("hillshade-method")){case"basic":x=4;break;case"combined":x=1;break;case"igor":x=2;break;case"multidirectional":x=3;break;default:x=0}const T=d.getIlluminationProperties();for(let D=0;D<T.directionRadians.length;D++)d.paint.get("hillshade-illumination-anchor")==="viewport"&&(T.directionRadians[D]+=E.transform.bearingInRadians);return{u_image:0,u_latrange:bd(0,o.tileID),u_exaggeration:d.paint.get("hillshade-exaggeration"),u_altitudes:T.altitudeRadians,u_azimuths:T.directionRadians,u_accent:g,u_method:x,u_highlights:T.highlightColor,u_shadows:T.shadowColor}},xd=(E,o)=>{const d=o.stride,g=s.N();return s.c7(g,0,s.a5,-s.a5,0,0,1),s.O(g,g,[0,-s.a5,0]),{u_matrix:g,u_image:1,u_dimension:[d,d],u_zoom:E.overscaledZ,u_unpack:o.getUnpackVector()}};function bd(E,o){const d=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new s.a9(0,g/d).toLngLat().lat,new s.a9(0,(g+1)/d).toLngLat().lat]}const qg=(E,o,d=0)=>({u_image:0,u_unpack:o.getUnpackVector(),u_dimension:[o.stride,o.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:d,u_opacity:E.paint.get("color-relief-opacity")}),Ec=(E,o,d,g)=>{const x=E.transform;return{u_translation:wd(E,o,d),u_ratio:g/s.aN(o,1,x.zoom),u_device_pixel_ratio:E.pixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Xg=(E,o,d,g,x)=>s.e(Ec(E,o,d,g),{u_image:0,u_image_height:x}),Rf=(E,o,d,g,x)=>{const T=E.transform,D=ra(o,T);return{u_translation:wd(E,o,d),u_texsize:o.imageAtlasTexture.size,u_ratio:g/s.aN(o,1,T.zoom),u_device_pixel_ratio:E.pixelRatio,u_image:0,u_scale:[D,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},Df=(E,o,d,g,x)=>{const T=ra(o,E.transform);return s.e(Ec(E,o,d,g),{u_tileratio:T,u_crossfade_from:x.fromScale,u_crossfade_to:x.toScale,u_image:0,u_mix:x.t,u_lineatlas_width:E.lineAtlas.width,u_lineatlas_height:E.lineAtlas.height})},yh=(E,o,d,g,x,T)=>{const D=ra(o,E.transform);return s.e(Ec(E,o,d,g),{u_image:0,u_image_height:T,u_tileratio:D,u_crossfade_from:x.fromScale,u_crossfade_to:x.toScale,u_image_dash:1,u_mix:x.t,u_lineatlas_width:E.lineAtlas.width,u_lineatlas_height:E.lineAtlas.height})};function ra(E,o){return 1/s.aN(E,1,o.tileZoom)}function wd(E,o,d){return s.aO(E.transform,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const Lf=(E,o,d,g,x)=>{return{u_tl_parent:E,u_scale_parent:o,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(D=g.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(T=g.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Tm(g.paint.get("raster-hue-rotate")),u_coords_top:[x[0].x,x[0].y,x[1].x,x[1].y],u_coords_bottom:[x[3].x,x[3].y,x[2].x,x[2].y]};var T,D};function Tm(E){E*=Math.PI/180;const o=Math.sin(E),d=Math.cos(E);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const Pm=(E,o,d,g,x,T,D,N,V,Z,Q,ce,le)=>{const ge=D.transform;return{u_is_size_zoom_constant:+(E==="constant"||E==="source"),u_is_size_feature_constant:+(E==="constant"||E==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ge.cameraToCenterDistance,u_pitch:ge.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:ge.width/ge.height,u_fade_change:D.options.fadeDuration?D.symbolFadeChange:1,u_label_plane_matrix:N,u_coord_matrix:V,u_is_text:+Q,u_pitch_with_map:+g,u_is_along_line:x,u_is_variable_anchor:T,u_texsize:ce,u_texture:0,u_translation:Z,u_pitched_scale:le}},kf=(E,o,d,g,x,T,D,N,V,Z,Q,ce,le,ge)=>{const be=D.transform;return s.e(Pm(E,o,d,g,x,T,D,N,V,Z,Q,ce,ge),{u_gamma_scale:g?Math.cos(be.pitch*Math.PI/180)*be.cameraToCenterDistance:1,u_device_pixel_ratio:D.pixelRatio,u_is_halo:1})},gu=(E,o,d,g,x,T,D,N,V,Z,Q,ce,le)=>s.e(kf(E,o,d,g,x,T,D,N,V,Z,!0,Q,0,le),{u_texsize_icon:ce,u_texture_icon:1}),Am=(E,o)=>({u_opacity:E,u_color:o}),Aa=(E,o,d,g,x)=>s.e(function(T,D,N,V){const Z=N.imageManager.getPattern(T.from.toString()),Q=N.imageManager.getPattern(T.to.toString()),{width:ce,height:le}=N.imageManager.getPixelSize(),ge=Math.pow(2,V.tileID.overscaledZ),be=V.tileSize*Math.pow(2,N.transform.tileZoom)/ge,ze=be*(V.tileID.canonical.x+V.tileID.wrap*ge),$e=be*V.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:Q.tl,u_pattern_br_b:Q.br,u_texsize:[ce,le],u_mix:D.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:Q.displaySize,u_scale_a:D.fromScale,u_scale_b:D.toScale,u_tile_units_to_pixels:1/s.aN(V,1,N.transform.tileZoom),u_pixel_coord_upper:[ze>>16,$e>>16],u_pixel_coord_lower:[65535&ze,65535&$e]}}(d,x,o,g),{u_opacity:E}),_h=(E,o)=>{},Zg={fillExtrusion:(E,o)=>({u_lightpos:new s.c2(E,o.u_lightpos),u_lightpos_globe:new s.c2(E,o.u_lightpos_globe),u_lightintensity:new s.bq(E,o.u_lightintensity),u_lightcolor:new s.c2(E,o.u_lightcolor),u_vertical_gradient:new s.bq(E,o.u_vertical_gradient),u_opacity:new s.bq(E,o.u_opacity),u_fill_translate:new s.c3(E,o.u_fill_translate)}),fillExtrusionPattern:(E,o)=>({u_lightpos:new s.c2(E,o.u_lightpos),u_lightpos_globe:new s.c2(E,o.u_lightpos_globe),u_lightintensity:new s.bq(E,o.u_lightintensity),u_lightcolor:new s.c2(E,o.u_lightcolor),u_vertical_gradient:new s.bq(E,o.u_vertical_gradient),u_height_factor:new s.bq(E,o.u_height_factor),u_opacity:new s.bq(E,o.u_opacity),u_fill_translate:new s.c3(E,o.u_fill_translate),u_image:new s.b_(E,o.u_image),u_texsize:new s.c3(E,o.u_texsize),u_pixel_coord_upper:new s.c3(E,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(E,o.u_pixel_coord_lower),u_scale:new s.c2(E,o.u_scale),u_fade:new s.bq(E,o.u_fade)}),fill:(E,o)=>({u_fill_translate:new s.c3(E,o.u_fill_translate)}),fillPattern:(E,o)=>({u_image:new s.b_(E,o.u_image),u_texsize:new s.c3(E,o.u_texsize),u_pixel_coord_upper:new s.c3(E,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(E,o.u_pixel_coord_lower),u_scale:new s.c2(E,o.u_scale),u_fade:new s.bq(E,o.u_fade),u_fill_translate:new s.c3(E,o.u_fill_translate)}),fillOutline:(E,o)=>({u_world:new s.c3(E,o.u_world),u_fill_translate:new s.c3(E,o.u_fill_translate)}),fillOutlinePattern:(E,o)=>({u_world:new s.c3(E,o.u_world),u_image:new s.b_(E,o.u_image),u_texsize:new s.c3(E,o.u_texsize),u_pixel_coord_upper:new s.c3(E,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(E,o.u_pixel_coord_lower),u_scale:new s.c2(E,o.u_scale),u_fade:new s.bq(E,o.u_fade),u_fill_translate:new s.c3(E,o.u_fill_translate)}),circle:(E,o)=>({u_camera_to_center_distance:new s.bq(E,o.u_camera_to_center_distance),u_scale_with_map:new s.b_(E,o.u_scale_with_map),u_pitch_with_map:new s.b_(E,o.u_pitch_with_map),u_extrude_scale:new s.c3(E,o.u_extrude_scale),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_globe_extrude_scale:new s.bq(E,o.u_globe_extrude_scale),u_translate:new s.c3(E,o.u_translate)}),collisionBox:(E,o)=>({u_pixel_extrude_scale:new s.c3(E,o.u_pixel_extrude_scale)}),collisionCircle:(E,o)=>({u_viewport_size:new s.c3(E,o.u_viewport_size)}),debug:(E,o)=>({u_color:new s.b$(E,o.u_color),u_overlay:new s.b_(E,o.u_overlay),u_overlay_scale:new s.bq(E,o.u_overlay_scale)}),depth:_h,clippingMask:_h,heatmap:(E,o)=>({u_extrude_scale:new s.bq(E,o.u_extrude_scale),u_intensity:new s.bq(E,o.u_intensity),u_globe_extrude_scale:new s.bq(E,o.u_globe_extrude_scale)}),heatmapTexture:(E,o)=>({u_matrix:new s.c0(E,o.u_matrix),u_world:new s.c3(E,o.u_world),u_image:new s.b_(E,o.u_image),u_color_ramp:new s.b_(E,o.u_color_ramp),u_opacity:new s.bq(E,o.u_opacity)}),hillshade:(E,o)=>({u_image:new s.b_(E,o.u_image),u_latrange:new s.c3(E,o.u_latrange),u_exaggeration:new s.bq(E,o.u_exaggeration),u_altitudes:new s.c9(E,o.u_altitudes),u_azimuths:new s.c9(E,o.u_azimuths),u_accent:new s.b$(E,o.u_accent),u_method:new s.b_(E,o.u_method),u_shadows:new s.c8(E,o.u_shadows),u_highlights:new s.c8(E,o.u_highlights)}),hillshadePrepare:(E,o)=>({u_matrix:new s.c0(E,o.u_matrix),u_image:new s.b_(E,o.u_image),u_dimension:new s.c3(E,o.u_dimension),u_zoom:new s.bq(E,o.u_zoom),u_unpack:new s.c1(E,o.u_unpack)}),colorRelief:(E,o)=>({u_image:new s.b_(E,o.u_image),u_unpack:new s.c1(E,o.u_unpack),u_dimension:new s.c3(E,o.u_dimension),u_elevation_stops:new s.b_(E,o.u_elevation_stops),u_color_stops:new s.b_(E,o.u_color_stops),u_color_ramp_size:new s.b_(E,o.u_color_ramp_size),u_opacity:new s.bq(E,o.u_opacity)}),line:(E,o)=>({u_translation:new s.c3(E,o.u_translation),u_ratio:new s.bq(E,o.u_ratio),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_units_to_pixels:new s.c3(E,o.u_units_to_pixels)}),lineGradient:(E,o)=>({u_translation:new s.c3(E,o.u_translation),u_ratio:new s.bq(E,o.u_ratio),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_units_to_pixels:new s.c3(E,o.u_units_to_pixels),u_image:new s.b_(E,o.u_image),u_image_height:new s.bq(E,o.u_image_height)}),linePattern:(E,o)=>({u_translation:new s.c3(E,o.u_translation),u_texsize:new s.c3(E,o.u_texsize),u_ratio:new s.bq(E,o.u_ratio),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_image:new s.b_(E,o.u_image),u_units_to_pixels:new s.c3(E,o.u_units_to_pixels),u_scale:new s.c2(E,o.u_scale),u_fade:new s.bq(E,o.u_fade)}),lineSDF:(E,o)=>({u_translation:new s.c3(E,o.u_translation),u_ratio:new s.bq(E,o.u_ratio),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_units_to_pixels:new s.c3(E,o.u_units_to_pixels),u_image:new s.b_(E,o.u_image),u_mix:new s.bq(E,o.u_mix),u_tileratio:new s.bq(E,o.u_tileratio),u_crossfade_from:new s.bq(E,o.u_crossfade_from),u_crossfade_to:new s.bq(E,o.u_crossfade_to),u_lineatlas_width:new s.bq(E,o.u_lineatlas_width),u_lineatlas_height:new s.bq(E,o.u_lineatlas_height)}),lineGradientSDF:(E,o)=>({u_translation:new s.c3(E,o.u_translation),u_ratio:new s.bq(E,o.u_ratio),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_units_to_pixels:new s.c3(E,o.u_units_to_pixels),u_image:new s.b_(E,o.u_image),u_image_height:new s.bq(E,o.u_image_height),u_tileratio:new s.bq(E,o.u_tileratio),u_crossfade_from:new s.bq(E,o.u_crossfade_from),u_crossfade_to:new s.bq(E,o.u_crossfade_to),u_image_dash:new s.b_(E,o.u_image_dash),u_mix:new s.bq(E,o.u_mix),u_lineatlas_width:new s.bq(E,o.u_lineatlas_width),u_lineatlas_height:new s.bq(E,o.u_lineatlas_height)}),raster:(E,o)=>({u_tl_parent:new s.c3(E,o.u_tl_parent),u_scale_parent:new s.bq(E,o.u_scale_parent),u_buffer_scale:new s.bq(E,o.u_buffer_scale),u_fade_t:new s.bq(E,o.u_fade_t),u_opacity:new s.bq(E,o.u_opacity),u_image0:new s.b_(E,o.u_image0),u_image1:new s.b_(E,o.u_image1),u_brightness_low:new s.bq(E,o.u_brightness_low),u_brightness_high:new s.bq(E,o.u_brightness_high),u_saturation_factor:new s.bq(E,o.u_saturation_factor),u_contrast_factor:new s.bq(E,o.u_contrast_factor),u_spin_weights:new s.c2(E,o.u_spin_weights),u_coords_top:new s.c1(E,o.u_coords_top),u_coords_bottom:new s.c1(E,o.u_coords_bottom)}),symbolIcon:(E,o)=>({u_is_size_zoom_constant:new s.b_(E,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(E,o.u_is_size_feature_constant),u_size_t:new s.bq(E,o.u_size_t),u_size:new s.bq(E,o.u_size),u_camera_to_center_distance:new s.bq(E,o.u_camera_to_center_distance),u_pitch:new s.bq(E,o.u_pitch),u_rotate_symbol:new s.b_(E,o.u_rotate_symbol),u_aspect_ratio:new s.bq(E,o.u_aspect_ratio),u_fade_change:new s.bq(E,o.u_fade_change),u_label_plane_matrix:new s.c0(E,o.u_label_plane_matrix),u_coord_matrix:new s.c0(E,o.u_coord_matrix),u_is_text:new s.b_(E,o.u_is_text),u_pitch_with_map:new s.b_(E,o.u_pitch_with_map),u_is_along_line:new s.b_(E,o.u_is_along_line),u_is_variable_anchor:new s.b_(E,o.u_is_variable_anchor),u_texsize:new s.c3(E,o.u_texsize),u_texture:new s.b_(E,o.u_texture),u_translation:new s.c3(E,o.u_translation),u_pitched_scale:new s.bq(E,o.u_pitched_scale)}),symbolSDF:(E,o)=>({u_is_size_zoom_constant:new s.b_(E,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(E,o.u_is_size_feature_constant),u_size_t:new s.bq(E,o.u_size_t),u_size:new s.bq(E,o.u_size),u_camera_to_center_distance:new s.bq(E,o.u_camera_to_center_distance),u_pitch:new s.bq(E,o.u_pitch),u_rotate_symbol:new s.b_(E,o.u_rotate_symbol),u_aspect_ratio:new s.bq(E,o.u_aspect_ratio),u_fade_change:new s.bq(E,o.u_fade_change),u_label_plane_matrix:new s.c0(E,o.u_label_plane_matrix),u_coord_matrix:new s.c0(E,o.u_coord_matrix),u_is_text:new s.b_(E,o.u_is_text),u_pitch_with_map:new s.b_(E,o.u_pitch_with_map),u_is_along_line:new s.b_(E,o.u_is_along_line),u_is_variable_anchor:new s.b_(E,o.u_is_variable_anchor),u_texsize:new s.c3(E,o.u_texsize),u_texture:new s.b_(E,o.u_texture),u_gamma_scale:new s.bq(E,o.u_gamma_scale),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_is_halo:new s.b_(E,o.u_is_halo),u_translation:new s.c3(E,o.u_translation),u_pitched_scale:new s.bq(E,o.u_pitched_scale)}),symbolTextAndIcon:(E,o)=>({u_is_size_zoom_constant:new s.b_(E,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(E,o.u_is_size_feature_constant),u_size_t:new s.bq(E,o.u_size_t),u_size:new s.bq(E,o.u_size),u_camera_to_center_distance:new s.bq(E,o.u_camera_to_center_distance),u_pitch:new s.bq(E,o.u_pitch),u_rotate_symbol:new s.b_(E,o.u_rotate_symbol),u_aspect_ratio:new s.bq(E,o.u_aspect_ratio),u_fade_change:new s.bq(E,o.u_fade_change),u_label_plane_matrix:new s.c0(E,o.u_label_plane_matrix),u_coord_matrix:new s.c0(E,o.u_coord_matrix),u_is_text:new s.b_(E,o.u_is_text),u_pitch_with_map:new s.b_(E,o.u_pitch_with_map),u_is_along_line:new s.b_(E,o.u_is_along_line),u_is_variable_anchor:new s.b_(E,o.u_is_variable_anchor),u_texsize:new s.c3(E,o.u_texsize),u_texsize_icon:new s.c3(E,o.u_texsize_icon),u_texture:new s.b_(E,o.u_texture),u_texture_icon:new s.b_(E,o.u_texture_icon),u_gamma_scale:new s.bq(E,o.u_gamma_scale),u_device_pixel_ratio:new s.bq(E,o.u_device_pixel_ratio),u_is_halo:new s.b_(E,o.u_is_halo),u_translation:new s.c3(E,o.u_translation),u_pitched_scale:new s.bq(E,o.u_pitched_scale)}),background:(E,o)=>({u_opacity:new s.bq(E,o.u_opacity),u_color:new s.b$(E,o.u_color)}),backgroundPattern:(E,o)=>({u_opacity:new s.bq(E,o.u_opacity),u_image:new s.b_(E,o.u_image),u_pattern_tl_a:new s.c3(E,o.u_pattern_tl_a),u_pattern_br_a:new s.c3(E,o.u_pattern_br_a),u_pattern_tl_b:new s.c3(E,o.u_pattern_tl_b),u_pattern_br_b:new s.c3(E,o.u_pattern_br_b),u_texsize:new s.c3(E,o.u_texsize),u_mix:new s.bq(E,o.u_mix),u_pattern_size_a:new s.c3(E,o.u_pattern_size_a),u_pattern_size_b:new s.c3(E,o.u_pattern_size_b),u_scale_a:new s.bq(E,o.u_scale_a),u_scale_b:new s.bq(E,o.u_scale_b),u_pixel_coord_upper:new s.c3(E,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(E,o.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bq(E,o.u_tile_units_to_pixels)}),terrain:(E,o)=>({u_texture:new s.b_(E,o.u_texture),u_ele_delta:new s.bq(E,o.u_ele_delta),u_fog_matrix:new s.c0(E,o.u_fog_matrix),u_fog_color:new s.b$(E,o.u_fog_color),u_fog_ground_blend:new s.bq(E,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bq(E,o.u_fog_ground_blend_opacity),u_horizon_color:new s.b$(E,o.u_horizon_color),u_horizon_fog_blend:new s.bq(E,o.u_horizon_fog_blend),u_is_globe_mode:new s.bq(E,o.u_is_globe_mode)}),terrainDepth:(E,o)=>({u_ele_delta:new s.bq(E,o.u_ele_delta)}),terrainCoords:(E,o)=>({u_texture:new s.b_(E,o.u_texture),u_terrain_coords_id:new s.bq(E,o.u_terrain_coords_id),u_ele_delta:new s.bq(E,o.u_ele_delta)}),projectionErrorMeasurement:(E,o)=>({u_input:new s.bq(E,o.u_input),u_output_expected:new s.bq(E,o.u_output_expected)}),atmosphere:(E,o)=>({u_sun_pos:new s.c2(E,o.u_sun_pos),u_atmosphere_blend:new s.bq(E,o.u_atmosphere_blend),u_globe_position:new s.c2(E,o.u_globe_position),u_globe_radius:new s.bq(E,o.u_globe_radius),u_inv_proj_matrix:new s.c0(E,o.u_inv_proj_matrix)}),sky:(E,o)=>({u_sky_color:new s.b$(E,o.u_sky_color),u_horizon_color:new s.b$(E,o.u_horizon_color),u_horizon:new s.c3(E,o.u_horizon),u_horizon_normal:new s.c3(E,o.u_horizon_normal),u_sky_horizon_blend:new s.bq(E,o.u_sky_horizon_blend),u_sky_blend:new s.bq(E,o.u_sky_blend)})};class Yg{constructor(o,d,g){this.context=o;const x=o.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Im={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Kg{constructor(o,d,g,x){this.length=d.length,this.attributes=g,this.itemSize=d.bytesPerElement,this.dynamicDraw=x,this.context=o;const T=o.gl;this.buffer=T.createBuffer(),o.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let g=0;g<this.attributes.length;g++){const x=d.attributes[this.attributes[g].name];x!==void 0&&o.enableVertexAttribArray(x)}}setVertexAttribPointers(o,d,g){for(let x=0;x<this.attributes.length;x++){const T=this.attributes[x],D=d.attributes[T.name];D!==void 0&&o.vertexAttribPointer(D,T.components,o[Im[T.type]],!1,this.itemSize,T.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ur{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class zf extends Ur{getDefault(){return s.bp.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Of extends Ur{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Ol extends Ur{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Sd extends Ur{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ia extends Ur{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class vu extends Ur{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class yu extends Ur{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class as extends Ur{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class _u extends Ur{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class Ff extends Ur{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Nf extends Ur{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ja extends Ur{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Md extends Ur{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class Ed extends Ur{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class xh extends Ur{getDefault(){return s.bp.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Cd extends Ur{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Rm extends Ur{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class xu extends Ur{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class $s extends Ur{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Bf extends Ur{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Td extends Ur{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Tr extends Ur{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Uf extends Ur{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Pd extends Ur{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Jg extends Ur{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class bh extends Ur{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Qg extends Ur{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Ii extends Ur{getDefault(){return null}set(o){var d;if(o===this.current&&!this.dirty)return;const g=this.gl;zi(g)?g.bindVertexArray(o):(d=g.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class $f extends Ur{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Vf extends Ur{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class bu extends Ur{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class wu extends Ur{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Su extends wu{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Cc extends wu{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class wh extends wu{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}const Tc="Framebuffer is not complete";class Ad{constructor(o,d,g,x,T){this.context=o,this.width=d,this.height=g;const D=o.gl,N=this.framebuffer=D.createFramebuffer();if(this.colorAttachment=new Su(o,N),x)this.depthAttachment=T?new wh(o,N):new Cc(o,N);else if(T)throw new Error("Stencil cannot be set without depth");if(D.checkFramebufferStatus(D.FRAMEBUFFER)!==D.FRAMEBUFFER_COMPLETE)throw new Error(Tc)}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const g=this.depthAttachment.get();g&&o.deleteRenderbuffer(g)}o.deleteFramebuffer(this.framebuffer)}}class jf{constructor(o){var d,g;if(this.gl=o,this.clearColor=new zf(this),this.clearDepth=new Of(this),this.clearStencil=new Ol(this),this.colorMask=new Sd(this),this.depthMask=new Ia(this),this.stencilMask=new vu(this),this.stencilFunc=new yu(this),this.stencilOp=new as(this),this.stencilTest=new _u(this),this.depthRange=new Ff(this),this.depthTest=new Nf(this),this.depthFunc=new Ja(this),this.blend=new Md(this),this.blendFunc=new Ed(this),this.blendColor=new xh(this),this.blendEquation=new Cd(this),this.cullFace=new Rm(this),this.cullFaceSide=new xu(this),this.frontFace=new $s(this),this.program=new Bf(this),this.activeTexture=new Td(this),this.viewport=new Tr(this),this.bindFramebuffer=new Uf(this),this.bindRenderbuffer=new Pd(this),this.bindTexture=new Jg(this),this.bindVertexBuffer=new bh(this),this.bindElementBuffer=new Qg(this),this.bindVertexArray=new Ii(this),this.pixelStoreUnpack=new $f(this),this.pixelStoreUnpackPremultiplyAlpha=new Vf(this),this.pixelStoreUnpackFlipY=new bu(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),zi(o)){this.HALF_FLOAT=o.HALF_FLOAT;const x=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=o.RGBA16F)!==null&&d!==void 0?d:x?.RGBA16F_EXT,this.RGB16F=(g=o.RGB16F)!==null&&g!==void 0?g:x?.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const x=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=x?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new Yg(this,o,d)}createVertexBuffer(o,d,g){return new Kg(this,o,d,g)}createRenderbuffer(o,d,g){const x=this.gl,T=x.createRenderbuffer();return this.bindRenderbuffer.set(T),x.renderbufferStorage(x.RENDERBUFFER,o,d,g),this.bindRenderbuffer.set(null),T}createFramebuffer(o,d,g,x){return new Ad(this,o,d,g,x)}clear({color:o,depth:d,stencil:g}){const x=this.gl;let T=0;o&&(T|=x.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(T|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),g!==void 0&&(T|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),x.clear(T)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){s.bR(o.blendFunction,Br.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return zi(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var d;return zi(this.gl)?this.gl.deleteVertexArray(o):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}let Pc;function Ac(E,o,d,g,x){const T=E.context,D=E.transform,N=T.gl,V=E.useProgram("collisionBox"),Z=[];let Q=0,ce=0;for(let Ne=0;Ne<g.length;Ne++){const qe=g[Ne],it=o.getTile(qe).getBucket(d);if(!it)continue;const Xe=x?it.textCollisionBox:it.iconCollisionBox,rt=it.collisionCircleArray;rt.length>0&&(Z.push({circleArray:rt,circleOffset:ce,coord:qe}),Q+=rt.length/4,ce=Q),Xe&&V.draw(T,N.LINES,xr.disabled,Rr.disabled,E.colorModeForRenderPass(),Pr.disabled,na(E.transform),E.style.map.terrain&&E.style.map.terrain.getTerrainData(qe),D.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),d.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,null,E.transform.zoom,null,null,Xe.collisionVertexBuffer)}if(!x||!Z.length)return;const le=E.useProgram("collisionCircle"),ge=new s.ca;ge.resize(4*Q),ge._trim();let be=0;for(const Ne of Z)for(let qe=0;qe<Ne.circleArray.length/4;qe++){const it=4*qe,Xe=Ne.circleArray[it+0],rt=Ne.circleArray[it+1],ht=Ne.circleArray[it+2],Qe=Ne.circleArray[it+3];ge.emplace(be++,Xe,rt,ht,Qe,0),ge.emplace(be++,Xe,rt,ht,Qe,1),ge.emplace(be++,Xe,rt,ht,Qe,2),ge.emplace(be++,Xe,rt,ht,Qe,3)}(!Pc||Pc.length<2*Q)&&(Pc=function(Ne){const qe=2*Ne,it=new s.cc;it.resize(qe),it._trim();for(let Xe=0;Xe<qe;Xe++){const rt=6*Xe;it.uint16[rt+0]=4*Xe+0,it.uint16[rt+1]=4*Xe+1,it.uint16[rt+2]=4*Xe+2,it.uint16[rt+3]=4*Xe+2,it.uint16[rt+4]=4*Xe+3,it.uint16[rt+5]=4*Xe+0}return it}(Q));const ze=T.createIndexBuffer(Pc,!0),$e=T.createVertexBuffer(ge,s.cb.members,!0);for(const Ne of Z){const qe=Wg(E.transform);le.draw(T,N.TRIANGLES,xr.disabled,Rr.disabled,E.colorModeForRenderPass(),Pr.disabled,qe,E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ne.coord),null,d.id,$e,ze,s.aX.simpleSegment(0,2*Ne.circleOffset,Ne.circleArray.length,Ne.circleArray.length/2),null,E.transform.zoom,null,null,null)}$e.destroy(),ze.destroy()}const Sh=s.ar(new Float32Array(16));function Hf(E,o,d,g,x,T){const{horizontalAlign:D,verticalAlign:N}=s.aS(E);return new s.P((-(D-.5)*o/x+g[0])*T,(-(N-.5)*d/x+g[1])*T)}function Mu(E,o,d,g,x,T){const D=o.tileAnchorPoint.add(new s.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let N=g.mult(T);d||(N=N.rotate(-x));const V=D.add(N);return In(V.x,V.y,o.pitchedLabelPlaneMatrix,o.getElevation).point}if(d){const N=pn(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(E),V=Math.atan(N.y/N.x)+(N.x<0?Math.PI:0);return E.add(g.rotate(V))}return E.add(g)}function Dm(E,o,d,g,x,T,D,N,V,Z,Q,ce){const le=E.text.placedSymbolArray,ge=E.text.dynamicLayoutVertexArray,be=E.icon.dynamicLayoutVertexArray,ze={};ge.clear();for(let $e=0;$e<le.length;$e++){const Ne=le.get($e),qe=Ne.hidden||!Ne.crossTileID||E.allowVerticalPlacement&&!Ne.placedOrientation?null:g[Ne.crossTileID];if(qe){const it=new s.P(Ne.anchorX,Ne.anchorY),Xe={getElevation:ce,width:x.width,height:x.height,pitchedLabelPlaneMatrix:T,pitchWithMap:d,transform:x,tileAnchorPoint:it,translation:Z,unwrappedTileID:Q},rt=d?mn(it.x,it.y,Xe):pn(it.x,it.y,Xe),ht=fr(x.cameraToCenterDistance,rt.signedDistanceFromCamera);let Qe=s.aA(E.textSizeData,N,Ne)*ht/s.aM;d&&(Qe*=E.tilePixelRatio/D);const{width:yt,height:Ot,anchor:Pt,textOffset:It,textBoxScale:Dt}=qe,gn=Hf(Pt,yt,Ot,It,Dt,Qe),xn=x.getPitchedTextCorrection(it.x+Z[0],it.y+Z[1],Q),tn=Mu(rt.point,Xe,o,gn,-x.bearingInRadians,xn),Dn=E.allowVerticalPlacement&&Ne.placedOrientation===s.az.vertical?Math.PI/2:0;for(let gr=0;gr<Ne.numGlyphs;gr++)s.aG(ge,tn,Dn);V&&Ne.associatedIconIndex>=0&&(ze[Ne.associatedIconIndex]={shiftedAnchor:tn,angle:Dn})}else Ir(Ne.numGlyphs,ge)}if(V){be.clear();const $e=E.icon.placedSymbolArray;for(let Ne=0;Ne<$e.length;Ne++){const qe=$e.get(Ne);if(qe.hidden)Ir(qe.numGlyphs,be);else{const it=ze[Ne];if(it)for(let Xe=0;Xe<qe.numGlyphs;Xe++)s.aG(be,it.shiftedAnchor,it.angle);else Ir(qe.numGlyphs,be)}}E.icon.dynamicLayoutVertexBuffer.updateData(be)}E.text.dynamicLayoutVertexBuffer.updateData(ge)}function Gf(E,o,d){return d.iconsInText&&o?"symbolTextAndIcon":E?"symbolSDF":"symbolIcon"}function Eu(E,o,d,g,x,T,D,N,V,Z,Q,ce,le){const ge=E.context,be=ge.gl,ze=E.transform,$e=N==="map",Ne=V==="map",qe=N!=="viewport"&&d.layout.get("symbol-placement")!=="point",it=$e&&!Ne&&!qe,Xe=!d.layout.get("symbol-sort-key").isConstant();let rt=!1;const ht=E.getDepthModeForSublayer(0,xr.ReadOnly),Qe=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),yt=[],Ot=ze.getCircleRadiusCorrection();for(const Pt of g){const It=o.getTile(Pt),Dt=It.getBucket(d);if(!Dt)continue;const gn=x?Dt.text:Dt.icon;if(!gn||!gn.segments.get().length||!gn.hasVisibleVertices)continue;const xn=gn.programConfigurations.get(d.id),tn=x||Dt.sdfIcons,Dn=x?Dt.textSizeData:Dt.iconSizeData,gr=Ne||ze.pitch!==0,Yr=E.useProgram(Gf(tn,x,Dt),xn),xi=s.ay(Dn,ze.zoom),ni=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Pt);let bi,ri,wi,Di,Co=[0,0],Xi=null;if(x)ri=It.glyphAtlasTexture,wi=be.LINEAR,bi=It.glyphAtlasTexture.size,Dt.iconsInText&&(Co=It.imageAtlasTexture.size,Xi=It.imageAtlasTexture,Di=gr||E.options.rotating||E.options.zooming||Dn.kind==="composite"||Dn.kind==="camera"?be.LINEAR:be.NEAREST);else{const si=d.layout.get("icon-size").constantOr(0)!==1||Dt.iconsNeedLinear;ri=It.imageAtlasTexture,wi=tn||E.options.rotating||E.options.zooming||si||gr?be.LINEAR:be.NEAREST,bi=It.imageAtlasTexture.size}const qr=s.aN(It,1,E.transform.zoom),fo=Vt($e,E.transform,qr),Oa=s.N();s.aB(Oa,fo);const sl=En(Ne,$e,E.transform,qr),Fa=s.aO(ze,It,T,D),cs=ze.getProjectionData({overscaledTileID:Pt,applyGlobeMatrix:!le,applyTerrainMatrix:!0}),jl=Qe&&Dt.hasTextData(),al=d.layout.get("icon-text-fit")!=="none"&&jl&&Dt.hasIconData();if(qe){const si=E.style.map.terrain?(oo,po)=>E.style.map.terrain.getElevation(Pt,oo,po):null,ii=d.layout.get("text-rotation-alignment")==="map";mt(Dt,E,x,fo,Oa,Ne,Z,ii,Pt.toUnwrapped(),ze.width,ze.height,Fa,si)}const Hl=x&&Qe||al,Es=qe||Hl?Sh:Ne?fo:E.transform.clipSpaceToPixelsMatrix,ll=tn&&d.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ha;ha=tn?Dt.iconsInText?gu(Dn.kind,xi,it,Ne,qe,Hl,E,Es,sl,Fa,bi,Co,Ot):kf(Dn.kind,xi,it,Ne,qe,Hl,E,Es,sl,Fa,x,bi,0,Ot):Pm(Dn.kind,xi,it,Ne,qe,Hl,E,Es,sl,Fa,x,bi,Ot);const da={program:Yr,buffers:gn,uniformValues:ha,projectionData:cs,atlasTexture:ri,atlasTextureIcon:Xi,atlasInterpolation:wi,atlasInterpolationIcon:Di,isSDF:tn,hasHalo:ll};if(Xe&&Dt.canOverlap){rt=!0;const si=gn.segments.get();for(const ii of si)yt.push({segments:new s.aX([ii]),sortKey:ii.sortKey,state:da,terrainData:ni})}else yt.push({segments:gn.segments,sortKey:0,state:da,terrainData:ni})}rt&&yt.sort((Pt,It)=>Pt.sortKey-It.sortKey);for(const Pt of yt){const It=Pt.state;if(ge.activeTexture.set(be.TEXTURE0),It.atlasTexture.bind(It.atlasInterpolation,be.CLAMP_TO_EDGE),It.atlasTextureIcon&&(ge.activeTexture.set(be.TEXTURE1),It.atlasTextureIcon&&It.atlasTextureIcon.bind(It.atlasInterpolationIcon,be.CLAMP_TO_EDGE)),It.isSDF){const Dt=It.uniformValues;It.hasHalo&&(Dt.u_is_halo=1,Wf(It.buffers,Pt.segments,d,E,It.program,ht,Q,ce,Dt,It.projectionData,Pt.terrainData)),Dt.u_is_halo=0}Wf(It.buffers,Pt.segments,d,E,It.program,ht,Q,ce,It.uniformValues,It.projectionData,Pt.terrainData)}}function Wf(E,o,d,g,x,T,D,N,V,Z,Q){const ce=g.context;x.draw(ce,ce.gl.TRIANGLES,T,D,N,Pr.backCCW,V,Q,Z,d.id,E.layoutVertexBuffer,E.indexBuffer,o,d.paint,g.transform.zoom,E.programConfigurations.get(d.id),E.dynamicLayoutVertexBuffer,E.opacityVertexBuffer)}function Lm(E,o,d,g,x){const T=E.context,D=T.gl,N=Rr.disabled,V=new Br([D.ONE,D.ONE],s.bp.transparent,[!0,!0,!0,!0]),Z=o.getBucket(d);if(!Z)return;const Q=g.key;let ce=d.heatmapFbos.get(Q);ce||(ce=Id(T,o.tileSize,o.tileSize),d.heatmapFbos.set(Q,ce)),T.bindFramebuffer.set(ce.framebuffer),T.viewport.set([0,0,o.tileSize,o.tileSize]),T.clear({color:s.bp.transparent});const le=Z.programConfigurations.get(d.id),ge=E.useProgram("heatmap",le,!x),be=E.transform.getProjectionData({overscaledTileID:o.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ze=E.style.map.terrain.getTerrainData(g);ge.draw(T,D.TRIANGLES,xr.disabled,N,V,Pr.disabled,vh(o,E.transform.zoom,d.paint.get("heatmap-intensity"),1),ze,be,d.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,d.paint,E.transform.zoom,le)}function ev(E,o,d,g,x){const T=E.context,D=T.gl,N=E.transform;T.setColorMode(E.colorModeForRenderPass());const V=Mh(T,o),Z=d.key,Q=o.heatmapFbos.get(Z);if(!Q)return;T.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,Q.colorAttachment.get()),T.activeTexture.set(D.TEXTURE1),V.bind(D.LINEAR,D.CLAMP_TO_EDGE);const ce=N.getProjectionData({overscaledTileID:d,applyTerrainMatrix:x,applyGlobeMatrix:!g});E.useProgram("heatmapTexture").draw(T,D.TRIANGLES,xr.disabled,Rr.disabled,E.colorModeForRenderPass(),Pr.disabled,Cm(E,o,0,1),null,ce,o.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments,o.paint,N.zoom),Q.destroy(),o.heatmapFbos.delete(Z)}function Id(E,o,d){var g,x;const T=E.gl,D=T.createTexture();T.bindTexture(T.TEXTURE_2D,D),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR);const N=(g=E.HALF_FLOAT)!==null&&g!==void 0?g:T.UNSIGNED_BYTE,V=(x=E.RGBA16F)!==null&&x!==void 0?x:T.RGBA;T.texImage2D(T.TEXTURE_2D,0,V,o,d,0,T.RGBA,N,null);const Z=E.createFramebuffer(o,d,!1,!1);return Z.colorAttachment.set(D),Z}function Mh(E,o){return o.colorRampTexture||(o.colorRampTexture=new s.T(E,o.colorRamp,E.gl.RGBA)),o.colorRampTexture}function Fl(E,o,d,g,x,T,D,N){let V=256;if(x.stepInterpolant){const Z=o.getSource().maxzoom,Q=D.canonical.z===Z?Math.ceil(1<<E.transform.maxZoom-D.canonical.z):1;V=s.an(s.ce(T.maxLineLength/s.a5*1024*Q),256,d.maxTextureSize)}return N.gradient=s.cf({expression:x.gradientExpression(),evaluationKey:"lineProgress",resolution:V,image:N.gradient||void 0,clips:T.lineClipsArray}),N.texture?N.texture.update(N.gradient):N.texture=new s.T(d,N.gradient,g.RGBA),N.version=x.gradientVersion,N.texture}function km(E,o,d,g,x){E.activeTexture.set(o.TEXTURE0),d.imageAtlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),g.updatePaintBuffers(x)}function li(E,o,d,g,x,T){(x||E.lineAtlas.dirty)&&(o.activeTexture.set(d.TEXTURE0),E.lineAtlas.bind(o)),g.updatePaintBuffers(T)}function Wo(E,o,d,g,x,T,D){const N=T.gradients[x.id];let V=N.texture;x.gradientVersion!==N.version&&(V=Fl(E,o,d,g,x,T,D,N)),d.activeTexture.set(g.TEXTURE0),V.bind(x.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}function Oo(E,o,d,g,x,T,D,N,V){const Z=T.gradients[x.id];let Q=Z.texture;x.gradientVersion!==Z.version&&(Q=Fl(E,o,d,g,x,T,D,Z)),d.activeTexture.set(g.TEXTURE0),Q.bind(x.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE),d.activeTexture.set(g.TEXTURE1),E.lineAtlas.bind(d),N.updatePaintBuffers(V)}function ia(E,o,d,g,x){if(!d||!g||!g.imageAtlas)return;const T=g.imageAtlas.patternPositions;let D=T[d.to.toString()],N=T[d.from.toString()];if(!D&&N&&(D=N),!N&&D&&(N=D),!D||!N){const V=x.getPaintProperty(o);D=T[V],N=T[V]}D&&N&&E.setConstantPatternPositions(D,N)}function Cu(E,o,d,g,x,T,D,N){const V=E.context.gl,Z="fill-pattern",Q=d.paint.get(Z),ce=Q&&Q.constantOr(1),le=d.getCrossfadeParameters();let ge,be,ze,$e,Ne;const qe=E.transform,it=d.paint.get("fill-translate"),Xe=d.paint.get("fill-translate-anchor");D?(be=ce&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ge=V.LINES):(be=ce?"fillPattern":"fill",ge=V.TRIANGLES);const rt=Q.constantOr(null);for(const ht of g){const Qe=o.getTile(ht);if(ce&&!Qe.patternsLoaded())continue;const yt=Qe.getBucket(d);if(!yt)continue;const Ot=yt.programConfigurations.get(d.id),Pt=E.useProgram(be,Ot),It=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ht);ce&&(E.context.activeTexture.set(V.TEXTURE0),Qe.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Ot.updatePaintBuffers(le)),ia(Ot,Z,rt,Qe,d);const Dt=qe.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),gn=s.aO(qe,Qe,it,Xe);if(D){$e=yt.indexBuffer2,Ne=yt.segments2;const tn=[V.drawingBufferWidth,V.drawingBufferHeight];ze=be==="fillOutlinePattern"&&ce?Sm(E,le,Qe,tn,gn):wm(tn,gn)}else $e=yt.indexBuffer,Ne=yt.segments,ze=ce?If(E,le,Qe,gn):{u_fill_translate:gn};const xn=E.stencilModeForClipping(ht);Pt.draw(E.context,ge,x,xn,T,Pr.backCCW,ze,It,Dt,d.id,yt.layoutVertexBuffer,$e,Ne,d.paint,E.transform.zoom,Ot)}}function qf(E,o,d,g,x,T,D,N){const V=E.context,Z=V.gl,Q="fill-extrusion-pattern",ce=d.paint.get(Q),le=ce.constantOr(1),ge=d.getCrossfadeParameters(),be=d.paint.get("fill-extrusion-opacity"),ze=ce.constantOr(null),$e=E.transform;for(const Ne of g){const qe=o.getTile(Ne),it=qe.getBucket(d);if(!it)continue;const Xe=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ne),rt=it.programConfigurations.get(d.id),ht=E.useProgram(le?"fillExtrusionPattern":"fillExtrusion",rt);le&&(E.context.activeTexture.set(Z.TEXTURE0),qe.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),rt.updatePaintBuffers(ge));const Qe=$e.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!N,applyTerrainMatrix:!0});ia(rt,Q,ze,qe,d);const yt=s.aO($e,qe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ot=d.paint.get("fill-extrusion-vertical-gradient"),Pt=le?Af(E,Ot,be,yt,Ne,ge,qe):bm(E,Ot,be,yt);ht.draw(V,V.gl.TRIANGLES,x,T,D,Pr.backCCW,Pt,Xe,Qe,d.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,d.paint,E.transform.zoom,rt,E.style.map.terrain&&it.centroidVertexBuffer)}}function Ic(E,o,d,g,x,T,D,N,V){var Z;const Q=E.style.projection,ce=E.context,le=E.transform,ge=ce.gl,be=[`#define NUM_ILLUMINATION_SOURCES ${d.paint.get("hillshade-highlight-color").values.length}`],ze=E.useProgram("hillshade",null,!1,be),$e=!E.options.moving;for(const Ne of g){const qe=o.getTile(Ne),it=qe.fbo;if(!it)continue;const Xe=Q.getMeshFromTileID(ce,Ne.canonical,N,!0,"raster"),rt=(Z=E.style.map.terrain)===null||Z===void 0?void 0:Z.getTerrainData(Ne);ce.activeTexture.set(ge.TEXTURE0),ge.bindTexture(ge.TEXTURE_2D,it.colorAttachment.get());const ht=le.getProjectionData({overscaledTileID:Ne,aligned:$e,applyGlobeMatrix:!V,applyTerrainMatrix:!0});ze.draw(ce,ge.TRIANGLES,T,x[Ne.overscaledZ],D,Pr.backCCW,_d(E,qe,d),rt,ht,d.id,Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}}function Ra(E,o,d,g,x,T,D,N,V){var Z;const Q=E.style.projection,ce=E.context,le=E.transform,ge=ce.gl,be=E.useProgram("colorRelief"),ze=!E.options.moving;let $e=!0,Ne=0;for(const qe of g){const it=o.getTile(qe),Xe=it.dem;if($e){const Pt=ge.getParameter(ge.MAX_TEXTURE_SIZE),{elevationTexture:It,colorTexture:Dt}=d.getColorRampTextures(ce,Pt,Xe.getUnpackVector());ce.activeTexture.set(ge.TEXTURE1),It.bind(ge.NEAREST,ge.CLAMP_TO_EDGE),ce.activeTexture.set(ge.TEXTURE4),Dt.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),$e=!1,Ne=It.size[0]}if(!Xe||!Xe.data)continue;const rt=Xe.stride,ht=Xe.getPixels();if(ce.activeTexture.set(ge.TEXTURE0),ce.pixelStoreUnpackPremultiplyAlpha.set(!1),it.demTexture=it.demTexture||E.getTileTexture(rt),it.demTexture){const Pt=it.demTexture;Pt.update(ht,{premultiply:!1}),Pt.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}else it.demTexture=new s.T(ce,ht,ge.RGBA,{premultiply:!1}),it.demTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE);const Qe=Q.getMeshFromTileID(ce,qe.canonical,N,!0,"raster"),yt=(Z=E.style.map.terrain)===null||Z===void 0?void 0:Z.getTerrainData(qe),Ot=le.getProjectionData({overscaledTileID:qe,aligned:ze,applyGlobeMatrix:!V,applyTerrainMatrix:!0});be.draw(ce,ge.TRIANGLES,T,x[qe.overscaledZ],D,Pr.backCCW,qg(d,it.dem,Ne),yt,Ot,d.id,Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)}}const Da=[new s.P(0,0),new s.P(s.a5,0),new s.P(s.a5,s.a5),new s.P(0,s.a5)];function La(E,o,d,g,x,T,D,N,V=!1,Z=!1){const Q=g[g.length-1].overscaledZ,ce=E.context,le=ce.gl,ge=E.useProgram("raster"),be=E.transform,ze=E.style.projection,$e=E.colorModeForRenderPass(),Ne=!E.options.moving,qe=d.paint.get("raster-opacity"),it=d.paint.get("raster-resampling"),Xe=d.paint.get("raster-fade-duration"),rt=!!E.style.map.terrain;for(const ht of g){const Qe=E.getDepthModeForSublayer(ht.overscaledZ-Q,qe===1?xr.ReadWrite:xr.ReadOnly,le.LESS),yt=o.getTile(ht),Ot=it==="nearest"?le.NEAREST:le.LINEAR;ce.activeTexture.set(le.TEXTURE0),yt.texture.bind(Ot,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),ce.activeTexture.set(le.TEXTURE1);const{parentTile:Pt,parentScaleBy:It,parentTopLeft:Dt,fadeValues:gn}=Rd(yt,o,Xe,rt);yt.fadeOpacity=gn.tileOpacity,Pt?(Pt.fadeOpacity=gn.parentTileOpacity,Pt.texture.bind(Ot,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST)):yt.texture.bind(Ot,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),yt.texture.useMipmap&&ce.extTextureFilterAnisotropic&&E.transform.pitch>20&&le.texParameterf(le.TEXTURE_2D,ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ce.extTextureFilterAnisotropicMax);const xn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ht),tn=be.getProjectionData({overscaledTileID:ht,aligned:Ne,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Dn=Lf(Dt,It,gn.fadeMix,d,N),gr=ze.getMeshFromTileID(ce,ht.canonical,T,D,"raster");ge.draw(ce,le.TRIANGLES,Qe,x?x[ht.overscaledZ]:Rr.disabled,$e,V?Pr.frontCCW:Pr.backCCW,Dn,xn,tn,d.id,gr.vertexBuffer,gr.indexBuffer,gr.segments)}}function Rd(E,o,d,g){const x={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(d===0||g)return x;if(E.fadingParentID){const T=o.getLoadedTile(E.fadingParentID);if(!T)return x;const D=Math.pow(2,T.tileID.overscaledZ-E.tileID.overscaledZ),N=[E.tileID.canonical.x*D%1,E.tileID.canonical.y*D%1],V=function(Z,Q,ce){const le=z(),ge=(le-Q.timeAdded)/ce,be=Z.fadingDirection===he.Incoming,ze=s.an((le-Z.timeAdded)/ce,0,1),$e=s.an(1-ge,0,1),Ne=be?ze:$e;return{tileOpacity:Ne,parentTileOpacity:be?$e:ze,fadeMix:{opacity:1,mix:1-Ne}}}(E,T,d);return{parentTile:T,parentScaleBy:D,parentTopLeft:N,fadeValues:V}}if(E.selfFading){const T=function(D,N){const V=(z()-D.timeAdded)/N,Z=s.an(V,0,1);return{tileOpacity:Z,fadeMix:{opacity:Z,mix:0}}}(E,d);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:T}}return x}const Xf=new s.bp(1,0,0,1),Tu=new s.bp(0,1,0,1),Nl=new s.bp(0,0,1,1),yi=new s.bp(1,0,1,1),Wr=new s.bp(0,1,1,1);function Qa(E,o,d,g){Eo(E,0,o+d/2,E.transform.width,d,g)}function Mo(E,o,d,g){Eo(E,o-d/2,0,d,E.transform.height,g)}function Eo(E,o,d,g,x,T){const D=E.context,N=D.gl;N.enable(N.SCISSOR_TEST),N.scissor(o*E.pixelRatio,d*E.pixelRatio,g*E.pixelRatio,x*E.pixelRatio),D.clear({color:T}),N.disable(N.SCISSOR_TEST)}function Rc(E,o,d){const g=E.context,x=g.gl,T=E.useProgram("debug"),D=xr.disabled,N=Rr.disabled,V=E.colorModeForRenderPass(),Z="$debug",Q=E.style.map.terrain&&E.style.map.terrain.getTerrainData(d);g.activeTexture.set(x.TEXTURE0);const ce=o.getTileByID(d.key).latestRawTileData,le=Math.floor((ce&&ce.byteLength||0)/1024),ge=o.getTile(d).tileSize,be=512/Math.min(ge,512)*(d.overscaledZ/E.transform.zoom)*.5;let ze=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(ze+=` => ${d.overscaledZ}`),function(Ne,qe){Ne.initDebugOverlayCanvas();const it=Ne.debugOverlayCanvas,Xe=Ne.context.gl,rt=Ne.debugOverlayCanvas.getContext("2d");rt.clearRect(0,0,it.width,it.height),rt.shadowColor="white",rt.shadowBlur=2,rt.lineWidth=1.5,rt.strokeStyle="white",rt.textBaseline="top",rt.font="bold 36px Open Sans, sans-serif",rt.fillText(qe,5,5),rt.strokeText(qe,5,5),Ne.debugOverlayTexture.update(it),Ne.debugOverlayTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE)}(E,`${ze} ${le}kB`);const $e=E.transform.getProjectionData({overscaledTileID:d,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(g,x.TRIANGLES,D,N,Br.alphaBlended,Pr.disabled,Em(s.bp.transparent,be),null,$e,Z,E.debugBuffer,E.quadTriangleIndexBuffer,E.debugSegments),T.draw(g,x.LINE_STRIP,D,N,V,Pr.disabled,Em(s.bp.red),Q,$e,Z,E.debugBuffer,E.tileBorderIndexBuffer,E.debugSegments)}function Dc(E,o,d,g){const{isRenderingGlobe:x}=g,T=E.context,D=T.gl,N=E.transform,V=E.colorModeForRenderPass(),Z=E.getDepthModeFor3D(),Q=E.useProgram("terrain");T.bindFramebuffer.set(null),T.viewport.set([0,0,E.width,E.height]);for(const ce of d){const le=o.getTerrainMesh(ce.tileID),ge=E.renderToTexture.getTexture(ce),be=o.getTerrainData(ce.tileID);T.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,ge.texture);const ze=o.getMeshFrameDelta(N.zoom),$e=N.calculateFogMatrix(ce.tileID.toUnwrapped()),Ne=s0(ze,$e,E.style.sky,N.pitch,x),qe=N.getProjectionData({overscaledTileID:ce.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(T,D.TRIANGLES,Z,Rr.disabled,V,Pr.backCCW,Ne,be,qe,"terrain",le.vertexBuffer,le.indexBuffer,le.segments)}}function qo(E,o){if(!o.mesh){const d=new s.aW;d.emplaceBack(-1,-1),d.emplaceBack(1,-1),d.emplaceBack(1,1),d.emplaceBack(-1,1);const g=new s.aY;g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),o.mesh=new ti(E.createVertexBuffer(d,ta.members),E.createIndexBuffer(g),s.aX.simpleSegment(0,0,d.length,g.length))}return o.mesh}class Dd{constructor(o,d){this.context=new jf(o),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=kn.maxOverzooming+kn.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bo}resize(o,d,g){if(this.width=Math.floor(o*g),this.height=Math.floor(d*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style._order)this.style._layers[x].resize()}setup(){const o=this.context,d=new s.aW;d.emplaceBack(0,0),d.emplaceBack(s.a5,0),d.emplaceBack(0,s.a5),d.emplaceBack(s.a5,s.a5),this.tileExtentBuffer=o.createVertexBuffer(d,ta.members),this.tileExtentSegments=s.aX.simpleSegment(0,0,4,2);const g=new s.aW;g.emplaceBack(0,0),g.emplaceBack(s.a5,0),g.emplaceBack(0,s.a5),g.emplaceBack(s.a5,s.a5),this.debugBuffer=o.createVertexBuffer(g,ta.members),this.debugSegments=s.aX.simpleSegment(0,0,4,5);const x=new s.ch;x.emplaceBack(0,0,0,0),x.emplaceBack(s.a5,0,s.a5,0),x.emplaceBack(0,s.a5,0,s.a5),x.emplaceBack(s.a5,s.a5,s.a5,s.a5),this.rasterBoundsBuffer=o.createVertexBuffer(x,o0.members),this.rasterBoundsSegments=s.aX.simpleSegment(0,0,4,2);const T=new s.aW;T.emplaceBack(0,0),T.emplaceBack(s.a5,0),T.emplaceBack(0,s.a5),T.emplaceBack(s.a5,s.a5),this.rasterBoundsBufferPosOnly=o.createVertexBuffer(T,ta.members),this.rasterBoundsSegmentsPosOnly=s.aX.simpleSegment(0,0,4,5);const D=new s.aW;D.emplaceBack(0,0),D.emplaceBack(1,0),D.emplaceBack(0,1),D.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(D,ta.members),this.viewportSegments=s.aX.simpleSegment(0,0,4,2);const N=new s.ci;N.emplaceBack(0),N.emplaceBack(1),N.emplaceBack(3),N.emplaceBack(2),N.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(N);const V=new s.aY;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(V);const Z=this.context.gl;this.stencilClearMode=new Rr({func:Z.ALWAYS,mask:0},0,255,Z.ZERO,Z.ZERO,Z.ZERO),this.tileExtentMesh=new ti(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=s.N();s.c7(g,0,this.width,this.height,0,0,1),s.Q(g,g,[d.drawingBufferWidth,d.drawingBufferHeight,0]);const x={mainMatrix:g,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:g};this.useProgram("clippingMask",null,!0).draw(o,d.TRIANGLES,xr.disabled,this.stencilClearMode,Br.disabled,Pr.disabled,null,null,x,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,d,g){if(this.currentStencilSource===o.source||!o.isTileClipped()||!d||!d.length)return;this.currentStencilSource=o.source,this.nextStencilID+d.length>256&&this.clearStencil();const x=this.context;x.setColorMode(Br.disabled),x.setDepthMode(xr.disabled);const T={};for(const D of d)T[D.key]=this.nextStencilID++;this._renderTileMasks(T,d,g,!0),this._renderTileMasks(T,d,g,!1),this._tileClippingMaskIDs=T}_renderTileMasks(o,d,g,x){const T=this.context,D=T.gl,N=this.style.projection,V=this.transform,Z=this.useProgram("clippingMask");for(const Q of d){const ce=o[Q.key],le=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Q),ge=N.getMeshFromTileID(this.context,Q.canonical,x,!0,"stencil"),be=V.getProjectionData({overscaledTileID:Q,applyGlobeMatrix:!g,applyTerrainMatrix:!0});Z.draw(T,D.TRIANGLES,xr.disabled,new Rr({func:D.ALWAYS,mask:0},ce,255,D.KEEP,D.KEEP,D.REPLACE),Br.disabled,g?Pr.disabled:Pr.backCCW,null,le,be,"$clipping",ge.vertexBuffer,ge.indexBuffer,ge.segments)}}_renderTilesDepthBuffer(){const o=this.context,d=o.gl,g=this.style.projection,x=this.transform,T=this.useProgram("depth"),D=this.getDepthModeFor3D(),N=yr(x,{tileSize:x.tileSize});for(const V of N){const Z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(V),Q=g.getMeshFromTileID(this.context,V.canonical,!0,!0,"raster"),ce=x.getProjectionData({overscaledTileID:V,applyGlobeMatrix:!0,applyTerrainMatrix:!0});T.draw(o,d.TRIANGLES,D,Rr.disabled,Br.disabled,Pr.backCCW,null,Z,ce,"$clipping",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new Rr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){const d=this.context.gl;return new Rr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(o){const d=this.context.gl,g=o.sort((D,N)=>N.overscaledZ-D.overscaledZ),x=g[g.length-1].overscaledZ,T=g[0].overscaledZ-x+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const D={};for(let N=0;N<T;N++)D[N+x]=new Rr({func:d.GEQUAL,mask:255},N+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=T,[D,g]}return[{[x]:Rr.disabled},g]}stencilConfigForOverlapTwoPass(o){const d=this.context.gl,g=o.sort((D,N)=>N.overscaledZ-D.overscaledZ),x=g[g.length-1].overscaledZ,T=g[0].overscaledZ-x+1;if(this.clearStencil(),T>1){const D={},N={};for(let V=0;V<T;V++)D[V+x]=new Rr({func:d.GREATER,mask:255},T+1+V,255,d.KEEP,d.KEEP,d.REPLACE),N[V+x]=new Rr({func:d.GREATER,mask:255},1+V,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID=2*T+1,[D,N,g]}return this.nextStencilID=3,[{[x]:new Rr({func:d.GREATER,mask:255},2,255,d.KEEP,d.KEEP,d.REPLACE)},{[x]:new Rr({func:d.GREATER,mask:255},1,255,d.KEEP,d.KEEP,d.REPLACE)},g]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Br([o.CONSTANT_COLOR,o.ONE],new s.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Br.unblended:Br.alphaBlended}getDepthModeForSublayer(o,d,g){if(!this.opaquePassEnabledForLayer())return xr.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new xr(g||this.context.gl.LEQUAL,d,[x,x])}getDepthModeFor3D(){return new xr(this.context.gl.LEQUAL,xr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){var g,x;this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(z()),this.imageManager.beginFrame();const T=this.style._order,D=this.style.tileManagers,N={},V={},Z={},Q={isRenderingToTexture:!1,isRenderingGlobe:((g=o.projection)===null||g===void 0?void 0:g.transitionState)>0};for(const le in D){const ge=D[le];ge.used&&ge.prepare(this.context),N[le]=ge.getVisibleCoordinates(!1),V[le]=N[le].slice().reverse(),Z[le]=ge.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let le=0;le<T.length;le++)if(this.style._layers[T[le]].is3D()){this.opaquePassCutoff=le;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const le of T){const ge=this.style._layers[le];if(!ge.hasOffscreenPass()||ge.isHidden(this.transform.zoom))continue;const be=V[ge.source];(ge.type==="custom"||be.length)&&this.renderLayer(this,D[ge.source],ge,be,Q)}if((x=this.style.projection)===null||x===void 0||x.updateGPUdependent({context:this.context,useProgram:le=>this.useProgram(le)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?s.bp.black:s.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(le,ge){const be=le.context,ze=be.gl,$e=((ht,Qe,yt)=>{const Ot=Math.cos(Qe.rollInRadians),Pt=Math.sin(Qe.rollInRadians),It=Ge(Qe),Dt=Qe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ht.properties.get("sky-color"),u_horizon_color:ht.properties.get("horizon-color"),u_horizon:[(Qe.width/2-It*Pt)*yt,(Qe.height/2+It*Ot)*yt],u_horizon_normal:[-Pt,Ot],u_sky_horizon_blend:ht.properties.get("sky-horizon-blend")*Qe.height/2*yt,u_sky_blend:Dt}})(ge,le.style.map.transform,le.pixelRatio),Ne=new xr(ze.LEQUAL,xr.ReadWrite,[0,1]),qe=Rr.disabled,it=le.colorModeForRenderPass(),Xe=le.useProgram("sky"),rt=qo(be,ge);Xe.draw(be,ze.TRIANGLES,Ne,qe,it,Pr.disabled,$e,null,void 0,"sky",rt.vertexBuffer,rt.indexBuffer,rt.segments)}(this,this.style.sky),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const le=this.style._layers[T[this.currentLayer]],ge=D[le.source],be=N[le.source];this._renderTileClippingMasks(le,be,!1),this.renderLayer(this,ge,le,be,Q)}this.renderPass="translucent";let ce=!1;for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const le=this.style._layers[T[this.currentLayer]],ge=D[le.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(le,Q))continue;this.opaquePassEnabledForLayer()||ce||(ce=!0,Q.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const be=(le.type==="symbol"?Z:V)[le.source];this._renderTileClippingMasks(le,N[le.source],!!this.renderToTexture),this.renderLayer(this,ge,le,be,Q)}if(Q.isRenderingGlobe&&function(le,ge,be){const ze=le.context,$e=ze.gl,Ne=le.useProgram("atmosphere"),qe=new xr($e.LEQUAL,xr.ReadOnly,[0,1]),it=le.transform,Xe=function(Dt,gn){const xn=Dt.properties.get("position"),tn=[-xn.x,-xn.y,-xn.z],Dn=s.ar(new Float64Array(16));return Dt.properties.get("anchor")==="map"&&(s.bg(Dn,Dn,gn.rollInRadians),s.bh(Dn,Dn,-gn.pitchInRadians),s.bg(Dn,Dn,gn.bearingInRadians),s.bh(Dn,Dn,gn.center.lat*Math.PI/180),s.bJ(Dn,Dn,-gn.center.lng*Math.PI/180)),s.cg(tn,tn,Dn),tn}(be,le.transform),rt=it.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ht=ge.properties.get("atmosphere-blend")*rt.projectionTransition;if(ht===0)return;const Qe=hu(it.worldSize,it.center.lat),yt=it.inverseProjectionMatrix,Ot=new Float64Array(4);Ot[3]=1,s.aH(Ot,Ot,it.modelViewProjectionMatrix),Ot[0]/=Ot[3],Ot[1]/=Ot[3],Ot[2]/=Ot[3],Ot[3]=1,s.aH(Ot,Ot,yt),Ot[0]/=Ot[3],Ot[1]/=Ot[3],Ot[2]/=Ot[3],Ot[3]=1;const Pt=((Dt,gn,xn,tn,Dn)=>({u_sun_pos:Dt,u_atmosphere_blend:gn,u_globe_position:xn,u_globe_radius:tn,u_inv_proj_matrix:Dn}))(Xe,ht,[Ot[0],Ot[1],Ot[2]],Qe,yt),It=qo(ze,ge);Ne.draw(ze,$e.TRIANGLES,qe,Rr.disabled,Br.alphaBlended,Pr.disabled,Pt,null,null,"atmosphere",It.vertexBuffer,It.indexBuffer,It.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const le=function(ge,be){let ze=null;const $e=Object.values(ge._layers).flatMap(Xe=>Xe.source&&!Xe.isHidden(be)?[ge.tileManagers[Xe.source]]:[]),Ne=$e.filter(Xe=>Xe.getSource().type==="vector"),qe=$e.filter(Xe=>Xe.getSource().type!=="vector"),it=Xe=>{(!ze||ze.getSource().maxzoom<Xe.getSource().maxzoom)&&(ze=Xe)};return Ne.forEach(Xe=>it(Xe)),ze||qe.forEach(Xe=>it(Xe)),ze}(this.style,this.transform.zoom);le&&function(ge,be,ze){for(let $e=0;$e<ze.length;$e++)Rc(ge,be,ze[$e])}(this,le,le.getVisibleCoordinates())}this.options.showPadding&&function(le){const ge=le.transform.padding;Qa(le,le.transform.height-(ge.top||0),3,Xf),Qa(le,ge.bottom||0,3,Tu),Mo(le,ge.left||0,3,Nl),Mo(le,le.transform.width-(ge.right||0),3,yi);const be=le.transform.centerPoint;(function(ze,$e,Ne,qe){Eo(ze,$e-1,Ne-10,2,20,qe),Eo(ze,$e-10,Ne-1,20,2,qe)})(le,be.x,le.transform.height-be.y,Wr)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let x=this.terrainFacilitator.dirty;x||(x=o?!s.cj(d,g):!s.ck(d,g)),x||(x=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),x&&(s.cl(d,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(T,D){const N=T.context,V=N.gl,Z=T.transform,Q=Br.unblended,ce=new xr(V.LEQUAL,xr.ReadWrite,[0,1]),le=D.tileManager.getRenderableTiles(),ge=T.useProgram("terrainDepth");N.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),N.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),N.clear({color:s.bp.transparent,depth:1});for(const be of le){const ze=D.getTerrainMesh(be.tileID),$e=D.getTerrainData(be.tileID),Ne=Z.getProjectionData({overscaledTileID:be.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),qe={u_ele_delta:D.getMeshFrameDelta(Z.zoom)};ge.draw(N,V.TRIANGLES,ce,Rr.disabled,Q,Pr.backCCW,qe,$e,Ne,"terrain",ze.vertexBuffer,ze.indexBuffer,ze.segments)}N.bindFramebuffer.set(null),N.viewport.set([0,0,T.width,T.height])}(this,this.style.map.terrain),function(T,D){const N=T.context,V=N.gl,Z=T.transform,Q=Br.unblended,ce=new xr(V.LEQUAL,xr.ReadWrite,[0,1]),le=D.getCoordsTexture(),ge=D.tileManager.getRenderableTiles(),be=T.useProgram("terrainCoords");N.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),N.viewport.set([0,0,T.width/devicePixelRatio,T.height/devicePixelRatio]),N.clear({color:s.bp.transparent,depth:1}),D.coordsIndex=[];for(const ze of ge){const $e=D.getTerrainMesh(ze.tileID),Ne=D.getTerrainData(ze.tileID);N.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,le.texture);const qe={u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0,u_ele_delta:D.getMeshFrameDelta(Z.zoom)},it=Z.getProjectionData({overscaledTileID:ze.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});be.draw(N,V.TRIANGLES,ce,Rr.disabled,Q,Pr.backCCW,qe,Ne,it,"terrain",$e.vertexBuffer,$e.indexBuffer,$e.segments),D.coordsIndex.push(ze.tileID.key)}N.bindFramebuffer.set(null),N.viewport.set([0,0,T.width,T.height])}(this,this.style.map.terrain))}renderLayer(o,d,g,x,T){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(x||[]).length)&&(this.id=g.id,s.cm(g)?function(D,N,V,Z,Q,ce){if(D.renderPass!=="translucent")return;const{isRenderingToTexture:le}=ce,ge=Rr.disabled,be=D.colorModeForRenderPass();(V._unevaluatedLayout.hasValue("text-variable-anchor")||V._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ze,$e,Ne,qe,it,Xe,rt,ht,Qe){const yt=$e.transform,Ot=$e.style.map.terrain,Pt=it==="map",It=Xe==="map";for(const Dt of ze){const gn=qe.getTile(Dt),xn=gn.getBucket(Ne);if(!xn||!xn.text||!xn.text.segments.get().length)continue;const tn=s.ay(xn.textSizeData,yt.zoom),Dn=s.aN(gn,1,$e.transform.zoom),gr=Vt(Pt,$e.transform,Dn),Yr=Ne.layout.get("icon-text-fit")!=="none"&&xn.hasIconData();if(tn){const xi=Math.pow(2,yt.zoom-gn.tileID.overscaledZ),ni=Ot?(bi,ri)=>Ot.getElevation(Dt,bi,ri):null;Dm(xn,Pt,It,Qe,yt,gr,xi,tn,Yr,s.aO(yt,gn,rt,ht),Dt.toUnwrapped(),ni)}}}(Z,D,V,N,V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),Q),V.paint.get("icon-opacity").constantOr(1)!==0&&Eu(D,N,V,Z,!1,V.paint.get("icon-translate"),V.paint.get("icon-translate-anchor"),V.layout.get("icon-rotation-alignment"),V.layout.get("icon-pitch-alignment"),V.layout.get("icon-keep-upright"),ge,be,le),V.paint.get("text-opacity").constantOr(1)!==0&&Eu(D,N,V,Z,!0,V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),V.layout.get("text-keep-upright"),ge,be,le),N.map.showCollisionBoxes&&(Ac(D,N,V,Z,!0),Ac(D,N,V,Z,!1))}(o,d,g,x,this.style.placement.variableOffsets,T):s.cn(g)?function(D,N,V,Z,Q){if(D.renderPass!=="translucent")return;const{isRenderingToTexture:ce}=Q,le=V.paint.get("circle-opacity"),ge=V.paint.get("circle-stroke-width"),be=V.paint.get("circle-stroke-opacity"),ze=!V.layout.get("circle-sort-key").isConstant();if(le.constantOr(1)===0&&(ge.constantOr(1)===0||be.constantOr(1)===0))return;const $e=D.context,Ne=$e.gl,qe=D.transform,it=D.getDepthModeForSublayer(0,xr.ReadOnly),Xe=Rr.disabled,rt=D.colorModeForRenderPass(),ht=[],Qe=qe.getCircleRadiusCorrection();for(let yt=0;yt<Z.length;yt++){const Ot=Z[yt],Pt=N.getTile(Ot),It=Pt.getBucket(V);if(!It)continue;const Dt=V.paint.get("circle-translate"),gn=V.paint.get("circle-translate-anchor"),xn=s.aO(qe,Pt,Dt,gn),tn=It.programConfigurations.get(V.id),Dn=D.useProgram("circle",tn),gr=It.layoutVertexBuffer,Yr=It.indexBuffer,xi=D.style.map.terrain&&D.style.map.terrain.getTerrainData(Ot),ni={programConfiguration:tn,program:Dn,layoutVertexBuffer:gr,indexBuffer:Yr,uniformValues:Mm(D,Pt,V,xn,Qe),terrainData:xi,projectionData:qe.getProjectionData({overscaledTileID:Ot,applyGlobeMatrix:!ce,applyTerrainMatrix:!0})};if(ze){const bi=It.segments.get();for(const ri of bi)ht.push({segments:new s.aX([ri]),sortKey:ri.sortKey,state:ni})}else ht.push({segments:It.segments,sortKey:0,state:ni})}ze&&ht.sort((yt,Ot)=>yt.sortKey-Ot.sortKey);for(const yt of ht){const{programConfiguration:Ot,program:Pt,layoutVertexBuffer:It,indexBuffer:Dt,uniformValues:gn,terrainData:xn,projectionData:tn}=yt.state;Pt.draw($e,Ne.TRIANGLES,it,Xe,rt,Pr.backCCW,gn,xn,tn,V.id,It,Dt,yt.segments,V.paint,D.transform.zoom,Ot)}}(o,d,g,x,T):s.co(g)?function(D,N,V,Z,Q){if(V.paint.get("heatmap-opacity")===0)return;const ce=D.context,{isRenderingToTexture:le,isRenderingGlobe:ge}=Q;if(D.style.map.terrain){for(const be of Z){const ze=N.getTile(be);N.hasRenderableParent(be)||(D.renderPass==="offscreen"?Lm(D,ze,V,be,ge):D.renderPass==="translucent"&&ev(D,V,be,le,ge))}ce.viewport.set([0,0,D.width,D.height])}else D.renderPass==="offscreen"?function(be,ze,$e,Ne){const qe=be.context,it=qe.gl,Xe=be.transform,rt=Rr.disabled,ht=new Br([it.ONE,it.ONE],s.bp.transparent,[!0,!0,!0,!0]);(function(Qe,yt,Ot){const Pt=Qe.gl;Qe.activeTexture.set(Pt.TEXTURE1),Qe.viewport.set([0,0,yt.width/4,yt.height/4]);let It=Ot.heatmapFbos.get(s.cd);It?(Pt.bindTexture(Pt.TEXTURE_2D,It.colorAttachment.get()),Qe.bindFramebuffer.set(It.framebuffer)):(It=Id(Qe,yt.width/4,yt.height/4),Ot.heatmapFbos.set(s.cd,It))})(qe,be,$e),qe.clear({color:s.bp.transparent});for(let Qe=0;Qe<Ne.length;Qe++){const yt=Ne[Qe];if(ze.hasRenderableParent(yt))continue;const Ot=ze.getTile(yt),Pt=Ot.getBucket($e);if(!Pt)continue;const It=Pt.programConfigurations.get($e.id),Dt=be.useProgram("heatmap",It),gn=Xe.getProjectionData({overscaledTileID:yt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),xn=Xe.getCircleRadiusCorrection();Dt.draw(qe,it.TRIANGLES,xr.disabled,rt,ht,Pr.backCCW,vh(Ot,Xe.zoom,$e.paint.get("heatmap-intensity"),xn),null,gn,$e.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,$e.paint,Xe.zoom,It)}qe.viewport.set([0,0,be.width,be.height])}(D,N,V,Z):D.renderPass==="translucent"&&function(be,ze){const $e=be.context,Ne=$e.gl;$e.setColorMode(be.colorModeForRenderPass());const qe=ze.heatmapFbos.get(s.cd);qe&&($e.activeTexture.set(Ne.TEXTURE0),Ne.bindTexture(Ne.TEXTURE_2D,qe.colorAttachment.get()),$e.activeTexture.set(Ne.TEXTURE1),Mh($e,ze).bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),be.useProgram("heatmapTexture").draw($e,Ne.TRIANGLES,xr.disabled,Rr.disabled,be.colorModeForRenderPass(),Pr.disabled,Cm(be,ze,0,1),null,null,ze.id,be.viewportBuffer,be.quadTriangleIndexBuffer,be.viewportSegments,ze.paint,be.transform.zoom))}(D,V)}(o,d,g,x,T):s.cp(g)?function(D,N,V,Z,Q){if(D.renderPass!=="translucent")return;const{isRenderingToTexture:ce}=Q,le=V.paint.get("line-opacity"),ge=V.paint.get("line-width");if(le.constantOr(1)===0||ge.constantOr(1)===0)return;const be=D.getDepthModeForSublayer(0,xr.ReadOnly),ze=D.colorModeForRenderPass(),$e=V.paint.get("line-dasharray"),Ne=$e.constantOr(1),qe=V.paint.get("line-pattern"),it=qe.constantOr(1),Xe=V.paint.get("line-gradient"),rt=V.getCrossfadeParameters();let ht;ht=it?"linePattern":Ne&&Xe?"lineGradientSDF":Ne?"lineSDF":Xe?"lineGradient":"line";const Qe=D.context,yt=Qe.gl,Ot=D.transform;let Pt=!0;for(const It of Z){const Dt=N.getTile(It);if(it&&!Dt.patternsLoaded())continue;const gn=Dt.getBucket(V);if(!gn)continue;const xn=gn.programConfigurations.get(V.id),tn=D.context.program.get(),Dn=D.useProgram(ht,xn),gr=Pt||Dn.program!==tn,Yr=D.style.map.terrain&&D.style.map.terrain.getTerrainData(It),xi=qe.constantOr(null),ni=$e&&$e.constantOr(null);if(xi&&Dt.imageAtlas){const Co=Dt.imageAtlas,Xi=Co.patternPositions[xi.to.toString()],qr=Co.patternPositions[xi.from.toString()];Xi&&qr&&xn.setConstantPatternPositions(Xi,qr)}else if(ni){const Co=V.layout.get("line-cap")==="round",Xi=D.lineAtlas.getDash(ni.to,Co),qr=D.lineAtlas.getDash(ni.from,Co);xn.setConstantDashPositions(Xi,qr)}const bi=Ot.getProjectionData({overscaledTileID:It,applyGlobeMatrix:!ce,applyTerrainMatrix:!0}),ri=Ot.getPixelScale();let wi;it?(wi=Rf(D,Dt,V,ri,rt),km(Qe,yt,Dt,xn,rt)):Ne&&Xe?(wi=yh(D,Dt,V,ri,rt,gn.lineClipsArray.length),Oo(D,N,Qe,yt,V,gn,It,xn,rt)):Ne?(wi=Df(D,Dt,V,ri,rt),li(D,Qe,yt,xn,gr,rt)):Xe?(wi=Xg(D,Dt,V,ri,gn.lineClipsArray.length),Wo(D,N,Qe,yt,V,gn,It)):wi=Ec(D,Dt,V,ri);const Di=D.stencilModeForClipping(It);Dn.draw(Qe,yt.TRIANGLES,be,Di,ze,Pr.disabled,wi,Yr,bi,V.id,gn.layoutVertexBuffer,gn.indexBuffer,gn.segments,V.paint,D.transform.zoom,xn,gn.layoutVertexBuffer2),Pt=!1}}(o,d,g,x,T):s.cq(g)?function(D,N,V,Z,Q){const ce=V.paint.get("fill-color"),le=V.paint.get("fill-opacity");if(le.constantOr(1)===0)return;const{isRenderingToTexture:ge}=Q,be=D.colorModeForRenderPass(),ze=V.paint.get("fill-pattern"),$e=D.opaquePassEnabledForLayer()&&!ze.constantOr(1)&&ce.constantOr(s.bp.transparent).a===1&&le.constantOr(0)===1?"opaque":"translucent";if(D.renderPass===$e){const Ne=D.getDepthModeForSublayer(1,D.renderPass==="opaque"?xr.ReadWrite:xr.ReadOnly);Cu(D,N,V,Z,Ne,be,!1,ge)}if(D.renderPass==="translucent"&&V.paint.get("fill-antialias")){const Ne=D.getDepthModeForSublayer(V.getPaintProperty("fill-outline-color")?2:0,xr.ReadOnly);Cu(D,N,V,Z,Ne,be,!0,ge)}}(o,d,g,x,T):s.cr(g)?function(D,N,V,Z,Q){const ce=V.paint.get("fill-extrusion-opacity");if(ce===0)return;const{isRenderingToTexture:le}=Q;if(D.renderPass==="translucent"){const ge=new xr(D.context.gl.LEQUAL,xr.ReadWrite,D.depthRangeFor3D);if(ce!==1||V.paint.get("fill-extrusion-pattern").constantOr(1))qf(D,N,V,Z,ge,Rr.disabled,Br.disabled,le),qf(D,N,V,Z,ge,D.stencilModeFor3D(),D.colorModeForRenderPass(),le);else{const be=D.colorModeForRenderPass();qf(D,N,V,Z,ge,Rr.disabled,be,le)}}}(o,d,g,x,T):s.cs(g)?function(D,N,V,Z,Q){if(D.renderPass!=="offscreen"&&D.renderPass!=="translucent")return;const{isRenderingToTexture:ce}=Q,le=D.context,ge=D.style.projection.useSubdivision,be=D.getDepthModeForSublayer(0,xr.ReadOnly),ze=D.colorModeForRenderPass();if(D.renderPass==="offscreen")(function($e,Ne,qe,it,Xe,rt,ht){const Qe=$e.context,yt=Qe.gl;for(const Ot of qe){const Pt=Ne.getTile(Ot),It=Pt.dem;if(!It||!It.data||!Pt.needsHillshadePrepare)continue;const Dt=It.dim,gn=It.stride,xn=It.getPixels();if(Qe.activeTexture.set(yt.TEXTURE1),Qe.pixelStoreUnpackPremultiplyAlpha.set(!1),Pt.demTexture=Pt.demTexture||$e.getTileTexture(gn),Pt.demTexture){const Dn=Pt.demTexture;Dn.update(xn,{premultiply:!1}),Dn.bind(yt.NEAREST,yt.CLAMP_TO_EDGE)}else Pt.demTexture=new s.T(Qe,xn,yt.RGBA,{premultiply:!1}),Pt.demTexture.bind(yt.NEAREST,yt.CLAMP_TO_EDGE);Qe.activeTexture.set(yt.TEXTURE0);let tn=Pt.fbo;if(!tn){const Dn=new s.T(Qe,{width:Dt,height:Dt,data:null},yt.RGBA);Dn.bind(yt.LINEAR,yt.CLAMP_TO_EDGE),tn=Pt.fbo=Qe.createFramebuffer(Dt,Dt,!0,!1),tn.colorAttachment.set(Dn.texture)}Qe.bindFramebuffer.set(tn.framebuffer),Qe.viewport.set([0,0,Dt,Dt]),$e.useProgram("hillshadePrepare").draw(Qe,yt.TRIANGLES,Xe,rt,ht,Pr.disabled,xd(Pt.tileID,It),null,null,it.id,$e.rasterBoundsBuffer,$e.quadTriangleIndexBuffer,$e.rasterBoundsSegments),Pt.needsHillshadePrepare=!1}})(D,N,Z,V,be,Rr.disabled,ze),le.viewport.set([0,0,D.width,D.height]);else if(D.renderPass==="translucent")if(ge){const[$e,Ne,qe]=D.stencilConfigForOverlapTwoPass(Z);Ic(D,N,V,qe,$e,be,ze,!1,ce),Ic(D,N,V,qe,Ne,be,ze,!0,ce)}else{const[$e,Ne]=D.getStencilConfigForOverlapAndUpdateStencilID(Z);Ic(D,N,V,Ne,$e,be,ze,!1,ce)}}(o,d,g,x,T):s.ct(g)?function(D,N,V,Z,Q){if(D.renderPass!=="translucent"||!Z.length)return;const{isRenderingToTexture:ce}=Q,le=D.style.projection.useSubdivision,ge=D.getDepthModeForSublayer(0,xr.ReadOnly),be=D.colorModeForRenderPass();if(le){const[ze,$e,Ne]=D.stencilConfigForOverlapTwoPass(Z);Ra(D,N,V,Ne,ze,ge,be,!1,ce),Ra(D,N,V,Ne,$e,ge,be,!0,ce)}else{const[ze,$e]=D.getStencilConfigForOverlapAndUpdateStencilID(Z);Ra(D,N,V,$e,ze,ge,be,!1,ce)}}(o,d,g,x,T):s.bU(g)?function(D,N,V,Z,Q){if(D.renderPass!=="translucent"||V.paint.get("raster-opacity")===0||!Z.length)return;const{isRenderingToTexture:ce}=Q,le=N.getSource(),ge=D.style.projection.useSubdivision;if(le instanceof jt)La(D,N,V,Z,null,!1,!1,le.tileCoords,le.flippedWindingOrder,ce);else if(ge){const[be,ze,$e]=D.stencilConfigForOverlapTwoPass(Z);La(D,N,V,$e,be,!1,!0,Da,!1,ce),La(D,N,V,$e,ze,!0,!0,Da,!1,ce)}else{const[be,ze]=D.getStencilConfigForOverlapAndUpdateStencilID(Z);La(D,N,V,ze,be,!1,!0,Da,!1,ce)}}(o,d,g,x,T):s.cu(g)?function(D,N,V,Z,Q){const ce=V.paint.get("background-color"),le=V.paint.get("background-opacity");if(le===0)return;const{isRenderingToTexture:ge}=Q,be=D.context,ze=be.gl,$e=D.style.projection,Ne=D.transform,qe=Ne.tileSize,it=V.paint.get("background-pattern");if(D.isPatternMissing(it))return;const Xe=!it&&ce.a===1&&le===1&&D.opaquePassEnabledForLayer()?"opaque":"translucent";if(D.renderPass!==Xe)return;const rt=Rr.disabled,ht=D.getDepthModeForSublayer(0,Xe==="opaque"?xr.ReadWrite:xr.ReadOnly),Qe=D.colorModeForRenderPass(),yt=D.useProgram(it?"backgroundPattern":"background"),Ot=Z||yr(Ne,{tileSize:qe,terrain:D.style.map.terrain});it&&(be.activeTexture.set(ze.TEXTURE0),D.imageManager.bind(D.context));const Pt=V.getCrossfadeParameters();for(const It of Ot){const Dt=Ne.getProjectionData({overscaledTileID:It,applyGlobeMatrix:!ge,applyTerrainMatrix:!0}),gn=it?Aa(le,D,it,{tileID:It,tileSize:qe},Pt):Am(le,ce),xn=D.style.map.terrain&&D.style.map.terrain.getTerrainData(It),tn=$e.getMeshFromTileID(be,It.canonical,!1,!0,"raster");yt.draw(be,ze.TRIANGLES,ht,rt,Qe,Pr.backCCW,gn,xn,Dt,V.id,tn.vertexBuffer,tn.indexBuffer,tn.segments)}}(o,0,g,x,T):s.cv(g)&&function(D,N,V,Z){const{isRenderingGlobe:Q}=Z,ce=D.context,le=V.implementation,ge=D.style.projection,be=D.transform,ze=be.getProjectionDataForCustomLayer(Q),$e={farZ:be.farZ,nearZ:be.nearZ,fov:be.fov*Math.PI/180,modelViewProjectionMatrix:be.modelViewProjectionMatrix,projectionMatrix:be.projectionMatrix,shaderData:{variantName:ge.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ge.shaderPreludeCode.vertexSource}`,define:ge.shaderDefine},defaultProjectionData:ze},Ne=le.renderingMode?le.renderingMode:"2d";if(D.renderPass==="offscreen"){const qe=le.prerender;qe&&(D.setCustomLayerDefaults(),ce.setColorMode(D.colorModeForRenderPass()),qe.call(le,ce.gl,$e),ce.setDirty(),D.setBaseState())}else if(D.renderPass==="translucent"){D.setCustomLayerDefaults(),ce.setColorMode(D.colorModeForRenderPass()),ce.setStencilMode(Rr.disabled);const qe=Ne==="3d"?D.getDepthModeFor3D():D.getDepthModeForSublayer(0,xr.ReadOnly);ce.setDepthMode(qe),le.render(ce.gl,$e),ce.setDirty(),D.setBaseState(),ce.bindFramebuffer.set(null)}}(o,0,g,T))}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),g=this.imageManager.getPattern(o.to.toString());return!d||!g}useProgram(o,d,g=!1,x=[]){this.cache=this.cache||{};const T=!!this.style.map.terrain,D=this.style.projection,N=g?Zr.projectionMercator:D.shaderPreludeCode,V=g?os:D.shaderDefine,Z=o+(d?d.cacheKey:"")+`/${g?_s:D.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(T?"/terrain":"")+(x?`/${x.join("/")}`:"");return this.cache[Z]||(this.cache[Z]=new Pf(this.context,Zr[o],d,Zg[o],this._showOverdrawInspector,T,N,V,x)),this.cache[Z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var o,d;if(this._tileTextures){for(const g in this._tileTextures){const x=this._tileTextures[g];if(x)for(const T of x)T.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((o=this.tileExtentMesh.vertexBuffer)===null||o===void 0||o.destroy()),this.tileExtentMesh&&((d=this.tileExtentMesh.indexBuffer)===null||d===void 0||d.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const g in this.cache){const x=this.cache[g];x&&x.program&&this.context.gl.deleteProgram(x.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:d}=this.context.gl;return this.width!==o||this.height!==d}}function Zf(E,o){let d,g=!1,x=null,T=null;const D=()=>{x=null,g&&(E.apply(T,d),x=setTimeout(D,o),g=!1)};return(...N)=>(g=!0,T=this,d=N,x||D(),x)}class Yf{constructor(o){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let g;return d.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(g=x)}),(g&&g[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(!this._isValidHash(d))return!1;const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:g,pitch:+(d[4]||0)}),!0},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,d)},this._removeHash=()=>{const d=this._getCurrentHash();if(d.length===0)return;const g=d.join("/");let x=g;x.split("&").length>0&&(x=x.split("&")[0]),this._hashName&&(x=`${this._hashName}=${g}`);let T=window.location.hash.replace(x,"");T.startsWith("#&")?T=T.slice(0,1)+T.slice(2):T==="#"&&(T="");let D=window.location.href.replace(/(#.+)?$/,T);D=D.replace("&&","&"),window.history.replaceState(window.history.state,null,D)},this._updateHash=Zf(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const d=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,x),D=Math.round(d.lng*T)/T,N=Math.round(d.lat*T)/T,V=this._map.getBearing(),Z=this._map.getPitch();let Q="";if(Q+=o?`/${D}/${N}/${g}`:`${g}/${N}/${D}`,(V||Z)&&(Q+="/"+Math.round(10*V)/10),Z&&(Q+=`/${Math.round(Z)}`),this._hashName){const ce=this._hashName;let le=!1;const ge=window.location.hash.slice(1).split("&").map(be=>{const ze=be.split("=")[0];return ze===ce?(le=!0,`${ze}=${Q}`):be}).filter(be=>be);return le||ge.push(`${ce}=${Q}`),`#${ge.join("&")}`}return`#${Q}`}_isValidHash(o){if(o.length<3||o.some(isNaN))return!1;try{new s.V(+o[2],+o[1])}catch{return!1}const d=+o[0],g=+(o[3]||0),x=+(o[4]||0);return d>=this._map.getMinZoom()&&d<=this._map.getMaxZoom()&&g>=-180&&g<=180&&x>=this._map.getMinPitch()&&x<=this._map.getMaxPitch()}}const ka={linearity:.3,easing:s.cw(0,0,.3,1)},zm=s.e({deceleration:2500,maxSpeed:1400},ka),ro=s.e({deceleration:20,maxSpeed:1400},ka),bs=s.e({deceleration:1e3,maxSpeed:360},ka),Kf=s.e({deceleration:1e3,maxSpeed:90},ka),oa=s.e({deceleration:1e3,maxSpeed:360},ka);class a0{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:z(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=z();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)d.zoom+=T.zoomDelta||0,d.bearing+=T.bearingDelta||0,d.pitch+=T.pitchDelta||0,d.roll+=T.rollDelta||0,T.panDelta&&d.pan._add(T.panDelta),T.around&&(d.around=T.around),T.pinchAround&&(d.pinchAround=T.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(d.pan.mag()){const T=el(d.pan.mag(),g,s.e({},zm,o||{})),D=d.pan.mult(T.amount/d.pan.mag()),N=this._map.cameraHelper.handlePanInertia(D,this._map.transform);x.center=N.easingCenter,x.offset=N.easingOffset,sa(x,T)}if(d.zoom){const T=el(d.zoom,g,ro),D=s.cx(this._map.transform.zoom+T.amount,this._map.getZoomSnap(),T.amount);x.zoom=D,sa(x,T)}if(d.bearing){const T=el(d.bearing,g,bs);x.bearing=this._map.transform.bearing+s.an(T.amount,-179,179),sa(x,T)}if(d.pitch){const T=el(d.pitch,g,Kf);x.pitch=this._map.transform.pitch+T.amount,sa(x,T)}if(d.roll){const T=el(d.roll,g,oa);x.roll=this._map.transform.roll+s.an(T.amount,-179,179),sa(x,T)}if(x.zoom||x.bearing){const T=d.pinchAround===void 0?d.around:d.pinchAround;x.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),s.e(x,{noMoveStart:!0})}}function sa(E,o){(!E.duration||E.duration<o.duration)&&(E.duration=o.duration,E.easing=o.easing)}function el(E,o,d){const{maxSpeed:g,linearity:x,deceleration:T}=d,D=s.an(E*x/(o/1e3),-g,g),N=Math.abs(D)/(T*x);return{easing:d.easing,duration:1e3*N,amount:D*(N/2)}}class $i extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,g,x={}){g=g instanceof MouseEvent?g:new MouseEvent(o,g);const T=P.mousePos(d.getCanvas(),g),D=d.unproject(T);super(o,s.e({point:T,lngLat:D,originalEvent:g},x)),this._defaultPrevented=!1,this.target=d}}class Lc extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,g){const x=o==="touchend"?g.changedTouches:g.touches,T=P.touchPos(d.getCanvasContainer(),x),D=T.map(V=>d.unproject(V)),N=T.reduce((V,Z,Q,ce)=>V.add(Z.div(ce.length)),new s.P(0,0));super(o,{points:T,point:N,lngLats:D,lngLat:d.unproject(N),originalEvent:g}),this._defaultPrevented=!1}}class Ld extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class aa{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Ld(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new $i(o.type,this._map,o))}mouseup(o){this._map.fire(new $i(o.type,this._map,o))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new $i(o.type,this._map,o))}dblclick(o){return this._firePreventable(new $i(o.type,this._map,o))}mouseover(o){this._map.fire(new $i(o.type,this._map,o))}mouseout(o){this._map.fire(new $i(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Lc(o.type,this._map,o))}touchmove(o){this._map.fire(new Lc(o.type,this._map,o))}touchend(o){this._map.fire(new Lc(o.type,this._map,o))}touchcancel(o){this._map.fire(new Lc(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class la{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new $i(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new $i(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ca{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.screenPointToLocation(s.P.convert(o),this._map.terrain)}}class ws{constructor(o,d){this._map=o,this._tr=new ca(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(P.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const g=d;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=g,this._box||(this._box=P.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const T=Math.min(x.x,g.x),D=Math.max(x.x,g.x),N=Math.min(x.y,g.y),V=Math.max(x.y,g.y);P.setTransform(this._box,`translate(${T}px,${N}px)`),this._box.style.width=D-T+"px",this._box.style.height=V-N+"px"}mouseupWindow(o,d){if(!this._active||o.button!==0)return;const g=this._startPos,x=d;if(this.reset(),P.suppressClick(),g.x!==x.x||g.y!==x.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:o})),{cameraAnimation:T=>T.fitScreenCoordinates(g,x,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(P.remove(this._box),this._box=null),P.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new s.l(o,{originalEvent:d}))}}function ho(E,o){if(E.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${E.length}, points ${o.length}`);const d={};for(let g=0;g<E.length;g++)d[E[g].identifier]=o[g];return d}class Nn{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,d,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const T=new s.P(0,0);for(const D of x)T._add(D);return T.div(x.length)}(d),this.touches=ho(g,d)))}touchmove(o,d,g){if(this.aborted||!this.centroid)return;const x=ho(g,d);for(const T in this.touches){const D=x[T];(!D||D.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(o,d,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class kd{constructor(o){this.singleTap=new Nn(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,d,g){this.singleTap.touchstart(o,d,g)}touchmove(o,d,g){this.singleTap.touchmove(o,d,g)}touchend(o,d,g){const x=this.singleTap.touchend(o,d,g);if(x){const T=o.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(x)<30;if(T&&D||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class zd{constructor(o){this._tr=new ca(o),this._zoomIn=new kd({numTouches:1,numTaps:2}),this._zoomOut=new kd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,g){this._zoomIn.touchstart(o,d,g),this._zoomOut.touchstart(o,d,g)}touchmove(o,d,g){this._zoomIn.touchmove(o,d,g),this._zoomOut.touchmove(o,d,g)}touchend(o,d,g){const x=this._zoomIn.touchend(o,d,g),T=this._zoomOut.touchend(o,d,g),D=this._tr;return x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:s.cx(D.zoom+1,N.getZoomSnap()),around:D.unproject(x)},{originalEvent:o})}):T?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:s.cx(D.zoom-1,N.getZoomSnap()),around:D.unproject(T)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kc{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const d=this._moveFunction(...o);if(d.bearingDelta||d.pitchDelta||d.rollDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(o,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=Array.isArray(d)?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,d){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const x=Array.isArray(d)?d[0]:d;return!this._moved&&x.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=x,this._move(g,x))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&P.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Fo=0,No=2,_i={[Fo]:1,[No]:2};class ls{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const d=P.mouseButton(o);this._eventButton=d}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(d,g){const x=_i[g];return d.buttons===void 0||(d.buttons&x)!==x}(o,this._eventButton)}isValidEndEvent(o){return P.mouseButton(o)===this._eventButton}}class Jf{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}class Om{constructor(o=new ls({checkCorrectEvent:()=>!0}),d=new Jf){this.mouseMoveStateManager=o,this.oneFingerTouchMoveStateManager=d}_executeRelevantHandler(o,d,g){return o instanceof MouseEvent?d(o):typeof TouchEvent<"u"&&o instanceof TouchEvent?g(o):void 0}startMove(o){this._executeRelevantHandler(o,d=>this.mouseMoveStateManager.startMove(d),d=>this.oneFingerTouchMoveStateManager.startMove(d))}endMove(o){this._executeRelevantHandler(o,d=>this.mouseMoveStateManager.endMove(d),d=>this.oneFingerTouchMoveStateManager.endMove(d))}isValidStartEvent(o){return this._executeRelevantHandler(o,d=>this.mouseMoveStateManager.isValidStartEvent(d),d=>this.oneFingerTouchMoveStateManager.isValidStartEvent(d))}isValidMoveEvent(o){return this._executeRelevantHandler(o,d=>this.mouseMoveStateManager.isValidMoveEvent(d),d=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(d))}isValidEndEvent(o){return this._executeRelevantHandler(o,d=>this.mouseMoveStateManager.isValidEndEvent(d),d=>this.oneFingerTouchMoveStateManager.isValidEndEvent(d))}}const zc=E=>{E.mousedown=E.dragStart,E.mousemoveWindow=E.dragMove,E.mouseup=E.dragEnd,E.contextmenu=o=>{o.preventDefault()}};class Fm{constructor(o,d){this._clickTolerance=o.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,d,g){return this._calculateTransform(o,d,g)}touchmove(o,d,g){if(this._active){if(!this._shouldBePrevented(g.length))return o.preventDefault(),this._calculateTransform(o,d,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,d,g){this._calculateTransform(o,d,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,g){g.length>0&&(this._active=!0);const x=ho(g,d),T=new s.P(0,0),D=new s.P(0,0);let N=0;for(const Z in x){const Q=x[Z],ce=this._touches[Z];ce&&(T._add(Q),D._add(Q.sub(ce)),N++,x[Z]=Q)}if(this._touches=x,this._shouldBePrevented(N)||!D.mag())return;const V=D.div(N);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(N),panDelta:V}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Od{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,d,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,g){if(!this._firstTwoTouches)return;o.preventDefault();const[x,T]=this._firstTwoTouches,D=Pu(g,d,x),N=Pu(g,d,T);if(!D||!N)return;const V=this._aroundCenter?null:D.add(N).div(2);return this._move([D,N],V,o)}touchend(o,d,g){if(!this._firstTwoTouches)return;const[x,T]=this._firstTwoTouches,D=Pu(g,d,x),N=Pu(g,d,T);D&&N||(this._active&&P.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Pu(E,o,d){for(let g=0;g<E.length;g++)if(E[g].identifier===d)return o[g]}function Nm(E,o){return Math.log(E/o)/Math.LN2}class Oc extends Od{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Nm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Nm(this._distance,g),pinchAround:d}}}function Qf(E,o){return 180*E.angleWith(o)/Math.PI}class Bm extends Od{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d,g){const x=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qf(this._vector,x),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,g=Qf(o,this._startVector);return Math.abs(g)<d}}function Au(E){return Math.abs(E.y)>Math.abs(E.x)}class Fd extends Od{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,d,g){super.touchstart(o,d,g),this._currentTouchCount=g.length}_start(o){this._lastPoints=o,Au(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const x=o[0].sub(this._lastPoints[0]),T=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(x,T,g.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(x.y+T.y)/2*-.5}):void 0}gestureBeginsVertically(o,d,g){if(this._valid!==void 0)return this._valid;const x=o.mag()>=2,T=d.mag()>=2;if(!x&&!T)return;if(!x||!T)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const D=o.y>0==d.y>0;return Au(o)&&Au(d)&&D}}const Bl={panStep:100,bearingStep:15,pitchStep:10};class Jr{constructor(o){this._tr=new ca(o);const d=Bl;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,g=0,x=0,T=0,D=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),T=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),T=1);break;case 38:o.shiftKey?x=1:(o.preventDefault(),D=-1);break;case 40:o.shiftKey?x=-1:(o.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:N=>{const V=this._tr;N.easeTo({duration:300,easeId:"keyboardHandler",easing:Eh,zoom:d?s.cx(V.zoom+d*(o.shiftKey?2:1),N.getZoomSnap()):V.zoom,bearing:V.bearing+g*this._bearingStep,pitch:V.pitch+x*this._pitchStep,offset:[-T*this._panStep,-D*this._panStep],center:V.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Eh(E){return E*(2-E)}const Ch=4.000244140625,Iu=1/450;class Ru{constructor(o,d){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=o,this._tr=new ca(o),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Iu}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const g=z(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,d!==0&&d%Ch==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(x*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=P.mousePos(this._map.getCanvas(),o),g=this._tr;this._aroundPoint=this._aroundCenter?g.transform.locationToScreenPoint(s.V.convert(g.center)):d,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const N=o.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=N),typeof this._targetZoom=="number"&&(this._targetZoom+=N)}if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>Ch?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&V!==0&&(V=1/V);const Z=typeof this._targetZoom!="number"?o.scale:s.aq(this._targetZoom),Q=o.applyConstrain(o.getCameraLngLat(),s.at(Z*V)).zoom,ce=this._map.getZoomSnap();if(this._type==="wheel"&&ce>0){const le=s.cx(o.zoom,ce);this._targetZoom=s.cx(Q,ce,Q-le)}else this._targetZoom=Q;this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom!="number"?o.zoom:this._targetZoom,g=this._startZoom,x=this._easing;let T,D=!1;if(this._type==="wheel"&&g&&x){const N=z()-this._lastWheelEventTime,V=Math.min((N+5)/200,1),Z=x(V);T=s.G.number(g,d,Z),V<1?this._frameId||(this._frameId=!0):D=!0}else T=d,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=T,{noInertia:!0,needsRenderFrame:!D,zoomDelta:T-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=s.cz;if(this._prevEase){const g=this._prevEase,x=(z()-g.start)/g.duration,T=g.easing(x+.01)-g.easing(x),D=.27/Math.sqrt(T*T+1e-4)*.01,N=Math.sqrt(.0729-D*D);d=s.cw(D,N,.25,1)}return this._prevEase={start:z(),duration:o,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Fc{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ep{constructor(o){this._tr=new ca(o),this.reset()}reset(){this._active=!1}dblclick(o,d){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:s.cx(this._tr.zoom+(o.shiftKey?-1:1),g.getZoomSnap()),around:this._tr.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tp{constructor(){this._tap=new kd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,d,g){if(!this._swipePoint)if(this._tapTime){const x=d[0],T=o.timeStamp-this._tapTime<500,D=this._tapPoint.dist(x)<30;T&&D?g.length>0&&(this._swipePoint=x,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(o,d,g)}touchmove(o,d,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=d[0],T=x.y-this._swipePoint.y;return this._swipePoint=x,o.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(o,d,g)}touchend(o,d,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const x=this._tap.touchend(o,d,g);x&&(this._tapTime=o.timeStamp,this._tapPoint=x)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class np{constructor(o,d,g){this._el=o,this._mousePan=d,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vs{constructor(o,d,g,x){this._pitchWithRotate=o.pitchWithRotate,this._rollEnabled=o.rollEnabled,this._mouseRotate=d,this._mousePitch=g,this._mouseRoll=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class tl{constructor(o,d,g,x){this._el=o,this._touchZoom=d,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Vn{constructor(o,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=o,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=P.create("div","maplibregl-cooperative-gesture-screen",o);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),x=document.createElement("div");x.className="maplibregl-desktop-message",x.textContent=d,this._container.appendChild(x);const T=document.createElement("div");T.className="maplibregl-mobile-message",T.textContent=g,this._container.appendChild(T),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(P.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,d){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:o,originalEvent:d})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const rr=E=>E.zoom||E.drag||E.roll||E.pitch||E.rotate;class Du extends s.l{}function Nd(E){return E.panDelta&&E.panDelta.mag()||E.zoomDelta||E.bearingDelta||E.pitchDelta||E.rollDelta}class ua{get _ownerDocument(){var o;return((o=this._el)===null||o===void 0?void 0:o.ownerDocument)||document}get _ownerWindow(){var o,d;return((d=(o=this._el)===null||o===void 0?void 0:o.ownerDocument)===null||d===void 0?void 0:d.defaultView)||window}constructor(o,d){this.handleWindowEvent=x=>{this.handleEvent(x,`${x.type}Window`)},this.handleEvent=(x,T)=>{if(x.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const D=x.type==="renderFrame"?void 0:x,N={needsRenderFrame:!1},V={},Z={};for(const{handlerName:le,handler:ge,allowed:be}of this._handlers){if(!ge.isEnabled())continue;let ze;if(this._blockedByActive(Z,be,le))ge.reset();else if(ge[T||x.type]){if(s.cA(x,T||x.type)){const $e=P.mousePos(this._map.getCanvas(),x);ze=ge[T||x.type](x,$e)}else if(s.cB(x,T||x.type)){const $e=this._getMapTouches(x.touches),Ne=P.touchPos(this._map.getCanvas(),$e);ze=ge[T||x.type](x,Ne,$e)}else s.cC(T||x.type)||(ze=ge[T||x.type](x));this.mergeHandlerResult(N,V,ze,le,D),ze&&ze.needsRenderFrame&&this._triggerRenderFrame()}(ze||ge.isActive())&&(Z[le]=ge)}const Q={};for(const le in this._previousActiveHandlers)Z[le]||(Q[le]=D);this._previousActiveHandlers=Z,(Object.keys(Q).length||Nd(N))&&(this._changes.push([N,V,Q]),this._triggerRenderFrame()),(Object.keys(Z).length||Nd(N))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ce}=N;ce&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ce(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new a0(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[this._ownerDocument,"mousemove",{capture:!0}],[this._ownerDocument,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[this._ownerWindow,"blur",void 0]];for(const[x,T,D]of this._listeners)P.addEventListener(x,T,x===this._ownerDocument?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[o,d,g]of this._listeners)P.removeEventListener(o,d,o===this._ownerDocument?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(o){const d=this._map,g=d.getCanvasContainer();this._add("mapEvent",new aa(d,o));const x=d.boxZoom=new ws(d,o);this._add("boxZoom",x),o.interactive&&o.boxZoom&&x.enable();const T=d.cooperativeGestures=new Vn(d,o.cooperativeGestures);this._add("cooperativeGestures",T),o.cooperativeGestures&&T.enable();const D=new zd(d),N=new ep(d);d.doubleClickZoom=new Fc(N,D),this._add("tapZoom",D),this._add("clickZoom",N),o.interactive&&o.doubleClickZoom&&d.doubleClickZoom.enable();const V=new tp;this._add("tapDragZoom",V);const Z=d.touchPitch=new Fd(d);this._add("touchPitch",Z),o.interactive&&o.touchPitch&&d.touchPitch.enable(o.touchPitch);const Q=()=>d.project(d.getCenter()),ce=function({enable:Xe,clickTolerance:rt,aroundCenter:ht=!0,minPixelCenterThreshold:Qe=100,rotateDegreesPerPixelMoved:yt=.8},Ot){const Pt=new ls({checkCorrectEvent:It=>P.mouseButton(It)===0&&It.ctrlKey||P.mouseButton(It)===2&&!It.ctrlKey});return new kc({clickTolerance:rt,move:(It,Dt)=>{const gn=Ot();if(ht&&Math.abs(gn.y-It.y)>Qe)return{bearingDelta:s.cy(new s.P(It.x,Dt.y),Dt,gn)};let xn=(Dt.x-It.x)*yt;return ht&&Dt.y<gn.y&&(xn=-xn),{bearingDelta:xn}},moveStateManager:Pt,enable:Xe,assignEvents:zc})}(o,Q),le=function({enable:Xe,clickTolerance:rt,pitchDegreesPerPixelMoved:ht=-.5}){const Qe=new ls({checkCorrectEvent:yt=>P.mouseButton(yt)===0&&yt.ctrlKey||P.mouseButton(yt)===2});return new kc({clickTolerance:rt,move:(yt,Ot)=>({pitchDelta:(Ot.y-yt.y)*ht}),moveStateManager:Qe,enable:Xe,assignEvents:zc})}(o),ge=function({enable:Xe,clickTolerance:rt,rollDegreesPerPixelMoved:ht=.3},Qe){const yt=new ls({checkCorrectEvent:Ot=>P.mouseButton(Ot)===2&&Ot.ctrlKey});return new kc({clickTolerance:rt,move:(Ot,Pt)=>{const It=Qe();let Dt=(Pt.x-Ot.x)*ht;return Pt.y<It.y&&(Dt=-Dt),{rollDelta:Dt}},moveStateManager:yt,enable:Xe,assignEvents:zc})}(o,Q);d.dragRotate=new Vs(o,ce,le,ge),this._add("mouseRotate",ce,["mousePitch"]),this._add("mousePitch",le,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ge,["mousePitch"]),o.interactive&&o.dragRotate&&d.dragRotate.enable();const be=function({enable:Xe,clickTolerance:rt}){const ht=new ls({checkCorrectEvent:Qe=>P.mouseButton(Qe)===0&&!Qe.ctrlKey});return new kc({clickTolerance:rt,move:(Qe,yt)=>({around:yt,panDelta:yt.sub(Qe)}),activateOnStart:!0,moveStateManager:ht,enable:Xe,assignEvents:zc})}(o),ze=new Fm(o,d);d.dragPan=new np(g,be,ze),this._add("mousePan",be),this._add("touchPan",ze,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&d.dragPan.enable(o.dragPan);const $e=new Bm,Ne=new Oc;d.touchZoomRotate=new tl(g,Ne,$e,V),this._add("touchRotate",$e,["touchPan","touchZoom"]),this._add("touchZoom",Ne,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&d.touchZoomRotate.enable(o.touchZoomRotate),this._add("blockableMapEvent",new la(d));const qe=d.scrollZoom=new Ru(d,()=>this._triggerRenderFrame());this._add("scrollZoom",qe,["mousePan"]),o.interactive&&o.scrollZoom&&d.scrollZoom.enable(o.scrollZoom);const it=d.keyboard=new Jr(d);this._add("keyboard",it),o.interactive&&o.keyboard&&d.keyboard.enable()}_add(o,d,g){this._handlers.push({handlerName:o,handler:d,allowed:g}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!rr(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,d,g){for(const x in o)if(x!==g&&(!d||d.indexOf(x)<0))return!0;return!1}_getMapTouches(o){const d=[];for(const g of o)this._el.contains(g.target)&&d.push(g);return d}mergeHandlerResult(o,d,g,x,T){if(!g)return;s.e(o,g);const D={handlerName:x,originalEvent:g.originalEvent||T};g.zoomDelta!==void 0&&(d.zoom=D),g.panDelta!==void 0&&(d.drag=D),g.rollDelta!==void 0&&(d.roll=D),g.pitchDelta!==void 0&&(d.pitch=D),g.bearingDelta!==void 0&&(d.rotate=D)}_applyChanges(){const o={},d={},g={};for(const[x,T,D]of this._changes)x.panDelta&&(o.panDelta=(o.panDelta||new s.P(0,0))._add(x.panDelta)),x.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+x.pitchDelta),x.rollDelta&&(o.rollDelta=(o.rollDelta||0)+x.rollDelta),x.around!==void 0&&(o.around=x.around),x.pinchAround!==void 0&&(o.pinchAround=x.pinchAround),x.noInertia&&(o.noInertia=x.noInertia),s.e(d,T),s.e(g,D);this._updateMapTransform(o,d,g),this._changes=[]}_updateMapTransform(o,d,g){const x=this._map,T=x._getTransformForUpdate(),D=x.terrain;if(!(Nd(o)||D&&this._terrainMovement))return this._fireEvents(d,g,!0);x._stop(!0);let{panDelta:N,zoomDelta:V,bearingDelta:Z,pitchDelta:Q,rollDelta:ce,around:le,pinchAround:ge}=o;ge!==void 0&&(le=ge),le=le||x.transform.centerPoint,D&&!T.isPointOnMapSurface(le)&&(le=T.centerPoint);const be={panDelta:N,zoomDelta:V,rollDelta:ce,pitchDelta:Q,bearingDelta:Z,around:le};this._map.cameraHelper.useGlobeControls&&!T.isPointOnMapSurface(le)&&(le=T.centerPoint);const ze=le.distSqr(T.centerPoint)<.01?T.center:T.screenPointToLocation(N?le.sub(N):le);this._handleMapControls({terrain:D,tr:T,deltasForHelper:be,preZoomAroundLoc:ze,combinedEventsInProgress:d,panDelta:N}),x._applyUpdatedTransform(T),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,g,!0)}_handleMapControls({terrain:o,tr:d,deltasForHelper:g,preZoomAroundLoc:x,combinedEventsInProgress:T,panDelta:D}){const N=this._map.cameraHelper;if(N.handleMapControlsRollPitchBearingZoom(g,d),o)return N.useGlobeControls?(this._terrainMovement||!T.drag&&!T.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void N.handleMapControlsPan(g,d,x)):this._terrainMovement||!T.drag&&!T.zoom?void(T.drag&&this._terrainMovement&&D?d.setCenter(d.screenPointToLocation(d.centerPoint.sub(D))):N.handleMapControlsPan(g,d,x)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void N.handleMapControlsPan(g,d,x));N.handleMapControlsPan(g,d,x)}_fireEvents(o,d,g){const x=rr(this._eventsInProgress),T=rr(o),D={};for(const ce in o){const{originalEvent:le}=o[ce];this._eventsInProgress[ce]||(D[`${ce}start`]=le),this._eventsInProgress[ce]=o[ce]}!x&&T&&this._fireEvent("movestart",T.originalEvent);for(const ce in D)this._fireEvent(ce,D[ce]);T&&this._fireEvent("move",T.originalEvent);for(const ce in o){const{originalEvent:le}=o[ce];this._fireEvent(ce,le)}const N={};let V;for(const ce in this._eventsInProgress){const{handlerName:le,originalEvent:ge}=this._eventsInProgress[ce];this._handlersById[le].isActive()||(delete this._eventsInProgress[ce],V=d[le]||ge,N[`${ce}end`]=V)}for(const ce in N)this._fireEvent(ce,N[ce]);const Z=rr(this._eventsInProgress),Q=(x||T)&&!Z;if(Q&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const ce=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&ce.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(ce)}if(g&&Q){this._updatingCamera=!0;const ce=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),le=ge=>ge!==0&&-this._bearingSnap<ge&&ge<this._bearingSnap;!ce||!ce.essential&&A.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:V})),le(this._map.getBearing())&&this._map.resetNorth()):(le(ce.bearing||this._map.getBearing())&&(ce.bearing=0),ce.freezeElevation=!0,this._map.easeTo(ce,{originalEvent:V})),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new s.l(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Du("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Wi extends s.E{constructor(o,d,g){super(),this._renderFrameCallback=()=>{const x=Math.min((z()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=g.bearingSnap,this._zoomSnap=g.zoomSnap,this.cameraHelper=d,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(o,d){o.apply(this.transform,!0),this.transform=o,this.cameraHelper=d}getCenter(){return new s.V(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}getCenterElevation(){return this.transform.elevation}setCenterElevation(o,d){return this.jumpTo({elevation:o},d),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(o){this._centerClampedToGround=o}panBy(o,d,g){return o=s.P.convert(o).mult(-1),this.panTo(this.transform.center,s.e({offset:o},d),g)}panTo(o,d,g){return this.easeTo(s.e({center:o},d),g)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,g){return this.easeTo(s.e({zoom:o},d),g)}zoomIn(o,d){return this.zoomTo(s.cx(this.getZoom()+1,this._zoomSnap),o,d),this}zoomOut(o,d){return this.zoomTo(s.cx(this.getZoom()-1,this._zoomSnap),o,d),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(o,d){return o!=this.transform.fov&&(this.transform.setFov(o),this.fire(new s.l("movestart",d)).fire(new s.l("move",d)).fire(new s.l("moveend",d))),this}getBearing(){return this.transform.bearing}setZoomSnap(o){return this._zoomSnap=o,this}getZoomSnap(){return this._zoomSnap}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,g){return this.easeTo(s.e({bearing:o},d),g)}resetNorth(o,d){return this.rotateTo(0,s.e({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}getRoll(){return this.transform.roll}setRoll(o,d){return this.jumpTo({roll:o},d),this}cameraForBounds(o,d){o=on.convert(o).adjustAntiMeridian();const g=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),g,d)}_cameraForBoxAndBearing(o,d,g,x){const T={top:0,bottom:0,right:0,left:0};if(typeof(x=s.e({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},x)).padding=="number"){const Z=x.padding;x.padding={top:Z,bottom:Z,right:Z,left:Z}}const D=s.e(T,x.padding);x.padding=D;const N=this.transform,V=new on(o,d);return this.cameraHelper.cameraForBoxAndBearing(x,D,V,g,N)}fitBounds(o,d,g){return this._fitInternal(this.cameraForBounds(o,d),d,g)}fitScreenCoordinates(o,d,g,x,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(o)),this.transform.screenPointToLocation(s.P.convert(d)),g,x),x,T)}_fitInternal(o,d,g){return o?(delete(d=s.e(o,d)).padding,d.linear?this.easeTo(d,g):this.flyTo(d,g)):this}jumpTo(o,d){this.stop();const g=this._getTransformForUpdate();let x=!1,T=!1,D=!1;const N=g.zoom;this.cameraHelper.handleJumpToCenterZoom(g,o);const V=g.zoom!==N;return"elevation"in o&&g.elevation!==+o.elevation&&g.setElevation(+o.elevation),"bearing"in o&&g.bearing!==+o.bearing&&(x=!0,g.setBearing(+o.bearing)),"pitch"in o&&g.pitch!==+o.pitch&&(T=!0,g.setPitch(+o.pitch)),"roll"in o&&g.roll!==+o.roll&&(D=!0,g.setRoll(+o.roll)),o.padding==null||g.isPaddingEqual(o.padding)||g.setPadding(o.padding),this._applyUpdatedTransform(g),this.fire(new s.l("movestart",d)).fire(new s.l("move",d)),V&&this.fire(new s.l("zoomstart",d)).fire(new s.l("zoom",d)).fire(new s.l("zoomend",d)),x&&this.fire(new s.l("rotatestart",d)).fire(new s.l("rotate",d)).fire(new s.l("rotateend",d)),T&&this.fire(new s.l("pitchstart",d)).fire(new s.l("pitch",d)).fire(new s.l("pitchend",d)),D&&this.fire(new s.l("rollstart",d)).fire(new s.l("roll",d)).fire(new s.l("rollend",d)),this.fire(new s.l("moveend",d))}calculateCameraOptionsFromTo(o,d,g,x=0){const T=s.a9.fromLngLat(o,d),D=s.a9.fromLngLat(g,x),N=D.x-T.x,V=D.y-T.y,Z=D.z-T.z,Q=Math.hypot(N,V,Z);if(Q===0)throw new Error("Can't calculate camera options with same From and To");const ce=Math.hypot(N,V),le=s.at(this.transform.cameraToCenterDistance/Q/this.transform.tileSize),ge=180*Math.atan2(N,-V)/Math.PI;let be=180*Math.acos(ce/Q)/Math.PI;return be=Z<0?90-be:90+be,{center:D.toLngLat(),elevation:x,zoom:le,pitch:be,bearing:ge}}calculateCameraOptionsFromCameraLngLatAltRotation(o,d,g,x,T){const D=this.transform.calculateCenterFromCameraLngLatAlt(o,d,g,x);return{center:D.center,elevation:D.elevation,zoom:D.zoom,bearing:g,pitch:x,roll:T}}easeTo(o,d){this._stop(!1,o.easeId),((o=s.e({offset:[0,0],duration:500,easing:s.cz},o)).animate===!1||!o.essential&&A.prefersReducedMotion)&&(o.duration=0);const g=this._getTransformForUpdate(),x=this.getBearing(),T=g.pitch,D=g.roll,N="bearing"in o?this._normalizeBearing(o.bearing,x):x,V="pitch"in o?+o.pitch:T,Z="roll"in o?this._normalizeBearing(o.roll,D):D,Q="padding"in o?o.padding:g.padding,ce=s.P.convert(o.offset);let le,ge;o.around&&(le=s.V.convert(o.around),ge=g.locationToScreenPoint(le));const be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ze=this.cameraHelper.handleEaseTo(g,{bearing:N,pitch:V,roll:Z,padding:Q,around:le,aroundPoint:ge,offsetAsPoint:ce,offset:o.offset,zoom:o.zoom,center:o.center});return this._rotating=this._rotating||x!==N,this._pitching=this._pitching||V!==T,this._rolling=this._rolling||Z!==D,this._padding=!g.isPaddingEqual(Q),this._zooming=this._zooming||ze.isZooming,this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,be),this.terrain&&this._prepareElevation(ze.elevationCenter),this._ease($e=>{ze.easeFunc($e),this.terrain&&!o.freezeElevation&&this._updateElevation($e),this._applyUpdatedTransform(g),this._fireMoveEvents(d)},$e=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(d,$e)},o),this}_prepareEase(o,d,g={}){this._moving=!0,d||g.moving||this.fire(new s.l("movestart",o)),this._zooming&&!g.zooming&&this.fire(new s.l("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new s.l("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new s.l("pitchstart",o)),this._rolling&&!g.rolling&&this.fire(new s.l("rollstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&d!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(g-(d-(g*o+this._elevationStart))/(1-o)),this._elevationTarget=d}this.transform.setElevation(s.G.number(this._elevationStart,this._elevationTarget,o))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){if(!this.terrain&&o.elevation>=0&&o.pitch<=90)return{};const d=o.getCameraLngLat(),g=o.getCameraAltitude(),x=this.terrain?this.terrain.getElevationForLngLatZoom(d,o.zoom):0;if(g<x){const T=this.calculateCameraOptionsFromTo(d,x,o.center,o.elevation);return{pitch:T.pitch,zoom:T.zoom}}return{}}_applyUpdatedTransform(o){const d=[];if(d.push(x=>this._elevateCameraIfInsideTerrain(x)),this.transformCameraUpdate&&d.push(x=>this.transformCameraUpdate(x)),!d.length)return;const g=o.clone();for(const x of d){const T=g.clone(),{center:D,zoom:N,roll:V,pitch:Z,bearing:Q,elevation:ce}=x(T);D&&T.setCenter(D),ce!==void 0&&T.setElevation(ce),N!==void 0&&T.setZoom(N),V!==void 0&&T.setRoll(V),Z!==void 0&&T.setPitch(Z),Q!==void 0&&T.setBearing(Q),g.apply(T,!1)}this.transform.apply(g,!1)}_fireMoveEvents(o){this.fire(new s.l("move",o)),this._zooming&&this.fire(new s.l("zoom",o)),this._rotating&&this.fire(new s.l("rotate",o)),this._pitching&&this.fire(new s.l("pitch",o)),this._rolling&&this.fire(new s.l("roll",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const g=this._zooming,x=this._rotating,T=this._pitching,D=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,g&&this.fire(new s.l("zoomend",o)),x&&this.fire(new s.l("rotateend",o)),T&&this.fire(new s.l("pitchend",o)),D&&this.fire(new s.l("rollend",o)),this.fire(new s.l("moveend",o))}flyTo(o,d){if(!o.essential&&A.prefersReducedMotion){const Dt=s.U(o,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Dt,d)}this.stop(),o=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cz},o);const g=this._getTransformForUpdate(),x=g.bearing,T=g.pitch,D=g.roll,N=g.padding,V="bearing"in o?this._normalizeBearing(o.bearing,x):x,Z="pitch"in o?+o.pitch:T,Q="roll"in o?this._normalizeBearing(o.roll,D):D,ce="padding"in o?o.padding:g.padding,le=s.P.convert(o.offset);let ge=g.centerPoint.add(le);const be=g.screenPointToLocation(ge),ze=this.cameraHelper.handleFlyTo(g,{bearing:V,pitch:Z,roll:Q,padding:ce,locationAtOffset:be,offsetAsPoint:le,center:o.center,minZoom:o.minZoom,zoom:o.zoom});let $e=o.curve;const Ne=Math.max(g.width,g.height),qe=Ne/ze.scaleOfZoom,it=ze.pixelPathLength;typeof ze.scaleOfMinZoom=="number"&&($e=Math.sqrt(Ne/ze.scaleOfMinZoom/it*2));const Xe=$e*$e;function rt(Dt){const gn=(qe*qe-Ne*Ne+(Dt?-1:1)*Xe*Xe*it*it)/(2*(Dt?qe:Ne)*Xe*it);return Math.log(Math.sqrt(gn*gn+1)-gn)}function ht(Dt){return(Math.exp(Dt)-Math.exp(-Dt))/2}function Qe(Dt){return(Math.exp(Dt)+Math.exp(-Dt))/2}const yt=rt(!1);let Ot=function(Dt){return Qe(yt)/Qe(yt+$e*Dt)},Pt=function(Dt){return Ne*((Qe(yt)*(ht(gn=yt+$e*Dt)/Qe(gn))-ht(yt))/Xe)/it;var gn},It=(rt(!0)-yt)/$e;if(Math.abs(it)<2e-6||!isFinite(It)){if(Math.abs(Ne-qe)<1e-6)return this.easeTo(o,d);const Dt=qe<Ne?-1:1;It=Math.abs(Math.log(qe/Ne))/$e,Pt=()=>0,Ot=gn=>Math.exp(Dt*$e*gn)}return o.duration="duration"in o?+o.duration:1e3*It/("screenSpeed"in o?+o.screenSpeed/$e:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=x!==V,this._pitching=Z!==T,this._rolling=Q!==D,this._padding=!g.isPaddingEqual(ce),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(ze.targetCenter),this._ease(Dt=>{const gn=Dt*It,xn=1/Ot(gn),tn=Pt(gn);this._rotating&&g.setBearing(s.G.number(x,V,Dt)),this._pitching&&g.setPitch(s.G.number(T,Z,Dt)),this._rolling&&g.setRoll(s.G.number(D,Q,Dt)),this._padding&&(g.interpolatePadding(N,ce,Dt),ge=g.centerPoint.add(le)),ze.easeFunc(Dt,xn,tn,ge),this.terrain&&!o.freezeElevation&&this._updateElevation(Dt),this._applyUpdatedTransform(g),this._fireMoveEvents(d)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(d)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const x=this._onEaseEnd;delete this._onEaseEnd,x.call(this,d)}return o||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(o,d,g){g.animate===!1||g.duration===0?(o(1),d()):(this._easeStart=z(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,d){o=s.W(o,-180,180);const g=Math.abs(o-d);return Math.abs(o-360-d)<g&&(o-=360),Math.abs(o+360-d)<g&&(o+=360),o}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLat(s.V.convert(o),this.transform):null}}const Ss={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class rp{constructor(o=Ss){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=P.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=P.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=P.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){P.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const g=this._map._getUIString(`AttributionControl.${d}`);o.title=g,o.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(x=>typeof x!="string"?"":x)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const d=this._map.style.tileManagers;for(const x in d){const T=d[x];if(T.used||T.usedForTerrain){const D=T.getSource();D.attribution&&o.indexOf(D.attribution)<0&&o.push(D.attribution)}}o=o.filter(x=>String(x).trim()),o.sort((x,T)=>x.length-T.length),o=o.filter((x,T)=>{for(let D=T+1;D<o.length;D++)if(o[D].indexOf(x)>=0)return!1;return!0});const g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=P.sanitize(g),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class nl{constructor(o={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const g=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=P.create("div","maplibregl-ctrl");const d=P.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){P.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Nc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,g=d?this._queue.concat(d):this._queue;for(const x of g)if(x.id===o)return void(x.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const g of d)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ip=s.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Th extends s.E{constructor(o){super(),this._lastTilesetChange=z(),this.tileManager=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=o._source.tileSize*2**this.deltaZoom,o.usedForTerrain=!0,o.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(o,d){this.tileManager.update(o,d),this._renderableTilesKeys=[];const g={};for(const x of yr(o,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d,calculateTileZoom:this.tileManager._source.calculateTileZoom}))g[x.key]=!0,this._renderableTilesKeys.push(x.key),this._tiles[x.key]||(x.terrainRttPosMatrix32f=new Float64Array(16),s.c7(x.terrainRttPosMatrix32f,0,s.a5,s.a5,0,0,1),this._tiles[x.key]=new xe(x,this.tileSize),this._lastTilesetChange=z());for(const x in this._tiles)g[x]||delete this._tiles[x]}freeRtt(o){for(const d in this._tiles){const g=this._tiles[d];(!o||g.tileID.equals(o)||g.tileID.isChildOf(o)||o.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o,d){return d?this._getTerrainCoordsForTileRanges(o,d):this._getTerrainCoordsForRegularTile(o)}_getTerrainCoordsForRegularTile(o){const d={};for(const g of this._renderableTilesKeys){const x=this._tiles[g].tileID,T=o.clone(),D=s.bk();if(x.canonical.equals(o.canonical))s.c7(D,0,s.a5,s.a5,0,0,1);else if(x.canonical.isChildOf(o.canonical)){const N=x.canonical.z-o.canonical.z,V=x.canonical.x-(x.canonical.x>>N<<N),Z=x.canonical.y-(x.canonical.y>>N<<N),Q=s.a5>>N;s.c7(D,0,Q,Q,0,0,1),s.O(D,D,[-V*Q,-Z*Q,0])}else{if(!o.canonical.isChildOf(x.canonical))continue;{const N=o.canonical.z-x.canonical.z,V=o.canonical.x-(o.canonical.x>>N<<N),Z=o.canonical.y-(o.canonical.y>>N<<N),Q=s.a5>>N;s.c7(D,0,s.a5,s.a5,0,0,1),s.O(D,D,[V*Q,Z*Q,0]),s.Q(D,D,[1/2**N,1/2**N,0])}}T.terrainRttPosMatrix32f=new Float32Array(D),d[g]=T}return d}_getTerrainCoordsForTileRanges(o,d){const g={};for(const x of this._renderableTilesKeys){const T=this._tiles[x].tileID;if(!this._isWithinTileRanges(T,d))continue;const D=o.clone(),N=s.bk();if(T.canonical.z===o.canonical.z){const V=o.canonical.x-T.canonical.x+o.wrap*(1<<o.canonical.z),Z=o.canonical.y-T.canonical.y;s.c7(N,0,s.a5,s.a5,0,0,1),s.O(N,N,[V*s.a5,Z*s.a5,0])}else if(T.canonical.z>o.canonical.z){const V=T.canonical.z-o.canonical.z,Z=T.canonical.x-(T.canonical.x>>V<<V)+o.wrap*(1<<T.canonical.z),Q=T.canonical.y-(T.canonical.y>>V<<V),ce=o.canonical.x-(T.canonical.x>>V),le=o.canonical.y-(T.canonical.y>>V),ge=s.a5>>V;s.c7(N,0,ge,ge,0,0,1),s.O(N,N,[-Z*ge+ce*s.a5,-Q*ge+le*s.a5,0])}else{const V=o.canonical.z-T.canonical.z,Z=o.canonical.x-(o.canonical.x>>V<<V)+o.wrap*(1<<o.canonical.z),Q=o.canonical.y-(o.canonical.y>>V<<V),ce=(o.canonical.x>>V)-T.canonical.x,le=(o.canonical.y>>V)-T.canonical.y,ge=s.a5<<V;s.c7(N,0,ge,ge,0,0,1),s.O(N,N,[Z*s.a5+ce*ge,Q*s.a5+le*ge,0])}D.terrainRttPosMatrix32f=new Float32Array(N),g[x]=D}return g}getSourceTile(o,d){const g=this.tileManager._source;let x=o.overscaledZ-this.deltaZoom;if(x>g.maxzoom&&(x=g.maxzoom),x<g.minzoom)return;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(x).key);let T=this.findTileInCaches(this._sourceTileCache[o.key]);if(!T?.dem&&d)for(;x>=g.minzoom&&!T?.dem;)T=this.findTileInCaches(o.scaledTo(x--).key);return T}findTileInCaches(o){let d=this.tileManager.getTileByID(o);return d||(d=this.tileManager._outOfViewCache.getByKey(o),d)}anyTilesAfterTime(o=Date.now()){return this._lastTilesetChange>=o}_isWithinTileRanges(o,d){const g=d[o.canonical.z];return!!g&&(o.wrap>g.minWrap||o.wrap<g.maxWrap||o.canonical.x>=g.minTileXWrapped&&o.canonical.x<=g.maxTileXWrapped&&o.canonical.y>=g.minTileY&&o.canonical.y<=g.maxTileY)}}class ci{constructor(o,d,g){this._meshCache={},this.painter=o,this.tileManager=new Th(d),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,d,g,x=s.a5){var T;const D=o.normalizeCoordinates(d,g,x);if(!D)return 0;const N=this.getTerrainData(D.tileID),V=(T=N.tile)===null||T===void 0?void 0:T.dem;if(!V)return 0;const Z=s.cD([],[D.x/x*s.a5,D.y/x*s.a5],N.u_terrain_matrix),Q=[Z[0]*V.dim,Z[1]*V.dim],ce=Math.floor(Q[0]),le=Math.floor(Q[1]),ge=Q[0]-ce,be=Q[1]-le;return V.get(ce,le)*(1-ge)*(1-be)+V.get(ce+1,le)*ge*(1-be)+V.get(ce,le+1)*(1-ge)*be+V.get(ce+1,le+1)*ge*be}getElevationForLngLatZoom(o,d){if(!s.cE(d,o.wrap()))return 0;const{tileID:g,mercatorX:x,mercatorY:T}=this._getOverscaledTileIDFromLngLatZoom(o,d);return this.getElevation(g,x%s.a5,T%s.a5,s.a5)}getElevationForLngLat(o,d){const g=yr(d,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let x=0;for(const T of g)T.canonical.z>x&&(x=Math.min(T.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(o,x)}getElevation(o,d,g,x=s.a5){return this.getDEMElevation(o,d,g,x)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const x=this.painter.context,T=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(x,T,x.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(x,new s.R({width:1,height:1}),x.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ar([])}const d=this.tileManager.getSourceTile(o,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const x=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new s.T(x,d.dem.getPixels(),x.gl.RGBA,{premultiply:!1}),d.demTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const g=d&&d.toString()+d.tileID.key+o.key;if(g&&!this._demMatrixCache[g]){const x=this.tileManager.getSource().maxzoom;let T=o.canonical.z-d.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=x?T=o.canonical.z-x:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const D=o.canonical.x-(o.canonical.x>>T<<T),N=o.canonical.y-(o.canonical.y>>T<<T),V=s.cF(new Float64Array(16),[1/(s.a5<<T),1/(s.a5<<T),0]);s.O(V,V,[D*s.a5,N*s.a5,0]),this._demMatrixCache[o.key]={matrix:V,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(o){const d=this.painter,g=d.width/devicePixelRatio,x=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===x||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(d.context,{width:g,height:x,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(d.context,{width:g,height:x,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(g,x,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,g,x))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let T=0,D=0;T<this._coordsTextureSize;T++)for(let N=0;N<this._coordsTextureSize;N++,D+=4)d[D+0]=255&N,d[D+1]=255&T,d[D+2]=N>>8<<4|T>>8,d[D+3]=0;const g=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),x=new s.T(o,g,o.gl.RGBA,{premultiply:!1});return x.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=x,x}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),g=this.painter.context,x=g.gl,T=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),D=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),N=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),x.readPixels(T,N-D-1,1,1,x.RGBA,x.UNSIGNED_BYTE,d),g.bindFramebuffer.set(null);const V=d[0]+(d[2]>>4<<8),Z=d[1]+((15&d[2])<<8),Q=this.coordsIndex[255-d[3]],ce=Q&&this.tileManager.getTileByID(Q);if(!ce)return null;const le=this._coordsTextureSize,ge=(1<<ce.tileID.canonical.z)*le;return new s.a9((ce.tileID.canonical.x*le+V)/ge+ce.tileID.wrap,(ce.tileID.canonical.y*le+Z)/ge,this.getElevation(ce.tileID,V,Z,le))}depthAtPoint(o){const d=new Uint8Array(4),g=this.painter.context,x=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),x.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,x.RGBA,x.UNSIGNED_BYTE,d),g.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(o){var d;const g=((d=this.painter.style.projection)===null||d===void 0?void 0:d.transitionState)>0,x=g&&o.canonical.y===0,T=g&&o.canonical.y===(1<<o.canonical.z)-1,D=`m_${x?"n":""}_${T?"s":""}`;if(this._meshCache[D])return this._meshCache[D];const N=this.painter.context,V=new s.cG,Z=new s.aY,Q=this.meshSize,ce=s.a5/Q,le=Q*Q;for(let Qe=0;Qe<=Q;Qe++)for(let yt=0;yt<=Q;yt++)V.emplaceBack(yt*ce,Qe*ce,0);for(let Qe=0;Qe<le;Qe+=Q+1)for(let yt=0;yt<Q;yt++)Z.emplaceBack(yt+Qe,Q+yt+Qe+1,Q+yt+Qe+2),Z.emplaceBack(yt+Qe,Q+yt+Qe+2,yt+Qe+1);const ge=V.length,be=ge+(Q+1),ze=(Q+1)*Q,$e=x?s.br:0,Ne=x?0:1,qe=T?s.bs:s.a5,it=T?0:1;for(let Qe=0;Qe<=Q;Qe++)V.emplaceBack(Qe*ce,$e,Ne);for(let Qe=0;Qe<=Q;Qe++)V.emplaceBack(Qe*ce,qe,it);for(let Qe=0;Qe<Q;Qe++)Z.emplaceBack(ze+Qe,be+Qe,be+Qe+1),Z.emplaceBack(ze+Qe,be+Qe+1,ze+Qe+1),Z.emplaceBack(0+Qe,ge+Qe+1,ge+Qe),Z.emplaceBack(0+Qe,0+Qe+1,ge+Qe+1);const Xe=V.length,rt=Xe+2*(Q+1);for(const Qe of[0,1])for(let yt=0;yt<=Q;yt++)for(const Ot of[0,1])V.emplaceBack(Qe*s.a5,yt*ce,Ot);for(let Qe=0;Qe<2*Q;Qe+=2)Z.emplaceBack(Xe+Qe,Xe+Qe+1,Xe+Qe+3),Z.emplaceBack(Xe+Qe,Xe+Qe+3,Xe+Qe+2),Z.emplaceBack(rt+Qe,rt+Qe+3,rt+Qe+1),Z.emplaceBack(rt+Qe,rt+Qe+2,rt+Qe+3);const ht=new ti(N.createVertexBuffer(V,ip.members),N.createIndexBuffer(Z),s.aX.simpleSegment(0,0,V.length,Z.length));return this._meshCache[D]=ht,ht}getMeshFrameDelta(o){return 2*Math.PI*s.bE/Math.pow(2,Math.max(o,0))/5}getMinTileElevationForLngLatZoom(o,d){var g;if(!s.cE(d,o.wrap()))return 0;const{tileID:x}=this._getOverscaledTileIDFromLngLatZoom(o,d);return(g=this.getMinMaxElevation(x).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(o){const d=this.getTerrainData(o).tile,g={minElevation:null,maxElevation:null};return d&&d.dem&&(g.minElevation=d.dem.min*this.exaggeration,g.maxElevation=d.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(o,d){const g=s.a9.fromLngLat(o.wrap()),x=(1<<d)*s.a5,T=g.x*x,D=g.y*x,N=Math.floor(T/s.a5),V=Math.floor(D/s.a5);return{tileID:new s.a2(d,0,d,N,V),mercatorX:T,mercatorY:D}}}class Vi{constructor(o,d,g){this._context=o,this._size=d,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(g.texture),{id:o,fbo:d,texture:g,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>o.id!==d),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const za={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ms{constructor(o,d){this.painter=o,this.terrain=d,this.pool=new Vi(o.context,30,d.tileManager.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,d){var g,x;this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=o._order.filter(T=>!o._layers[T].isHidden(d)),this._coordsAscending={};for(const T in o.tileManagers){this._coordsAscending[T]={};const D=o.tileManagers[T].getVisibleCoordinates(),N=o.tileManagers[T].getSource(),V=N instanceof jt?N.terrainTileRanges:null;for(const Z of D){const Q=this.terrain.tileManager.getTerrainCoords(Z,V);for(const ce in Q)this._coordsAscending[T][ce]||(this._coordsAscending[T][ce]=[]),this._coordsAscending[T][ce].push(Q[ce])}}this._rttFingerprints={};for(const T of o._order){const D=o._layers[T],N=D.source;if(za[D.type]&&!this._rttFingerprints[N]){this._rttFingerprints[N]={};const V=(x=(g=o.tileManagers[N])===null||g===void 0?void 0:g.getState().revision)!==null&&x!==void 0?x:0;for(const Z in this._coordsAscending[N])this._rttFingerprints[N][Z]=`${this._coordsAscending[N][Z].map(Q=>Q.key).sort().join()}#${V}`}}for(const T of this._renderableTiles)for(const D in this._rttFingerprints){const N=this._rttFingerprints[D][T.tileID.key];N&&N!==T.rttFingerprint[D]&&(T.rtt=[])}}renderLayer(o,d){if(o.isHidden(this.painter.transform.zoom))return!1;const g=Object.assign(Object.assign({},d),{isRenderingToTexture:!0}),x=o.type,T=this.painter,D=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(za[x]&&(this._prevType&&za[this._prevType]||this._stacks.push([]),this._prevType=x,this._stacks[this._stacks.length-1].push(o.id),!D))return!0;if(za[this._prevType]||za[x]&&D){this._prevType=x;const N=this._stacks.length-1,V=this._stacks[N]||[];for(const Z of this._renderableTiles){if(this.pool.isFull()&&(Dc(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(Z),Z.rtt[N]){const ce=this.pool.getObjectForId(Z.rtt[N].id);if(ce.stamp===Z.rtt[N].stamp){this.pool.useObject(ce);continue}}const Q=this.pool.getOrCreateFreeObject();this.pool.useObject(Q),this.pool.stampObject(Q),Z.rtt[N]={id:Q.id,stamp:Q.stamp},T.context.bindFramebuffer.set(Q.fbo.framebuffer),T.context.clear({color:s.bp.transparent,stencil:0}),T.currentStencilSource=void 0;for(let ce=0;ce<V.length;ce++){const le=T.style._layers[V[ce]],ge=le.source?this._coordsAscending[le.source][Z.tileID.key]:[Z.tileID];T.context.viewport.set([0,0,Q.fbo.width,Q.fbo.height]),T._renderTileClippingMasks(le,ge,!0),T.renderLayer(T,T.style.tileManagers[le.source],le,ge,g),le.source&&(Z.rttFingerprint[le.source]=this._rttFingerprints[le.source][Z.tileID.key])}}return Dc(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects(),za[x]}return!1}}const Bc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Drag to rotate map, click to reset north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Lu=m,rl={hash:!1,interactive:!0,bearingSnap:7,zoomSnap:0,attributionControl:Ss,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Bd={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class il{constructor(o,d,g=!1){this.mousedown=T=>{this.startMove(T,P.mousePos(this.element,T)),P.addEventListener(window,"mousemove",this.mousemove),P.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.move(T,P.mousePos(this.element,T))},this.mouseup=T=>{this._rotatePitchHandler.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=P.touchPos(this.element,T.targetTouches)[0],this.startMove(T,this._startPos),P.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),P.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=P.touchPos(this.element,T.targetTouches)[0],this.move(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=d;const x=new Om;this._rotatePitchHandler=new kc({clickTolerance:3,move:(T,D)=>{const N=d.getBoundingClientRect(),V=new s.P((N.bottom-N.top)/2,(N.right-N.left)/2);return{bearingDelta:s.cy(new s.P(T.x,D.y),D,V),pitchDelta:g?-.5*(D.y-T.y):void 0}},moveStateManager:x,enable:!0,assignEvents:()=>{}}),this.map=o,P.addEventListener(d,"mousedown",this.mousedown),P.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),P.addEventListener(d,"touchcancel",this.reset)}startMove(o,d){this._rotatePitchHandler.dragStart(o,d),P.disableDrag()}move(o,d){const g=this.map,{bearingDelta:x,pitchDelta:T}=this._rotatePitchHandler.dragMove(o,d)||{};x&&g.setBearing(g.getBearing()+x),T&&g.setPitch(g.getPitch()+T)}off(){const o=this.element;P.removeEventListener(o,"mousedown",this.mousedown),P.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),P.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),P.removeEventListener(window,"touchend",this.touchend),P.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){P.enableDrag(),P.removeEventListener(window,"mousemove",this.mousemove),P.removeEventListener(window,"mouseup",this.mouseup),P.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),P.removeEventListener(window,"touchend",this.touchend)}}let ol;function Ph(E,o,d,g=!1){if(g||!d.getCoveringTilesDetailsProvider().allowWorldCopies())return E?.wrap();const x=new s.V(E.lng,E.lat);if(E=new s.V(E.lng,E.lat),o){const T=new s.V(E.lng-360,E.lat),D=new s.V(E.lng+360,E.lat),N=d.locationToScreenPoint(E).distSqr(o);d.locationToScreenPoint(T).distSqr(o)<N?E=T:d.locationToScreenPoint(D).distSqr(o)<N&&(E=D)}for(;Math.abs(E.lng-d.center.lng)>180;){const T=d.locationToScreenPoint(E);if(T.x>=0&&T.y>=0&&T.x<=d.width&&T.y<=d.height)break;E.lng>d.center.lng?E.lng-=360:E.lng+=360}return E.lng!==x.lng&&d.isPointOnMapSurface(d.locationToScreenPoint(E))?E:x}const ui={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ku(E,o,d){const g=E.classList;for(const x in ui)g.remove(`maplibregl-${d}-anchor-${x}`);g.add(`maplibregl-${d}-anchor-${o}`)}class zu extends s.E{constructor(o){if(super(),this._onClick=d=>{this.fire(new s.l("click",{originalEvent:d}))},this._onKeyPress=d=>{const g=d.code,x=d.charCode||d.keyCode;g!=="Space"&&g!=="Enter"&&x!==32&&x!==13||this.togglePopup()},this._onMapClick=d=>{const g=d.originalEvent.target,x=this._element;this._popup&&(g===x||x.contains(g))&&this.togglePopup()},this._update=d=>{if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();(d?.type==="terrain"||d?.type==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=Ph(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||d&&d.type!=="moveend"||(this._pos=this._pos.round()),P.setTransform(this._element,`${ui[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${x}`),A.frameAsync(new AbortController,this._map._ownerWindow).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this.setOpacity(o?.opacity,o?.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=s.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=P.create("div");const d=P.createNS("http://www.w3.org/2000/svg","svg"),g=41,x=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${g}px`),d.setAttributeNS(null,"width",`${x}px`),d.setAttributeNS(null,"viewBox",`0 0 ${x} ${g}`);const T=P.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const D=P.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill-rule","nonzero");const N=P.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(3.0, 29.0)"),N.setAttributeNS(null,"fill","#000000");const V=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ne of V){const qe=P.createNS("http://www.w3.org/2000/svg","ellipse");qe.setAttributeNS(null,"opacity","0.04"),qe.setAttributeNS(null,"cx","10.5"),qe.setAttributeNS(null,"cy","5.80029008"),qe.setAttributeNS(null,"rx",Ne.rx),qe.setAttributeNS(null,"ry",Ne.ry),N.appendChild(qe)}const Z=P.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill",this._color);const Q=P.createNS("http://www.w3.org/2000/svg","path");Q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Z.appendChild(Q);const ce=P.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"opacity","0.25"),ce.setAttributeNS(null,"fill","#000000");const le=P.createNS("http://www.w3.org/2000/svg","path");le.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ce.appendChild(le);const ge=P.createNS("http://www.w3.org/2000/svg","g");ge.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ge.setAttributeNS(null,"fill","#FFFFFF");const be=P.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ze=P.createNS("http://www.w3.org/2000/svg","circle");ze.setAttributeNS(null,"fill","#000000"),ze.setAttributeNS(null,"opacity","0.25"),ze.setAttributeNS(null,"cx","5.5"),ze.setAttributeNS(null,"cy","5.5"),ze.setAttributeNS(null,"r","5.4999962");const $e=P.createNS("http://www.w3.org/2000/svg","circle");$e.setAttributeNS(null,"fill","#FFFFFF"),$e.setAttributeNS(null,"cx","5.5"),$e.setAttributeNS(null,"cy","5.5"),$e.setAttributeNS(null,"r","5.4999962"),be.appendChild(ze),be.appendChild($e),D.appendChild(N),D.appendChild(Z),D.appendChild(ce),D.appendChild(ge),D.appendChild(be),d.appendChild(D),d.setAttributeNS(null,"height",g*this._scale+"px"),d.setAttributeNS(null,"width",x*this._scale+"px"),this._element.appendChild(d),this._offset=s.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),ku(this._element,this._anchor,"marker"),this._element.addEventListener("click",this._onClick),o&&o.className)for(const d of o.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),o.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),P.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.V.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const x=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var d,g;const x=(d=this._map)===null||d===void 0?void 0:d.terrain,T=this._map.transform.isLocationOccluded(this._lngLat);if(!x||T){const ge=T?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ge&&(this._element.style.opacity=ge))}if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const D=this._map,N=D.terrain.depthAtPoint(this._pos),V=D.terrain.getElevationForLngLat(this._lngLat,D.transform);if(D.transform.lngLatToCameraDepth(this._lngLat,V)-N<.006)return void(this._element.style.opacity=this._opacity);const Z=-this._offset.y/D.transform.pixelsPerMeter,Q=Math.sin(D.getPitch()*Math.PI/180)*Z,ce=D.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),le=D.transform.lngLatToCameraDepth(this._lngLat,V+Q)-ce>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&le&&this._popup.remove(),this._element.style.opacity=le?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=s.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,d){return(this._opacity===void 0||o===void 0&&d===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),o!==void 0&&(this._opacity=o),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const Ud={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ul=0,$l=!1;const Vl={maxWidth:100,unit:"metric"};function hi(E,o,d){const g=d&&d.maxWidth||100,x=E._container.clientHeight/2,T=E._container.clientWidth/2,D=E.unproject([T-g/2,x]),N=E.unproject([T+g/2,x]),V=Math.round(E.project(N).x-E.project(D).x),Z=Math.min(g,V,E._container.clientWidth),Q=D.distanceTo(N);if(d&&d.unit==="imperial"){const ce=3.2808*Q;ce>5280?Ri(o,Z,ce/5280,E._getUIString("ScaleControl.Miles")):Ri(o,Z,ce,E._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Ri(o,Z,Q/1852,E._getUIString("ScaleControl.NauticalMiles")):Q>=1e3?Ri(o,Z,Q/1e3,E._getUIString("ScaleControl.Kilometers")):Ri(o,Z,Q,E._getUIString("ScaleControl.Meters"))}function Ri(E,o,d,g){const x=function(T){const D=Math.pow(10,`${Math.floor(T)}`.length-1);let N=T/D;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(V){const Z=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*Z)/Z}(N),D*N}(d);E.style.width=o*(x/d)+"px",E.innerHTML=`${x}&nbsp;${g}`}const io={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Ou=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Uc(E){if(E){if(typeof E=="number"){const o=Math.round(Math.abs(E)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,E),"top-left":new s.P(o,o),"top-right":new s.P(-o,o),bottom:new s.P(0,-E),"bottom-left":new s.P(o,-o),"bottom-right":new s.P(-o,-o),left:new s.P(E,0),right:new s.P(-E,0)}}if(E instanceof s.P||Array.isArray(E)){const o=s.P.convert(E);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:s.P.convert(E.center||[0,0]),top:s.P.convert(E.top||[0,0]),"top-left":s.P.convert(E["top-left"]||[0,0]),"top-right":s.P.convert(E["top-right"]||[0,0]),bottom:s.P.convert(E.bottom||[0,0]),"bottom-left":s.P.convert(E["bottom-left"]||[0,0]),"bottom-right":s.P.convert(E["bottom-right"]||[0,0]),left:s.P.convert(E.left||[0,0]),right:s.P.convert(E.right||[0,0])}}return Uc(new s.P(0,0))}const Fu=m;u.AJAXError=s.cJ,u.EXTENT=s.a5,u.Event=s.l,u.Evented=s.E,u.LngLat=s.V,u.MercatorCoordinate=s.a9,u.Point=s.P,u.addProtocol=s.cK,u.config=s.c,u.removeProtocol=s.cL,u.AttributionControl=rp,u.BoxZoomHandler=ws,u.CanvasSource=yn,u.CooperativeGesturesHandler=Vn,u.DoubleClickZoomHandler=Fc,u.DragPanHandler=np,u.DragRotateHandler=Vs,u.EdgeInsets=lu,u.FullscreenControl=class extends s.E{constructor(E={}){var o;super(),this._onFullscreenChange=()=>{var d;let g=window.document.fullscreenElement||window.document.webkitFullscreenElement;for(;!((d=g?.shadowRoot)===null||d===void 0)&&d.fullscreenElement;)g=g.shadowRoot.fullscreenElement;g===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,this._pseudo=(o=E.pseudo)!==null&&o!==void 0&&o,E&&E.container&&(E.container instanceof HTMLElement?this._container=E.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(E){return this._map=E,this._container||(this._container=this._map.getContainer()),this._controlContainer=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){P.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const E=this._fullscreenButton=P.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);P.create("span","maplibregl-ctrl-icon",E).setAttribute("aria-hidden","true"),E.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const E=this._getTitle();this._fullscreenButton.setAttribute("aria-label",E),this._fullscreenButton.title=E}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){this._pseudo?this._togglePseudoFullScreen():window.document.exitFullscreen?window.document.exitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._pseudo?this._togglePseudoFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},u.GeoJSONSource=Nt,u.GeolocateControl=class extends s.E{constructor(E){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",o)),this._finish()}},this._updateCamera=o=>{const d=new s.V(o.coords.longitude,o.coords.latitude),g=o.coords.accuracy,x=this._map.getBearing(),T=s.e({bearing:x},this.options.fitBoundsOptions),D=on.fromLngLat(d,g);this._map.fitBounds(D,T,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const d=new s.V(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=o.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=o=>{if(this._map){if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&$l)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=P.create("button","maplibregl-ctrl-geolocate",this._container),P.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(o===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=P.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new zu({element:this._dotElement}),this._circleElement=P.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{const g=d?.[0]instanceof ResizeObserverEntry;d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||g||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},Ud,E)}onAdd(E){return this._map=E,this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(o=!1){if(ol!==void 0&&!o)return ol;if(window.navigator.permissions===void 0)return ol=!!window.navigator.geolocation,ol;try{ol=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ol=!!window.navigator.geolocation}return ol})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),P.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ul=0,$l=!1}_isOutOfMapMaxBounds(E){const o=this._map.getMaxBounds(),d=E.coords;return o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const E=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&E))return;const o=this._map.project(E),d=this._map.unproject([o.x+100,o.y]),g=E.distanceTo(d)/100,x=2*this._accuracy/g;this._circleElement.style.width=`${x.toFixed(2)}px`,this._circleElement.style.height=`${x.toFixed(2)}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ul--,$l=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let E;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ul++,Ul>1?(E={maximumAge:6e5,timeout:0},$l=!0):(E=this.options.positionOptions,$l=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,E)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},u.GlobeControl=class{constructor(){this._toggleProjection=()=>{var E;const o=(E=this._map.getProjection())===null||E===void 0?void 0:E.type;this._map.setProjection(o!=="mercator"&&o?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var E;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((E=this._map.getProjection())===null||E===void 0?void 0:E.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(E){return this._map=E,this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=P.create("button","maplibregl-ctrl-globe",this._container),P.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._map.on("projectiontransition",this._updateGlobeIcon),this._container}onRemove(){P.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._map.off("projectiontransition",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},u.Hash=Yf,u.ImageSource=jt,u.KeyboardHandler=Jr,u.LngLatBounds=on,u.LogoControl=nl,u.Map=class extends Wi{get _ownerWindow(){var E,o;return((o=(E=this._container)===null||E===void 0?void 0:E.ownerDocument)===null||o===void 0?void 0:o.defaultView)||window}constructor(E){var o,d;s.cH.mark(s.cI.create);const g=Object.assign(Object.assign(Object.assign({},rl),E),{canvasContextAttributes:Object.assign(Object.assign({},rl.canvasContextAttributes),E.canvasContextAttributes)});if(g.minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const x=new uu,T=new wc;g.minZoom!==void 0&&x.setMinZoom(g.minZoom),g.maxZoom!==void 0&&x.setMaxZoom(g.maxZoom),g.minPitch!==void 0&&x.setMinPitch(g.minPitch),g.maxPitch!==void 0&&x.setMaxPitch(g.maxPitch),g.renderWorldCopies!==void 0&&x.setRenderWorldCopies(g.renderWorldCopies),g.transformConstrain!==null&&x.setConstrainOverride(g.transformConstrain),super(x,T,{bearingSnap:g.bearingSnap,zoomSnap:g.zoomSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Nc,this._controls=[],this._mapId=s.af(),this._lostContextStyle={style:null,images:null},this._contextLost=N=>{if(N.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy(),this._lostContextStyle=this._getStyleAndImages(),this.style){for(const V of Object.values(this.style._layers))if(V.type==="custom"&&console.warn(`Custom layer with id '${V.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),V._listeners)for(const[Z]of Object.entries(V._listeners))console.warn(`Custom layer with id '${V.id}' had event listeners for event '${Z}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this.style.destroy(),this.style=null,this.fire(new s.l("webglcontextlost",{originalEvent:N}))}else this.fire(new s.l("webglcontextlost",{originalEvent:N}))},this._contextRestored=N=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new s.l("webglcontextrestored",{originalEvent:N}))},this._onMapScroll=N=>{if(N.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},g.canvasContextAttributes),this._trackResize=g.trackResize===!0,this._bearingSnap=g.bearingSnap,this._zoomSnap=g.zoomSnap,this._centerClampedToGround=g.centerClampedToGround,this._refreshExpiredTiles=g.refreshExpiredTiles===!0,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions===!0,this._collectResourceTiming=g.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Bc),g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this._zoomLevelsToOverscale=g.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=g.transformCameraUpdate,this.transformConstrain=g.transformConstrain,this.cancelPendingTileRequestsWhileZooming=g.cancelPendingTileRequestsWhileZooming===!0,g.reduceMotion!==void 0&&(A.prefersReducedMotion=g.reduceMotion),this._imageQueueHandle=J.addThrottleControl(()=>this.isMoving()),this._requestManager=new ue(g.transformRequest),this._container=this._resolveContainer(g.container),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"&&(this._ownerWindow.addEventListener("online",this._onWindowOnline,!1),this._setupResizeObserver()),this.handlers=new ua(this,g),this._hash=g.hash&&new Yf(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,elevation:g.elevation,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,roll:g.roll}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,s.e({},g.fitBoundsOptions,{duration:0}))));const D=typeof g.style=="string"||((d=(o=g.style)===null||o===void 0?void 0:o.projection)===null||d===void 0?void 0:d.type)!=="globe";this.resize(null,D),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new rp(typeof g.attributionControl=="boolean"?void 0:g.attributionControl)),g.maplibreLogo&&this.addControl(new nl,g.logoPosition),this.on("style.load",()=>{if(D||this._resizeTransform(),this.transform.unmodified){const N=s.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(N)}}),this.on("data",N=>{this._update(N.dataType==="style"),this.fire(new s.l(`${N.dataType}data`,N))}),this.on("dataloading",N=>{this.fire(new s.l(`${N.dataType}dataloading`,N))}),this.on("dataabort",N=>{this.fire(new s.l("sourcedataabort",N))})}_getMapId(){return this._mapId}setGlobalStateProperty(E,o){return this.style.setGlobalStateProperty(E,o),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(E,o){if(o===void 0&&(o=E.getDefaultPosition?E.getDefaultPosition():"top-right"),!E||!E.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=E.onAdd(this);this._controls.push(E);const g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(d,g.firstChild):g.appendChild(d),this}removeControl(E){if(!E||!E.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(E);return o>-1&&this._controls.splice(o,1),E.onRemove(this),this}hasControl(E){return this._controls.indexOf(E)>-1}coveringTiles(E){return yr(this.transform,E)}calculateCameraOptionsFromTo(E,o,d,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLat(d,this.transform)),super.calculateCameraOptionsFromTo(E,o,d,g)}resize(E,o=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(o);const d=!this._moving;return d&&(this.stop(),this.fire(new s.l("movestart",E)).fire(new s.l("move",E))),this.fire(new s.l("resize",E)),d&&this.fire(new s.l("moveend",E)),this}_resizeInternal(E=!0){const[o,d]=this._containerDimensions(),g=this._getClampedPixelRatio(o,d);if(this._resizeCanvas(o,d,g),this.painter.resize(o,d,g),this.painter.overLimit()){const x=this.painter.context.gl;this._maxCanvasSize=[x.drawingBufferWidth,x.drawingBufferHeight];const T=this._getClampedPixelRatio(o,d);this._resizeCanvas(o,d,T),this.painter.resize(o,d,T)}this._resizeTransform(E)}_resizeTransform(E=!0){var o;const[d,g]=this._containerDimensions();this.transform.resize(d,g,E),(o=this._requestedCameraState)===null||o===void 0||o.resize(d,g,E)}_getClampedPixelRatio(E,o){const{0:d,1:g}=this._maxCanvasSize,x=this.getPixelRatio(),T=E*x,D=o*x;return Math.min(T>d?d/T:1,D>g?g/D:1)*x}getPixelRatio(){var E;return(E=this._overridePixelRatio)!==null&&E!==void 0?E:devicePixelRatio}setPixelRatio(E){this._overridePixelRatio=E,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(E){return this.transform.setMaxBounds(on.convert(E)),this._update()}setMinZoom(E){if((E=E??-2)>=-2&&E<=this.transform.maxZoom){const o=this.transform.zoom,d=this._getTransformForUpdate();return d.setMinZoom(E),this._applyUpdatedTransform(d),this._update(),o!==this.transform.zoom&&this.fire(new s.l("zoomstart")).fire(new s.l("zoom")).fire(new s.l("zoomend")).fire(new s.l("movestart")).fire(new s.l("move")).fire(new s.l("moveend")),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(E){if((E=E??22)>=this.transform.minZoom){const o=this.transform.zoom,d=this._getTransformForUpdate();return d.setMaxZoom(E),this._applyUpdatedTransform(d),this._update(),o!==this.transform.zoom&&this.fire(new s.l("zoomstart")).fire(new s.l("zoom")).fire(new s.l("zoomend")).fire(new s.l("movestart")).fire(new s.l("move")).fire(new s.l("moveend")),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(E){if((E=E??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(E>=0&&E<=this.transform.maxPitch){const o=this.transform.pitch,d=this._getTransformForUpdate();return d.setMinPitch(E),this._applyUpdatedTransform(d),this._update(),o!==this.transform.pitch&&this.fire(new s.l("pitchstart")).fire(new s.l("pitch")).fire(new s.l("pitchend")).fire(new s.l("movestart")).fire(new s.l("move")).fire(new s.l("moveend")),this}throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(E){if((E=E??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(E>=this.transform.minPitch){const o=this.transform.pitch,d=this._getTransformForUpdate();return d.setMaxPitch(E),this._applyUpdatedTransform(d),this._update(),o!==this.transform.pitch&&this.fire(new s.l("pitchstart")).fire(new s.l("pitch")).fire(new s.l("pitchend")).fire(new s.l("movestart")).fire(new s.l("move")).fire(new s.l("moveend")),this}throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(E){return this.transform.setRenderWorldCopies(E),this._update()}setTransformConstrain(E){return this.transform.setConstrainOverride(E),this._update()}project(E){return this.transform.locationToScreenPoint(s.V.convert(E),this.style&&this.terrain)}unproject(E){return this.transform.screenPointToLocation(s.P.convert(E),this.terrain)}isMoving(){var E;return this._moving||((E=this.handlers)===null||E===void 0?void 0:E.isMoving())}isZooming(){var E;return this._zooming||((E=this.handlers)===null||E===void 0?void 0:E.isZooming())}isRotating(){var E;return this._rotating||((E=this.handlers)===null||E===void 0?void 0:E.isRotating())}_createDelegatedListener(E,o,d){if(E==="mouseenter"||E==="mouseover"){let g=!1;return{layers:o,listener:d,delegates:{mousemove:T=>{const D=o.filter(V=>this.getLayer(V)),N=D.length!==0?this.queryRenderedFeatures(T.point,{layers:D}):[];N.length?g||(g=!0,d.call(this,new $i(E,this,T.originalEvent,{features:N}))):g=!1},mouseout:()=>{g=!1}}}}if(E==="mouseleave"||E==="mouseout"){let g=!1;return{layers:o,listener:d,delegates:{mousemove:D=>{const N=o.filter(V=>this.getLayer(V));(N.length!==0?this.queryRenderedFeatures(D.point,{layers:N}):[]).length?g=!0:g&&(g=!1,d.call(this,new $i(E,this,D.originalEvent)))},mouseout:D=>{g&&(g=!1,d.call(this,new $i(E,this,D.originalEvent)))}}}}{const g=x=>{const T=o.filter(N=>this.getLayer(N)),D=T.length!==0?this.queryRenderedFeatures(x.point,{layers:T}):[];D.length&&(x.features=D,d.call(this,x),delete x.features)};return{layers:o,listener:d,delegates:{[E]:g}}}}_saveDelegatedListener(E,o){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[E]=this._delegatedListeners[E]||[],this._delegatedListeners[E].push(o)}_removeDelegatedListener(E,o,d){if(!this._delegatedListeners||!this._delegatedListeners[E])return;const g=this._delegatedListeners[E];for(let x=0;x<g.length;x++){const T=g[x];if(T.listener===d&&T.layers.length===o.length&&T.layers.every(D=>o.includes(D))){for(const D in T.delegates)this.off(D,T.delegates[D]);return void g.splice(x,1)}}}on(E,o,d){if(d===void 0)return super.on(E,o);const g=typeof o=="string"?[o]:o,x=this._createDelegatedListener(E,g,d);this._saveDelegatedListener(E,x);for(const T in x.delegates)this.on(T,x.delegates[T]);return{unsubscribe:()=>{this._removeDelegatedListener(E,g,d)}}}once(E,o,d){if(d===void 0)return super.once(E,o);const g=typeof o=="string"?[o]:o,x=this._createDelegatedListener(E,g,d);for(const T in x.delegates){const D=x.delegates[T];x.delegates[T]=(...N)=>{this._removeDelegatedListener(E,g,d),D(...N)}}this._saveDelegatedListener(E,x);for(const T in x.delegates)this.once(T,x.delegates[T]);return this}off(E,o,d){return d===void 0?super.off(E,o):(this._removeDelegatedListener(E,typeof o=="string"?[o]:o,d),this)}queryRenderedFeatures(E,o){if(!this.style)return[];let d;const g=E instanceof s.P||Array.isArray(E),x=g?E:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(g?{}:E)||{},x instanceof s.P||typeof x[0]=="number")d=[s.P.convert(x)];else{const T=s.P.convert(x[0]),D=s.P.convert(x[1]);d=[T,new s.P(D.x,T.y),D,new s.P(T.x,D.y),T]}return this.style.queryRenderedFeatures(d,o,this.transform)}querySourceFeatures(E,o){return this.style.querySourceFeatures(E,o)}setStyle(E,o){return(o=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&E?(this._diffStyle(E,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(E,o))}setTransformRequest(E){return this._requestManager.setTransformRequest(E),this}_getUIString(E){const o=this._locale[E];if(o==null)throw new Error(`Missing UI string '${E}'`);return o}_updateStyle(E,o){var d,g;if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(E,o));const x=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!E)),E?(this.style=new mu(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof E=="string"?this.style.loadURL(E,o,x):this.style.loadJSON(E,o,x),this):((g=(d=this.style)===null||d===void 0?void 0:d.projection)===null||g===void 0||g.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new mu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(E,o){if(typeof E=="string"){const d=this._requestManager.transformRequest(E,"Style");s.j(d,new AbortController).then(g=>{this._updateDiff(g.data,o)}).catch(g=>{g&&this.fire(new s.k(g))})}else typeof E=="object"&&this._updateDiff(E,o)}_updateDiff(E,o){try{this.style.setState(E,o)&&this._update(!0)}catch(d){s.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(E,o)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(E,o){return this._lazyInitEmptyStyle(),this.style.addSource(E,o),this._update(!0)}isSourceLoaded(E){const o=this.style&&this.style.tileManagers[E];if(o!==void 0)return o.loaded();this.fire(new s.k(new Error(`There is no tile manager with ID '${E}'`)))}setTerrain(E){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),E){const o=this.style.tileManagers[E.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${E.source}`);this.terrain===null&&o.reload();for(const d in this.style._layers){const g=this.style._layers[d];g.type==="hillshade"&&g.source===E.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),g.type==="color-relief"&&g.source===E.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ci(this.painter,o,E),this.painter.renderToTexture=new Ms(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=d=>{var g;d.dataType==="style"?this.terrain.tileManager.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==E.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((g=d.source)===null||g===void 0?void 0:g.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:E})),this}getTerrain(){var E,o;return(o=(E=this.terrain)===null||E===void 0?void 0:E.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const E=this.style&&this.style.tileManagers;for(const o of Object.values(E))if(!o.areTilesLoaded())return!1;return!0}removeSource(E){return this.style.removeSource(E),this._update(!0)}getSource(E){return this.style.getSource(E)}setSourceTileLodParams(E,o,d){if(d){const g=this.getSource(d);if(!g)throw new Error(`There is no source with ID "${d}", cannot set LOD parameters`);g.calculateTileZoom=Jt(Math.max(1,E),Math.max(1,o))}else for(const g in this.style.tileManagers)this.style.tileManagers[g].getSource().calculateTileZoom=Jt(Math.max(1,E),Math.max(1,o));return this._update(!0),this}refreshTiles(E,o){const d=this.style.tileManagers[E];if(!d)throw new Error(`There is no tile manager with ID "${E}", cannot refresh tile`);o===void 0?d.reload(!0):d.refreshTiles(o.map(g=>new s.ac(g.z,g.x,g.y)))}addImage(E,o,d={}){const{pixelRatio:g=1,sdf:x=!1,stretchX:T,stretchY:D,content:N,textFitWidth:V,textFitHeight:Z}=d;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||s.b(o))){if(o.width===void 0||o.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Q,height:ce,data:le}=o,ge=o;return this.style.addImage(E,{data:new s.R({width:Q,height:ce},new Uint8Array(le)),pixelRatio:g,stretchX:T,stretchY:D,content:N,textFitWidth:V,textFitHeight:Z,sdf:x,version:0,userImage:ge}),ge.onAdd&&ge.onAdd(this,E),this}}{const{width:Q,height:ce,data:le}=A.getImageData(o);this.style.addImage(E,{data:new s.R({width:Q,height:ce},le),pixelRatio:g,stretchX:T,stretchY:D,content:N,textFitWidth:V,textFitHeight:Z,sdf:x,version:0})}}updateImage(E,o){const d=this.style.getImage(E);if(!d)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=o instanceof HTMLImageElement||s.b(o)?A.getImageData(o):o,{width:x,height:T,data:D}=g;if(x===void 0||T===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==d.data.width||T!==d.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const N=!(o instanceof HTMLImageElement||s.b(o));return d.data.replace(D,N),this.style.updateImage(E,d),this}getImage(E){return this.style.getImage(E)}hasImage(E){return E?!!this.style.getImage(E):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(E){this.style.removeImage(E)}loadImage(E){return J.getImage(this._requestManager.transformRequest(E,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(E,o){return this._lazyInitEmptyStyle(),this.style.addLayer(E,o),this._update(!0)}moveLayer(E,o){return this.style.moveLayer(E,o),this._update(!0)}removeLayer(E){return this.style.removeLayer(E),this._update(!0)}getLayer(E){return this.style.getLayer(E)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(E,o,d){return this.style.setLayerZoomRange(E,o,d),this._update(!0)}setFilter(E,o,d={}){return this.style.setFilter(E,o,d),this._update(!0)}getFilter(E){return this.style.getFilter(E)}setPaintProperty(E,o,d,g={}){return this.style.setPaintProperty(E,o,d,g),this._update(!0)}getPaintProperty(E,o){return this.style.getPaintProperty(E,o)}setLayoutProperty(E,o,d,g={}){return this.style.setLayoutProperty(E,o,d,g),this._update(!0)}getLayoutProperty(E,o){return this.style.getLayoutProperty(E,o)}setGlyphs(E,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(E,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(E,o,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(E,o,d,g=>{g||this._update(!0)}),this}removeSprite(E){return this._lazyInitEmptyStyle(),this.style.removeSprite(E),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(E,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(E,o,d=>{d||this._update(!0)}),this}setLight(E,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(E,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(E,o={}){return this._lazyInitEmptyStyle(),this.style.setSky(E,o),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(E,o){return this.style.setFeatureState(E,o),this._update()}removeFeatureState(E,o){return this.style.removeFeatureState(E,o),this._update()}getFeatureState(E){return this.style.getFeatureState(E)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let E=0,o=0;return this._container&&(E=this._container.clientWidth||400,o=this._container.clientHeight||300),[E,o]}_setupResizeObserver(){var E;let o=!1;const d=Zf(x=>{this._trackResize&&!this._removed&&(this.resize(x),this.redraw())},50),g=(E=this._ownerWindow.ResizeObserver)!==null&&E!==void 0?E:ResizeObserver;this._resizeObserver=new g(x=>{o?d(x):o=!0}),this._resizeObserver.observe(this._container)}_resolveContainer(E){if(typeof E=="string"){const o=document.getElementById(E);if(!o)throw new Error(`Container '${E}' not found.`);return o}if(E instanceof HTMLElement||E&&typeof E=="object"&&E.nodeType===1)return E;throw new Error("Invalid type: 'container' must be a String or HTMLElement.")}_setupContainer(){const E=this._container;E.classList.add("maplibregl-map");const o=this._canvasContainer=P.create("div","maplibregl-canvas-container",E);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=P.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),g=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],g);const x=this._controlContainer=P.create("div","maplibregl-control-container",E),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(D=>{T[D]=P.create("div",`maplibregl-ctrl-${D} `,x)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(E,o,d){this._canvas.width=Math.floor(d*E),this._canvas.height=Math.floor(d*o),this._canvas.style.width=`${E}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const E=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let o=null;this._canvas.addEventListener("webglcontextcreationerror",g=>{o={requestedAttributes:E},g&&(o.statusMessage=g.statusMessage,o.type=g.type)},{once:!0});let d=null;if(d=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,E):this._canvas.getContext("webgl2",E)||this._canvas.getContext("webgl",E),!d){const g="Failed to initialize WebGL";throw o?(o.message=g,new Error(JSON.stringify(o))):new Error(g)}this.painter=new Dd(d,this.transform),O.testSupport(d)}migrateProjection(E,o){super.migrateProjection(E,o),this.painter.transform=E,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(E){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||E,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(E){return this._update(),this._renderTaskQueue.add(E)}_cancelRenderFrame(E){this._renderTaskQueue.remove(E)}_render(E){var o,d,g,x,T;const D=this._idleTriggered?this._fadeDuration:0,N=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(E),this._removed)return;let V=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const ce=this.transform.zoom,le=z();this.style.zoomHistory.update(ce,le);const ge=new s.H(ce,{now:le,fadeDuration:D,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),be=ge.crossFadingFactor();be===1&&be===this._crossFadingFactor||(V=!0,this._crossFadingFactor=be),this.style.update(ge)}const Z=((d=this.style.projection)===null||d===void 0?void 0:d.transitionState)>0!==N;(g=this.style.projection)===null||g===void 0||g.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((x=this.style.projection)===null||x===void 0?void 0:x.transitionState,(T=this.style.projection)===null||T===void 0?void 0:T.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||Z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,D,this._crossSourceCollisions,Z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:D,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cH.mark(s.cI.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||V)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const Q=this._sourcesDirty||this._styleDirty||this._placementDirty;return Q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||Q||(this._fullyLoaded=!0,s.cH.mark(s.cI.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var E;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&this._ownerWindow.removeEventListener("online",this._onWindowOnline,!1),J.removeThrottleControl(this._imageQueueHandle),(E=this._resizeObserver)===null||E===void 0||E.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o?.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),P.remove(this._canvasContainer),P.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cH.remove(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,A.frame(this._frameRequest,E=>{s.cH.recordStartOfFrameAt(E),this._frameRequest=null;try{this._render(E)}catch(o){if(!s.Z(o)&&!function(d){return d.message===Tc}(o))throw o}},()=>{},this._ownerWindow))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(E){this._showTileBoundaries!==E&&(this._showTileBoundaries=E,this._update())}get showPadding(){return!!this._showPadding}set showPadding(E){this._showPadding!==E&&(this._showPadding=E,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(E){this._showCollisionBoxes!==E&&(this._showCollisionBoxes=E,E?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(E){this._showOverdrawInspector!==E&&(this._showOverdrawInspector=E,this._update())}get repaint(){return!!this._repaint}set repaint(E){this._repaint!==E&&(this._repaint=E,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(E){this._vertices=E,this._update()}get version(){return Lu}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(E){return this._lazyInitEmptyStyle(),this.style.setProjection(E),this._update(!0)}},u.MapMouseEvent=$i,u.MapTouchEvent=Lc,u.MapWheelEvent=Ld,u.Marker=zu,u.NavigationControl=class{constructor(E){this._updateZoomButtons=()=>{const o=this._map.getZoom(),d=o===this._map.getMaxZoom(),g=o===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(o,d)=>{const g=this._map._getUIString(`NavigationControl.${d}`);o.title=g,o.setAttribute("aria-label",g)},this.options=s.e({},Bd,E),this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),P.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),P.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=P.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(E){return this._map=E,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new il(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){P.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(E,o){const d=P.create("button",E,this._container);return d.type="button",d.addEventListener("click",o),d}},u.Popup=class extends s.E{constructor(E){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&P.remove(this._content),this._container&&(P.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=P.create("div","maplibregl-popup",this._map.getContainer()),this._tip=P.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const D of this.options.className.split(" "))this._container.classList.add(D);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Ph(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!o)return;const d=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationToScreenPoint(this._lngLat));let g=this.options.anchor;const x=Uc(this.options.offset);if(!g){const D=this._container.offsetWidth,N=this._container.offsetHeight,V=function(Q){var ce,le,ge,be;return Q?{top:(ce=Q.top)!==null&&ce!==void 0?ce:0,right:(le=Q.right)!==null&&le!==void 0?le:0,bottom:(ge=Q.bottom)!==null&&ge!==void 0?ge:0,left:(be=Q.left)!==null&&be!==void 0?be:0}:{top:0,right:0,bottom:0,left:0}}(this.options.padding);let Z;Z=d.y+x.bottom.y<N+V.top?["top"]:d.y>this._map.transform.height-N-V.bottom?["bottom"]:[],d.x<D/2+V.left?Z.push("left"):d.x>this._map.transform.width-D/2-V.right&&Z.push("right"),g=Z.length===0?"bottom":Z.join("-")}let T=d.add(x[g]);this.options.subpixelPositioning||(T=T.round()),P.setTransform(this._container,`${ui[g]} translate(${T.x}px,${T.y}px)`),ku(this._container,g,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(io),E)}addTo(E){return this._map&&this.remove(),this._map=E,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(E){return this._lngLat=s.V.convert(E),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(E){return this.setDOMContent(document.createTextNode(E))}setHTML(E){const o=document.createDocumentFragment(),d=document.createElement("body");let g;for(d.innerHTML=E;g=d.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){var E;return(E=this._container)===null||E===void 0?void 0:E.style.maxWidth}setMaxWidth(E){return this.options.maxWidth=E,this._update(),this}setDOMContent(E){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=P.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(E),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(E){return this._container&&this._container.classList.add(E),this}removeClassName(E){return this._container&&this._container.classList.remove(E),this}setOffset(E){return this.options.offset=E,this._update(),this}toggleClassName(E){if(this._container)return this._container.classList.toggle(E)}setSubpixelPositioning(E){this.options.subpixelPositioning=E}setPadding(E){this.options.padding=E,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=P.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const E=this._container.querySelector(Ou);E&&E.focus()}},u.RasterDEMTileSource=Ve,u.RasterTileSource=dn,u.ScaleControl=class{constructor(E){this._onMove=()=>{hi(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,hi(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Vl),E)}getDefaultPosition(){return"bottom-left"}onAdd(E){return this._map=E,this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-scale",E.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){P.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},u.ScrollZoomHandler=Ru,u.Style=mu,u.TerrainControl=class{constructor(E){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=E}onAdd(E){return this._map=E,this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=P.create("button","maplibregl-ctrl-terrain",this._container),P.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){P.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},u.TwoFingersTouchPitchHandler=Fd,u.TwoFingersTouchRotateHandler=Bm,u.TwoFingersTouchZoomHandler=Oc,u.TwoFingersTouchZoomRotateHandler=tl,u.VectorTileSource=Gn,u.VideoSource=Ut,u.addSourceType=(E,o)=>s._(void 0,void 0,void 0,function*(){if(qt(E))throw new Error(`A source type called "${E}" already exists.`);((d,g)=>{Zt[d]=g})(E,o)}),u.clearPrewarmedResources=function(){const E=ot;E&&(E.isPreloaded()&&E.numActive()===1?(E.release(He),ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},u.createTileMesh=hh,u.getMaxParallelImageRequests=function(){return s.c.MAX_PARALLEL_IMAGE_REQUESTS},u.getRTLTextPluginStatus=function(){return oe().getRTLTextPluginStatus()},u.getVersion=function(){return Fu},u.getWorkerCount=function(){return pt.workerCount},u.getWorkerUrl=function(){return s.c.WORKER_URL},u.importScriptInWorkers=function(E){return hn().broadcast("IS",E)},u.isTimeFrozen=function(){return k.isFrozen()},u.now=z,u.prewarm=function(){Mt().acquire(He)},u.restoreNow=function(){k.restoreNow()},u.setMaxParallelImageRequests=function(E){s.c.MAX_PARALLEL_IMAGE_REQUESTS=E},u.setNow=function(E){k.setNow(E)},u.setRTLTextPlugin=function(E,o){return oe().setRTLTextPlugin(E,o)},u.setWorkerCount=function(E){pt.workerCount=E},u.setWorkerUrl=function(E){s.c.WORKER_URL=E}});var l=n;return l})}(Qb)),Qb.exports}var ZS=foe();const A6=oS(ZS),poe=j4({__proto__:null,default:A6},[ZS]);var uc=Uint8Array,sy=Uint16Array,moe=Int32Array,I6=new uc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),R6=new uc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),goe=new uc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),D6=function(t,e){for(var n=new sy(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var a=new moe(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)a[l]=l-n[r]<<5|r;return{b:n,r:a}},L6=D6(I6,2),k6=L6.b,voe=L6.r;k6[28]=258,voe[258]=28;var yoe=D6(R6,0),_oe=yoe.b,dP=new sy(32768);for(var Qi=0;Qi<32768;++Qi){var Cp=(Qi&43690)>>1|(Qi&21845)<<1;Cp=(Cp&52428)>>2|(Cp&13107)<<2,Cp=(Cp&61680)>>4|(Cp&3855)<<4,dP[Qi]=((Cp&65280)>>8|(Cp&255)<<8)>>1}var b_=function(t,e,n){for(var r=t.length,a=0,l=new sy(e);a<r;++a)t[a]&&++l[t[a]-1];var u=new sy(e);for(a=1;a<e;++a)u[a]=u[a-1]+l[a-1]<<1;var s;if(n){s=new sy(1<<e);var m=15-e;for(a=0;a<r;++a)if(t[a])for(var _=a<<4|t[a],b=e-t[a],M=u[t[a]-1]++<<b,C=M|(1<<b)-1;M<=C;++M)s[dP[M]>>m]=_}else for(s=new sy(r),a=0;a<r;++a)t[a]&&(s[a]=dP[u[t[a]-1]++]>>15-t[a]);return s},Ux=new uc(288);for(var Qi=0;Qi<144;++Qi)Ux[Qi]=8;for(var Qi=144;Qi<256;++Qi)Ux[Qi]=9;for(var Qi=256;Qi<280;++Qi)Ux[Qi]=7;for(var Qi=280;Qi<288;++Qi)Ux[Qi]=8;var z6=new uc(32);for(var Qi=0;Qi<32;++Qi)z6[Qi]=5;var xoe=b_(Ux,9,1),boe=b_(z6,5,1),LM=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},Zu=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},kM=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},woe=function(t){return(t+7)/8|0},Soe=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new uc(t.subarray(e,n))},Moe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ic=function(t,e,n){var r=new Error(e||Moe[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,ic),!n)throw r;return r},VI=function(t,e,n,r){var a=t.length,l=0;if(!a||e.f&&!e.l)return n||new uc(0);var u=!n,s=u||e.i!=2,m=e.i;u&&(n=new uc(a*3));var _=function(hn){var en=n.length;if(hn>en){var an=new uc(Math.max(en*2,hn));an.set(n),n=an}},b=e.f||0,M=e.p||0,C=e.b||0,A=e.l,k=e.d,z=e.m,P=e.n,O=a*8;do{if(!A){b=Zu(t,M,1);var j=Zu(t,M+1,3);if(M+=3,j)if(j==1)A=xoe,k=boe,z=9,P=5;else if(j==2){var se=Zu(t,M,31)+257,J=Zu(t,M+10,15)+4,ue=se+Zu(t,M+5,31)+1;M+=14;for(var ne=new uc(ue),H=new uc(19),de=0;de<J;++de)H[goe[de]]=Zu(t,M+de*3,7);M+=J*3;for(var Ee=LM(H),Pe=(1<<Ee)-1,Ze=b_(H,Ee,1),de=0;de<ue;){var ke=Ze[Zu(t,M,Pe)];M+=ke&15;var U=ke>>4;if(U<16)ne[de++]=U;else{var Te=0,Ie=0;for(U==16?(Ie=3+Zu(t,M,3),M+=2,Te=ne[de-1]):U==17?(Ie=3+Zu(t,M,7),M+=3):U==18&&(Ie=11+Zu(t,M,127),M+=7);Ie--;)ne[de++]=Te}}var Ce=ne.subarray(0,se),Ue=ne.subarray(se);z=LM(Ce),P=LM(Ue),A=b_(Ce,z,1),k=b_(Ue,P,1)}else ic(1);else{var U=woe(M)+4,X=t[U-4]|t[U-3]<<8,K=U+X;if(K>a){m&&ic(0);break}s&&_(C+X),n.set(t.subarray(U,K),C),e.b=C+=X,e.p=M=K*8,e.f=b;continue}if(M>O){m&&ic(0);break}}s&&_(C+131072);for(var nt=(1<<z)-1,Le=(1<<P)-1,lt=M;;lt=M){var Te=A[kM(t,M)&nt],Ht=Te>>4;if(M+=Te&15,M>O){m&&ic(0);break}if(Te||ic(2),Ht<256)n[C++]=Ht;else if(Ht==256){lt=M,A=null;break}else{var He=Ht-254;if(Ht>264){var de=Ht-257,pt=I6[de];He=Zu(t,M,(1<<pt)-1)+k6[de],M+=pt}var _t=k[kM(t,M)&Le],ot=_t>>4;_t||ic(3),M+=_t&15;var Ue=_oe[ot];if(ot>3){var pt=R6[ot];Ue+=kM(t,M)&(1<<pt)-1,M+=pt}if(M>O){m&&ic(0);break}s&&_(C+131072);var et=C+He;if(C<Ue){var Mt=l-Ue,Tt=Math.min(Ue,et);for(Mt+C<0&&ic(3);C<Tt;++C)n[C]=r[Mt+C]}for(;C<et;++C)n[C]=n[C-Ue]}}e.l=A,e.p=lt,e.b=C,e.f=b,A&&(b=1,e.m=z,e.d=k,e.n=P)}while(!b);return C!=n.length&&u?Soe(n,0,C):n.subarray(0,C)},Eoe=new uc(0),Coe=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&ic(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=(t[10]|t[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(e&2)},Toe=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Poe=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ic(6,"invalid zlib data"),(t[1]>>5&1)==1&&ic(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Aoe(t,e){return VI(t,{i:2},e,e)}function Ioe(t,e){var n=Coe(t);return n+8>t.length&&ic(6,"invalid gzip data"),VI(t.subarray(n,-8),{i:2},new uc(Toe(t)),e)}function Roe(t,e){return VI(t.subarray(Poe(t),-4),{i:2},e,e)}function Doe(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Ioe(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Aoe(t,e):Roe(t,e)}var Loe=typeof TextDecoder<"u"&&new TextDecoder,koe=0;try{Loe.decode(Eoe,{stream:!0}),koe=1}catch{}var zoe=Object.defineProperty,Ooe=Math.pow,Bi=(t,e)=>zoe(t,"name",{value:e,configurable:!0}),Ns=(t,e,n)=>new Promise((r,a)=>{var l=m=>{try{s(n.next(m))}catch(_){a(_)}},u=m=>{try{s(n.throw(m))}catch(_){a(_)}},s=m=>m.done?r(m.value):Promise.resolve(m.value).then(l,u);s((n=n.apply(t,e)).next())});Bi((t,e)=>{let n=!1,r="",a=L.GridLayer.extend({createTile:Bi((l,u)=>{let s=document.createElement("img"),m=new AbortController,_=m.signal;return s.cancel=()=>{m.abort()},n||(t.getHeader().then(b=>{b.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):b.tileType===2?r="image/png":b.tileType===3?r="image/jpeg":b.tileType===4?r="image/webp":b.tileType===5&&(r="image/avif")}),n=!0),t.getZxy(l.z,l.x,l.y,_).then(b=>{if(b){let M=new Blob([b.data],{type:r}),C=window.URL.createObjectURL(M);s.src=C}else s.style.display="none";s.cancel=void 0,u(void 0,s)}).catch(b=>{if(b.name!=="AbortError")throw b}),s},"createTile"),_removeTile:Bi(function(l){let u=this._tiles[l];u&&(u.el.cancel&&u.el.cancel(),u.el.width=0,u.el.height=0,u.el.deleted=!0,L.DomUtil.remove(u.el),delete this._tiles[l],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(l)}))},"_removeTile")});return new a(e)},"leafletRasterLayer");var Foe=Bi(t=>(e,n)=>{if(n instanceof AbortController)return t(e,n);let r=new AbortController;return t(e,r).then(a=>n(void 0,a.data,a.cacheControl||"",a.expires||""),a=>n(a)).catch(a=>n(a)),{cancel:Bi(()=>r.abort(),"cancel")}},"v3compat"),O6=class{constructor(e){this.tilev4=Bi((n,r)=>Ns(this,null,function*(){if(n.type==="json"){let A=n.url.substr(10),k=this.tiles.get(A);if(k||(k=new Bk(A),this.tiles.set(A,k)),this.metadata){let P=yield k.getTileJson(n.url);return r.signal.throwIfAborted(),{data:P}}let z=yield k.getHeader();return r.signal.throwIfAborted(),(z.minLon>=z.maxLon||z.minLat>=z.maxLat)&&console.error(`Bounds of PMTiles archive ${z.minLon},${z.minLat},${z.maxLon},${z.maxLat} are not valid.`),{data:{tiles:[`${n.url}/{z}/{x}/{y}`],minzoom:z.minZoom,maxzoom:z.maxZoom,bounds:[z.minLon,z.minLat,z.maxLon,z.maxLat]}}}let a=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),l=n.url.match(a);if(!l)throw new Error("Invalid PMTiles protocol URL");let u=l[1],s=this.tiles.get(u);s||(s=new Bk(u),this.tiles.set(u,s));let m=l[2],_=l[3],b=l[4],M=yield s.getHeader(),C=yield s?.getZxy(+m,+_,+b,r.signal);if(r.signal.throwIfAborted(),C)return{data:new Uint8Array(C.data),cacheControl:C.cacheControl,expires:C.expires};if(M.tileType===1){if(this.errorOnMissingTile)throw new Error("Tile not found.");return{data:new Uint8Array}}return{data:null}}),"tilev4"),this.tile=Foe(this.tilev4),this.tiles=new Map,this.metadata=e?.metadata||!1,this.errorOnMissingTile=e?.errorOnMissingTile||!1}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};Bi(O6,"Protocol");var Noe=O6;function F6(t,e){return(e>>>0)*4294967296+(t>>>0)}Bi(F6,"toNum");function N6(t,e){let n=e.buf,r=n[e.pos++],a=(r&112)>>4;if(r<128||(r=n[e.pos++],a|=(r&127)<<3,r<128)||(r=n[e.pos++],a|=(r&127)<<10,r<128)||(r=n[e.pos++],a|=(r&127)<<17,r<128)||(r=n[e.pos++],a|=(r&127)<<24,r<128)||(r=n[e.pos++],a|=(r&1)<<31,r<128))return F6(t,a);throw new Error("Expected varint not more than 10 bytes")}Bi(N6,"readVarintRemainder");function Kv(t){let e=t.buf,n=e[t.pos++],r=n&127;return n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,N6(r,t))}Bi(Kv,"readVarint");function jI(t,e,n,r,a){return a===0?r!==0?[t-1-n,t-1-e]:[n,e]:[e,n]}Bi(jI,"rotate");function B6(t,e,n){if(t>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");if(e>=1<<t||n>=1<<t)throw new Error("tile x/y outside zoom level bounds");let r=((1<<t)*(1<<t)-1)/3,a=t-1,[l,u]=[e,n];for(let s=1<<a;s>0;s>>=1){let m=l&s,_=u&s;r+=(3*m^_)*(1<<a),[l,u]=jI(s,l,u,m,_),a--}return r}Bi(B6,"zxyToTileId");function U6(t){let e=3*t+1;return e<4294967296?31-Math.clz32(e):63-Math.clz32(e/4294967296)}Bi(U6,"tileIdToZ");function Boe(t){let e=U6(t)>>1;if(e>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");let n=((1<<e)*(1<<e)-1)/3,r=t-n,a=0,l=0,u=1<<e;for(let s=1;s<u;s<<=1){let m=s&r/2,_=s&(r^m);[a,l]=jI(s,a,l,m,_),r=r/2,a+=m,l+=_}return[e,a,l]}Bi(Boe,"tileIdToZxy");var Uoe=(t=>(t[t.Unknown=0]="Unknown",t[t.None=1]="None",t[t.Gzip=2]="Gzip",t[t.Brotli=3]="Brotli",t[t.Zstd=4]="Zstd",t))(Uoe||{});function YS(t,e){return Ns(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Doe(new Uint8Array(t));let n=new Response(t).body;if(!n)throw new Error("Failed to read response stream");let r=n.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(r).arrayBuffer()}throw new Error("Compression method not supported")})}Bi(YS,"defaultDecompress");var $oe=(t=>(t[t.Unknown=0]="Unknown",t[t.Mvt=1]="Mvt",t[t.Png=2]="Png",t[t.Jpeg=3]="Jpeg",t[t.Webp=4]="Webp",t[t.Avif=5]="Avif",t[t.Mlt=6]="Mlt",t))($oe||{});function $6(t){return t===1?".mvt":t===2?".png":t===3?".jpg":t===4?".webp":t===5?".avif":t===6?".mlt":""}Bi($6,"tileTypeExt");var Voe=127;function V6(t,e){let n=0,r=t.length-1;for(;n<=r;){let a=r+n>>1,l=e-t[a].tileId;if(l>0)n=a+1;else if(l<0)r=a-1;else return t[a]}return r>=0&&(t[r].runLength===0||e-t[r].tileId<t[r].runLength)?t[r]:null}Bi(V6,"findTile");var joe=class{constructor(e){this.file=e}getKey(){return this.file.name}getBytes(e,n){return Ns(this,null,function*(){return{data:yield this.file.slice(e,e+n).arrayBuffer()}})}};Bi(joe,"FileSource");var j6=class{constructor(e,n=new Headers){var r,a;this.url=e,this.customHeaders=n,this.mustReload=!1;let l="";"navigator"in globalThis&&(l=(a=(r=globalThis.navigator)==null?void 0:r.userAgent)!=null?a:"");let u=l.indexOf("Windows")>-1,s=/Chrome|Chromium|Edg|OPR|Brave/.test(l);this.chromeWindowsNoCache=!1,u&&s&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,n,r,a){return Ns(this,null,function*(){let l,u;r?u=r:(l=new AbortController,u=l.signal);let s=new Headers(this.customHeaders);s.set("range",`bytes=${e}-${e+n-1}`);let m;this.mustReload?m="reload":this.chromeWindowsNoCache&&(m="no-store");let _=yield fetch(this.url,{signal:u,cache:m,headers:s});if(e===0&&_.status===416){let C=_.headers.get("Content-Range");if(!C||!C.startsWith("bytes */"))throw new Error("Missing content-length on 416 response");let A=+C.substr(8);_=yield fetch(this.url,{signal:u,cache:"reload",headers:{range:`bytes=0-${A-1}`}})}let b=_.headers.get("Etag");if(b!=null&&b.startsWith("W/")&&(b=null),_.status===416||a&&b&&b!==a)throw this.mustReload=!0,new fP(`Server returned non-matching ETag ${a} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(_.status>=300)throw new Error(`Bad response code: ${_.status}`);let M=_.headers.get("Content-Length");if(_.status===200&&(!M||+M>n))throw l&&l.abort(),new Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield _.arrayBuffer(),etag:b||void 0,cacheControl:_.headers.get("Cache-Control")||void 0,expires:_.headers.get("Expires")||void 0}})}};Bi(j6,"FetchSource");var Hoe=j6;function qc(t,e){let n=t.getUint32(e+4,!0),r=t.getUint32(e+0,!0);return n*Ooe(2,32)+r}Bi(qc,"getUint64");function H6(t,e){let n=new DataView(t),r=n.getUint8(7);if(r>3)throw new Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:qc(n,8),rootDirectoryLength:qc(n,16),jsonMetadataOffset:qc(n,24),jsonMetadataLength:qc(n,32),leafDirectoryOffset:qc(n,40),leafDirectoryLength:qc(n,48),tileDataOffset:qc(n,56),tileDataLength:qc(n,64),numAddressedTiles:qc(n,72),numTileEntries:qc(n,80),numTileContents:qc(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}Bi(H6,"bytesToHeader");function HI(t){let e={buf:new Uint8Array(t),pos:0},n=Kv(e),r=[],a=0;for(let l=0;l<n;l++){let u=Kv(e);r.push({tileId:a+u,offset:0,length:0,runLength:1}),a+=u}for(let l=0;l<n;l++)r[l].runLength=Kv(e);for(let l=0;l<n;l++)r[l].length=Kv(e);for(let l=0;l<n;l++){let u=Kv(e);u===0&&l>0?r[l].offset=r[l-1].offset+r[l-1].length:r[l].offset=u-1}return r}Bi(HI,"deserializeIndex");var G6=class extends Error{};Bi(G6,"EtagMismatch");var fP=G6;function GI(t,e){return Ns(this,null,function*(){let n=yield t.getBytes(0,16384);if(new DataView(n.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let r=n.data.slice(0,Voe),a=H6(r,n.etag),l=n.data.slice(a.rootDirectoryOffset,a.rootDirectoryOffset+a.rootDirectoryLength),u=`${t.getKey()}|${a.etag||""}|${a.rootDirectoryOffset}|${a.rootDirectoryLength}`,s=HI(yield e(l,a.internalCompression));return[a,[u,s.length,s]]})}Bi(GI,"getHeaderAndRoot");function WI(t,e,n,r,a){return Ns(this,null,function*(){let l=yield t.getBytes(n,r,void 0,a.etag),u=yield e(l.data,a.internalCompression),s=HI(u);if(s.length===0)throw new Error("Empty directory is invalid");return s})}Bi(WI,"getDirectory");var Goe=class{constructor(e=100,n=!0,r=YS){this.cache=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=r}getHeader(e){return Ns(this,null,function*(){let n=e.getKey(),r=this.cache.get(n);if(r)return r.lastUsed=this.counter++,r.data;let a=yield GI(e,this.decompress);return a[1]&&this.cache.set(a[1][0],{lastUsed:this.counter++,data:a[1][2]}),this.cache.set(n,{lastUsed:this.counter++,data:a[0]}),this.prune(),a[0]})}getDirectory(e,n,r,a){return Ns(this,null,function*(){let l=`${e.getKey()}|${a.etag||""}|${n}|${r}`,u=this.cache.get(l);if(u)return u.lastUsed=this.counter++,u.data;let s=yield WI(e,this.decompress,n,r,a);return this.cache.set(l,{lastUsed:this.counter++,data:s}),this.prune(),s})}prune(){if(this.cache.size>this.maxCacheEntries){let e=1/0,n;this.cache.forEach((r,a)=>{r.lastUsed<e&&(e=r.lastUsed,n=a)}),n&&this.cache.delete(n)}}invalidate(e){return Ns(this,null,function*(){this.cache.delete(e.getKey())})}};Bi(Goe,"ResolvedValueCache");var W6=class{constructor(e=100,n=!0,r=YS){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=r}getHeader(e){return Ns(this,null,function*(){let n=e.getKey(),r=this.cache.get(n);if(r)return r.lastUsed=this.counter++,yield r.data;let a=new Promise((l,u)=>{GI(e,this.decompress).then(s=>{s[1]&&this.cache.set(s[1][0],{lastUsed:this.counter++,data:Promise.resolve(s[1][2])}),l(s[0]),this.prune()}).catch(s=>{u(s)})});return this.cache.set(n,{lastUsed:this.counter++,data:a}),a})}getDirectory(e,n,r,a){return Ns(this,null,function*(){let l=`${e.getKey()}|${a.etag||""}|${n}|${r}`,u=this.cache.get(l);if(u)return u.lastUsed=this.counter++,yield u.data;let s=new Promise((m,_)=>{WI(e,this.decompress,n,r,a).then(b=>{m(b),this.prune()}).catch(b=>{_(b)})});return this.cache.set(l,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,n;this.cache.forEach((r,a)=>{r.lastUsed<e&&(e=r.lastUsed,n=a)}),n&&this.cache.delete(n)}}invalidate(e){return Ns(this,null,function*(){let n=e.getKey();if(this.invalidations.get(n))return yield this.invalidations.get(n);this.cache.delete(e.getKey());let r=new Promise((a,l)=>{this.getHeader(e).then(u=>{a(),this.invalidations.delete(n)}).catch(u=>{l(u)})});this.invalidations.set(n,r)})}};Bi(W6,"SharedPromiseCache");var Woe=W6,q6=class{constructor(e,n,r){typeof e=="string"?this.source=new Hoe(e):this.source=e,r?this.decompress=r:this.decompress=YS,n?this.cache=n:this.cache=new Woe}getHeader(){return Ns(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,n,r,a){return Ns(this,null,function*(){let l=B6(e,n,r),u=yield this.cache.getHeader(this.source);if(e<u.minZoom||e>u.maxZoom)return;let s=u.rootDirectoryOffset,m=u.rootDirectoryLength;for(let _=0;_<=3;_++){let b=yield this.cache.getDirectory(this.source,s,m,u),M=V6(b,l);if(M){if(M.runLength>0){let C=yield this.source.getBytes(u.tileDataOffset+M.offset,M.length,a,u.etag);return{data:yield this.decompress(C.data,u.tileCompression),cacheControl:C.cacheControl,expires:C.expires}}s=u.leafDirectoryOffset+M.offset,m=M.length}else return}throw new Error("Maximum directory depth exceeded")})}getZxy(e,n,r,a){return Ns(this,null,function*(){try{return yield this.getZxyAttempt(e,n,r,a)}catch(l){if(l instanceof fP)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,n,r,a);throw l}})}getMetadataAttempt(){return Ns(this,null,function*(){let e=yield this.cache.getHeader(this.source),n=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),r=yield this.decompress(n.data,e.internalCompression),a=new TextDecoder("utf-8");return JSON.parse(a.decode(r))})}getMetadata(){return Ns(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof fP)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}getTileJson(e){return Ns(this,null,function*(){let n=yield this.getHeader(),r=yield this.getMetadata(),a=$6(n.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${e}/{z}/{x}/{y}${a}`],vector_layers:r.vector_layers,attribution:r.attribution,description:r.description,name:r.name,version:r.version,bounds:[n.minLon,n.minLat,n.maxLon,n.maxLat],center:[n.centerLon,n.centerLat,n.centerZoom],minzoom:n.minZoom,maxzoom:n.maxZoom}})}};Bi(q6,"PMTiles");var Bk=q6;let Uk=!1;function qI(){if(Uk)return;const t=new Noe;A6.addProtocol("pmtiles",t.tile),Uk=!0}const KS=t=>{qI();const{mode:e="light",children:n,tileRootUrl:r}=t,a=XS[e];return ae.jsxs(ae.Fragment,{children:[ae.jsx(Dr,{id:"background",type:"background",paint:{"background-color":a.land}}),ae.jsxs(Jp,{id:"world",type:"vector",url:`pmtiles://${r}/world.pmtiles`,children:[ae.jsx(Dr,{"source-layer":"water",type:"fill",paint:{"fill-color":a.water}}),n,ae.jsx(Dr,{"source-layer":"states",type:"line",paint:{"line-color":a.stateBorder,"line-width":1,"line-opacity":1,"line-dasharray":[2,2]}}),ae.jsx(Dr,{"source-layer":"countries",type:"line",filter:["!=",["get","name"],"Serbia-Kosovo"],paint:{"line-color":a.countryBorder,"line-width":2,"line-opacity":1}}),ae.jsx(Dr,{"source-layer":"countries",type:"line",filter:["==",["get","name"],"Serbia-Kosovo"],paint:{"line-color":a.countryBorder,"line-width":2,"line-opacity":1,"line-dasharray":[3,2]}})]})]})},pP=t=>(qI(),ae.jsx(Jp,{type:"vector",url:`pmtiles://${t.tileRootUrl}/${t.game}-contours.pmtiles`,children:ae.jsx(Dr,{"source-layer":"contours",type:"fill",layout:{"fill-sort-key":["get","elevation"],visibility:t.showContours?"visible":"none"},paint:{"fill-color":["interpolate",["linear"],["get","elevation"],-200,"#77c571",0,"#77c571",100,"#afd35f",150,"#ece75b",200,"#decb4c",250,"#d2b446",300,"#bf9c4a",400,"#ba8839",500,"#ac792d"]}})}));var zM={exports:{}},OM,$k;function X6(){return $k||($k=1,OM={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),OM}var FM={exports:{}},NM,Vk;function qoe(){return Vk||(Vk=1,NM=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),NM}var jk;function Xoe(){if(jk)return FM.exports;jk=1;var t=qoe(),e=Array.prototype.concat,n=Array.prototype.slice,r=FM.exports=function(l){for(var u=[],s=0,m=l.length;s<m;s++){var _=l[s];t(_)?u=e.call(u,n.call(_)):u.push(_)}return u};return r.wrap=function(a){return function(){return a(r(arguments))}},FM.exports}var Hk;function Zoe(){if(Hk)return zM.exports;Hk=1;var t=X6(),e=Xoe(),n=Object.hasOwnProperty,r=Object.create(null);for(var a in t)n.call(t,a)&&(r[t[a]]=a);var l=zM.exports={to:{},get:{}};l.get=function(m){var _=m.substring(0,3).toLowerCase(),b,M;switch(_){case"hsl":b=l.get.hsl(m),M="hsl";break;case"hwb":b=l.get.hwb(m),M="hwb";break;default:b=l.get.rgb(m),M="rgb";break}return b?{model:M,value:b}:null},l.get.rgb=function(m){if(!m)return null;var _=/^#([a-f0-9]{3,4})$/i,b=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,M=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,C=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,A=/^(\w+)$/,k=[0,0,0,1],z,P,O;if(z=m.match(b)){for(O=z[2],z=z[1],P=0;P<3;P++){var j=P*2;k[P]=parseInt(z.slice(j,j+2),16)}O&&(k[3]=parseInt(O,16)/255)}else if(z=m.match(_)){for(z=z[1],O=z[3],P=0;P<3;P++)k[P]=parseInt(z[P]+z[P],16);O&&(k[3]=parseInt(O+O,16)/255)}else if(z=m.match(M)){for(P=0;P<3;P++)k[P]=parseInt(z[P+1],0);z[4]&&(z[5]?k[3]=parseFloat(z[4])*.01:k[3]=parseFloat(z[4]))}else if(z=m.match(C)){for(P=0;P<3;P++)k[P]=Math.round(parseFloat(z[P+1])*2.55);z[4]&&(z[5]?k[3]=parseFloat(z[4])*.01:k[3]=parseFloat(z[4]))}else return(z=m.match(A))?z[1]==="transparent"?[0,0,0,0]:n.call(t,z[1])?(k=t[z[1]],k[3]=1,k):null:null;for(P=0;P<3;P++)k[P]=u(k[P],0,255);return k[3]=u(k[3],0,1),k},l.get.hsl=function(m){if(!m)return null;var _=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,b=m.match(_);if(b){var M=parseFloat(b[4]),C=(parseFloat(b[1])%360+360)%360,A=u(parseFloat(b[2]),0,100),k=u(parseFloat(b[3]),0,100),z=u(isNaN(M)?1:M,0,1);return[C,A,k,z]}return null},l.get.hwb=function(m){if(!m)return null;var _=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,b=m.match(_);if(b){var M=parseFloat(b[4]),C=(parseFloat(b[1])%360+360)%360,A=u(parseFloat(b[2]),0,100),k=u(parseFloat(b[3]),0,100),z=u(isNaN(M)?1:M,0,1);return[C,A,k,z]}return null},l.to.hex=function(){var m=e(arguments);return"#"+s(m[0])+s(m[1])+s(m[2])+(m[3]<1?s(Math.round(m[3]*255)):"")},l.to.rgb=function(){var m=e(arguments);return m.length<4||m[3]===1?"rgb("+Math.round(m[0])+", "+Math.round(m[1])+", "+Math.round(m[2])+")":"rgba("+Math.round(m[0])+", "+Math.round(m[1])+", "+Math.round(m[2])+", "+m[3]+")"},l.to.rgb.percent=function(){var m=e(arguments),_=Math.round(m[0]/255*100),b=Math.round(m[1]/255*100),M=Math.round(m[2]/255*100);return m.length<4||m[3]===1?"rgb("+_+"%, "+b+"%, "+M+"%)":"rgba("+_+"%, "+b+"%, "+M+"%, "+m[3]+")"},l.to.hsl=function(){var m=e(arguments);return m.length<4||m[3]===1?"hsl("+m[0]+", "+m[1]+"%, "+m[2]+"%)":"hsla("+m[0]+", "+m[1]+"%, "+m[2]+"%, "+m[3]+")"},l.to.hwb=function(){var m=e(arguments),_="";return m.length>=4&&m[3]!==1&&(_=", "+m[3]),"hwb("+m[0]+", "+m[1]+"%, "+m[2]+"%"+_+")"},l.to.keyword=function(m){return r[m.slice(0,3)]};function u(m,_,b){return Math.min(Math.max(_,m),b)}function s(m){var _=Math.round(m).toString(16).toUpperCase();return _.length<2?"0"+_:_}return zM.exports}var BM,Gk;function Z6(){if(Gk)return BM;Gk=1;const t=X6(),e={};for(const a of Object.keys(t))e[t[a]]=a;const n={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};BM=n;for(const a of Object.keys(n)){if(!("channels"in n[a]))throw new Error("missing channels property: "+a);if(!("labels"in n[a]))throw new Error("missing channel labels property: "+a);if(n[a].labels.length!==n[a].channels)throw new Error("channel and label counts mismatch: "+a);const{channels:l,labels:u}=n[a];delete n[a].channels,delete n[a].labels,Object.defineProperty(n[a],"channels",{value:l}),Object.defineProperty(n[a],"labels",{value:u})}n.rgb.hsl=function(a){const l=a[0]/255,u=a[1]/255,s=a[2]/255,m=Math.min(l,u,s),_=Math.max(l,u,s),b=_-m;let M,C;_===m?M=0:l===_?M=(u-s)/b:u===_?M=2+(s-l)/b:s===_&&(M=4+(l-u)/b),M=Math.min(M*60,360),M<0&&(M+=360);const A=(m+_)/2;return _===m?C=0:A<=.5?C=b/(_+m):C=b/(2-_-m),[M,C*100,A*100]},n.rgb.hsv=function(a){let l,u,s,m,_;const b=a[0]/255,M=a[1]/255,C=a[2]/255,A=Math.max(b,M,C),k=A-Math.min(b,M,C),z=function(P){return(A-P)/6/k+1/2};return k===0?(m=0,_=0):(_=k/A,l=z(b),u=z(M),s=z(C),b===A?m=s-u:M===A?m=1/3+l-s:C===A&&(m=2/3+u-l),m<0?m+=1:m>1&&(m-=1)),[m*360,_*100,A*100]},n.rgb.hwb=function(a){const l=a[0],u=a[1];let s=a[2];const m=n.rgb.hsl(a)[0],_=1/255*Math.min(l,Math.min(u,s));return s=1-1/255*Math.max(l,Math.max(u,s)),[m,_*100,s*100]},n.rgb.cmyk=function(a){const l=a[0]/255,u=a[1]/255,s=a[2]/255,m=Math.min(1-l,1-u,1-s),_=(1-l-m)/(1-m)||0,b=(1-u-m)/(1-m)||0,M=(1-s-m)/(1-m)||0;return[_*100,b*100,M*100,m*100]};function r(a,l){return(a[0]-l[0])**2+(a[1]-l[1])**2+(a[2]-l[2])**2}return n.rgb.keyword=function(a){const l=e[a];if(l)return l;let u=1/0,s;for(const m of Object.keys(t)){const _=t[m],b=r(a,_);b<u&&(u=b,s=m)}return s},n.keyword.rgb=function(a){return t[a]},n.rgb.xyz=function(a){let l=a[0]/255,u=a[1]/255,s=a[2]/255;l=l>.04045?((l+.055)/1.055)**2.4:l/12.92,u=u>.04045?((u+.055)/1.055)**2.4:u/12.92,s=s>.04045?((s+.055)/1.055)**2.4:s/12.92;const m=l*.4124+u*.3576+s*.1805,_=l*.2126+u*.7152+s*.0722,b=l*.0193+u*.1192+s*.9505;return[m*100,_*100,b*100]},n.rgb.lab=function(a){const l=n.rgb.xyz(a);let u=l[0],s=l[1],m=l[2];u/=95.047,s/=100,m/=108.883,u=u>.008856?u**(1/3):7.787*u+16/116,s=s>.008856?s**(1/3):7.787*s+16/116,m=m>.008856?m**(1/3):7.787*m+16/116;const _=116*s-16,b=500*(u-s),M=200*(s-m);return[_,b,M]},n.hsl.rgb=function(a){const l=a[0]/360,u=a[1]/100,s=a[2]/100;let m,_,b;if(u===0)return b=s*255,[b,b,b];s<.5?m=s*(1+u):m=s+u-s*u;const M=2*s-m,C=[0,0,0];for(let A=0;A<3;A++)_=l+1/3*-(A-1),_<0&&_++,_>1&&_--,6*_<1?b=M+(m-M)*6*_:2*_<1?b=m:3*_<2?b=M+(m-M)*(2/3-_)*6:b=M,C[A]=b*255;return C},n.hsl.hsv=function(a){const l=a[0];let u=a[1]/100,s=a[2]/100,m=u;const _=Math.max(s,.01);s*=2,u*=s<=1?s:2-s,m*=_<=1?_:2-_;const b=(s+u)/2,M=s===0?2*m/(_+m):2*u/(s+u);return[l,M*100,b*100]},n.hsv.rgb=function(a){const l=a[0]/60,u=a[1]/100;let s=a[2]/100;const m=Math.floor(l)%6,_=l-Math.floor(l),b=255*s*(1-u),M=255*s*(1-u*_),C=255*s*(1-u*(1-_));switch(s*=255,m){case 0:return[s,C,b];case 1:return[M,s,b];case 2:return[b,s,C];case 3:return[b,M,s];case 4:return[C,b,s];case 5:return[s,b,M]}},n.hsv.hsl=function(a){const l=a[0],u=a[1]/100,s=a[2]/100,m=Math.max(s,.01);let _,b;b=(2-u)*s;const M=(2-u)*m;return _=u*m,_/=M<=1?M:2-M,_=_||0,b/=2,[l,_*100,b*100]},n.hwb.rgb=function(a){const l=a[0]/360;let u=a[1]/100,s=a[2]/100;const m=u+s;let _;m>1&&(u/=m,s/=m);const b=Math.floor(6*l),M=1-s;_=6*l-b,(b&1)!==0&&(_=1-_);const C=u+_*(M-u);let A,k,z;switch(b){default:case 6:case 0:A=M,k=C,z=u;break;case 1:A=C,k=M,z=u;break;case 2:A=u,k=M,z=C;break;case 3:A=u,k=C,z=M;break;case 4:A=C,k=u,z=M;break;case 5:A=M,k=u,z=C;break}return[A*255,k*255,z*255]},n.cmyk.rgb=function(a){const l=a[0]/100,u=a[1]/100,s=a[2]/100,m=a[3]/100,_=1-Math.min(1,l*(1-m)+m),b=1-Math.min(1,u*(1-m)+m),M=1-Math.min(1,s*(1-m)+m);return[_*255,b*255,M*255]},n.xyz.rgb=function(a){const l=a[0]/100,u=a[1]/100,s=a[2]/100;let m,_,b;return m=l*3.2406+u*-1.5372+s*-.4986,_=l*-.9689+u*1.8758+s*.0415,b=l*.0557+u*-.204+s*1.057,m=m>.0031308?1.055*m**(1/2.4)-.055:m*12.92,_=_>.0031308?1.055*_**(1/2.4)-.055:_*12.92,b=b>.0031308?1.055*b**(1/2.4)-.055:b*12.92,m=Math.min(Math.max(0,m),1),_=Math.min(Math.max(0,_),1),b=Math.min(Math.max(0,b),1),[m*255,_*255,b*255]},n.xyz.lab=function(a){let l=a[0],u=a[1],s=a[2];l/=95.047,u/=100,s/=108.883,l=l>.008856?l**(1/3):7.787*l+16/116,u=u>.008856?u**(1/3):7.787*u+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;const m=116*u-16,_=500*(l-u),b=200*(u-s);return[m,_,b]},n.lab.xyz=function(a){const l=a[0],u=a[1],s=a[2];let m,_,b;_=(l+16)/116,m=u/500+_,b=_-s/200;const M=_**3,C=m**3,A=b**3;return _=M>.008856?M:(_-16/116)/7.787,m=C>.008856?C:(m-16/116)/7.787,b=A>.008856?A:(b-16/116)/7.787,m*=95.047,_*=100,b*=108.883,[m,_,b]},n.lab.lch=function(a){const l=a[0],u=a[1],s=a[2];let m;m=Math.atan2(s,u)*360/2/Math.PI,m<0&&(m+=360);const b=Math.sqrt(u*u+s*s);return[l,b,m]},n.lch.lab=function(a){const l=a[0],u=a[1],m=a[2]/360*2*Math.PI,_=u*Math.cos(m),b=u*Math.sin(m);return[l,_,b]},n.rgb.ansi16=function(a,l=null){const[u,s,m]=a;let _=l===null?n.rgb.hsv(a)[2]:l;if(_=Math.round(_/50),_===0)return 30;let b=30+(Math.round(m/255)<<2|Math.round(s/255)<<1|Math.round(u/255));return _===2&&(b+=60),b},n.hsv.ansi16=function(a){return n.rgb.ansi16(n.hsv.rgb(a),a[2])},n.rgb.ansi256=function(a){const l=a[0],u=a[1],s=a[2];return l===u&&u===s?l<8?16:l>248?231:Math.round((l-8)/247*24)+232:16+36*Math.round(l/255*5)+6*Math.round(u/255*5)+Math.round(s/255*5)},n.ansi16.rgb=function(a){let l=a%10;if(l===0||l===7)return a>50&&(l+=3.5),l=l/10.5*255,[l,l,l];const u=(~~(a>50)+1)*.5,s=(l&1)*u*255,m=(l>>1&1)*u*255,_=(l>>2&1)*u*255;return[s,m,_]},n.ansi256.rgb=function(a){if(a>=232){const _=(a-232)*10+8;return[_,_,_]}a-=16;let l;const u=Math.floor(a/36)/5*255,s=Math.floor((l=a%36)/6)/5*255,m=l%6/5*255;return[u,s,m]},n.rgb.hex=function(a){const u=(((Math.round(a[0])&255)<<16)+((Math.round(a[1])&255)<<8)+(Math.round(a[2])&255)).toString(16).toUpperCase();return"000000".substring(u.length)+u},n.hex.rgb=function(a){const l=a.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!l)return[0,0,0];let u=l[0];l[0].length===3&&(u=u.split("").map(M=>M+M).join(""));const s=parseInt(u,16),m=s>>16&255,_=s>>8&255,b=s&255;return[m,_,b]},n.rgb.hcg=function(a){const l=a[0]/255,u=a[1]/255,s=a[2]/255,m=Math.max(Math.max(l,u),s),_=Math.min(Math.min(l,u),s),b=m-_;let M,C;return b<1?M=_/(1-b):M=0,b<=0?C=0:m===l?C=(u-s)/b%6:m===u?C=2+(s-l)/b:C=4+(l-u)/b,C/=6,C%=1,[C*360,b*100,M*100]},n.hsl.hcg=function(a){const l=a[1]/100,u=a[2]/100,s=u<.5?2*l*u:2*l*(1-u);let m=0;return s<1&&(m=(u-.5*s)/(1-s)),[a[0],s*100,m*100]},n.hsv.hcg=function(a){const l=a[1]/100,u=a[2]/100,s=l*u;let m=0;return s<1&&(m=(u-s)/(1-s)),[a[0],s*100,m*100]},n.hcg.rgb=function(a){const l=a[0]/360,u=a[1]/100,s=a[2]/100;if(u===0)return[s*255,s*255,s*255];const m=[0,0,0],_=l%1*6,b=_%1,M=1-b;let C=0;switch(Math.floor(_)){case 0:m[0]=1,m[1]=b,m[2]=0;break;case 1:m[0]=M,m[1]=1,m[2]=0;break;case 2:m[0]=0,m[1]=1,m[2]=b;break;case 3:m[0]=0,m[1]=M,m[2]=1;break;case 4:m[0]=b,m[1]=0,m[2]=1;break;default:m[0]=1,m[1]=0,m[2]=M}return C=(1-u)*s,[(u*m[0]+C)*255,(u*m[1]+C)*255,(u*m[2]+C)*255]},n.hcg.hsv=function(a){const l=a[1]/100,u=a[2]/100,s=l+u*(1-l);let m=0;return s>0&&(m=l/s),[a[0],m*100,s*100]},n.hcg.hsl=function(a){const l=a[1]/100,s=a[2]/100*(1-l)+.5*l;let m=0;return s>0&&s<.5?m=l/(2*s):s>=.5&&s<1&&(m=l/(2*(1-s))),[a[0],m*100,s*100]},n.hcg.hwb=function(a){const l=a[1]/100,u=a[2]/100,s=l+u*(1-l);return[a[0],(s-l)*100,(1-s)*100]},n.hwb.hcg=function(a){const l=a[1]/100,s=1-a[2]/100,m=s-l;let _=0;return m<1&&(_=(s-m)/(1-m)),[a[0],m*100,_*100]},n.apple.rgb=function(a){return[a[0]/65535*255,a[1]/65535*255,a[2]/65535*255]},n.rgb.apple=function(a){return[a[0]/255*65535,a[1]/255*65535,a[2]/255*65535]},n.gray.rgb=function(a){return[a[0]/100*255,a[0]/100*255,a[0]/100*255]},n.gray.hsl=function(a){return[0,0,a[0]]},n.gray.hsv=n.gray.hsl,n.gray.hwb=function(a){return[0,100,a[0]]},n.gray.cmyk=function(a){return[0,0,0,a[0]]},n.gray.lab=function(a){return[a[0],0,0]},n.gray.hex=function(a){const l=Math.round(a[0]/100*255)&255,s=((l<<16)+(l<<8)+l).toString(16).toUpperCase();return"000000".substring(s.length)+s},n.rgb.gray=function(a){return[(a[0]+a[1]+a[2])/3/255*100]},BM}var UM,Wk;function Yoe(){if(Wk)return UM;Wk=1;const t=Z6();function e(){const l={},u=Object.keys(t);for(let s=u.length,m=0;m<s;m++)l[u[m]]={distance:-1,parent:null};return l}function n(l){const u=e(),s=[l];for(u[l].distance=0;s.length;){const m=s.pop(),_=Object.keys(t[m]);for(let b=_.length,M=0;M<b;M++){const C=_[M],A=u[C];A.distance===-1&&(A.distance=u[m].distance+1,A.parent=m,s.unshift(C))}}return u}function r(l,u){return function(s){return u(l(s))}}function a(l,u){const s=[u[l].parent,l];let m=t[u[l].parent][l],_=u[l].parent;for(;u[_].parent;)s.unshift(u[_].parent),m=r(t[u[_].parent][_],m),_=u[_].parent;return m.conversion=s,m}return UM=function(l){const u=n(l),s={},m=Object.keys(u);for(let _=m.length,b=0;b<_;b++){const M=m[b];u[M].parent!==null&&(s[M]=a(M,u))}return s},UM}var $M,qk;function Koe(){if(qk)return $M;qk=1;const t=Z6(),e=Yoe(),n={},r=Object.keys(t);function a(u){const s=function(...m){const _=m[0];return _==null?_:(_.length>1&&(m=_),u(m))};return"conversion"in u&&(s.conversion=u.conversion),s}function l(u){const s=function(...m){const _=m[0];if(_==null)return _;_.length>1&&(m=_);const b=u(m);if(typeof b=="object")for(let M=b.length,C=0;C<M;C++)b[C]=Math.round(b[C]);return b};return"conversion"in u&&(s.conversion=u.conversion),s}return r.forEach(u=>{n[u]={},Object.defineProperty(n[u],"channels",{value:t[u].channels}),Object.defineProperty(n[u],"labels",{value:t[u].labels});const s=e(u);Object.keys(s).forEach(_=>{const b=s[_];n[u][_]=l(b),n[u][_].raw=a(b)})}),$M=n,$M}var VM,Xk;function Joe(){if(Xk)return VM;Xk=1;const t=Zoe(),e=Koe(),n=["keyword","gray","hex"],r={};for(const C of Object.keys(e))r[[...e[C].labels].sort().join("")]=C;const a={};function l(C,A){if(!(this instanceof l))return new l(C,A);if(A&&A in n&&(A=null),A&&!(A in e))throw new Error("Unknown model: "+A);let k,z;if(C==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(C instanceof l)this.model=C.model,this.color=[...C.color],this.valpha=C.valpha;else if(typeof C=="string"){const P=t.get(C);if(P===null)throw new Error("Unable to parse color from string: "+C);this.model=P.model,z=e[this.model].channels,this.color=P.value.slice(0,z),this.valpha=typeof P.value[z]=="number"?P.value[z]:1}else if(C.length>0){this.model=A||"rgb",z=e[this.model].channels;const P=Array.prototype.slice.call(C,0,z);this.color=M(P,z),this.valpha=typeof C[z]=="number"?C[z]:1}else if(typeof C=="number")this.model="rgb",this.color=[C>>16&255,C>>8&255,C&255],this.valpha=1;else{this.valpha=1;const P=Object.keys(C);"alpha"in C&&(P.splice(P.indexOf("alpha"),1),this.valpha=typeof C.alpha=="number"?C.alpha:0);const O=P.sort().join("");if(!(O in r))throw new Error("Unable to parse color from object: "+JSON.stringify(C));this.model=r[O];const{labels:j}=e[this.model],U=[];for(k=0;k<j.length;k++)U.push(C[j[k]]);this.color=M(U)}if(a[this.model])for(z=e[this.model].channels,k=0;k<z;k++){const P=a[this.model][k];P&&(this.color[k]=P(this.color[k]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}l.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(C){let A=this.model in t.to?this:this.rgb();A=A.round(typeof C=="number"?C:1);const k=A.valpha===1?A.color:[...A.color,this.valpha];return t.to[A.model](k)},percentString(C){const A=this.rgb().round(typeof C=="number"?C:1),k=A.valpha===1?A.color:[...A.color,this.valpha];return t.to.rgb.percent(k)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const C={},{channels:A}=e[this.model],{labels:k}=e[this.model];for(let z=0;z<A;z++)C[k[z]]=this.color[z];return this.valpha!==1&&(C.alpha=this.valpha),C},unitArray(){const C=this.rgb().color;return C[0]/=255,C[1]/=255,C[2]/=255,this.valpha!==1&&C.push(this.valpha),C},unitObject(){const C=this.rgb().object();return C.r/=255,C.g/=255,C.b/=255,this.valpha!==1&&(C.alpha=this.valpha),C},round(C){return C=Math.max(C||0,0),new l([...this.color.map(s(C)),this.valpha],this.model)},alpha(C){return C!==void 0?new l([...this.color,Math.max(0,Math.min(1,C))],this.model):this.valpha},red:m("rgb",0,_(255)),green:m("rgb",1,_(255)),blue:m("rgb",2,_(255)),hue:m(["hsl","hsv","hsl","hwb","hcg"],0,C=>(C%360+360)%360),saturationl:m("hsl",1,_(100)),lightness:m("hsl",2,_(100)),saturationv:m("hsv",1,_(100)),value:m("hsv",2,_(100)),chroma:m("hcg",1,_(100)),gray:m("hcg",2,_(100)),white:m("hwb",1,_(100)),wblack:m("hwb",2,_(100)),cyan:m("cmyk",0,_(100)),magenta:m("cmyk",1,_(100)),yellow:m("cmyk",2,_(100)),black:m("cmyk",3,_(100)),x:m("xyz",0,_(95.047)),y:m("xyz",1,_(100)),z:m("xyz",2,_(108.833)),l:m("lab",0,_(100)),a:m("lab",1),b:m("lab",2),keyword(C){return C!==void 0?new l(C):e[this.model].keyword(this.color)},hex(C){return C!==void 0?new l(C):t.to.hex(this.rgb().round().color)},hexa(C){if(C!==void 0)return new l(C);const A=this.rgb().round().color;let k=Math.round(this.valpha*255).toString(16).toUpperCase();return k.length===1&&(k="0"+k),t.to.hex(A)+k},rgbNumber(){const C=this.rgb().color;return(C[0]&255)<<16|(C[1]&255)<<8|C[2]&255},luminosity(){const C=this.rgb().color,A=[];for(const[k,z]of C.entries()){const P=z/255;A[k]=P<=.04045?P/12.92:((P+.055)/1.055)**2.4}return .2126*A[0]+.7152*A[1]+.0722*A[2]},contrast(C){const A=this.luminosity(),k=C.luminosity();return A>k?(A+.05)/(k+.05):(k+.05)/(A+.05)},level(C){const A=this.contrast(C);return A>=7?"AAA":A>=4.5?"AA":""},isDark(){const C=this.rgb().color;return(C[0]*2126+C[1]*7152+C[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const C=this.rgb();for(let A=0;A<3;A++)C.color[A]=255-C.color[A];return C},lighten(C){const A=this.hsl();return A.color[2]+=A.color[2]*C,A},darken(C){const A=this.hsl();return A.color[2]-=A.color[2]*C,A},saturate(C){const A=this.hsl();return A.color[1]+=A.color[1]*C,A},desaturate(C){const A=this.hsl();return A.color[1]-=A.color[1]*C,A},whiten(C){const A=this.hwb();return A.color[1]+=A.color[1]*C,A},blacken(C){const A=this.hwb();return A.color[2]+=A.color[2]*C,A},grayscale(){const C=this.rgb().color,A=C[0]*.3+C[1]*.59+C[2]*.11;return l.rgb(A,A,A)},fade(C){return this.alpha(this.valpha-this.valpha*C)},opaquer(C){return this.alpha(this.valpha+this.valpha*C)},rotate(C){const A=this.hsl();let k=A.color[0];return k=(k+C)%360,k=k<0?360+k:k,A.color[0]=k,A},mix(C,A){if(!C||!C.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof C);const k=C.rgb(),z=this.rgb(),P=A===void 0?.5:A,O=2*P-1,j=k.alpha()-z.alpha(),U=((O*j===-1?O:(O+j)/(1+O*j))+1)/2,X=1-U;return l.rgb(U*k.red()+X*z.red(),U*k.green()+X*z.green(),U*k.blue()+X*z.blue(),k.alpha()*P+z.alpha()*(1-P))}};for(const C of Object.keys(e)){if(n.includes(C))continue;const{channels:A}=e[C];l.prototype[C]=function(...k){return this.model===C?new l(this):k.length>0?new l(k,C):new l([...b(e[this.model][C].raw(this.color)),this.valpha],C)},l[C]=function(...k){let z=k[0];return typeof z=="number"&&(z=M(k,A)),new l(z,C)}}function u(C,A){return Number(C.toFixed(A))}function s(C){return function(A){return u(A,C)}}function m(C,A,k){C=Array.isArray(C)?C:[C];for(const z of C)(a[z]||(a[z]=[]))[A]=k;return C=C[0],function(z){let P;return z!==void 0?(k&&(z=k(z)),P=this[C](),P.color[A]=z,P):(P=this[C]().color[A],k&&(P=k(P)),P)}}function _(C){return function(A){return Math.max(0,Math.min(C,A))}}function b(C){return Array.isArray(C)?C:[C]}function M(C,A){for(let k=0;k<A;k++)typeof C[k]!="number"&&(C[k]=0);return C}return VM=l,VM}var Qoe=Joe();const Y6=oS(Qoe);var go=(t=>(t[t.FuelStation=0]="FuelStation",t[t.Toll=1]="Toll",t[t.Parking=2]="Parking",t[t.RecruitmentAgency=3]="RecruitmentAgency",t[t.Service=4]="Service",t[t.TruckDealer=5]="TruckDealer",t[t.Port=6]="Port",t[t.Train=7]="Train",t[t.Viewpoint=8]="Viewpoint",t[t.PhotoSight=9]="PhotoSight",t[t.AgricultureCheck=10]="AgricultureCheck",t[t.BorderCheck=11]="BorderCheck",t[t.Garage=12]="Garage",t[t.WeighStation=13]="WeighStation",t[t.CityNames=14]="CityNames",t[t.Company=15]="Company",t[t.RoadNumber=16]="RoadNumber",t[t.ExitNumber=17]="ExitNumber",t[t.Roadwork=18]="Roadwork",t[t.RailCrossing=19]="RailCrossing",t))(go||{});const ese=new Set([10,17]),tse=new Set([7,11]),K6=new Set(Array.from({length:20},(t,e)=>e)),Ny=new Set([...K6].filter(t=>!tse.has(t))),J6=new Set([...K6].filter(t=>!ese.has(t))),By=t=>{const{game:e,tileRootUrl:n,visibleIcons:r=e==="ats"?Ny:J6,enableIconAutoHide:a=!0,showSecrets:l="showAsNormal",mode:u="light",specialEvent:s}=t,m=s?!0:e==="ats"?Kk(e,t.dlcs??Rg):Kk(e,t.dlcs??Rie),_=l!=="hide"?!0:["==",["get","secret"],!1],b=XS[u];qI();const M=Nx();return q.useEffect(()=>{if(!M.current)return;const C=M.current;C.on("styleimagemissing",A=>{if(A.id!=="exit-sign"||C.hasImage("exit-sign"))return;const k=64,z=4,P=new Uint8Array(k*k*z);for(let j=0;j<k;j++)for(let U=0;U<k;U++){const X=(U*k+j)*z;U===0||U===k-1||j===0||j===k-1?(P[X+0]=136,P[X+1]=136,P[X+2]=136,P[X+3]=255):j===1||j===2||j===k-2||j===k-3||U===1||U===2||U===k-2||U===k-3?(P[X+0]=255,P[X+1]=255,P[X+2]=255,P[X+3]=255):(P[X+0]=82,P[X+1]=177,P[X+2]=129,P[X+3]=255)}const O=8;C.addImage("exit-sign",{width:k,height:k,data:P},{stretchX:[[O,k-O]],stretchY:[[O,k-O]],content:[O,O,k-O,k-O],pixelRatio:2})})},[M.current]),ae.jsxs(Jp,{id:e,type:"vector",url:`pmtiles://${n}/${s??e}.pmtiles`,children:[ae.jsx(Dr,{id:e+"mapAreas","source-layer":e,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"mapArea"],m,_],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":WM(u),"fill-outline-color":["case",["==",["get","color"],M6.Road],b.mapAreaOutline,WM(u)]}}),ae.jsx(Dr,{id:e+"prefabs","source-layer":e,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"prefab"],m,_],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":WM(u)}}),ae.jsx(nse,{game:e,specialEvent:s,tileRootUrl:n,mode:u,color:b.footprint}),ae.jsx(Dr,{id:e+"hidden-roads","source-layer":e,type:"line",minzoom:9,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!0],m],paint:{"line-color":b.hiddenRoad,"line-width":1,"line-opacity":.7}}),ae.jsx(Dr,{id:e+"secret-roads-case","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],["==",["get","secret"],l!=="hide"],m],layout:HM,paint:{"line-color":Jk(u,l==="showAsDashed"?u==="light"?"darken":"lighten":"none"),"line-gap-width":GM,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3],...l==="showAsDashed"?{"line-dasharray":[2,2]}:{}}}),ae.jsx(Dr,{id:e+"visible-roads-case","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],["==",["get","secret"],!1],m],layout:HM,paint:{"line-color":Jk(u),"line-gap-width":GM,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3]}}),ae.jsx(Dr,{id:e+"visible-roads","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],m,_],layout:HM,paint:{"line-color":ase(u),"line-width":GM}}),ae.jsx(Dr,{id:e+"ferries","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],paint:{"line-color":b.ferryLine,"line-width":1,"line-opacity":.8,"line-dasharray":[2,2]}}),ae.jsx(Dr,{id:e+"trains-a","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":b.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,-6]}}),ae.jsx(Dr,{id:e+"trains-b","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":b.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,6]}}),ae.jsx(Dr,{id:e+"train-hatch","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":b.trainLine,"line-width":10,"line-opacity":.8,"line-dasharray":[.1,1]}}),t.children,ae.jsx(Dr,{id:e+"ferry-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],layout:{...Wh,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":b.ferryHalo,"text-color":b.ferryLabel}}),ae.jsx(Dr,{id:e+"train-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],layout:{...Wh,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":b.trainHalo,"text-color":b.trainLabel}}),r.has(15)&&ae.jsx(Dr,{id:e+"company-icons","source-layer":e,type:"symbol",minzoom:a?8:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"company"],m,_],layout:Kd(a,1,1.25,3.5)}),e==="ets2"&&r.has(16)&&ae.jsx(Dr,{id:"euro-road-overlays","source-layer":e,minzoom:a?4.5:0,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["!",["in",["get","sprite"],["literal",Zk]]],_],layout:Kd(a,.4*1.25,.75*1.25,1.25*1.25)}),e==="ats"&&r.has(16)&&ae.jsx(Dr,{id:e+"road-interstate-overlays","source-layer":e,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","is",["get","sprite"]],0],m,_],layout:Kd(a,.4,.75,1.25)}),e==="ats"&&r.has(16)&&ae.jsx(Dr,{id:e+"road-us-route-overlays","source-layer":e,type:"symbol",minzoom:a?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","us",["get","sprite"]],0],m,_],layout:Kd(a,.4,.75,1.25)}),e==="ats"&&r.has(16)&&ae.jsx(Dr,{id:e+"road-state-route-overlays","source-layer":e,type:"symbol",minzoom:a?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],m,_,["!",["any",["==",["index-of","is",["get","sprite"]],0],["==",["index-of","us",["get","sprite"]],0],["in",["get","sprite"],["literal",Zk]]]]],layout:Kd(a,.4,.75,1.25)}),r.has(17)&&ae.jsx(Dr,{id:e+"exit-points","source-layer":e,type:"symbol",paint:{"text-color":"#fff"},minzoom:a?10:0,layout:{...Kd(a,.4,.75,1.25),...Wh,"text-field":"{name}","text-size":["interpolate",["linear"],["zoom"],4,4,10,10],"icon-text-fit":"both","icon-text-fit-padding":[0,2,0,2],"icon-image":"exit-sign"},filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"exit"],m]}),r.has(14)&&ae.jsx(Dr,{id:e+"city-labels-small","source-layer":e,type:"symbol",minzoom:a?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],[">",["get","scaleRank"],6],m],layout:{...Wh,"text-field":"{name}","text-allow-overlap":!a,"text-variable-anchor":Jv,"text-size":12,"icon-image":jM,"icon-allow-overlap":!a,"icon-size":.6},paint:b.primaryTextPaint}),r.has(14)&&ae.jsx(Dr,{id:e+"city-labels-medium","source-layer":e,type:"symbol",minzoom:a?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],6],[">",["get","scaleRank"],3],m],layout:{...Wh,"text-field":"{name}","text-allow-overlap":!a,"text-variable-anchor":Jv,"text-size":13,"icon-image":jM,"icon-allow-overlap":!a,"icon-size":.6},paint:b.primaryTextPaint}),r.has(14)&&ae.jsx(Dr,{id:e+"city-labels-big","source-layer":e,type:"symbol",minzoom:a?4:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],3],m],layout:{...Wh,"text-field":"{name}","text-allow-overlap":!a,"text-variable-anchor":Jv,"text-size":14,"icon-image":jM,"icon-allow-overlap":!a,"icon-size":.8},paint:b.primaryTextPaint}),e==="ets2"&&r.has(14)&&ae.jsx(Dr,{id:e+"country-labels","source-layer":e,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...Wh,"text-font":["Klokantech Noto Sans Bold"],"text-field":"{name}","text-variable-anchor":Jv,"text-size":14},paint:b.primaryTextPaint}),e==="ats"&&r.has(14)&&ae.jsx(Dr,{id:e+"country-labels","source-layer":e,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...Wh,"text-font":["Open Sans Light"],"text-field":"{name}","text-transform":"uppercase","text-variable-anchor":Jv,"text-size":["step",["zoom"],10,5,13]},paint:b.secondaryTextPaint}),mP(r)&&ae.jsx(Dr,{id:e+"poi-icons","source-layer":e,type:"symbol",minzoom:a?7:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],Yk(r),m,_],layout:Kd(a,.6,1.25,2.5,{vertical:2,horizontal:2})}),mP(r)&&(r.has(8)||r.has(9)||r.has(5))&&ae.jsx(Dr,{id:e+"poi-icon-labels","source-layer":e,type:"symbol",minzoom:a?9.5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["any",["in",["get","poiType"],["literal",["viewpoint","landmark"]]],["all",["==",["get","poiType"],"facility"],["==",["get","sprite"],"dealer_ico"]]],Yk(r),m,_],layout:{...Kd(a,.6,1.25,2.5,{vertical:2,horizontal:2}),...Wh,"text-field":"{poiName}","text-allow-overlap":!a,"text-variable-anchor":["left","right","top","bottom"],"text-radial-offset":1.5,"text-size":10},paint:b.primaryTextPaint}),(r.has(18)||r.has(19))&&ae.jsx(Dr,{id:e+"traffic-icons","source-layer":e,type:"symbol",minzoom:a?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"traffic"],ose(r),m,_],layout:Kd(a,.6*.5,1.25*.5,2.5*.5,{vertical:2,horizontal:2})})]})},nse=({game:t,tileRootUrl:e,color:n,mode:r,specialEvent:a})=>ae.jsxs(Jp,{id:t+"footprints",type:"vector",url:`pmtiles://${e}/${a??t}-footprints.pmtiles`,children:[ae.jsx(Dr,{id:t+"footprints","source-layer":"footprints",type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-color":n,"fill-opacity":["step",["zoom"],1,9,.8]}}),ae.jsx(Dr,{id:t+"extrusions",minzoom:9,"source-layer":"footprints",type:"fill-extrusion",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-extrusion-color":n,"fill-extrusion-height":["interpolate",["exponential",1.5],["zoom"],9,["*",10,["get","height"]],13,["*",20,["get","height"]]],"fill-extrusion-opacity":r==="light"?.33:.67}})]});function Kd(t,e,n,r,a={vertical:10,horizontal:30}){const l=["literal",[a.vertical,a.horizontal]];return{"icon-image":"{sprite}","icon-allow-overlap":!t,"icon-padding":l,"icon-size":["interpolate",["exponential",1.5],["zoom"],4,e,9,n,13,r]}}const jM=["step",["zoom"],["case",["==",["get","capital"],2],"dotdot","dot"],8,""],rse=[9,8,6,7,2,0,4,5,12,3,13,1,10,11],Q6=[18,19],Zk=["weigh_ico","toll_ico","agri_check","border_ico"];function mP(t){return rse.some(e=>t.has(e))}function ise(t){return Q6.some(e=>t.has(e))}function ose(t){ld.checkArgument(ise(t));const e=[];return t.has(18)&&e.push("roadwork"),t.has(19)&&e.push("railcrossing"),["any",e.length>0?["in",["get","sprite"],["literal",e]]:!1]}function Yk(t){ld.checkArgument(mP(t));const e=[];t.has(9)&&e.push("landmark"),t.has(8)&&e.push("viewpoint"),t.has(6)&&e.push("ferry"),t.has(7)&&e.push("train");const n=[];t.has(0)&&n.push("gas_ico"),t.has(4)&&n.push("service_ico"),t.has(13)&&n.push("weigh_station_ico"),t.has(5)&&n.push("dealer_ico"),t.has(12)&&n.push("garage_large_ico"),t.has(3)&&n.push("recruitment_ico"),t.has(2)&&n.push("parking_ico");const r=[];t.has(13)&&r.push("weigh_ico"),t.has(1)&&r.push("toll_ico"),t.has(10)&&r.push("agri_check"),t.has(11)&&r.push("border_ico");const a=e.length>0?["in",["get","poiType"],["literal",e]]:!1,l=n.length>0?["all",["==",["get","poiType"],"facility"],["in",["get","sprite"],["literal",n]]]:!1,u=r.length>0?["all",["==",["get","poiType"],"road"],["in",["get","sprite"],["literal",r]]]:!1;return["any",a,l,u]}function Kk(t,e){let n;return t==="ats"?n=Fx(e):(n=Lie(e),n.add(null)),["in",["get","dlcGuard"],["literal",[...n]]]}const Jv=["step",["zoom"],["literal",["top","bottom","right","left"]],7,["literal",["center"]]],Wh={"text-radial-offset":.5,"text-justify":"auto","text-font":["Klokantech Noto Sans Regular"]},HM={"line-cap":"round","line-join":"bevel"},GM=["interpolate",["exponential",1.5],["zoom"],3,.8,14,30,16,150],eU={light:{freeway:["#fde293","#f8c248"],divided:["#ffffff","#dddddd"],no_vehicles:["#aaaaaa","#888888"],local:["#f1f3f4","#dddddd"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]},dark:{freeway:["#95813e","#372f21"],divided:["#3c4043","#4c5043"],no_vehicles:["#606166","#888888"],local:["#606166","#333"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]}},sse={light:{0:"hsl(200, 8%, 92%)",1:"hsl(38, 59%, 76%)",2:"hsl(38, 64%, 58%)",3:"hsl(92, 31%, 70%)",4:"hsl(0, 100%, 30%)",5:"hsl(107, 51%, 43%)",6:"hsl(201, 53%, 39%)",7:"hsl(53, 84%, 53%)",8:"hsl(267,46% ,45%)"},dark:{0:"hsl(200, 2%, 36%)",1:"hsl(38, 25%, 35%)",2:"hsl(38, 25%, 25%)",3:"hsl(143, 20%, 25%)",4:"hsl(0, 100%, 25%)",5:"hsl(107, 51%, 25%)",6:"hsl(201, 53%, 25%)",7:"hsl(53, 84%, 25%)",8:"hsl(267, 46%, 25%)"}},ase=t=>["match",["get","roadType"],...Object.entries(eU[t]).flatMap(([e,[n]])=>[e,n]),"#f0f"],Jk=(t,e="none")=>["match",["get","roadType"],...Object.entries(eU[t]).flatMap(([n,[,r]])=>[n,e==="darken"?Y6(r).darken(.2).string():e==="lighten"?"#ccc":r]),"#b0b"],WM=t=>["match",["get","color"],...Object.entries(sse[t]).flatMap(([e,n])=>[Number(e),n]),"#b0b"],lse="/extra-labels.geojson",cse="/ets2-villages.geojson";var rs=(t=>(t.AR="AR",t.AZ="AZ",t.CA="CA",t.CO="CO",t.IA="IA",t.ID="ID",t.KS="KS",t.LA="LA",t.MO="MO",t.MT="MT",t.NE="NE",t.NM="NM",t.NV="NV",t.OK="OK",t.OR="OR",t.TX="TX",t.UT="UT",t.WA="WA",t.WY="WY",t))(rs||{});const use={AR:void 0,AZ:void 0,CA:void 0,CO:void 0,IA:void 0,ID:void 0,KS:void 0,LA:void 0,MO:void 0,MT:void 0,NE:void 0,NM:void 0,NV:void 0,OK:void 0,OR:void 0,TX:void 0,UT:void 0,WA:void 0,WY:void 0},hse=new Set(Object.keys(use)),gP=t=>{const{game:e,enableAutoHide:n=!0,mode:r="light"}=t,a=e==="ats"?lse:cse,l=e==="ats"?["all",["boolean",["get","show"],!0],["in",["slice",["get","country"],-2],["literal",[...t.enabledStates??hse]]]]:["boolean",!0],u=XS[r];return ae.jsx(Jp,{id:`${e}-scenery-towns`,type:"geojson",data:a,children:ae.jsx(Dr,{id:`${e}-scenery-towns`,type:"symbol",minzoom:n?7:0,filter:l,layout:{...Wh,"text-field":e==="ats"?"{text}":"{name}","text-allow-overlap":!n,"text-variable-anchor":Jv,"text-size":10.5},paint:u.primaryTextPaint})})},XI={version:8,glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},ZI={get(t,e,n){return e==="sprite"&&typeof t.sprite=="string"&&/^\/\w/.exec(t.sprite.toString())?window.location.origin+t.sprite:Reflect.get(t,e,n)}},JS=new Proxy({...XI,sprite:"/sprites"},ZI),dse=new Proxy({...XI,sprite:"/halloween-sprites"},ZI),fse=new Proxy({...XI,sprite:"/christmas-sprites"},ZI);var ec=63710088e-1,pse={centimeters:ec*100,centimetres:ec*100,degrees:360/(2*Math.PI),feet:ec*3.28084,inches:ec*39.37,kilometers:ec/1e3,kilometres:ec/1e3,meters:ec,metres:ec,miles:ec/1609.344,millimeters:ec*1e3,millimetres:ec*1e3,nauticalmiles:ec/1852,radians:1,yards:ec*1.0936};function vP(t,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function ob(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ez(t[0])||!ez(t[1]))throw new Error("coordinates must contain numbers");return vP({type:"Point",coordinates:t},e,n)}function mse(t,e="kilometers"){const n=pse[e];if(!n)throw new Error(e+" units is invalid");return t*n}function Qk(t){return t%(2*Math.PI)*180/Math.PI}function ay(t){return t%360*Math.PI/180}function ez(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function w_(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function gse(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function wy(t,e,n={}){var r=w_(t),a=w_(e),l=ay(a[1]-r[1]),u=ay(a[0]-r[0]),s=ay(r[1]),m=ay(a[1]),_=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(s)*Math.cos(m);return mse(2*Math.atan2(Math.sqrt(_),Math.sqrt(1-_)),n.units)}function vse(t,e){var n,r,a,l,u,s,m,_,b,M,C=0,A=t.type==="FeatureCollection",k=t.type==="Feature",z=A?t.features.length:1;for(n=0;n<z;n++){for(s=A?t.features[n].geometry:k?t.geometry:t,_=A?t.features[n].properties:k?t.properties:{},b=A?t.features[n].bbox:k?t.bbox:void 0,M=A?t.features[n].id:k?t.id:void 0,m=s?s.type==="GeometryCollection":!1,u=m?s.geometries.length:1,a=0;a<u;a++){if(l=m?s.geometries[a]:s,l===null){if(e(null,C,_,b,M)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(l,C,_,b,M)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<l.geometries.length;r++)if(e(l.geometries[r],C,_,b,M)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}C++}}function yse(t,e){vse(t,function(n,r,a,l,u){var s=n===null?null:n.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(vP(n,a,{bbox:l,id:u}),r,0)===!1?!1:void 0}var m;switch(s){case"MultiPoint":m="Point";break;case"MultiLineString":m="LineString";break;case"MultiPolygon":m="Polygon";break}for(var _=0;_<n.coordinates.length;_++){var b=n.coordinates[_],M={type:m,coordinates:b};if(e(vP(M,a),r,_)===!1)return!1}})}var _se=Object.defineProperty,xse=Object.defineProperties,bse=Object.getOwnPropertyDescriptors,tz=Object.getOwnPropertySymbols,wse=Object.prototype.hasOwnProperty,Sse=Object.prototype.propertyIsEnumerable,nz=(t,e,n)=>e in t?_se(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Mse=(t,e)=>{for(var n in e||(e={}))wse.call(e,n)&&nz(t,n,e[n]);if(tz)for(var n of tz(e))Sse.call(e,n)&&nz(t,n,e[n]);return t},Ese=(t,e)=>xse(t,bse(e));function Cse(t,e,n={}){if(!t||!e)throw new Error("lines and inputPoint are required arguments");const r=w_(e);let a=ob([1/0,1/0],{lineStringIndex:-1,segmentIndex:-1,totalDistance:-1,lineDistance:-1,segmentDistance:-1,pointDistance:1/0,multiFeatureIndex:-1,index:-1,location:-1,dist:1/0}),l=0,u=0,s=-1;return yse(t,function(m,_,b){s!==b&&(s=b,u=0);const M=gse(m),C=M.length-2;for(let A=0;A<M.length-1;A++){const k=ob(M[A]),z=w_(k),P=ob(M[A+1]),O=w_(P),j=wy(k,P,n);let U,X;O[0]===r[0]&&O[1]===r[1]?[U,X]=[O,!0]:z[0]===r[0]&&z[1]===r[1]?[U,X]=[z,!1]:[U,X]=Ase(z,O,r);const K=wy(e,U,n);if(K<a.properties.pointDistance){const se=wy(k,U,n);a=ob(U,{lineStringIndex:b,segmentIndex:X&&A+1<=C?A+1:A,totalDistance:l+se,lineDistance:u+se,segmentDistance:se,pointDistance:K,multiFeatureIndex:-1,index:-1,location:-1,dist:1/0}),a.properties=Ese(Mse({},a.properties),{multiFeatureIndex:a.properties.lineStringIndex,index:a.properties.segmentIndex,location:a.properties.totalDistance,dist:a.properties.pointDistance})}l+=j,u+=j}}),a}function ag(t,e){const[n,r,a]=t,[l,u,s]=e;return n*l+r*u+a*s}function G0(t,e){const[n,r,a]=t,[l,u,s]=e;return[r*s-a*u,a*l-n*s,n*u-r*l]}function Tse(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2))}function rz(t){const e=Tse(t);return[t[0]/e,t[1]/e,t[2]/e]}function qM(t){const e=ay(t[1]),n=ay(t[0]);return[Math.cos(e)*Math.cos(n),Math.cos(e)*Math.sin(n),Math.sin(e)]}function Pse(t){const[e,n,r]=t,a=Math.min(Math.max(r,-1),1),l=Qk(Math.asin(a));return[Qk(Math.atan2(n,e)),l]}function Ase(t,e,n){const r=qM(t),a=qM(e),l=qM(n),u=G0(r,a);if(u[0]===0&&u[1]===0&&u[2]===0)return ag(r,a)>0?[[...e],!0]:[[...n],!1];const s=G0(u,l);if(s[0]===0&&s[1]===0&&s[2]===0)return[[...e],!0];const m=G0(s,u),_=rz(m),b=[-_[0],-_[1],-_[2]],M=ag(l,_)>ag(l,b)?_:b,C=rz(u),A=ag(G0(r,M),C),k=ag(G0(M,a),C);return A>=0&&k>=0?[Pse(M),!1]:ag(r,l)>ag(a,l)?[[...t],!1]:[[...e],!0]}var Ise=Cse;const Rse=Bs(ae.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),Dse=Bs(ae.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6"})),Lse=Bs(ae.jsx("path",{d:"M10.85 12.65h2.3L12 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM14.3 16l-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9z"})),kse=Bs(ae.jsx("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4"})),zse=Bs(ae.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6"})),iz=Bs(ae.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),Ose=Bs(ae.jsx("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"})),Fse=Bs(ae.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),Nse=Bs(ae.jsx("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"})),Bse=Bs(ae.jsx("path",{d:"m16 5-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2"})),Use=Bs(ae.jsx("path",{d:"M19 5v14H5V5zm1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9M11 7h6v2h-6zm0 4h6v2h-6zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"})),$se=Bs(ae.jsx("path",{d:"M15 11V5l-3-3-3 3v2H3v14h18V11zm-8 8H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm6 8h-2v-2h2zm0-4h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm6 12h-2v-2h2zm0-4h-2v-2h2z"})),Vse=Bs(ae.jsx("path",{d:"M2 18v4h3v-2h5.5v2h3v-2H19v2h3v-4zM18 2H6c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1m-3 6H9V6h6z"})),jse=Bs(ae.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),tU=Bs(ae.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),nU=Bs(ae.jsx("path",{d:"m21.58 16.09-1.09-7.66C20.21 6.46 18.52 5 16.53 5H7.47C5.48 5 3.79 6.46 3.51 8.43l-1.09 7.66C2.2 17.63 3.39 19 4.94 19c.68 0 1.32-.27 1.8-.75L9 16h6l2.25 2.25c.48.48 1.13.75 1.8.75 1.56 0 2.75-1.37 2.53-2.91M11 11H9v2H8v-2H6v-1h2V8h1v2h2zm4-1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2 3c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),Hse=Bs(ae.jsx("path",{d:"M20.69 4.05C18.66 4.73 15.86 5.5 12 5.5c-3.89 0-6.95-.84-8.69-1.43-.64-.22-1.31.26-1.31.95V19c0 .68.66 1.17 1.31.95C5.36 19.26 8.1 18.5 12 18.5c3.87 0 6.66.76 8.69 1.45.65.21 1.31-.27 1.31-.95V5c0-.68-.66-1.16-1.31-.95M12 15c-2.34 0-4.52.15-6.52.41l3.69-4.42 2 2.4L14 10l4.51 5.4c-1.99-.25-4.21-.4-6.51-.4"}));function Gse(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var Dg=1,Lg=2,Sy=3,Wse=4,yP=5,oz=6378137,qse=6356752314e-3,sz=.0066943799901413165,S_=484813681109536e-20,Tn=Math.PI/2,Xse=.16666666666666666,Zse=.04722222222222222,Yse=.022156084656084655,Kn=1e-10,Xs=.017453292519943295,Kh=57.29577951308232,Mi=Math.PI/4,nx=Math.PI*2,Uo=3.14159265359,Rl={};Rl.greenwich=0;Rl.lisbon=-9.131906111111;Rl.paris=2.337229166667;Rl.bogota=-74.080916666667;Rl.madrid=-3.687938888889;Rl.rome=12.452333333333;Rl.bern=7.439583333333;Rl.jakarta=106.807719444444;Rl.ferro=-17.666666666667;Rl.brussels=4.367975;Rl.stockholm=18.058277777778;Rl.athens=23.7163375;Rl.oslo=10.722916666667;const Kse={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var az=/[\s_\-\/\(\)]/g;function Qp(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(az,""),a=-1,l,u;++a<n.length;)if(l=n[a],u=l.toLowerCase().replace(az,""),u===r)return t[l]}function _P(t){var e={},n=t.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,m){var _=m.split("=");return _.push(!0),s[_[0].toLowerCase()]=_[1],s},{}),r,a,l,u={proj:"projName",datum:"datumCode",rf:function(s){e.rf=parseFloat(s)},lat_0:function(s){e.lat0=s*Xs},lat_1:function(s){e.lat1=s*Xs},lat_2:function(s){e.lat2=s*Xs},lat_ts:function(s){e.lat_ts=s*Xs},lon_0:function(s){e.long0=s*Xs},lon_1:function(s){e.long1=s*Xs},lon_2:function(s){e.long2=s*Xs},alpha:function(s){e.alpha=parseFloat(s)*Xs},gamma:function(s){e.rectified_grid_angle=parseFloat(s)},lonc:function(s){e.longc=s*Xs},x_0:function(s){e.x0=parseFloat(s)},y_0:function(s){e.y0=parseFloat(s)},k_0:function(s){e.k0=parseFloat(s)},k:function(s){e.k0=parseFloat(s)},a:function(s){e.a=parseFloat(s)},b:function(s){e.b=parseFloat(s)},r:function(s){e.a=e.b=parseFloat(s)},r_a:function(){e.R_A=!0},zone:function(s){e.zone=parseInt(s,10)},south:function(){e.utmSouth=!0},towgs84:function(s){e.datum_params=s.split(",").map(function(m){return parseFloat(m)})},to_meter:function(s){e.to_meter=parseFloat(s)},units:function(s){e.units=s;var m=Qp(Kse,s);m&&(e.to_meter=m.to_meter)},from_greenwich:function(s){e.from_greenwich=s*Xs},pm:function(s){var m=Qp(Rl,s);e.from_greenwich=(m||parseFloat(s))*Xs},nadgrids:function(s){s==="@null"?e.datumCode="none":e.nadgrids=s},axis:function(s){var m="ewnsud";s.length===3&&m.indexOf(s.substr(0,1))!==-1&&m.indexOf(s.substr(1,1))!==-1&&m.indexOf(s.substr(2,1))!==-1&&(e.axis=s)},approx:function(){e.approx=!0}};for(r in n)a=n[r],r in u?(l=u[r],typeof l=="function"?l(a):e[l]=a):e[r]=a;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var rx=1,rU=2,iU=3,Iw=4,oU=5,YI=-1,Jse=/\s/,Qse=/[A-Za-z]/,eae=/[A-Za-z84_]/,QS=/[,\]]/,sU=/[\d\.E\-\+]/;function wf(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=rx}wf.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==Iw)for(;Jse.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case rx:return this.neutral(t);case rU:return this.keyword(t);case Iw:return this.quoted(t);case oU:return this.afterquote(t);case iU:return this.number(t);case YI:return}};wf.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=Iw;return}if(QS.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};wf.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=rx;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=rx,this.currentObject=this.stack.pop(),this.currentObject||(this.state=YI);return}};wf.prototype.number=function(t){if(sU.test(t)){this.word+=t;return}if(QS.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};wf.prototype.quoted=function(t){if(t==='"'){this.state=oU;return}this.word+=t};wf.prototype.keyword=function(t){if(eae.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=rx;return}if(QS.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};wf.prototype.neutral=function(t){if(Qse.test(t)){this.word=t,this.state=rU;return}if(t==='"'){this.word="",this.state=Iw;return}if(sU.test(t)){this.word=t,this.state=iU;return}if(QS.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};wf.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===YI)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function tae(t){var e=new wf(t);return e.output()}function XM(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,a=n.reduce(function(l,u){return ly(u,l),l},r);e&&(t[e]=a)}function ly(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},ly(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&ly(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&ly(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],XM(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],XM(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return ly(t,e[n]);return XM(e,n,t)}}var nae=.017453292519943295,rae=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function iae(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function jh(t){return t*nae}function aU(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var a=e[n];rae.indexOf(a)!==-1&&oae(t[a]),typeof t[a]=="object"&&aU(t[a])}}function oae(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,a=t.AXIS.length;r<a;++r){var l=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];l[0].indexOf("north")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="north"?n+="n":l[0].indexOf("south")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="south"?n+="s":l[0].indexOf("east")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="east"?n+="e":(l[0].indexOf("west")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var u=t.GEOGCS;t.type==="GEOGCS"&&(u=t),u&&(u.DATUM?t.datumCode=u.DATUM.name.toLowerCase():t.datumCode=u.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),u.DATUM&&u.DATUM.SPHEROID&&(t.ellps=u.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=u.DATUM.SPHEROID.a,t.rf=parseFloat(u.DATUM.SPHEROID.rf,10)),u.DATUM&&u.DATUM.TOWGS84&&(t.datum_params=u.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a);function s(b){var M=t.to_meter||1;return b*M}var m=function(b){return iae(t,b)},_=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",jh],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",jh],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",jh],["lat0","latitude_of_origin",jh],["lat0","standard_parallel_1",jh],["lat1","standard_parallel_1",jh],["lat2","standard_parallel_2",jh],["azimuth","Azimuth"],["alpha","azimuth",jh],["srsCode","name"]];_.forEach(m),!t.long0&&t.longc&&(t.projName==="Albers_Conic_Equal_Area"||t.projName==="Lambert_Azimuthal_Equal_Area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(t.projName==="Stereographic_South_Pole"||t.projName==="Polar Stereographic (variant B)")?(t.lat0=jh(t.lat1>0?90:-90),t.lat_ts=t.lat1):!t.lat_ts&&t.lat0&&t.projName==="Polar_Stereographic"&&(t.lat_ts=t.lat0,t.lat0=jh(t.lat0>0?90:-90))}function lU(t){var e=tae(t),n=e[0],r={};return ly(e,r),aU(r),r[n]}function Ha(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?Ha[t]=_P(arguments[1]):Ha[t]=lU(arguments[1]):Ha[t]=n}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){Array.isArray(r)?Ha.apply(e,r):Ha(r)});if(typeof t=="string"){if(t in Ha)return Ha[t]}else"EPSG"in t?Ha["EPSG:"+t.EPSG]=t:"ESRI"in t?Ha["ESRI:"+t.ESRI]=t:"IAU2000"in t?Ha["IAU2000:"+t.IAU2000]=t:console.log(t);return}}Gse(Ha);function sae(t){return typeof t=="string"}function aae(t){return t in Ha}var lae=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function cae(t){return lae.some(function(e){return t.indexOf(e)>-1})}var uae=["3857","900913","3785","102113"];function hae(t){var e=Qp(t,"authority");if(e){var n=Qp(e,"epsg");return n&&uae.indexOf(n)>-1}}function dae(t){var e=Qp(t,"extension");if(e)return Qp(e,"proj4")}function fae(t){return t[0]==="+"}function pae(t){if(sae(t)){if(aae(t))return Ha[t];if(cae(t)){var e=lU(t);if(hae(e))return Ha["EPSG:3857"];var n=dae(e);return n?_P(n):e}if(fae(t))return _P(t)}else return t}function lz(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function cd(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function $x(t){return t<0?-1:1}function er(t){return Math.abs(t)<=Uo?t:t-$x(t)*nx}function ih(t,e,n){var r=t*n,a=.5*t;return r=Math.pow((1-r)/(1+r),a),Math.tan(.5*(Tn-e))/r}function ix(t,e){for(var n=.5*t,r,a,l=Tn-2*Math.atan(e),u=0;u<=15;u++)if(r=t*Math.sin(l),a=Tn-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-l,l+=a,Math.abs(a)<=1e-10)return l;return-9999}function mae(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=cd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function gae(t){var e=t.x,n=t.y;if(n*Kh>90&&n*Kh<-90&&e*Kh>180&&e*Kh<-180)return null;var r,a;if(Math.abs(Math.abs(n)-Tn)<=Kn)return null;if(this.sphere)r=this.x0+this.a*this.k0*er(e-this.long0),a=this.y0+this.a*this.k0*Math.log(Math.tan(Mi+.5*n));else{var l=Math.sin(n),u=ih(this.e,n,l);r=this.x0+this.a*this.k0*er(e-this.long0),a=this.y0-this.a*this.k0*Math.log(u)}return t.x=r,t.y=a,t}function vae(t){var e=t.x-this.x0,n=t.y-this.y0,r,a;if(this.sphere)a=Tn-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var l=Math.exp(-n/(this.a*this.k0));if(a=ix(this.e,l),a===-9999)return null}return r=er(this.long0+e/(this.a*this.k0)),t.x=r,t.y=a,t}var yae=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const _ae={init:mae,forward:gae,inverse:vae,names:yae};function xae(){}function cz(t){return t}var bae=["longlat","identity"];const wae={init:xae,forward:cz,inverse:cz,names:bae};var Sae=[_ae,wae],ew={},Rw=[];function cU(t,e){var n=Rw.length;return t.names?(Rw[n]=t,t.names.forEach(function(r){ew[r.toLowerCase()]=n}),this):(console.log(e),!0)}function Mae(t){if(!t)return!1;var e=t.toLowerCase();if(typeof ew[e]<"u"&&Rw[ew[e]])return Rw[ew[e]]}function Eae(){Sae.forEach(cU)}const Cae={start:Eae,add:cU,get:Mae};var Er={};Er.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Er.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Er.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Er.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Er.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Er.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Er.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Er.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Er.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Er.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Er.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Er.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Er.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Er.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Er.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Er.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Er.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Er.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Er.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Er.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Er.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Er.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Er.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Er.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Er.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Er.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Er.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Er.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Er.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Er.hough={a:6378270,rf:297,ellipseName:"Hough"};Er.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Er.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Er.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Er.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Er.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Er.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Er.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Er.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Er.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Er.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Er.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Er.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Tae=Er.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Er.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Pae(t,e,n,r){var a=t*t,l=e*e,u=(a-l)/a,s=0;r?(t*=1-u*(Xse+u*(Zse+u*Yse)),a=t*t,u=0):s=Math.sqrt(u);var m=(a-l)/l;return{es:u,e:s,ep2:m}}function Aae(t,e,n,r,a){if(!t){var l=Qp(Er,r);l||(l=Tae),t=l.a,e=l.b,n=l.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<Kn)&&(a=!0,e=t),{a:t,b:e,rf:n,sphere:a}}var tw={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var Iae in tw){var uz=tw[Iae];tw[uz.datumName]=uz}function Rae(t,e,n,r,a,l,u){var s={};return t===void 0||t==="none"?s.datum_type=yP:s.datum_type=Wse,e&&(s.datum_params=e.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=Dg),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=Lg,s.datum_params[3]*=S_,s.datum_params[4]*=S_,s.datum_params[5]*=S_,s.datum_params[6]=s.datum_params[6]/1e6+1)),u&&(s.datum_type=Sy,s.grids=u),s.a=n,s.b=r,s.es=a,s.ep2=l,s}var uU={};function Dae(t,e){var n=new DataView(e),r=zae(n),a=Oae(n,r),l=Fae(n,a,r),u={header:a,subgrids:l};return uU[t]=u,u}function Lae(t){if(t===void 0)return null;var e=t.split(",");return e.map(kae)}function kae(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:uU[t]||null,isNull:!1}}function cy(t){return t/3600*Math.PI/180}function zae(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Oae(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:xP(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function xP(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Fae(t,e,n){for(var r=176,a=[],l=0;l<e.nSubgrids;l++){var u=Bae(t,r,n),s=Uae(t,r,u,n),m=Math.round(1+(u.upperLongitude-u.lowerLongitude)/u.longitudeInterval),_=Math.round(1+(u.upperLatitude-u.lowerLatitude)/u.latitudeInterval);a.push({ll:[cy(u.lowerLongitude),cy(u.lowerLatitude)],del:[cy(u.longitudeInterval),cy(u.latitudeInterval)],lim:[m,_],count:u.gridNodeCount,cvs:Nae(s)}),r+=176+u.gridNodeCount*16}return a}function Nae(t){return t.map(function(e){return[cy(e.longitudeShift),cy(e.latitudeShift)]})}function Bae(t,e,n){return{name:xP(t,e+8,e+16).trim(),parent:xP(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Uae(t,e,n,r){for(var a=e+176,l=16,u=[],s=0;s<n.gridNodeCount;s++){var m={latitudeShift:t.getFloat32(a+s*l,r),longitudeShift:t.getFloat32(a+s*l+4,r),latitudeAccuracy:t.getFloat32(a+s*l+8,r),longitudeAccuracy:t.getFloat32(a+s*l+12,r)};u.push(m)}return u}function rd(t,e){if(!(this instanceof rd))return new rd(t);e=e||function(_){if(_)throw _};var n=pae(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=rd.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var a=Qp(tw,n.datumCode);a&&(n.datum_params=n.datum_params||(a.towgs84?a.towgs84.split(","):null),n.ellps=a.ellipse,n.datumName=a.datumName?a.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var l=Aae(n.a,n.b,n.rf,n.ellps,n.sphere),u=Pae(l.a,l.b,l.rf,n.R_A),s=Lae(n.nadgrids),m=n.datum||Rae(n.datumCode,n.datum_params,l.a,l.b,u.es,u.ep2,s);lz(this,n),lz(this,r),this.a=l.a,this.b=l.b,this.rf=l.rf,this.sphere=l.sphere,this.es=u.es,this.e=u.e,this.ep2=u.ep2,this.datum=m,this.init(),e(null,this)}rd.projections=Cae;rd.projections.start();function $ae(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===Dg?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===Lg?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function hU(t,e,n){var r=t.x,a=t.y,l=t.z?t.z:0,u,s,m,_;if(a<-Tn&&a>-1.001*Tn)a=-Tn;else if(a>Tn&&a<1.001*Tn)a=Tn;else{if(a<-Tn)return{x:-1/0,y:-1/0,z:t.z};if(a>Tn)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),s=Math.sin(a),_=Math.cos(a),m=s*s,u=n/Math.sqrt(1-e*m),{x:(u+l)*_*Math.cos(r),y:(u+l)*_*Math.sin(r),z:(u*(1-e)+l)*s}}function dU(t,e,n,r){var a=1e-12,l=a*a,u=30,s,m,_,b,M,C,A,k,z,P,O,j,U,X=t.x,K=t.y,se=t.z?t.z:0,J,ue,ne;if(s=Math.sqrt(X*X+K*K),m=Math.sqrt(X*X+K*K+se*se),s/n<a){if(J=0,m/n<a)return ue=Tn,ne=-r,{x:t.x,y:t.y,z:t.z}}else J=Math.atan2(K,X);_=se/m,b=s/m,M=1/Math.sqrt(1-e*(2-e)*b*b),k=b*(1-e)*M,z=_*M,U=0;do U++,A=n/Math.sqrt(1-e*z*z),ne=s*k+se*z-A*(1-e*z*z),C=e*A/(A+ne),M=1/Math.sqrt(1-C*(2-C)*b*b),P=b*(1-C)*M,O=_*M,j=O*k-P*z,k=P,z=O;while(j*j>l&&U<u);return ue=Math.atan(O/Math.abs(P)),{x:J,y:ue,z:ne}}function Vae(t,e,n){if(e===Dg)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===Lg){var r=n[0],a=n[1],l=n[2],u=n[3],s=n[4],m=n[5],_=n[6];return{x:_*(t.x-m*t.y+s*t.z)+r,y:_*(m*t.x+t.y-u*t.z)+a,z:_*(-s*t.x+u*t.y+t.z)+l}}}function jae(t,e,n){if(e===Dg)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===Lg){var r=n[0],a=n[1],l=n[2],u=n[3],s=n[4],m=n[5],_=n[6],b=(t.x-r)/_,M=(t.y-a)/_,C=(t.z-l)/_;return{x:b+m*M-s*C,y:-m*b+M+u*C,z:s*b-u*M+C}}}function sb(t){return t===Dg||t===Lg}function Hae(t,e,n){if($ae(t,e)||t.datum_type===yP||e.datum_type===yP)return n;var r=t.a,a=t.es;if(t.datum_type===Sy){var l=hz(t,!1,n);if(l!==0)return;r=oz,a=sz}var u=e.a,s=e.b,m=e.es;if(e.datum_type===Sy&&(u=oz,s=qse,m=sz),a===m&&r===u&&!sb(t.datum_type)&&!sb(e.datum_type))return n;if(n=hU(n,a,r),sb(t.datum_type)&&(n=Vae(n,t.datum_type,t.datum_params)),sb(e.datum_type)&&(n=jae(n,e.datum_type,e.datum_params)),n=dU(n,m,u,s),e.datum_type===Sy){var _=hz(e,!0,n);if(_!==0)return}return n}function hz(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},a={x:Number.NaN,y:Number.NaN},l=[];e:for(var u=0;u<t.grids.length;u++){var s=t.grids[u];if(l.push(s.name),s.isNull){a=r;break}if(s.mandatory,s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}for(var m=s.grid.subgrids,_=0,b=m.length;_<b;_++){var M=m[_],C=(Math.abs(M.del[1])+Math.abs(M.del[0]))/1e4,A=M.ll[0]-C,k=M.ll[1]-C,z=M.ll[0]+(M.lim[0]-1)*M.del[0]+C,P=M.ll[1]+(M.lim[1]-1)*M.del[1]+C;if(!(k>r.y||A>r.x||P<r.y||z<r.x)&&(a=Gae(r,e,M),!isNaN(a.x)))break e}}return isNaN(a.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Kh+" "+r.y*Kh+" tried: '"+l+"'"),-1):(n.x=-a.x,n.y=a.y,0)}function Gae(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var a={x:t.x,y:t.y};a.x-=n.ll[0],a.y-=n.ll[1],a.x=er(a.x-Math.PI)+Math.PI;var l=dz(a,n);if(e){if(isNaN(l.x))return r;l.x=a.x-l.x,l.y=a.y-l.y;var u=9,s=1e-12,m,_;do{if(_=dz(l,n),isNaN(_.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}m={x:a.x-(_.x+l.x),y:a.y-(_.y+l.y)},l.x+=m.x,l.y+=m.y}while(u--&&Math.abs(m.x)>s&&Math.abs(m.y)>s);if(u<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=er(l.x+n.ll[0]),r.y=l.y+n.ll[1]}else isNaN(l.x)||(r.x=t.x+l.x,r.y=t.y+l.y);return r}function dz(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},a={x:n.x-1*r.x,y:n.y-1*r.y},l={x:Number.NaN,y:Number.NaN},u;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return l;u=r.y*e.lim[0]+r.x;var s={x:e.cvs[u][0],y:e.cvs[u][1]};u++;var m={x:e.cvs[u][0],y:e.cvs[u][1]};u+=e.lim[0];var _={x:e.cvs[u][0],y:e.cvs[u][1]};u--;var b={x:e.cvs[u][0],y:e.cvs[u][1]},M=a.x*a.y,C=a.x*(1-a.y),A=(1-a.x)*(1-a.y),k=(1-a.x)*a.y;return l.x=A*s.x+C*m.x+k*b.x+M*_.x,l.y=A*s.y+C*m.y+k*b.y+M*_.y,l}function fz(t,e,n){var r=n.x,a=n.y,l=n.z||0,u,s,m,_={};for(m=0;m<3;m++)if(!(e&&m===2&&n.z===void 0))switch(m===0?(u=r,"ew".indexOf(t.axis[m])!==-1?s="x":s="y"):m===1?(u=a,"ns".indexOf(t.axis[m])!==-1?s="y":s="x"):(u=l,s="z"),t.axis[m]){case"e":_[s]=u;break;case"w":_[s]=-u;break;case"n":_[s]=u;break;case"s":_[s]=-u;break;case"u":n[s]!==void 0&&(_.z=u);break;case"d":n[s]!==void 0&&(_.z=-u);break;default:return null}return _}function fU(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Wae(t){pz(t.x),pz(t.y)}function pz(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function qae(t,e){return(t.datum.datum_type===Dg||t.datum.datum_type===Lg||t.datum.datum_type===Sy)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Dg||e.datum.datum_type===Lg||e.datum.datum_type===Sy)&&t.datumCode!=="WGS84"}function Dw(t,e,n,r){var a;Array.isArray(n)?n=fU(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var l=n.z!==void 0;if(Wae(n),t.datum&&e.datum&&qae(t,e)&&(a=new rd("WGS84"),n=Dw(t,a,n,r),t=a),r&&t.axis!=="enu"&&(n=fz(t,!1,n)),t.projName==="longlat")n={x:n.x*Xs,y:n.y*Xs,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=Hae(t.datum,e.datum,n),!!n)return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*Kh,y:n.y*Kh,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?fz(e,!0,n):(n&&!l&&delete n.z,n)}var mz=rd("WGS84");function ZM(t,e,n,r){var a,l,u;return Array.isArray(n)?(a=Dw(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof a.z=="number"?[a.x,a.y,a.z].concat(n.slice(3)):[a.x,a.y,n[2]].concat(n.slice(3)):[a.x,a.y].concat(n.slice(2)):[a.x,a.y]):(l=Dw(t,e,n,r),u=Object.keys(n),u.length===2||u.forEach(function(s){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;l[s]=n[s]}),l)}function gz(t){return t instanceof rd?t:t.oProj?t.oProj:rd(t)}function Al(t,e,n){t=gz(t);var r=!1,a;return typeof e>"u"?(e=t,t=mz,r=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,e=t,t=mz,r=!0),e=gz(e),n?ZM(t,e,n):(a={forward:function(l,u){return ZM(t,e,l,u)},inverse:function(l,u){return ZM(e,t,l,u)}},r&&(a.oProj=e),a)}var vz=6,pU="AJSAJS",mU="AFAFAF",uy=65,_l=73,Zc=79,l_=86,c_=90;const Xae={forward:gU,inverse:Zae,toPoint:vU};function gU(t,e){return e=e||5,Jae(Yae({lat:t[1],lon:t[0]}),e)}function Zae(t){var e=KI(_U(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function vU(t){var e=KI(_U(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function YM(t){return t*(Math.PI/180)}function yz(t){return 180*(t/Math.PI)}function Yae(t){var e=t.lat,n=t.lon,r=6378137,a=.00669438,l=.9996,u,s,m,_,b,M,C,A=YM(e),k=YM(n),z,P;P=Math.floor((n+180)/6)+1,n===180&&(P=60),e>=56&&e<64&&n>=3&&n<12&&(P=32),e>=72&&e<84&&(n>=0&&n<9?P=31:n>=9&&n<21?P=33:n>=21&&n<33?P=35:n>=33&&n<42&&(P=37)),u=(P-1)*6-180+3,z=YM(u),s=a/(1-a),m=r/Math.sqrt(1-a*Math.sin(A)*Math.sin(A)),_=Math.tan(A)*Math.tan(A),b=s*Math.cos(A)*Math.cos(A),M=Math.cos(A)*(k-z),C=r*((1-a/4-3*a*a/64-5*a*a*a/256)*A-(3*a/8+3*a*a/32+45*a*a*a/1024)*Math.sin(2*A)+(15*a*a/256+45*a*a*a/1024)*Math.sin(4*A)-35*a*a*a/3072*Math.sin(6*A));var O=l*m*(M+(1-_+b)*M*M*M/6+(5-18*_+_*_+72*b-58*s)*M*M*M*M*M/120)+5e5,j=l*(C+m*Math.tan(A)*(M*M/2+(5-_+9*b+4*b*b)*M*M*M*M/24+(61-58*_+_*_+600*b-330*s)*M*M*M*M*M*M/720));return e<0&&(j+=1e7),{northing:Math.round(j),easting:Math.round(O),zoneNumber:P,zoneLetter:Kae(e)}}function KI(t){var e=t.northing,n=t.easting,r=t.zoneLetter,a=t.zoneNumber;if(a<0||a>60)return null;var l=.9996,u=6378137,s=.00669438,m,_=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),b,M,C,A,k,z,P,O,j,U=n-5e5,X=e;r<"N"&&(X-=1e7),P=(a-1)*6-180+3,m=s/(1-s),z=X/l,O=z/(u*(1-s/4-3*s*s/64-5*s*s*s/256)),j=O+(3*_/2-27*_*_*_/32)*Math.sin(2*O)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*O)+151*_*_*_/96*Math.sin(6*O),b=u/Math.sqrt(1-s*Math.sin(j)*Math.sin(j)),M=Math.tan(j)*Math.tan(j),C=m*Math.cos(j)*Math.cos(j),A=u*(1-s)/Math.pow(1-s*Math.sin(j)*Math.sin(j),1.5),k=U/(b*l);var K=j-b*Math.tan(j)/A*(k*k/2-(5+3*M+10*C-4*C*C-9*m)*k*k*k*k/24+(61+90*M+298*C+45*M*M-252*m-3*C*C)*k*k*k*k*k*k/720);K=yz(K);var se=(k-(1+2*M+C)*k*k*k/6+(5-2*C+28*M-3*C*C+8*m+24*M*M)*k*k*k*k*k/120)/Math.cos(j);se=P+yz(se);var J;if(t.accuracy){var ue=KI({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});J={top:ue.lat,right:ue.lon,bottom:K,left:se}}else J={lat:K,lon:se};return J}function Kae(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Jae(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+Qae(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function Qae(t,e,n){var r=yU(n),a=Math.floor(t/1e5),l=Math.floor(e/1e5)%20;return ele(a,l,r)}function yU(t){var e=t%vz;return e===0&&(e=vz),e}function ele(t,e,n){var r=n-1,a=pU.charCodeAt(r),l=mU.charCodeAt(r),u=a+t-1,s=l+e,m=!1;u>c_&&(u=u-c_+uy-1,m=!0),(u===_l||a<_l&&u>_l||(u>_l||a<_l)&&m)&&u++,(u===Zc||a<Zc&&u>Zc||(u>Zc||a<Zc)&&m)&&(u++,u===_l&&u++),u>c_&&(u=u-c_+uy-1),s>l_?(s=s-l_+uy-1,m=!0):m=!1,(s===_l||l<_l&&s>_l||(s>_l||l<_l)&&m)&&s++,(s===Zc||l<Zc&&s>Zc||(s>Zc||l<Zc)&&m)&&(s++,s===_l&&s++),s>l_&&(s=s-l_+uy-1);var _=String.fromCharCode(u)+String.fromCharCode(s);return _}function _U(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",a,l=0;!/[A-Z]/.test(a=t.charAt(l));){if(l>=2)throw"MGRSPoint bad conversion from: "+t;r+=a,l++}var u=parseInt(r,10);if(l===0||l+3>e)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(l++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+t;n=t.substring(l,l+=2);for(var m=yU(u),_=tle(n.charAt(0),m),b=nle(n.charAt(1),m);b<rle(s);)b+=2e6;var M=e-l;if(M%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var C=M/2,A=0,k=0,z,P,O,j,U;return C>0&&(z=1e5/Math.pow(10,C),P=t.substring(l,l+C),A=parseFloat(P)*z,O=t.substring(l+C),k=parseFloat(O)*z),j=A+_,U=k+b,{easting:j,northing:U,zoneLetter:s,zoneNumber:u,accuracy:z}}function tle(t,e){for(var n=pU.charCodeAt(e-1),r=1e5,a=!1;n!==t.charCodeAt(0);){if(n++,n===_l&&n++,n===Zc&&n++,n>c_){if(a)throw"Bad character: "+t;n=uy,a=!0}r+=1e5}return r}function nle(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=mU.charCodeAt(e-1),r=0,a=!1;n!==t.charCodeAt(0);){if(n++,n===_l&&n++,n===Zc&&n++,n>l_){if(a)throw"Bad character: "+t;n=uy,a=!0}r+=1e5}return r}function rle(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Uy(t,e,n){if(!(this instanceof Uy))return new Uy(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Uy.fromMGRS=function(t){return new Uy(vU(t))};Uy.prototype.toMGRS=function(t){return gU([this.x,this.y],t)};var ile=1,ole=.25,_z=.046875,xz=.01953125,bz=.01068115234375,sle=.75,ale=.46875,lle=.013020833333333334,cle=.007120768229166667,ule=.3645833333333333,hle=.005696614583333333,dle=.3076171875;function JI(t){var e=[];e[0]=ile-t*(ole+t*(_z+t*(xz+t*bz))),e[1]=t*(sle-t*(_z+t*(xz+t*bz)));var n=t*t;return e[2]=n*(ale-t*(lle+t*cle)),n*=t,e[3]=n*(ule-t*hle),e[4]=n*t*dle,e}function Yy(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var fle=20;function QI(t,e,n){for(var r=1/(1-e),a=t,l=fle;l;--l){var u=Math.sin(a),s=1-e*u*u;if(s=(Yy(a,u,Math.cos(a),n)-t)*(s*Math.sqrt(s))*r,a-=s,Math.abs(s)<Kn)return a}return a}function ple(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=JI(this.es),this.ml0=Yy(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function mle(t){var e=t.x,n=t.y,r=er(e-this.long0),a,l,u,s=Math.sin(n),m=Math.cos(n);if(this.es){var b=m*r,M=Math.pow(b,2),C=this.ep2*Math.pow(m,2),A=Math.pow(C,2),k=Math.abs(m)>Kn?Math.tan(n):0,z=Math.pow(k,2),P=Math.pow(z,2);a=1-this.es*Math.pow(s,2),b=b/Math.sqrt(a);var O=Yy(n,s,m,this.en);l=this.a*(this.k0*b*(1+M/6*(1-z+C+M/20*(5-18*z+P+14*C-58*z*C+M/42*(61+179*P-P*z-479*z)))))+this.x0,u=this.a*(this.k0*(O-this.ml0+s*r*b/2*(1+M/12*(5-z+9*C+4*A+M/30*(61+P-58*z+270*C-330*z*C+M/56*(1385+543*P-P*z-3111*z))))))+this.y0}else{var _=m*Math.sin(r);if(Math.abs(Math.abs(_)-1)<Kn)return 93;if(l=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,u=m*Math.cos(r)/Math.sqrt(1-Math.pow(_,2)),_=Math.abs(u),_>=1){if(_-1>Kn)return 93;u=0}else u=Math.acos(u);n<0&&(u=-u),u=this.a*this.k0*(u-this.lat0)+this.y0}return t.x=l,t.y=u,t}function gle(t){var e,n,r,a,l=(t.x-this.x0)*(1/this.a),u=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+u/this.k0,n=QI(e,this.es,this.en),Math.abs(n)<Tn){var M=Math.sin(n),C=Math.cos(n),A=Math.abs(C)>Kn?Math.tan(n):0,k=this.ep2*Math.pow(C,2),z=Math.pow(k,2),P=Math.pow(A,2),O=Math.pow(P,2);e=1-this.es*Math.pow(M,2);var j=l*Math.sqrt(e)/this.k0,U=Math.pow(j,2);e=e*A,r=n-e*U/(1-this.es)*.5*(1-U/12*(5+3*P-9*k*P+k-4*z-U/30*(61+90*P-252*k*P+45*O+46*k-U/56*(1385+3633*P+4095*O+1574*O*P)))),a=er(this.long0+j*(1-U/6*(1+2*P+k-U/20*(5+28*P+24*O+8*k*P+6*k-U/42*(61+662*P+1320*O+720*O*P))))/C)}else r=Tn*$x(u),a=0;else{var s=Math.exp(l/this.k0),m=.5*(s-1/s),_=this.lat0+u/this.k0,b=Math.cos(_);e=Math.sqrt((1-Math.pow(b,2))/(1+Math.pow(m,2))),r=Math.asin(e),u<0&&(r=-r),m===0&&b===0?a=0:a=er(Math.atan2(m,b)+this.long0)}return t.x=a,t.y=r,t}var vle=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const nw={init:ple,forward:mle,inverse:gle,names:vle};function xU(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function bl(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function yle(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function _le(t){var e=Math.abs(t);return e=yle(e*(1+e/(bl(1,e)+1))),t<0?-e:e}function eR(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,a=t[r],l=0,u;--r>=0;)u=-l+n*a+t[r],l=a,a=u;return e+u*Math.sin(2*e)}function xle(t,e){for(var n=2*Math.cos(e),r=t.length-1,a=t[r],l=0,u;--r>=0;)u=-l+n*a+t[r],l=a,a=u;return Math.sin(e)*u}function ble(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function bU(t,e,n){for(var r=Math.sin(e),a=Math.cos(e),l=xU(n),u=ble(n),s=2*a*u,m=-2*r*l,_=t.length-1,b=t[_],M=0,C=0,A=0,k,z;--_>=0;)k=C,z=M,C=b,M=A,b=-k+s*C-m*M+t[_],A=-z+m*C+s*M;return s=r*u,m=a*l,[s*b-m*A,s*A+m*b]}function wle(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(nw.init.apply(this),this.forward=nw.forward,this.inverse=nw.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=eR(this.cbg,this.lat0);this.Zb=-this.Qn*(r+xle(this.gtu,2*r))}function Sle(t){var e=er(t.x-this.long0),n=t.y;n=eR(this.cbg,n);var r=Math.sin(n),a=Math.cos(n),l=Math.sin(e),u=Math.cos(e);n=Math.atan2(r,u*a),e=Math.atan2(l*a,bl(r,a*u)),e=_le(Math.tan(e));var s=bU(this.gtu,2*n,2*e);n=n+s[0],e=e+s[1];var m,_;return Math.abs(e)<=2.623395162778?(m=this.a*(this.Qn*e)+this.x0,_=this.a*(this.Qn*n+this.Zb)+this.y0):(m=1/0,_=1/0),t.x=m,t.y=_,t}function Mle(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,a;if(Math.abs(e)<=2.623395162778){var l=bU(this.utg,2*n,2*e);n=n+l[0],e=e+l[1],e=Math.atan(xU(e));var u=Math.sin(n),s=Math.cos(n),m=Math.sin(e),_=Math.cos(e);n=Math.atan2(u*_,bl(m,_*s)),e=Math.atan2(m,_*s),r=er(e+this.long0),a=eR(this.cgb,n)}else r=1/0,a=1/0;return t.x=r,t.y=a,t}var Ele=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const rw={init:wle,forward:Sle,inverse:Mle,names:Ele};function Cle(t,e){if(t===void 0){if(t=Math.floor((er(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var Tle="etmerc";function Ple(){var t=Cle(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Xs,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,rw.init.apply(this),this.forward=rw.forward,this.inverse=rw.inverse}var Ale=["Universal Transverse Mercator System","utm"];const Ile={init:Ple,names:Ale,dependsOn:Tle};function tR(t,e){return Math.pow((1-t)/(1+t),e)}var Rle=20;function Dle(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Mi)/(Math.pow(Math.tan(.5*this.lat0+Mi),this.C)*tR(this.e*t,this.ratexp))}function Lle(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Mi),this.C)*tR(this.e*Math.sin(n),this.ratexp))-Tn,t.x=this.C*e,t}function kle(t){for(var e=1e-14,n=t.x/this.C,r=t.y,a=Math.pow(Math.tan(.5*r+Mi)/this.K,1/this.C),l=Rle;l>0&&(r=2*Math.atan(a*tR(this.e*Math.sin(t.y),-.5*this.e))-Tn,!(Math.abs(r-t.y)<e));--l)t.y=r;return l?(t.x=n,t.y=r,t):null}const nR={init:Dle,forward:Lle,inverse:kle};function zle(){nR.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Ole(t){var e,n,r,a;return t.x=er(t.x-this.long0),nR.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),a=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=a*n*Math.sin(t.x),t.y=a*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Fle(t){var e,n,r,a,l;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,l=bl(t.x,t.y)){var u=2*Math.atan2(l,this.R2);e=Math.sin(u),n=Math.cos(u),a=Math.asin(n*this.sinc0+t.y*e*this.cosc0/l),r=Math.atan2(t.x*e,l*this.cosc0*n-t.y*this.sinc0*e)}else a=this.phic0,r=0;return t.x=r,t.y=a,nR.inverse.apply(this,[t]),t.x=er(t.x+this.long0),t}var Nle=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Ble={init:zle,forward:Ole,inverse:Fle,names:Nle};function Ule(t,e,n){return e*=n,Math.tan(.5*(Tn+t))*Math.pow((1-e)/(1+e),.5*n)}function $le(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Kn&&(this.k0=.5*(1+$x(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Kn&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Kn&&Math.abs(Math.cos(this.lat_ts))>Kn&&(this.k0=.5*this.cons*cd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ih(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=cd(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Tn,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Vle(t){var e=t.x,n=t.y,r=Math.sin(n),a=Math.cos(n),l,u,s,m,_,b,M=er(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=Kn&&Math.abs(n+this.lat0)<=Kn?(t.x=NaN,t.y=NaN,t):this.sphere?(l=2*this.k0/(1+this.sinlat0*r+this.coslat0*a*Math.cos(M)),t.x=this.a*l*a*Math.sin(M)+this.x0,t.y=this.a*l*(this.coslat0*r-this.sinlat0*a*Math.cos(M))+this.y0,t):(u=2*Math.atan(this.ssfn_(n,r,this.e))-Tn,m=Math.cos(u),s=Math.sin(u),Math.abs(this.coslat0)<=Kn?(_=ih(this.e,n*this.con,this.con*r),b=2*this.a*this.k0*_/this.cons,t.x=this.x0+b*Math.sin(e-this.long0),t.y=this.y0-this.con*b*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<Kn?(l=2*this.a*this.k0/(1+m*Math.cos(M)),t.y=l*s):(l=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*m*Math.cos(M))),t.y=l*(this.cosX0*s-this.sinX0*m*Math.cos(M))+this.y0),t.x=l*m*Math.sin(M)+this.x0,t))}function jle(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,a,l,u=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(u/(2*this.a*this.k0));return e=this.long0,n=this.lat0,u<=Kn?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/u),Math.abs(this.coslat0)<Kn?this.lat0>0?e=er(this.long0+Math.atan2(t.x,-1*t.y)):e=er(this.long0+Math.atan2(t.x,t.y)):e=er(this.long0+Math.atan2(t.x*Math.sin(s),u*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=Kn){if(u<=Kn)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=u*this.cons/(2*this.a*this.k0),n=this.con*ix(this.e,r),e=this.con*er(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else a=2*Math.atan(u*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,u<=Kn?l=this.X0:(l=Math.asin(Math.cos(a)*this.sinX0+t.y*Math.sin(a)*this.cosX0/u),e=er(this.long0+Math.atan2(t.x*Math.sin(a),u*this.cosX0*Math.cos(a)-t.y*this.sinX0*Math.sin(a)))),n=-1*ix(this.e,Math.tan(.5*(Tn+l)));return t.x=e,t.y=n,t}var Hle=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const Gle={init:$le,forward:Vle,inverse:jle,names:Hle,ssfn_:Ule};function Wle(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,a=1/r,l=2*a-Math.pow(a,2),u=this.e=Math.sqrt(l);this.R=this.k0*n*Math.sqrt(1-l)/(1-l*Math.pow(e,2)),this.alpha=Math.sqrt(1+l/(1-l)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),m=Math.log(Math.tan(Math.PI/4+t/2)),_=Math.log((1+u*e)/(1-u*e));this.K=s-this.alpha*m+this.alpha*u/2*_}function qle(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,a=2*(Math.atan(Math.exp(r))-Math.PI/4),l=this.alpha*(t.x-this.lambda0),u=Math.atan(Math.sin(l)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(l))),s=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(l));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*u+this.x0,t}function Xle(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,a=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),l=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(r)),u=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(a))),s=this.lambda0+u/this.alpha,m=0,_=l,b=-1e3,M=0;Math.abs(_-b)>1e-7;){if(++M>20)return;m=1/this.alpha*(Math.log(Math.tan(Math.PI/4+l/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(_))/2)),b=_,_=2*Math.atan(Math.exp(m))-Math.PI/2}return t.x=s,t.y=_,t}var Zle=["somerc"];const Yle={init:Wle,forward:qle,inverse:Xle,names:Zle};var Qv=1e-7;function Kle(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.PROJECTION=="object"?Object.keys(t.PROJECTION)[0]:t.PROJECTION;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1}function Jle(){var t,e,n,r,a,l,u,s,m,_,b=0,M,C=0,A=0,k=0,z=0,P=0,O=0;this.no_off=Kle(this),this.no_rot="no_rot"in this;var j=!1;"alpha"in this&&(j=!0);var U=!1;if("rectified_grid_angle"in this&&(U=!0),j&&(O=this.alpha),U&&(b=this.rectified_grid_angle*Xs),j||U)C=this.longc;else if(A=this.long1,z=this.lat1,k=this.long2,P=this.lat2,Math.abs(z-P)<=Qv||(t=Math.abs(z))<=Qv||Math.abs(t-Tn)<=Qv||Math.abs(Math.abs(this.lat0)-Tn)<=Qv||Math.abs(Math.abs(P)-Tn)<=Qv)throw new Error;var X=1-this.es;e=Math.sqrt(X),Math.abs(this.lat0)>Kn?(s=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*s*s,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/X),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),a=r*r-1,a<=0?a=0:(a=Math.sqrt(a),this.lat0<0&&(a=-a)),this.E=a+=r,this.E*=Math.pow(ih(this.e,this.lat0,s),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=a=1),j||U?(j?(M=Math.asin(Math.sin(O)/r),U||(b=O)):(M=b,O=Math.asin(r*Math.sin(M))),this.lam0=C-Math.asin(.5*(a-1/a)*Math.tan(M))/this.B):(l=Math.pow(ih(this.e,z,Math.sin(z)),this.B),u=Math.pow(ih(this.e,P,Math.sin(P)),this.B),a=this.E/l,m=(u-l)/(u+l),_=this.E*this.E,_=(_-u*l)/(_+u*l),t=A-k,t<-Math.pi?k-=nx:t>Math.pi&&(k+=nx),this.lam0=er(.5*(A+k)-Math.atan(_*Math.tan(.5*this.B*(A-k))/m)/this.B),M=Math.atan(2*Math.sin(this.B*er(A-this.lam0))/(a-1/a)),b=O=Math.asin(r*Math.sin(M))),this.singam=Math.sin(M),this.cosgam=Math.cos(M),this.sinrot=Math.sin(b),this.cosrot=Math.cos(b),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(O))),this.lat0<0&&(this.u_0=-this.u_0)),a=.5*M,this.v_pole_n=this.ArB*Math.log(Math.tan(Mi-a)),this.v_pole_s=this.ArB*Math.log(Math.tan(Mi+a))}function Qle(t){var e={},n,r,a,l,u,s,m,_;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-Tn)>Kn){if(u=this.E/Math.pow(ih(this.e,t.y,Math.sin(t.y)),this.B),s=1/u,n=.5*(u-s),r=.5*(u+s),l=Math.sin(this.B*t.x),a=(n*this.singam-l*this.cosgam)/r,Math.abs(Math.abs(a)-1)<Kn)throw new Error;_=.5*this.ArB*Math.log((1-a)/(1+a)),s=Math.cos(this.B*t.x),Math.abs(s)<Qv?m=this.A*t.x:m=this.ArB*Math.atan2(n*this.cosgam+l*this.singam,s)}else _=t.y>0?this.v_pole_n:this.v_pole_s,m=this.ArB*t.y;return this.no_rot?(e.x=m,e.y=_):(m-=this.u_0,e.x=_*this.cosrot+m*this.sinrot,e.y=m*this.cosrot-_*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function ece(t){var e,n,r,a,l,u,s,m={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),a=.5*(r-1/r),l=.5*(r+1/r),u=Math.sin(this.BrA*e),s=(u*this.cosgam+a*this.singam)/l,Math.abs(Math.abs(s)-1)<Kn)m.x=0,m.y=s<0?-Tn:Tn;else{if(m.y=this.E/Math.sqrt((1+s)/(1-s)),m.y=ix(this.e,Math.pow(m.y,1/this.B)),m.y===1/0)throw new Error;m.x=-this.rB*Math.atan2(a*this.cosgam-u*this.singam,Math.cos(this.BrA*e))}return m.x+=this.lam0,m}var tce=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const nce={init:Jle,forward:Qle,inverse:ece,names:tce};function rce(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Kn)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=cd(this.e,e,n),a=ih(this.e,this.lat1,e),l=Math.sin(this.lat2),u=Math.cos(this.lat2),s=cd(this.e,l,u),m=ih(this.e,this.lat2,l),_=ih(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Kn?this.ns=Math.log(r/s)/Math.log(a/m):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(_,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function ice(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=Kn&&(n=$x(n)*(Tn-2*Kn));var r=Math.abs(Math.abs(n)-Tn),a,l;if(r>Kn)a=ih(this.e,n,Math.sin(n)),l=this.a*this.f0*Math.pow(a,this.ns);else{if(r=n*this.ns,r<=0)return null;l=0}var u=this.ns*er(e-this.long0);return t.x=this.k0*(l*Math.sin(u))+this.x0,t.y=this.k0*(this.rh-l*Math.cos(u))+this.y0,t}function oce(t){var e,n,r,a,l,u=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(u*u+s*s),n=1):(e=-Math.sqrt(u*u+s*s),n=-1);var m=0;if(e!==0&&(m=Math.atan2(n*u,n*s)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),a=ix(this.e,r),a===-9999)return null}else a=-Tn;return l=er(m/this.ns+this.long0),t.x=l,t.y=a,t}var sce=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const ace={init:rce,forward:ice,inverse:oce,names:sce};function lce(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function cce(t){var e,n,r,a,l,u,s,m=t.x,_=t.y,b=er(m-this.long0);return e=Math.pow((1+this.e*Math.sin(_))/(1-this.e*Math.sin(_)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(_/2+this.s45),this.alfa)/e)-this.s45),r=-b*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),l=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(a)),u=this.n*l,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n),t.y=s*Math.cos(u)/1,t.x=s*Math.sin(u)/1,this.czech||(t.y*=-1,t.x*=-1),t}function uce(t){var e,n,r,a,l,u,s,m,_=t.x;t.x=t.y,t.y=_,this.czech||(t.y*=-1,t.x*=-1),u=Math.sqrt(t.x*t.x+t.y*t.y),l=Math.atan2(t.y,t.x),a=l/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/u,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(a)),n=Math.asin(Math.cos(r)*Math.sin(a)/Math.cos(e)),t.x=this.long0-n/this.alfa,s=e,m=0;var b=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(m=1),s=t.y,b+=1;while(m===0&&b<15);return b>=15?null:t}var hce=["Krovak","krovak"];const dce={init:lce,forward:cce,inverse:uce,names:hce};function Wa(t,e,n,r,a){return t*a-e*Math.sin(2*a)+n*Math.sin(4*a)-r*Math.sin(6*a)}function Vx(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function jx(t){return .375*t*(1+.25*t*(1+.46875*t))}function Hx(t){return .05859375*t*t*(1+.75*t)}function Gx(t){return t*t*t*(35/3072)}function $y(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function um(t){return Math.abs(t)<Tn?t:t-$x(t)*Math.PI}function Lw(t,e,n,r,a){var l,u;l=t/e;for(var s=0;s<15;s++)if(u=(t-(e*l-n*Math.sin(2*l)+r*Math.sin(4*l)-a*Math.sin(6*l)))/(e-2*n*Math.cos(2*l)+4*r*Math.cos(4*l)-6*a*Math.cos(6*l)),l+=u,Math.abs(u)<=1e-10)return l;return NaN}function fce(){this.sphere||(this.e0=Vx(this.es),this.e1=jx(this.es),this.e2=Hx(this.es),this.e3=Gx(this.es),this.ml0=this.a*Wa(this.e0,this.e1,this.e2,this.e3,this.lat0))}function pce(t){var e,n,r=t.x,a=t.y;if(r=er(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(a)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(a),Math.cos(r))-this.lat0);else{var l=Math.sin(a),u=Math.cos(a),s=$y(this.a,this.e,l),m=Math.tan(a)*Math.tan(a),_=r*Math.cos(a),b=_*_,M=this.es*u*u/(1-this.es),C=this.a*Wa(this.e0,this.e1,this.e2,this.e3,a);e=s*_*(1-b*m*(1/6-(8-m+8*M)*b/120)),n=C-this.ml0+s*l/u*b*(.5+(5-m+6*M)*b/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function mce(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,a;if(this.sphere){var l=n+this.lat0;r=Math.asin(Math.sin(l)*Math.cos(e)),a=Math.atan2(Math.tan(e),Math.cos(l))}else{var u=this.ml0/this.a+n,s=Lw(u,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-Tn)<=Kn)return t.x=this.long0,t.y=Tn,n<0&&(t.y*=-1),t;var m=$y(this.a,this.e,Math.sin(s)),_=m*m*m/this.a/this.a*(1-this.es),b=Math.pow(Math.tan(s),2),M=e*this.a/m,C=M*M;r=s-m*Math.tan(s)/_*M*M*(.5-(1+3*b)*M*M/24),a=M*(1-C*(b/3+(1+3*b)*b*C/15))/Math.cos(s)}return t.x=er(a+this.long0),t.y=um(r),t}var gce=["Cassini","Cassini_Soldner","cass"];const vce={init:fce,forward:pce,inverse:mce,names:gce};function Hp(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var yce=1,_ce=2,xce=3,bce=4;function wce(){var t=Math.abs(this.lat0);if(Math.abs(t-Tn)<Kn?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<Kn?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=Hp(this.e,1),this.mmf=.5/(1-this.es),this.apa=Rce(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Hp(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Sce(t){var e,n,r,a,l,u,s,m,_,b,M=t.x,C=t.y;if(M=er(M-this.long0),this.sphere){if(l=Math.sin(C),b=Math.cos(C),r=Math.cos(M),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+b*r:1+this.sinph0*l+this.cosph0*b*r,n<=Kn)return null;n=Math.sqrt(2/n),e=n*b*Math.sin(M),n*=this.mode===this.EQUIT?l:this.cosph0*l-this.sinph0*b*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(C+this.lat0)<Kn)return null;n=Mi-C*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(M),n*=r}}else{switch(s=0,m=0,_=0,r=Math.cos(M),a=Math.sin(M),l=Math.sin(C),u=Hp(this.e,l),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=u/this.qp,m=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:_=1+this.sinb1*s+this.cosb1*m*r;break;case this.EQUIT:_=1+m*r;break;case this.N_POLE:_=Tn+C,u=this.qp-u;break;case this.S_POLE:_=C-Tn,u=this.qp+u;break}if(Math.abs(_)<Kn)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:_=Math.sqrt(2/_),this.mode===this.OBLIQ?n=this.ymf*_*(this.cosb1*s-this.sinb1*m*r):n=(_=Math.sqrt(2/(1+m*r)))*s*this.ymf,e=this.xmf*_*m*a;break;case this.N_POLE:case this.S_POLE:u>=0?(e=(_=Math.sqrt(u))*a,n=r*(this.mode===this.S_POLE?_:-_)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function Mce(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,a,l,u,s,m,_;if(this.sphere){var b=0,M,C=0;if(M=Math.sqrt(e*e+n*n),a=M*.5,a>1)return null;switch(a=2*Math.asin(a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(C=Math.sin(a),b=Math.cos(a)),this.mode){case this.EQUIT:a=Math.abs(M)<=Kn?0:Math.asin(n*C/M),e*=C,n=b*M;break;case this.OBLIQ:a=Math.abs(M)<=Kn?this.lat0:Math.asin(b*this.sinph0+n*C*this.cosph0/M),e*=C*this.cosph0,n=(b-Math.sin(a)*this.sinph0)*M;break;case this.N_POLE:n=-n,a=Tn-a;break;case this.S_POLE:a-=Tn;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(_=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,m=Math.sqrt(e*e+n*n),m<Kn)return t.x=this.long0,t.y=this.lat0,t;u=2*Math.asin(.5*m/this.rq),l=Math.cos(u),e*=u=Math.sin(u),this.mode===this.OBLIQ?(_=l*this.sinb1+n*u*this.cosb1/m,s=this.qp*_,n=m*this.cosb1*l-n*this.sinb1*u):(_=n*u/m,s=this.qp*_,n=m*l)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),s=e*e+n*n,!s)return t.x=this.long0,t.y=this.lat0,t;_=1-s/this.qp,this.mode===this.S_POLE&&(_=-_)}r=Math.atan2(e,n),a=Dce(Math.asin(_),this.apa)}return t.x=er(this.long0+r),t.y=a,t}var Ece=.3333333333333333,Cce=.17222222222222222,Tce=.10257936507936508,Pce=.06388888888888888,Ace=.0664021164021164,Ice=.016415012942191543;function Rce(t){var e,n=[];return n[0]=t*Ece,e=t*t,n[0]+=e*Cce,n[1]=e*Pce,e*=t,n[0]+=e*Tce,n[1]+=e*Ace,n[2]=e*Ice,n}function Dce(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var Lce=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const kce={init:wce,forward:Sce,inverse:Mce,names:Lce,S_POLE:yce,N_POLE:_ce,EQUIT:xce,OBLIQ:bce};function em(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function zce(){Math.abs(this.lat1+this.lat2)<Kn||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=cd(this.e3,this.sin_po,this.cos_po),this.qs1=Hp(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=cd(this.e3,this.sin_po,this.cos_po),this.qs2=Hp(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Hp(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Kn?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Oce(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Hp(this.e3,this.sin_phi),a=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,l=this.ns0*er(e-this.long0),u=a*Math.sin(l)+this.x0,s=this.rh-a*Math.cos(l)+this.y0;return t.x=u,t.y=s,t}function Fce(t){var e,n,r,a,l,u;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),a=0,e!==0&&(a=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?u=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,u=this.phi1z(this.e3,n)),l=er(a/this.ns0+this.long0),t.x=l,t.y=u,t}function Nce(t,e){var n,r,a,l,u,s=em(.5*e);if(t<Kn)return s;for(var m=t*t,_=1;_<=25;_++)if(n=Math.sin(s),r=Math.cos(s),a=t*n,l=1-a*a,u=.5*l*l/r*(e/(1-m)-n/l+.5/t*Math.log((1-a)/(1+a))),s=s+u,Math.abs(u)<=1e-7)return s;return null}var Bce=["Albers_Conic_Equal_Area","Albers","aea"];const Uce={init:zce,forward:Oce,inverse:Fce,names:Bce,phi1z:Nce};function $ce(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Vce(t){var e,n,r,a,l,u,s,m,_=t.x,b=t.y;return r=er(_-this.long0),e=Math.sin(b),n=Math.cos(b),a=Math.cos(r),u=this.sin_p14*e+this.cos_p14*n*a,l=1,u>0||Math.abs(u)<=Kn?(s=this.x0+this.a*l*n*Math.sin(r)/u,m=this.y0+this.a*l*(this.cos_p14*e-this.sin_p14*n*a)/u):(s=this.x0+this.infinity_dist*n*Math.sin(r),m=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*a)),t.x=s,t.y=m,t}function jce(t){var e,n,r,a,l,u;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(a=Math.atan2(e,this.rc),n=Math.sin(a),r=Math.cos(a),u=em(r*this.sin_p14+t.y*n*this.cos_p14/e),l=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),l=er(this.long0+l)):(u=this.phic0,l=0),t.x=l,t.y=u,t}var Hce=["gnom"];const Gce={init:$ce,forward:Vce,inverse:jce,names:Hce};function Wce(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*Tn:Tn;for(var r=Math.asin(.5*e),a,l,u,s,m=0;m<30;m++)if(l=Math.sin(r),u=Math.cos(r),s=t*l,a=Math.pow(1-s*s,2)/(2*u)*(e/(1-t*t)-l/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),r+=a,Math.abs(a)<=1e-10)return r;return NaN}function qce(){this.sphere||(this.k0=cd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Xce(t){var e=t.x,n=t.y,r,a,l=er(e-this.long0);if(this.sphere)r=this.x0+this.a*l*Math.cos(this.lat_ts),a=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var u=Hp(this.e,Math.sin(n));r=this.x0+this.a*this.k0*l,a=this.y0+this.a*u*.5/this.k0}return t.x=r,t.y=a,t}function Zce(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=er(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=Wce(this.e,2*t.y*this.k0/this.a),e=er(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t}var Yce=["cea"];const Kce={init:qce,forward:Xce,inverse:Zce,names:Yce};function Jce(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Qce(t){var e=t.x,n=t.y,r=er(e-this.long0),a=um(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*a,t}function eue(t){var e=t.x,n=t.y;return t.x=er(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=um(this.lat0+(n-this.y0)/this.a),t}var tue=["Equirectangular","Equidistant_Cylindrical","eqc"];const nue={init:Jce,forward:Qce,inverse:eue,names:tue};var wz=20;function rue(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Vx(this.es),this.e1=jx(this.es),this.e2=Hx(this.es),this.e3=Gx(this.es),this.ml0=this.a*Wa(this.e0,this.e1,this.e2,this.e3,this.lat0)}function iue(t){var e=t.x,n=t.y,r,a,l,u=er(e-this.long0);if(l=u*Math.sin(n),this.sphere)Math.abs(n)<=Kn?(r=this.a*u,a=-1*this.a*this.lat0):(r=this.a*Math.sin(l)/Math.tan(n),a=this.a*(um(n-this.lat0)+(1-Math.cos(l))/Math.tan(n)));else if(Math.abs(n)<=Kn)r=this.a*u,a=-1*this.ml0;else{var s=$y(this.a,this.e,Math.sin(n))/Math.tan(n);r=s*Math.sin(l),a=this.a*Wa(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+s*(1-Math.cos(l))}return t.x=r+this.x0,t.y=a+this.y0,t}function oue(t){var e,n,r,a,l,u,s,m,_;if(r=t.x-this.x0,a=t.y-this.y0,this.sphere)if(Math.abs(a+this.a*this.lat0)<=Kn)e=er(r/this.a+this.long0),n=0;else{u=this.lat0+a/this.a,s=r*r/this.a/this.a+u*u,m=u;var b;for(l=wz;l;--l)if(b=Math.tan(m),_=-1*(u*(m*b+1)-m-.5*(m*m+s)*b)/((m-u)/b-1),m+=_,Math.abs(_)<=Kn){n=m;break}e=er(this.long0+Math.asin(r*Math.tan(m)/this.a)/Math.sin(n))}else if(Math.abs(a+this.ml0)<=Kn)n=0,e=er(this.long0+r/this.a);else{u=(this.ml0+a)/this.a,s=r*r/this.a/this.a+u*u,m=u;var M,C,A,k,z;for(l=wz;l;--l)if(z=this.e*Math.sin(m),M=Math.sqrt(1-z*z)*Math.tan(m),C=this.a*Wa(this.e0,this.e1,this.e2,this.e3,m),A=this.e0-2*this.e1*Math.cos(2*m)+4*this.e2*Math.cos(4*m)-6*this.e3*Math.cos(6*m),k=C/this.a,_=(u*(M*k+1)-k-.5*M*(k*k+s))/(this.es*Math.sin(2*m)*(k*k+s-2*u*k)/(4*M)+(u-k)*(M*A-2/Math.sin(2*m))-A),m-=_,Math.abs(_)<=Kn){n=m;break}M=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=er(this.long0+Math.asin(r*M/this.a)/Math.sin(n))}return t.x=e,t.y=n,t}var sue=["Polyconic","poly"];const aue={init:rue,forward:iue,inverse:oue,names:sue};function lue(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function cue(t){var e,n=t.x,r=t.y,a=r-this.lat0,l=n-this.long0,u=a/S_*1e-5,s=l,m=1,_=0;for(e=1;e<=10;e++)m=m*u,_=_+this.A[e]*m;var b=_,M=s,C=1,A=0,k,z,P=0,O=0;for(e=1;e<=6;e++)k=C*b-A*M,z=A*b+C*M,C=k,A=z,P=P+this.B_re[e]*C-this.B_im[e]*A,O=O+this.B_im[e]*C+this.B_re[e]*A;return t.x=O*this.a+this.x0,t.y=P*this.a+this.y0,t}function uue(t){var e,n=t.x,r=t.y,a=n-this.x0,l=r-this.y0,u=l/this.a,s=a/this.a,m=1,_=0,b,M,C=0,A=0;for(e=1;e<=6;e++)b=m*u-_*s,M=_*u+m*s,m=b,_=M,C=C+this.C_re[e]*m-this.C_im[e]*_,A=A+this.C_im[e]*m+this.C_re[e]*_;for(var k=0;k<this.iterations;k++){var z=C,P=A,O,j,U=u,X=s;for(e=2;e<=6;e++)O=z*C-P*A,j=P*C+z*A,z=O,P=j,U=U+(e-1)*(this.B_re[e]*z-this.B_im[e]*P),X=X+(e-1)*(this.B_im[e]*z+this.B_re[e]*P);z=1,P=0;var K=this.B_re[1],se=this.B_im[1];for(e=2;e<=6;e++)O=z*C-P*A,j=P*C+z*A,z=O,P=j,K=K+e*(this.B_re[e]*z-this.B_im[e]*P),se=se+e*(this.B_im[e]*z+this.B_re[e]*P);var J=K*K+se*se;C=(U*K+X*se)/J,A=(X*K-U*se)/J}var ue=C,ne=A,H=1,de=0;for(e=1;e<=9;e++)H=H*ue,de=de+this.D[e]*H;var Ee=this.lat0+de*S_*1e5,Pe=this.long0+ne;return t.x=Pe,t.y=Ee,t}var hue=["New_Zealand_Map_Grid","nzmg"];const due={init:lue,forward:cue,inverse:uue,names:hue};function fue(){}function pue(t){var e=t.x,n=t.y,r=er(e-this.long0),a=this.x0+this.a*r,l=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=a,t.y=l,t}function mue(t){t.x-=this.x0,t.y-=this.y0;var e=er(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var gue=["Miller_Cylindrical","mill"];const vue={init:fue,forward:pue,inverse:mue,names:gue};var yue=20;function _ue(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=JI(this.es)}function xue(t){var e,n,r=t.x,a=t.y;if(r=er(r-this.long0),this.sphere){if(!this.m)a=this.n!==1?Math.asin(this.n*Math.sin(a)):a;else for(var l=this.n*Math.sin(a),u=yue;u;--u){var s=(this.m*a+Math.sin(a)-l)/(this.m+Math.cos(a));if(a-=s,Math.abs(s)<Kn)break}e=this.a*this.C_x*r*(this.m+Math.cos(a)),n=this.a*this.C_y*a}else{var m=Math.sin(a),_=Math.cos(a);n=this.a*Yy(a,m,_,this.en),e=this.a*r*_/Math.sqrt(1-this.es*m*m)}return t.x=e,t.y=n,t}function bue(t){var e,n,r,a;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=em((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=em(Math.sin(e)/this.n)),r=er(r+this.long0),e=um(e)):(e=QI(t.y/this.a,this.es,this.en),a=Math.abs(e),a<Tn?(a=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(e)),r=er(n)):a-Kn<Tn&&(r=this.long0)),t.x=r,t.y=e,t}var wue=["Sinusoidal","sinu"];const Sue={init:_ue,forward:xue,inverse:bue,names:wue};function Mue(){}function Eue(t){for(var e=t.x,n=t.y,r=er(e-this.long0),a=n,l=Math.PI*Math.sin(n);;){var u=-(a+Math.sin(a)-l)/(1+Math.cos(a));if(a+=u,Math.abs(u)<Kn)break}a/=2,Math.PI/2-Math.abs(n)<Kn&&(r=0);var s=.900316316158*this.a*r*Math.cos(a)+this.x0,m=1.4142135623731*this.a*Math.sin(a)+this.y0;return t.x=s,t.y=m,t}function Cue(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=er(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var a=Math.asin(n);return t.x=r,t.y=a,t}var Tue=["Mollweide","moll"];const Pue={init:Mue,forward:Eue,inverse:Cue,names:Tue};function Aue(){Math.abs(this.lat1+this.lat2)<Kn||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Vx(this.es),this.e1=jx(this.es),this.e2=Hx(this.es),this.e3=Gx(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=cd(this.e,this.sinphi,this.cosphi),this.ml1=Wa(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Kn?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=cd(this.e,this.sinphi,this.cosphi),this.ml2=Wa(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Wa(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Iue(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var a=Wa(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-a)}var l=this.ns*er(e-this.long0),u=this.x0+r*Math.sin(l),s=this.y0+this.rh-r*Math.cos(l);return t.x=u,t.y=s,t}function Rue(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,a;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var l=0;if(n!==0&&(l=Math.atan2(e*t.x,e*t.y)),this.sphere)return a=er(this.long0+l/this.ns),r=um(this.g-n/this.a),t.x=a,t.y=r,t;var u=this.g-n/this.a;return r=Lw(u,this.e0,this.e1,this.e2,this.e3),a=er(this.long0+l/this.ns),t.x=a,t.y=r,t}var Due=["Equidistant_Conic","eqdc"];const Lue={init:Aue,forward:Iue,inverse:Rue,names:Due};function kue(){this.R=this.a}function zue(t){var e=t.x,n=t.y,r=er(e-this.long0),a,l;Math.abs(n)<=Kn&&(a=this.x0+this.R*r,l=this.y0);var u=em(2*Math.abs(n/Math.PI));(Math.abs(r)<=Kn||Math.abs(Math.abs(n)-Tn)<=Kn)&&(a=this.x0,n>=0?l=this.y0+Math.PI*this.R*Math.tan(.5*u):l=this.y0+Math.PI*this.R*-Math.tan(.5*u));var s=.5*Math.abs(Math.PI/r-r/Math.PI),m=s*s,_=Math.sin(u),b=Math.cos(u),M=b/(_+b-1),C=M*M,A=M*(2/_-1),k=A*A,z=Math.PI*this.R*(s*(M-k)+Math.sqrt(m*(M-k)*(M-k)-(k+m)*(C-k)))/(k+m);r<0&&(z=-z),a=this.x0+z;var P=m+M;return z=Math.PI*this.R*(A*P-s*Math.sqrt((k+m)*(m+1)-P*P))/(k+m),n>=0?l=this.y0+z:l=this.y0-z,t.x=a,t.y=l,t}function Oue(t){var e,n,r,a,l,u,s,m,_,b,M,C,A;return t.x-=this.x0,t.y-=this.y0,M=Math.PI*this.R,r=t.x/M,a=t.y/M,l=r*r+a*a,u=-Math.abs(a)*(1+l),s=u-2*a*a+r*r,m=-2*u+1+2*a*a+l*l,A=a*a/m+(2*s*s*s/m/m/m-9*u*s/m/m)/27,_=(u-s*s/3/m)/m,b=2*Math.sqrt(-_/3),M=3*A/_/b,Math.abs(M)>1&&(M>=0?M=1:M=-1),C=Math.acos(M)/3,t.y>=0?n=(-b*Math.cos(C+Math.PI/3)-s/3/m)*Math.PI:n=-(-b*Math.cos(C+Math.PI/3)-s/3/m)*Math.PI,Math.abs(r)<Kn?e=this.long0:e=er(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(r*r-a*a)+l*l))/2/r),t.x=e,t.y=n,t}var Fue=["Van_der_Grinten_I","VanDerGrinten","vandg"];const Nue={init:kue,forward:zue,inverse:Oue,names:Fue};function Bue(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function Uue(t){var e=t.x,n=t.y,r=Math.sin(t.y),a=Math.cos(t.y),l=er(e-this.long0),u,s,m,_,b,M,C,A,k,z,P,O,j,U,X,K,se,J,ue,ne,H,de,Ee;return this.sphere?Math.abs(this.sin_p12-1)<=Kn?(t.x=this.x0+this.a*(Tn-n)*Math.sin(l),t.y=this.y0-this.a*(Tn-n)*Math.cos(l),t):Math.abs(this.sin_p12+1)<=Kn?(t.x=this.x0+this.a*(Tn+n)*Math.sin(l),t.y=this.y0+this.a*(Tn+n)*Math.cos(l),t):(J=this.sin_p12*r+this.cos_p12*a*Math.cos(l),K=Math.acos(J),se=K?K/Math.sin(K):1,t.x=this.x0+this.a*se*a*Math.sin(l),t.y=this.y0+this.a*se*(this.cos_p12*r-this.sin_p12*a*Math.cos(l)),t):(u=Vx(this.es),s=jx(this.es),m=Hx(this.es),_=Gx(this.es),Math.abs(this.sin_p12-1)<=Kn?(b=this.a*Wa(u,s,m,_,Tn),M=this.a*Wa(u,s,m,_,n),t.x=this.x0+(b-M)*Math.sin(l),t.y=this.y0-(b-M)*Math.cos(l),t):Math.abs(this.sin_p12+1)<=Kn?(b=this.a*Wa(u,s,m,_,Tn),M=this.a*Wa(u,s,m,_,n),t.x=this.x0+(b+M)*Math.sin(l),t.y=this.y0+(b+M)*Math.cos(l),t):(C=r/a,A=$y(this.a,this.e,this.sin_p12),k=$y(this.a,this.e,r),z=Math.atan((1-this.es)*C+this.es*A*this.sin_p12/(k*a)),P=Math.atan2(Math.sin(l),this.cos_p12*Math.tan(z)-this.sin_p12*Math.cos(l)),P===0?ue=Math.asin(this.cos_p12*Math.sin(z)-this.sin_p12*Math.cos(z)):Math.abs(Math.abs(P)-Math.PI)<=Kn?ue=-Math.asin(this.cos_p12*Math.sin(z)-this.sin_p12*Math.cos(z)):ue=Math.asin(Math.sin(l)*Math.cos(z)/Math.sin(P)),O=this.e*this.sin_p12/Math.sqrt(1-this.es),j=this.e*this.cos_p12*Math.cos(P)/Math.sqrt(1-this.es),U=O*j,X=j*j,ne=ue*ue,H=ne*ue,de=H*ue,Ee=de*ue,K=A*ue*(1-ne*X*(1-X)/6+H/8*U*(1-2*X)+de/120*(X*(4-7*X)-3*O*O*(1-7*X))-Ee/48*U),t.x=this.x0+K*Math.sin(P),t.y=this.y0+K*Math.cos(P),t))}function $ue(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,a,l,u,s,m,_,b,M,C,A,k,z,P,O,j,U,X,K,se,J,ue;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*Tn*this.a?void 0:(n=e/this.a,r=Math.sin(n),a=Math.cos(n),l=this.long0,Math.abs(e)<=Kn?u=this.lat0:(u=em(a*this.sin_p12+t.y*r*this.cos_p12/e),s=Math.abs(this.lat0)-Tn,Math.abs(s)<=Kn?this.lat0>=0?l=er(this.long0+Math.atan2(t.x,-t.y)):l=er(this.long0-Math.atan2(-t.x,t.y)):l=er(this.long0+Math.atan2(t.x*r,e*this.cos_p12*a-t.y*this.sin_p12*r))),t.x=l,t.y=u,t)):(m=Vx(this.es),_=jx(this.es),b=Hx(this.es),M=Gx(this.es),Math.abs(this.sin_p12-1)<=Kn?(C=this.a*Wa(m,_,b,M,Tn),e=Math.sqrt(t.x*t.x+t.y*t.y),A=C-e,u=Lw(A/this.a,m,_,b,M),l=er(this.long0+Math.atan2(t.x,-1*t.y)),t.x=l,t.y=u,t):Math.abs(this.sin_p12+1)<=Kn?(C=this.a*Wa(m,_,b,M,Tn),e=Math.sqrt(t.x*t.x+t.y*t.y),A=e-C,u=Lw(A/this.a,m,_,b,M),l=er(this.long0+Math.atan2(t.x,t.y)),t.x=l,t.y=u,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),P=Math.atan2(t.x,t.y),k=$y(this.a,this.e,this.sin_p12),O=Math.cos(P),j=this.e*this.cos_p12*O,U=-j*j/(1-this.es),X=3*this.es*(1-U)*this.sin_p12*this.cos_p12*O/(1-this.es),K=e/k,se=K-U*(1+U)*Math.pow(K,3)/6-X*(1+3*U)*Math.pow(K,4)/24,J=1-U*se*se/2-K*se*se*se/6,z=Math.asin(this.sin_p12*Math.cos(se)+this.cos_p12*Math.sin(se)*O),l=er(this.long0+Math.asin(Math.sin(P)*Math.sin(se)/Math.cos(z))),ue=Math.sin(z),u=Math.atan2((ue-this.es*J*this.sin_p12)*Math.tan(z),ue*(1-this.es)),t.x=l,t.y=u,t))}var Vue=["Azimuthal_Equidistant","aeqd"];const jue={init:Bue,forward:Uue,inverse:$ue,names:Vue};function Hue(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Gue(t){var e,n,r,a,l,u,s,m,_=t.x,b=t.y;return r=er(_-this.long0),e=Math.sin(b),n=Math.cos(b),a=Math.cos(r),u=this.sin_p14*e+this.cos_p14*n*a,l=1,(u>0||Math.abs(u)<=Kn)&&(s=this.a*l*n*Math.sin(r),m=this.y0+this.a*l*(this.cos_p14*e-this.sin_p14*n*a)),t.x=s,t.y=m,t}function Wue(t){var e,n,r,a,l,u,s;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=em(e/this.a),r=Math.sin(n),a=Math.cos(n),u=this.long0,Math.abs(e)<=Kn?(s=this.lat0,t.x=u,t.y=s,t):(s=em(a*this.sin_p14+t.y*r*this.cos_p14/e),l=Math.abs(this.lat0)-Tn,Math.abs(l)<=Kn?(this.lat0>=0?u=er(this.long0+Math.atan2(t.x,-t.y)):u=er(this.long0-Math.atan2(-t.x,t.y)),t.x=u,t.y=s,t):(u=er(this.long0+Math.atan2(t.x*r,e*this.cos_p14*a-t.y*this.sin_p14*r)),t.x=u,t.y=s,t))}var que=["ortho"];const Xue={init:Hue,forward:Gue,inverse:Wue,names:que};var vo={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Ei={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Zue(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Tn-Mi/2?this.face=vo.TOP:this.lat0<=-(Tn-Mi/2)?this.face=vo.BOTTOM:Math.abs(this.long0)<=Mi?this.face=vo.FRONT:Math.abs(this.long0)<=Tn+Mi?this.face=this.long0>0?vo.RIGHT:vo.LEFT:this.face=vo.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Yue(t){var e={x:0,y:0},n,r,a,l,u,s,m={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===vo.TOP)l=Tn-n,r>=Mi&&r<=Tn+Mi?(m.value=Ei.AREA_0,a=r-Tn):r>Tn+Mi||r<=-(Tn+Mi)?(m.value=Ei.AREA_1,a=r>0?r-Uo:r+Uo):r>-(Tn+Mi)&&r<=-Mi?(m.value=Ei.AREA_2,a=r+Tn):(m.value=Ei.AREA_3,a=r);else if(this.face===vo.BOTTOM)l=Tn+n,r>=Mi&&r<=Tn+Mi?(m.value=Ei.AREA_0,a=-r+Tn):r<Mi&&r>=-Mi?(m.value=Ei.AREA_1,a=-r):r<-Mi&&r>=-(Tn+Mi)?(m.value=Ei.AREA_2,a=-r-Tn):(m.value=Ei.AREA_3,a=r>0?-r+Uo:-r-Uo);else{var _,b,M,C,A,k,z;this.face===vo.RIGHT?r=My(r,+Tn):this.face===vo.BACK?r=My(r,+Uo):this.face===vo.LEFT&&(r=My(r,-Tn)),C=Math.sin(n),A=Math.cos(n),k=Math.sin(r),z=Math.cos(r),_=A*z,b=A*k,M=C,this.face===vo.FRONT?(l=Math.acos(_),a=ab(l,M,b,m)):this.face===vo.RIGHT?(l=Math.acos(b),a=ab(l,M,-_,m)):this.face===vo.BACK?(l=Math.acos(-_),a=ab(l,M,-b,m)):this.face===vo.LEFT?(l=Math.acos(-b),a=ab(l,M,_,m)):(l=a=0,m.value=Ei.AREA_0)}return s=Math.atan(12/Uo*(a+Math.acos(Math.sin(a)*Math.cos(Mi))-Tn)),u=Math.sqrt((1-Math.cos(l))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(a))))),m.value===Ei.AREA_1?s+=Tn:m.value===Ei.AREA_2?s+=Uo:m.value===Ei.AREA_3&&(s+=1.5*Uo),e.x=u*Math.cos(s),e.y=u*Math.sin(s),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function Kue(t){var e={lam:0,phi:0},n,r,a,l,u,s,m,_,b,M={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?M.value=Ei.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(M.value=Ei.AREA_1,n-=Tn):t.x<0&&-t.x>=Math.abs(t.y)?(M.value=Ei.AREA_2,n=n<0?n+Uo:n-Uo):(M.value=Ei.AREA_3,n+=Tn),b=Uo/12*Math.tan(n),u=Math.sin(b)/(Math.cos(b)-1/Math.sqrt(2)),s=Math.atan(u),a=Math.cos(n),l=Math.tan(r),m=1-a*a*l*l*(1-Math.cos(Math.atan(1/Math.cos(s)))),m<-1?m=-1:m>1&&(m=1),this.face===vo.TOP)_=Math.acos(m),e.phi=Tn-_,M.value===Ei.AREA_0?e.lam=s+Tn:M.value===Ei.AREA_1?e.lam=s<0?s+Uo:s-Uo:M.value===Ei.AREA_2?e.lam=s-Tn:e.lam=s;else if(this.face===vo.BOTTOM)_=Math.acos(m),e.phi=_-Tn,M.value===Ei.AREA_0?e.lam=-s+Tn:M.value===Ei.AREA_1?e.lam=-s:M.value===Ei.AREA_2?e.lam=-s-Tn:e.lam=s<0?-s-Uo:-s+Uo;else{var C,A,k;C=m,b=C*C,b>=1?k=0:k=Math.sqrt(1-b)*Math.sin(s),b+=k*k,b>=1?A=0:A=Math.sqrt(1-b),M.value===Ei.AREA_1?(b=A,A=-k,k=b):M.value===Ei.AREA_2?(A=-A,k=-k):M.value===Ei.AREA_3&&(b=A,A=k,k=-b),this.face===vo.RIGHT?(b=C,C=-A,A=b):this.face===vo.BACK?(C=-C,A=-A):this.face===vo.LEFT&&(b=C,C=A,A=-b),e.phi=Math.acos(-k)-Tn,e.lam=Math.atan2(A,C),this.face===vo.RIGHT?e.lam=My(e.lam,-Tn):this.face===vo.BACK?e.lam=My(e.lam,-Uo):this.face===vo.LEFT&&(e.lam=My(e.lam,+Tn))}if(this.es!==0){var z,P,O;z=e.phi<0?1:0,P=Math.tan(e.phi),O=this.b/Math.sqrt(P*P+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-O*O)/(this.one_minus_f*O)),z&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function ab(t,e,n,r){var a;return t<Kn?(r.value=Ei.AREA_0,a=0):(a=Math.atan2(e,n),Math.abs(a)<=Mi?r.value=Ei.AREA_0:a>Mi&&a<=Tn+Mi?(r.value=Ei.AREA_1,a-=Tn):a>Tn+Mi||a<=-(Tn+Mi)?(r.value=Ei.AREA_2,a=a>=0?a-Uo:a+Uo):(r.value=Ei.AREA_3,a+=Tn)),a}function My(t,e){var n=t+e;return n<-Uo?n+=nx:n>+Uo&&(n-=nx),n}var Jue=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Que={init:Zue,forward:Yue,inverse:Kue,names:Jue};var bP=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],u_=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],wU=.8487,SU=1.3523,MU=Kh/5,ehe=1/MU,hy=18,kw=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},the=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function nhe(t,e,n,r){for(var a=e;r;--r){var l=t(a);if(a-=l,Math.abs(l)<n)break}return a}function rhe(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function ihe(t){var e=er(t.x-this.long0),n=Math.abs(t.y),r=Math.floor(n*MU);r<0?r=0:r>=hy&&(r=hy-1),n=Kh*(n-ehe*r);var a={x:kw(bP[r],n)*e,y:kw(u_[r],n)};return t.y<0&&(a.y=-a.y),a.x=a.x*this.a*wU+this.x0,a.y=a.y*this.a*SU+this.y0,a}function ohe(t){var e={x:(t.x-this.x0)/(this.a*wU),y:Math.abs(t.y-this.y0)/(this.a*SU)};if(e.y>=1)e.x/=bP[hy][0],e.y=t.y<0?-Tn:Tn;else{var n=Math.floor(e.y*hy);for(n<0?n=0:n>=hy&&(n=hy-1);;)if(u_[n][0]>e.y)--n;else if(u_[n+1][0]<=e.y)++n;else break;var r=u_[n],a=5*(e.y-r[0])/(u_[n+1][0]-r[0]);a=nhe(function(l){return(kw(r,l)-e.y)/the(r,l)},a,Kn,100),e.x/=kw(bP[n],a),e.y=(5*n+a)*Xs,t.y<0&&(e.y=-e.y)}return e.x=er(e.x+this.long0),e}var she=["Robinson","robin"];const ahe={init:rhe,forward:ihe,inverse:ohe,names:she};function lhe(){this.name="geocent"}function che(t){var e=hU(t,this.es,this.a);return e}function uhe(t){var e=dU(t,this.es,this.a,this.b);return e}var hhe=["Geocentric","geocentric","geocent","Geocent"];const dhe={init:lhe,forward:che,inverse:uhe,names:hhe};var wa={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},W0={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function fhe(){if(Object.keys(W0).forEach((function(n){if(typeof this[n]>"u")this[n]=W0[n].def;else{if(W0[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);W0[n].num&&(this[n]=parseFloat(this[n]))}W0[n].degrees&&(this[n]=this[n]*Xs)}).bind(this)),Math.abs(Math.abs(this.lat0)-Tn)<Kn?this.mode=this.lat0<0?wa.S_POLE:wa.N_POLE:Math.abs(this.lat0)<Kn?this.mode=wa.EQUIT:(this.mode=wa.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function phe(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),a,l;switch(this.mode){case wa.OBLIQ:l=this.sinph0*e+this.cosph0*n*r;break;case wa.EQUIT:l=n*r;break;case wa.S_POLE:l=-e;break;case wa.N_POLE:l=e;break}switch(l=this.pn1/(this.p-l),a=l*n*Math.sin(t.x),this.mode){case wa.OBLIQ:l*=this.cosph0*e-this.sinph0*n*r;break;case wa.EQUIT:l*=e;break;case wa.N_POLE:l*=-(n*r);break;case wa.S_POLE:l*=n*r;break}var u,s;return u=l*this.cg+a*this.sg,s=1/(u*this.sw*this.h1+this.cw),a=(a*this.cg-l*this.sg)*this.cw*s,l=u*s,t.x=a*this.a,t.y=l*this.a,t}function mhe(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,a;a=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*a,r=this.pn1*t.y*this.cw*a,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var l=bl(t.x,t.y);if(Math.abs(l)<Kn)e.x=0,e.y=t.y;else{var u,s;switch(s=1-l*l*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/l+l/this.pn1),u=Math.sqrt(1-s*s),this.mode){case wa.OBLIQ:e.y=Math.asin(u*this.sinph0+t.y*s*this.cosph0/l),t.y=(u-this.sinph0*Math.sin(e.y))*l,t.x*=s*this.cosph0;break;case wa.EQUIT:e.y=Math.asin(t.y*s/l),t.y=u*l,t.x*=s;break;case wa.N_POLE:e.y=Math.asin(u),t.y=-t.y;break;case wa.S_POLE:e.y=-Math.asin(u);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var ghe=["Tilted_Perspective","tpers"];const vhe={init:fhe,forward:phe,inverse:mhe,names:ghe};function yhe(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function _he(t){var e=t.x,n=t.y,r,a,l,u;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var s=this.radius_p/bl(this.radius_p*Math.cos(n),Math.sin(n));if(a=s*Math.cos(e)*Math.cos(n),l=s*Math.sin(e)*Math.cos(n),u=s*Math.sin(n),(this.radius_g-a)*a-l*l-u*u*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-a,this.flip_axis?(t.x=this.radius_g_1*Math.atan(l/bl(u,r)),t.y=this.radius_g_1*Math.atan(u/r)):(t.x=this.radius_g_1*Math.atan(l/r),t.y=this.radius_g_1*Math.atan(u/bl(l,r)))}else this.shape==="sphere"&&(r=Math.cos(n),a=Math.cos(e)*r,l=Math.sin(e)*r,u=Math.sin(n),r=this.radius_g-a,this.flip_axis?(t.x=this.radius_g_1*Math.atan(l/bl(u,r)),t.y=this.radius_g_1*Math.atan(u/r)):(t.x=this.radius_g_1*Math.atan(l/r),t.y=this.radius_g_1*Math.atan(u/bl(l,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function xhe(t){var e=-1,n=0,r=0,a,l,u,s;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*bl(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*bl(1,n));var m=r/this.radius_p;if(a=n*n+m*m+e*e,l=2*this.radius_g*e,u=l*l-4*a*this.C,u<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-l-Math.sqrt(u))/(2*a),e=this.radius_g+s*e,n*=s,r*=s,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),a=n*n+r*r+e*e,l=2*this.radius_g*e,u=l*l-4*a*this.C,u<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-l-Math.sqrt(u))/(2*a),e=this.radius_g+s*e,n*=s,r*=s,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var bhe=["Geostationary Satellite View","Geostationary_Satellite","geos"];const whe={init:yhe,forward:_he,inverse:xhe,names:bhe};var M_=1.340264,E_=-.081106,C_=893e-6,T_=.003796,zw=Math.sqrt(3)/2;function She(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function Mhe(t){var e=er(t.x-this.long0),n=t.y,r=Math.asin(zw*Math.sin(n)),a=r*r,l=a*a*a;return t.x=e*Math.cos(r)/(zw*(M_+3*E_*a+l*(7*C_+9*T_*a))),t.y=r*(M_+E_*a+l*(C_+T_*a)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Ehe(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,a,l,u,s,m,_;for(_=0;_<n&&(a=r*r,l=a*a*a,u=r*(M_+E_*a+l*(C_+T_*a))-t.y,s=M_+3*E_*a+l*(7*C_+9*T_*a),r-=m=u/s,!(Math.abs(m)<e));++_);return a=r*r,l=a*a*a,t.x=zw*t.x*(M_+3*E_*a+l*(7*C_+9*T_*a))/Math.cos(r),t.y=Math.asin(Math.sin(r)/zw),t.x=er(t.x+this.long0),t}var Che=["eqearth","Equal Earth","Equal_Earth"];const The={init:She,forward:Mhe,inverse:Ehe,names:Che};var ox=1e-10;function Phe(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<ox)throw new Error;this.es?(this.en=JI(this.es),this.m1=Yy(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Ihe,this.forward=Ahe):(Math.abs(this.phi1)+ox>=Tn?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Dhe,this.forward=Rhe)}function Ahe(t){var e=er(t.x-(this.long0||0)),n=t.y,r,a,l;return r=this.am1+this.m1-Yy(n,a=Math.sin(n),l=Math.cos(n),this.en),a=l*e/(r*Math.sqrt(1-this.es*a*a)),t.x=r*Math.sin(a),t.y=this.am1-r*Math.cos(a),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Ihe(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,a;if(n=bl(t.x,t.y=this.am1-t.y),a=QI(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(a))<Tn)e=Math.sin(a),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(a);else if(Math.abs(e-Tn)<=ox)r=0;else throw new Error;return t.x=er(r+(this.long0||0)),t.y=um(a),t}function Rhe(t){var e=er(t.x-(this.long0||0)),n=t.y,r,a;return a=this.cphi1+this.phi1-n,Math.abs(a)>ox?(t.x=a*Math.sin(r=e*Math.cos(n)/a),t.y=this.cphi1-a*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Dhe(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=bl(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>Tn)throw new Error;return Math.abs(Math.abs(n)-Tn)<=ox?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=er(e+(this.long0||0)),t.y=um(n),t}var Lhe=["bonne","Bonne (Werner lat_1=90)"];const khe={init:Phe,names:Lhe};function zhe(t){t.Proj.projections.add(nw),t.Proj.projections.add(rw),t.Proj.projections.add(Ile),t.Proj.projections.add(Ble),t.Proj.projections.add(Gle),t.Proj.projections.add(Yle),t.Proj.projections.add(nce),t.Proj.projections.add(ace),t.Proj.projections.add(dce),t.Proj.projections.add(vce),t.Proj.projections.add(kce),t.Proj.projections.add(Uce),t.Proj.projections.add(Gce),t.Proj.projections.add(Kce),t.Proj.projections.add(nue),t.Proj.projections.add(aue),t.Proj.projections.add(due),t.Proj.projections.add(vue),t.Proj.projections.add(Sue),t.Proj.projections.add(Pue),t.Proj.projections.add(Lue),t.Proj.projections.add(Nue),t.Proj.projections.add(jue),t.Proj.projections.add(Xue),t.Proj.projections.add(Que),t.Proj.projections.add(ahe),t.Proj.projections.add(dhe),t.Proj.projections.add(vhe),t.Proj.projections.add(whe),t.Proj.projections.add(The),t.Proj.projections.add(khe)}Al.defaultDatum="WGS84";Al.Proj=rd;Al.WGS84=new Al.Proj("WGS84");Al.Point=Uy;Al.toPoint=fU;Al.defs=Ha;Al.nadgrid=Dae;Al.transform=Dw;Al.mgrs=Xae;Al.version="__VERSION__";zhe(Al);const rR=6370997,Ow=rR*Math.PI/180,dy={standardParalel1:33,standardParalel2:45,mapOrigin:[39,-96],mapFactor:[-.00017706234,.000176689948]},Ohe=["+proj=lcc",`+R=${rR}`,`+lat_1=${dy.standardParalel1}`,`+lat_2=${dy.standardParalel2}`,`+lat_0=${dy.mapOrigin[0]}`,`+lon_0=${dy.mapOrigin[1]}`].join(" "),Fhe=Al(Ohe),EU=([t,e])=>{const n=Fhe.forward([t,e]);return[n[0]/dy.mapFactor[1]/Ow,n[1]/dy.mapFactor[0]/Ow].map(r=>Number(r.toFixed(10)))},$p={standardParalel1:37,standardParalel2:65,mapOrigin:[50,15],mapOffset:[16660,4150],mapFactor:[-.000171570875,.0001729241463]},Nhe=["+proj=lcc",`+R=${rR}`,`+lat_1=${$p.standardParalel1}`,`+lat_2=${$p.standardParalel2}`,`+lat_0=${$p.mapOrigin[0]}`,`+lon_0=${$p.mapOrigin[1]}`].join(" "),Bhe=Al(Nhe),CU=([t,e])=>{const n=Bhe.forward([t,e]);let[r,a]=[n[0]/$p.mapFactor[1]/Ow,n[1]/$p.mapFactor[0]/Ow];const l=.75,u=[-31100,-5500],s=r/l-u[0]/2,m=a/l-u[1]/2;return s*l<u[0]&&s*l<u[1]&&(r=s,a=m),[r+$p.mapOffset[0],a+$p.mapOffset[1]].map(b=>Number(b.toFixed(10)))},Tp={ats:[[-124.477162,25.767968].map(t=>Math.floor(t)),[-88.928336,49.122384].map(t=>Math.ceil(t))].flat(),ets2:[[-10.025698,34.897275].map(t=>Math.floor(t)),[33.284941,71.573102].map(t=>Math.ceil(t))].flat()},Uhe=()=>{const t=pr(Nx().current),[e,n]=q.useState(null),[r,a]=q.useState(!1),[l,u]=q.useState(!1),[s,m]=q.useState([]),_=q.useCallback(A=>{A!=="clickaway"&&a(!1)},[]),b=q.useCallback(()=>{u(!1),m([])},[]),M=A=>()=>{a(!0);const k=pr(e).position;switch(A){case"lngLat":navigator.clipboard.writeText(k.lngLat.map(z=>Mz(z,4)).join(","));break;case"xz":navigator.clipboard.writeText(pr(k.xz).map(z=>Mz(z,1)).join(","));break;default:throw new ah(A)}},C=q.useCallback(()=>{n(null),t.off("move",C)},[]);return q.useEffect(()=>{const A=O=>{const{x:j,y:U}=O.point,X=O.lngLat.toArray();let K;ib(Tp.ats,X)?K=EU(X):ib(Tp.ets2,X)&&(K=CU(X));const se=wy(X,Ck(Tp.ats)),J=wy(X,Ck(Tp.ets2)),ue=se<=J?"ats":"ets2";n({position:{lngLat:X,xz:K},closestGame:ue,anchorEl:{getBoundingClientRect:()=>({width:0,height:0,top:U,right:j,bottom:U,left:j})}}),t.once("move",C)};let k;const z=O=>{k=window.setTimeout(()=>{k=void 0,A(O)},1e3)},P=()=>clearTimeout(k);return t.on("contextmenu",A),t.on("touchstart",z),t.on("touchend",P),t.on("touchmove",P),()=>{t.off("contextmenu",A),t.off("touchstart",z),t.off("touchend",P),t.off("touchmove",P)}},[t]),q.useEffect(()=>{if(!l){t.getCanvas().style.cursor="";return}let A=0;const k=()=>A++,z={type:"Feature",geometry:{type:"LineString",coordinates:s},properties:{id:k()}},P={type:"FeatureCollection",features:[...s.map(U=>Ez(U,k())),...s.length>1?[z]:[]]},O=U=>{const X=t.queryRenderedFeatures(U.point,{layers:["measure-points"]}),K=ib(l==="ats"?Tp.ats:Tp.ets2,U.lngLat.toArray());t.getCanvas().style.cursor=K?X.length?"pointer":"crosshair":"not-allowed"},j=U=>{if(!ib(l==="ats"?Tp.ats:Tp.ets2,U.lngLat.toArray()))return;const K=t.queryRenderedFeatures(U.point,{layers:["measure-points"]});if(P.features.length>1&&P.features.pop(),K.length){const se=K[0].properties.id;P.features=P.features.filter(J=>J.properties.id!==se)}else P.features.push(Ez(U.lngLat.toArray(),k()));P.features.length>1&&(z.geometry.coordinates=P.features.map(se=>(x6(se.geometry.type==="Point",`unexpected non-Point geometry: ${se.geometry.type}`),se.geometry.coordinates)),P.features.push(z)),pr(t.getSource("measure")).setData(P),m(P.features.filter(se=>se.geometry.type==="Point").map(se=>se.geometry.coordinates))};return t.on("mousemove",O),t.on("click",j),pr(t.getSource("measure")).setData(P),()=>{t.off("mousemove",O),t.off("click",j),pr(t.getSource("measure")).setData({type:"FeatureCollection",features:[]})}},[t,s,l]),ae.jsxs(ae.Fragment,{children:[ae.jsx("div",{style:{display:e!=null?"block":"none",zIndex:10,position:"absolute",top:0,left:0,right:0,bottom:0},onMouseDown:A=>{A.currentTarget===A.target&&C()},children:ae.jsx(wB,{size:"sm",open:e!=null,anchorEl:e?.anchorEl,placement:"bottom-start",onClick:C,onContextMenu:A=>A.preventDefault(),children:e?ae.jsxs(ae.Fragment,{children:[ae.jsxs(bg,{sx:{justifyContent:"space-between"},onClick:M("lngLat"),children:[ae.jsx(tU,{}),ae.jsx(K_,{children:ae.jsx(Sz,{coords:{lng:e.position.lngLat[0],lat:e.position.lngLat[1]},fractionDigits:4})}),ae.jsx(iz,{sx:{ml:1}})]}),e.position.xz?ae.jsxs(ae.Fragment,{children:[ae.jsxs(bg,{sx:{justifyContent:"space-between"},onClick:M("xz"),children:[ae.jsx(nU,{}),ae.jsx(K_,{children:ae.jsx(Sz,{coords:{x:e.position.xz[0],z:e.position.xz[1]},fractionDigits:1})}),ae.jsx(iz,{sx:{ml:1}})]}),ae.jsx(tP,{}),l?ae.jsx(bg,{onClick:b,children:"Clear measurement"}):ae.jsx(bg,{onClick:()=>{u(pr(e).closestGame),m([pr(e).position.lngLat])},children:"Measure distance"})]}):ae.jsxs(ae.Fragment,{children:[ae.jsx(tP,{}),ae.jsx(am,{children:ae.jsxs(Ci,{level:"body-xs",sx:{opacity:.75},children:["Right-click within the"," ",e.closestGame.toUpperCase()," game map for more options."]})})]})]}):null})}),ae.jsx($he,{measuring:l,close:b,measuringPoints:s}),ae.jsx(Vhe,{open:r,close:_})]})},Sz=t=>Object.entries(t.coords).map(([e,n],r)=>ae.jsxs(q.Fragment,{children:[r>0?ae.jsx("span",{children:""}):null,ae.jsx(QN,{size:"sm",variant:"plain",sx:{opacity:.4},children:e}),h_(n,t.fractionDigits)]},e)),$he=q.memo(t=>t.measuring===!1?null:ae.jsx(mI,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",sx:{alignItems:"baseline",mb:4},endDecorator:ae.jsx(sd,{onClick:t.close,children:ae.jsx(FI,{})}),children:ae.jsxs(Sa,{gap:1,children:[ae.jsx(Ci,{level:"title-md",children:"Measure distance"}),t.measuringPoints.length<=1?ae.jsx(Ci,{level:"body-sm",children:"Click on the map to trace a path you want to measure."}):ae.jsxs(Sa,{gap:2,children:[ae.jsx(Ci,{level:"body-sm",children:"Click on the map to add to your path. Click on an existing point to remove it from the path."}),ae.jsxs(Sa,{direction:{xs:"column",md:"row"},gap:2,children:[ae.jsx(Ci,{level:"title-sm",children:"Total distance:"}),ae.jsxs(Sa,{direction:"row",gap:.5,children:[ae.jsx(Ci,{level:"body-xs",children:ae.jsx(tU,{})}),ae.jsx(Ci,{level:"title-sm",children:Cz(t.measuringPoints,"irl",t.measuring)})]}),ae.jsxs(Sa,{direction:"row",gap:.5,children:[ae.jsx(Ci,{level:"body-xs",children:ae.jsx(nU,{})}),ae.jsx(Ci,{level:"title-sm",children:Cz(t.measuringPoints,"game",t.measuring)})]})]})]})]})})),Vhe=q.memo(t=>ae.jsx(mI,{open:t.open,onClose:(e,n)=>t.close(n),autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",endDecorator:ae.jsx(sd,{onClick:()=>t.close("escapeKeyDown"),children:ae.jsx(FI,{})}),children:"Copied to clipboard."}));function Mz(t,e){return Number(t.toFixed(e))}function h_(t,e){return Number(t.toFixed(e)).toLocaleString(void 0,{maximumFractionDigits:e})}function Ez(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:{id:e}}}function Cz(t,e,n){let r;if(e==="irl")r=t;else{const m=n==="ats"?EU:CU;r=t.map(m)}const a=e==="irl"?wy:(m,_)=>Tw(m,_)/1e3;let l=r[0],u=0;for(const m of r.slice(1))u+=a(l,m),l=m;const s=u<1?`${h_(u*1e3,1)} meters`:`${h_(u,2)} km`;if(e==="irl"){const m=u*.6213712,_=m<1?`${h_(m*5280,0)} ft`:`${h_(m,2)} mi`;return`${n==="ats"?_:s} (${n==="ats"?s:_})`}else return s}const TU={[go.FuelStation]:{iconName:"gas_ico",label:"Fuel station"},[go.Toll]:{iconName:"toll_ico",label:"Toll gate"},[go.Parking]:{iconName:"parking_ico",label:"Rest stop"},[go.RecruitmentAgency]:{iconName:"recruitment_ico",label:"Recruitment agency"},[go.Service]:{iconName:"service_ico",label:"Service"},[go.TruckDealer]:{iconName:"dealer_ico",label:"Truck dealer"},[go.Port]:{iconName:"port_overlay",label:"Port"},[go.Train]:{iconName:"train_ico",label:"Train"},[go.Viewpoint]:{iconName:"viewpoint",label:"Viewpoint"},[go.PhotoSight]:{iconName:"photo_sight_captured",label:"Photo trophy"},[go.AgricultureCheck]:{iconName:"agri_check",label:"Agricultural inspection"},[go.BorderCheck]:{iconName:"border_ico",label:"Border inspection"},[go.Garage]:{iconName:"garage_large_ico",label:"Garage"},[go.WeighStation]:{iconName:"weigh_station_ico",label:"Weigh station"},[go.CityNames]:{iconName:"city_names_ico",label:"City names"},[go.Company]:{iconName:"companies_ico",label:"Companies"},[go.RoadNumber]:{iconName:"road_numbers_ico",label:"Road numbers"},[go.ExitNumber]:{iconName:"exit",label:"Exit numbers"},[go.Roadwork]:{iconName:"roadwork",label:"Roadwork"},[go.RailCrossing]:{iconName:"railcrossing",label:"Rail Crossing"}},jhe=new Map(Object.entries(TU).map(([t,e])=>[Number(t),e.label])),Tz=new Map(Object.entries(Aie).map(([t,e])=>[Number(t),e]));function Fw(t,e,n){return{selectedItems:t,allItems:n,onSelectAllToggle:r=>e(new Set(r?n:[])),onItemToggle:(r,a)=>{e(l=>{const u=new Set(l);return a?u.add(r):u.delete(r),u})}}}const PU=t=>{const e=q.useRef(null),[n,r]=q.useState(!1),[a,l]=q.useState(0),u=new Map(jhe.entries().filter(([s])=>t.icons.allItems.has(s)));return Il(()=>({onAdd:()=>pr(e.current),onRemove:()=>pr(e.current).remove()}),{position:"bottom-left"}),ae.jsxs("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",children:[ae.jsx(sd,{title:"Map Options",sx:{minWidth:0,minHeight:0,borderRadius:0},onClick:()=>r(!0),children:ae.jsx(Use,{})}),ae.jsx(xB,{open:n,onClose:()=>r(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",justifyContent:"end"}}},children:ae.jsxs(EB,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,height:"80%",overflow:"auto"},children:[ae.jsx(mB,{children:"Map Options"}),ae.jsx(SB,{}),ae.jsx(RL,{onChange:(s,m)=>l(Number(m)),children:ae.jsxs(EQ,{tabFlex:1,sx:{borderRadius:0},children:[ae.jsx(bM,{children:"Icons"}),ae.jsx(bM,{children:"ATS DLC"}),ae.jsx(bM,{children:"Advanced"})]})}),ae.jsx(pB,{sx:{overflowX:"hidden"},children:ae.jsxs(RL,{value:a,children:[ae.jsx(wM,{sx:{p:0},value:0,children:ae.jsx(Pz,{items:u,selectedItems:t.icons.selectedItems,onItemToggle:t.icons.onItemToggle,icon:s=>ae.jsx("img",{style:{marginLeft:-3},width:32,height:32,src:`map-icons/${TU[s].iconName}.png`})})}),ae.jsx(wM,{sx:{p:0},value:1,children:ae.jsx(Pz,{items:Tz,selectedItems:t.atsDlcs.selectedItems,onItemToggle:t.atsDlcs.onItemToggle})}),ae.jsx(wM,{sx:{p:0},value:2,children:ae.jsx(qhe,{showSecrets:t.advanced.showSecrets,onSecretsChange:t.advanced.onSecretsChange,showContours:t.advanced.showContours,onContoursToggle:t.advanced.onContoursToggle})})]})}),ae.jsx(Ax,{}),a===0&&ae.jsx(Hhe,{enableAutoHiding:t.icons.enableAutoHiding,enableSelectAll:t.icons.selectedItems.size===u.size,onAutoHidingToggle:t.icons.onAutoHidingToggle,onSelectAllToggle:t.icons.onSelectAllToggle}),a===1&&ae.jsx(Whe,{enableSelectAll:t.atsDlcs.selectedItems.size===Tz.size,onSelectAllToggle:t.atsDlcs.onSelectAllToggle})]})})]})},Hhe=q.memo(t=>ae.jsxs(Sa,{direction:"row",justifyContent:"space-between",gap:1,mx:2,children:[ae.jsx(TB,{enterDelay:500,title:"Enable to hide icons based on zoom and nearby icons. Disable to always show icons.",children:ae.jsx(ky,{label:"Enable icon hiding",checked:t.enableAutoHiding,onChange:e=>t.onAutoHidingToggle?.(e.target.checked)})}),ae.jsx(ky,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:t.enableSelectAll,onChange:e=>t.onSelectAllToggle?.(e.target.checked)})]})),Ghe=t=>ae.jsx(RS,{size:"lg",sx:{p:0,[`& .${Cg.root}`]:{flexGrow:1,alignItems:"center",flexDirection:"row-reverse"}},children:[...t.items.entries()].map(([e,n])=>ae.jsxs(am,{children:[t.icon?.(e),ae.jsx(ky,{overlay:!0,label:n,checked:t.selectedItems.has(e),onChange:r=>t.onItemToggle(e,r.target.checked)})]},String(e)))}),Pz=q.memo(Ghe),Whe=q.memo(t=>ae.jsx(Sa,{direction:"row",justifyContent:"end",gap:1,mx:2,children:ae.jsx(ky,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:t.enableSelectAll,onChange:e=>t.onSelectAllToggle?.(e.target.checked)})})),qhe=t=>ae.jsxs(Sa,{mx:2,gap:2,children:[ae.jsxs(eP,{children:[ae.jsx(Ci,{level:"title-md",children:"Secret roads"}),ae.jsxs(MB,{defaultValue:t.showSecrets,onChange:(e,n)=>n&&t.onSecretsChange(n),children:[ae.jsx(Xb,{value:"showAsNormal",children:"Show as normal roads"}),ae.jsx(Xb,{value:"showAsDashed",children:"Show as dashed lines"}),ae.jsx(Xb,{value:"hide",children:"Don't show"})]})]}),ae.jsx(Ax,{}),ae.jsx(Ci,{mb:2,level:"title-lg",children:"Experimental Features"}),ae.jsx(Sa,{gap:2,children:ae.jsxs(eP,{children:[ae.jsx(ky,{sx:{flexDirection:"row-reverse"},label:"Show elevation data",checked:t.showContours,onChange:e=>t.onContoursToggle(e.target.checked)}),ae.jsx(Ci,{level:"body-xs",color:"warning",children:"Note: elevation data for points further away from roads is estimated and likely inaccurate."})]})})]}),iR=()=>{const t=q.useRef(null),{mode:e="light",setMode:n}=xS();return Il(()=>({onAdd:()=>pr(t.current),onRemove:()=>pr(t.current).remove()})),ae.jsx("div",{ref:t,className:"maplibregl-ctrl maplibregl-ctrl-group",children:ae.jsxs(EW,{children:[ae.jsx(PJ,{slots:{root:sd},sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Set map theme",children:ae.jsx(Dse,{})}),ae.jsxs(wB,{placement:"left",children:[ae.jsx(am,{sticky:!0,children:ae.jsx(Ci,{m:1,level:"body-xs",textTransform:"uppercase",fontWeight:"lg",children:"Map theme"})}),ae.jsxs(bg,{onClick:()=>n("light"),selected:e==="light",children:[ae.jsx(yy,{children:ae.jsx(kse,{})})," ","Light"]}),ae.jsxs(bg,{onClick:()=>n("dark"),selected:e==="dark",children:[ae.jsx(yy,{children:ae.jsx(zse,{})})," ","Dark"]}),ae.jsxs(bg,{onClick:()=>n("system"),selected:e==="system",children:[ae.jsx(yy,{children:ae.jsx(Lse,{})})," ","Auto"]})]})]})})};function Xhe(t,e,n){let r=n.get(t);return r==null&&(r=e,n.set(t,r)),r}const Az=t=>{const{map:e,selectDecorator:n,onSelect:r}=t,[a,l]=q.useState([]);q.useEffect(()=>{const m=e==="usa"?"ats":"ets2";Promise.all([fetch(`${m}-achievements.json`).then(_=>_.json()),fetch(`${m}-achievements.geojson`).then(_=>_.json())]).then(([_,b])=>{const M=new Map;for(const A of b.features)Xhe(A.properties.name,[],M).push({coordinates:A.geometry.coordinates,dlcGuard:A.properties.dlcGuard});const C=new Set(b.features.map(A=>A.properties.name));l([..._.data.filter(A=>C.has(A.id)).map(A=>({...A,label:A.title,value:A.id,features:pr(M.get(A.id))})).sort((A,k)=>A.label.localeCompare(k.label))])},()=>console.error("could not load achievements json."))},[e]);const u=a.filter(m=>{if(e==="europe")return!0;const _=Fx(t.visibleStateDlcs);return m.features.some(b=>_.has(b.dlcGuard))}),s=HN({stringify:m=>[m.label,m.desc].join(" ")});return ae.jsx(Mw,{onChange:(m,_)=>r(_),placeholder:"Search achievements...",options:u,filterOptions:s,blurOnSelect:!0,autoComplete:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,renderOption:(m,_)=>q.createElement(aB,{...m,key:_.value},ae.jsx(yy,{sx:{border:"2px solid var(--joy-palette-neutral-outlinedBorder)",borderRadius:6,overflow:"hidden",minWidth:"fit-content",mr:.5},children:ae.jsx("img",{loading:"lazy",width:"48",height:"48",src:_.imgUrl,alt:""})}),ae.jsxs(K_,{children:[ae.jsx(Ci,{level:"title-md",children:_.label}),ae.jsx(Ci,{level:"body-xs",children:_.desc})]}))},e)};function gf(t){return Array.isArray?Array.isArray(t):RU(t)==="[object Array]"}function Zhe(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Yhe(t){return t==null?"":Zhe(t)}function Jh(t){return typeof t=="string"}function AU(t){return typeof t=="number"}function Khe(t){return t===!0||t===!1||Jhe(t)&&RU(t)=="[object Boolean]"}function IU(t){return typeof t=="object"}function Jhe(t){return IU(t)&&t!==null}function sc(t){return t!=null}function KM(t){return!t.trim().length}function RU(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Qhe="Incorrect 'index' type",ede=t=>`Invalid value for key ${t}`,tde=t=>`Pattern length exceeds max of ${t}.`,nde=t=>`Missing ${t} property in key`,rde=t=>`Property 'weight' in key '${t}' must be a positive integer`,Iz=Object.prototype.hasOwnProperty;class ide{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(r=>{let a=DU(r);this._keys.push(a),this._keyMap[a.id]=a,n+=a.weight}),this._keys.forEach(r=>{r.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function DU(t){let e=null,n=null,r=null,a=1,l=null;if(Jh(t)||gf(t))r=t,e=Rz(t),n=wP(t);else{if(!Iz.call(t,"name"))throw new Error(nde("name"));const u=t.name;if(r=u,Iz.call(t,"weight")&&(a=t.weight,a<=0))throw new Error(rde(u));e=Rz(u),n=wP(u),l=t.getFn}return{path:e,id:n,weight:a,src:r,getFn:l}}function Rz(t){return gf(t)?t:t.split(".")}function wP(t){return gf(t)?t.join("."):t}function ode(t,e){let n=[],r=!1;const a=(l,u,s)=>{if(sc(l))if(!u[s])n.push(l);else{let m=u[s];const _=l[m];if(!sc(_))return;if(s===u.length-1&&(Jh(_)||AU(_)||Khe(_)))n.push(Yhe(_));else if(gf(_)){r=!0;for(let b=0,M=_.length;b<M;b+=1)a(_[b],u,s+1)}else u.length&&a(_,u,s+1)}};return a(t,Jh(e)?e.split("."):e,0),r?n:n[0]}const sde={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},ade={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},lde={location:0,threshold:.6,distance:100},cde={useExtendedSearch:!1,getFn:ode,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Sr={...ade,...sde,...lde,...cde};const ude=/[^ ]+/g;function hde(t=1,e=3){const n=new Map,r=Math.pow(10,e);return{get(a){const l=a.match(ude).length;if(n.has(l))return n.get(l);const u=1/Math.pow(l,.5*t),s=parseFloat(Math.round(u*r)/r);return n.set(l,s),s},clear(){n.clear()}}}class oR{constructor({getFn:e=Sr.getFn,fieldNormWeight:n=Sr.fieldNormWeight}={}){this.norm=hde(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Jh(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){const n=this.size();Jh(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!sc(e)||KM(e))return;let r={v:e,i:n,n:this.norm.get(e)};this.records.push(r)}_addObject(e,n){let r={i:n,$:{}};this.keys.forEach((a,l)=>{let u=a.getFn?a.getFn(e):this.getFn(e,a.path);if(sc(u)){if(gf(u)){let s=[];const m=[{nestedArrIndex:-1,value:u}];for(;m.length;){const{nestedArrIndex:_,value:b}=m.pop();if(sc(b))if(Jh(b)&&!KM(b)){let M={v:b,i:_,n:this.norm.get(b)};s.push(M)}else gf(b)&&b.forEach((M,C)=>{m.push({nestedArrIndex:C,value:M})})}r.$[l]=s}else if(Jh(u)&&!KM(u)){let s={v:u,n:this.norm.get(u)};r.$[l]=s}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function LU(t,e,{getFn:n=Sr.getFn,fieldNormWeight:r=Sr.fieldNormWeight}={}){const a=new oR({getFn:n,fieldNormWeight:r});return a.setKeys(t.map(DU)),a.setSources(e),a.create(),a}function dde(t,{getFn:e=Sr.getFn,fieldNormWeight:n=Sr.fieldNormWeight}={}){const{keys:r,records:a}=t,l=new oR({getFn:e,fieldNormWeight:n});return l.setKeys(r),l.setIndexRecords(a),l}function lb(t,{errors:e=0,currentLocation:n=0,expectedLocation:r=0,distance:a=Sr.distance,ignoreLocation:l=Sr.ignoreLocation}={}){const u=e/t.length;if(l)return u;const s=Math.abs(r-n);return a?u+s/a:s?1:u}function fde(t=[],e=Sr.minMatchCharLength){let n=[],r=-1,a=-1,l=0;for(let u=t.length;l<u;l+=1){let s=t[l];s&&r===-1?r=l:!s&&r!==-1&&(a=l-1,a-r+1>=e&&n.push([r,a]),r=-1)}return t[l-1]&&l-r>=e&&n.push([r,l-1]),n}const yg=32;function pde(t,e,n,{location:r=Sr.location,distance:a=Sr.distance,threshold:l=Sr.threshold,findAllMatches:u=Sr.findAllMatches,minMatchCharLength:s=Sr.minMatchCharLength,includeMatches:m=Sr.includeMatches,ignoreLocation:_=Sr.ignoreLocation}={}){if(e.length>yg)throw new Error(tde(yg));const b=e.length,M=t.length,C=Math.max(0,Math.min(r,M));let A=l,k=C;const z=s>1||m,P=z?Array(M):[];let O;for(;(O=t.indexOf(e,k))>-1;){let J=lb(e,{currentLocation:O,expectedLocation:C,distance:a,ignoreLocation:_});if(A=Math.min(J,A),k=O+b,z){let ue=0;for(;ue<b;)P[O+ue]=1,ue+=1}}k=-1;let j=[],U=1,X=b+M;const K=1<<b-1;for(let J=0;J<b;J+=1){let ue=0,ne=X;for(;ue<ne;)lb(e,{errors:J,currentLocation:C+ne,expectedLocation:C,distance:a,ignoreLocation:_})<=A?ue=ne:X=ne,ne=Math.floor((X-ue)/2+ue);X=ne;let H=Math.max(1,C-ne+1),de=u?M:Math.min(C+ne,M)+b,Ee=Array(de+2);Ee[de+1]=(1<<J)-1;for(let Ze=de;Ze>=H;Ze-=1){let ke=Ze-1,Te=n[t.charAt(ke)];if(z&&(P[ke]=+!!Te),Ee[Ze]=(Ee[Ze+1]<<1|1)&Te,J&&(Ee[Ze]|=(j[Ze+1]|j[Ze])<<1|1|j[Ze+1]),Ee[Ze]&K&&(U=lb(e,{errors:J,currentLocation:ke,expectedLocation:C,distance:a,ignoreLocation:_}),U<=A)){if(A=U,k=ke,k<=C)break;H=Math.max(1,2*C-k)}}if(lb(e,{errors:J+1,currentLocation:C,expectedLocation:C,distance:a,ignoreLocation:_})>A)break;j=Ee}const se={isMatch:k>=0,score:Math.max(.001,U)};if(z){const J=fde(P,s);J.length?m&&(se.indices=J):se.isMatch=!1}return se}function mde(t){let e={};for(let n=0,r=t.length;n<r;n+=1){const a=t.charAt(n);e[a]=(e[a]||0)|1<<r-n-1}return e}const Nw=String.prototype.normalize?t=>t.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):t=>t;class kU{constructor(e,{location:n=Sr.location,threshold:r=Sr.threshold,distance:a=Sr.distance,includeMatches:l=Sr.includeMatches,findAllMatches:u=Sr.findAllMatches,minMatchCharLength:s=Sr.minMatchCharLength,isCaseSensitive:m=Sr.isCaseSensitive,ignoreDiacritics:_=Sr.ignoreDiacritics,ignoreLocation:b=Sr.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:a,includeMatches:l,findAllMatches:u,minMatchCharLength:s,isCaseSensitive:m,ignoreDiacritics:_,ignoreLocation:b},e=m?e:e.toLowerCase(),e=_?Nw(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const M=(A,k)=>{this.chunks.push({pattern:A,alphabet:mde(A),startIndex:k})},C=this.pattern.length;if(C>yg){let A=0;const k=C%yg,z=C-k;for(;A<z;)M(this.pattern.substr(A,yg),A),A+=yg;if(k){const P=C-yg;M(this.pattern.substr(P),P)}}else M(this.pattern,0)}searchIn(e){const{isCaseSensitive:n,ignoreDiacritics:r,includeMatches:a}=this.options;if(e=n?e:e.toLowerCase(),e=r?Nw(e):e,this.pattern===e){let z={isMatch:!0,score:0};return a&&(z.indices=[[0,e.length-1]]),z}const{location:l,distance:u,threshold:s,findAllMatches:m,minMatchCharLength:_,ignoreLocation:b}=this.options;let M=[],C=0,A=!1;this.chunks.forEach(({pattern:z,alphabet:P,startIndex:O})=>{const{isMatch:j,score:U,indices:X}=pde(e,z,P,{location:l+O,distance:u,threshold:s,findAllMatches:m,minMatchCharLength:_,includeMatches:a,ignoreLocation:b});j&&(A=!0),C+=U,j&&X&&(M=[...M,...X])});let k={isMatch:A,score:A?C/this.chunks.length:1};return A&&a&&(k.indices=M),k}}class hm{constructor(e){this.pattern=e}static isMultiMatch(e){return Dz(e,this.multiRegex)}static isSingleMatch(e){return Dz(e,this.singleRegex)}search(){}}function Dz(t,e){const n=t.match(e);return n?n[1]:null}class gde extends hm{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class vde extends hm{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class yde extends hm{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class _de extends hm{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class xde extends hm{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class bde extends hm{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class zU extends hm{constructor(e,{location:n=Sr.location,threshold:r=Sr.threshold,distance:a=Sr.distance,includeMatches:l=Sr.includeMatches,findAllMatches:u=Sr.findAllMatches,minMatchCharLength:s=Sr.minMatchCharLength,isCaseSensitive:m=Sr.isCaseSensitive,ignoreDiacritics:_=Sr.ignoreDiacritics,ignoreLocation:b=Sr.ignoreLocation}={}){super(e),this._bitapSearch=new kU(e,{location:n,threshold:r,distance:a,includeMatches:l,findAllMatches:u,minMatchCharLength:s,isCaseSensitive:m,ignoreDiacritics:_,ignoreLocation:b})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class OU extends hm{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,r;const a=[],l=this.pattern.length;for(;(r=e.indexOf(this.pattern,n))>-1;)n=r+l,a.push([r,n-1]);const u=!!a.length;return{isMatch:u,score:u?0:1,indices:a}}}const SP=[gde,OU,yde,_de,bde,xde,vde,zU],Lz=SP.length,wde=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Sde="|";function Mde(t,e={}){return t.split(Sde).map(n=>{let r=n.trim().split(wde).filter(l=>l&&!!l.trim()),a=[];for(let l=0,u=r.length;l<u;l+=1){const s=r[l];let m=!1,_=-1;for(;!m&&++_<Lz;){const b=SP[_];let M=b.isMultiMatch(s);M&&(a.push(new b(M,e)),m=!0)}if(!m)for(_=-1;++_<Lz;){const b=SP[_];let M=b.isSingleMatch(s);if(M){a.push(new b(M,e));break}}}return a})}const Ede=new Set([zU.type,OU.type]);class Cde{constructor(e,{isCaseSensitive:n=Sr.isCaseSensitive,ignoreDiacritics:r=Sr.ignoreDiacritics,includeMatches:a=Sr.includeMatches,minMatchCharLength:l=Sr.minMatchCharLength,ignoreLocation:u=Sr.ignoreLocation,findAllMatches:s=Sr.findAllMatches,location:m=Sr.location,threshold:_=Sr.threshold,distance:b=Sr.distance}={}){this.query=null,this.options={isCaseSensitive:n,ignoreDiacritics:r,includeMatches:a,minMatchCharLength:l,findAllMatches:s,ignoreLocation:u,location:m,threshold:_,distance:b},e=n?e:e.toLowerCase(),e=r?Nw(e):e,this.pattern=e,this.query=Mde(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:a,ignoreDiacritics:l}=this.options;e=a?e:e.toLowerCase(),e=l?Nw(e):e;let u=0,s=[],m=0;for(let _=0,b=n.length;_<b;_+=1){const M=n[_];s.length=0,u=0;for(let C=0,A=M.length;C<A;C+=1){const k=M[C],{isMatch:z,indices:P,score:O}=k.search(e);if(z){if(u+=1,m+=O,r){const j=k.constructor.type;Ede.has(j)?s=[...s,...P]:s.push(P)}}else{m=0,u=0,s.length=0;break}}if(u){let C={isMatch:!0,score:m/u};return r&&(C.indices=s),C}}return{isMatch:!1,score:1}}}const MP=[];function Tde(...t){MP.push(...t)}function EP(t,e){for(let n=0,r=MP.length;n<r;n+=1){let a=MP[n];if(a.condition(t,e))return new a(t,e)}return new kU(t,e)}const Bw={AND:"$and",OR:"$or"},CP={PATH:"$path",PATTERN:"$val"},TP=t=>!!(t[Bw.AND]||t[Bw.OR]),Pde=t=>!!t[CP.PATH],Ade=t=>!gf(t)&&IU(t)&&!TP(t),kz=t=>({[Bw.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function FU(t,e,{auto:n=!0}={}){const r=a=>{let l=Object.keys(a);const u=Pde(a);if(!u&&l.length>1&&!TP(a))return r(kz(a));if(Ade(a)){const m=u?a[CP.PATH]:l[0],_=u?a[CP.PATTERN]:a[m];if(!Jh(_))throw new Error(ede(m));const b={keyId:wP(m),pattern:_};return n&&(b.searcher=EP(_,e)),b}let s={children:[],operator:l[0]};return l.forEach(m=>{const _=a[m];gf(_)&&_.forEach(b=>{s.children.push(r(b))})}),s};return TP(t)||(t=kz(t)),r(t)}function Ide(t,{ignoreFieldNorm:e=Sr.ignoreFieldNorm}){t.forEach(n=>{let r=1;n.matches.forEach(({key:a,norm:l,score:u})=>{const s=a?a.weight:null;r*=Math.pow(u===0&&s?Number.EPSILON:u,(s||1)*(e?1:l))}),n.score=r})}function Rde(t,e){const n=t.matches;e.matches=[],sc(n)&&n.forEach(r=>{if(!sc(r.indices)||!r.indices.length)return;const{indices:a,value:l}=r;let u={indices:a,value:l};r.key&&(u.key=r.key.src),r.idx>-1&&(u.refIndex=r.idx),e.matches.push(u)})}function Dde(t,e){e.score=t.score}function Lde(t,e,{includeMatches:n=Sr.includeMatches,includeScore:r=Sr.includeScore}={}){const a=[];return n&&a.push(Rde),r&&a.push(Dde),t.map(l=>{const{idx:u}=l,s={item:e[u],refIndex:u};return a.length&&a.forEach(m=>{m(l,s)}),s})}class Ky{constructor(e,n={},r){this.options={...Sr,...n},this.options.useExtendedSearch,this._keyStore=new ide(this.options.keys),this.setCollection(e,r)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof oR))throw new Error(Qhe);this._myIndex=n||LU(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){sc(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const n=[];for(let r=0,a=this._docs.length;r<a;r+=1){const l=this._docs[r];e(l,r)&&(this.removeAt(r),r-=1,a-=1,n.push(l))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){const{includeMatches:r,includeScore:a,shouldSort:l,sortFn:u,ignoreFieldNorm:s}=this.options;let m=Jh(e)?Jh(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Ide(m,{ignoreFieldNorm:s}),l&&m.sort(u),AU(n)&&n>-1&&(m=m.slice(0,n)),Lde(m,this._docs,{includeMatches:r,includeScore:a})}_searchStringList(e){const n=EP(e,this.options),{records:r}=this._myIndex,a=[];return r.forEach(({v:l,i:u,n:s})=>{if(!sc(l))return;const{isMatch:m,score:_,indices:b}=n.searchIn(l);m&&a.push({item:l,idx:u,matches:[{score:_,value:l,norm:s,indices:b}]})}),a}_searchLogical(e){const n=FU(e,this.options),r=(s,m,_)=>{if(!s.children){const{keyId:M,searcher:C}=s,A=this._findMatches({key:this._keyStore.get(M),value:this._myIndex.getValueForItemAtKeyId(m,M),searcher:C});return A&&A.length?[{idx:_,item:m,matches:A}]:[]}const b=[];for(let M=0,C=s.children.length;M<C;M+=1){const A=s.children[M],k=r(A,m,_);if(k.length)b.push(...k);else if(s.operator===Bw.AND)return[]}return b},a=this._myIndex.records,l={},u=[];return a.forEach(({$:s,i:m})=>{if(sc(s)){let _=r(n,s,m);_.length&&(l[m]||(l[m]={idx:m,item:s,matches:[]},u.push(l[m])),_.forEach(({matches:b})=>{l[m].matches.push(...b)}))}}),u}_searchObjectList(e){const n=EP(e,this.options),{keys:r,records:a}=this._myIndex,l=[];return a.forEach(({$:u,i:s})=>{if(!sc(u))return;let m=[];r.forEach((_,b)=>{m.push(...this._findMatches({key:_,value:u[b],searcher:n}))}),m.length&&l.push({idx:s,item:u,matches:m})}),l}_findMatches({key:e,value:n,searcher:r}){if(!sc(n))return[];let a=[];if(gf(n))n.forEach(({v:l,i:u,n:s})=>{if(!sc(l))return;const{isMatch:m,score:_,indices:b}=r.searchIn(l);m&&a.push({score:_,key:e,value:l,idx:u,norm:s,indices:b})});else{const{v:l,n:u}=n,{isMatch:s,score:m,indices:_}=r.searchIn(l);s&&a.push({score:m,key:e,value:l,norm:u,indices:_})}return a}}Ky.version="7.1.0";Ky.createIndex=LU;Ky.parseIndex=dde;Ky.config=Sr;Ky.parseQuery=FU;Tde(Cde);const zz=100,kde=t=>t.match(/("[^"]*?"|[^"\s]+)+(?=\s*|\s*$)/g)??[],Oz=t=>{const{map:e,selectDecorator:n,onSelect:r}=t,[a,l]=q.useState({}),[u,s]=q.useState(null),[m,_]=q.useState([]),[b,M]=q.useState(null),[C,A]=q.useState(0),k=P=>setTimeout(()=>A(P),0);q.useEffect(()=>{fetch("sprites@2x.json").then(P=>P.json()).then(P=>l(P),P=>console.error("could not load sprites json",P))},[]),q.useEffect(()=>{fetch(`${e==="usa"?"ats":"ets2"}-search.geojson`).then(O=>O.json()).then(O=>{let j;if(e==="usa"){const K=Fx(t.visibleStateDlcs);j=se=>K.has(se.properties.dlcGuard)}else j=()=>!0;const U=O.features.filter(j),X=new Ky(U,{distance:0,threshold:.2,findAllMatches:!0,ignoreLocation:!0,sortFn:Bde,keys:[{name:"properties.label",weight:3},{name:"properties.city.name",weight:2},{name:"properties.stateName",weight:1.5},"properties.stateCode","properties.tags"]});s(X),_(U.map((K,se)=>({type:"poi",id:se.toString(),label:K.properties.label,poi:K})))},O=>console.error("could not load search json.",O))},[e,e==="usa"?t.visibleStateDlcs:null]);const z=(P,{inputValue:O})=>{if(ld.checkState(u!=null),O.length<3)if(b!=null)typeof b=="string"?O=b:O=b.label;else return k(0),[];const j=kde(O);if(!j.length)return console.warn("empty tokens for search input:",O),k(0),[];const U=u.search({$and:j.map(X=>({$or:[{"properties.label":X},{"properties.city.name":X},{"properties.stateName":X},{"properties.stateCode":X},{"properties.tags":X}]}))});return k(U.length),U.slice(0,zz).map(X=>P[X.refIndex])};return ae.jsx(Mw,{onChange:(P,O)=>{if(O==null)M(null),r(null);else if(typeof O=="string")M(O);else if(O&&O.type==="poi")A(1),M(O),r(O);else if(O)throw new Error("suggestions not yet supported")},onInputChange:(P,O,j)=>{j!=="reset"&&M(null)},placeholder:"Search cities, companies, points of interest...",options:m,filterOptions:z,getOptionLabel:Fde,blurOnSelect:!0,handleHomeEndKeys:!0,freeSolo:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,endDecorator:ae.jsx(zde,{maxResults:zz,numSearchResults:C}),renderOption:(P,O)=>q.createElement(aB,{...P,key:O.id},ae.jsx(Ode,{option:O,sprites:a}))},e)},zde=({numSearchResults:t,maxResults:e})=>t>e?ae.jsx(TB,{title:`Showing first ${e} of ${t} results, only. Try adding more terms to narrow your search.`,children:ae.jsx(Fse,{color:"warning",sx:{width:"0.8em"}})}):null,Ode=q.memo(({option:t,sprites:e})=>ae.jsxs(ae.Fragment,{children:[ae.jsx(yy,{sx:{display:"flex",justifyContent:"center",mx:0},children:ae.jsx(Fz,{option:t,sprites:e})}),ae.jsx(Nde,{option:t}),ae.jsx(yy,{children:t.type==="poi"&&t.poi.properties.type==="company"?ae.jsx(Fz,{option:t,sprites:e,position:"end"}):null})]})),Fz=({option:t,sprites:e,position:n})=>{if(t.type==="suggestion")return null;if(t.poi.properties.type==="city")return ae.jsx($se,{});if(t.poi.properties.type==="scenery")return ae.jsx(Nse,{});let r;switch(t.poi.properties.type){case"company":if(!n)return ae.jsx(Vse,{});r=t.poi.properties.sprite;break;case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":r=t.poi.properties.sprite;break;case"serviceArea":throw new Error("facility search results unsupported in demo app.");default:throw new ah(t.poi.properties.type)}const a=pr(e[r]);return ae.jsx(zS,{sx:{width:a.width+"px",height:a.height+"px",background:`url(sprites.png) -${a.x}px -${a.y}px`,transform:"scale(0.70)"}})};function Fde(t){if(typeof t=="string")return t;if(t.type==="suggestion")return"suggestion";const e=t.poi.properties;switch(e.type){case"city":case"scenery":return`${t.label}, ${e.stateCode}`;case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{const n=NU(e.label,e.city);switch(n){case 0:return`${t.label} in ${e.city.name}, ${e.stateCode}`;case 1:return`${t.label} near ${e.city.name}, ${e.stateCode}`;case 2:return`${t.label} in ${e.stateName}`;default:throw new ah(n)}}case"serviceArea":throw new Error("facility search results unsupported in demo app.");default:throw new ah(e)}}const Nde=({option:t})=>{if(t.type==="suggestion")return"suggestion";const e=t.poi.properties;switch(e.type){case"city":case"scenery":return ae.jsxs(K_,{children:[t.label,", ",e.stateCode]});case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{let n;const r=NU(e.label,e.city);switch(r){case 0:n=`${e.city.name}, ${e.stateCode}`;break;case 1:n=`near ${e.city.name}, ${e.stateCode}`;break;case 2:n=`${e.stateName}`;break;default:throw new ah(r)}return ae.jsxs(K_,{children:[ae.jsx(Ci,{children:t.label}),ae.jsx(Ci,{level:"body-sm",children:n})]})}case"serviceArea":throw new Error("service area search results unsupported in demo app.");default:throw new ah(e)}};function NU(t,e){return e.distance<=250||t.startsWith(e.name)||t.endsWith(e.name)?0:e.distance<=1e3?1:2}const Nz={company:0,city:1,scenery:1,landmark:2,viewpoint:3,dealer:4,ferry:5,train:6,serviceArea:7};function Bde(t,e){if(t.score!==e.score)return t.score-e.score;const n=t.item[1],r=e.item[1];if(n&&r)return n.v.localeCompare(r.v);if(n&&!r)return 1;if(!n&&r)return-1;const a=t.item[4],l=e.item[4];if(!Array.isArray(a)||!Array.isArray(l))throw new Error("unexpected non-arrays at key 5");const u=pr(a.find(b=>b.i===0)).v,s=pr(l.find(b=>b.i===0)).v;if(u!==s)return Nz[u]-Nz[s];const m=t.item[0],_=e.item[0];return m.v.localeCompare(_.v)}var JM,Bz;function BU(){if(Bz)return JM;Bz=1;var t=Object.prototype.toString;return JM=function(n){var r=t.call(n),a=r==="[object Arguments]";return a||(a=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),a},JM}var QM,Uz;function Ude(){if(Uz)return QM;Uz=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=BU(),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],m=function(C){var A=C.constructor;return A&&A.prototype===C},_={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},b=function(){if(typeof window>"u")return!1;for(var C in window)try{if(!_["$"+C]&&e.call(window,C)&&window[C]!==null&&typeof window[C]=="object")try{m(window[C])}catch{return!0}}catch{return!0}return!1}(),M=function(C){if(typeof window>"u"||!b)return m(C);try{return m(C)}catch{return!1}};t=function(A){var k=A!==null&&typeof A=="object",z=n.call(A)==="[object Function]",P=r(A),O=k&&n.call(A)==="[object String]",j=[];if(!k&&!z&&!P)throw new TypeError("Object.keys called on a non-object");var U=u&&z;if(O&&A.length>0&&!e.call(A,0))for(var X=0;X<A.length;++X)j.push(String(X));if(P&&A.length>0)for(var K=0;K<A.length;++K)j.push(String(K));else for(var se in A)!(U&&se==="prototype")&&e.call(A,se)&&j.push(String(se));if(l)for(var J=M(A),ue=0;ue<s.length;++ue)!(J&&s[ue]==="constructor")&&e.call(A,s[ue])&&j.push(s[ue]);return j}}return QM=t,QM}var eE,$z;function $de(){if($z)return eE;$z=1;var t=Array.prototype.slice,e=BU(),n=Object.keys,r=n?function(u){return n(u)}:Ude(),a=Object.keys;return r.shim=function(){if(Object.keys){var u=function(){var s=Object.keys(arguments);return s&&s.length===arguments.length}(1,2);u||(Object.keys=function(m){return e(m)?a(t.call(m)):a(m)})}else Object.keys=r;return Object.keys||r},eE=r,eE}var tE,Vz;function Wx(){if(Vz)return tE;Vz=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return tE=t,tE}var nE,jz;function dm(){return jz||(jz=1,nE=SyntaxError),nE}var rE,Hz;function Lr(){return Hz||(Hz=1,rE=TypeError),rE}var iE,Gz;function Vde(){return Gz||(Gz=1,iE=Object.getOwnPropertyDescriptor),iE}var oE,Wz;function Jy(){if(Wz)return oE;Wz=1;var t=Vde();if(t)try{t([],"length")}catch{t=null}return oE=t,oE}var sE,qz;function UU(){if(qz)return sE;qz=1;var t=Wx(),e=dm(),n=Lr(),r=Jy();return sE=function(l,u,s){if(!l||typeof l!="object"&&typeof l!="function")throw new n("`obj` must be an object or a function`");if(typeof u!="string"&&typeof u!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var m=arguments.length>3?arguments[3]:null,_=arguments.length>4?arguments[4]:null,b=arguments.length>5?arguments[5]:null,M=arguments.length>6?arguments[6]:!1,C=!!r&&r(l,u);if(t)t(l,u,{configurable:b===null&&C?C.configurable:!b,enumerable:m===null&&C?C.enumerable:!m,value:s,writable:_===null&&C?C.writable:!_});else if(M||!m&&!_&&!b)l[u]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},sE}var aE,Xz;function sR(){if(Xz)return aE;Xz=1;var t=Wx(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},aE=e,aE}var lE,Zz;function $U(){if(Zz)return lE;Zz=1;var t=$de(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,a=UU(),l=function(_){return typeof _=="function"&&n.call(_)==="[object Function]"},u=sR()(),s=function(_,b,M,C){if(b in _){if(C===!0){if(_[b]===M)return}else if(!l(C)||!C())return}u?a(_,b,M,!0):a(_,b,M)},m=function(_,b){var M=arguments.length>2?arguments[2]:{},C=t(b);e&&(C=r.call(C,Object.getOwnPropertySymbols(b)));for(var A=0;A<C.length;A+=1)s(_,C[A],b[C[A]],M[C[A]])};return m.supportsDescriptors=!!u,lE=m,lE}var cE={exports:{}},uE,Yz;function jde(){return Yz||(Yz=1,uE=Object),uE}var hE,Kz;function Hde(){return Kz||(Kz=1,hE=Error),hE}var dE,Jz;function Gde(){return Jz||(Jz=1,dE=EvalError),dE}var fE,Qz;function Wde(){return Qz||(Qz=1,fE=RangeError),fE}var pE,eO;function qde(){return eO||(eO=1,pE=ReferenceError),pE}var mE,tO;function Xde(){return tO||(tO=1,mE=URIError),mE}var gE,nO;function VU(){return nO||(nO=1,gE=Math.abs),gE}var vE,rO;function jU(){return rO||(rO=1,vE=Math.floor),vE}var yE,iO;function Zde(){return iO||(iO=1,yE=Math.max),yE}var _E,oO;function Yde(){return oO||(oO=1,_E=Math.min),_E}var xE,sO;function Kde(){return sO||(sO=1,xE=Math.pow),xE}var bE,aO;function HU(){return aO||(aO=1,bE=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var a=42;e[n]=a;for(var l in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var u=Object.getOwnPropertySymbols(e);if(u.length!==1||u[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,n);if(s.value!==a||s.enumerable!==!0)return!1}return!0}),bE}var wE,lO;function e2(){if(lO)return wE;lO=1;var t=typeof Symbol<"u"&&Symbol,e=HU();return wE=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},wE}var SE,cO;function Jde(){if(cO)return SE;cO=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,n=Math.max,r="[object Function]",a=function(m,_){for(var b=[],M=0;M<m.length;M+=1)b[M]=m[M];for(var C=0;C<_.length;C+=1)b[C+m.length]=_[C];return b},l=function(m,_){for(var b=[],M=_,C=0;M<m.length;M+=1,C+=1)b[C]=m[M];return b},u=function(s,m){for(var _="",b=0;b<s.length;b+=1)_+=s[b],b+1<s.length&&(_+=m);return _};return SE=function(m){var _=this;if(typeof _!="function"||e.apply(_)!==r)throw new TypeError(t+_);for(var b=l(arguments,1),M,C=function(){if(this instanceof M){var O=_.apply(this,a(b,arguments));return Object(O)===O?O:this}return _.apply(m,a(b,arguments))},A=n(0,_.length-b.length),k=[],z=0;z<A;z++)k[z]="$"+z;if(M=Function("binder","return function ("+u(k,",")+"){ return binder.apply(this,arguments); }")(C),_.prototype){var P=function(){};P.prototype=_.prototype,M.prototype=new P,P.prototype=null}return M},SE}var ME,uO;function qx(){if(uO)return ME;uO=1;var t=Jde();return ME=Function.prototype.bind||t,ME}var EE,hO;function aR(){return hO||(hO=1,EE=Function.prototype.call),EE}var CE,dO;function lR(){return dO||(dO=1,CE=Function.prototype.apply),CE}var TE,fO;function Qde(){return fO||(fO=1,TE=typeof Reflect<"u"&&Reflect&&Reflect.apply),TE}var PE,pO;function GU(){if(pO)return PE;pO=1;var t=qx(),e=lR(),n=aR(),r=Qde();return PE=r||t.call(n,e),PE}var AE,mO;function cR(){if(mO)return AE;mO=1;var t=qx(),e=Lr(),n=aR(),r=GU();return AE=function(l){if(l.length<1||typeof l[0]!="function")throw new e("a function is required");return r(t,n,l)},AE}var IE,gO;function efe(){if(gO)return IE;gO=1;var t=cR(),e=Jy(),n;try{n=[].__proto__===Array.prototype}catch(u){if(!u||typeof u!="object"||!("code"in u)||u.code!=="ERR_PROTO_ACCESS")throw u}var r=!!n&&e&&e(Object.prototype,"__proto__"),a=Object,l=a.getPrototypeOf;return IE=r&&typeof r.get=="function"?t([r.get]):typeof l=="function"?function(s){return l(s==null?s:a(s))}:!1,IE}var RE,vO;function Sf(){if(vO)return RE;vO=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,n=qx();return RE=n.call(t,e),RE}var DE,yO;function Ma(){if(yO)return DE;yO=1;var t,e=jde(),n=Hde(),r=Gde(),a=Wde(),l=qde(),u=dm(),s=Lr(),m=Xde(),_=VU(),b=jU(),M=Zde(),C=Yde(),A=Kde(),k=Function,z=function(_t){try{return k('"use strict"; return ('+_t+").constructor;")()}catch{}},P=Jy(),O=Wx(),j=function(){throw new s},U=P?function(){try{return arguments.callee,j}catch{try{return P(arguments,"callee").get}catch{return j}}}():j,X=e2()(),K=efe(),se=typeof Reflect=="function"&&Reflect.getPrototypeOf||e.getPrototypeOf||K,J=lR(),ue=aR(),ne={},H=typeof Uint8Array>"u"||!se?t:se(Uint8Array),de={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":X&&se?se([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":ne,"%AsyncGenerator%":ne,"%AsyncGeneratorFunction%":ne,"%AsyncIteratorPrototype%":ne,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":r,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":k,"%GeneratorFunction%":ne,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":X&&se?se(se([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!X||!se?t:se(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":P,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":a,"%ReferenceError%":l,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!X||!se?t:se(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":X&&se?se(""[Symbol.iterator]()):t,"%Symbol%":X?Symbol:t,"%SyntaxError%":u,"%ThrowTypeError%":U,"%TypedArray%":H,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":m,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet,"%Function.prototype.call%":ue,"%Function.prototype.apply%":J,"%Object.defineProperty%":O,"%Math.abs%":_,"%Math.floor%":b,"%Math.max%":M,"%Math.min%":C,"%Math.pow%":A};if(se)try{null.error}catch(_t){var Ee=se(se(_t));de["%Error.prototype%"]=Ee}var Pe=function _t(ot){var et;if(ot==="%AsyncFunction%")et=z("async function () {}");else if(ot==="%GeneratorFunction%")et=z("function* () {}");else if(ot==="%AsyncGeneratorFunction%")et=z("async function* () {}");else if(ot==="%AsyncGenerator%"){var Mt=_t("%AsyncGeneratorFunction%");Mt&&(et=Mt.prototype)}else if(ot==="%AsyncIteratorPrototype%"){var Tt=_t("%AsyncGenerator%");Tt&&se&&(et=se(Tt.prototype))}return de[ot]=et,et},Ze={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ke=qx(),Te=Sf(),Ie=ke.call(ue,Array.prototype.concat),Ce=ke.call(J,Array.prototype.splice),Ue=ke.call(ue,String.prototype.replace),nt=ke.call(ue,String.prototype.slice),Le=ke.call(ue,RegExp.prototype.exec),lt=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ht=/\\(\\)?/g,He=function(ot){var et=nt(ot,0,1),Mt=nt(ot,-1);if(et==="%"&&Mt!=="%")throw new u("invalid intrinsic syntax, expected closing `%`");if(Mt==="%"&&et!=="%")throw new u("invalid intrinsic syntax, expected opening `%`");var Tt=[];return Ue(ot,lt,function(hn,en,an,Ke){Tt[Tt.length]=an?Ue(Ke,Ht,"$1"):en||hn}),Tt},pt=function(ot,et){var Mt=ot,Tt;if(Te(Ze,Mt)&&(Tt=Ze[Mt],Mt="%"+Tt[0]+"%"),Te(de,Mt)){var hn=de[Mt];if(hn===ne&&(hn=Pe(Mt)),typeof hn>"u"&&!et)throw new s("intrinsic "+ot+" exists, but is not available. Please file an issue!");return{alias:Tt,name:Mt,value:hn}}throw new u("intrinsic "+ot+" does not exist!")};return DE=function(ot,et){if(typeof ot!="string"||ot.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof et!="boolean")throw new s('"allowMissing" argument must be a boolean');if(Le(/^%?[^%]*%?$/,ot)===null)throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Mt=He(ot),Tt=Mt.length>0?Mt[0]:"",hn=pt("%"+Tt+"%",et),en=hn.name,an=hn.value,Ke=!1,An=hn.alias;An&&(Tt=An[0],Ce(Mt,Ie([0,1],An)));for(var Gt=1,on=!0;Gt<Mt.length;Gt+=1){var Wt=Mt[Gt],Gn=nt(Wt,0,1),dn=nt(Wt,-1);if((Gn==='"'||Gn==="'"||Gn==="`"||dn==='"'||dn==="'"||dn==="`")&&Gn!==dn)throw new u("property names with quotes must have matching quotes");if((Wt==="constructor"||!on)&&(Ke=!0),Tt+="."+Wt,en="%"+Tt+"%",Te(de,en))an=de[en];else if(an!=null){if(!(Wt in an)){if(!et)throw new s("base intrinsic for "+ot+" exists, but the property is not available.");return}if(P&&Gt+1>=Mt.length){var Ve=P(an,Wt);on=!!Ve,on&&"get"in Ve&&!("originalValue"in Ve.get)?an=Ve.get:an=an[Wt]}else on=Te(an,Wt),an=an[Wt];on&&!Ke&&(de[en]=an)}}return an},DE}var LE,_O;function tfe(){if(_O)return LE;_O=1;var t=Ma(),e=UU(),n=sR()(),r=Jy(),a=Lr(),l=t("%Math.floor%");return LE=function(s,m){if(typeof s!="function")throw new a("`fn` is not a function");if(typeof m!="number"||m<0||m>4294967295||l(m)!==m)throw new a("`length` must be a positive 32-bit integer");var _=arguments.length>2&&!!arguments[2],b=!0,M=!0;if("length"in s&&r){var C=r(s,"length");C&&!C.configurable&&(b=!1),C&&!C.writable&&(M=!1)}return(b||M||!_)&&(n?e(s,"length",m,!0,!0):e(s,"length",m)),s},LE}var kE,xO;function nfe(){if(xO)return kE;xO=1;var t=qx(),e=lR(),n=GU();return kE=function(){return n(t,e,arguments)},kE}var bO;function WU(){return bO||(bO=1,function(t){var e=tfe(),n=Wx(),r=cR(),a=nfe();t.exports=function(u){var s=r(arguments),m=u.length-(arguments.length-1);return e(s,1+(m>0?m:0),!0)},n?n(t.exports,"apply",{value:a}):t.exports.apply=a}(cE)),cE.exports}var zE,wO;function $g(){return wO||(wO=1,zE=function(e){return typeof e=="string"||typeof e=="symbol"}),zE}var OE,SO;function Vg(){if(SO)return OE;SO=1;var t=Lr(),e=Sf(),n={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return OE=function(a){if(!a||typeof a!="object")return!1;for(var l in a)if(e(a,l)&&!n[l])return!1;var u=e(a,"[[Value]]")||e(a,"[[Writable]]"),s=e(a,"[[Get]]")||e(a,"[[Set]]");if(u&&s)throw new t("Property Descriptors may not be both accessor and data descriptors");return!0},OE}var FE,MO;function uR(){if(MO)return FE;MO=1;var t=Lr(),e=Sf(),n=Vg();return FE=function(a){if(typeof a>"u")return!1;if(!n(a))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!(!e(a,"[[Get]]")&&!e(a,"[[Set]]"))},FE}var NE,EO;function rfe(){return EO||(EO=1,NE=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),NE}var BE,CO;function ife(){if(CO)return BE;CO=1;var t=Ma(),e=t("%Object.preventExtensions%",!0),n=t("%Object.isExtensible%",!0),r=rfe();return BE=e?function(l){return!r(l)&&n(l)}:function(l){return!r(l)},BE}var UE,TO;function qU(){if(TO)return UE;TO=1;var t=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,n,r;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{n=Object.defineProperty({},"length",{get:function(){throw r}}),r={},e(function(){throw 42},null,n)}catch(j){j!==r&&(e=null)}else e=null;var a=/^\s*class\b/,l=function(U){try{var X=t.call(U);return a.test(X)}catch{return!1}},u=function(U){try{return l(U)?!1:(t.call(U),!0)}catch{return!1}},s=Object.prototype.toString,m="[object Object]",_="[object Function]",b="[object GeneratorFunction]",M="[object HTMLAllCollection]",C="[object HTML document.all class]",A="[object HTMLCollection]",k=typeof Symbol=="function"&&!!Symbol.toStringTag,z=!(0 in[,]),P=function(){return!1};if(typeof document=="object"){var O=document.all;s.call(O)===s.call(document.all)&&(P=function(U){if((z||!U)&&(typeof U>"u"||typeof U=="object"))try{var X=s.call(U);return(X===M||X===C||X===A||X===m)&&U("")==null}catch{}return!1})}return UE=e?function(U){if(P(U))return!0;if(!U||typeof U!="function"&&typeof U!="object")return!1;try{e(U,null,n)}catch(X){if(X!==r)return!1}return!l(U)&&u(U)}:function(U){if(P(U))return!0;if(!U||typeof U!="function"&&typeof U!="object")return!1;if(k)return u(U);if(l(U))return!1;var X=s.call(U);return X!==_&&X!==b&&!/^\[object HTML/.test(X)?!1:u(U)},UE}var $E,PO;function Xx(){return PO||(PO=1,$E=qU()),$E}var VE,AO;function XU(){return AO||(AO=1,VE=function(e){return!!e}),VE}var jE,IO;function Xa(){return IO||(IO=1,jE=function(e){return!!e&&(typeof e=="function"||typeof e=="object")}),jE}var HE,RO;function ofe(){if(RO)return HE;RO=1;var t=Sf(),e=Lr(),n=Xx(),r=XU(),a=Xa();return HE=function(u){if(!a(u))throw new e("ToPropertyDescriptor requires an object");var s={};if(t(u,"enumerable")&&(s["[[Enumerable]]"]=r(u.enumerable)),t(u,"configurable")&&(s["[[Configurable]]"]=r(u.configurable)),t(u,"value")&&(s["[[Value]]"]=u.value),t(u,"writable")&&(s["[[Writable]]"]=r(u.writable)),t(u,"get")){var m=u.get;if(typeof m<"u"&&!n(m))throw new e("getter must be a function");s["[[Get]]"]=m}if(t(u,"set")){var _=u.set;if(typeof _<"u"&&!n(_))throw new e("setter must be a function");s["[[Set]]"]=_}if((t(s,"[[Get]]")||t(s,"[[Set]]"))&&(t(s,"[[Value]]")||t(s,"[[Writable]]")))throw new e("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return s},HE}var GE,DO;function hR(){return DO||(DO=1,GE=Number.isNaN||function(e){return e!==e}),GE}var WE,LO;function dR(){if(LO)return WE;LO=1;var t=hR();return WE=function(n,r){return n===r?n===0?1/n===1/r:!0:t(n)&&t(r)},WE}var qE,kO;function Dl(){if(kO)return qE;kO=1;var t=Ma(),e=cR(),n=e([t("%String.prototype.indexOf%")]);return qE=function(a,l){var u=t(a,!!l);return typeof u=="function"&&n(a,".prototype.")>-1?e([u]):u},qE}var XE,zO;function fR(){if(zO)return XE;zO=1;var t=Ma(),e=t("%Array%"),n=!e.isArray&&Dl()("Object.prototype.toString");return XE=e.isArray||function(a){return n(a)==="[object Array]"},XE}var ZE,OO;function sfe(){if(OO)return ZE;OO=1;var t=sR(),e=Wx(),n=t.hasArrayLengthDefineBug(),r=n&&fR(),a=Dl(),l=a("Object.prototype.propertyIsEnumerable");return ZE=function(s,m,_,b,M,C){if(!e){if(!s(C)||!C["[[Configurable]]"]||!C["[[Writable]]"]||M in b&&l(b,M)!==!!C["[[Enumerable]]"])return!1;var A=C["[[Value]]"];return b[M]=A,m(b[M],A)}return n&&M==="length"&&"[[Value]]"in C&&r(b)&&b.length!==C["[[Value]]"]?(b.length=C["[[Value]]"],b.length===C["[[Value]]"]):(e(b,M,_(C)),!0)},ZE}var YE,FO;function afe(){if(FO)return YE;FO=1;var t=Vg();return YE=function(n,r){return t(r)&&"[[Enumerable]]"in r&&"[[Configurable]]"in r&&(n.IsAccessorDescriptor(r)||n.IsDataDescriptor(r))},YE}var KE,NO;function lfe(){return NO||(NO=1,KE=function(e){if(typeof e>"u")return e;var n={};return"[[Value]]"in e&&(n.value=e["[[Value]]"]),"[[Writable]]"in e&&(n.writable=!!e["[[Writable]]"]),"[[Get]]"in e&&(n.get=e["[[Get]]"]),"[[Set]]"in e&&(n.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(n.enumerable=!!e["[[Enumerable]]"]),"[[Configurable]]"in e&&(n.configurable=!!e["[[Configurable]]"]),n}),KE}var JE,BO;function cfe(){if(BO)return JE;BO=1;var t=Lr(),e=Vg(),n=lfe();return JE=function(a){if(typeof a<"u"&&!e(a))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return n(a)},JE}var QE,UO;function ZU(){if(UO)return QE;UO=1;var t=Lr(),e=Sf(),n=Vg();return QE=function(a){if(typeof a>"u")return!1;if(!n(a))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!(!e(a,"[[Value]]")&&!e(a,"[[Writable]]"))},QE}var eC,$O;function ufe(){if($O)return eC;$O=1;var t=Lr(),e=uR(),n=ZU(),r=Vg();return eC=function(l){if(typeof l>"u")return!1;if(!r(l))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!e(l)&&!n(l)},eC}var tC,VO;function hfe(){if(VO)return tC;VO=1;var t=Xa();return tC=function(n){if(n===null)return"Null";if(typeof n>"u")return"Undefined";if(t(n))return"Object";if(typeof n=="number")return"Number";if(typeof n=="boolean")return"Boolean";if(typeof n=="string")return"String"},tC}var nC,jO;function dfe(){if(jO)return nC;jO=1;var t=hfe();return nC=function(n){return typeof n=="symbol"?"Symbol":typeof n=="bigint"?"BigInt":t(n)},nC}var rC,HO;function ffe(){if(HO)return rC;HO=1;var t=Lr(),e=sfe(),n=afe(),r=Vg(),a=cfe(),l=uR(),u=ZU(),s=ufe(),m=$g(),_=dR(),b=dfe(),M=Xa();return rC=function(A,k,z,P,O){var j=b(A);if(typeof A<"u"&&!M(A))throw new t("Assertion failed: O must be undefined or an Object");if(!m(k))throw new t("Assertion failed: P must be a Property Key");if(typeof z!="boolean")throw new t("Assertion failed: extensible must be a Boolean");if(!r(P))throw new t("Assertion failed: Desc must be a Property Descriptor");if(typeof O<"u"&&!r(O))throw new t("Assertion failed: current must be a Property Descriptor, or undefined");if(typeof O>"u")return z?j==="Undefined"?!0:l(P)?e(u,_,a,A,k,P):e(u,_,a,A,k,{"[[Configurable]]":!!P["[[Configurable]]"],"[[Enumerable]]":!!P["[[Enumerable]]"],"[[Value]]":P["[[Value]]"],"[[Writable]]":!!P["[[Writable]]"]}):!1;if(!n({IsAccessorDescriptor:l,IsDataDescriptor:u},O))throw new t("`current`, when present, must be a fully populated and valid Property Descriptor");if(!O["[[Configurable]]"]){if("[[Configurable]]"in P&&P["[[Configurable]]"]||"[[Enumerable]]"in P&&!_(P["[[Enumerable]]"],O["[[Enumerable]]"])||!s(P)&&!_(l(P),l(O)))return!1;if(l(O)){if("[[Get]]"in P&&!_(P["[[Get]]"],O["[[Get]]"])||"[[Set]]"in P&&!_(P["[[Set]]"],O["[[Set]]"]))return!1}else if(!O["[[Writable]]"]&&("[[Writable]]"in P&&P["[[Writable]]"]||"[[Value]]"in P&&!_(P["[[Value]]"],O["[[Value]]"])))return!1}if(j!=="Undefined"){var U,X;return u(O)&&l(P)?(U=("[[Configurable]]"in P?P:O)["[[Configurable]]"],X=("[[Enumerable]]"in P?P:O)["[[Enumerable]]"],e(u,_,a,A,k,{"[[Configurable]]":!!U,"[[Enumerable]]":!!X,"[[Get]]":("[[Get]]"in P?P:O)["[[Get]]"],"[[Set]]":("[[Set]]"in P?P:O)["[[Set]]"]})):l(O)&&u(P)?(U=("[[Configurable]]"in P?P:O)["[[Configurable]]"],X=("[[Enumerable]]"in P?P:O)["[[Enumerable]]"],e(u,_,a,A,k,{"[[Configurable]]":!!U,"[[Enumerable]]":!!X,"[[Value]]":("[[Value]]"in P?P:O)["[[Value]]"],"[[Writable]]":!!("[[Writable]]"in P?P:O)["[[Writable]]"]})):e(u,_,a,A,k,P)}return!0},rC}var iC,GO;function pfe(){if(GO)return iC;GO=1;var t=Jy(),e=dm(),n=Lr(),r=Vg(),a=uR(),l=ife(),u=$g(),s=ofe(),m=dR(),_=ffe(),b=Xa();return iC=function(C,A,k){if(!b(C))throw new n("Assertion failed: O must be an Object");if(!u(A))throw new n("Assertion failed: P must be a Property Key");if(!r(k))throw new n("Assertion failed: Desc must be a Property Descriptor");if(!t){if(a(k))throw new e("This environment does not support accessor property descriptors.");var z=!(A in C)&&k["[[Writable]]"]&&k["[[Enumerable]]"]&&k["[[Configurable]]"]&&"[[Value]]"in k,P=A in C&&(!("[[Configurable]]"in k)||k["[[Configurable]]"])&&(!("[[Enumerable]]"in k)||k["[[Enumerable]]"])&&(!("[[Writable]]"in k)||k["[[Writable]]"])&&"[[Value]]"in k;if(z||P)return C[A]=k["[[Value]]"],m(C[A],k["[[Value]]"]);throw new e("This environment does not support defining non-writable, non-enumerable, or non-configurable properties")}var O=t(C,A),j=O&&s(O),U=l(C);return _(C,A,U,k,j)},iC}var oC,WO;function mfe(){if(WO)return oC;WO=1;var t=Lr(),e=$g(),n=pfe(),r=Xa();return oC=function(l,u,s){if(!r(l))throw new t("Assertion failed: Type(O) is not Object");if(!e(u))throw new t("Assertion failed: P is not a Property Key");var m={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Value]]":s,"[[Writable]]":!0};return n(l,u,m)},oC}var sC,qO;function gfe(){if(qO)return sC;qO=1;var t=Lr(),e=mfe(),n=Xa(),r=$g();return sC=function(l,u,s){if(!n(l))throw new t("Assertion failed: Type(O) is not Object");if(!r(u))throw new t("Assertion failed: P is not a Property Key");var m=e(l,u,s);if(!m)throw new t("unable to create data property")},sC}var aC,XO;function pR(){return XO||(XO=1,aC=fR()),aC}var lC,ZO;function mR(){return ZO||(ZO=1,lC=function(e,n){for(var r=0;r<e.length;r+=1)n(e[r],r,e)}),lC}const vfe={},yfe=Object.freeze(Object.defineProperty({__proto__:null,default:vfe},Symbol.toStringTag,{value:"Module"})),_fe=Q9(yfe);var cC,YO;function fm(){if(YO)return cC;YO=1;var t=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=t&&e&&typeof e.get=="function"?e.get:null,r=t&&Map.prototype.forEach,a=typeof Set=="function"&&Set.prototype,l=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=a&&l&&typeof l.get=="function"?l.get:null,s=a&&Set.prototype.forEach,m=typeof WeakMap=="function"&&WeakMap.prototype,_=m?WeakMap.prototype.has:null,b=typeof WeakSet=="function"&&WeakSet.prototype,M=b?WeakSet.prototype.has:null,C=typeof WeakRef=="function"&&WeakRef.prototype,A=C?WeakRef.prototype.deref:null,k=Boolean.prototype.valueOf,z=Object.prototype.toString,P=Function.prototype.toString,O=String.prototype.match,j=String.prototype.slice,U=String.prototype.replace,X=String.prototype.toUpperCase,K=String.prototype.toLowerCase,se=RegExp.prototype.test,J=Array.prototype.concat,ue=Array.prototype.join,ne=Array.prototype.slice,H=Math.floor,de=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ee=Object.getOwnPropertySymbols,Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ze=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ke=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ze||!0)?Symbol.toStringTag:null,Te=Object.prototype.propertyIsEnumerable,Ie=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(he){return he.__proto__}:null);function Ce(he,xe){if(he===1/0||he===-1/0||he!==he||he&&he>-1e3&&he<1e3||se.call(/e/,xe))return xe;var Ye=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof he=="number"){var st=he<0?-H(-he):H(he);if(st!==he){var _e=String(st),Fe=j.call(xe,_e.length+1);return U.call(_e,Ye,"$&_")+"."+U.call(U.call(Fe,/([0-9]{3})/g,"$&_"),/_$/,"")}}return U.call(xe,Ye,"$&_")}var Ue=_fe,nt=Ue.custom,Le=an(nt)?nt:null,lt={__proto__:null,double:'"',single:"'"},Ht={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};cC=function he(xe,Ye,st,_e){var Fe=Ye||{};if(Gt(Fe,"quoteStyle")&&!Gt(lt,Fe.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Gt(Fe,"maxStringLength")&&(typeof Fe.maxStringLength=="number"?Fe.maxStringLength<0&&Fe.maxStringLength!==1/0:Fe.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Ge=Gt(Fe,"customInspect")?Fe.customInspect:!0;if(typeof Ge!="boolean"&&Ge!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Gt(Fe,"indent")&&Fe.indent!==null&&Fe.indent!=="	"&&!(parseInt(Fe.indent,10)===Fe.indent&&Fe.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Gt(Fe,"numericSeparator")&&typeof Fe.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var je=Fe.numericSeparator;if(typeof xe>"u")return"undefined";if(xe===null)return"null";if(typeof xe=="boolean")return xe?"true":"false";if(typeof xe=="string")return Ut(xe,Fe);if(typeof xe=="number"){if(xe===0)return 1/0/xe>0?"0":"-0";var De=String(xe);return je?Ce(xe,De):De}if(typeof xe=="bigint"){var zt=String(xe)+"n";return je?Ce(xe,zt):zt}var fn=typeof Fe.depth>"u"?5:Fe.depth;if(typeof st>"u"&&(st=0),st>=fn&&fn>0&&typeof xe=="object")return _t(xe)?"[Array]":"[Object]";var sn=ee(Fe,st);if(typeof _e>"u")_e=[];else if(Gn(_e,xe)>=0)return"[Circular]";function Jt(En,Bn,In){if(Bn&&(_e=ne.call(_e),_e.push(Bn)),In){var fr={depth:Fe.depth};return Gt(Fe,"quoteStyle")&&(fr.quoteStyle=Fe.quoteStyle),he(En,fr,st+1,_e)}return he(En,Fe,st+1,_e)}if(typeof xe=="function"&&!et(xe)){var cn=Wt(xe),Zn=fe(xe,Jt);return"[Function"+(cn?": "+cn:" (anonymous)")+"]"+(Zn.length>0?" { "+ue.call(Zn,", ")+" }":"")}if(an(xe)){var yr=Ze?U.call(String(xe),/^(Symbol\(.*\))_[^)]*$/,"$1"):Pe.call(xe);return typeof xe=="object"&&!Ze?Zt(yr):yr}if(jt(xe)){for(var Ar="<"+K.call(String(xe.nodeName)),Je=xe.attributes||[],gt=0;gt<Je.length;gt++)Ar+=" "+Je[gt].name+"="+He(pt(Je[gt].value),"double",Fe);return Ar+=">",xe.childNodes&&xe.childNodes.length&&(Ar+="..."),Ar+="</"+K.call(String(xe.nodeName))+">",Ar}if(_t(xe)){if(xe.length===0)return"[]";var St=fe(xe,Jt);return sn&&!Be(St)?"["+oe(St,sn)+"]":"[ "+ue.call(St,", ")+" ]"}if(Mt(xe)){var ft=fe(xe,Jt);return!("cause"in Error.prototype)&&"cause"in xe&&!Te.call(xe,"cause")?"{ ["+String(xe)+"] "+ue.call(J.call("[cause]: "+Jt(xe.cause),ft),", ")+" }":ft.length===0?"["+String(xe)+"]":"{ ["+String(xe)+"] "+ue.call(ft,", ")+" }"}if(typeof xe=="object"&&Ge){if(Le&&typeof xe[Le]=="function"&&Ue)return Ue(xe,{depth:fn-st});if(Ge!=="symbol"&&typeof xe.inspect=="function")return xe.inspect()}if(dn(xe)){var Qt=[];return r&&r.call(xe,function(En,Bn){Qt.push(Jt(Bn,xe,!0)+" => "+Jt(En,xe))}),Fn("Map",n.call(xe),Qt,sn)}if(bt(xe)){var Sn=[];return s&&s.call(xe,function(En){Sn.push(Jt(En,xe))}),Fn("Set",u.call(xe),Sn,sn)}if(Ve(xe))return qt("WeakMap");if(Nt(xe))return qt("WeakSet");if(Se(xe))return qt("WeakRef");if(hn(xe))return Zt(Jt(Number(xe)));if(Ke(xe))return Zt(Jt(de.call(xe)));if(en(xe))return Zt(k.call(xe));if(Tt(xe))return Zt(Jt(String(xe)));if(typeof window<"u"&&xe===window)return"{ [object Window] }";if(typeof globalThis<"u"&&xe===globalThis||typeof yD<"u"&&xe===yD)return"{ [object globalThis] }";if(!ot(xe)&&!et(xe)){var Un=fe(xe,Jt),kn=Ie?Ie(xe)===Object.prototype:xe instanceof Object||xe.constructor===Object,Rt=xe instanceof Object?"":"null prototype",ct=!kn&&ke&&Object(xe)===xe&&ke in xe?j.call(on(xe),8,-1):Rt?"Object":"",ut=kn||typeof xe.constructor!="function"?"":xe.constructor.name?xe.constructor.name+" ":"",Vt=ut+(ct||Rt?"["+ue.call(J.call([],ct||[],Rt||[]),": ")+"] ":"");return Un.length===0?Vt+"{}":sn?Vt+"{"+oe(Un,sn)+"}":Vt+"{ "+ue.call(Un,", ")+" }"}return String(xe)};function He(he,xe,Ye){var st=Ye.quoteStyle||xe,_e=lt[st];return _e+he+_e}function pt(he){return U.call(String(he),/"/g,"&quot;")}function _t(he){return on(he)==="[object Array]"&&(!ke||!(typeof he=="object"&&ke in he))}function ot(he){return on(he)==="[object Date]"&&(!ke||!(typeof he=="object"&&ke in he))}function et(he){return on(he)==="[object RegExp]"&&(!ke||!(typeof he=="object"&&ke in he))}function Mt(he){return on(he)==="[object Error]"&&(!ke||!(typeof he=="object"&&ke in he))}function Tt(he){return on(he)==="[object String]"&&(!ke||!(typeof he=="object"&&ke in he))}function hn(he){return on(he)==="[object Number]"&&(!ke||!(typeof he=="object"&&ke in he))}function en(he){return on(he)==="[object Boolean]"&&(!ke||!(typeof he=="object"&&ke in he))}function an(he){if(Ze)return he&&typeof he=="object"&&he instanceof Symbol;if(typeof he=="symbol")return!0;if(!he||typeof he!="object"||!Pe)return!1;try{return Pe.call(he),!0}catch{}return!1}function Ke(he){if(!he||typeof he!="object"||!de)return!1;try{return de.call(he),!0}catch{}return!1}var An=Object.prototype.hasOwnProperty||function(he){return he in this};function Gt(he,xe){return An.call(he,xe)}function on(he){return z.call(he)}function Wt(he){if(he.name)return he.name;var xe=O.call(P.call(he),/^function\s*([\w$]+)/);return xe?xe[1]:null}function Gn(he,xe){if(he.indexOf)return he.indexOf(xe);for(var Ye=0,st=he.length;Ye<st;Ye++)if(he[Ye]===xe)return Ye;return-1}function dn(he){if(!n||!he||typeof he!="object")return!1;try{n.call(he);try{u.call(he)}catch{return!0}return he instanceof Map}catch{}return!1}function Ve(he){if(!_||!he||typeof he!="object")return!1;try{_.call(he,_);try{M.call(he,M)}catch{return!0}return he instanceof WeakMap}catch{}return!1}function Se(he){if(!A||!he||typeof he!="object")return!1;try{return A.call(he),!0}catch{}return!1}function bt(he){if(!u||!he||typeof he!="object")return!1;try{u.call(he);try{n.call(he)}catch{return!0}return he instanceof Set}catch{}return!1}function Nt(he){if(!M||!he||typeof he!="object")return!1;try{M.call(he,M);try{_.call(he,_)}catch{return!0}return he instanceof WeakSet}catch{}return!1}function jt(he){return!he||typeof he!="object"?!1:typeof HTMLElement<"u"&&he instanceof HTMLElement?!0:typeof he.nodeName=="string"&&typeof he.getAttribute=="function"}function Ut(he,xe){if(he.length>xe.maxStringLength){var Ye=he.length-xe.maxStringLength,st="... "+Ye+" more character"+(Ye>1?"s":"");return Ut(j.call(he,0,xe.maxStringLength),xe)+st}var _e=Ht[xe.quoteStyle||"single"];_e.lastIndex=0;var Fe=U.call(U.call(he,_e,"\\$1"),/[\x00-\x1f]/g,yn);return He(Fe,"single",xe)}function yn(he){var xe=he.charCodeAt(0),Ye={8:"b",9:"t",10:"n",12:"f",13:"r"}[xe];return Ye?"\\"+Ye:"\\x"+(xe<16?"0":"")+X.call(xe.toString(16))}function Zt(he){return"Object("+he+")"}function qt(he){return he+" { ? }"}function Fn(he,xe,Ye,st){var _e=st?oe(Ye,st):ue.call(Ye,", ");return he+" ("+xe+") {"+_e+"}"}function Be(he){for(var xe=0;xe<he.length;xe++)if(Gn(he[xe],`
`)>=0)return!1;return!0}function ee(he,xe){var Ye;if(he.indent==="	")Ye="	";else if(typeof he.indent=="number"&&he.indent>0)Ye=ue.call(Array(he.indent+1)," ");else return null;return{base:Ye,prev:ue.call(Array(xe+1),Ye)}}function oe(he,xe){if(he.length===0)return"";var Ye=`
`+xe.prev+xe.base;return Ye+ue.call(he,","+Ye)+`
`+xe.prev}function fe(he,xe){var Ye=_t(he),st=[];if(Ye){st.length=he.length;for(var _e=0;_e<he.length;_e++)st[_e]=Gt(he,_e)?xe(he[_e],he):""}var Fe=typeof Ee=="function"?Ee(he):[],Ge;if(Ze){Ge={};for(var je=0;je<Fe.length;je++)Ge["$"+Fe[je]]=Fe[je]}for(var De in he)Gt(he,De)&&(Ye&&String(Number(De))===De&&De<he.length||Ze&&Ge["$"+De]instanceof Symbol||(se.call(/[^\w$]/,De)?st.push(xe(De,he)+": "+xe(he[De],he)):st.push(De+": "+xe(he[De],he))));if(typeof Ee=="function")for(var zt=0;zt<Fe.length;zt++)Te.call(he,Fe[zt])&&st.push("["+xe(Fe[zt])+"]: "+xe(he[Fe[zt]],he));return st}return cC}var uC,KO;function xfe(){if(KO)return uC;KO=1;var t=fm(),e=Lr(),n=function(s,m,_){for(var b=s,M;(M=b.next)!=null;b=M)if(M.key===m)return b.next=M.next,_||(M.next=s.next,s.next=M),M},r=function(s,m){if(s){var _=n(s,m);return _&&_.value}},a=function(s,m,_){var b=n(s,m);b?b.value=_:s.next={key:m,next:s.next,value:_}},l=function(s,m){return s?!!n(s,m):!1},u=function(s,m){if(s)return n(s,m,!0)};return uC=function(){var m,_={assert:function(b){if(!_.has(b))throw new e("Side channel does not contain "+t(b))},delete:function(b){var M=m&&m.next,C=u(m,b);return C&&M&&M===C&&(m=void 0),!!C},get:function(b){return r(m,b)},has:function(b){return l(m,b)},set:function(b,M){m||(m={next:void 0}),a(m,b,M)}};return _},uC}var hC,JO;function YU(){if(JO)return hC;JO=1;var t=Ma(),e=Dl(),n=fm(),r=Lr(),a=t("%Map%",!0),l=e("Map.prototype.get",!0),u=e("Map.prototype.set",!0),s=e("Map.prototype.has",!0),m=e("Map.prototype.delete",!0),_=e("Map.prototype.size",!0);return hC=!!a&&function(){var M,C={assert:function(A){if(!C.has(A))throw new r("Side channel does not contain "+n(A))},delete:function(A){if(M){var k=m(M,A);return _(M)===0&&(M=void 0),k}return!1},get:function(A){if(M)return l(M,A)},has:function(A){return M?s(M,A):!1},set:function(A,k){M||(M=new a),u(M,A,k)}};return C},hC}var dC,QO;function bfe(){if(QO)return dC;QO=1;var t=Ma(),e=Dl(),n=fm(),r=YU(),a=Lr(),l=t("%WeakMap%",!0),u=e("WeakMap.prototype.get",!0),s=e("WeakMap.prototype.set",!0),m=e("WeakMap.prototype.has",!0),_=e("WeakMap.prototype.delete",!0);return dC=l?function(){var M,C,A={assert:function(k){if(!A.has(k))throw new a("Side channel does not contain "+n(k))},delete:function(k){if(l&&k&&(typeof k=="object"||typeof k=="function")){if(M)return _(M,k)}else if(r&&C)return C.delete(k);return!1},get:function(k){return l&&k&&(typeof k=="object"||typeof k=="function")&&M?u(M,k):C&&C.get(k)},has:function(k){return l&&k&&(typeof k=="object"||typeof k=="function")&&M?m(M,k):!!C&&C.has(k)},set:function(k,z){l&&k&&(typeof k=="object"||typeof k=="function")?(M||(M=new l),s(M,k,z)):r&&(C||(C=r()),C.set(k,z))}};return A}:r,dC}var fC,e5;function wfe(){if(e5)return fC;e5=1;var t=Lr(),e=fm(),n=xfe(),r=YU(),a=bfe(),l=a||r||n;return fC=function(){var s,m={assert:function(_){if(!m.has(_))throw new t("Side channel does not contain "+e(_))},delete:function(_){return!!s&&s.delete(_)},get:function(_){return s&&s.get(_)},has:function(_){return!!s&&s.has(_)},set:function(_,b){s||(s=l()),s.set(_,b)}};return m},fC}var pC,t5;function gR(){if(t5)return pC;t5=1;var t=Sf(),e=wfe()(),n=Lr(),r={assert:function(a,l){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");if(e.assert(a),!r.has(a,l))throw new n("`"+l+"` is not present on `O`")},get:function(a,l){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var u=e.get(a);return u&&u["$"+l]},has:function(a,l){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var u=e.get(a);return!!u&&t(u,"$"+l)},set:function(a,l,u){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var s=e.get(a);s||(s={},e.set(a,s)),s["$"+l]=u}};return Object.freeze&&Object.freeze(r),pC=r,pC}var mC,n5;function Sfe(){if(n5)return mC;n5=1;var t={__proto__:null,foo:{}},e={__proto__:t}.foo===t.foo&&!(t instanceof Object);return mC=function(){return e},mC}var gC,r5;function KU(){if(r5)return gC;r5=1;var t=Ma(),e=t("%Object.create%",!0),n=Lr(),r=dm(),a=pR(),l=mR(),u=Xa(),s=gR(),m=Sfe()();return gC=function(b){if(b!==null&&!u(b))throw new n("Assertion failed: `proto` must be null or an object");var M=arguments.length<2?[]:arguments[1];if(!a(M))throw new n("Assertion failed: `additionalInternalSlotsList` must be an Array");var C;if(e)C=e(b);else if(m)C={__proto__:b};else{if(b===null)throw new r("native Object.create support is required to create null objects");var A=function(){};A.prototype=b,C=new A}return M.length>0&&l(M,function(k){s.set(C,k,void 0)}),C},gC}var vC,i5;function Mfe(){return i5||(i5=1,vC=function(e){return e===0&&1/e===-1/0}),vC}var yC,o5;function JU(){return o5||(o5=1,yC=Number.MAX_SAFE_INTEGER||9007199254740991),yC}var _C,s5;function Efe(){return s5||(s5=1,_C=function(e,n){for(var r=0;r<e.length;r+=1)if(!n(e[r],r,e))return!1;return!0}),_C}var xC,a5;function Cfe(){if(a5)return xC;a5=1;var t=Lr(),e=Dl(),n=e("Array.prototype.push"),r=dR(),a=fR(),l=Efe(),u=mR(),s=Sf(),m=function(_){return s(_,"[[Key]]")&&s(_,"[[Elements]]")&&a(_["[[Elements]]"])};return xC=function(b,M,C){if(!a(b)||b.length>0&&!l(b,m))throw new t("Assertion failed: `groups` must be a List of Records with [[Key]] and [[Elements]]");var A=0;if(u(b,function(z){if(r(z["[[Key]]"],M)){if(A+=1,A>1)throw new t("Assertion failed: Exactly one element of groups meets this criterion");n(z["[[Elements]]"],C)}}),A===0){var k={"[[Key]]":M,"[[Elements]]":[C]};n(b,k)}},xC}var bC,l5;function Zx(){if(l5)return bC;l5=1;var t=Ma(),e=Dl(),n=Lr(),r=pR(),a=t("%Reflect.apply%",!0)||e("Function.prototype.apply");return bC=function(u,s){var m=arguments.length>2?arguments[2]:[];if(!r(m))throw new n("Assertion failed: optional `argumentsList`, if provided, must be a List");return a(u,s,m)},bC}var wC,c5;function QU(){return c5||(c5=1,wC=function(e){return typeof e=="number"&&e>=55296&&e<=56319}),wC}var SC,u5;function e8(){return u5||(u5=1,SC=function(e){return typeof e=="number"&&e>=56320&&e<=57343}),SC}var MC,h5;function Tfe(){if(h5)return MC;h5=1;var t=Ma(),e=Lr(),n=t("%String.fromCharCode%"),r=QU(),a=e8();return MC=function(u,s){if(!r(u)||!a(s))throw new e("Assertion failed: `lead` must be a leading surrogate char code, and `trail` must be a trailing surrogate char code");return n(u)+n(s)},MC}var EC,d5;function Pfe(){if(d5)return EC;d5=1;var t=Lr(),e=Dl(),n=QU(),r=e8(),a=Tfe(),l=e("String.prototype.charAt"),u=e("String.prototype.charCodeAt");return EC=function(m,_){if(typeof m!="string")throw new t("Assertion failed: `string` must be a String");var b=m.length;if(_<0||_>=b)throw new t("Assertion failed: `position` must be >= 0, and < the length of `string`");var M=u(m,_),C=l(m,_),A=n(M),k=r(M);if(!A&&!k)return{"[[CodePoint]]":C,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!1};if(k||_+1===b)return{"[[CodePoint]]":C,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0};var z=u(m,_+1);return r(z)?{"[[CodePoint]]":a(M,z),"[[CodeUnitCount]]":2,"[[IsUnpairedSurrogate]]":!1}:{"[[CodePoint]]":C,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0}},EC}var CC,f5;function Afe(){if(f5)return CC;f5=1;var t=hR();return CC=function(n){return(typeof n=="number"||typeof n=="bigint")&&!t(n)&&n!==1/0&&n!==-1/0},CC}var TC,p5;function Ife(){if(p5)return TC;p5=1;var t=VU(),e=jU(),n=hR(),r=Afe();return TC=function(l){if(typeof l!="number"||n(l)||!r(l))return!1;var u=t(l);return e(u)===u},TC}var PC,m5;function Rfe(){if(m5)return PC;m5=1;var t=Pfe(),e=Lr(),n=Ife(),r=JU();return PC=function(l,u,s){if(typeof l!="string")throw new e("Assertion failed: `S` must be a String");if(!n(u)||u<0||u>r)throw new e("Assertion failed: `length` must be an integer >= 0 and <= 2**53");if(typeof s!="boolean")throw new e("Assertion failed: `unicode` must be a Boolean");if(!s)return u+1;var m=l.length;if(u+1>=m)return u+1;var _=t(l,u);return u+_["[[CodeUnitCount]]"]},PC}var AC,g5;function t8(){if(g5)return AC;g5=1;var t=Lr();return AC=function(n,r){if(typeof r!="boolean")throw new t("Assertion failed: Type(done) is not Boolean");return{value:n,done:r}},AC}var IC,v5;function t2(){if(v5)return IC;v5=1;var t=Lr(),e=fm(),n=Xa(),r=$g();return IC=function(l,u){if(!n(l))throw new t("Assertion failed: Type(O) is not Object");if(!r(u))throw new t("Assertion failed: P is not a Property Key, got "+e(u));return l[u]},IC}var RC,y5;function n8(){if(y5)return RC;y5=1;var t=Lr(),e=t2(),n=XU(),r=Xa();return RC=function(l){if(!r(l))throw new t("Assertion failed: Type(iterResult) is not Object");return n(e(l,"done"))},RC}var DC,_5;function r8(){if(_5)return DC;_5=1;var t=Lr(),e=t2(),n=Xa();return DC=function(a){if(!n(a))throw new t("Assertion failed: Type(iterResult) is not Object");return e(a,"value")},DC}var LC,x5;function Dfe(){if(x5)return LC;x5=1;var t=Ma(),e=WU(),n=dm(),r=t("%Promise.resolve%",!0),a=r&&e(r);return LC=function(u,s){if(!a)throw new n("This environment does not support Promises.");return a(u,s)},LC}var kC,b5;function Lfe(){if(b5)return kC;b5=1;var t=Ma(),e=dm(),n=Lr(),r=t("%Promise%",!0),a=Dl(),l=t8(),u=n8(),s=r8(),m=Dfe(),_=Xa(),b=a("Promise.prototype.then",!0);return kC=function(C){if(!_(C))throw new n("Assertion failed: Type(O) is not Object");if(arguments.length>1)throw new e("although AsyncFromSyncIteratorContinuation should take a second argument, it is not used in this implementation");if(!r)throw new e("This environment does not support Promises.");return new r(function(A){var k=u(C),z=s(C),P=m(r,z),O=function(j){return l(j,k)};A(b(P,O))})},kC}var zC,w5;function kfe(){if(w5)return zC;w5=1;var t=Lr(),e=fm(),n=$g();return zC=function(a,l){if(!n(l))throw new t("Assertion failed: P is not a Property Key, got "+e(l));return a[l]},zC}var OC,S5;function vR(){if(S5)return OC;S5=1;var t=Lr(),e=kfe(),n=Xx(),r=$g(),a=fm();return OC=function(u,s){if(!r(s))throw new t("Assertion failed: P is not a Property Key");var m=e(u,s);if(m!=null){if(!n(m))throw new t(a(s)+" is not a function: "+a(m));return m}},OC}var FC,M5;function n2(){if(M5)return FC;M5=1;var t=Sf();return FC=function(n){return!!n&&typeof n=="object"&&t(n,"[[Iterator]]")&&t(n,"[[NextMethod]]")&&t(n,"[[Done]]")&&typeof n["[[Done]]"]=="boolean"},FC}var NC,E5;function i8(){if(E5)return NC;E5=1;var t=Lr(),e=Zx(),n=Xa(),r=n2();return NC=function(l){if(!r(l))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");var u;if(arguments.length<2?u=e(l["[[NextMethod]]"],l["[[Iterator]]"]):u=e(l["[[NextMethod]]"],l["[[Iterator]]"],[arguments[1]]),!n(u))throw new t("iterator next must return an object");return u},NC}var BC,C5;function zfe(){if(C5)return BC;C5=1;var t=Ma(),e=dm(),n=Lr(),r=t("%Promise%",!0),a=Lfe(),l=Zx(),u=t8(),s=t2(),m=vR(),_=i8(),b=KU(),M=Xa(),C=n2(),A=gR(),k=t("%AsyncFromSyncIteratorPrototype%",!0)||{next:function(P){if(!r)throw new e("This environment does not support Promises.");var O=this;A.assert(O,"[[SyncIteratorRecord]]");var j=arguments.length;return new r(function(U){var X=A.get(O,"[[SyncIteratorRecord]]"),K;j>0?K=_(X,P):K=_(X),U(a(K))})},return:function(){if(!r)throw new e("This environment does not support Promises.");var z=this;A.assert(z,"[[SyncIteratorRecord]]");var P=arguments.length>0,O=P?arguments[0]:void 0;return new r(function(j,U){var X=A.get(z,"[[SyncIteratorRecord]]")["[[Iterator]]"],K=m(X,"return");if(typeof K>"u"){var se=u(O,!0);l(j,void 0,[se]);return}var J;if(P?J=l(K,X,[O]):J=l(K,X),!M(J)){l(U,void 0,[new n("Iterator `return` method returned a non-object value.")]);return}j(a(J))})},throw:function(){if(!r)throw new e("This environment does not support Promises.");var z=this;A.assert(z,"[[SyncIteratorRecord]]");var P=arguments.length>0,O=P?arguments[0]:void 0;return new r(function(j,U){var X=A.get(z,"[[SyncIteratorRecord]]")["[[Iterator]]"],K=m(X,"throw");if(typeof K>"u"){l(U,void 0,[O]);return}var se;if(P?se=l(K,X,[O]):se=l(K,X),!M(se)){l(U,void 0,[new n("Iterator `throw` method returned a non-object value.")]);return}j(a(se))})}};return BC=function(P){if(!C(P))throw new n("Assertion failed: `syncIteratorRecord` must be an Iterator Record");var O=b(k);A.set(O,"[[SyncIteratorRecord]]",P);var j=s(O,"next");return{"[[Iterator]]":O,"[[NextMethod]]":j,"[[Done]]":!1}},BC}var UC,T5;function Ofe(){if(T5)return UC;T5=1;var t=Lr(),e=Zx(),n=t2(),r=Xx(),a=Xa();return UC=function(u,s){if(!r(s))throw new t("method must be a function");var m=e(s,u);if(!a(m))throw new t("iterator must return an object");var _=n(m,"next");return{"[[Iterator]]":m,"[[NextMethod]]":_,"[[Done]]":!1}},UC}var $C,P5;function yR(){if(P5)return $C;P5=1;var t=HU();return $C=function(){return t()&&!!Symbol.toStringTag},$C}var VC,A5;function Ffe(){if(A5)return VC;A5=1;var t=Dl(),e=t("String.prototype.valueOf"),n=function(s){try{return e(s),!0}catch{return!1}},r=t("Object.prototype.toString"),a="[object String]",l=yR()();return VC=function(s){return typeof s=="string"?!0:!s||typeof s!="object"?!1:l?n(s):r(s)===a},VC}var jC,I5;function Nfe(){if(I5)return jC;I5=1;var t=e2()(),e=Ma(),n=Dl(),r=Ffe(),a=e("%Symbol.iterator%",!0),l=n("String.prototype.slice"),u=e("%String%");return jC=function(m,_){var b;return t?b=m.GetMethod(_,a):m.IsArray(_)?b=function(){var M=-1,C=this;return{next:function(){return M+=1,{done:M>=C.length,value:C[M]}}}}:r(_)&&(b=function(){var M=0;return{next:function(){var C=m.AdvanceStringIndex(u(_),M,!0),A=l(_,M,C);return M=C,{done:C>_.length,value:A}}}}),b},jC}var HC,R5;function Bfe(){if(R5)return HC;R5=1;var t=Ma(),e=Lr(),n=t("%Symbol.asyncIterator%",!0),r=fm(),a=e2()(),l=Rfe(),u=zfe(),s=Ofe(),m=vR(),_=pR(),b={AdvanceStringIndex:l,GetMethod:m,IsArray:_},M=Nfe();return HC=function(A,k){if(k!=="SYNC"&&k!=="ASYNC")throw new e("Assertion failed: `kind` must be one of 'sync' or 'async', got "+r(k));var z;if(k==="ASYNC"&&a&&n&&(z=m(A,n)),typeof z>"u"){var P=M(b,A);if(k==="ASYNC"){if(typeof P>"u")throw new e("iterator method is `undefined`");var O=s(A,P);return u(O)}z=P}if(typeof z>"u")throw new e("iterator method is `undefined`");return s(A,z)},HC}var GC,D5;function o8(){if(D5)return GC;D5=1;var t=dm(),e=gR(),n=function r(a,l){if(!(this instanceof r))return new r(a,l);if(a!=="normal"&&a!=="break"&&a!=="continue"&&a!=="return"&&a!=="throw")throw new t('Assertion failed: `type` must be one of "normal", "break", "continue", "return", or "throw"');e.set(this,"[[Type]]",a),e.set(this,"[[Value]]",l)};return n.prototype.type=function(){return e.get(this,"[[Type]]")},n.prototype.value=function(){return e.get(this,"[[Value]]")},n.prototype["?"]=function(){var a=e.get(this,"[[Type]]"),l=e.get(this,"[[Value]]");if(a==="throw")throw l;return l},n.prototype["!"]=function(){var a=e.get(this,"[[Type]]");if(a!=="normal")throw new t('Assertion failed: Completion Record is not of type "normal"');return e.get(this,"[[Value]]")},GC=n,GC}var WC,L5;function Ufe(){if(L5)return WC;L5=1;var t=Lr(),e=Zx(),n=o8(),r=vR(),a=Xx(),l=Xa(),u=n2();return WC=function(m,_){if(!u(m))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");if(!l(m["[[Iterator]]"]))throw new t("Assertion failed: iteratorRecord.[[Iterator]] must be an Object");if(!a(_)&&!(_ instanceof n))throw new t("Assertion failed: completion is not a thunk representing a Completion Record, nor a Completion Record instance");var b=_ instanceof n?function(){return _["?"]()}:_,M=m["[[Iterator]]"],C;try{C=r(M,"return")}catch(z){throw b(),b=null,z}if(typeof C>"u")return b();var A;try{A=e(C,M,[])}catch(z){throw b(),b=null,z}var k=b();if(b=null,!l(A))throw new t("iterator .return must return an object");return k},WC}var qC,k5;function $fe(){if(k5)return qC;k5=1;var t=Lr(),e=n8(),n=i8(),r=n2();return qC=function(l){if(!r(l))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");var u=n(l),s=e(u);return s===!0?!1:u},qC}var XC,z5;function Vfe(){if(z5)return XC;z5=1;var t=Lr();return XC=function(n){if(n==null)throw new t(arguments.length>0&&arguments[1]||"Cannot call method on "+n);return n},XC}var ZC,O5;function jfe(){return O5||(O5=1,ZC=Vfe()),ZC}var YC,F5;function Hfe(){if(F5)return YC;F5=1;var t=o8();return YC=function(n){return new t("throw",n)},YC}var KC,N5;function Gfe(){return N5||(N5=1,KC=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),KC}var JC,B5;function Wfe(){if(B5)return JC;B5=1;var t=Dl(),e=t("Date.prototype.getDay"),n=function(s){try{return e(s),!0}catch{return!1}},r=t("Object.prototype.toString"),a="[object Date]",l=yR()();return JC=function(s){return typeof s!="object"||s===null?!1:l?n(s):r(s)===a},JC}var cb={exports:{}},QC,U5;function qfe(){if(U5)return QC;U5=1;var t=Dl(),e=yR()(),n=Sf(),r=Jy(),a;if(e){var l=t("RegExp.prototype.exec"),u={},s=function(){throw u},m={toString:s,valueOf:s};typeof Symbol.toPrimitive=="symbol"&&(m[Symbol.toPrimitive]=s),a=function(C){if(!C||typeof C!="object")return!1;var A=r(C,"lastIndex"),k=A&&n(A,"value");if(!k)return!1;try{l(C,m)}catch(z){return z===u}}}else{var _=t("Object.prototype.toString"),b="[object RegExp]";a=function(C){return!C||typeof C!="object"&&typeof C!="function"?!1:_(C)===b}}return QC=a,QC}var eT,$5;function Xfe(){if($5)return eT;$5=1;var t=Dl(),e=qfe(),n=t("RegExp.prototype.exec"),r=Lr();return eT=function(l){if(!e(l))throw new r("`regex` must be a RegExp");return function(s){return n(l,s)!==null}},eT}var V5;function Zfe(){if(V5)return cb.exports;V5=1;var t=Dl(),e=t("Object.prototype.toString"),n=e2()(),r=Xfe();if(n){var a=t("Symbol.prototype.toString"),l=r(/^Symbol\(.*\)$/),u=function(m){return typeof m.valueOf()!="symbol"?!1:l(a(m))};cb.exports=function(m){if(typeof m=="symbol")return!0;if(!m||typeof m!="object"||e(m)!=="[object Symbol]")return!1;try{return u(m)}catch{return!1}}}else cb.exports=function(m){return!1};return cb.exports}var tT,j5;function Yfe(){if(j5)return tT;j5=1;var t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",e=Gfe(),n=qU(),r=Wfe(),a=Zfe(),l=function(m,_){if(typeof m>"u"||m===null)throw new TypeError("Cannot call method on "+m);if(typeof _!="string"||_!=="number"&&_!=="string")throw new TypeError('hint must be "string" or "number"');var b=_==="string"?["toString","valueOf"]:["valueOf","toString"],M,C,A;for(A=0;A<b.length;++A)if(M=m[b[A]],n(M)&&(C=M.call(m),e(C)))return C;throw new TypeError("No default value")},u=function(m,_){var b=m[_];if(b!==null&&typeof b<"u"){if(!n(b))throw new TypeError(b+" returned for property "+String(_)+" of object "+m+" is not a function");return b}};return tT=function(m){if(e(m))return m;var _="default";arguments.length>1&&(arguments[1]===String?_="string":arguments[1]===Number&&(_="number"));var b;if(t&&(Symbol.toPrimitive?b=u(m,Symbol.toPrimitive):a(m)&&(b=Symbol.prototype.valueOf)),typeof b<"u"){var M=b.call(m,_);if(e(M))return M;throw new TypeError("unable to convert exotic object to primitive")}return _==="default"&&(r(m)||a(m))&&(_="string"),l(m,_==="default"?"number":_)},tT}var nT,H5;function Kfe(){if(H5)return nT;H5=1;var t=Yfe();return nT=function(n){return arguments.length>1?t(n,arguments[1]):t(n)},nT}var rT,G5;function Jfe(){if(G5)return rT;G5=1;var t=Ma(),e=t("%String%"),n=Lr();return rT=function(a){if(typeof a=="symbol")throw new n("Cannot convert a Symbol value to a string");return e(a)},rT}var iT,W5;function Qfe(){if(W5)return iT;W5=1;var t=Ma(),e=t("%String%"),n=Kfe(),r=Jfe();return iT=function(l){var u=n(l,e);return typeof u=="symbol"?u:r(u)},iT}var oT,q5;function epe(){if(q5)return oT;q5=1;var t=Lr(),e=Mfe(),n=JU(),r=Cfe(),a=Zx(),l=Bfe(),u=Xx(),s=Ufe(),m=$fe(),_=r8(),b=jfe(),M=Hfe(),C=Qfe();return oT=function(k,z,P){if(P!=="PROPERTY"&&P!=="ZERO")throw new t('Assertion failed: `keyCoercion` must be `"PROPERTY"` or `"ZERO"`');if(b(k),!u(z))throw new t("callbackfn must be callable");for(var O=[],j=l(k,"SYNC"),U=0;;){if(U>=n){var X=M(new t("k must be less than 2 ** 53 - 1"));s(j,X);return}var K=m(j);if(!K)return O;var se=_(K),J;try{J=a(z,void 0,[se,U])}catch(ue){s(j,M(ue));return}if(P==="PROPERTY")try{J=C(J)}catch(ue){s(j,M(ue));return}else{if(P!=="ZERO")throw new t("keyCoercion must be ~PROPERTY~ or ~ZERO~");e(J)&&(J=0)}r(O,J,se),U+=1}},oT}var sT,X5;function s8(){if(X5)return sT;X5=1;var t=gfe(),e=KU(),n=mR(),r=epe();return sT=function(l,u){var s=r(l,u,"PROPERTY"),m=e(null);return n(s,function(_){t(m,_["[[Key]]"],_["[[Elements]]"])}),m},sT}var aT,Z5;function a8(){if(Z5)return aT;Z5=1;var t=s8();return aT=function(){return Object.groupBy||t},aT}var lT,Y5;function tpe(){if(Y5)return lT;Y5=1;var t=$U(),e=a8();return lT=function(){var r=e();return t(Object,{groupBy:r},{groupBy:function(){return Object.groupBy!==r}}),r},lT}var cT,K5;function npe(){if(K5)return cT;K5=1;var t=$U(),e=WU(),n=s8(),r=a8(),a=r(),l=tpe(),u=e(a,Object);return t(u,{getPolyfill:r,implementation:n,shim:l}),cT=u,cT}var rpe=npe();const ipe=oS(rpe),Uw=[{label:"ATS",value:{map:"usa",search:"places"}},{label:"ATS",value:{map:"usa",search:"achievements"}},{label:"ETS2",value:{map:"europe",search:"places"}},{label:"ETS2",value:{map:"europe",search:"achievements"}}],uT=(t,e)=>Uw.find(r=>r.value.map===t&&r.value.search===e)??pr(Uw.find(r=>r.value.map)),ub=({selected:t,onSelect:e})=>ae.jsx(MB,{sx:{paddingBlock:0,minWidth:"fit-content"},variant:"plain",size:"sm",slotProps:{listbox:{placement:"bottom-start"}},value:t,onChange:(n,r)=>{n!=null&&e(pr(Uw.find(a=>a.value===r)))},renderValue:n=>{if(n)return ae.jsxs(Sa,{direction:"row",gap:1,sx:{alignItems:"center"},children:[ae.jsx(Ci,{level:"body-xs",fontWeight:"lg",children:n.value.map==="usa"?"ATS":"ETS2"}),ae.jsx(J5,{search:n.value.search})]})},children:Object.entries(ipe(Uw,({label:n})=>n)).map(([n,r])=>ae.jsxs(RS,{children:[ae.jsx(am,{children:ae.jsx(Ci,{level:"body-xs",fontWeight:"lg",children:n})}),r?.map(a=>ae.jsxs(Xb,{value:a.value,sx:{px:"1em",textTransform:"capitalize"},children:[ae.jsx(J5,{search:a.value.search}),a.value.search]},a.value.search))]},n))}),J5=({search:t})=>{switch(t){case"achievements":return ae.jsx(Ose,{});case"places":return ae.jsx(jse,{});default:throw new ah(t)}},iw={usa:{longitude:-108,latitude:39},europe:{longitude:12,latitude:51}},ope=t=>{const e=q.useRef(null);Il(()=>({onAdd:()=>pr(e.current),onRemove:()=>pr(e.current).remove()}),{position:"top-left"});const{current:n}=Nx(),[r,a]=q.useState(uT(localStorage.getItem("tm-map")==="europe"?"europe":"usa",ape(localStorage.getItem("tm-search")))),l=p_.useCallback(A=>{if(A==null||(a(A),localStorage.setItem("tm-map",A.value.map),localStorage.setItem("tm-search",A.value.search),!n||A.value.map===r.value.map))return;const{longitude:k,latitude:z}=iw[A.value.map];n.easeTo({zoom:4,center:[k,z]})},[n,r]);q.useEffect(()=>{if(!n)return;const A=()=>{const k=n.getCenter().lng,z=Q5(k,iw.usa.longitude),P=Q5(k,iw.europe.longitude);z<P&&r.value.map!=="usa"?(a(uT("usa",r.value.search)),localStorage.setItem("tm-map","usa")):P<z&&r.value.map!=="europe"&&(a(uT("europe",r.value.search)),localStorage.setItem("tm-map","europe"))};return n.on("moveend",A),()=>void n.off("moveend",A)},[n,r]);const u=p_.useCallback(A=>{n==null||A==null||(n.flyTo({curve:1,zoom:10.5,center:A.poi.geometry.coordinates}),n.once("moveend",k=>{const{lat:z,lng:P}=k.target.getCenter(),O=k.target.getZoom(),j=Number(k.target.getBearing().toFixed(1)),U=Math.round(k.target.getPitch());let X;U?X=`#${O}/${z.toFixed(3)}/${P.toFixed(3)}/${j}/${U}`:j?X=`#${O}/${z.toFixed(3)}/${P.toFixed(3)}/${j}`:X=`#${O}/${z.toFixed(3)}/${P.toFixed(3)}`,window.history.replaceState(window.history.state,"",X)}))},[n]),[s,m]=q.useState([]),_=A=>p_.useCallback((k,z={enableFitBounds:!0})=>{if(s.forEach(j=>j.remove()),A(k),n==null||k==null)return;const P=Fx(t.visibleStateDlcs),O=k.features.filter(j=>P.has(j.dlcGuard)).map(({coordinates:j})=>new ZS.Marker().setLngLat(j).addTo(n.getMap()));if(m(O),O.length&&z.enableFitBounds){const j=b6(O.map(K=>K.getLngLat().toArray())),U=[j[0],j[1]],X=[j[2],j[3]];n.fitBounds([U,X],{curve:1,padding:100,maxZoom:9})}},[n,s,A,m,t.visibleStateDlcs]),[b,M]=q.useState(null),C=_(M);return q.useEffect(()=>{C(b,{enableFitBounds:!1})},[b,t.visibleStateDlcs]),ae.jsx("div",{ref:e,className:"maplibregl-ctrl",style:{width:"calc(100svw - 64px)",pointerEvents:"none"},children:ae.jsx(Sa,{direction:"row",gap:1,sx:{pointerEvents:"auto",width:t.reserveRoomForSpecialEventButton?"calc(100% - 44px)":void 0},children:ae.jsx(spe,{selected:r.value,onMapSelect:l,onPlaceSelect:u,onAchievementSelect:C,visibleStates:t.visibleStates,visibleStateDlcs:t.visibleStateDlcs})})})},spe=({selected:t,onMapSelect:e,onPlaceSelect:n,onAchievementSelect:r,visibleStateDlcs:a})=>{switch(t.map){case"usa":switch(t.search){case"places":return ae.jsx(Oz,{selectDecorator:ae.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:n,visibleStateDlcs:a});case"achievements":return ae.jsx(Az,{selectDecorator:ae.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:r,visibleStateDlcs:a});default:throw new ah(t.search)}case"europe":switch(t.search){case"places":return ae.jsx(Oz,{selectDecorator:ae.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:n});case"achievements":return ae.jsx(Az,{selectDecorator:ae.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:r});default:throw new ah(t.search)}}};function ape(t){return t==="achievements"?t:"places"}function Q5(t,e){const n=Pw(t)/2,r=Pw(e)/2;return Math.abs(Math.sin(n)-Math.sin(r))}const lpe=t=>{const e=q.useRef(null);Il(()=>({onAdd:()=>pr(e.current),onRemove:()=>pr(e.current).remove()}));const n=q.useCallback(()=>{t.onToggle(!t.active)},[t.active]);return ae.jsx("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",style:{display:t.visible?"":"none"},children:ae.jsx(sd,{slots:{root:sd},sx:{minWidth:0,minHeight:0,borderRadius:0,backgroundColor:t.active?"var(--joy-palette-primary-softHoverBg) !important":void 0},variant:t.active?"soft":"plain",title:"Browse Street View images",onClick:n,children:ae.jsx(Hse,{})})})},hT=(t,e)=>{const n=Math.pow(10,e);return Math.round(t*n)/n},cpe=()=>{const t=q.useRef(null),[e,n]=q.useState(!1),[r,a]=q.useState(!1),[l,u]=q.useState(window.location.origin),s=Nx();return Il(()=>({onAdd:()=>pr(t.current),onRemove:()=>pr(t.current).remove()})),q.useEffect(()=>{const m=s.current;if(!m||!e)return;const _=()=>{const C=m.getCenter(),A=m.getBearing(),k=m.getPitch(),z=A||k?[A,k]:[],P=m.getZoom(),O=b?"?"+new URLSearchParams({mlat:String(hT(b.getLngLat().lat,2)),mlon:String(hT(b.getLngLat().lng,2))}).toString():"",j="#"+[P,C.lat,C.lng,...z].map(U=>hT(U,2)).join("/");u(window.location.origin+O+j)};let b,M;if(r){b=new ZS.Marker,b.setLngLat(m.getCenter()).setDraggable(!0).addTo(m.getMap());let C=!0;M=()=>C&&b.setLngLat(m.getCenter()),b.on("dragend",()=>{C=!1,m.easeTo({center:b?.getLngLat()}),m.once("moveend",()=>C=!0)})}return _(),m.on("moveend",_),M&&m.on("move",M),()=>{m.off("moveend",_),M&&m.off("move",M),b?.remove()}},[s,e,r]),ae.jsxs("div",{ref:t,children:[ae.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:ae.jsx(sd,{sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Share",onClick:()=>n(!e),children:ae.jsx(Bse,{})})}),ae.jsx(xB,{open:e,anchor:"right",onClose:()=>n(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",right:e?48:0}}},children:ae.jsxs(EB,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,overflow:"auto"},children:[ae.jsx(mB,{children:"Share"}),ae.jsx(SB,{}),ae.jsx(Ax,{}),ae.jsxs(pB,{sx:{gap:2,overflow:"hidden",flexGrow:1,justifyContent:"center"},children:[ae.jsx(Ci,{children:"Share a link to this map"}),ae.jsx(dY,{readOnly:!0,sx:{"--Input-decoratorChildHeight":"36px"},onFocus:m=>m.target.select(),value:l,endDecorator:ae.jsx(uB,{sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:()=>void navigator.clipboard.writeText(l).catch(()=>alert("Could not copy to clipboard ")),children:"Copy"})}),ae.jsx(ky,{label:"Include marker",checked:r,onChange:m=>a(m.target.checked)})]})]})})]})},_R={halloween:{emoji:"",mapName:"Brackenreach",url:"/brackenreach",centerLngLat:[-120.6266,18.5926],boundsDelta:.5,minZoom:10,mapStyle:dse},christmas:{emoji:"",mapName:"Winterland",url:"/winterland",centerLngLat:[-123.075,13.5243],boundsDelta:1,minZoom:8,mapStyle:fse}},upe=t=>{const{specialEvent:e}=t;if(e==null)return null;const n=q.useRef(null);Il(()=>({onAdd:()=>pr(n.current),onRemove:()=>pr(n.current).remove(),getDefaultPosition:()=>"top-left"}));const r=_R[e];return ae.jsx("div",{ref:n,style:{position:"absolute",top:0,right:0},children:ae.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:ae.jsx(bB,{component:"button",underline:"none",title:`Switch to ${r.mapName} Map`,justifyContent:"center",onClick:()=>window.location.href=r.url,sx:{fontSize:"1.75em"},children:ae.jsx(zS,{children:r.emoji})})})})};function l8(t){return new Set([...t].map(hpe).concat(rs.CA))}function hpe(t){switch(t){case ms.Arizona:return rs.AZ;case ms.Arkansas:return rs.AR;case ms.Colorado:return rs.CO;case ms.Idaho:return rs.ID;case ms.Iowa:return rs.IA;case ms.Kansas:return rs.KS;case ms.Louisiana:return rs.LA;case ms.Missouri:return rs.MO;case ms.Montana:return rs.MT;case ms.Nebraska:return rs.NE;case ms.Nevada:return rs.NV;case ms.NewMexico:return rs.NM;case ms.Oklahoma:return rs.OK;case ms.Oregon:return rs.OR;case ms.Texas:return rs.TX;case ms.Utah:return rs.UT;case ms.Washington:return rs.WA;case ms.Wyoming:return rs.WY;default:throw new ah(t)}}const xR="175",dpe=0,eF=1,fpe=2,c8=1,ppe=2,of=3,tm=0,El=1,af=2,Gp=0,Ey=1,tF=2,nF=3,rF=4,mpe=5,_g=100,gpe=101,vpe=102,ype=103,_pe=104,xpe=200,bpe=201,wpe=202,Spe=203,PP=204,AP=205,Mpe=206,Epe=207,Cpe=208,Tpe=209,Ppe=210,Ape=211,Ipe=212,Rpe=213,Dpe=214,IP=0,RP=1,DP=2,Vy=3,LP=4,kP=5,zP=6,OP=7,u8=0,Lpe=1,kpe=2,Wp=0,h8=1,zpe=2,Ope=3,Fpe=4,Npe=5,Bpe=6,Upe=7,d8=300,jy=301,Hy=302,FP=303,NP=304,r2=306,BP=1e3,Mg=1001,UP=1002,oh=1003,$pe=1004,hb=1005,hc=1006,dT=1007,Vp=1008,vf=1009,f8=1010,p8=1011,sx=1012,bR=1013,kg=1014,lf=1015,Yx=1016,wR=1017,SR=1018,ax=1020,m8=35902,g8=1021,v8=1022,rh=1023,y8=1024,_8=1025,lx=1026,cx=1027,x8=1028,MR=1029,b8=1030,ER=1031,CR=1033,ow=33776,sw=33777,aw=33778,lw=33779,$P=35840,VP=35841,jP=35842,HP=35843,GP=36196,WP=37492,qP=37496,XP=37808,ZP=37809,YP=37810,KP=37811,JP=37812,QP=37813,eA=37814,tA=37815,nA=37816,rA=37817,iA=37818,oA=37819,sA=37820,aA=37821,cw=36492,lA=36494,cA=36495,w8=36283,uA=36284,hA=36285,dA=36286,Vpe=3200,jpe=3201,Hpe=0,Gpe=1,Bp="",Kc="srgb",zg="srgb-linear",$w="linear",Fi="srgb",Lv=7680,iF=519,Wpe=512,qpe=513,Xpe=514,S8=515,Zpe=516,Ype=517,Kpe=518,Jpe=519,oF=35044,sF="300 es",cf=2e3,Vw=2001;class Qy{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){const r=this._listeners;if(r===void 0)return;const a=r[e];if(a!==void 0){const l=a.indexOf(n);l!==-1&&a.splice(l,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const r=n[e.type];if(r!==void 0){e.target=this;const a=r.slice(0);for(let l=0,u=a.length;l<u;l++)a[l].call(this,e);e.target=null}}}const ya=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let aF=1234567;const P_=Math.PI/180,ux=180/Math.PI;function e0(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ya[t&255]+ya[t>>8&255]+ya[t>>16&255]+ya[t>>24&255]+"-"+ya[e&255]+ya[e>>8&255]+"-"+ya[e>>16&15|64]+ya[e>>24&255]+"-"+ya[n&63|128]+ya[n>>8&255]+"-"+ya[n>>16&255]+ya[n>>24&255]+ya[r&255]+ya[r>>8&255]+ya[r>>16&255]+ya[r>>24&255]).toLowerCase()}function Xr(t,e,n){return Math.max(e,Math.min(n,t))}function TR(t,e){return(t%e+e)%e}function Qpe(t,e,n,r,a){return r+(t-e)*(a-r)/(n-e)}function eme(t,e,n){return t!==e?(n-t)/(e-t):0}function A_(t,e,n){return(1-n)*t+n*e}function tme(t,e,n,r){return A_(t,e,1-Math.exp(-n*r))}function nme(t,e=1){return e-Math.abs(TR(t,e*2)-e)}function rme(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function ime(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function ome(t,e){return t+Math.floor(Math.random()*(e-t+1))}function sme(t,e){return t+Math.random()*(e-t)}function ame(t){return t*(.5-Math.random())}function lme(t){t!==void 0&&(aF=t);let e=aF+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function cme(t){return t*P_}function ume(t){return t*ux}function hme(t){return(t&t-1)===0&&t!==0}function dme(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function fme(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function pme(t,e,n,r,a){const l=Math.cos,u=Math.sin,s=l(n/2),m=u(n/2),_=l((e+r)/2),b=u((e+r)/2),M=l((e-r)/2),C=u((e-r)/2),A=l((r-e)/2),k=u((r-e)/2);switch(a){case"XYX":t.set(s*b,m*M,m*C,s*_);break;case"YZY":t.set(m*C,s*b,m*M,s*_);break;case"ZXZ":t.set(m*M,m*C,s*b,s*_);break;case"XZX":t.set(s*b,m*k,m*A,s*_);break;case"YXY":t.set(m*A,s*b,m*k,s*_);break;case"ZYZ":t.set(m*k,m*A,s*b,s*_);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}function ey(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Va(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const jr={DEG2RAD:P_,RAD2DEG:ux,generateUUID:e0,clamp:Xr,euclideanModulo:TR,mapLinear:Qpe,inverseLerp:eme,lerp:A_,damp:tme,pingpong:nme,smoothstep:rme,smootherstep:ime,randInt:ome,randFloat:sme,randFloatSpread:ame,seededRandom:lme,degToRad:cme,radToDeg:ume,isPowerOfTwo:hme,ceilPowerOfTwo:dme,floorPowerOfTwo:fme,setQuaternionFromProperEuler:pme,normalize:Va,denormalize:ey};class mi{constructor(e=0,n=0){mi.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,a=e.elements;return this.x=a[0]*n+a[3]*r+a[6],this.y=a[1]*n+a[4]*r+a[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Xr(this.x,e.x,n.x),this.y=Xr(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Xr(this.x,e,n),this.y=Xr(this.y,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Xr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Xr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),a=Math.sin(n),l=this.x-e.x,u=this.y-e.y;return this.x=l*r-u*a+e.x,this.y=l*a+u*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class zr{constructor(e,n,r,a,l,u,s,m,_){zr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,a,l,u,s,m,_)}set(e,n,r,a,l,u,s,m,_){const b=this.elements;return b[0]=e,b[1]=a,b[2]=s,b[3]=n,b[4]=l,b[5]=m,b[6]=r,b[7]=u,b[8]=_,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,a=n.elements,l=this.elements,u=r[0],s=r[3],m=r[6],_=r[1],b=r[4],M=r[7],C=r[2],A=r[5],k=r[8],z=a[0],P=a[3],O=a[6],j=a[1],U=a[4],X=a[7],K=a[2],se=a[5],J=a[8];return l[0]=u*z+s*j+m*K,l[3]=u*P+s*U+m*se,l[6]=u*O+s*X+m*J,l[1]=_*z+b*j+M*K,l[4]=_*P+b*U+M*se,l[7]=_*O+b*X+M*J,l[2]=C*z+A*j+k*K,l[5]=C*P+A*U+k*se,l[8]=C*O+A*X+k*J,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],a=e[2],l=e[3],u=e[4],s=e[5],m=e[6],_=e[7],b=e[8];return n*u*b-n*s*_-r*l*b+r*s*m+a*l*_-a*u*m}invert(){const e=this.elements,n=e[0],r=e[1],a=e[2],l=e[3],u=e[4],s=e[5],m=e[6],_=e[7],b=e[8],M=b*u-s*_,C=s*m-b*l,A=_*l-u*m,k=n*M+r*C+a*A;if(k===0)return this.set(0,0,0,0,0,0,0,0,0);const z=1/k;return e[0]=M*z,e[1]=(a*_-b*r)*z,e[2]=(s*r-a*u)*z,e[3]=C*z,e[4]=(b*n-a*m)*z,e[5]=(a*l-s*n)*z,e[6]=A*z,e[7]=(r*m-_*n)*z,e[8]=(u*n-r*l)*z,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,a,l,u,s){const m=Math.cos(l),_=Math.sin(l);return this.set(r*m,r*_,-r*(m*u+_*s)+u+e,-a*_,a*m,-a*(-_*u+m*s)+s+n,0,0,1),this}scale(e,n){return this.premultiply(fT.makeScale(e,n)),this}rotate(e){return this.premultiply(fT.makeRotation(-e)),this}translate(e,n){return this.premultiply(fT.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let a=0;a<9;a++)if(n[a]!==r[a])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const fT=new zr;function M8(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function jw(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function mme(){const t=jw("canvas");return t.style.display="block",t}const lF={};function uw(t){t in lF||(lF[t]=!0,console.warn(t))}function gme(t,e,n){return new Promise(function(r,a){function l(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:a();break;case t.TIMEOUT_EXPIRED:setTimeout(l,n);break;default:r()}}setTimeout(l,n)})}function vme(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function yme(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const cF=new zr().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),uF=new zr().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function _me(){const t={enabled:!0,workingColorSpace:zg,spaces:{},convert:function(a,l,u){return this.enabled===!1||l===u||!l||!u||(this.spaces[l].transfer===Fi&&(a.r=uf(a.r),a.g=uf(a.g),a.b=uf(a.b)),this.spaces[l].primaries!==this.spaces[u].primaries&&(a.applyMatrix3(this.spaces[l].toXYZ),a.applyMatrix3(this.spaces[u].fromXYZ)),this.spaces[u].transfer===Fi&&(a.r=Cy(a.r),a.g=Cy(a.g),a.b=Cy(a.b))),a},fromWorkingColorSpace:function(a,l){return this.convert(a,this.workingColorSpace,l)},toWorkingColorSpace:function(a,l){return this.convert(a,l,this.workingColorSpace)},getPrimaries:function(a){return this.spaces[a].primaries},getTransfer:function(a){return a===Bp?$w:this.spaces[a].transfer},getLuminanceCoefficients:function(a,l=this.workingColorSpace){return a.fromArray(this.spaces[l].luminanceCoefficients)},define:function(a){Object.assign(this.spaces,a)},_getMatrix:function(a,l,u){return a.copy(this.spaces[l].toXYZ).multiply(this.spaces[u].fromXYZ)},_getDrawingBufferColorSpace:function(a){return this.spaces[a].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(a=this.workingColorSpace){return this.spaces[a].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return t.define({[zg]:{primaries:e,whitePoint:r,transfer:$w,toXYZ:cF,fromXYZ:uF,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Kc},outputColorSpaceConfig:{drawingBufferColorSpace:Kc}},[Kc]:{primaries:e,whitePoint:r,transfer:Fi,toXYZ:cF,fromXYZ:uF,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Kc}}}),t}const oi=_me();function uf(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Cy(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let kv;class xme{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{kv===void 0&&(kv=jw("canvas")),kv.width=e.width,kv.height=e.height;const a=kv.getContext("2d");e instanceof ImageData?a.putImageData(e,0,0):a.drawImage(e,0,0,e.width,e.height),r=kv}return r.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=jw("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const a=r.getImageData(0,0,e.width,e.height),l=a.data;for(let u=0;u<l.length;u++)l[u]=uf(l[u]/255)*255;return r.putImageData(a,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(uf(n[r]/255)*255):n[r]=uf(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let bme=0;class PR{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:bme++}),this.uuid=e0(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},a=this.data;if(a!==null){let l;if(Array.isArray(a)){l=[];for(let u=0,s=a.length;u<s;u++)a[u].isDataTexture?l.push(pT(a[u].image)):l.push(pT(a[u]))}else l=pT(a);r.url=l}return n||(e.images[this.uuid]=r),r}}function pT(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?xme.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let wme=0;class Js extends Qy{constructor(e=Js.DEFAULT_IMAGE,n=Js.DEFAULT_MAPPING,r=Mg,a=Mg,l=hc,u=Vp,s=rh,m=vf,_=Js.DEFAULT_ANISOTROPY,b=Bp){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wme++}),this.uuid=e0(),this.name="",this.source=new PR(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=a,this.magFilter=l,this.minFilter=u,this.anisotropy=_,this.format=s,this.internalFormat=null,this.type=m,this.offset=new mi(0,0),this.repeat=new mi(1,1),this.center=new mi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=b,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==d8)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case BP:e.x=e.x-Math.floor(e.x);break;case Mg:e.x=e.x<0?0:1;break;case UP:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case BP:e.y=e.y-Math.floor(e.y);break;case Mg:e.y=e.y<0?0:1;break;case UP:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Js.DEFAULT_IMAGE=null;Js.DEFAULT_MAPPING=d8;Js.DEFAULT_ANISOTROPY=1;class $o{constructor(e=0,n=0,r=0,a=1){$o.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=a}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,a){return this.x=e,this.y=n,this.z=r,this.w=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,a=this.z,l=this.w,u=e.elements;return this.x=u[0]*n+u[4]*r+u[8]*a+u[12]*l,this.y=u[1]*n+u[5]*r+u[9]*a+u[13]*l,this.z=u[2]*n+u[6]*r+u[10]*a+u[14]*l,this.w=u[3]*n+u[7]*r+u[11]*a+u[15]*l,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,a,l;const m=e.elements,_=m[0],b=m[4],M=m[8],C=m[1],A=m[5],k=m[9],z=m[2],P=m[6],O=m[10];if(Math.abs(b-C)<.01&&Math.abs(M-z)<.01&&Math.abs(k-P)<.01){if(Math.abs(b+C)<.1&&Math.abs(M+z)<.1&&Math.abs(k+P)<.1&&Math.abs(_+A+O-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const U=(_+1)/2,X=(A+1)/2,K=(O+1)/2,se=(b+C)/4,J=(M+z)/4,ue=(k+P)/4;return U>X&&U>K?U<.01?(r=0,a=.707106781,l=.707106781):(r=Math.sqrt(U),a=se/r,l=J/r):X>K?X<.01?(r=.707106781,a=0,l=.707106781):(a=Math.sqrt(X),r=se/a,l=ue/a):K<.01?(r=.707106781,a=.707106781,l=0):(l=Math.sqrt(K),r=J/l,a=ue/l),this.set(r,a,l,n),this}let j=Math.sqrt((P-k)*(P-k)+(M-z)*(M-z)+(C-b)*(C-b));return Math.abs(j)<.001&&(j=1),this.x=(P-k)/j,this.y=(M-z)/j,this.z=(C-b)/j,this.w=Math.acos((_+A+O-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Xr(this.x,e.x,n.x),this.y=Xr(this.y,e.y,n.y),this.z=Xr(this.z,e.z,n.z),this.w=Xr(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Xr(this.x,e,n),this.y=Xr(this.y,e,n),this.z=Xr(this.z,e,n),this.w=Xr(this.w,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Xr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Sme extends Qy{constructor(e=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new $o(0,0,e,n),this.scissorTest=!1,this.viewport=new $o(0,0,e,n);const a={width:e,height:n,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:hc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const l=new Js(a,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);l.flipY=!1,l.generateMipmaps=r.generateMipmaps,l.internalFormat=r.internalFormat,this.textures=[];const u=r.count;for(let s=0;s<u;s++)this.textures[s]=l.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let a=0,l=this.textures.length;a<l;a++)this.textures[a].image.width=e,this.textures[a].image.height=n,this.textures[a].image.depth=r;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const a=Object.assign({},e.textures[n].image);this.textures[n].source=new PR(a)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class nm extends Sme{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class E8 extends Js{constructor(e=null,n=1,r=1,a=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:a},this.magFilter=oh,this.minFilter=oh,this.wrapR=Mg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Mme extends Js{constructor(e=null,n=1,r=1,a=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:a},this.magFilter=oh,this.minFilter=oh,this.wrapR=Mg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class pm{constructor(e=0,n=0,r=0,a=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=a}static slerpFlat(e,n,r,a,l,u,s){let m=r[a+0],_=r[a+1],b=r[a+2],M=r[a+3];const C=l[u+0],A=l[u+1],k=l[u+2],z=l[u+3];if(s===0){e[n+0]=m,e[n+1]=_,e[n+2]=b,e[n+3]=M;return}if(s===1){e[n+0]=C,e[n+1]=A,e[n+2]=k,e[n+3]=z;return}if(M!==z||m!==C||_!==A||b!==k){let P=1-s;const O=m*C+_*A+b*k+M*z,j=O>=0?1:-1,U=1-O*O;if(U>Number.EPSILON){const K=Math.sqrt(U),se=Math.atan2(K,O*j);P=Math.sin(P*se)/K,s=Math.sin(s*se)/K}const X=s*j;if(m=m*P+C*X,_=_*P+A*X,b=b*P+k*X,M=M*P+z*X,P===1-s){const K=1/Math.sqrt(m*m+_*_+b*b+M*M);m*=K,_*=K,b*=K,M*=K}}e[n]=m,e[n+1]=_,e[n+2]=b,e[n+3]=M}static multiplyQuaternionsFlat(e,n,r,a,l,u){const s=r[a],m=r[a+1],_=r[a+2],b=r[a+3],M=l[u],C=l[u+1],A=l[u+2],k=l[u+3];return e[n]=s*k+b*M+m*A-_*C,e[n+1]=m*k+b*C+_*M-s*A,e[n+2]=_*k+b*A+s*C-m*M,e[n+3]=b*k-s*M-m*C-_*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,a){return this._x=e,this._y=n,this._z=r,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,a=e._y,l=e._z,u=e._order,s=Math.cos,m=Math.sin,_=s(r/2),b=s(a/2),M=s(l/2),C=m(r/2),A=m(a/2),k=m(l/2);switch(u){case"XYZ":this._x=C*b*M+_*A*k,this._y=_*A*M-C*b*k,this._z=_*b*k+C*A*M,this._w=_*b*M-C*A*k;break;case"YXZ":this._x=C*b*M+_*A*k,this._y=_*A*M-C*b*k,this._z=_*b*k-C*A*M,this._w=_*b*M+C*A*k;break;case"ZXY":this._x=C*b*M-_*A*k,this._y=_*A*M+C*b*k,this._z=_*b*k+C*A*M,this._w=_*b*M-C*A*k;break;case"ZYX":this._x=C*b*M-_*A*k,this._y=_*A*M+C*b*k,this._z=_*b*k-C*A*M,this._w=_*b*M+C*A*k;break;case"YZX":this._x=C*b*M+_*A*k,this._y=_*A*M+C*b*k,this._z=_*b*k-C*A*M,this._w=_*b*M-C*A*k;break;case"XZY":this._x=C*b*M-_*A*k,this._y=_*A*M-C*b*k,this._z=_*b*k+C*A*M,this._w=_*b*M+C*A*k;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,a=Math.sin(r);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],a=n[4],l=n[8],u=n[1],s=n[5],m=n[9],_=n[2],b=n[6],M=n[10],C=r+s+M;if(C>0){const A=.5/Math.sqrt(C+1);this._w=.25/A,this._x=(b-m)*A,this._y=(l-_)*A,this._z=(u-a)*A}else if(r>s&&r>M){const A=2*Math.sqrt(1+r-s-M);this._w=(b-m)/A,this._x=.25*A,this._y=(a+u)/A,this._z=(l+_)/A}else if(s>M){const A=2*Math.sqrt(1+s-r-M);this._w=(l-_)/A,this._x=(a+u)/A,this._y=.25*A,this._z=(m+b)/A}else{const A=2*Math.sqrt(1+M-r-s);this._w=(u-a)/A,this._x=(l+_)/A,this._y=(m+b)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xr(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const a=Math.min(1,n/r);return this.slerp(e,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,a=e._y,l=e._z,u=e._w,s=n._x,m=n._y,_=n._z,b=n._w;return this._x=r*b+u*s+a*_-l*m,this._y=a*b+u*m+l*s-r*_,this._z=l*b+u*_+r*m-a*s,this._w=u*b-r*s-a*m-l*_,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,a=this._y,l=this._z,u=this._w;let s=u*e._w+r*e._x+a*e._y+l*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=u,this._x=r,this._y=a,this._z=l,this;const m=1-s*s;if(m<=Number.EPSILON){const A=1-n;return this._w=A*u+n*this._w,this._x=A*r+n*this._x,this._y=A*a+n*this._y,this._z=A*l+n*this._z,this.normalize(),this}const _=Math.sqrt(m),b=Math.atan2(_,s),M=Math.sin((1-n)*b)/_,C=Math.sin(n*b)/_;return this._w=u*M+this._w*C,this._x=r*M+this._x*C,this._y=a*M+this._y*C,this._z=l*M+this._z*C,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),a=Math.sqrt(1-r),l=Math.sqrt(r);return this.set(a*Math.sin(e),a*Math.cos(e),l*Math.sin(n),l*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class At{constructor(e=0,n=0,r=0){At.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(hF.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(hF.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,a=this.z,l=e.elements;return this.x=l[0]*n+l[3]*r+l[6]*a,this.y=l[1]*n+l[4]*r+l[7]*a,this.z=l[2]*n+l[5]*r+l[8]*a,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,a=this.z,l=e.elements,u=1/(l[3]*n+l[7]*r+l[11]*a+l[15]);return this.x=(l[0]*n+l[4]*r+l[8]*a+l[12])*u,this.y=(l[1]*n+l[5]*r+l[9]*a+l[13])*u,this.z=(l[2]*n+l[6]*r+l[10]*a+l[14])*u,this}applyQuaternion(e){const n=this.x,r=this.y,a=this.z,l=e.x,u=e.y,s=e.z,m=e.w,_=2*(u*a-s*r),b=2*(s*n-l*a),M=2*(l*r-u*n);return this.x=n+m*_+u*M-s*b,this.y=r+m*b+s*_-l*M,this.z=a+m*M+l*b-u*_,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,a=this.z,l=e.elements;return this.x=l[0]*n+l[4]*r+l[8]*a,this.y=l[1]*n+l[5]*r+l[9]*a,this.z=l[2]*n+l[6]*r+l[10]*a,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Xr(this.x,e.x,n.x),this.y=Xr(this.y,e.y,n.y),this.z=Xr(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Xr(this.x,e,n),this.y=Xr(this.y,e,n),this.z=Xr(this.z,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Xr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,a=e.y,l=e.z,u=n.x,s=n.y,m=n.z;return this.x=a*m-l*s,this.y=l*u-r*m,this.z=r*s-a*u,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return mT.copy(this).projectOnVector(e),this.sub(mT)}reflect(e){return this.sub(mT.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Xr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,a=this.z-e.z;return n*n+r*r+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const a=Math.sin(n)*e;return this.x=a*Math.sin(r),this.y=Math.cos(n)*e,this.z=a*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),a=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=a,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(e),this.y=n,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const mT=new At,hF=new pm;class t0{constructor(e=new At(1/0,1/0,1/0),n=new At(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(Yu.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(Yu.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=Yu.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const l=r.getAttribute("position");if(n===!0&&l!==void 0&&e.isInstancedMesh!==!0)for(let u=0,s=l.count;u<s;u++)e.isMesh===!0?e.getVertexPosition(u,Yu):Yu.fromBufferAttribute(l,u),Yu.applyMatrix4(e.matrixWorld),this.expandByPoint(Yu);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),db.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),db.copy(r.boundingBox)),db.applyMatrix4(e.matrixWorld),this.union(db)}const a=e.children;for(let l=0,u=a.length;l<u;l++)this.expandByObject(a[l],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Yu),Yu.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(q0),fb.subVectors(this.max,q0),zv.subVectors(e.a,q0),Ov.subVectors(e.b,q0),Fv.subVectors(e.c,q0),Pp.subVectors(Ov,zv),Ap.subVectors(Fv,Ov),lg.subVectors(zv,Fv);let n=[0,-Pp.z,Pp.y,0,-Ap.z,Ap.y,0,-lg.z,lg.y,Pp.z,0,-Pp.x,Ap.z,0,-Ap.x,lg.z,0,-lg.x,-Pp.y,Pp.x,0,-Ap.y,Ap.x,0,-lg.y,lg.x,0];return!gT(n,zv,Ov,Fv,fb)||(n=[1,0,0,0,1,0,0,0,1],!gT(n,zv,Ov,Fv,fb))?!1:(pb.crossVectors(Pp,Ap),n=[pb.x,pb.y,pb.z],gT(n,zv,Ov,Fv,fb))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Yu).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Yu).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Jd[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Jd[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Jd[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Jd[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Jd[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Jd[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Jd[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Jd[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Jd),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Jd=[new At,new At,new At,new At,new At,new At,new At,new At],Yu=new At,db=new t0,zv=new At,Ov=new At,Fv=new At,Pp=new At,Ap=new At,lg=new At,q0=new At,fb=new At,pb=new At,cg=new At;function gT(t,e,n,r,a){for(let l=0,u=t.length-3;l<=u;l+=3){cg.fromArray(t,l);const s=a.x*Math.abs(cg.x)+a.y*Math.abs(cg.y)+a.z*Math.abs(cg.z),m=e.dot(cg),_=n.dot(cg),b=r.dot(cg);if(Math.max(-Math.max(m,_,b),Math.min(m,_,b))>s)return!1}return!0}const Eme=new t0,X0=new At,vT=new At;class i2{constructor(e=new At,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):Eme.setFromPoints(e).getCenter(r);let a=0;for(let l=0,u=e.length;l<u;l++)a=Math.max(a,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(a),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;X0.subVectors(e,this.center);const n=X0.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),a=(r-this.radius)*.5;this.center.addScaledVector(X0,a/r),this.radius+=a}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(vT.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(X0.copy(e.center).add(vT)),this.expandByPoint(X0.copy(e.center).sub(vT))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Qd=new At,yT=new At,mb=new At,Ip=new At,_T=new At,gb=new At,xT=new At;class AR{constructor(e=new At,n=new At(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Qd)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Qd.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Qd.copy(this.origin).addScaledVector(this.direction,n),Qd.distanceToSquared(e))}distanceSqToSegment(e,n,r,a){yT.copy(e).add(n).multiplyScalar(.5),mb.copy(n).sub(e).normalize(),Ip.copy(this.origin).sub(yT);const l=e.distanceTo(n)*.5,u=-this.direction.dot(mb),s=Ip.dot(this.direction),m=-Ip.dot(mb),_=Ip.lengthSq(),b=Math.abs(1-u*u);let M,C,A,k;if(b>0)if(M=u*m-s,C=u*s-m,k=l*b,M>=0)if(C>=-k)if(C<=k){const z=1/b;M*=z,C*=z,A=M*(M+u*C+2*s)+C*(u*M+C+2*m)+_}else C=l,M=Math.max(0,-(u*C+s)),A=-M*M+C*(C+2*m)+_;else C=-l,M=Math.max(0,-(u*C+s)),A=-M*M+C*(C+2*m)+_;else C<=-k?(M=Math.max(0,-(-u*l+s)),C=M>0?-l:Math.min(Math.max(-l,-m),l),A=-M*M+C*(C+2*m)+_):C<=k?(M=0,C=Math.min(Math.max(-l,-m),l),A=C*(C+2*m)+_):(M=Math.max(0,-(u*l+s)),C=M>0?l:Math.min(Math.max(-l,-m),l),A=-M*M+C*(C+2*m)+_);else C=u>0?-l:l,M=Math.max(0,-(u*C+s)),A=-M*M+C*(C+2*m)+_;return r&&r.copy(this.origin).addScaledVector(this.direction,M),a&&a.copy(yT).addScaledVector(mb,C),A}intersectSphere(e,n){Qd.subVectors(e.center,this.origin);const r=Qd.dot(this.direction),a=Qd.dot(Qd)-r*r,l=e.radius*e.radius;if(a>l)return null;const u=Math.sqrt(l-a),s=r-u,m=r+u;return m<0?null:s<0?this.at(m,n):this.at(s,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,a,l,u,s,m;const _=1/this.direction.x,b=1/this.direction.y,M=1/this.direction.z,C=this.origin;return _>=0?(r=(e.min.x-C.x)*_,a=(e.max.x-C.x)*_):(r=(e.max.x-C.x)*_,a=(e.min.x-C.x)*_),b>=0?(l=(e.min.y-C.y)*b,u=(e.max.y-C.y)*b):(l=(e.max.y-C.y)*b,u=(e.min.y-C.y)*b),r>u||l>a||((l>r||isNaN(r))&&(r=l),(u<a||isNaN(a))&&(a=u),M>=0?(s=(e.min.z-C.z)*M,m=(e.max.z-C.z)*M):(s=(e.max.z-C.z)*M,m=(e.min.z-C.z)*M),r>m||s>a)||((s>r||r!==r)&&(r=s),(m<a||a!==a)&&(a=m),a<0)?null:this.at(r>=0?r:a,n)}intersectsBox(e){return this.intersectBox(e,Qd)!==null}intersectTriangle(e,n,r,a,l){_T.subVectors(n,e),gb.subVectors(r,e),xT.crossVectors(_T,gb);let u=this.direction.dot(xT),s;if(u>0){if(a)return null;s=1}else if(u<0)s=-1,u=-u;else return null;Ip.subVectors(this.origin,e);const m=s*this.direction.dot(gb.crossVectors(Ip,gb));if(m<0)return null;const _=s*this.direction.dot(_T.cross(Ip));if(_<0||m+_>u)return null;const b=-s*Ip.dot(xT);return b<0?null:this.at(b/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ki{constructor(e,n,r,a,l,u,s,m,_,b,M,C,A,k,z,P){ki.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,a,l,u,s,m,_,b,M,C,A,k,z,P)}set(e,n,r,a,l,u,s,m,_,b,M,C,A,k,z,P){const O=this.elements;return O[0]=e,O[4]=n,O[8]=r,O[12]=a,O[1]=l,O[5]=u,O[9]=s,O[13]=m,O[2]=_,O[6]=b,O[10]=M,O[14]=C,O[3]=A,O[7]=k,O[11]=z,O[15]=P,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ki().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,a=1/Nv.setFromMatrixColumn(e,0).length(),l=1/Nv.setFromMatrixColumn(e,1).length(),u=1/Nv.setFromMatrixColumn(e,2).length();return n[0]=r[0]*a,n[1]=r[1]*a,n[2]=r[2]*a,n[3]=0,n[4]=r[4]*l,n[5]=r[5]*l,n[6]=r[6]*l,n[7]=0,n[8]=r[8]*u,n[9]=r[9]*u,n[10]=r[10]*u,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,a=e.y,l=e.z,u=Math.cos(r),s=Math.sin(r),m=Math.cos(a),_=Math.sin(a),b=Math.cos(l),M=Math.sin(l);if(e.order==="XYZ"){const C=u*b,A=u*M,k=s*b,z=s*M;n[0]=m*b,n[4]=-m*M,n[8]=_,n[1]=A+k*_,n[5]=C-z*_,n[9]=-s*m,n[2]=z-C*_,n[6]=k+A*_,n[10]=u*m}else if(e.order==="YXZ"){const C=m*b,A=m*M,k=_*b,z=_*M;n[0]=C+z*s,n[4]=k*s-A,n[8]=u*_,n[1]=u*M,n[5]=u*b,n[9]=-s,n[2]=A*s-k,n[6]=z+C*s,n[10]=u*m}else if(e.order==="ZXY"){const C=m*b,A=m*M,k=_*b,z=_*M;n[0]=C-z*s,n[4]=-u*M,n[8]=k+A*s,n[1]=A+k*s,n[5]=u*b,n[9]=z-C*s,n[2]=-u*_,n[6]=s,n[10]=u*m}else if(e.order==="ZYX"){const C=u*b,A=u*M,k=s*b,z=s*M;n[0]=m*b,n[4]=k*_-A,n[8]=C*_+z,n[1]=m*M,n[5]=z*_+C,n[9]=A*_-k,n[2]=-_,n[6]=s*m,n[10]=u*m}else if(e.order==="YZX"){const C=u*m,A=u*_,k=s*m,z=s*_;n[0]=m*b,n[4]=z-C*M,n[8]=k*M+A,n[1]=M,n[5]=u*b,n[9]=-s*b,n[2]=-_*b,n[6]=A*M+k,n[10]=C-z*M}else if(e.order==="XZY"){const C=u*m,A=u*_,k=s*m,z=s*_;n[0]=m*b,n[4]=-M,n[8]=_*b,n[1]=C*M+z,n[5]=u*b,n[9]=A*M-k,n[2]=k*M-A,n[6]=s*b,n[10]=z*M+C}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Cme,e,Tme)}lookAt(e,n,r){const a=this.elements;return tc.subVectors(e,n),tc.lengthSq()===0&&(tc.z=1),tc.normalize(),Rp.crossVectors(r,tc),Rp.lengthSq()===0&&(Math.abs(r.z)===1?tc.x+=1e-4:tc.z+=1e-4,tc.normalize(),Rp.crossVectors(r,tc)),Rp.normalize(),vb.crossVectors(tc,Rp),a[0]=Rp.x,a[4]=vb.x,a[8]=tc.x,a[1]=Rp.y,a[5]=vb.y,a[9]=tc.y,a[2]=Rp.z,a[6]=vb.z,a[10]=tc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,a=n.elements,l=this.elements,u=r[0],s=r[4],m=r[8],_=r[12],b=r[1],M=r[5],C=r[9],A=r[13],k=r[2],z=r[6],P=r[10],O=r[14],j=r[3],U=r[7],X=r[11],K=r[15],se=a[0],J=a[4],ue=a[8],ne=a[12],H=a[1],de=a[5],Ee=a[9],Pe=a[13],Ze=a[2],ke=a[6],Te=a[10],Ie=a[14],Ce=a[3],Ue=a[7],nt=a[11],Le=a[15];return l[0]=u*se+s*H+m*Ze+_*Ce,l[4]=u*J+s*de+m*ke+_*Ue,l[8]=u*ue+s*Ee+m*Te+_*nt,l[12]=u*ne+s*Pe+m*Ie+_*Le,l[1]=b*se+M*H+C*Ze+A*Ce,l[5]=b*J+M*de+C*ke+A*Ue,l[9]=b*ue+M*Ee+C*Te+A*nt,l[13]=b*ne+M*Pe+C*Ie+A*Le,l[2]=k*se+z*H+P*Ze+O*Ce,l[6]=k*J+z*de+P*ke+O*Ue,l[10]=k*ue+z*Ee+P*Te+O*nt,l[14]=k*ne+z*Pe+P*Ie+O*Le,l[3]=j*se+U*H+X*Ze+K*Ce,l[7]=j*J+U*de+X*ke+K*Ue,l[11]=j*ue+U*Ee+X*Te+K*nt,l[15]=j*ne+U*Pe+X*Ie+K*Le,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],a=e[8],l=e[12],u=e[1],s=e[5],m=e[9],_=e[13],b=e[2],M=e[6],C=e[10],A=e[14],k=e[3],z=e[7],P=e[11],O=e[15];return k*(+l*m*M-a*_*M-l*s*C+r*_*C+a*s*A-r*m*A)+z*(+n*m*A-n*_*C+l*u*C-a*u*A+a*_*b-l*m*b)+P*(+n*_*M-n*s*A-l*u*M+r*u*A+l*s*b-r*_*b)+O*(-a*s*b-n*m*M+n*s*C+a*u*M-r*u*C+r*m*b)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const a=this.elements;return e.isVector3?(a[12]=e.x,a[13]=e.y,a[14]=e.z):(a[12]=e,a[13]=n,a[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],a=e[2],l=e[3],u=e[4],s=e[5],m=e[6],_=e[7],b=e[8],M=e[9],C=e[10],A=e[11],k=e[12],z=e[13],P=e[14],O=e[15],j=M*P*_-z*C*_+z*m*A-s*P*A-M*m*O+s*C*O,U=k*C*_-b*P*_-k*m*A+u*P*A+b*m*O-u*C*O,X=b*z*_-k*M*_+k*s*A-u*z*A-b*s*O+u*M*O,K=k*M*m-b*z*m-k*s*C+u*z*C+b*s*P-u*M*P,se=n*j+r*U+a*X+l*K;if(se===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const J=1/se;return e[0]=j*J,e[1]=(z*C*l-M*P*l-z*a*A+r*P*A+M*a*O-r*C*O)*J,e[2]=(s*P*l-z*m*l+z*a*_-r*P*_-s*a*O+r*m*O)*J,e[3]=(M*m*l-s*C*l-M*a*_+r*C*_+s*a*A-r*m*A)*J,e[4]=U*J,e[5]=(b*P*l-k*C*l+k*a*A-n*P*A-b*a*O+n*C*O)*J,e[6]=(k*m*l-u*P*l-k*a*_+n*P*_+u*a*O-n*m*O)*J,e[7]=(u*C*l-b*m*l+b*a*_-n*C*_-u*a*A+n*m*A)*J,e[8]=X*J,e[9]=(k*M*l-b*z*l-k*r*A+n*z*A+b*r*O-n*M*O)*J,e[10]=(u*z*l-k*s*l+k*r*_-n*z*_-u*r*O+n*s*O)*J,e[11]=(b*s*l-u*M*l-b*r*_+n*M*_+u*r*A-n*s*A)*J,e[12]=K*J,e[13]=(b*z*a-k*M*a+k*r*C-n*z*C-b*r*P+n*M*P)*J,e[14]=(k*s*a-u*z*a-k*r*m+n*z*m+u*r*P-n*s*P)*J,e[15]=(u*M*a-b*s*a+b*r*m-n*M*m-u*r*C+n*s*C)*J,this}scale(e){const n=this.elements,r=e.x,a=e.y,l=e.z;return n[0]*=r,n[4]*=a,n[8]*=l,n[1]*=r,n[5]*=a,n[9]*=l,n[2]*=r,n[6]*=a,n[10]*=l,n[3]*=r,n[7]*=a,n[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],a=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,a))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),a=Math.sin(n),l=1-r,u=e.x,s=e.y,m=e.z,_=l*u,b=l*s;return this.set(_*u+r,_*s-a*m,_*m+a*s,0,_*s+a*m,b*s+r,b*m-a*u,0,_*m-a*s,b*m+a*u,l*m*m+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,a,l,u){return this.set(1,r,l,0,e,1,u,0,n,a,1,0,0,0,0,1),this}compose(e,n,r){const a=this.elements,l=n._x,u=n._y,s=n._z,m=n._w,_=l+l,b=u+u,M=s+s,C=l*_,A=l*b,k=l*M,z=u*b,P=u*M,O=s*M,j=m*_,U=m*b,X=m*M,K=r.x,se=r.y,J=r.z;return a[0]=(1-(z+O))*K,a[1]=(A+X)*K,a[2]=(k-U)*K,a[3]=0,a[4]=(A-X)*se,a[5]=(1-(C+O))*se,a[6]=(P+j)*se,a[7]=0,a[8]=(k+U)*J,a[9]=(P-j)*J,a[10]=(1-(C+z))*J,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,this}decompose(e,n,r){const a=this.elements;let l=Nv.set(a[0],a[1],a[2]).length();const u=Nv.set(a[4],a[5],a[6]).length(),s=Nv.set(a[8],a[9],a[10]).length();this.determinant()<0&&(l=-l),e.x=a[12],e.y=a[13],e.z=a[14],Ku.copy(this);const _=1/l,b=1/u,M=1/s;return Ku.elements[0]*=_,Ku.elements[1]*=_,Ku.elements[2]*=_,Ku.elements[4]*=b,Ku.elements[5]*=b,Ku.elements[6]*=b,Ku.elements[8]*=M,Ku.elements[9]*=M,Ku.elements[10]*=M,n.setFromRotationMatrix(Ku),r.x=l,r.y=u,r.z=s,this}makePerspective(e,n,r,a,l,u,s=cf){const m=this.elements,_=2*l/(n-e),b=2*l/(r-a),M=(n+e)/(n-e),C=(r+a)/(r-a);let A,k;if(s===cf)A=-(u+l)/(u-l),k=-2*u*l/(u-l);else if(s===Vw)A=-u/(u-l),k=-u*l/(u-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return m[0]=_,m[4]=0,m[8]=M,m[12]=0,m[1]=0,m[5]=b,m[9]=C,m[13]=0,m[2]=0,m[6]=0,m[10]=A,m[14]=k,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(e,n,r,a,l,u,s=cf){const m=this.elements,_=1/(n-e),b=1/(r-a),M=1/(u-l),C=(n+e)*_,A=(r+a)*b;let k,z;if(s===cf)k=(u+l)*M,z=-2*M;else if(s===Vw)k=l*M,z=-1*M;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return m[0]=2*_,m[4]=0,m[8]=0,m[12]=-C,m[1]=0,m[5]=2*b,m[9]=0,m[13]=-A,m[2]=0,m[6]=0,m[10]=z,m[14]=-k,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let a=0;a<16;a++)if(n[a]!==r[a])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const Nv=new At,Ku=new ki,Cme=new At(0,0,0),Tme=new At(1,1,1),Rp=new At,vb=new At,tc=new At,dF=new ki,fF=new pm;class ud{constructor(e=0,n=0,r=0,a=ud.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=a}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,a=this._order){return this._x=e,this._y=n,this._z=r,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const a=e.elements,l=a[0],u=a[4],s=a[8],m=a[1],_=a[5],b=a[9],M=a[2],C=a[6],A=a[10];switch(n){case"XYZ":this._y=Math.asin(Xr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-b,A),this._z=Math.atan2(-u,l)):(this._x=Math.atan2(C,_),this._z=0);break;case"YXZ":this._x=Math.asin(-Xr(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(s,A),this._z=Math.atan2(m,_)):(this._y=Math.atan2(-M,l),this._z=0);break;case"ZXY":this._x=Math.asin(Xr(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-M,A),this._z=Math.atan2(-u,_)):(this._y=0,this._z=Math.atan2(m,l));break;case"ZYX":this._y=Math.asin(-Xr(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(C,A),this._z=Math.atan2(m,l)):(this._x=0,this._z=Math.atan2(-u,_));break;case"YZX":this._z=Math.asin(Xr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-b,_),this._y=Math.atan2(-M,l)):(this._x=0,this._y=Math.atan2(s,A));break;case"XZY":this._z=Math.asin(-Xr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(C,_),this._y=Math.atan2(s,l)):(this._x=Math.atan2(-b,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return dF.makeRotationFromQuaternion(e),this.setFromRotationMatrix(dF,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return fF.setFromEuler(this),this.setFromQuaternion(fF,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ud.DEFAULT_ORDER="XYZ";class IR{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Pme=0;const pF=new At,Bv=new pm,ef=new ki,yb=new At,Z0=new At,Ame=new At,Ime=new pm,mF=new At(1,0,0),gF=new At(0,1,0),vF=new At(0,0,1),yF={type:"added"},Rme={type:"removed"},Uv={type:"childadded",child:null},bT={type:"childremoved",child:null};class Qs extends Qy{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Pme++}),this.uuid=e0(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Qs.DEFAULT_UP.clone();const e=new At,n=new ud,r=new pm,a=new At(1,1,1);function l(){r.setFromEuler(n,!1)}function u(){n.setFromQuaternion(r,void 0,!1)}n._onChange(l),r._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new ki},normalMatrix:{value:new zr}}),this.matrix=new ki,this.matrixWorld=new ki,this.matrixAutoUpdate=Qs.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Qs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new IR,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Bv.setFromAxisAngle(e,n),this.quaternion.multiply(Bv),this}rotateOnWorldAxis(e,n){return Bv.setFromAxisAngle(e,n),this.quaternion.premultiply(Bv),this}rotateX(e){return this.rotateOnAxis(mF,e)}rotateY(e){return this.rotateOnAxis(gF,e)}rotateZ(e){return this.rotateOnAxis(vF,e)}translateOnAxis(e,n){return pF.copy(e).applyQuaternion(this.quaternion),this.position.add(pF.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(mF,e)}translateY(e){return this.translateOnAxis(gF,e)}translateZ(e){return this.translateOnAxis(vF,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ef.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?yb.copy(e):yb.set(e,n,r);const a=this.parent;this.updateWorldMatrix(!0,!1),Z0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ef.lookAt(Z0,yb,this.up):ef.lookAt(yb,Z0,this.up),this.quaternion.setFromRotationMatrix(ef),a&&(ef.extractRotation(a.matrixWorld),Bv.setFromRotationMatrix(ef),this.quaternion.premultiply(Bv.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(yF),Uv.child=e,this.dispatchEvent(Uv),Uv.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Rme),bT.child=e,this.dispatchEvent(bT),bT.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ef.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ef.multiply(e.parent.matrixWorld)),e.applyMatrix4(ef),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(yF),Uv.child=e,this.dispatchEvent(Uv),Uv.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,a=this.children.length;r<a;r++){const u=this.children[r].getObjectByProperty(e,n);if(u!==void 0)return u}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const a=this.children;for(let l=0,u=a.length;l<u;l++)a[l].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Z0,e,Ame),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Z0,Ime,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,a=n.length;r<a;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,a=n.length;r<a;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,a=n.length;r<a;r++)n[r].updateMatrixWorld(e)}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const a=this.children;for(let l=0,u=a.length;l<u;l++)a[l].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.visibility=this._visibility,a.active=this._active,a.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),a.maxInstanceCount=this._maxInstanceCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.geometryCount=this._geometryCount,a.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(a.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(a.boundingSphere={center:a.boundingSphere.center.toArray(),radius:a.boundingSphere.radius}),this.boundingBox!==null&&(a.boundingBox={min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}));function l(s,m){return s[m.uuid]===void 0&&(s[m.uuid]=m.toJSON(e)),m.uuid}if(this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=l(e.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const m=s.shapes;if(Array.isArray(m))for(let _=0,b=m.length;_<b;_++){const M=m[_];l(e.shapes,M)}else l(e.shapes,m)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let m=0,_=this.material.length;m<_;m++)s.push(l(e.materials,this.material[m]));a.material=s}else a.material=l(e.materials,this.material);if(this.children.length>0){a.children=[];for(let s=0;s<this.children.length;s++)a.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){a.animations=[];for(let s=0;s<this.animations.length;s++){const m=this.animations[s];a.animations.push(l(e.animations,m))}}if(n){const s=u(e.geometries),m=u(e.materials),_=u(e.textures),b=u(e.images),M=u(e.shapes),C=u(e.skeletons),A=u(e.animations),k=u(e.nodes);s.length>0&&(r.geometries=s),m.length>0&&(r.materials=m),_.length>0&&(r.textures=_),b.length>0&&(r.images=b),M.length>0&&(r.shapes=M),C.length>0&&(r.skeletons=C),A.length>0&&(r.animations=A),k.length>0&&(r.nodes=k)}return r.object=a,r;function u(s){const m=[];for(const _ in s){const b=s[_];delete b.metadata,m.push(b)}return m}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const a=e.children[r];this.add(a.clone())}return this}}Qs.DEFAULT_UP=new At(0,1,0);Qs.DEFAULT_MATRIX_AUTO_UPDATE=!0;Qs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ju=new At,tf=new At,wT=new At,nf=new At,$v=new At,Vv=new At,_F=new At,ST=new At,MT=new At,ET=new At,CT=new $o,TT=new $o,PT=new $o;class th{constructor(e=new At,n=new At,r=new At){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,a){a.subVectors(r,n),Ju.subVectors(e,n),a.cross(Ju);const l=a.lengthSq();return l>0?a.multiplyScalar(1/Math.sqrt(l)):a.set(0,0,0)}static getBarycoord(e,n,r,a,l){Ju.subVectors(a,n),tf.subVectors(r,n),wT.subVectors(e,n);const u=Ju.dot(Ju),s=Ju.dot(tf),m=Ju.dot(wT),_=tf.dot(tf),b=tf.dot(wT),M=u*_-s*s;if(M===0)return l.set(0,0,0),null;const C=1/M,A=(_*m-s*b)*C,k=(u*b-s*m)*C;return l.set(1-A-k,k,A)}static containsPoint(e,n,r,a){return this.getBarycoord(e,n,r,a,nf)===null?!1:nf.x>=0&&nf.y>=0&&nf.x+nf.y<=1}static getInterpolation(e,n,r,a,l,u,s,m){return this.getBarycoord(e,n,r,a,nf)===null?(m.x=0,m.y=0,"z"in m&&(m.z=0),"w"in m&&(m.w=0),null):(m.setScalar(0),m.addScaledVector(l,nf.x),m.addScaledVector(u,nf.y),m.addScaledVector(s,nf.z),m)}static getInterpolatedAttribute(e,n,r,a,l,u){return CT.setScalar(0),TT.setScalar(0),PT.setScalar(0),CT.fromBufferAttribute(e,n),TT.fromBufferAttribute(e,r),PT.fromBufferAttribute(e,a),u.setScalar(0),u.addScaledVector(CT,l.x),u.addScaledVector(TT,l.y),u.addScaledVector(PT,l.z),u}static isFrontFacing(e,n,r,a){return Ju.subVectors(r,n),tf.subVectors(e,n),Ju.cross(tf).dot(a)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,a){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[a]),this}setFromAttributeAndIndices(e,n,r,a){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ju.subVectors(this.c,this.b),tf.subVectors(this.a,this.b),Ju.cross(tf).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return th.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return th.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,r,a,l){return th.getInterpolation(e,this.a,this.b,this.c,n,r,a,l)}containsPoint(e){return th.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return th.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,a=this.b,l=this.c;let u,s;$v.subVectors(a,r),Vv.subVectors(l,r),ST.subVectors(e,r);const m=$v.dot(ST),_=Vv.dot(ST);if(m<=0&&_<=0)return n.copy(r);MT.subVectors(e,a);const b=$v.dot(MT),M=Vv.dot(MT);if(b>=0&&M<=b)return n.copy(a);const C=m*M-b*_;if(C<=0&&m>=0&&b<=0)return u=m/(m-b),n.copy(r).addScaledVector($v,u);ET.subVectors(e,l);const A=$v.dot(ET),k=Vv.dot(ET);if(k>=0&&A<=k)return n.copy(l);const z=A*_-m*k;if(z<=0&&_>=0&&k<=0)return s=_/(_-k),n.copy(r).addScaledVector(Vv,s);const P=b*k-A*M;if(P<=0&&M-b>=0&&A-k>=0)return _F.subVectors(l,a),s=(M-b)/(M-b+(A-k)),n.copy(a).addScaledVector(_F,s);const O=1/(P+z+C);return u=z*O,s=C*O,n.copy(r).addScaledVector($v,u).addScaledVector(Vv,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const C8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Dp={h:0,s:0,l:0},_b={h:0,s:0,l:0};function AT(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class Ti{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const a=e;a&&a.isColor?this.copy(a):typeof a=="number"?this.setHex(a):typeof a=="string"&&this.setStyle(a)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Kc){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,oi.toWorkingColorSpace(this,n),this}setRGB(e,n,r,a=oi.workingColorSpace){return this.r=e,this.g=n,this.b=r,oi.toWorkingColorSpace(this,a),this}setHSL(e,n,r,a=oi.workingColorSpace){if(e=TR(e,1),n=Xr(n,0,1),r=Xr(r,0,1),n===0)this.r=this.g=this.b=r;else{const l=r<=.5?r*(1+n):r+n-r*n,u=2*r-l;this.r=AT(u,l,e+1/3),this.g=AT(u,l,e),this.b=AT(u,l,e-1/3)}return oi.toWorkingColorSpace(this,a),this}setStyle(e,n=Kc){function r(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let a;if(a=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const u=a[1],s=a[2];switch(u){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,n);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,n);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=a[1],u=l.length;if(u===3)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,n);if(u===6)return this.setHex(parseInt(l,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Kc){const r=C8[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=uf(e.r),this.g=uf(e.g),this.b=uf(e.b),this}copyLinearToSRGB(e){return this.r=Cy(e.r),this.g=Cy(e.g),this.b=Cy(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Kc){return oi.fromWorkingColorSpace(_a.copy(this),e),Math.round(Xr(_a.r*255,0,255))*65536+Math.round(Xr(_a.g*255,0,255))*256+Math.round(Xr(_a.b*255,0,255))}getHexString(e=Kc){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=oi.workingColorSpace){oi.fromWorkingColorSpace(_a.copy(this),n);const r=_a.r,a=_a.g,l=_a.b,u=Math.max(r,a,l),s=Math.min(r,a,l);let m,_;const b=(s+u)/2;if(s===u)m=0,_=0;else{const M=u-s;switch(_=b<=.5?M/(u+s):M/(2-u-s),u){case r:m=(a-l)/M+(a<l?6:0);break;case a:m=(l-r)/M+2;break;case l:m=(r-a)/M+4;break}m/=6}return e.h=m,e.s=_,e.l=b,e}getRGB(e,n=oi.workingColorSpace){return oi.fromWorkingColorSpace(_a.copy(this),n),e.r=_a.r,e.g=_a.g,e.b=_a.b,e}getStyle(e=Kc){oi.fromWorkingColorSpace(_a.copy(this),e);const n=_a.r,r=_a.g,a=_a.b;return e!==Kc?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${a.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(a*255)})`}offsetHSL(e,n,r){return this.getHSL(Dp),this.setHSL(Dp.h+e,Dp.s+n,Dp.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Dp),e.getHSL(_b);const r=A_(Dp.h,_b.h,n),a=A_(Dp.s,_b.s,n),l=A_(Dp.l,_b.l,n);return this.setHSL(r,a,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,a=this.b,l=e.elements;return this.r=l[0]*n+l[3]*r+l[6]*a,this.g=l[1]*n+l[4]*r+l[7]*a,this.b=l[2]*n+l[5]*r+l[8]*a,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _a=new Ti;Ti.NAMES=C8;let Dme=0;class Kx extends Qy{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dme++}),this.uuid=e0(),this.name="",this.type="Material",this.blending=Ey,this.side=tm,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=PP,this.blendDst=AP,this.blendEquation=_g,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ti(0,0,0),this.blendAlpha=0,this.depthFunc=Vy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=iF,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Lv,this.stencilZFail=Lv,this.stencilZPass=Lv,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const a=this[n];if(a===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}a&&a.isColor?a.set(r):a&&a.isVector3&&r&&r.isVector3?a.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Ey&&(r.blending=this.blending),this.side!==tm&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==PP&&(r.blendSrc=this.blendSrc),this.blendDst!==AP&&(r.blendDst=this.blendDst),this.blendEquation!==_g&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Vy&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==iF&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Lv&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Lv&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Lv&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function a(l){const u=[];for(const s in l){const m=l[s];delete m.metadata,u.push(m)}return u}if(n){const l=a(e.textures),u=a(e.images);l.length>0&&(r.textures=l),u.length>0&&(r.images=u)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const a=n.length;r=new Array(a);for(let l=0;l!==a;++l)r[l]=n[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class rm extends Kx{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ti(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ud,this.combine=u8,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const ts=new At,xb=new mi;let Lme=0;class id{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Lme++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=oF,this.updateRanges=[],this.gpuType=lf,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let a=0,l=this.itemSize;a<l;a++)this.array[e+a]=n.array[r+a];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)xb.fromBufferAttribute(this,n),xb.applyMatrix3(e),this.setXY(n,xb.x,xb.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)ts.fromBufferAttribute(this,n),ts.applyMatrix3(e),this.setXYZ(n,ts.x,ts.y,ts.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)ts.fromBufferAttribute(this,n),ts.applyMatrix4(e),this.setXYZ(n,ts.x,ts.y,ts.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)ts.fromBufferAttribute(this,n),ts.applyNormalMatrix(e),this.setXYZ(n,ts.x,ts.y,ts.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)ts.fromBufferAttribute(this,n),ts.transformDirection(e),this.setXYZ(n,ts.x,ts.y,ts.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=ey(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Va(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=ey(n,this.array)),n}setX(e,n){return this.normalized&&(n=Va(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=ey(n,this.array)),n}setY(e,n){return this.normalized&&(n=Va(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=ey(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Va(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=ey(n,this.array)),n}setW(e,n){return this.normalized&&(n=Va(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Va(n,this.array),r=Va(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,a){return e*=this.itemSize,this.normalized&&(n=Va(n,this.array),r=Va(r,this.array),a=Va(a,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=a,this}setXYZW(e,n,r,a,l){return e*=this.itemSize,this.normalized&&(n=Va(n,this.array),r=Va(r,this.array),a=Va(a,this.array),l=Va(l,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=a,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==oF&&(e.usage=this.usage),e}}class T8 extends id{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class P8 extends id{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class gc extends id{constructor(e,n,r){super(new Float32Array(e),n,r)}}let kme=0;const Wc=new ki,IT=new Qs,jv=new At,nc=new t0,Y0=new t0,ks=new At;class dd extends Qy{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:kme++}),this.uuid=e0(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(M8(e)?P8:T8)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const l=new zr().getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}const a=this.attributes.tangent;return a!==void 0&&(a.transformDirection(e),a.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Wc.makeRotationFromQuaternion(e),this.applyMatrix4(Wc),this}rotateX(e){return Wc.makeRotationX(e),this.applyMatrix4(Wc),this}rotateY(e){return Wc.makeRotationY(e),this.applyMatrix4(Wc),this}rotateZ(e){return Wc.makeRotationZ(e),this.applyMatrix4(Wc),this}translate(e,n,r){return Wc.makeTranslation(e,n,r),this.applyMatrix4(Wc),this}scale(e,n,r){return Wc.makeScale(e,n,r),this.applyMatrix4(Wc),this}lookAt(e){return IT.lookAt(e),IT.updateMatrix(),this.applyMatrix4(IT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jv).negate(),this.translate(jv.x,jv.y,jv.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];r.push(u.x,u.y,u.z||0)}this.setAttribute("position",new gc(r,3))}else{const r=Math.min(e.length,n.count);for(let a=0;a<r;a++){const l=e[a];n.setXYZ(a,l.x,l.y,l.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new t0);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new At(-1/0,-1/0,-1/0),new At(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,a=n.length;r<a;r++){const l=n[r];nc.setFromBufferAttribute(l),this.morphTargetsRelative?(ks.addVectors(this.boundingBox.min,nc.min),this.boundingBox.expandByPoint(ks),ks.addVectors(this.boundingBox.max,nc.max),this.boundingBox.expandByPoint(ks)):(this.boundingBox.expandByPoint(nc.min),this.boundingBox.expandByPoint(nc.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new i2);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new At,1/0);return}if(e){const r=this.boundingSphere.center;if(nc.setFromBufferAttribute(e),n)for(let l=0,u=n.length;l<u;l++){const s=n[l];Y0.setFromBufferAttribute(s),this.morphTargetsRelative?(ks.addVectors(nc.min,Y0.min),nc.expandByPoint(ks),ks.addVectors(nc.max,Y0.max),nc.expandByPoint(ks)):(nc.expandByPoint(Y0.min),nc.expandByPoint(Y0.max))}nc.getCenter(r);let a=0;for(let l=0,u=e.count;l<u;l++)ks.fromBufferAttribute(e,l),a=Math.max(a,r.distanceToSquared(ks));if(n)for(let l=0,u=n.length;l<u;l++){const s=n[l],m=this.morphTargetsRelative;for(let _=0,b=s.count;_<b;_++)ks.fromBufferAttribute(s,_),m&&(jv.fromBufferAttribute(e,_),ks.add(jv)),a=Math.max(a,r.distanceToSquared(ks))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,a=n.normal,l=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new id(new Float32Array(4*r.count),4));const u=this.getAttribute("tangent"),s=[],m=[];for(let ue=0;ue<r.count;ue++)s[ue]=new At,m[ue]=new At;const _=new At,b=new At,M=new At,C=new mi,A=new mi,k=new mi,z=new At,P=new At;function O(ue,ne,H){_.fromBufferAttribute(r,ue),b.fromBufferAttribute(r,ne),M.fromBufferAttribute(r,H),C.fromBufferAttribute(l,ue),A.fromBufferAttribute(l,ne),k.fromBufferAttribute(l,H),b.sub(_),M.sub(_),A.sub(C),k.sub(C);const de=1/(A.x*k.y-k.x*A.y);isFinite(de)&&(z.copy(b).multiplyScalar(k.y).addScaledVector(M,-A.y).multiplyScalar(de),P.copy(M).multiplyScalar(A.x).addScaledVector(b,-k.x).multiplyScalar(de),s[ue].add(z),s[ne].add(z),s[H].add(z),m[ue].add(P),m[ne].add(P),m[H].add(P))}let j=this.groups;j.length===0&&(j=[{start:0,count:e.count}]);for(let ue=0,ne=j.length;ue<ne;++ue){const H=j[ue],de=H.start,Ee=H.count;for(let Pe=de,Ze=de+Ee;Pe<Ze;Pe+=3)O(e.getX(Pe+0),e.getX(Pe+1),e.getX(Pe+2))}const U=new At,X=new At,K=new At,se=new At;function J(ue){K.fromBufferAttribute(a,ue),se.copy(K);const ne=s[ue];U.copy(ne),U.sub(K.multiplyScalar(K.dot(ne))).normalize(),X.crossVectors(se,ne);const de=X.dot(m[ue])<0?-1:1;u.setXYZW(ue,U.x,U.y,U.z,de)}for(let ue=0,ne=j.length;ue<ne;++ue){const H=j[ue],de=H.start,Ee=H.count;for(let Pe=de,Ze=de+Ee;Pe<Ze;Pe+=3)J(e.getX(Pe+0)),J(e.getX(Pe+1)),J(e.getX(Pe+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new id(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let C=0,A=r.count;C<A;C++)r.setXYZ(C,0,0,0);const a=new At,l=new At,u=new At,s=new At,m=new At,_=new At,b=new At,M=new At;if(e)for(let C=0,A=e.count;C<A;C+=3){const k=e.getX(C+0),z=e.getX(C+1),P=e.getX(C+2);a.fromBufferAttribute(n,k),l.fromBufferAttribute(n,z),u.fromBufferAttribute(n,P),b.subVectors(u,l),M.subVectors(a,l),b.cross(M),s.fromBufferAttribute(r,k),m.fromBufferAttribute(r,z),_.fromBufferAttribute(r,P),s.add(b),m.add(b),_.add(b),r.setXYZ(k,s.x,s.y,s.z),r.setXYZ(z,m.x,m.y,m.z),r.setXYZ(P,_.x,_.y,_.z)}else for(let C=0,A=n.count;C<A;C+=3)a.fromBufferAttribute(n,C+0),l.fromBufferAttribute(n,C+1),u.fromBufferAttribute(n,C+2),b.subVectors(u,l),M.subVectors(a,l),b.cross(M),r.setXYZ(C+0,b.x,b.y,b.z),r.setXYZ(C+1,b.x,b.y,b.z),r.setXYZ(C+2,b.x,b.y,b.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)ks.fromBufferAttribute(e,n),ks.normalize(),e.setXYZ(n,ks.x,ks.y,ks.z)}toNonIndexed(){function e(s,m){const _=s.array,b=s.itemSize,M=s.normalized,C=new _.constructor(m.length*b);let A=0,k=0;for(let z=0,P=m.length;z<P;z++){s.isInterleavedBufferAttribute?A=m[z]*s.data.stride+s.offset:A=m[z]*b;for(let O=0;O<b;O++)C[k++]=_[A++]}return new id(C,b,M)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new dd,r=this.index.array,a=this.attributes;for(const s in a){const m=a[s],_=e(m,r);n.setAttribute(s,_)}const l=this.morphAttributes;for(const s in l){const m=[],_=l[s];for(let b=0,M=_.length;b<M;b++){const C=_[b],A=e(C,r);m.push(A)}n.morphAttributes[s]=m}n.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let s=0,m=u.length;s<m;s++){const _=u[s];n.addGroup(_.start,_.count,_.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const m=this.parameters;for(const _ in m)m[_]!==void 0&&(e[_]=m[_]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const m in r){const _=r[m];e.data.attributes[m]=_.toJSON(e.data)}const a={};let l=!1;for(const m in this.morphAttributes){const _=this.morphAttributes[m],b=[];for(let M=0,C=_.length;M<C;M++){const A=_[M];b.push(A.toJSON(e.data))}b.length>0&&(a[m]=b,l=!0)}l&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const a=e.attributes;for(const _ in a){const b=a[_];this.setAttribute(_,b.clone(n))}const l=e.morphAttributes;for(const _ in l){const b=[],M=l[_];for(let C=0,A=M.length;C<A;C++)b.push(M[C].clone(n));this.morphAttributes[_]=b}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let _=0,b=u.length;_<b;_++){const M=u[_];this.addGroup(M.start,M.count,M.materialIndex)}const s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());const m=e.boundingSphere;return m!==null&&(this.boundingSphere=m.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const xF=new ki,ug=new AR,bb=new i2,bF=new At,wb=new At,Sb=new At,Mb=new At,RT=new At,Eb=new At,wF=new At,Cb=new At;class wl extends Qs{constructor(e=new dd,n=new rm){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const a=n[r[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=a.length;l<u;l++){const s=a[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=l}}}}getVertexPosition(e,n){const r=this.geometry,a=r.attributes.position,l=r.morphAttributes.position,u=r.morphTargetsRelative;n.fromBufferAttribute(a,e);const s=this.morphTargetInfluences;if(l&&s){Eb.set(0,0,0);for(let m=0,_=l.length;m<_;m++){const b=s[m],M=l[m];b!==0&&(RT.fromBufferAttribute(M,e),u?Eb.addScaledVector(RT,b):Eb.addScaledVector(RT.sub(n),b))}n.add(Eb)}return n}raycast(e,n){const r=this.geometry,a=this.material,l=this.matrixWorld;a!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),bb.copy(r.boundingSphere),bb.applyMatrix4(l),ug.copy(e.ray).recast(e.near),!(bb.containsPoint(ug.origin)===!1&&(ug.intersectSphere(bb,bF)===null||ug.origin.distanceToSquared(bF)>(e.far-e.near)**2))&&(xF.copy(l).invert(),ug.copy(e.ray).applyMatrix4(xF),!(r.boundingBox!==null&&ug.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,ug)))}_computeIntersections(e,n,r){let a;const l=this.geometry,u=this.material,s=l.index,m=l.attributes.position,_=l.attributes.uv,b=l.attributes.uv1,M=l.attributes.normal,C=l.groups,A=l.drawRange;if(s!==null)if(Array.isArray(u))for(let k=0,z=C.length;k<z;k++){const P=C[k],O=u[P.materialIndex],j=Math.max(P.start,A.start),U=Math.min(s.count,Math.min(P.start+P.count,A.start+A.count));for(let X=j,K=U;X<K;X+=3){const se=s.getX(X),J=s.getX(X+1),ue=s.getX(X+2);a=Tb(this,O,e,r,_,b,M,se,J,ue),a&&(a.faceIndex=Math.floor(X/3),a.face.materialIndex=P.materialIndex,n.push(a))}}else{const k=Math.max(0,A.start),z=Math.min(s.count,A.start+A.count);for(let P=k,O=z;P<O;P+=3){const j=s.getX(P),U=s.getX(P+1),X=s.getX(P+2);a=Tb(this,u,e,r,_,b,M,j,U,X),a&&(a.faceIndex=Math.floor(P/3),n.push(a))}}else if(m!==void 0)if(Array.isArray(u))for(let k=0,z=C.length;k<z;k++){const P=C[k],O=u[P.materialIndex],j=Math.max(P.start,A.start),U=Math.min(m.count,Math.min(P.start+P.count,A.start+A.count));for(let X=j,K=U;X<K;X+=3){const se=X,J=X+1,ue=X+2;a=Tb(this,O,e,r,_,b,M,se,J,ue),a&&(a.faceIndex=Math.floor(X/3),a.face.materialIndex=P.materialIndex,n.push(a))}}else{const k=Math.max(0,A.start),z=Math.min(m.count,A.start+A.count);for(let P=k,O=z;P<O;P+=3){const j=P,U=P+1,X=P+2;a=Tb(this,u,e,r,_,b,M,j,U,X),a&&(a.faceIndex=Math.floor(P/3),n.push(a))}}}}function zme(t,e,n,r,a,l,u,s){let m;if(e.side===El?m=r.intersectTriangle(u,l,a,!0,s):m=r.intersectTriangle(a,l,u,e.side===tm,s),m===null)return null;Cb.copy(s),Cb.applyMatrix4(t.matrixWorld);const _=n.ray.origin.distanceTo(Cb);return _<n.near||_>n.far?null:{distance:_,point:Cb.clone(),object:t}}function Tb(t,e,n,r,a,l,u,s,m,_){t.getVertexPosition(s,wb),t.getVertexPosition(m,Sb),t.getVertexPosition(_,Mb);const b=zme(t,e,n,r,wb,Sb,Mb,wF);if(b){const M=new At;th.getBarycoord(wF,wb,Sb,Mb,M),a&&(b.uv=th.getInterpolatedAttribute(a,s,m,_,M,new mi)),l&&(b.uv1=th.getInterpolatedAttribute(l,s,m,_,M,new mi)),u&&(b.normal=th.getInterpolatedAttribute(u,s,m,_,M,new At),b.normal.dot(r.direction)>0&&b.normal.multiplyScalar(-1));const C={a:s,b:m,c:_,normal:new At,materialIndex:0};th.getNormal(wb,Sb,Mb,C.normal),b.face=C,b.barycoord=M}return b}class Jx extends dd{constructor(e=1,n=1,r=1,a=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:a,heightSegments:l,depthSegments:u};const s=this;a=Math.floor(a),l=Math.floor(l),u=Math.floor(u);const m=[],_=[],b=[],M=[];let C=0,A=0;k("z","y","x",-1,-1,r,n,e,u,l,0),k("z","y","x",1,-1,r,n,-e,u,l,1),k("x","z","y",1,1,e,r,n,a,u,2),k("x","z","y",1,-1,e,r,-n,a,u,3),k("x","y","z",1,-1,e,n,r,a,l,4),k("x","y","z",-1,-1,e,n,-r,a,l,5),this.setIndex(m),this.setAttribute("position",new gc(_,3)),this.setAttribute("normal",new gc(b,3)),this.setAttribute("uv",new gc(M,2));function k(z,P,O,j,U,X,K,se,J,ue,ne){const H=X/J,de=K/ue,Ee=X/2,Pe=K/2,Ze=se/2,ke=J+1,Te=ue+1;let Ie=0,Ce=0;const Ue=new At;for(let nt=0;nt<Te;nt++){const Le=nt*de-Pe;for(let lt=0;lt<ke;lt++){const Ht=lt*H-Ee;Ue[z]=Ht*j,Ue[P]=Le*U,Ue[O]=Ze,_.push(Ue.x,Ue.y,Ue.z),Ue[z]=0,Ue[P]=0,Ue[O]=se>0?1:-1,b.push(Ue.x,Ue.y,Ue.z),M.push(lt/J),M.push(1-nt/ue),Ie+=1}}for(let nt=0;nt<ue;nt++)for(let Le=0;Le<J;Le++){const lt=C+Le+ke*nt,Ht=C+Le+ke*(nt+1),He=C+(Le+1)+ke*(nt+1),pt=C+(Le+1)+ke*nt;m.push(lt,Ht,pt),m.push(Ht,He,pt),Ce+=6}s.addGroup(A,Ce,ne),A+=Ce,C+=Ie}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jx(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Gy(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const a=t[n][r];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=a.clone():Array.isArray(a)?e[n][r]=a.slice():e[n][r]=a}}return e}function ja(t){const e={};for(let n=0;n<t.length;n++){const r=Gy(t[n]);for(const a in r)e[a]=r[a]}return e}function Ome(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function A8(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:oi.workingColorSpace}const Fme={clone:Gy,merge:ja};var Nme=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Bme=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class yf extends Kx{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Nme,this.fragmentShader=Bme,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Gy(e.uniforms),this.uniformsGroups=Ome(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const a in this.uniforms){const u=this.uniforms[a].value;u&&u.isTexture?n.uniforms[a]={type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?n.uniforms[a]={type:"c",value:u.getHex()}:u&&u.isVector2?n.uniforms[a]={type:"v2",value:u.toArray()}:u&&u.isVector3?n.uniforms[a]={type:"v3",value:u.toArray()}:u&&u.isVector4?n.uniforms[a]={type:"v4",value:u.toArray()}:u&&u.isMatrix3?n.uniforms[a]={type:"m3",value:u.toArray()}:u&&u.isMatrix4?n.uniforms[a]={type:"m4",value:u.toArray()}:n.uniforms[a]={value:u}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const a in this.extensions)this.extensions[a]===!0&&(r[a]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class I8 extends Qs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ki,this.projectionMatrix=new ki,this.projectionMatrixInverse=new ki,this.coordinateSystem=cf}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Lp=new At,SF=new mi,MF=new mi;class ac extends I8{constructor(e=50,n=1,r=.1,a=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=a,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=ux*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(P_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ux*2*Math.atan(Math.tan(P_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,r){Lp.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Lp.x,Lp.y).multiplyScalar(-e/Lp.z),Lp.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Lp.x,Lp.y).multiplyScalar(-e/Lp.z)}getViewSize(e,n){return this.getViewBounds(e,SF,MF),n.subVectors(MF,SF)}setViewOffset(e,n,r,a,l,u){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=a,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(P_*.5*this.fov)/this.zoom,r=2*n,a=this.aspect*r,l=-.5*a;const u=this.view;if(this.view!==null&&this.view.enabled){const m=u.fullWidth,_=u.fullHeight;l+=u.offsetX*a/m,n-=u.offsetY*r/_,a*=u.width/m,r*=u.height/_}const s=this.filmOffset;s!==0&&(l+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+a,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Hv=-90,Gv=1;class Ume extends Qs{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const a=new ac(Hv,Gv,e,n);a.layers=this.layers,this.add(a);const l=new ac(Hv,Gv,e,n);l.layers=this.layers,this.add(l);const u=new ac(Hv,Gv,e,n);u.layers=this.layers,this.add(u);const s=new ac(Hv,Gv,e,n);s.layers=this.layers,this.add(s);const m=new ac(Hv,Gv,e,n);m.layers=this.layers,this.add(m);const _=new ac(Hv,Gv,e,n);_.layers=this.layers,this.add(_)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,a,l,u,s,m]=n;for(const _ of n)this.remove(_);if(e===cf)r.up.set(0,1,0),r.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),m.up.set(0,1,0),m.lookAt(0,0,-1);else if(e===Vw)r.up.set(0,-1,0),r.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),m.up.set(0,-1,0),m.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const _ of n)this.add(_),_.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:a}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,u,s,m,_,b]=this.children,M=e.getRenderTarget(),C=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),k=e.xr.enabled;e.xr.enabled=!1;const z=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,a),e.render(n,l),e.setRenderTarget(r,1,a),e.render(n,u),e.setRenderTarget(r,2,a),e.render(n,s),e.setRenderTarget(r,3,a),e.render(n,m),e.setRenderTarget(r,4,a),e.render(n,_),r.texture.generateMipmaps=z,e.setRenderTarget(r,5,a),e.render(n,b),e.setRenderTarget(M,C,A),e.xr.enabled=k,r.texture.needsPMREMUpdate=!0}}class R8 extends Js{constructor(e=[],n=jy,r,a,l,u,s,m,_,b){super(e,n,r,a,l,u,s,m,_,b),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class $me extends nm{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},a=[r,r,r,r,r,r];this.texture=new R8(a,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:hc}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},a=new Jx(5,5,5),l=new yf({name:"CubemapFromEquirect",uniforms:Gy(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:El,blending:Gp});l.uniforms.tEquirect.value=n;const u=new wl(a,l),s=n.minFilter;return n.minFilter===Vp&&(n.minFilter=hc),new Ume(1,10,this).update(e,u),n.minFilter=s,u.geometry.dispose(),u.material.dispose(),this}clear(e,n=!0,r=!0,a=!0){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(n,r,a);e.setRenderTarget(l)}}class jp extends Qs{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Vme={type:"move"};class DT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new jp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new jp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new At,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new At),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new jp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new At,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new At),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let a=null,l=null,u=null;const s=this._targetRay,m=this._grip,_=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(_&&e.hand){u=!0;for(const z of e.hand.values()){const P=n.getJointPose(z,r),O=this._getHandJoint(_,z);P!==null&&(O.matrix.fromArray(P.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),O.matrixWorldNeedsUpdate=!0,O.jointRadius=P.radius),O.visible=P!==null}const b=_.joints["index-finger-tip"],M=_.joints["thumb-tip"],C=b.position.distanceTo(M.position),A=.02,k=.005;_.inputState.pinching&&C>A+k?(_.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!_.inputState.pinching&&C<=A-k&&(_.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else m!==null&&e.gripSpace&&(l=n.getPose(e.gripSpace,r),l!==null&&(m.matrix.fromArray(l.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,l.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(l.linearVelocity)):m.hasLinearVelocity=!1,l.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(l.angularVelocity)):m.hasAngularVelocity=!1));s!==null&&(a=n.getPose(e.targetRaySpace,r),a===null&&l!==null&&(a=l),a!==null&&(s.matrix.fromArray(a.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,a.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(a.linearVelocity)):s.hasLinearVelocity=!1,a.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(a.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Vme)))}return s!==null&&(s.visible=a!==null),m!==null&&(m.visible=l!==null),_!==null&&(_.visible=u!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new jp;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class Hw extends Qs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ud,this.environmentIntensity=1,this.environmentRotation=new ud,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}const LT=new At,jme=new At,Hme=new zr;class mg{constructor(e=new At(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,a){return this.normal.set(e,n,r),this.constant=a,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const a=LT.subVectors(r,n).cross(jme.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(LT),a=this.normal.dot(r);if(a===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/a;return l<0||l>1?null:n.copy(e.start).addScaledVector(r,l)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||Hme.getNormalMatrix(e),a=this.coplanarPoint(LT).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-a.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const hg=new i2,Pb=new At;class RR{constructor(e=new mg,n=new mg,r=new mg,a=new mg,l=new mg,u=new mg){this.planes=[e,n,r,a,l,u]}set(e,n,r,a,l,u){const s=this.planes;return s[0].copy(e),s[1].copy(n),s[2].copy(r),s[3].copy(a),s[4].copy(l),s[5].copy(u),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=cf){const r=this.planes,a=e.elements,l=a[0],u=a[1],s=a[2],m=a[3],_=a[4],b=a[5],M=a[6],C=a[7],A=a[8],k=a[9],z=a[10],P=a[11],O=a[12],j=a[13],U=a[14],X=a[15];if(r[0].setComponents(m-l,C-_,P-A,X-O).normalize(),r[1].setComponents(m+l,C+_,P+A,X+O).normalize(),r[2].setComponents(m+u,C+b,P+k,X+j).normalize(),r[3].setComponents(m-u,C-b,P-k,X-j).normalize(),r[4].setComponents(m-s,C-M,P-z,X-U).normalize(),n===cf)r[5].setComponents(m+s,C+M,P+z,X+U).normalize();else if(n===Vw)r[5].setComponents(s,M,z,U).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),hg.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),hg.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(hg)}intersectsSprite(e){return hg.center.set(0,0,0),hg.radius=.7071067811865476,hg.applyMatrix4(e.matrixWorld),this.intersectsSphere(hg)}intersectsSphere(e){const n=this.planes,r=e.center,a=-e.radius;for(let l=0;l<6;l++)if(n[l].distanceToPoint(r)<a)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const a=n[r];if(Pb.x=a.normal.x>0?e.max.x:e.min.x,Pb.y=a.normal.y>0?e.max.y:e.min.y,Pb.z=a.normal.z>0?e.max.z:e.min.z,a.distanceToPoint(Pb)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Gme extends Kx{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ti(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Gw=new At,Ww=new At,EF=new ki,K0=new AR,Ab=new i2,kT=new At,CF=new At;class Wme extends Qs{constructor(e=new dd,n=new Gme){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let a=1,l=n.count;a<l;a++)Gw.fromBufferAttribute(n,a-1),Ww.fromBufferAttribute(n,a),r[a]=r[a-1],r[a]+=Gw.distanceTo(Ww);e.setAttribute("lineDistance",new gc(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,a=this.matrixWorld,l=e.params.Line.threshold,u=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Ab.copy(r.boundingSphere),Ab.applyMatrix4(a),Ab.radius+=l,e.ray.intersectsSphere(Ab)===!1)return;EF.copy(a).invert(),K0.copy(e.ray).applyMatrix4(EF);const s=l/((this.scale.x+this.scale.y+this.scale.z)/3),m=s*s,_=this.isLineSegments?2:1,b=r.index,C=r.attributes.position;if(b!==null){const A=Math.max(0,u.start),k=Math.min(b.count,u.start+u.count);for(let z=A,P=k-1;z<P;z+=_){const O=b.getX(z),j=b.getX(z+1),U=Ib(this,e,K0,m,O,j,z);U&&n.push(U)}if(this.isLineLoop){const z=b.getX(k-1),P=b.getX(A),O=Ib(this,e,K0,m,z,P,k-1);O&&n.push(O)}}else{const A=Math.max(0,u.start),k=Math.min(C.count,u.start+u.count);for(let z=A,P=k-1;z<P;z+=_){const O=Ib(this,e,K0,m,z,z+1,z);O&&n.push(O)}if(this.isLineLoop){const z=Ib(this,e,K0,m,k-1,A,k-1);z&&n.push(z)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const a=n[r[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=a.length;l<u;l++){const s=a[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=l}}}}}function Ib(t,e,n,r,a,l,u){const s=t.geometry.attributes.position;if(Gw.fromBufferAttribute(s,a),Ww.fromBufferAttribute(s,l),n.distanceSqToSegment(Gw,Ww,kT,CF)>r)return;kT.applyMatrix4(t.matrixWorld);const _=e.ray.origin.distanceTo(kT);if(!(_<e.near||_>e.far))return{distance:_,point:CF.clone().applyMatrix4(t.matrixWorld),index:u,face:null,faceIndex:null,barycoord:null,object:t}}const TF=new At,PF=new At;class qme extends Wme{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[];for(let a=0,l=n.count;a<l;a+=2)TF.fromBufferAttribute(n,a),PF.fromBufferAttribute(n,a+1),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+TF.distanceTo(PF);e.setAttribute("lineDistance",new gc(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Xme extends Js{constructor(e,n,r,a,l=hc,u=hc,s,m,_){super(e,n,r,a,l,u,s,m,_),this.isVideoTexture=!0,this.generateMipmaps=!1;const b=this;function M(){b.needsUpdate=!0,e.requestVideoFrameCallback(M)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(M)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class D8 extends Js{constructor(e,n,r=kg,a,l,u,s=oh,m=oh,_,b=lx){if(b!==lx&&b!==cx)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,a,l,u,s,m,b,r,_),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new PR(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class Qx extends dd{constructor(e=1,n=1,r=1,a=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:a};const l=e/2,u=n/2,s=Math.floor(r),m=Math.floor(a),_=s+1,b=m+1,M=e/s,C=n/m,A=[],k=[],z=[],P=[];for(let O=0;O<b;O++){const j=O*C-u;for(let U=0;U<_;U++){const X=U*M-l;k.push(X,-j,0),z.push(0,0,1),P.push(U/s),P.push(1-O/m)}}for(let O=0;O<m;O++)for(let j=0;j<s;j++){const U=j+_*O,X=j+_*(O+1),K=j+1+_*(O+1),se=j+1+_*O;A.push(U,X,se),A.push(X,K,se)}this.setIndex(A),this.setAttribute("position",new gc(k,3)),this.setAttribute("normal",new gc(z,3)),this.setAttribute("uv",new gc(P,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qx(e.width,e.height,e.widthSegments,e.heightSegments)}}class n0 extends dd{constructor(e=1,n=32,r=16,a=0,l=Math.PI*2,u=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:a,phiLength:l,thetaStart:u,thetaLength:s},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const m=Math.min(u+s,Math.PI);let _=0;const b=[],M=new At,C=new At,A=[],k=[],z=[],P=[];for(let O=0;O<=r;O++){const j=[],U=O/r;let X=0;O===0&&u===0?X=.5/n:O===r&&m===Math.PI&&(X=-.5/n);for(let K=0;K<=n;K++){const se=K/n;M.x=-e*Math.cos(a+se*l)*Math.sin(u+U*s),M.y=e*Math.cos(u+U*s),M.z=e*Math.sin(a+se*l)*Math.sin(u+U*s),k.push(M.x,M.y,M.z),C.copy(M).normalize(),z.push(C.x,C.y,C.z),P.push(se+X,1-U),j.push(_++)}b.push(j)}for(let O=0;O<r;O++)for(let j=0;j<n;j++){const U=b[O][j+1],X=b[O][j],K=b[O+1][j],se=b[O+1][j+1];(O!==0||u>0)&&A.push(U,X,se),(O!==r-1||m<Math.PI)&&A.push(X,K,se)}this.setIndex(A),this.setAttribute("position",new gc(k,3)),this.setAttribute("normal",new gc(z,3)),this.setAttribute("uv",new gc(P,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Zme extends dd{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],r=new Set,a=new At,l=new At;if(e.index!==null){const u=e.attributes.position,s=e.index;let m=e.groups;m.length===0&&(m=[{start:0,count:s.count,materialIndex:0}]);for(let _=0,b=m.length;_<b;++_){const M=m[_],C=M.start,A=M.count;for(let k=C,z=C+A;k<z;k+=3)for(let P=0;P<3;P++){const O=s.getX(k+P),j=s.getX(k+(P+1)%3);a.fromBufferAttribute(u,O),l.fromBufferAttribute(u,j),AF(a,l,r)===!0&&(n.push(a.x,a.y,a.z),n.push(l.x,l.y,l.z))}}}else{const u=e.attributes.position;for(let s=0,m=u.count/3;s<m;s++)for(let _=0;_<3;_++){const b=3*s+_,M=3*s+(_+1)%3;a.fromBufferAttribute(u,b),l.fromBufferAttribute(u,M),AF(a,l,r)===!0&&(n.push(a.x,a.y,a.z),n.push(l.x,l.y,l.z))}}this.setAttribute("position",new gc(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function AF(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,a=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(r)===!0||n.has(a)===!0?!1:(n.add(r),n.add(a),!0)}class Yme extends Kx{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Vpe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Kme extends Kx{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const fA={enabled:!1};class Jme{constructor(e,n,r){const a=this;let l=!1,u=0,s=0,m;const _=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(b){s++,l===!1&&a.onStart!==void 0&&a.onStart(b,u,s),l=!0},this.itemEnd=function(b){u++,a.onProgress!==void 0&&a.onProgress(b,u,s),u===s&&(l=!1,a.onLoad!==void 0&&a.onLoad())},this.itemError=function(b){a.onError!==void 0&&a.onError(b)},this.resolveURL=function(b){return m?m(b):b},this.setURLModifier=function(b){return m=b,this},this.addHandler=function(b,M){return _.push(b,M),this},this.removeHandler=function(b){const M=_.indexOf(b);return M!==-1&&_.splice(M,2),this},this.getHandler=function(b){for(let M=0,C=_.length;M<C;M+=2){const A=_[M],k=_[M+1];if(A.global&&(A.lastIndex=0),A.test(b))return k}return null}}}const Qme=new Jme;let DR=class{constructor(e){this.manager=e!==void 0?e:Qme,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(a,l){r.load(e,a,n,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};DR.DEFAULT_MATERIAL_NAME="__DEFAULT";class ege extends I8{constructor(e=-1,n=1,r=1,a=-1,l=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=a,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,a,l,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=a,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,a=(this.top+this.bottom)/2;let l=r-e,u=r+e,s=a+n,m=a-n;if(this.view!==null&&this.view.enabled){const _=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=_*this.view.offsetX,u=l+_*this.view.width,s-=b*this.view.offsetY,m=s-b*this.view.height}this.projectionMatrix.makeOrthographic(l,u,s,m,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class tge extends ac{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}}const IF=new ki;class nge{constructor(e,n,r=0,a=1/0){this.ray=new AR(e,n),this.near=r,this.far=a,this.camera=null,this.layers=new IR,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return IF.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(IF),this}intersectObject(e,n=!0,r=[]){return pA(e,this,r,n),r.sort(RF),r}intersectObjects(e,n=!0,r=[]){for(let a=0,l=e.length;a<l;a++)pA(e[a],this,r,n);return r.sort(RF),r}}function RF(t,e){return t.distance-e.distance}function pA(t,e,n,r){let a=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(a=!1),a===!0&&r===!0){const l=t.children;for(let u=0,s=l.length;u<s;u++)pA(l[u],e,n,!0)}}function DF(t,e,n,r){const a=rge(r);switch(n){case g8:return t*e;case y8:return t*e;case _8:return t*e*2;case x8:return t*e/a.components*a.byteLength;case MR:return t*e/a.components*a.byteLength;case b8:return t*e*2/a.components*a.byteLength;case ER:return t*e*2/a.components*a.byteLength;case v8:return t*e*3/a.components*a.byteLength;case rh:return t*e*4/a.components*a.byteLength;case CR:return t*e*4/a.components*a.byteLength;case ow:case sw:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case aw:case lw:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case VP:case HP:return Math.max(t,16)*Math.max(e,8)/4;case $P:case jP:return Math.max(t,8)*Math.max(e,8)/2;case GP:case WP:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case qP:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case XP:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case ZP:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case YP:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case KP:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case JP:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case QP:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case eA:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case tA:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case nA:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case rA:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case iA:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case oA:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case sA:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case aA:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case cw:case lA:case cA:return Math.ceil(t/4)*Math.ceil(e/4)*16;case w8:case uA:return Math.ceil(t/4)*Math.ceil(e/4)*8;case hA:case dA:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function rge(t){switch(t){case vf:case f8:return{byteLength:1,components:1};case sx:case p8:case Yx:return{byteLength:2,components:1};case wR:case SR:return{byteLength:2,components:4};case kg:case bR:case lf:return{byteLength:4,components:1};case m8:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:xR}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=xR);function L8(){let t=null,e=!1,n=null,r=null;function a(l,u){n(l,u),r=t.requestAnimationFrame(a)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(a),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(l){n=l},setContext:function(l){t=l}}}function ige(t){const e=new WeakMap;function n(s,m){const _=s.array,b=s.usage,M=_.byteLength,C=t.createBuffer();t.bindBuffer(m,C),t.bufferData(m,_,b),s.onUploadCallback();let A;if(_ instanceof Float32Array)A=t.FLOAT;else if(_ instanceof Uint16Array)s.isFloat16BufferAttribute?A=t.HALF_FLOAT:A=t.UNSIGNED_SHORT;else if(_ instanceof Int16Array)A=t.SHORT;else if(_ instanceof Uint32Array)A=t.UNSIGNED_INT;else if(_ instanceof Int32Array)A=t.INT;else if(_ instanceof Int8Array)A=t.BYTE;else if(_ instanceof Uint8Array)A=t.UNSIGNED_BYTE;else if(_ instanceof Uint8ClampedArray)A=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+_);return{buffer:C,type:A,bytesPerElement:_.BYTES_PER_ELEMENT,version:s.version,size:M}}function r(s,m,_){const b=m.array,M=m.updateRanges;if(t.bindBuffer(_,s),M.length===0)t.bufferSubData(_,0,b);else{M.sort((A,k)=>A.start-k.start);let C=0;for(let A=1;A<M.length;A++){const k=M[C],z=M[A];z.start<=k.start+k.count+1?k.count=Math.max(k.count,z.start+z.count-k.start):(++C,M[C]=z)}M.length=C+1;for(let A=0,k=M.length;A<k;A++){const z=M[A];t.bufferSubData(_,z.start*b.BYTES_PER_ELEMENT,b,z.start,z.count)}m.clearUpdateRanges()}m.onUploadCallback()}function a(s){return s.isInterleavedBufferAttribute&&(s=s.data),e.get(s)}function l(s){s.isInterleavedBufferAttribute&&(s=s.data);const m=e.get(s);m&&(t.deleteBuffer(m.buffer),e.delete(s))}function u(s,m){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){const b=e.get(s);(!b||b.version<s.version)&&e.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}const _=e.get(s);if(_===void 0)e.set(s,n(s,m));else if(_.version<s.version){if(_.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(_.buffer,s,m),_.version=s.version}}return{get:a,remove:l,update:u}}var oge=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,sge=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,age=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,lge=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,cge=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,uge=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,hge=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,dge=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,fge=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,pge=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,mge=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,gge=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,vge=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,yge=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,_ge=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,xge=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,bge=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,wge=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Sge=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Mge=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Ege=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Cge=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Tge=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Pge=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Age=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Ige=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Rge=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Dge=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Lge=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,kge=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,zge="gl_FragColor = linearToOutputTexel( gl_FragColor );",Oge=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Fge=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Nge=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Bge=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Uge=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,$ge=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Vge=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,jge=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Hge=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Gge=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Wge=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,qge=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Xge=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Zge=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Yge=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Kge=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Jge=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Qge=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,eve=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,tve=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,nve=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,rve=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ive=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,ove=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,sve=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,ave=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,lve=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,cve=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,uve=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,hve=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,dve=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,fve=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,pve=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mve=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,gve=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,vve=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,yve=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,_ve=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,xve=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,bve=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,wve=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Sve=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Mve=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Eve=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Cve=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Tve=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Pve=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Ave=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Ive=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Rve=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Dve=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Lve=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,kve=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,zve=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Ove=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Fve=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Nve=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Bve=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Uve=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,$ve=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Vve=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,jve=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Hve=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Gve=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Wve=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,qve=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Xve=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Zve=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Yve=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Kve=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Jve=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Qve=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,eye=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,tye=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,nye=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,rye=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const iye=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,oye=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,aye=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,lye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cye=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,uye=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,hye=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,dye=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fye=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,pye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,mye=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gye=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,vye=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,yye=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,_ye=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xye=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bye=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wye=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Sye=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mye=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Eye=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Cye=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Tye=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Pye=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Aye=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Iye=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Rye=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dye=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Lye=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,kye=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zye=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Oye=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Fye=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Fr={alphahash_fragment:oge,alphahash_pars_fragment:sge,alphamap_fragment:age,alphamap_pars_fragment:lge,alphatest_fragment:cge,alphatest_pars_fragment:uge,aomap_fragment:hge,aomap_pars_fragment:dge,batching_pars_vertex:fge,batching_vertex:pge,begin_vertex:mge,beginnormal_vertex:gge,bsdfs:vge,iridescence_fragment:yge,bumpmap_pars_fragment:_ge,clipping_planes_fragment:xge,clipping_planes_pars_fragment:bge,clipping_planes_pars_vertex:wge,clipping_planes_vertex:Sge,color_fragment:Mge,color_pars_fragment:Ege,color_pars_vertex:Cge,color_vertex:Tge,common:Pge,cube_uv_reflection_fragment:Age,defaultnormal_vertex:Ige,displacementmap_pars_vertex:Rge,displacementmap_vertex:Dge,emissivemap_fragment:Lge,emissivemap_pars_fragment:kge,colorspace_fragment:zge,colorspace_pars_fragment:Oge,envmap_fragment:Fge,envmap_common_pars_fragment:Nge,envmap_pars_fragment:Bge,envmap_pars_vertex:Uge,envmap_physical_pars_fragment:Kge,envmap_vertex:$ge,fog_vertex:Vge,fog_pars_vertex:jge,fog_fragment:Hge,fog_pars_fragment:Gge,gradientmap_pars_fragment:Wge,lightmap_pars_fragment:qge,lights_lambert_fragment:Xge,lights_lambert_pars_fragment:Zge,lights_pars_begin:Yge,lights_toon_fragment:Jge,lights_toon_pars_fragment:Qge,lights_phong_fragment:eve,lights_phong_pars_fragment:tve,lights_physical_fragment:nve,lights_physical_pars_fragment:rve,lights_fragment_begin:ive,lights_fragment_maps:ove,lights_fragment_end:sve,logdepthbuf_fragment:ave,logdepthbuf_pars_fragment:lve,logdepthbuf_pars_vertex:cve,logdepthbuf_vertex:uve,map_fragment:hve,map_pars_fragment:dve,map_particle_fragment:fve,map_particle_pars_fragment:pve,metalnessmap_fragment:mve,metalnessmap_pars_fragment:gve,morphinstance_vertex:vve,morphcolor_vertex:yve,morphnormal_vertex:_ve,morphtarget_pars_vertex:xve,morphtarget_vertex:bve,normal_fragment_begin:wve,normal_fragment_maps:Sve,normal_pars_fragment:Mve,normal_pars_vertex:Eve,normal_vertex:Cve,normalmap_pars_fragment:Tve,clearcoat_normal_fragment_begin:Pve,clearcoat_normal_fragment_maps:Ave,clearcoat_pars_fragment:Ive,iridescence_pars_fragment:Rve,opaque_fragment:Dve,packing:Lve,premultiplied_alpha_fragment:kve,project_vertex:zve,dithering_fragment:Ove,dithering_pars_fragment:Fve,roughnessmap_fragment:Nve,roughnessmap_pars_fragment:Bve,shadowmap_pars_fragment:Uve,shadowmap_pars_vertex:$ve,shadowmap_vertex:Vve,shadowmask_pars_fragment:jve,skinbase_vertex:Hve,skinning_pars_vertex:Gve,skinning_vertex:Wve,skinnormal_vertex:qve,specularmap_fragment:Xve,specularmap_pars_fragment:Zve,tonemapping_fragment:Yve,tonemapping_pars_fragment:Kve,transmission_fragment:Jve,transmission_pars_fragment:Qve,uv_pars_fragment:eye,uv_pars_vertex:tye,uv_vertex:nye,worldpos_vertex:rye,background_vert:iye,background_frag:oye,backgroundCube_vert:sye,backgroundCube_frag:aye,cube_vert:lye,cube_frag:cye,depth_vert:uye,depth_frag:hye,distanceRGBA_vert:dye,distanceRGBA_frag:fye,equirect_vert:pye,equirect_frag:mye,linedashed_vert:gye,linedashed_frag:vye,meshbasic_vert:yye,meshbasic_frag:_ye,meshlambert_vert:xye,meshlambert_frag:bye,meshmatcap_vert:wye,meshmatcap_frag:Sye,meshnormal_vert:Mye,meshnormal_frag:Eye,meshphong_vert:Cye,meshphong_frag:Tye,meshphysical_vert:Pye,meshphysical_frag:Aye,meshtoon_vert:Iye,meshtoon_frag:Rye,points_vert:Dye,points_frag:Lye,shadow_vert:kye,shadow_frag:zye,sprite_vert:Oye,sprite_frag:Fye},Yn={common:{diffuse:{value:new Ti(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new zr},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new zr}},envmap:{envMap:{value:null},envMapRotation:{value:new zr},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new zr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new zr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new zr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new zr},normalScale:{value:new mi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new zr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new zr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new zr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new zr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ti(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ti(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0},uvTransform:{value:new zr}},sprite:{diffuse:{value:new Ti(16777215)},opacity:{value:1},center:{value:new mi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new zr},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0}}},Yh={basic:{uniforms:ja([Yn.common,Yn.specularmap,Yn.envmap,Yn.aomap,Yn.lightmap,Yn.fog]),vertexShader:Fr.meshbasic_vert,fragmentShader:Fr.meshbasic_frag},lambert:{uniforms:ja([Yn.common,Yn.specularmap,Yn.envmap,Yn.aomap,Yn.lightmap,Yn.emissivemap,Yn.bumpmap,Yn.normalmap,Yn.displacementmap,Yn.fog,Yn.lights,{emissive:{value:new Ti(0)}}]),vertexShader:Fr.meshlambert_vert,fragmentShader:Fr.meshlambert_frag},phong:{uniforms:ja([Yn.common,Yn.specularmap,Yn.envmap,Yn.aomap,Yn.lightmap,Yn.emissivemap,Yn.bumpmap,Yn.normalmap,Yn.displacementmap,Yn.fog,Yn.lights,{emissive:{value:new Ti(0)},specular:{value:new Ti(1118481)},shininess:{value:30}}]),vertexShader:Fr.meshphong_vert,fragmentShader:Fr.meshphong_frag},standard:{uniforms:ja([Yn.common,Yn.envmap,Yn.aomap,Yn.lightmap,Yn.emissivemap,Yn.bumpmap,Yn.normalmap,Yn.displacementmap,Yn.roughnessmap,Yn.metalnessmap,Yn.fog,Yn.lights,{emissive:{value:new Ti(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Fr.meshphysical_vert,fragmentShader:Fr.meshphysical_frag},toon:{uniforms:ja([Yn.common,Yn.aomap,Yn.lightmap,Yn.emissivemap,Yn.bumpmap,Yn.normalmap,Yn.displacementmap,Yn.gradientmap,Yn.fog,Yn.lights,{emissive:{value:new Ti(0)}}]),vertexShader:Fr.meshtoon_vert,fragmentShader:Fr.meshtoon_frag},matcap:{uniforms:ja([Yn.common,Yn.bumpmap,Yn.normalmap,Yn.displacementmap,Yn.fog,{matcap:{value:null}}]),vertexShader:Fr.meshmatcap_vert,fragmentShader:Fr.meshmatcap_frag},points:{uniforms:ja([Yn.points,Yn.fog]),vertexShader:Fr.points_vert,fragmentShader:Fr.points_frag},dashed:{uniforms:ja([Yn.common,Yn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fr.linedashed_vert,fragmentShader:Fr.linedashed_frag},depth:{uniforms:ja([Yn.common,Yn.displacementmap]),vertexShader:Fr.depth_vert,fragmentShader:Fr.depth_frag},normal:{uniforms:ja([Yn.common,Yn.bumpmap,Yn.normalmap,Yn.displacementmap,{opacity:{value:1}}]),vertexShader:Fr.meshnormal_vert,fragmentShader:Fr.meshnormal_frag},sprite:{uniforms:ja([Yn.sprite,Yn.fog]),vertexShader:Fr.sprite_vert,fragmentShader:Fr.sprite_frag},background:{uniforms:{uvTransform:{value:new zr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Fr.background_vert,fragmentShader:Fr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new zr}},vertexShader:Fr.backgroundCube_vert,fragmentShader:Fr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Fr.cube_vert,fragmentShader:Fr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Fr.equirect_vert,fragmentShader:Fr.equirect_frag},distanceRGBA:{uniforms:ja([Yn.common,Yn.displacementmap,{referencePosition:{value:new At},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Fr.distanceRGBA_vert,fragmentShader:Fr.distanceRGBA_frag},shadow:{uniforms:ja([Yn.lights,Yn.fog,{color:{value:new Ti(0)},opacity:{value:1}}]),vertexShader:Fr.shadow_vert,fragmentShader:Fr.shadow_frag}};Yh.physical={uniforms:ja([Yh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new zr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new zr},clearcoatNormalScale:{value:new mi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new zr},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new zr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new zr},sheen:{value:0},sheenColor:{value:new Ti(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new zr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new zr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new zr},transmissionSamplerSize:{value:new mi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new zr},attenuationDistance:{value:0},attenuationColor:{value:new Ti(0)},specularColor:{value:new Ti(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new zr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new zr},anisotropyVector:{value:new mi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new zr}}]),vertexShader:Fr.meshphysical_vert,fragmentShader:Fr.meshphysical_frag};const Rb={r:0,b:0,g:0},dg=new ud,Nye=new ki;function Bye(t,e,n,r,a,l,u){const s=new Ti(0);let m=l===!0?0:1,_,b,M=null,C=0,A=null;function k(U){let X=U.isScene===!0?U.background:null;return X&&X.isTexture&&(X=(U.backgroundBlurriness>0?n:e).get(X)),X}function z(U){let X=!1;const K=k(U);K===null?O(s,m):K&&K.isColor&&(O(K,1),X=!0);const se=t.xr.getEnvironmentBlendMode();se==="additive"?r.buffers.color.setClear(0,0,0,1,u):se==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,u),(t.autoClear||X)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function P(U,X){const K=k(X);K&&(K.isCubeTexture||K.mapping===r2)?(b===void 0&&(b=new wl(new Jx(1,1,1),new yf({name:"BackgroundCubeMaterial",uniforms:Gy(Yh.backgroundCube.uniforms),vertexShader:Yh.backgroundCube.vertexShader,fragmentShader:Yh.backgroundCube.fragmentShader,side:El,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),b.geometry.deleteAttribute("normal"),b.geometry.deleteAttribute("uv"),b.onBeforeRender=function(se,J,ue){this.matrixWorld.copyPosition(ue.matrixWorld)},Object.defineProperty(b.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(b)),dg.copy(X.backgroundRotation),dg.x*=-1,dg.y*=-1,dg.z*=-1,K.isCubeTexture&&K.isRenderTargetTexture===!1&&(dg.y*=-1,dg.z*=-1),b.material.uniforms.envMap.value=K,b.material.uniforms.flipEnvMap.value=K.isCubeTexture&&K.isRenderTargetTexture===!1?-1:1,b.material.uniforms.backgroundBlurriness.value=X.backgroundBlurriness,b.material.uniforms.backgroundIntensity.value=X.backgroundIntensity,b.material.uniforms.backgroundRotation.value.setFromMatrix4(Nye.makeRotationFromEuler(dg)),b.material.toneMapped=oi.getTransfer(K.colorSpace)!==Fi,(M!==K||C!==K.version||A!==t.toneMapping)&&(b.material.needsUpdate=!0,M=K,C=K.version,A=t.toneMapping),b.layers.enableAll(),U.unshift(b,b.geometry,b.material,0,0,null)):K&&K.isTexture&&(_===void 0&&(_=new wl(new Qx(2,2),new yf({name:"BackgroundMaterial",uniforms:Gy(Yh.background.uniforms),vertexShader:Yh.background.vertexShader,fragmentShader:Yh.background.fragmentShader,side:tm,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),_.geometry.deleteAttribute("normal"),Object.defineProperty(_.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(_)),_.material.uniforms.t2D.value=K,_.material.uniforms.backgroundIntensity.value=X.backgroundIntensity,_.material.toneMapped=oi.getTransfer(K.colorSpace)!==Fi,K.matrixAutoUpdate===!0&&K.updateMatrix(),_.material.uniforms.uvTransform.value.copy(K.matrix),(M!==K||C!==K.version||A!==t.toneMapping)&&(_.material.needsUpdate=!0,M=K,C=K.version,A=t.toneMapping),_.layers.enableAll(),U.unshift(_,_.geometry,_.material,0,0,null))}function O(U,X){U.getRGB(Rb,A8(t)),r.buffers.color.setClear(Rb.r,Rb.g,Rb.b,X,u)}function j(){b!==void 0&&(b.geometry.dispose(),b.material.dispose(),b=void 0),_!==void 0&&(_.geometry.dispose(),_.material.dispose(),_=void 0)}return{getClearColor:function(){return s},setClearColor:function(U,X=1){s.set(U),m=X,O(s,m)},getClearAlpha:function(){return m},setClearAlpha:function(U){m=U,O(s,m)},render:z,addToRenderList:P,dispose:j}}function Uye(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r={},a=C(null);let l=a,u=!1;function s(H,de,Ee,Pe,Ze){let ke=!1;const Te=M(Pe,Ee,de);l!==Te&&(l=Te,_(l.object)),ke=A(H,Pe,Ee,Ze),ke&&k(H,Pe,Ee,Ze),Ze!==null&&e.update(Ze,t.ELEMENT_ARRAY_BUFFER),(ke||u)&&(u=!1,X(H,de,Ee,Pe),Ze!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(Ze).buffer))}function m(){return t.createVertexArray()}function _(H){return t.bindVertexArray(H)}function b(H){return t.deleteVertexArray(H)}function M(H,de,Ee){const Pe=Ee.wireframe===!0;let Ze=r[H.id];Ze===void 0&&(Ze={},r[H.id]=Ze);let ke=Ze[de.id];ke===void 0&&(ke={},Ze[de.id]=ke);let Te=ke[Pe];return Te===void 0&&(Te=C(m()),ke[Pe]=Te),Te}function C(H){const de=[],Ee=[],Pe=[];for(let Ze=0;Ze<n;Ze++)de[Ze]=0,Ee[Ze]=0,Pe[Ze]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:de,enabledAttributes:Ee,attributeDivisors:Pe,object:H,attributes:{},index:null}}function A(H,de,Ee,Pe){const Ze=l.attributes,ke=de.attributes;let Te=0;const Ie=Ee.getAttributes();for(const Ce in Ie)if(Ie[Ce].location>=0){const nt=Ze[Ce];let Le=ke[Ce];if(Le===void 0&&(Ce==="instanceMatrix"&&H.instanceMatrix&&(Le=H.instanceMatrix),Ce==="instanceColor"&&H.instanceColor&&(Le=H.instanceColor)),nt===void 0||nt.attribute!==Le||Le&&nt.data!==Le.data)return!0;Te++}return l.attributesNum!==Te||l.index!==Pe}function k(H,de,Ee,Pe){const Ze={},ke=de.attributes;let Te=0;const Ie=Ee.getAttributes();for(const Ce in Ie)if(Ie[Ce].location>=0){let nt=ke[Ce];nt===void 0&&(Ce==="instanceMatrix"&&H.instanceMatrix&&(nt=H.instanceMatrix),Ce==="instanceColor"&&H.instanceColor&&(nt=H.instanceColor));const Le={};Le.attribute=nt,nt&&nt.data&&(Le.data=nt.data),Ze[Ce]=Le,Te++}l.attributes=Ze,l.attributesNum=Te,l.index=Pe}function z(){const H=l.newAttributes;for(let de=0,Ee=H.length;de<Ee;de++)H[de]=0}function P(H){O(H,0)}function O(H,de){const Ee=l.newAttributes,Pe=l.enabledAttributes,Ze=l.attributeDivisors;Ee[H]=1,Pe[H]===0&&(t.enableVertexAttribArray(H),Pe[H]=1),Ze[H]!==de&&(t.vertexAttribDivisor(H,de),Ze[H]=de)}function j(){const H=l.newAttributes,de=l.enabledAttributes;for(let Ee=0,Pe=de.length;Ee<Pe;Ee++)de[Ee]!==H[Ee]&&(t.disableVertexAttribArray(Ee),de[Ee]=0)}function U(H,de,Ee,Pe,Ze,ke,Te){Te===!0?t.vertexAttribIPointer(H,de,Ee,Ze,ke):t.vertexAttribPointer(H,de,Ee,Pe,Ze,ke)}function X(H,de,Ee,Pe){z();const Ze=Pe.attributes,ke=Ee.getAttributes(),Te=de.defaultAttributeValues;for(const Ie in ke){const Ce=ke[Ie];if(Ce.location>=0){let Ue=Ze[Ie];if(Ue===void 0&&(Ie==="instanceMatrix"&&H.instanceMatrix&&(Ue=H.instanceMatrix),Ie==="instanceColor"&&H.instanceColor&&(Ue=H.instanceColor)),Ue!==void 0){const nt=Ue.normalized,Le=Ue.itemSize,lt=e.get(Ue);if(lt===void 0)continue;const Ht=lt.buffer,He=lt.type,pt=lt.bytesPerElement,_t=He===t.INT||He===t.UNSIGNED_INT||Ue.gpuType===bR;if(Ue.isInterleavedBufferAttribute){const ot=Ue.data,et=ot.stride,Mt=Ue.offset;if(ot.isInstancedInterleavedBuffer){for(let Tt=0;Tt<Ce.locationSize;Tt++)O(Ce.location+Tt,ot.meshPerAttribute);H.isInstancedMesh!==!0&&Pe._maxInstanceCount===void 0&&(Pe._maxInstanceCount=ot.meshPerAttribute*ot.count)}else for(let Tt=0;Tt<Ce.locationSize;Tt++)P(Ce.location+Tt);t.bindBuffer(t.ARRAY_BUFFER,Ht);for(let Tt=0;Tt<Ce.locationSize;Tt++)U(Ce.location+Tt,Le/Ce.locationSize,He,nt,et*pt,(Mt+Le/Ce.locationSize*Tt)*pt,_t)}else{if(Ue.isInstancedBufferAttribute){for(let ot=0;ot<Ce.locationSize;ot++)O(Ce.location+ot,Ue.meshPerAttribute);H.isInstancedMesh!==!0&&Pe._maxInstanceCount===void 0&&(Pe._maxInstanceCount=Ue.meshPerAttribute*Ue.count)}else for(let ot=0;ot<Ce.locationSize;ot++)P(Ce.location+ot);t.bindBuffer(t.ARRAY_BUFFER,Ht);for(let ot=0;ot<Ce.locationSize;ot++)U(Ce.location+ot,Le/Ce.locationSize,He,nt,Le*pt,Le/Ce.locationSize*ot*pt,_t)}}else if(Te!==void 0){const nt=Te[Ie];if(nt!==void 0)switch(nt.length){case 2:t.vertexAttrib2fv(Ce.location,nt);break;case 3:t.vertexAttrib3fv(Ce.location,nt);break;case 4:t.vertexAttrib4fv(Ce.location,nt);break;default:t.vertexAttrib1fv(Ce.location,nt)}}}}j()}function K(){ue();for(const H in r){const de=r[H];for(const Ee in de){const Pe=de[Ee];for(const Ze in Pe)b(Pe[Ze].object),delete Pe[Ze];delete de[Ee]}delete r[H]}}function se(H){if(r[H.id]===void 0)return;const de=r[H.id];for(const Ee in de){const Pe=de[Ee];for(const Ze in Pe)b(Pe[Ze].object),delete Pe[Ze];delete de[Ee]}delete r[H.id]}function J(H){for(const de in r){const Ee=r[de];if(Ee[H.id]===void 0)continue;const Pe=Ee[H.id];for(const Ze in Pe)b(Pe[Ze].object),delete Pe[Ze];delete Ee[H.id]}}function ue(){ne(),u=!0,l!==a&&(l=a,_(l.object))}function ne(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:s,reset:ue,resetDefaultState:ne,dispose:K,releaseStatesOfGeometry:se,releaseStatesOfProgram:J,initAttributes:z,enableAttribute:P,disableUnusedAttributes:j}}function $ye(t,e,n){let r;function a(_){r=_}function l(_,b){t.drawArrays(r,_,b),n.update(b,r,1)}function u(_,b,M){M!==0&&(t.drawArraysInstanced(r,_,b,M),n.update(b,r,M))}function s(_,b,M){if(M===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,_,0,b,0,M);let A=0;for(let k=0;k<M;k++)A+=b[k];n.update(A,r,1)}function m(_,b,M,C){if(M===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let k=0;k<_.length;k++)u(_[k],b[k],C[k]);else{A.multiDrawArraysInstancedWEBGL(r,_,0,b,0,C,0,M);let k=0;for(let z=0;z<M;z++)k+=b[z]*C[z];n.update(k,r,1)}}this.setMode=a,this.render=l,this.renderInstances=u,this.renderMultiDraw=s,this.renderMultiDrawInstances=m}function Vye(t,e,n,r){let a;function l(){if(a!==void 0)return a;if(e.has("EXT_texture_filter_anisotropic")===!0){const J=e.get("EXT_texture_filter_anisotropic");a=t.getParameter(J.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a}function u(J){return!(J!==rh&&r.convert(J)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(J){const ue=J===Yx&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(J!==vf&&r.convert(J)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&J!==lf&&!ue)}function m(J){if(J==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";J="mediump"}return J==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let _=n.precision!==void 0?n.precision:"highp";const b=m(_);b!==_&&(console.warn("THREE.WebGLRenderer:",_,"not supported, using",b,"instead."),_=b);const M=n.logarithmicDepthBuffer===!0,C=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),A=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),k=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),z=t.getParameter(t.MAX_TEXTURE_SIZE),P=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),O=t.getParameter(t.MAX_VERTEX_ATTRIBS),j=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),U=t.getParameter(t.MAX_VARYING_VECTORS),X=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),K=k>0,se=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:l,getMaxPrecision:m,textureFormatReadable:u,textureTypeReadable:s,precision:_,logarithmicDepthBuffer:M,reverseDepthBuffer:C,maxTextures:A,maxVertexTextures:k,maxTextureSize:z,maxCubemapSize:P,maxAttributes:O,maxVertexUniforms:j,maxVaryings:U,maxFragmentUniforms:X,vertexTextures:K,maxSamples:se}}function jye(t){const e=this;let n=null,r=0,a=!1,l=!1;const u=new mg,s=new zr,m={value:null,needsUpdate:!1};this.uniform=m,this.numPlanes=0,this.numIntersection=0,this.init=function(M,C){const A=M.length!==0||C||r!==0||a;return a=C,r=M.length,A},this.beginShadows=function(){l=!0,b(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(M,C){n=b(M,C,0)},this.setState=function(M,C,A){const k=M.clippingPlanes,z=M.clipIntersection,P=M.clipShadows,O=t.get(M);if(!a||k===null||k.length===0||l&&!P)l?b(null):_();else{const j=l?0:r,U=j*4;let X=O.clippingState||null;m.value=X,X=b(k,C,U,A);for(let K=0;K!==U;++K)X[K]=n[K];O.clippingState=X,this.numIntersection=z?this.numPlanes:0,this.numPlanes+=j}};function _(){m.value!==n&&(m.value=n,m.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function b(M,C,A,k){const z=M!==null?M.length:0;let P=null;if(z!==0){if(P=m.value,k!==!0||P===null){const O=A+z*4,j=C.matrixWorldInverse;s.getNormalMatrix(j),(P===null||P.length<O)&&(P=new Float32Array(O));for(let U=0,X=A;U!==z;++U,X+=4)u.copy(M[U]).applyMatrix4(j,s),u.normal.toArray(P,X),P[X+3]=u.constant}m.value=P,m.needsUpdate=!0}return e.numPlanes=z,e.numIntersection=0,P}}function Hye(t){let e=new WeakMap;function n(u,s){return s===FP?u.mapping=jy:s===NP&&(u.mapping=Hy),u}function r(u){if(u&&u.isTexture){const s=u.mapping;if(s===FP||s===NP)if(e.has(u)){const m=e.get(u).texture;return n(m,u.mapping)}else{const m=u.image;if(m&&m.height>0){const _=new $me(m.height);return _.fromEquirectangularTexture(t,u),e.set(u,_),u.addEventListener("dispose",a),n(_.texture,u.mapping)}else return null}}return u}function a(u){const s=u.target;s.removeEventListener("dispose",a);const m=e.get(s);m!==void 0&&(e.delete(s),m.dispose())}function l(){e=new WeakMap}return{get:r,dispose:l}}const fy=4,LF=[.125,.215,.35,.446,.526,.582],xg=20,zT=new ege,kF=new Ti;let OT=null,FT=0,NT=0,BT=!1;const gg=(1+Math.sqrt(5))/2,Wv=1/gg,zF=[new At(-gg,Wv,0),new At(gg,Wv,0),new At(-Wv,0,gg),new At(Wv,0,gg),new At(0,gg,-Wv),new At(0,gg,Wv),new At(-1,1,-1),new At(1,1,-1),new At(-1,1,1),new At(1,1,1)],Gye=new At;class OF{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,a=100,l={}){const{size:u=256,position:s=Gye}=l;OT=this._renderer.getRenderTarget(),FT=this._renderer.getActiveCubeFace(),NT=this._renderer.getActiveMipmapLevel(),BT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(u);const m=this._allocateTargets();return m.depthBuffer=!0,this._sceneToCubeUV(e,r,a,m,s),n>0&&this._blur(m,0,0,n),this._applyPMREM(m),this._cleanup(m),m}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=BF(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=NF(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(OT,FT,NT),this._renderer.xr.enabled=BT,e.scissorTest=!1,Db(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===jy||e.mapping===Hy?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),OT=this._renderer.getRenderTarget(),FT=this._renderer.getActiveCubeFace(),NT=this._renderer.getActiveMipmapLevel(),BT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:hc,minFilter:hc,generateMipmaps:!1,type:Yx,format:rh,colorSpace:zg,depthBuffer:!1},a=FF(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=FF(e,n,r);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Wye(l)),this._blurMaterial=qye(l,e,n)}return a}_compileMaterial(e){const n=new wl(this._lodPlanes[0],e);this._renderer.compile(n,zT)}_sceneToCubeUV(e,n,r,a,l){const m=new ac(90,1,n,r),_=[1,-1,1,1,1,1],b=[1,1,1,-1,-1,-1],M=this._renderer,C=M.autoClear,A=M.toneMapping;M.getClearColor(kF),M.toneMapping=Wp,M.autoClear=!1;const k=new rm({name:"PMREM.Background",side:El,depthWrite:!1,depthTest:!1}),z=new wl(new Jx,k);let P=!1;const O=e.background;O?O.isColor&&(k.color.copy(O),e.background=null,P=!0):(k.color.copy(kF),P=!0);for(let j=0;j<6;j++){const U=j%3;U===0?(m.up.set(0,_[j],0),m.position.set(l.x,l.y,l.z),m.lookAt(l.x+b[j],l.y,l.z)):U===1?(m.up.set(0,0,_[j]),m.position.set(l.x,l.y,l.z),m.lookAt(l.x,l.y+b[j],l.z)):(m.up.set(0,_[j],0),m.position.set(l.x,l.y,l.z),m.lookAt(l.x,l.y,l.z+b[j]));const X=this._cubeSize;Db(a,U*X,j>2?X:0,X,X),M.setRenderTarget(a),P&&M.render(z,m),M.render(e,m)}z.geometry.dispose(),z.material.dispose(),M.toneMapping=A,M.autoClear=C,e.background=O}_textureToCubeUV(e,n){const r=this._renderer,a=e.mapping===jy||e.mapping===Hy;a?(this._cubemapMaterial===null&&(this._cubemapMaterial=BF()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=NF());const l=a?this._cubemapMaterial:this._equirectMaterial,u=new wl(this._lodPlanes[0],l),s=l.uniforms;s.envMap.value=e;const m=this._cubeSize;Db(n,0,0,3*m,2*m),r.setRenderTarget(n),r.render(u,zT)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const a=this._lodPlanes.length;for(let l=1;l<a;l++){const u=Math.sqrt(this._sigmas[l]*this._sigmas[l]-this._sigmas[l-1]*this._sigmas[l-1]),s=zF[(a-l-1)%zF.length];this._blur(e,l-1,l,u,s)}n.autoClear=r}_blur(e,n,r,a,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,n,r,a,"latitudinal",l),this._halfBlur(u,e,r,r,a,"longitudinal",l)}_halfBlur(e,n,r,a,l,u,s){const m=this._renderer,_=this._blurMaterial;u!=="latitudinal"&&u!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const b=3,M=new wl(this._lodPlanes[a],_),C=_.uniforms,A=this._sizeLods[r]-1,k=isFinite(l)?Math.PI/(2*A):2*Math.PI/(2*xg-1),z=l/k,P=isFinite(l)?1+Math.floor(b*z):xg;P>xg&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${P} samples when the maximum is set to ${xg}`);const O=[];let j=0;for(let J=0;J<xg;++J){const ue=J/z,ne=Math.exp(-ue*ue/2);O.push(ne),J===0?j+=ne:J<P&&(j+=2*ne)}for(let J=0;J<O.length;J++)O[J]=O[J]/j;C.envMap.value=e.texture,C.samples.value=P,C.weights.value=O,C.latitudinal.value=u==="latitudinal",s&&(C.poleAxis.value=s);const{_lodMax:U}=this;C.dTheta.value=k,C.mipInt.value=U-r;const X=this._sizeLods[a],K=3*X*(a>U-fy?a-U+fy:0),se=4*(this._cubeSize-X);Db(n,K,se,3*X,2*X),m.setRenderTarget(n),m.render(M,zT)}}function Wye(t){const e=[],n=[],r=[];let a=t;const l=t-fy+1+LF.length;for(let u=0;u<l;u++){const s=Math.pow(2,a);n.push(s);let m=1/s;u>t-fy?m=LF[u-t+fy-1]:u===0&&(m=0),r.push(m);const _=1/(s-2),b=-_,M=1+_,C=[b,b,M,b,M,M,b,b,M,M,b,M],A=6,k=6,z=3,P=2,O=1,j=new Float32Array(z*k*A),U=new Float32Array(P*k*A),X=new Float32Array(O*k*A);for(let se=0;se<A;se++){const J=se%3*2/3-1,ue=se>2?0:-1,ne=[J,ue,0,J+2/3,ue,0,J+2/3,ue+1,0,J,ue,0,J+2/3,ue+1,0,J,ue+1,0];j.set(ne,z*k*se),U.set(C,P*k*se);const H=[se,se,se,se,se,se];X.set(H,O*k*se)}const K=new dd;K.setAttribute("position",new id(j,z)),K.setAttribute("uv",new id(U,P)),K.setAttribute("faceIndex",new id(X,O)),e.push(K),a>fy&&a--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function FF(t,e,n){const r=new nm(t,e,n);return r.texture.mapping=r2,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Db(t,e,n,r,a){t.viewport.set(e,n,r,a),t.scissor.set(e,n,r,a)}function qye(t,e,n){const r=new Float32Array(xg),a=new At(0,1,0);return new yf({name:"SphericalGaussianBlur",defines:{n:xg,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:LR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Gp,depthTest:!1,depthWrite:!1})}function NF(){return new yf({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:LR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Gp,depthTest:!1,depthWrite:!1})}function BF(){return new yf({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:LR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Gp,depthTest:!1,depthWrite:!1})}function LR(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Xye(t){let e=new WeakMap,n=null;function r(s){if(s&&s.isTexture){const m=s.mapping,_=m===FP||m===NP,b=m===jy||m===Hy;if(_||b){let M=e.get(s);const C=M!==void 0?M.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==C)return n===null&&(n=new OF(t)),M=_?n.fromEquirectangular(s,M):n.fromCubemap(s,M),M.texture.pmremVersion=s.pmremVersion,e.set(s,M),M.texture;if(M!==void 0)return M.texture;{const A=s.image;return _&&A&&A.height>0||b&&A&&a(A)?(n===null&&(n=new OF(t)),M=_?n.fromEquirectangular(s):n.fromCubemap(s),M.texture.pmremVersion=s.pmremVersion,e.set(s,M),s.addEventListener("dispose",l),M.texture):null}}}return s}function a(s){let m=0;const _=6;for(let b=0;b<_;b++)s[b]!==void 0&&m++;return m===_}function l(s){const m=s.target;m.removeEventListener("dispose",l);const _=e.get(m);_!==void 0&&(e.delete(m),_.dispose())}function u(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:u}}function Zye(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let a;switch(r){case"WEBGL_depth_texture":a=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=t.getExtension(r)}return e[r]=a,a}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const a=n(r);return a===null&&uw("THREE.WebGLRenderer: "+r+" extension not supported."),a}}}function Yye(t,e,n,r){const a={},l=new WeakMap;function u(M){const C=M.target;C.index!==null&&e.remove(C.index);for(const k in C.attributes)e.remove(C.attributes[k]);C.removeEventListener("dispose",u),delete a[C.id];const A=l.get(C);A&&(e.remove(A),l.delete(C)),r.releaseStatesOfGeometry(C),C.isInstancedBufferGeometry===!0&&delete C._maxInstanceCount,n.memory.geometries--}function s(M,C){return a[C.id]===!0||(C.addEventListener("dispose",u),a[C.id]=!0,n.memory.geometries++),C}function m(M){const C=M.attributes;for(const A in C)e.update(C[A],t.ARRAY_BUFFER)}function _(M){const C=[],A=M.index,k=M.attributes.position;let z=0;if(A!==null){const j=A.array;z=A.version;for(let U=0,X=j.length;U<X;U+=3){const K=j[U+0],se=j[U+1],J=j[U+2];C.push(K,se,se,J,J,K)}}else if(k!==void 0){const j=k.array;z=k.version;for(let U=0,X=j.length/3-1;U<X;U+=3){const K=U+0,se=U+1,J=U+2;C.push(K,se,se,J,J,K)}}else return;const P=new(M8(C)?P8:T8)(C,1);P.version=z;const O=l.get(M);O&&e.remove(O),l.set(M,P)}function b(M){const C=l.get(M);if(C){const A=M.index;A!==null&&C.version<A.version&&_(M)}else _(M);return l.get(M)}return{get:s,update:m,getWireframeAttribute:b}}function Kye(t,e,n){let r;function a(C){r=C}let l,u;function s(C){l=C.type,u=C.bytesPerElement}function m(C,A){t.drawElements(r,A,l,C*u),n.update(A,r,1)}function _(C,A,k){k!==0&&(t.drawElementsInstanced(r,A,l,C*u,k),n.update(A,r,k))}function b(C,A,k){if(k===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,A,0,l,C,0,k);let P=0;for(let O=0;O<k;O++)P+=A[O];n.update(P,r,1)}function M(C,A,k,z){if(k===0)return;const P=e.get("WEBGL_multi_draw");if(P===null)for(let O=0;O<C.length;O++)_(C[O]/u,A[O],z[O]);else{P.multiDrawElementsInstancedWEBGL(r,A,0,l,C,0,z,0,k);let O=0;for(let j=0;j<k;j++)O+=A[j]*z[j];n.update(O,r,1)}}this.setMode=a,this.setIndex=s,this.render=m,this.renderInstances=_,this.renderMultiDraw=b,this.renderMultiDrawInstances=M}function Jye(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(l,u,s){switch(n.calls++,u){case t.TRIANGLES:n.triangles+=s*(l/3);break;case t.LINES:n.lines+=s*(l/2);break;case t.LINE_STRIP:n.lines+=s*(l-1);break;case t.LINE_LOOP:n.lines+=s*l;break;case t.POINTS:n.points+=s*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u);break}}function a(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:a,update:r}}function Qye(t,e,n){const r=new WeakMap,a=new $o;function l(u,s,m){const _=u.morphTargetInfluences,b=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,M=b!==void 0?b.length:0;let C=r.get(s);if(C===void 0||C.count!==M){let H=function(){ue.dispose(),r.delete(s),s.removeEventListener("dispose",H)};var A=H;C!==void 0&&C.texture.dispose();const k=s.morphAttributes.position!==void 0,z=s.morphAttributes.normal!==void 0,P=s.morphAttributes.color!==void 0,O=s.morphAttributes.position||[],j=s.morphAttributes.normal||[],U=s.morphAttributes.color||[];let X=0;k===!0&&(X=1),z===!0&&(X=2),P===!0&&(X=3);let K=s.attributes.position.count*X,se=1;K>e.maxTextureSize&&(se=Math.ceil(K/e.maxTextureSize),K=e.maxTextureSize);const J=new Float32Array(K*se*4*M),ue=new E8(J,K,se,M);ue.type=lf,ue.needsUpdate=!0;const ne=X*4;for(let de=0;de<M;de++){const Ee=O[de],Pe=j[de],Ze=U[de],ke=K*se*4*de;for(let Te=0;Te<Ee.count;Te++){const Ie=Te*ne;k===!0&&(a.fromBufferAttribute(Ee,Te),J[ke+Ie+0]=a.x,J[ke+Ie+1]=a.y,J[ke+Ie+2]=a.z,J[ke+Ie+3]=0),z===!0&&(a.fromBufferAttribute(Pe,Te),J[ke+Ie+4]=a.x,J[ke+Ie+5]=a.y,J[ke+Ie+6]=a.z,J[ke+Ie+7]=0),P===!0&&(a.fromBufferAttribute(Ze,Te),J[ke+Ie+8]=a.x,J[ke+Ie+9]=a.y,J[ke+Ie+10]=a.z,J[ke+Ie+11]=Ze.itemSize===4?a.w:1)}}C={count:M,texture:ue,size:new mi(K,se)},r.set(s,C),s.addEventListener("dispose",H)}if(u.isInstancedMesh===!0&&u.morphTexture!==null)m.getUniforms().setValue(t,"morphTexture",u.morphTexture,n);else{let k=0;for(let P=0;P<_.length;P++)k+=_[P];const z=s.morphTargetsRelative?1:1-k;m.getUniforms().setValue(t,"morphTargetBaseInfluence",z),m.getUniforms().setValue(t,"morphTargetInfluences",_)}m.getUniforms().setValue(t,"morphTargetsTexture",C.texture,n),m.getUniforms().setValue(t,"morphTargetsTextureSize",C.size)}return{update:l}}function e0e(t,e,n,r){let a=new WeakMap;function l(m){const _=r.render.frame,b=m.geometry,M=e.get(m,b);if(a.get(M)!==_&&(e.update(M),a.set(M,_)),m.isInstancedMesh&&(m.hasEventListener("dispose",s)===!1&&m.addEventListener("dispose",s),a.get(m)!==_&&(n.update(m.instanceMatrix,t.ARRAY_BUFFER),m.instanceColor!==null&&n.update(m.instanceColor,t.ARRAY_BUFFER),a.set(m,_))),m.isSkinnedMesh){const C=m.skeleton;a.get(C)!==_&&(C.update(),a.set(C,_))}return M}function u(){a=new WeakMap}function s(m){const _=m.target;_.removeEventListener("dispose",s),n.remove(_.instanceMatrix),_.instanceColor!==null&&n.remove(_.instanceColor)}return{update:l,dispose:u}}const k8=new Js,UF=new D8(1,1),z8=new E8,O8=new Mme,F8=new R8,$F=[],VF=[],jF=new Float32Array(16),HF=new Float32Array(9),GF=new Float32Array(4);function r0(t,e,n){const r=t[0];if(r<=0||r>0)return t;const a=e*n;let l=$F[a];if(l===void 0&&(l=new Float32Array(a),$F[a]=l),e!==0){r.toArray(l,0);for(let u=1,s=0;u!==e;++u)s+=n,t[u].toArray(l,s)}return l}function vs(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function ys(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function o2(t,e){let n=VF[e];n===void 0&&(n=new Int32Array(e),VF[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function t0e(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function n0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(vs(n,e))return;t.uniform2fv(this.addr,e),ys(n,e)}}function r0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(vs(n,e))return;t.uniform3fv(this.addr,e),ys(n,e)}}function i0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(vs(n,e))return;t.uniform4fv(this.addr,e),ys(n,e)}}function o0e(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(vs(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),ys(n,e)}else{if(vs(n,r))return;GF.set(r),t.uniformMatrix2fv(this.addr,!1,GF),ys(n,r)}}function s0e(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(vs(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),ys(n,e)}else{if(vs(n,r))return;HF.set(r),t.uniformMatrix3fv(this.addr,!1,HF),ys(n,r)}}function a0e(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(vs(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),ys(n,e)}else{if(vs(n,r))return;jF.set(r),t.uniformMatrix4fv(this.addr,!1,jF),ys(n,r)}}function l0e(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function c0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(vs(n,e))return;t.uniform2iv(this.addr,e),ys(n,e)}}function u0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(vs(n,e))return;t.uniform3iv(this.addr,e),ys(n,e)}}function h0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(vs(n,e))return;t.uniform4iv(this.addr,e),ys(n,e)}}function d0e(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function f0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(vs(n,e))return;t.uniform2uiv(this.addr,e),ys(n,e)}}function p0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(vs(n,e))return;t.uniform3uiv(this.addr,e),ys(n,e)}}function m0e(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(vs(n,e))return;t.uniform4uiv(this.addr,e),ys(n,e)}}function g0e(t,e,n){const r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(t.uniform1i(this.addr,a),r[0]=a);let l;this.type===t.SAMPLER_2D_SHADOW?(UF.compareFunction=S8,l=UF):l=k8,n.setTexture2D(e||l,a)}function v0e(t,e,n){const r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(t.uniform1i(this.addr,a),r[0]=a),n.setTexture3D(e||O8,a)}function y0e(t,e,n){const r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(t.uniform1i(this.addr,a),r[0]=a),n.setTextureCube(e||F8,a)}function _0e(t,e,n){const r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(t.uniform1i(this.addr,a),r[0]=a),n.setTexture2DArray(e||z8,a)}function x0e(t){switch(t){case 5126:return t0e;case 35664:return n0e;case 35665:return r0e;case 35666:return i0e;case 35674:return o0e;case 35675:return s0e;case 35676:return a0e;case 5124:case 35670:return l0e;case 35667:case 35671:return c0e;case 35668:case 35672:return u0e;case 35669:case 35673:return h0e;case 5125:return d0e;case 36294:return f0e;case 36295:return p0e;case 36296:return m0e;case 35678:case 36198:case 36298:case 36306:case 35682:return g0e;case 35679:case 36299:case 36307:return v0e;case 35680:case 36300:case 36308:case 36293:return y0e;case 36289:case 36303:case 36311:case 36292:return _0e}}function b0e(t,e){t.uniform1fv(this.addr,e)}function w0e(t,e){const n=r0(e,this.size,2);t.uniform2fv(this.addr,n)}function S0e(t,e){const n=r0(e,this.size,3);t.uniform3fv(this.addr,n)}function M0e(t,e){const n=r0(e,this.size,4);t.uniform4fv(this.addr,n)}function E0e(t,e){const n=r0(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function C0e(t,e){const n=r0(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function T0e(t,e){const n=r0(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function P0e(t,e){t.uniform1iv(this.addr,e)}function A0e(t,e){t.uniform2iv(this.addr,e)}function I0e(t,e){t.uniform3iv(this.addr,e)}function R0e(t,e){t.uniform4iv(this.addr,e)}function D0e(t,e){t.uniform1uiv(this.addr,e)}function L0e(t,e){t.uniform2uiv(this.addr,e)}function k0e(t,e){t.uniform3uiv(this.addr,e)}function z0e(t,e){t.uniform4uiv(this.addr,e)}function O0e(t,e,n){const r=this.cache,a=e.length,l=o2(n,a);vs(r,l)||(t.uniform1iv(this.addr,l),ys(r,l));for(let u=0;u!==a;++u)n.setTexture2D(e[u]||k8,l[u])}function F0e(t,e,n){const r=this.cache,a=e.length,l=o2(n,a);vs(r,l)||(t.uniform1iv(this.addr,l),ys(r,l));for(let u=0;u!==a;++u)n.setTexture3D(e[u]||O8,l[u])}function N0e(t,e,n){const r=this.cache,a=e.length,l=o2(n,a);vs(r,l)||(t.uniform1iv(this.addr,l),ys(r,l));for(let u=0;u!==a;++u)n.setTextureCube(e[u]||F8,l[u])}function B0e(t,e,n){const r=this.cache,a=e.length,l=o2(n,a);vs(r,l)||(t.uniform1iv(this.addr,l),ys(r,l));for(let u=0;u!==a;++u)n.setTexture2DArray(e[u]||z8,l[u])}function U0e(t){switch(t){case 5126:return b0e;case 35664:return w0e;case 35665:return S0e;case 35666:return M0e;case 35674:return E0e;case 35675:return C0e;case 35676:return T0e;case 5124:case 35670:return P0e;case 35667:case 35671:return A0e;case 35668:case 35672:return I0e;case 35669:case 35673:return R0e;case 5125:return D0e;case 36294:return L0e;case 36295:return k0e;case 36296:return z0e;case 35678:case 36198:case 36298:case 36306:case 35682:return O0e;case 35679:case 36299:case 36307:return F0e;case 35680:case 36300:case 36308:case 36293:return N0e;case 36289:case 36303:case 36311:case 36292:return B0e}}class $0e{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=x0e(n.type)}}class V0e{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=U0e(n.type)}}class j0e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const a=this.seq;for(let l=0,u=a.length;l!==u;++l){const s=a[l];s.setValue(e,n[s.id],r)}}}const UT=/(\w+)(\])?(\[|\.)?/g;function WF(t,e){t.seq.push(e),t.map[e.id]=e}function H0e(t,e,n){const r=t.name,a=r.length;for(UT.lastIndex=0;;){const l=UT.exec(r),u=UT.lastIndex;let s=l[1];const m=l[2]==="]",_=l[3];if(m&&(s=s|0),_===void 0||_==="["&&u+2===a){WF(n,_===void 0?new $0e(s,t,e):new V0e(s,t,e));break}else{let M=n.map[s];M===void 0&&(M=new j0e(s),WF(n,M)),n=M}}}class hw{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let a=0;a<r;++a){const l=e.getActiveUniform(n,a),u=e.getUniformLocation(n,l.name);H0e(l,u,this)}}setValue(e,n,r,a){const l=this.map[n];l!==void 0&&l.setValue(e,r,a)}setOptional(e,n,r){const a=n[r];a!==void 0&&this.setValue(e,r,a)}static upload(e,n,r,a){for(let l=0,u=n.length;l!==u;++l){const s=n[l],m=r[s.id];m.needsUpdate!==!1&&s.setValue(e,m.value,a)}}static seqWithValue(e,n){const r=[];for(let a=0,l=e.length;a!==l;++a){const u=e[a];u.id in n&&r.push(u)}return r}}function qF(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const G0e=37297;let W0e=0;function q0e(t,e){const n=t.split(`
`),r=[],a=Math.max(e-6,0),l=Math.min(e+6,n.length);for(let u=a;u<l;u++){const s=u+1;r.push(`${s===e?">":" "} ${s}: ${n[u]}`)}return r.join(`
`)}const XF=new zr;function X0e(t){oi._getMatrix(XF,oi.workingColorSpace,t);const e=`mat3( ${XF.elements.map(n=>n.toFixed(4))} )`;switch(oi.getTransfer(t)){case $w:return[e,"LinearTransferOETF"];case Fi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function ZF(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),a=t.getShaderInfoLog(e).trim();if(r&&a==="")return"";const l=/ERROR: 0:(\d+)/.exec(a);if(l){const u=parseInt(l[1]);return n.toUpperCase()+`

`+a+`

`+q0e(t.getShaderSource(e),u)}else return a}function Z0e(t,e){const n=X0e(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function Y0e(t,e){let n;switch(e){case h8:n="Linear";break;case zpe:n="Reinhard";break;case Ope:n="Cineon";break;case Fpe:n="ACESFilmic";break;case Bpe:n="AgX";break;case Upe:n="Neutral";break;case Npe:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Lb=new At;function K0e(){oi.getLuminanceCoefficients(Lb);const t=Lb.x.toFixed(4),e=Lb.y.toFixed(4),n=Lb.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function J0e(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(d_).join(`
`)}function Q0e(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function e_e(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let a=0;a<r;a++){const l=t.getActiveAttrib(e,a),u=l.name;let s=1;l.type===t.FLOAT_MAT2&&(s=2),l.type===t.FLOAT_MAT3&&(s=3),l.type===t.FLOAT_MAT4&&(s=4),n[u]={type:l.type,location:t.getAttribLocation(e,u),locationSize:s}}return n}function d_(t){return t!==""}function YF(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function KF(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const t_e=/^[ \t]*#include +<([\w\d./]+)>/gm;function mA(t){return t.replace(t_e,r_e)}const n_e=new Map;function r_e(t,e){let n=Fr[e];if(n===void 0){const r=n_e.get(e);if(r!==void 0)n=Fr[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return mA(n)}const i_e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function JF(t){return t.replace(i_e,o_e)}function o_e(t,e,n,r){let a="";for(let l=parseInt(e);l<parseInt(n);l++)a+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return a}function QF(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function s_e(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===c8?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===ppe?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===of&&(e="SHADOWMAP_TYPE_VSM"),e}function a_e(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case jy:case Hy:e="ENVMAP_TYPE_CUBE";break;case r2:e="ENVMAP_TYPE_CUBE_UV";break}return e}function l_e(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Hy:e="ENVMAP_MODE_REFRACTION";break}return e}function c_e(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case u8:e="ENVMAP_BLENDING_MULTIPLY";break;case Lpe:e="ENVMAP_BLENDING_MIX";break;case kpe:e="ENVMAP_BLENDING_ADD";break}return e}function u_e(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function h_e(t,e,n,r){const a=t.getContext(),l=n.defines;let u=n.vertexShader,s=n.fragmentShader;const m=s_e(n),_=a_e(n),b=l_e(n),M=c_e(n),C=u_e(n),A=J0e(n),k=Q0e(l),z=a.createProgram();let P,O,j=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(P=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,k].filter(d_).join(`
`),P.length>0&&(P+=`
`),O=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,k].filter(d_).join(`
`),O.length>0&&(O+=`
`)):(P=[QF(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,k,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+b:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+m:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(d_).join(`
`),O=[QF(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,k,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+_:"",n.envMap?"#define "+b:"",n.envMap?"#define "+M:"",C?"#define CUBEUV_TEXEL_WIDTH "+C.texelWidth:"",C?"#define CUBEUV_TEXEL_HEIGHT "+C.texelHeight:"",C?"#define CUBEUV_MAX_MIP "+C.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+m:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Wp?"#define TONE_MAPPING":"",n.toneMapping!==Wp?Fr.tonemapping_pars_fragment:"",n.toneMapping!==Wp?Y0e("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Fr.colorspace_pars_fragment,Z0e("linearToOutputTexel",n.outputColorSpace),K0e(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(d_).join(`
`)),u=mA(u),u=YF(u,n),u=KF(u,n),s=mA(s),s=YF(s,n),s=KF(s,n),u=JF(u),s=JF(s),n.isRawShaderMaterial!==!0&&(j=`#version 300 es
`,P=[A,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+P,O=["#define varying in",n.glslVersion===sF?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===sF?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+O);const U=j+P+u,X=j+O+s,K=qF(a,a.VERTEX_SHADER,U),se=qF(a,a.FRAGMENT_SHADER,X);a.attachShader(z,K),a.attachShader(z,se),n.index0AttributeName!==void 0?a.bindAttribLocation(z,0,n.index0AttributeName):n.morphTargets===!0&&a.bindAttribLocation(z,0,"position"),a.linkProgram(z);function J(de){if(t.debug.checkShaderErrors){const Ee=a.getProgramInfoLog(z).trim(),Pe=a.getShaderInfoLog(K).trim(),Ze=a.getShaderInfoLog(se).trim();let ke=!0,Te=!0;if(a.getProgramParameter(z,a.LINK_STATUS)===!1)if(ke=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(a,z,K,se);else{const Ie=ZF(a,K,"vertex"),Ce=ZF(a,se,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(z,a.VALIDATE_STATUS)+`

Material Name: `+de.name+`
Material Type: `+de.type+`

Program Info Log: `+Ee+`
`+Ie+`
`+Ce)}else Ee!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Ee):(Pe===""||Ze==="")&&(Te=!1);Te&&(de.diagnostics={runnable:ke,programLog:Ee,vertexShader:{log:Pe,prefix:P},fragmentShader:{log:Ze,prefix:O}})}a.deleteShader(K),a.deleteShader(se),ue=new hw(a,z),ne=e_e(a,z)}let ue;this.getUniforms=function(){return ue===void 0&&J(this),ue};let ne;this.getAttributes=function(){return ne===void 0&&J(this),ne};let H=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return H===!1&&(H=a.getProgramParameter(z,G0e)),H},this.destroy=function(){r.releaseStatesOfProgram(this),a.deleteProgram(z),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=W0e++,this.cacheKey=e,this.usedTimes=1,this.program=z,this.vertexShader=K,this.fragmentShader=se,this}let d_e=0;class f_e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,a=this._getShaderStage(n),l=this._getShaderStage(r),u=this._getShaderCacheForMaterial(e);return u.has(a)===!1&&(u.add(a),a.usedTimes++),u.has(l)===!1&&(u.add(l),l.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new p_e(e),n.set(e,r)),r}}class p_e{constructor(e){this.id=d_e++,this.code=e,this.usedTimes=0}}function m_e(t,e,n,r,a,l,u){const s=new IR,m=new f_e,_=new Set,b=[],M=a.logarithmicDepthBuffer,C=a.vertexTextures;let A=a.precision;const k={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function z(ne){return _.add(ne),ne===0?"uv":`uv${ne}`}function P(ne,H,de,Ee,Pe){const Ze=Ee.fog,ke=Pe.geometry,Te=ne.isMeshStandardMaterial?Ee.environment:null,Ie=(ne.isMeshStandardMaterial?n:e).get(ne.envMap||Te),Ce=Ie&&Ie.mapping===r2?Ie.image.height:null,Ue=k[ne.type];ne.precision!==null&&(A=a.getMaxPrecision(ne.precision),A!==ne.precision&&console.warn("THREE.WebGLProgram.getParameters:",ne.precision,"not supported, using",A,"instead."));const nt=ke.morphAttributes.position||ke.morphAttributes.normal||ke.morphAttributes.color,Le=nt!==void 0?nt.length:0;let lt=0;ke.morphAttributes.position!==void 0&&(lt=1),ke.morphAttributes.normal!==void 0&&(lt=2),ke.morphAttributes.color!==void 0&&(lt=3);let Ht,He,pt,_t;if(Ue){const cn=Yh[Ue];Ht=cn.vertexShader,He=cn.fragmentShader}else Ht=ne.vertexShader,He=ne.fragmentShader,m.update(ne),pt=m.getVertexShaderID(ne),_t=m.getFragmentShaderID(ne);const ot=t.getRenderTarget(),et=t.state.buffers.depth.getReversed(),Mt=Pe.isInstancedMesh===!0,Tt=Pe.isBatchedMesh===!0,hn=!!ne.map,en=!!ne.matcap,an=!!Ie,Ke=!!ne.aoMap,An=!!ne.lightMap,Gt=!!ne.bumpMap,on=!!ne.normalMap,Wt=!!ne.displacementMap,Gn=!!ne.emissiveMap,dn=!!ne.metalnessMap,Ve=!!ne.roughnessMap,Se=ne.anisotropy>0,bt=ne.clearcoat>0,Nt=ne.dispersion>0,jt=ne.iridescence>0,Ut=ne.sheen>0,yn=ne.transmission>0,Zt=Se&&!!ne.anisotropyMap,qt=bt&&!!ne.clearcoatMap,Fn=bt&&!!ne.clearcoatNormalMap,Be=bt&&!!ne.clearcoatRoughnessMap,ee=jt&&!!ne.iridescenceMap,oe=jt&&!!ne.iridescenceThicknessMap,fe=Ut&&!!ne.sheenColorMap,he=Ut&&!!ne.sheenRoughnessMap,xe=!!ne.specularMap,Ye=!!ne.specularColorMap,st=!!ne.specularIntensityMap,_e=yn&&!!ne.transmissionMap,Fe=yn&&!!ne.thicknessMap,Ge=!!ne.gradientMap,je=!!ne.alphaMap,De=ne.alphaTest>0,zt=!!ne.alphaHash,fn=!!ne.extensions;let sn=Wp;ne.toneMapped&&(ot===null||ot.isXRRenderTarget===!0)&&(sn=t.toneMapping);const Jt={shaderID:Ue,shaderType:ne.type,shaderName:ne.name,vertexShader:Ht,fragmentShader:He,defines:ne.defines,customVertexShaderID:pt,customFragmentShaderID:_t,isRawShaderMaterial:ne.isRawShaderMaterial===!0,glslVersion:ne.glslVersion,precision:A,batching:Tt,batchingColor:Tt&&Pe._colorsTexture!==null,instancing:Mt,instancingColor:Mt&&Pe.instanceColor!==null,instancingMorph:Mt&&Pe.morphTexture!==null,supportsVertexTextures:C,outputColorSpace:ot===null?t.outputColorSpace:ot.isXRRenderTarget===!0?ot.texture.colorSpace:zg,alphaToCoverage:!!ne.alphaToCoverage,map:hn,matcap:en,envMap:an,envMapMode:an&&Ie.mapping,envMapCubeUVHeight:Ce,aoMap:Ke,lightMap:An,bumpMap:Gt,normalMap:on,displacementMap:C&&Wt,emissiveMap:Gn,normalMapObjectSpace:on&&ne.normalMapType===Gpe,normalMapTangentSpace:on&&ne.normalMapType===Hpe,metalnessMap:dn,roughnessMap:Ve,anisotropy:Se,anisotropyMap:Zt,clearcoat:bt,clearcoatMap:qt,clearcoatNormalMap:Fn,clearcoatRoughnessMap:Be,dispersion:Nt,iridescence:jt,iridescenceMap:ee,iridescenceThicknessMap:oe,sheen:Ut,sheenColorMap:fe,sheenRoughnessMap:he,specularMap:xe,specularColorMap:Ye,specularIntensityMap:st,transmission:yn,transmissionMap:_e,thicknessMap:Fe,gradientMap:Ge,opaque:ne.transparent===!1&&ne.blending===Ey&&ne.alphaToCoverage===!1,alphaMap:je,alphaTest:De,alphaHash:zt,combine:ne.combine,mapUv:hn&&z(ne.map.channel),aoMapUv:Ke&&z(ne.aoMap.channel),lightMapUv:An&&z(ne.lightMap.channel),bumpMapUv:Gt&&z(ne.bumpMap.channel),normalMapUv:on&&z(ne.normalMap.channel),displacementMapUv:Wt&&z(ne.displacementMap.channel),emissiveMapUv:Gn&&z(ne.emissiveMap.channel),metalnessMapUv:dn&&z(ne.metalnessMap.channel),roughnessMapUv:Ve&&z(ne.roughnessMap.channel),anisotropyMapUv:Zt&&z(ne.anisotropyMap.channel),clearcoatMapUv:qt&&z(ne.clearcoatMap.channel),clearcoatNormalMapUv:Fn&&z(ne.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Be&&z(ne.clearcoatRoughnessMap.channel),iridescenceMapUv:ee&&z(ne.iridescenceMap.channel),iridescenceThicknessMapUv:oe&&z(ne.iridescenceThicknessMap.channel),sheenColorMapUv:fe&&z(ne.sheenColorMap.channel),sheenRoughnessMapUv:he&&z(ne.sheenRoughnessMap.channel),specularMapUv:xe&&z(ne.specularMap.channel),specularColorMapUv:Ye&&z(ne.specularColorMap.channel),specularIntensityMapUv:st&&z(ne.specularIntensityMap.channel),transmissionMapUv:_e&&z(ne.transmissionMap.channel),thicknessMapUv:Fe&&z(ne.thicknessMap.channel),alphaMapUv:je&&z(ne.alphaMap.channel),vertexTangents:!!ke.attributes.tangent&&(on||Se),vertexColors:ne.vertexColors,vertexAlphas:ne.vertexColors===!0&&!!ke.attributes.color&&ke.attributes.color.itemSize===4,pointsUvs:Pe.isPoints===!0&&!!ke.attributes.uv&&(hn||je),fog:!!Ze,useFog:ne.fog===!0,fogExp2:!!Ze&&Ze.isFogExp2,flatShading:ne.flatShading===!0,sizeAttenuation:ne.sizeAttenuation===!0,logarithmicDepthBuffer:M,reverseDepthBuffer:et,skinning:Pe.isSkinnedMesh===!0,morphTargets:ke.morphAttributes.position!==void 0,morphNormals:ke.morphAttributes.normal!==void 0,morphColors:ke.morphAttributes.color!==void 0,morphTargetsCount:Le,morphTextureStride:lt,numDirLights:H.directional.length,numPointLights:H.point.length,numSpotLights:H.spot.length,numSpotLightMaps:H.spotLightMap.length,numRectAreaLights:H.rectArea.length,numHemiLights:H.hemi.length,numDirLightShadows:H.directionalShadowMap.length,numPointLightShadows:H.pointShadowMap.length,numSpotLightShadows:H.spotShadowMap.length,numSpotLightShadowsWithMaps:H.numSpotLightShadowsWithMaps,numLightProbes:H.numLightProbes,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:ne.dithering,shadowMapEnabled:t.shadowMap.enabled&&de.length>0,shadowMapType:t.shadowMap.type,toneMapping:sn,decodeVideoTexture:hn&&ne.map.isVideoTexture===!0&&oi.getTransfer(ne.map.colorSpace)===Fi,decodeVideoTextureEmissive:Gn&&ne.emissiveMap.isVideoTexture===!0&&oi.getTransfer(ne.emissiveMap.colorSpace)===Fi,premultipliedAlpha:ne.premultipliedAlpha,doubleSided:ne.side===af,flipSided:ne.side===El,useDepthPacking:ne.depthPacking>=0,depthPacking:ne.depthPacking||0,index0AttributeName:ne.index0AttributeName,extensionClipCullDistance:fn&&ne.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(fn&&ne.extensions.multiDraw===!0||Tt)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:ne.customProgramCacheKey()};return Jt.vertexUv1s=_.has(1),Jt.vertexUv2s=_.has(2),Jt.vertexUv3s=_.has(3),_.clear(),Jt}function O(ne){const H=[];if(ne.shaderID?H.push(ne.shaderID):(H.push(ne.customVertexShaderID),H.push(ne.customFragmentShaderID)),ne.defines!==void 0)for(const de in ne.defines)H.push(de),H.push(ne.defines[de]);return ne.isRawShaderMaterial===!1&&(j(H,ne),U(H,ne),H.push(t.outputColorSpace)),H.push(ne.customProgramCacheKey),H.join()}function j(ne,H){ne.push(H.precision),ne.push(H.outputColorSpace),ne.push(H.envMapMode),ne.push(H.envMapCubeUVHeight),ne.push(H.mapUv),ne.push(H.alphaMapUv),ne.push(H.lightMapUv),ne.push(H.aoMapUv),ne.push(H.bumpMapUv),ne.push(H.normalMapUv),ne.push(H.displacementMapUv),ne.push(H.emissiveMapUv),ne.push(H.metalnessMapUv),ne.push(H.roughnessMapUv),ne.push(H.anisotropyMapUv),ne.push(H.clearcoatMapUv),ne.push(H.clearcoatNormalMapUv),ne.push(H.clearcoatRoughnessMapUv),ne.push(H.iridescenceMapUv),ne.push(H.iridescenceThicknessMapUv),ne.push(H.sheenColorMapUv),ne.push(H.sheenRoughnessMapUv),ne.push(H.specularMapUv),ne.push(H.specularColorMapUv),ne.push(H.specularIntensityMapUv),ne.push(H.transmissionMapUv),ne.push(H.thicknessMapUv),ne.push(H.combine),ne.push(H.fogExp2),ne.push(H.sizeAttenuation),ne.push(H.morphTargetsCount),ne.push(H.morphAttributeCount),ne.push(H.numDirLights),ne.push(H.numPointLights),ne.push(H.numSpotLights),ne.push(H.numSpotLightMaps),ne.push(H.numHemiLights),ne.push(H.numRectAreaLights),ne.push(H.numDirLightShadows),ne.push(H.numPointLightShadows),ne.push(H.numSpotLightShadows),ne.push(H.numSpotLightShadowsWithMaps),ne.push(H.numLightProbes),ne.push(H.shadowMapType),ne.push(H.toneMapping),ne.push(H.numClippingPlanes),ne.push(H.numClipIntersection),ne.push(H.depthPacking)}function U(ne,H){s.disableAll(),H.supportsVertexTextures&&s.enable(0),H.instancing&&s.enable(1),H.instancingColor&&s.enable(2),H.instancingMorph&&s.enable(3),H.matcap&&s.enable(4),H.envMap&&s.enable(5),H.normalMapObjectSpace&&s.enable(6),H.normalMapTangentSpace&&s.enable(7),H.clearcoat&&s.enable(8),H.iridescence&&s.enable(9),H.alphaTest&&s.enable(10),H.vertexColors&&s.enable(11),H.vertexAlphas&&s.enable(12),H.vertexUv1s&&s.enable(13),H.vertexUv2s&&s.enable(14),H.vertexUv3s&&s.enable(15),H.vertexTangents&&s.enable(16),H.anisotropy&&s.enable(17),H.alphaHash&&s.enable(18),H.batching&&s.enable(19),H.dispersion&&s.enable(20),H.batchingColor&&s.enable(21),ne.push(s.mask),s.disableAll(),H.fog&&s.enable(0),H.useFog&&s.enable(1),H.flatShading&&s.enable(2),H.logarithmicDepthBuffer&&s.enable(3),H.reverseDepthBuffer&&s.enable(4),H.skinning&&s.enable(5),H.morphTargets&&s.enable(6),H.morphNormals&&s.enable(7),H.morphColors&&s.enable(8),H.premultipliedAlpha&&s.enable(9),H.shadowMapEnabled&&s.enable(10),H.doubleSided&&s.enable(11),H.flipSided&&s.enable(12),H.useDepthPacking&&s.enable(13),H.dithering&&s.enable(14),H.transmission&&s.enable(15),H.sheen&&s.enable(16),H.opaque&&s.enable(17),H.pointsUvs&&s.enable(18),H.decodeVideoTexture&&s.enable(19),H.decodeVideoTextureEmissive&&s.enable(20),H.alphaToCoverage&&s.enable(21),ne.push(s.mask)}function X(ne){const H=k[ne.type];let de;if(H){const Ee=Yh[H];de=Fme.clone(Ee.uniforms)}else de=ne.uniforms;return de}function K(ne,H){let de;for(let Ee=0,Pe=b.length;Ee<Pe;Ee++){const Ze=b[Ee];if(Ze.cacheKey===H){de=Ze,++de.usedTimes;break}}return de===void 0&&(de=new h_e(t,H,ne,l),b.push(de)),de}function se(ne){if(--ne.usedTimes===0){const H=b.indexOf(ne);b[H]=b[b.length-1],b.pop(),ne.destroy()}}function J(ne){m.remove(ne)}function ue(){m.dispose()}return{getParameters:P,getProgramCacheKey:O,getUniforms:X,acquireProgram:K,releaseProgram:se,releaseShaderCache:J,programs:b,dispose:ue}}function g_e(){let t=new WeakMap;function e(u){return t.has(u)}function n(u){let s=t.get(u);return s===void 0&&(s={},t.set(u,s)),s}function r(u){t.delete(u)}function a(u,s,m){t.get(u)[s]=m}function l(){t=new WeakMap}return{has:e,get:n,remove:r,update:a,dispose:l}}function v_e(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function e4(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function t4(){const t=[];let e=0;const n=[],r=[],a=[];function l(){e=0,n.length=0,r.length=0,a.length=0}function u(M,C,A,k,z,P){let O=t[e];return O===void 0?(O={id:M.id,object:M,geometry:C,material:A,groupOrder:k,renderOrder:M.renderOrder,z,group:P},t[e]=O):(O.id=M.id,O.object=M,O.geometry=C,O.material=A,O.groupOrder=k,O.renderOrder=M.renderOrder,O.z=z,O.group=P),e++,O}function s(M,C,A,k,z,P){const O=u(M,C,A,k,z,P);A.transmission>0?r.push(O):A.transparent===!0?a.push(O):n.push(O)}function m(M,C,A,k,z,P){const O=u(M,C,A,k,z,P);A.transmission>0?r.unshift(O):A.transparent===!0?a.unshift(O):n.unshift(O)}function _(M,C){n.length>1&&n.sort(M||v_e),r.length>1&&r.sort(C||e4),a.length>1&&a.sort(C||e4)}function b(){for(let M=e,C=t.length;M<C;M++){const A=t[M];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:n,transmissive:r,transparent:a,init:l,push:s,unshift:m,finish:b,sort:_}}function y_e(){let t=new WeakMap;function e(r,a){const l=t.get(r);let u;return l===void 0?(u=new t4,t.set(r,[u])):a>=l.length?(u=new t4,l.push(u)):u=l[a],u}function n(){t=new WeakMap}return{get:e,dispose:n}}function __e(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new At,color:new Ti};break;case"SpotLight":n={position:new At,direction:new At,color:new Ti,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new At,color:new Ti,distance:0,decay:0};break;case"HemisphereLight":n={direction:new At,skyColor:new Ti,groundColor:new Ti};break;case"RectAreaLight":n={color:new Ti,position:new At,halfWidth:new At,halfHeight:new At};break}return t[e.id]=n,n}}}function x_e(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mi};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mi};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mi,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let b_e=0;function w_e(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function S_e(t){const e=new __e,n=x_e(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let _=0;_<9;_++)r.probe.push(new At);const a=new At,l=new ki,u=new ki;function s(_){let b=0,M=0,C=0;for(let ne=0;ne<9;ne++)r.probe[ne].set(0,0,0);let A=0,k=0,z=0,P=0,O=0,j=0,U=0,X=0,K=0,se=0,J=0;_.sort(w_e);for(let ne=0,H=_.length;ne<H;ne++){const de=_[ne],Ee=de.color,Pe=de.intensity,Ze=de.distance,ke=de.shadow&&de.shadow.map?de.shadow.map.texture:null;if(de.isAmbientLight)b+=Ee.r*Pe,M+=Ee.g*Pe,C+=Ee.b*Pe;else if(de.isLightProbe){for(let Te=0;Te<9;Te++)r.probe[Te].addScaledVector(de.sh.coefficients[Te],Pe);J++}else if(de.isDirectionalLight){const Te=e.get(de);if(Te.color.copy(de.color).multiplyScalar(de.intensity),de.castShadow){const Ie=de.shadow,Ce=n.get(de);Ce.shadowIntensity=Ie.intensity,Ce.shadowBias=Ie.bias,Ce.shadowNormalBias=Ie.normalBias,Ce.shadowRadius=Ie.radius,Ce.shadowMapSize=Ie.mapSize,r.directionalShadow[A]=Ce,r.directionalShadowMap[A]=ke,r.directionalShadowMatrix[A]=de.shadow.matrix,j++}r.directional[A]=Te,A++}else if(de.isSpotLight){const Te=e.get(de);Te.position.setFromMatrixPosition(de.matrixWorld),Te.color.copy(Ee).multiplyScalar(Pe),Te.distance=Ze,Te.coneCos=Math.cos(de.angle),Te.penumbraCos=Math.cos(de.angle*(1-de.penumbra)),Te.decay=de.decay,r.spot[z]=Te;const Ie=de.shadow;if(de.map&&(r.spotLightMap[K]=de.map,K++,Ie.updateMatrices(de),de.castShadow&&se++),r.spotLightMatrix[z]=Ie.matrix,de.castShadow){const Ce=n.get(de);Ce.shadowIntensity=Ie.intensity,Ce.shadowBias=Ie.bias,Ce.shadowNormalBias=Ie.normalBias,Ce.shadowRadius=Ie.radius,Ce.shadowMapSize=Ie.mapSize,r.spotShadow[z]=Ce,r.spotShadowMap[z]=ke,X++}z++}else if(de.isRectAreaLight){const Te=e.get(de);Te.color.copy(Ee).multiplyScalar(Pe),Te.halfWidth.set(de.width*.5,0,0),Te.halfHeight.set(0,de.height*.5,0),r.rectArea[P]=Te,P++}else if(de.isPointLight){const Te=e.get(de);if(Te.color.copy(de.color).multiplyScalar(de.intensity),Te.distance=de.distance,Te.decay=de.decay,de.castShadow){const Ie=de.shadow,Ce=n.get(de);Ce.shadowIntensity=Ie.intensity,Ce.shadowBias=Ie.bias,Ce.shadowNormalBias=Ie.normalBias,Ce.shadowRadius=Ie.radius,Ce.shadowMapSize=Ie.mapSize,Ce.shadowCameraNear=Ie.camera.near,Ce.shadowCameraFar=Ie.camera.far,r.pointShadow[k]=Ce,r.pointShadowMap[k]=ke,r.pointShadowMatrix[k]=de.shadow.matrix,U++}r.point[k]=Te,k++}else if(de.isHemisphereLight){const Te=e.get(de);Te.skyColor.copy(de.color).multiplyScalar(Pe),Te.groundColor.copy(de.groundColor).multiplyScalar(Pe),r.hemi[O]=Te,O++}}P>0&&(t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Yn.LTC_FLOAT_1,r.rectAreaLTC2=Yn.LTC_FLOAT_2):(r.rectAreaLTC1=Yn.LTC_HALF_1,r.rectAreaLTC2=Yn.LTC_HALF_2)),r.ambient[0]=b,r.ambient[1]=M,r.ambient[2]=C;const ue=r.hash;(ue.directionalLength!==A||ue.pointLength!==k||ue.spotLength!==z||ue.rectAreaLength!==P||ue.hemiLength!==O||ue.numDirectionalShadows!==j||ue.numPointShadows!==U||ue.numSpotShadows!==X||ue.numSpotMaps!==K||ue.numLightProbes!==J)&&(r.directional.length=A,r.spot.length=z,r.rectArea.length=P,r.point.length=k,r.hemi.length=O,r.directionalShadow.length=j,r.directionalShadowMap.length=j,r.pointShadow.length=U,r.pointShadowMap.length=U,r.spotShadow.length=X,r.spotShadowMap.length=X,r.directionalShadowMatrix.length=j,r.pointShadowMatrix.length=U,r.spotLightMatrix.length=X+K-se,r.spotLightMap.length=K,r.numSpotLightShadowsWithMaps=se,r.numLightProbes=J,ue.directionalLength=A,ue.pointLength=k,ue.spotLength=z,ue.rectAreaLength=P,ue.hemiLength=O,ue.numDirectionalShadows=j,ue.numPointShadows=U,ue.numSpotShadows=X,ue.numSpotMaps=K,ue.numLightProbes=J,r.version=b_e++)}function m(_,b){let M=0,C=0,A=0,k=0,z=0;const P=b.matrixWorldInverse;for(let O=0,j=_.length;O<j;O++){const U=_[O];if(U.isDirectionalLight){const X=r.directional[M];X.direction.setFromMatrixPosition(U.matrixWorld),a.setFromMatrixPosition(U.target.matrixWorld),X.direction.sub(a),X.direction.transformDirection(P),M++}else if(U.isSpotLight){const X=r.spot[A];X.position.setFromMatrixPosition(U.matrixWorld),X.position.applyMatrix4(P),X.direction.setFromMatrixPosition(U.matrixWorld),a.setFromMatrixPosition(U.target.matrixWorld),X.direction.sub(a),X.direction.transformDirection(P),A++}else if(U.isRectAreaLight){const X=r.rectArea[k];X.position.setFromMatrixPosition(U.matrixWorld),X.position.applyMatrix4(P),u.identity(),l.copy(U.matrixWorld),l.premultiply(P),u.extractRotation(l),X.halfWidth.set(U.width*.5,0,0),X.halfHeight.set(0,U.height*.5,0),X.halfWidth.applyMatrix4(u),X.halfHeight.applyMatrix4(u),k++}else if(U.isPointLight){const X=r.point[C];X.position.setFromMatrixPosition(U.matrixWorld),X.position.applyMatrix4(P),C++}else if(U.isHemisphereLight){const X=r.hemi[z];X.direction.setFromMatrixPosition(U.matrixWorld),X.direction.transformDirection(P),z++}}}return{setup:s,setupView:m,state:r}}function n4(t){const e=new S_e(t),n=[],r=[];function a(b){_.camera=b,n.length=0,r.length=0}function l(b){n.push(b)}function u(b){r.push(b)}function s(){e.setup(n)}function m(b){e.setupView(n,b)}const _={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:a,state:_,setupLights:s,setupLightsView:m,pushLight:l,pushShadow:u}}function M_e(t){let e=new WeakMap;function n(a,l=0){const u=e.get(a);let s;return u===void 0?(s=new n4(t),e.set(a,[s])):l>=u.length?(s=new n4(t),u.push(s)):s=u[l],s}function r(){e=new WeakMap}return{get:n,dispose:r}}const E_e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,C_e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function T_e(t,e,n){let r=new RR;const a=new mi,l=new mi,u=new $o,s=new Yme({depthPacking:jpe}),m=new Kme,_={},b=n.maxTextureSize,M={[tm]:El,[El]:tm,[af]:af},C=new yf({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new mi},radius:{value:4}},vertexShader:E_e,fragmentShader:C_e}),A=C.clone();A.defines.HORIZONTAL_PASS=1;const k=new dd;k.setAttribute("position",new id(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const z=new wl(k,C),P=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=c8;let O=this.type;this.render=function(se,J,ue){if(P.enabled===!1||P.autoUpdate===!1&&P.needsUpdate===!1||se.length===0)return;const ne=t.getRenderTarget(),H=t.getActiveCubeFace(),de=t.getActiveMipmapLevel(),Ee=t.state;Ee.setBlending(Gp),Ee.buffers.color.setClear(1,1,1,1),Ee.buffers.depth.setTest(!0),Ee.setScissorTest(!1);const Pe=O!==of&&this.type===of,Ze=O===of&&this.type!==of;for(let ke=0,Te=se.length;ke<Te;ke++){const Ie=se[ke],Ce=Ie.shadow;if(Ce===void 0){console.warn("THREE.WebGLShadowMap:",Ie,"has no shadow.");continue}if(Ce.autoUpdate===!1&&Ce.needsUpdate===!1)continue;a.copy(Ce.mapSize);const Ue=Ce.getFrameExtents();if(a.multiply(Ue),l.copy(Ce.mapSize),(a.x>b||a.y>b)&&(a.x>b&&(l.x=Math.floor(b/Ue.x),a.x=l.x*Ue.x,Ce.mapSize.x=l.x),a.y>b&&(l.y=Math.floor(b/Ue.y),a.y=l.y*Ue.y,Ce.mapSize.y=l.y)),Ce.map===null||Pe===!0||Ze===!0){const Le=this.type!==of?{minFilter:oh,magFilter:oh}:{};Ce.map!==null&&Ce.map.dispose(),Ce.map=new nm(a.x,a.y,Le),Ce.map.texture.name=Ie.name+".shadowMap",Ce.camera.updateProjectionMatrix()}t.setRenderTarget(Ce.map),t.clear();const nt=Ce.getViewportCount();for(let Le=0;Le<nt;Le++){const lt=Ce.getViewport(Le);u.set(l.x*lt.x,l.y*lt.y,l.x*lt.z,l.y*lt.w),Ee.viewport(u),Ce.updateMatrices(Ie,Le),r=Ce.getFrustum(),X(J,ue,Ce.camera,Ie,this.type)}Ce.isPointLightShadow!==!0&&this.type===of&&j(Ce,ue),Ce.needsUpdate=!1}O=this.type,P.needsUpdate=!1,t.setRenderTarget(ne,H,de)};function j(se,J){const ue=e.update(z);C.defines.VSM_SAMPLES!==se.blurSamples&&(C.defines.VSM_SAMPLES=se.blurSamples,A.defines.VSM_SAMPLES=se.blurSamples,C.needsUpdate=!0,A.needsUpdate=!0),se.mapPass===null&&(se.mapPass=new nm(a.x,a.y)),C.uniforms.shadow_pass.value=se.map.texture,C.uniforms.resolution.value=se.mapSize,C.uniforms.radius.value=se.radius,t.setRenderTarget(se.mapPass),t.clear(),t.renderBufferDirect(J,null,ue,C,z,null),A.uniforms.shadow_pass.value=se.mapPass.texture,A.uniforms.resolution.value=se.mapSize,A.uniforms.radius.value=se.radius,t.setRenderTarget(se.map),t.clear(),t.renderBufferDirect(J,null,ue,A,z,null)}function U(se,J,ue,ne){let H=null;const de=ue.isPointLight===!0?se.customDistanceMaterial:se.customDepthMaterial;if(de!==void 0)H=de;else if(H=ue.isPointLight===!0?m:s,t.localClippingEnabled&&J.clipShadows===!0&&Array.isArray(J.clippingPlanes)&&J.clippingPlanes.length!==0||J.displacementMap&&J.displacementScale!==0||J.alphaMap&&J.alphaTest>0||J.map&&J.alphaTest>0){const Ee=H.uuid,Pe=J.uuid;let Ze=_[Ee];Ze===void 0&&(Ze={},_[Ee]=Ze);let ke=Ze[Pe];ke===void 0&&(ke=H.clone(),Ze[Pe]=ke,J.addEventListener("dispose",K)),H=ke}if(H.visible=J.visible,H.wireframe=J.wireframe,ne===of?H.side=J.shadowSide!==null?J.shadowSide:J.side:H.side=J.shadowSide!==null?J.shadowSide:M[J.side],H.alphaMap=J.alphaMap,H.alphaTest=J.alphaTest,H.map=J.map,H.clipShadows=J.clipShadows,H.clippingPlanes=J.clippingPlanes,H.clipIntersection=J.clipIntersection,H.displacementMap=J.displacementMap,H.displacementScale=J.displacementScale,H.displacementBias=J.displacementBias,H.wireframeLinewidth=J.wireframeLinewidth,H.linewidth=J.linewidth,ue.isPointLight===!0&&H.isMeshDistanceMaterial===!0){const Ee=t.properties.get(H);Ee.light=ue}return H}function X(se,J,ue,ne,H){if(se.visible===!1)return;if(se.layers.test(J.layers)&&(se.isMesh||se.isLine||se.isPoints)&&(se.castShadow||se.receiveShadow&&H===of)&&(!se.frustumCulled||r.intersectsObject(se))){se.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse,se.matrixWorld);const Pe=e.update(se),Ze=se.material;if(Array.isArray(Ze)){const ke=Pe.groups;for(let Te=0,Ie=ke.length;Te<Ie;Te++){const Ce=ke[Te],Ue=Ze[Ce.materialIndex];if(Ue&&Ue.visible){const nt=U(se,Ue,ne,H);se.onBeforeShadow(t,se,J,ue,Pe,nt,Ce),t.renderBufferDirect(ue,null,Pe,nt,se,Ce),se.onAfterShadow(t,se,J,ue,Pe,nt,Ce)}}}else if(Ze.visible){const ke=U(se,Ze,ne,H);se.onBeforeShadow(t,se,J,ue,Pe,ke,null),t.renderBufferDirect(ue,null,Pe,ke,se,null),se.onAfterShadow(t,se,J,ue,Pe,ke,null)}}const Ee=se.children;for(let Pe=0,Ze=Ee.length;Pe<Ze;Pe++)X(Ee[Pe],J,ue,ne,H)}function K(se){se.target.removeEventListener("dispose",K);for(const ue in _){const ne=_[ue],H=se.target.uuid;H in ne&&(ne[H].dispose(),delete ne[H])}}}const P_e={[IP]:RP,[DP]:zP,[LP]:OP,[Vy]:kP,[RP]:IP,[zP]:DP,[OP]:LP,[kP]:Vy};function A_e(t,e){function n(){let _e=!1;const Fe=new $o;let Ge=null;const je=new $o(0,0,0,0);return{setMask:function(De){Ge!==De&&!_e&&(t.colorMask(De,De,De,De),Ge=De)},setLocked:function(De){_e=De},setClear:function(De,zt,fn,sn,Jt){Jt===!0&&(De*=sn,zt*=sn,fn*=sn),Fe.set(De,zt,fn,sn),je.equals(Fe)===!1&&(t.clearColor(De,zt,fn,sn),je.copy(Fe))},reset:function(){_e=!1,Ge=null,je.set(-1,0,0,0)}}}function r(){let _e=!1,Fe=!1,Ge=null,je=null,De=null;return{setReversed:function(zt){if(Fe!==zt){const fn=e.get("EXT_clip_control");zt?fn.clipControlEXT(fn.LOWER_LEFT_EXT,fn.ZERO_TO_ONE_EXT):fn.clipControlEXT(fn.LOWER_LEFT_EXT,fn.NEGATIVE_ONE_TO_ONE_EXT),Fe=zt;const sn=De;De=null,this.setClear(sn)}},getReversed:function(){return Fe},setTest:function(zt){zt?ot(t.DEPTH_TEST):et(t.DEPTH_TEST)},setMask:function(zt){Ge!==zt&&!_e&&(t.depthMask(zt),Ge=zt)},setFunc:function(zt){if(Fe&&(zt=P_e[zt]),je!==zt){switch(zt){case IP:t.depthFunc(t.NEVER);break;case RP:t.depthFunc(t.ALWAYS);break;case DP:t.depthFunc(t.LESS);break;case Vy:t.depthFunc(t.LEQUAL);break;case LP:t.depthFunc(t.EQUAL);break;case kP:t.depthFunc(t.GEQUAL);break;case zP:t.depthFunc(t.GREATER);break;case OP:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}je=zt}},setLocked:function(zt){_e=zt},setClear:function(zt){De!==zt&&(Fe&&(zt=1-zt),t.clearDepth(zt),De=zt)},reset:function(){_e=!1,Ge=null,je=null,De=null,Fe=!1}}}function a(){let _e=!1,Fe=null,Ge=null,je=null,De=null,zt=null,fn=null,sn=null,Jt=null;return{setTest:function(cn){_e||(cn?ot(t.STENCIL_TEST):et(t.STENCIL_TEST))},setMask:function(cn){Fe!==cn&&!_e&&(t.stencilMask(cn),Fe=cn)},setFunc:function(cn,Zn,yr){(Ge!==cn||je!==Zn||De!==yr)&&(t.stencilFunc(cn,Zn,yr),Ge=cn,je=Zn,De=yr)},setOp:function(cn,Zn,yr){(zt!==cn||fn!==Zn||sn!==yr)&&(t.stencilOp(cn,Zn,yr),zt=cn,fn=Zn,sn=yr)},setLocked:function(cn){_e=cn},setClear:function(cn){Jt!==cn&&(t.clearStencil(cn),Jt=cn)},reset:function(){_e=!1,Fe=null,Ge=null,je=null,De=null,zt=null,fn=null,sn=null,Jt=null}}}const l=new n,u=new r,s=new a,m=new WeakMap,_=new WeakMap;let b={},M={},C=new WeakMap,A=[],k=null,z=!1,P=null,O=null,j=null,U=null,X=null,K=null,se=null,J=new Ti(0,0,0),ue=0,ne=!1,H=null,de=null,Ee=null,Pe=null,Ze=null;const ke=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Te=!1,Ie=0;const Ce=t.getParameter(t.VERSION);Ce.indexOf("WebGL")!==-1?(Ie=parseFloat(/^WebGL (\d)/.exec(Ce)[1]),Te=Ie>=1):Ce.indexOf("OpenGL ES")!==-1&&(Ie=parseFloat(/^OpenGL ES (\d)/.exec(Ce)[1]),Te=Ie>=2);let Ue=null,nt={};const Le=t.getParameter(t.SCISSOR_BOX),lt=t.getParameter(t.VIEWPORT),Ht=new $o().fromArray(Le),He=new $o().fromArray(lt);function pt(_e,Fe,Ge,je){const De=new Uint8Array(4),zt=t.createTexture();t.bindTexture(_e,zt),t.texParameteri(_e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(_e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let fn=0;fn<Ge;fn++)_e===t.TEXTURE_3D||_e===t.TEXTURE_2D_ARRAY?t.texImage3D(Fe,0,t.RGBA,1,1,je,0,t.RGBA,t.UNSIGNED_BYTE,De):t.texImage2D(Fe+fn,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,De);return zt}const _t={};_t[t.TEXTURE_2D]=pt(t.TEXTURE_2D,t.TEXTURE_2D,1),_t[t.TEXTURE_CUBE_MAP]=pt(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),_t[t.TEXTURE_2D_ARRAY]=pt(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),_t[t.TEXTURE_3D]=pt(t.TEXTURE_3D,t.TEXTURE_3D,1,1),l.setClear(0,0,0,1),u.setClear(1),s.setClear(0),ot(t.DEPTH_TEST),u.setFunc(Vy),Gt(!1),on(eF),ot(t.CULL_FACE),Ke(Gp);function ot(_e){b[_e]!==!0&&(t.enable(_e),b[_e]=!0)}function et(_e){b[_e]!==!1&&(t.disable(_e),b[_e]=!1)}function Mt(_e,Fe){return M[_e]!==Fe?(t.bindFramebuffer(_e,Fe),M[_e]=Fe,_e===t.DRAW_FRAMEBUFFER&&(M[t.FRAMEBUFFER]=Fe),_e===t.FRAMEBUFFER&&(M[t.DRAW_FRAMEBUFFER]=Fe),!0):!1}function Tt(_e,Fe){let Ge=A,je=!1;if(_e){Ge=C.get(Fe),Ge===void 0&&(Ge=[],C.set(Fe,Ge));const De=_e.textures;if(Ge.length!==De.length||Ge[0]!==t.COLOR_ATTACHMENT0){for(let zt=0,fn=De.length;zt<fn;zt++)Ge[zt]=t.COLOR_ATTACHMENT0+zt;Ge.length=De.length,je=!0}}else Ge[0]!==t.BACK&&(Ge[0]=t.BACK,je=!0);je&&t.drawBuffers(Ge)}function hn(_e){return k!==_e?(t.useProgram(_e),k=_e,!0):!1}const en={[_g]:t.FUNC_ADD,[gpe]:t.FUNC_SUBTRACT,[vpe]:t.FUNC_REVERSE_SUBTRACT};en[ype]=t.MIN,en[_pe]=t.MAX;const an={[xpe]:t.ZERO,[bpe]:t.ONE,[wpe]:t.SRC_COLOR,[PP]:t.SRC_ALPHA,[Ppe]:t.SRC_ALPHA_SATURATE,[Cpe]:t.DST_COLOR,[Mpe]:t.DST_ALPHA,[Spe]:t.ONE_MINUS_SRC_COLOR,[AP]:t.ONE_MINUS_SRC_ALPHA,[Tpe]:t.ONE_MINUS_DST_COLOR,[Epe]:t.ONE_MINUS_DST_ALPHA,[Ape]:t.CONSTANT_COLOR,[Ipe]:t.ONE_MINUS_CONSTANT_COLOR,[Rpe]:t.CONSTANT_ALPHA,[Dpe]:t.ONE_MINUS_CONSTANT_ALPHA};function Ke(_e,Fe,Ge,je,De,zt,fn,sn,Jt,cn){if(_e===Gp){z===!0&&(et(t.BLEND),z=!1);return}if(z===!1&&(ot(t.BLEND),z=!0),_e!==mpe){if(_e!==P||cn!==ne){if((O!==_g||X!==_g)&&(t.blendEquation(t.FUNC_ADD),O=_g,X=_g),cn)switch(_e){case Ey:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case tF:t.blendFunc(t.ONE,t.ONE);break;case nF:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case rF:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}else switch(_e){case Ey:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case tF:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case nF:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case rF:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}j=null,U=null,K=null,se=null,J.set(0,0,0),ue=0,P=_e,ne=cn}return}De=De||Fe,zt=zt||Ge,fn=fn||je,(Fe!==O||De!==X)&&(t.blendEquationSeparate(en[Fe],en[De]),O=Fe,X=De),(Ge!==j||je!==U||zt!==K||fn!==se)&&(t.blendFuncSeparate(an[Ge],an[je],an[zt],an[fn]),j=Ge,U=je,K=zt,se=fn),(sn.equals(J)===!1||Jt!==ue)&&(t.blendColor(sn.r,sn.g,sn.b,Jt),J.copy(sn),ue=Jt),P=_e,ne=!1}function An(_e,Fe){_e.side===af?et(t.CULL_FACE):ot(t.CULL_FACE);let Ge=_e.side===El;Fe&&(Ge=!Ge),Gt(Ge),_e.blending===Ey&&_e.transparent===!1?Ke(Gp):Ke(_e.blending,_e.blendEquation,_e.blendSrc,_e.blendDst,_e.blendEquationAlpha,_e.blendSrcAlpha,_e.blendDstAlpha,_e.blendColor,_e.blendAlpha,_e.premultipliedAlpha),u.setFunc(_e.depthFunc),u.setTest(_e.depthTest),u.setMask(_e.depthWrite),l.setMask(_e.colorWrite);const je=_e.stencilWrite;s.setTest(je),je&&(s.setMask(_e.stencilWriteMask),s.setFunc(_e.stencilFunc,_e.stencilRef,_e.stencilFuncMask),s.setOp(_e.stencilFail,_e.stencilZFail,_e.stencilZPass)),Gn(_e.polygonOffset,_e.polygonOffsetFactor,_e.polygonOffsetUnits),_e.alphaToCoverage===!0?ot(t.SAMPLE_ALPHA_TO_COVERAGE):et(t.SAMPLE_ALPHA_TO_COVERAGE)}function Gt(_e){H!==_e&&(_e?t.frontFace(t.CW):t.frontFace(t.CCW),H=_e)}function on(_e){_e!==dpe?(ot(t.CULL_FACE),_e!==de&&(_e===eF?t.cullFace(t.BACK):_e===fpe?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):et(t.CULL_FACE),de=_e}function Wt(_e){_e!==Ee&&(Te&&t.lineWidth(_e),Ee=_e)}function Gn(_e,Fe,Ge){_e?(ot(t.POLYGON_OFFSET_FILL),(Pe!==Fe||Ze!==Ge)&&(t.polygonOffset(Fe,Ge),Pe=Fe,Ze=Ge)):et(t.POLYGON_OFFSET_FILL)}function dn(_e){_e?ot(t.SCISSOR_TEST):et(t.SCISSOR_TEST)}function Ve(_e){_e===void 0&&(_e=t.TEXTURE0+ke-1),Ue!==_e&&(t.activeTexture(_e),Ue=_e)}function Se(_e,Fe,Ge){Ge===void 0&&(Ue===null?Ge=t.TEXTURE0+ke-1:Ge=Ue);let je=nt[Ge];je===void 0&&(je={type:void 0,texture:void 0},nt[Ge]=je),(je.type!==_e||je.texture!==Fe)&&(Ue!==Ge&&(t.activeTexture(Ge),Ue=Ge),t.bindTexture(_e,Fe||_t[_e]),je.type=_e,je.texture=Fe)}function bt(){const _e=nt[Ue];_e!==void 0&&_e.type!==void 0&&(t.bindTexture(_e.type,null),_e.type=void 0,_e.texture=void 0)}function Nt(){try{t.compressedTexImage2D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function jt(){try{t.compressedTexImage3D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Ut(){try{t.texSubImage2D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function yn(){try{t.texSubImage3D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Zt(){try{t.compressedTexSubImage2D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function qt(){try{t.compressedTexSubImage3D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Fn(){try{t.texStorage2D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Be(){try{t.texStorage3D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function ee(){try{t.texImage2D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function oe(){try{t.texImage3D(...arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function fe(_e){Ht.equals(_e)===!1&&(t.scissor(_e.x,_e.y,_e.z,_e.w),Ht.copy(_e))}function he(_e){He.equals(_e)===!1&&(t.viewport(_e.x,_e.y,_e.z,_e.w),He.copy(_e))}function xe(_e,Fe){let Ge=_.get(Fe);Ge===void 0&&(Ge=new WeakMap,_.set(Fe,Ge));let je=Ge.get(_e);je===void 0&&(je=t.getUniformBlockIndex(Fe,_e.name),Ge.set(_e,je))}function Ye(_e,Fe){const je=_.get(Fe).get(_e);m.get(Fe)!==je&&(t.uniformBlockBinding(Fe,je,_e.__bindingPointIndex),m.set(Fe,je))}function st(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),u.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),b={},Ue=null,nt={},M={},C=new WeakMap,A=[],k=null,z=!1,P=null,O=null,j=null,U=null,X=null,K=null,se=null,J=new Ti(0,0,0),ue=0,ne=!1,H=null,de=null,Ee=null,Pe=null,Ze=null,Ht.set(0,0,t.canvas.width,t.canvas.height),He.set(0,0,t.canvas.width,t.canvas.height),l.reset(),u.reset(),s.reset()}return{buffers:{color:l,depth:u,stencil:s},enable:ot,disable:et,bindFramebuffer:Mt,drawBuffers:Tt,useProgram:hn,setBlending:Ke,setMaterial:An,setFlipSided:Gt,setCullFace:on,setLineWidth:Wt,setPolygonOffset:Gn,setScissorTest:dn,activeTexture:Ve,bindTexture:Se,unbindTexture:bt,compressedTexImage2D:Nt,compressedTexImage3D:jt,texImage2D:ee,texImage3D:oe,updateUBOMapping:xe,uniformBlockBinding:Ye,texStorage2D:Fn,texStorage3D:Be,texSubImage2D:Ut,texSubImage3D:yn,compressedTexSubImage2D:Zt,compressedTexSubImage3D:qt,scissor:fe,viewport:he,reset:st}}function I_e(t,e,n,r,a,l,u){const s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),_=new mi,b=new WeakMap;let M;const C=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function k(Ve,Se){return A?new OffscreenCanvas(Ve,Se):jw("canvas")}function z(Ve,Se,bt){let Nt=1;const jt=dn(Ve);if((jt.width>bt||jt.height>bt)&&(Nt=bt/Math.max(jt.width,jt.height)),Nt<1)if(typeof HTMLImageElement<"u"&&Ve instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ve instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ve instanceof ImageBitmap||typeof VideoFrame<"u"&&Ve instanceof VideoFrame){const Ut=Math.floor(Nt*jt.width),yn=Math.floor(Nt*jt.height);M===void 0&&(M=k(Ut,yn));const Zt=Se?k(Ut,yn):M;return Zt.width=Ut,Zt.height=yn,Zt.getContext("2d").drawImage(Ve,0,0,Ut,yn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+jt.width+"x"+jt.height+") to ("+Ut+"x"+yn+")."),Zt}else return"data"in Ve&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+jt.width+"x"+jt.height+")."),Ve;return Ve}function P(Ve){return Ve.generateMipmaps}function O(Ve){t.generateMipmap(Ve)}function j(Ve){return Ve.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:Ve.isWebGL3DRenderTarget?t.TEXTURE_3D:Ve.isWebGLArrayRenderTarget||Ve.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function U(Ve,Se,bt,Nt,jt=!1){if(Ve!==null){if(t[Ve]!==void 0)return t[Ve];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ve+"'")}let Ut=Se;if(Se===t.RED&&(bt===t.FLOAT&&(Ut=t.R32F),bt===t.HALF_FLOAT&&(Ut=t.R16F),bt===t.UNSIGNED_BYTE&&(Ut=t.R8)),Se===t.RED_INTEGER&&(bt===t.UNSIGNED_BYTE&&(Ut=t.R8UI),bt===t.UNSIGNED_SHORT&&(Ut=t.R16UI),bt===t.UNSIGNED_INT&&(Ut=t.R32UI),bt===t.BYTE&&(Ut=t.R8I),bt===t.SHORT&&(Ut=t.R16I),bt===t.INT&&(Ut=t.R32I)),Se===t.RG&&(bt===t.FLOAT&&(Ut=t.RG32F),bt===t.HALF_FLOAT&&(Ut=t.RG16F),bt===t.UNSIGNED_BYTE&&(Ut=t.RG8)),Se===t.RG_INTEGER&&(bt===t.UNSIGNED_BYTE&&(Ut=t.RG8UI),bt===t.UNSIGNED_SHORT&&(Ut=t.RG16UI),bt===t.UNSIGNED_INT&&(Ut=t.RG32UI),bt===t.BYTE&&(Ut=t.RG8I),bt===t.SHORT&&(Ut=t.RG16I),bt===t.INT&&(Ut=t.RG32I)),Se===t.RGB_INTEGER&&(bt===t.UNSIGNED_BYTE&&(Ut=t.RGB8UI),bt===t.UNSIGNED_SHORT&&(Ut=t.RGB16UI),bt===t.UNSIGNED_INT&&(Ut=t.RGB32UI),bt===t.BYTE&&(Ut=t.RGB8I),bt===t.SHORT&&(Ut=t.RGB16I),bt===t.INT&&(Ut=t.RGB32I)),Se===t.RGBA_INTEGER&&(bt===t.UNSIGNED_BYTE&&(Ut=t.RGBA8UI),bt===t.UNSIGNED_SHORT&&(Ut=t.RGBA16UI),bt===t.UNSIGNED_INT&&(Ut=t.RGBA32UI),bt===t.BYTE&&(Ut=t.RGBA8I),bt===t.SHORT&&(Ut=t.RGBA16I),bt===t.INT&&(Ut=t.RGBA32I)),Se===t.RGB&&bt===t.UNSIGNED_INT_5_9_9_9_REV&&(Ut=t.RGB9_E5),Se===t.RGBA){const yn=jt?$w:oi.getTransfer(Nt);bt===t.FLOAT&&(Ut=t.RGBA32F),bt===t.HALF_FLOAT&&(Ut=t.RGBA16F),bt===t.UNSIGNED_BYTE&&(Ut=yn===Fi?t.SRGB8_ALPHA8:t.RGBA8),bt===t.UNSIGNED_SHORT_4_4_4_4&&(Ut=t.RGBA4),bt===t.UNSIGNED_SHORT_5_5_5_1&&(Ut=t.RGB5_A1)}return(Ut===t.R16F||Ut===t.R32F||Ut===t.RG16F||Ut===t.RG32F||Ut===t.RGBA16F||Ut===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ut}function X(Ve,Se){let bt;return Ve?Se===null||Se===kg||Se===ax?bt=t.DEPTH24_STENCIL8:Se===lf?bt=t.DEPTH32F_STENCIL8:Se===sx&&(bt=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Se===null||Se===kg||Se===ax?bt=t.DEPTH_COMPONENT24:Se===lf?bt=t.DEPTH_COMPONENT32F:Se===sx&&(bt=t.DEPTH_COMPONENT16),bt}function K(Ve,Se){return P(Ve)===!0||Ve.isFramebufferTexture&&Ve.minFilter!==oh&&Ve.minFilter!==hc?Math.log2(Math.max(Se.width,Se.height))+1:Ve.mipmaps!==void 0&&Ve.mipmaps.length>0?Ve.mipmaps.length:Ve.isCompressedTexture&&Array.isArray(Ve.image)?Se.mipmaps.length:1}function se(Ve){const Se=Ve.target;Se.removeEventListener("dispose",se),ue(Se),Se.isVideoTexture&&b.delete(Se)}function J(Ve){const Se=Ve.target;Se.removeEventListener("dispose",J),H(Se)}function ue(Ve){const Se=r.get(Ve);if(Se.__webglInit===void 0)return;const bt=Ve.source,Nt=C.get(bt);if(Nt){const jt=Nt[Se.__cacheKey];jt.usedTimes--,jt.usedTimes===0&&ne(Ve),Object.keys(Nt).length===0&&C.delete(bt)}r.remove(Ve)}function ne(Ve){const Se=r.get(Ve);t.deleteTexture(Se.__webglTexture);const bt=Ve.source,Nt=C.get(bt);delete Nt[Se.__cacheKey],u.memory.textures--}function H(Ve){const Se=r.get(Ve);if(Ve.depthTexture&&(Ve.depthTexture.dispose(),r.remove(Ve.depthTexture)),Ve.isWebGLCubeRenderTarget)for(let Nt=0;Nt<6;Nt++){if(Array.isArray(Se.__webglFramebuffer[Nt]))for(let jt=0;jt<Se.__webglFramebuffer[Nt].length;jt++)t.deleteFramebuffer(Se.__webglFramebuffer[Nt][jt]);else t.deleteFramebuffer(Se.__webglFramebuffer[Nt]);Se.__webglDepthbuffer&&t.deleteRenderbuffer(Se.__webglDepthbuffer[Nt])}else{if(Array.isArray(Se.__webglFramebuffer))for(let Nt=0;Nt<Se.__webglFramebuffer.length;Nt++)t.deleteFramebuffer(Se.__webglFramebuffer[Nt]);else t.deleteFramebuffer(Se.__webglFramebuffer);if(Se.__webglDepthbuffer&&t.deleteRenderbuffer(Se.__webglDepthbuffer),Se.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Se.__webglMultisampledFramebuffer),Se.__webglColorRenderbuffer)for(let Nt=0;Nt<Se.__webglColorRenderbuffer.length;Nt++)Se.__webglColorRenderbuffer[Nt]&&t.deleteRenderbuffer(Se.__webglColorRenderbuffer[Nt]);Se.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Se.__webglDepthRenderbuffer)}const bt=Ve.textures;for(let Nt=0,jt=bt.length;Nt<jt;Nt++){const Ut=r.get(bt[Nt]);Ut.__webglTexture&&(t.deleteTexture(Ut.__webglTexture),u.memory.textures--),r.remove(bt[Nt])}r.remove(Ve)}let de=0;function Ee(){de=0}function Pe(){const Ve=de;return Ve>=a.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ve+" texture units while this GPU supports only "+a.maxTextures),de+=1,Ve}function Ze(Ve){const Se=[];return Se.push(Ve.wrapS),Se.push(Ve.wrapT),Se.push(Ve.wrapR||0),Se.push(Ve.magFilter),Se.push(Ve.minFilter),Se.push(Ve.anisotropy),Se.push(Ve.internalFormat),Se.push(Ve.format),Se.push(Ve.type),Se.push(Ve.generateMipmaps),Se.push(Ve.premultiplyAlpha),Se.push(Ve.flipY),Se.push(Ve.unpackAlignment),Se.push(Ve.colorSpace),Se.join()}function ke(Ve,Se){const bt=r.get(Ve);if(Ve.isVideoTexture&&Wt(Ve),Ve.isRenderTargetTexture===!1&&Ve.version>0&&bt.__version!==Ve.version){const Nt=Ve.image;if(Nt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Nt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{He(bt,Ve,Se);return}}n.bindTexture(t.TEXTURE_2D,bt.__webglTexture,t.TEXTURE0+Se)}function Te(Ve,Se){const bt=r.get(Ve);if(Ve.version>0&&bt.__version!==Ve.version){He(bt,Ve,Se);return}n.bindTexture(t.TEXTURE_2D_ARRAY,bt.__webglTexture,t.TEXTURE0+Se)}function Ie(Ve,Se){const bt=r.get(Ve);if(Ve.version>0&&bt.__version!==Ve.version){He(bt,Ve,Se);return}n.bindTexture(t.TEXTURE_3D,bt.__webglTexture,t.TEXTURE0+Se)}function Ce(Ve,Se){const bt=r.get(Ve);if(Ve.version>0&&bt.__version!==Ve.version){pt(bt,Ve,Se);return}n.bindTexture(t.TEXTURE_CUBE_MAP,bt.__webglTexture,t.TEXTURE0+Se)}const Ue={[BP]:t.REPEAT,[Mg]:t.CLAMP_TO_EDGE,[UP]:t.MIRRORED_REPEAT},nt={[oh]:t.NEAREST,[$pe]:t.NEAREST_MIPMAP_NEAREST,[hb]:t.NEAREST_MIPMAP_LINEAR,[hc]:t.LINEAR,[dT]:t.LINEAR_MIPMAP_NEAREST,[Vp]:t.LINEAR_MIPMAP_LINEAR},Le={[Wpe]:t.NEVER,[Jpe]:t.ALWAYS,[qpe]:t.LESS,[S8]:t.LEQUAL,[Xpe]:t.EQUAL,[Kpe]:t.GEQUAL,[Zpe]:t.GREATER,[Ype]:t.NOTEQUAL};function lt(Ve,Se){if(Se.type===lf&&e.has("OES_texture_float_linear")===!1&&(Se.magFilter===hc||Se.magFilter===dT||Se.magFilter===hb||Se.magFilter===Vp||Se.minFilter===hc||Se.minFilter===dT||Se.minFilter===hb||Se.minFilter===Vp)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(Ve,t.TEXTURE_WRAP_S,Ue[Se.wrapS]),t.texParameteri(Ve,t.TEXTURE_WRAP_T,Ue[Se.wrapT]),(Ve===t.TEXTURE_3D||Ve===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Ve,t.TEXTURE_WRAP_R,Ue[Se.wrapR]),t.texParameteri(Ve,t.TEXTURE_MAG_FILTER,nt[Se.magFilter]),t.texParameteri(Ve,t.TEXTURE_MIN_FILTER,nt[Se.minFilter]),Se.compareFunction&&(t.texParameteri(Ve,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Ve,t.TEXTURE_COMPARE_FUNC,Le[Se.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Se.magFilter===oh||Se.minFilter!==hb&&Se.minFilter!==Vp||Se.type===lf&&e.has("OES_texture_float_linear")===!1)return;if(Se.anisotropy>1||r.get(Se).__currentAnisotropy){const bt=e.get("EXT_texture_filter_anisotropic");t.texParameterf(Ve,bt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Se.anisotropy,a.getMaxAnisotropy())),r.get(Se).__currentAnisotropy=Se.anisotropy}}}function Ht(Ve,Se){let bt=!1;Ve.__webglInit===void 0&&(Ve.__webglInit=!0,Se.addEventListener("dispose",se));const Nt=Se.source;let jt=C.get(Nt);jt===void 0&&(jt={},C.set(Nt,jt));const Ut=Ze(Se);if(Ut!==Ve.__cacheKey){jt[Ut]===void 0&&(jt[Ut]={texture:t.createTexture(),usedTimes:0},u.memory.textures++,bt=!0),jt[Ut].usedTimes++;const yn=jt[Ve.__cacheKey];yn!==void 0&&(jt[Ve.__cacheKey].usedTimes--,yn.usedTimes===0&&ne(Se)),Ve.__cacheKey=Ut,Ve.__webglTexture=jt[Ut].texture}return bt}function He(Ve,Se,bt){let Nt=t.TEXTURE_2D;(Se.isDataArrayTexture||Se.isCompressedArrayTexture)&&(Nt=t.TEXTURE_2D_ARRAY),Se.isData3DTexture&&(Nt=t.TEXTURE_3D);const jt=Ht(Ve,Se),Ut=Se.source;n.bindTexture(Nt,Ve.__webglTexture,t.TEXTURE0+bt);const yn=r.get(Ut);if(Ut.version!==yn.__version||jt===!0){n.activeTexture(t.TEXTURE0+bt);const Zt=oi.getPrimaries(oi.workingColorSpace),qt=Se.colorSpace===Bp?null:oi.getPrimaries(Se.colorSpace),Fn=Se.colorSpace===Bp||Zt===qt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Se.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Se.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Fn);let Be=z(Se.image,!1,a.maxTextureSize);Be=Gn(Se,Be);const ee=l.convert(Se.format,Se.colorSpace),oe=l.convert(Se.type);let fe=U(Se.internalFormat,ee,oe,Se.colorSpace,Se.isVideoTexture);lt(Nt,Se);let he;const xe=Se.mipmaps,Ye=Se.isVideoTexture!==!0,st=yn.__version===void 0||jt===!0,_e=Ut.dataReady,Fe=K(Se,Be);if(Se.isDepthTexture)fe=X(Se.format===cx,Se.type),st&&(Ye?n.texStorage2D(t.TEXTURE_2D,1,fe,Be.width,Be.height):n.texImage2D(t.TEXTURE_2D,0,fe,Be.width,Be.height,0,ee,oe,null));else if(Se.isDataTexture)if(xe.length>0){Ye&&st&&n.texStorage2D(t.TEXTURE_2D,Fe,fe,xe[0].width,xe[0].height);for(let Ge=0,je=xe.length;Ge<je;Ge++)he=xe[Ge],Ye?_e&&n.texSubImage2D(t.TEXTURE_2D,Ge,0,0,he.width,he.height,ee,oe,he.data):n.texImage2D(t.TEXTURE_2D,Ge,fe,he.width,he.height,0,ee,oe,he.data);Se.generateMipmaps=!1}else Ye?(st&&n.texStorage2D(t.TEXTURE_2D,Fe,fe,Be.width,Be.height),_e&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Be.width,Be.height,ee,oe,Be.data)):n.texImage2D(t.TEXTURE_2D,0,fe,Be.width,Be.height,0,ee,oe,Be.data);else if(Se.isCompressedTexture)if(Se.isCompressedArrayTexture){Ye&&st&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Fe,fe,xe[0].width,xe[0].height,Be.depth);for(let Ge=0,je=xe.length;Ge<je;Ge++)if(he=xe[Ge],Se.format!==rh)if(ee!==null)if(Ye){if(_e)if(Se.layerUpdates.size>0){const De=DF(he.width,he.height,Se.format,Se.type);for(const zt of Se.layerUpdates){const fn=he.data.subarray(zt*De/he.data.BYTES_PER_ELEMENT,(zt+1)*De/he.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ge,0,0,zt,he.width,he.height,1,ee,fn)}Se.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ge,0,0,0,he.width,he.height,Be.depth,ee,he.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Ge,fe,he.width,he.height,Be.depth,0,he.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ye?_e&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Ge,0,0,0,he.width,he.height,Be.depth,ee,oe,he.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Ge,fe,he.width,he.height,Be.depth,0,ee,oe,he.data)}else{Ye&&st&&n.texStorage2D(t.TEXTURE_2D,Fe,fe,xe[0].width,xe[0].height);for(let Ge=0,je=xe.length;Ge<je;Ge++)he=xe[Ge],Se.format!==rh?ee!==null?Ye?_e&&n.compressedTexSubImage2D(t.TEXTURE_2D,Ge,0,0,he.width,he.height,ee,he.data):n.compressedTexImage2D(t.TEXTURE_2D,Ge,fe,he.width,he.height,0,he.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ye?_e&&n.texSubImage2D(t.TEXTURE_2D,Ge,0,0,he.width,he.height,ee,oe,he.data):n.texImage2D(t.TEXTURE_2D,Ge,fe,he.width,he.height,0,ee,oe,he.data)}else if(Se.isDataArrayTexture)if(Ye){if(st&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Fe,fe,Be.width,Be.height,Be.depth),_e)if(Se.layerUpdates.size>0){const Ge=DF(Be.width,Be.height,Se.format,Se.type);for(const je of Se.layerUpdates){const De=Be.data.subarray(je*Ge/Be.data.BYTES_PER_ELEMENT,(je+1)*Ge/Be.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,je,Be.width,Be.height,1,ee,oe,De)}Se.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Be.width,Be.height,Be.depth,ee,oe,Be.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,fe,Be.width,Be.height,Be.depth,0,ee,oe,Be.data);else if(Se.isData3DTexture)Ye?(st&&n.texStorage3D(t.TEXTURE_3D,Fe,fe,Be.width,Be.height,Be.depth),_e&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Be.width,Be.height,Be.depth,ee,oe,Be.data)):n.texImage3D(t.TEXTURE_3D,0,fe,Be.width,Be.height,Be.depth,0,ee,oe,Be.data);else if(Se.isFramebufferTexture){if(st)if(Ye)n.texStorage2D(t.TEXTURE_2D,Fe,fe,Be.width,Be.height);else{let Ge=Be.width,je=Be.height;for(let De=0;De<Fe;De++)n.texImage2D(t.TEXTURE_2D,De,fe,Ge,je,0,ee,oe,null),Ge>>=1,je>>=1}}else if(xe.length>0){if(Ye&&st){const Ge=dn(xe[0]);n.texStorage2D(t.TEXTURE_2D,Fe,fe,Ge.width,Ge.height)}for(let Ge=0,je=xe.length;Ge<je;Ge++)he=xe[Ge],Ye?_e&&n.texSubImage2D(t.TEXTURE_2D,Ge,0,0,ee,oe,he):n.texImage2D(t.TEXTURE_2D,Ge,fe,ee,oe,he);Se.generateMipmaps=!1}else if(Ye){if(st){const Ge=dn(Be);n.texStorage2D(t.TEXTURE_2D,Fe,fe,Ge.width,Ge.height)}_e&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,ee,oe,Be)}else n.texImage2D(t.TEXTURE_2D,0,fe,ee,oe,Be);P(Se)&&O(Nt),yn.__version=Ut.version,Se.onUpdate&&Se.onUpdate(Se)}Ve.__version=Se.version}function pt(Ve,Se,bt){if(Se.image.length!==6)return;const Nt=Ht(Ve,Se),jt=Se.source;n.bindTexture(t.TEXTURE_CUBE_MAP,Ve.__webglTexture,t.TEXTURE0+bt);const Ut=r.get(jt);if(jt.version!==Ut.__version||Nt===!0){n.activeTexture(t.TEXTURE0+bt);const yn=oi.getPrimaries(oi.workingColorSpace),Zt=Se.colorSpace===Bp?null:oi.getPrimaries(Se.colorSpace),qt=Se.colorSpace===Bp||yn===Zt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Se.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Se.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,qt);const Fn=Se.isCompressedTexture||Se.image[0].isCompressedTexture,Be=Se.image[0]&&Se.image[0].isDataTexture,ee=[];for(let je=0;je<6;je++)!Fn&&!Be?ee[je]=z(Se.image[je],!0,a.maxCubemapSize):ee[je]=Be?Se.image[je].image:Se.image[je],ee[je]=Gn(Se,ee[je]);const oe=ee[0],fe=l.convert(Se.format,Se.colorSpace),he=l.convert(Se.type),xe=U(Se.internalFormat,fe,he,Se.colorSpace),Ye=Se.isVideoTexture!==!0,st=Ut.__version===void 0||Nt===!0,_e=jt.dataReady;let Fe=K(Se,oe);lt(t.TEXTURE_CUBE_MAP,Se);let Ge;if(Fn){Ye&&st&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Fe,xe,oe.width,oe.height);for(let je=0;je<6;je++){Ge=ee[je].mipmaps;for(let De=0;De<Ge.length;De++){const zt=Ge[De];Se.format!==rh?fe!==null?Ye?_e&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De,0,0,zt.width,zt.height,fe,zt.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De,xe,zt.width,zt.height,0,zt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ye?_e&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De,0,0,zt.width,zt.height,fe,he,zt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De,xe,zt.width,zt.height,0,fe,he,zt.data)}}}else{if(Ge=Se.mipmaps,Ye&&st){Ge.length>0&&Fe++;const je=dn(ee[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Fe,xe,je.width,je.height)}for(let je=0;je<6;je++)if(Be){Ye?_e&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,0,0,0,ee[je].width,ee[je].height,fe,he,ee[je].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,0,xe,ee[je].width,ee[je].height,0,fe,he,ee[je].data);for(let De=0;De<Ge.length;De++){const fn=Ge[De].image[je].image;Ye?_e&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De+1,0,0,fn.width,fn.height,fe,he,fn.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De+1,xe,fn.width,fn.height,0,fe,he,fn.data)}}else{Ye?_e&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,0,0,0,fe,he,ee[je]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,0,xe,fe,he,ee[je]);for(let De=0;De<Ge.length;De++){const zt=Ge[De];Ye?_e&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De+1,0,0,fe,he,zt.image[je]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+je,De+1,xe,fe,he,zt.image[je])}}}P(Se)&&O(t.TEXTURE_CUBE_MAP),Ut.__version=jt.version,Se.onUpdate&&Se.onUpdate(Se)}Ve.__version=Se.version}function _t(Ve,Se,bt,Nt,jt,Ut){const yn=l.convert(bt.format,bt.colorSpace),Zt=l.convert(bt.type),qt=U(bt.internalFormat,yn,Zt,bt.colorSpace),Fn=r.get(Se),Be=r.get(bt);if(Be.__renderTarget=Se,!Fn.__hasExternalTextures){const ee=Math.max(1,Se.width>>Ut),oe=Math.max(1,Se.height>>Ut);jt===t.TEXTURE_3D||jt===t.TEXTURE_2D_ARRAY?n.texImage3D(jt,Ut,qt,ee,oe,Se.depth,0,yn,Zt,null):n.texImage2D(jt,Ut,qt,ee,oe,0,yn,Zt,null)}n.bindFramebuffer(t.FRAMEBUFFER,Ve),on(Se)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Nt,jt,Be.__webglTexture,0,Gt(Se)):(jt===t.TEXTURE_2D||jt>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&jt<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Nt,jt,Be.__webglTexture,Ut),n.bindFramebuffer(t.FRAMEBUFFER,null)}function ot(Ve,Se,bt){if(t.bindRenderbuffer(t.RENDERBUFFER,Ve),Se.depthBuffer){const Nt=Se.depthTexture,jt=Nt&&Nt.isDepthTexture?Nt.type:null,Ut=X(Se.stencilBuffer,jt),yn=Se.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Zt=Gt(Se);on(Se)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Zt,Ut,Se.width,Se.height):bt?t.renderbufferStorageMultisample(t.RENDERBUFFER,Zt,Ut,Se.width,Se.height):t.renderbufferStorage(t.RENDERBUFFER,Ut,Se.width,Se.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,yn,t.RENDERBUFFER,Ve)}else{const Nt=Se.textures;for(let jt=0;jt<Nt.length;jt++){const Ut=Nt[jt],yn=l.convert(Ut.format,Ut.colorSpace),Zt=l.convert(Ut.type),qt=U(Ut.internalFormat,yn,Zt,Ut.colorSpace),Fn=Gt(Se);bt&&on(Se)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Fn,qt,Se.width,Se.height):on(Se)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Fn,qt,Se.width,Se.height):t.renderbufferStorage(t.RENDERBUFFER,qt,Se.width,Se.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function et(Ve,Se){if(Se&&Se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,Ve),!(Se.depthTexture&&Se.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Nt=r.get(Se.depthTexture);Nt.__renderTarget=Se,(!Nt.__webglTexture||Se.depthTexture.image.width!==Se.width||Se.depthTexture.image.height!==Se.height)&&(Se.depthTexture.image.width=Se.width,Se.depthTexture.image.height=Se.height,Se.depthTexture.needsUpdate=!0),ke(Se.depthTexture,0);const jt=Nt.__webglTexture,Ut=Gt(Se);if(Se.depthTexture.format===lx)on(Se)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,jt,0,Ut):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,jt,0);else if(Se.depthTexture.format===cx)on(Se)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,jt,0,Ut):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,jt,0);else throw new Error("Unknown depthTexture format")}function Mt(Ve){const Se=r.get(Ve),bt=Ve.isWebGLCubeRenderTarget===!0;if(Se.__boundDepthTexture!==Ve.depthTexture){const Nt=Ve.depthTexture;if(Se.__depthDisposeCallback&&Se.__depthDisposeCallback(),Nt){const jt=()=>{delete Se.__boundDepthTexture,delete Se.__depthDisposeCallback,Nt.removeEventListener("dispose",jt)};Nt.addEventListener("dispose",jt),Se.__depthDisposeCallback=jt}Se.__boundDepthTexture=Nt}if(Ve.depthTexture&&!Se.__autoAllocateDepthBuffer){if(bt)throw new Error("target.depthTexture not supported in Cube render targets");et(Se.__webglFramebuffer,Ve)}else if(bt){Se.__webglDepthbuffer=[];for(let Nt=0;Nt<6;Nt++)if(n.bindFramebuffer(t.FRAMEBUFFER,Se.__webglFramebuffer[Nt]),Se.__webglDepthbuffer[Nt]===void 0)Se.__webglDepthbuffer[Nt]=t.createRenderbuffer(),ot(Se.__webglDepthbuffer[Nt],Ve,!1);else{const jt=Ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ut=Se.__webglDepthbuffer[Nt];t.bindRenderbuffer(t.RENDERBUFFER,Ut),t.framebufferRenderbuffer(t.FRAMEBUFFER,jt,t.RENDERBUFFER,Ut)}}else if(n.bindFramebuffer(t.FRAMEBUFFER,Se.__webglFramebuffer),Se.__webglDepthbuffer===void 0)Se.__webglDepthbuffer=t.createRenderbuffer(),ot(Se.__webglDepthbuffer,Ve,!1);else{const Nt=Ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,jt=Se.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,jt),t.framebufferRenderbuffer(t.FRAMEBUFFER,Nt,t.RENDERBUFFER,jt)}n.bindFramebuffer(t.FRAMEBUFFER,null)}function Tt(Ve,Se,bt){const Nt=r.get(Ve);Se!==void 0&&_t(Nt.__webglFramebuffer,Ve,Ve.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),bt!==void 0&&Mt(Ve)}function hn(Ve){const Se=Ve.texture,bt=r.get(Ve),Nt=r.get(Se);Ve.addEventListener("dispose",J);const jt=Ve.textures,Ut=Ve.isWebGLCubeRenderTarget===!0,yn=jt.length>1;if(yn||(Nt.__webglTexture===void 0&&(Nt.__webglTexture=t.createTexture()),Nt.__version=Se.version,u.memory.textures++),Ut){bt.__webglFramebuffer=[];for(let Zt=0;Zt<6;Zt++)if(Se.mipmaps&&Se.mipmaps.length>0){bt.__webglFramebuffer[Zt]=[];for(let qt=0;qt<Se.mipmaps.length;qt++)bt.__webglFramebuffer[Zt][qt]=t.createFramebuffer()}else bt.__webglFramebuffer[Zt]=t.createFramebuffer()}else{if(Se.mipmaps&&Se.mipmaps.length>0){bt.__webglFramebuffer=[];for(let Zt=0;Zt<Se.mipmaps.length;Zt++)bt.__webglFramebuffer[Zt]=t.createFramebuffer()}else bt.__webglFramebuffer=t.createFramebuffer();if(yn)for(let Zt=0,qt=jt.length;Zt<qt;Zt++){const Fn=r.get(jt[Zt]);Fn.__webglTexture===void 0&&(Fn.__webglTexture=t.createTexture(),u.memory.textures++)}if(Ve.samples>0&&on(Ve)===!1){bt.__webglMultisampledFramebuffer=t.createFramebuffer(),bt.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,bt.__webglMultisampledFramebuffer);for(let Zt=0;Zt<jt.length;Zt++){const qt=jt[Zt];bt.__webglColorRenderbuffer[Zt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,bt.__webglColorRenderbuffer[Zt]);const Fn=l.convert(qt.format,qt.colorSpace),Be=l.convert(qt.type),ee=U(qt.internalFormat,Fn,Be,qt.colorSpace,Ve.isXRRenderTarget===!0),oe=Gt(Ve);t.renderbufferStorageMultisample(t.RENDERBUFFER,oe,ee,Ve.width,Ve.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.RENDERBUFFER,bt.__webglColorRenderbuffer[Zt])}t.bindRenderbuffer(t.RENDERBUFFER,null),Ve.depthBuffer&&(bt.__webglDepthRenderbuffer=t.createRenderbuffer(),ot(bt.__webglDepthRenderbuffer,Ve,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ut){n.bindTexture(t.TEXTURE_CUBE_MAP,Nt.__webglTexture),lt(t.TEXTURE_CUBE_MAP,Se);for(let Zt=0;Zt<6;Zt++)if(Se.mipmaps&&Se.mipmaps.length>0)for(let qt=0;qt<Se.mipmaps.length;qt++)_t(bt.__webglFramebuffer[Zt][qt],Ve,Se,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Zt,qt);else _t(bt.__webglFramebuffer[Zt],Ve,Se,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Zt,0);P(Se)&&O(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(yn){for(let Zt=0,qt=jt.length;Zt<qt;Zt++){const Fn=jt[Zt],Be=r.get(Fn);n.bindTexture(t.TEXTURE_2D,Be.__webglTexture),lt(t.TEXTURE_2D,Fn),_t(bt.__webglFramebuffer,Ve,Fn,t.COLOR_ATTACHMENT0+Zt,t.TEXTURE_2D,0),P(Fn)&&O(t.TEXTURE_2D)}n.unbindTexture()}else{let Zt=t.TEXTURE_2D;if((Ve.isWebGL3DRenderTarget||Ve.isWebGLArrayRenderTarget)&&(Zt=Ve.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Zt,Nt.__webglTexture),lt(Zt,Se),Se.mipmaps&&Se.mipmaps.length>0)for(let qt=0;qt<Se.mipmaps.length;qt++)_t(bt.__webglFramebuffer[qt],Ve,Se,t.COLOR_ATTACHMENT0,Zt,qt);else _t(bt.__webglFramebuffer,Ve,Se,t.COLOR_ATTACHMENT0,Zt,0);P(Se)&&O(Zt),n.unbindTexture()}Ve.depthBuffer&&Mt(Ve)}function en(Ve){const Se=Ve.textures;for(let bt=0,Nt=Se.length;bt<Nt;bt++){const jt=Se[bt];if(P(jt)){const Ut=j(Ve),yn=r.get(jt).__webglTexture;n.bindTexture(Ut,yn),O(Ut),n.unbindTexture()}}}const an=[],Ke=[];function An(Ve){if(Ve.samples>0){if(on(Ve)===!1){const Se=Ve.textures,bt=Ve.width,Nt=Ve.height;let jt=t.COLOR_BUFFER_BIT;const Ut=Ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,yn=r.get(Ve),Zt=Se.length>1;if(Zt)for(let qt=0;qt<Se.length;qt++)n.bindFramebuffer(t.FRAMEBUFFER,yn.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+qt,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,yn.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+qt,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,yn.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,yn.__webglFramebuffer);for(let qt=0;qt<Se.length;qt++){if(Ve.resolveDepthBuffer&&(Ve.depthBuffer&&(jt|=t.DEPTH_BUFFER_BIT),Ve.stencilBuffer&&Ve.resolveStencilBuffer&&(jt|=t.STENCIL_BUFFER_BIT)),Zt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,yn.__webglColorRenderbuffer[qt]);const Fn=r.get(Se[qt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Fn,0)}t.blitFramebuffer(0,0,bt,Nt,0,0,bt,Nt,jt,t.NEAREST),m===!0&&(an.length=0,Ke.length=0,an.push(t.COLOR_ATTACHMENT0+qt),Ve.depthBuffer&&Ve.resolveDepthBuffer===!1&&(an.push(Ut),Ke.push(Ut),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,Ke)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,an))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Zt)for(let qt=0;qt<Se.length;qt++){n.bindFramebuffer(t.FRAMEBUFFER,yn.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+qt,t.RENDERBUFFER,yn.__webglColorRenderbuffer[qt]);const Fn=r.get(Se[qt]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,yn.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+qt,t.TEXTURE_2D,Fn,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,yn.__webglMultisampledFramebuffer)}else if(Ve.depthBuffer&&Ve.resolveDepthBuffer===!1&&m){const Se=Ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Se])}}}function Gt(Ve){return Math.min(a.maxSamples,Ve.samples)}function on(Ve){const Se=r.get(Ve);return Ve.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Se.__useRenderToTexture!==!1}function Wt(Ve){const Se=u.render.frame;b.get(Ve)!==Se&&(b.set(Ve,Se),Ve.update())}function Gn(Ve,Se){const bt=Ve.colorSpace,Nt=Ve.format,jt=Ve.type;return Ve.isCompressedTexture===!0||Ve.isVideoTexture===!0||bt!==zg&&bt!==Bp&&(oi.getTransfer(bt)===Fi?(Nt!==rh||jt!==vf)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",bt)),Se}function dn(Ve){return typeof HTMLImageElement<"u"&&Ve instanceof HTMLImageElement?(_.width=Ve.naturalWidth||Ve.width,_.height=Ve.naturalHeight||Ve.height):typeof VideoFrame<"u"&&Ve instanceof VideoFrame?(_.width=Ve.displayWidth,_.height=Ve.displayHeight):(_.width=Ve.width,_.height=Ve.height),_}this.allocateTextureUnit=Pe,this.resetTextureUnits=Ee,this.setTexture2D=ke,this.setTexture2DArray=Te,this.setTexture3D=Ie,this.setTextureCube=Ce,this.rebindTextures=Tt,this.setupRenderTarget=hn,this.updateRenderTargetMipmap=en,this.updateMultisampleRenderTarget=An,this.setupDepthRenderbuffer=Mt,this.setupFrameBufferTexture=_t,this.useMultisampledRTT=on}function R_e(t,e){function n(r,a=Bp){let l;const u=oi.getTransfer(a);if(r===vf)return t.UNSIGNED_BYTE;if(r===wR)return t.UNSIGNED_SHORT_4_4_4_4;if(r===SR)return t.UNSIGNED_SHORT_5_5_5_1;if(r===m8)return t.UNSIGNED_INT_5_9_9_9_REV;if(r===f8)return t.BYTE;if(r===p8)return t.SHORT;if(r===sx)return t.UNSIGNED_SHORT;if(r===bR)return t.INT;if(r===kg)return t.UNSIGNED_INT;if(r===lf)return t.FLOAT;if(r===Yx)return t.HALF_FLOAT;if(r===g8)return t.ALPHA;if(r===v8)return t.RGB;if(r===rh)return t.RGBA;if(r===y8)return t.LUMINANCE;if(r===_8)return t.LUMINANCE_ALPHA;if(r===lx)return t.DEPTH_COMPONENT;if(r===cx)return t.DEPTH_STENCIL;if(r===x8)return t.RED;if(r===MR)return t.RED_INTEGER;if(r===b8)return t.RG;if(r===ER)return t.RG_INTEGER;if(r===CR)return t.RGBA_INTEGER;if(r===ow||r===sw||r===aw||r===lw)if(u===Fi)if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),l!==null){if(r===ow)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===sw)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===aw)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===lw)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(l=e.get("WEBGL_compressed_texture_s3tc"),l!==null){if(r===ow)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===sw)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===aw)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===lw)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===$P||r===VP||r===jP||r===HP)if(l=e.get("WEBGL_compressed_texture_pvrtc"),l!==null){if(r===$P)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===VP)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===jP)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===HP)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===GP||r===WP||r===qP)if(l=e.get("WEBGL_compressed_texture_etc"),l!==null){if(r===GP||r===WP)return u===Fi?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(r===qP)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===XP||r===ZP||r===YP||r===KP||r===JP||r===QP||r===eA||r===tA||r===nA||r===rA||r===iA||r===oA||r===sA||r===aA)if(l=e.get("WEBGL_compressed_texture_astc"),l!==null){if(r===XP)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===ZP)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===YP)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===KP)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===JP)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===QP)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===eA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===tA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===nA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===rA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===iA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===oA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===sA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===aA)return u===Fi?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===cw||r===lA||r===cA)if(l=e.get("EXT_texture_compression_bptc"),l!==null){if(r===cw)return u===Fi?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===lA)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===cA)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===w8||r===uA||r===hA||r===dA)if(l=e.get("EXT_texture_compression_rgtc"),l!==null){if(r===cw)return l.COMPRESSED_RED_RGTC1_EXT;if(r===uA)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===hA)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===dA)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===ax?t.UNSIGNED_INT_24_8:t[r]!==void 0?t[r]:null}return{convert:n}}const D_e=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,L_e=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class k_e{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,r){if(this.texture===null){const a=new Js,l=e.properties.get(a);l.__webglTexture=n.texture,(n.depthNear!==r.depthNear||n.depthFar!==r.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=a}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,r=new yf({vertexShader:D_e,fragmentShader:L_e,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new wl(new Qx(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class z_e extends Qy{constructor(e,n){super();const r=this;let a=null,l=1,u=null,s="local-floor",m=1,_=null,b=null,M=null,C=null,A=null,k=null;const z=new k_e,P=n.getContextAttributes();let O=null,j=null;const U=[],X=[],K=new mi;let se=null;const J=new ac;J.viewport=new $o;const ue=new ac;ue.viewport=new $o;const ne=[J,ue],H=new tge;let de=null,Ee=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(He){let pt=U[He];return pt===void 0&&(pt=new DT,U[He]=pt),pt.getTargetRaySpace()},this.getControllerGrip=function(He){let pt=U[He];return pt===void 0&&(pt=new DT,U[He]=pt),pt.getGripSpace()},this.getHand=function(He){let pt=U[He];return pt===void 0&&(pt=new DT,U[He]=pt),pt.getHandSpace()};function Pe(He){const pt=X.indexOf(He.inputSource);if(pt===-1)return;const _t=U[pt];_t!==void 0&&(_t.update(He.inputSource,He.frame,_||u),_t.dispatchEvent({type:He.type,data:He.inputSource}))}function Ze(){a.removeEventListener("select",Pe),a.removeEventListener("selectstart",Pe),a.removeEventListener("selectend",Pe),a.removeEventListener("squeeze",Pe),a.removeEventListener("squeezestart",Pe),a.removeEventListener("squeezeend",Pe),a.removeEventListener("end",Ze),a.removeEventListener("inputsourceschange",ke);for(let He=0;He<U.length;He++){const pt=X[He];pt!==null&&(X[He]=null,U[He].disconnect(pt))}de=null,Ee=null,z.reset(),e.setRenderTarget(O),A=null,C=null,M=null,a=null,j=null,Ht.stop(),r.isPresenting=!1,e.setPixelRatio(se),e.setSize(K.width,K.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(He){l=He,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(He){s=He,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return _||u},this.setReferenceSpace=function(He){_=He},this.getBaseLayer=function(){return C!==null?C:A},this.getBinding=function(){return M},this.getFrame=function(){return k},this.getSession=function(){return a},this.setSession=async function(He){if(a=He,a!==null){if(O=e.getRenderTarget(),a.addEventListener("select",Pe),a.addEventListener("selectstart",Pe),a.addEventListener("selectend",Pe),a.addEventListener("squeeze",Pe),a.addEventListener("squeezestart",Pe),a.addEventListener("squeezeend",Pe),a.addEventListener("end",Ze),a.addEventListener("inputsourceschange",ke),P.xrCompatible!==!0&&await n.makeXRCompatible(),se=e.getPixelRatio(),e.getSize(K),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let _t=null,ot=null,et=null;P.depth&&(et=P.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,_t=P.stencil?cx:lx,ot=P.stencil?ax:kg);const Mt={colorFormat:n.RGBA8,depthFormat:et,scaleFactor:l};M=new XRWebGLBinding(a,n),C=M.createProjectionLayer(Mt),a.updateRenderState({layers:[C]}),e.setPixelRatio(1),e.setSize(C.textureWidth,C.textureHeight,!1),j=new nm(C.textureWidth,C.textureHeight,{format:rh,type:vf,depthTexture:new D8(C.textureWidth,C.textureHeight,ot,void 0,void 0,void 0,void 0,void 0,void 0,_t),stencilBuffer:P.stencil,colorSpace:e.outputColorSpace,samples:P.antialias?4:0,resolveDepthBuffer:C.ignoreDepthValues===!1,resolveStencilBuffer:C.ignoreDepthValues===!1})}else{const _t={antialias:P.antialias,alpha:!0,depth:P.depth,stencil:P.stencil,framebufferScaleFactor:l};A=new XRWebGLLayer(a,n,_t),a.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),j=new nm(A.framebufferWidth,A.framebufferHeight,{format:rh,type:vf,colorSpace:e.outputColorSpace,stencilBuffer:P.stencil,resolveDepthBuffer:A.ignoreDepthValues===!1,resolveStencilBuffer:A.ignoreDepthValues===!1})}j.isXRRenderTarget=!0,this.setFoveation(m),_=null,u=await a.requestReferenceSpace(s),Ht.setContext(a),Ht.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(a!==null)return a.environmentBlendMode},this.getDepthTexture=function(){return z.getDepthTexture()};function ke(He){for(let pt=0;pt<He.removed.length;pt++){const _t=He.removed[pt],ot=X.indexOf(_t);ot>=0&&(X[ot]=null,U[ot].disconnect(_t))}for(let pt=0;pt<He.added.length;pt++){const _t=He.added[pt];let ot=X.indexOf(_t);if(ot===-1){for(let Mt=0;Mt<U.length;Mt++)if(Mt>=X.length){X.push(_t),ot=Mt;break}else if(X[Mt]===null){X[Mt]=_t,ot=Mt;break}if(ot===-1)break}const et=U[ot];et&&et.connect(_t)}}const Te=new At,Ie=new At;function Ce(He,pt,_t){Te.setFromMatrixPosition(pt.matrixWorld),Ie.setFromMatrixPosition(_t.matrixWorld);const ot=Te.distanceTo(Ie),et=pt.projectionMatrix.elements,Mt=_t.projectionMatrix.elements,Tt=et[14]/(et[10]-1),hn=et[14]/(et[10]+1),en=(et[9]+1)/et[5],an=(et[9]-1)/et[5],Ke=(et[8]-1)/et[0],An=(Mt[8]+1)/Mt[0],Gt=Tt*Ke,on=Tt*An,Wt=ot/(-Ke+An),Gn=Wt*-Ke;if(pt.matrixWorld.decompose(He.position,He.quaternion,He.scale),He.translateX(Gn),He.translateZ(Wt),He.matrixWorld.compose(He.position,He.quaternion,He.scale),He.matrixWorldInverse.copy(He.matrixWorld).invert(),et[10]===-1)He.projectionMatrix.copy(pt.projectionMatrix),He.projectionMatrixInverse.copy(pt.projectionMatrixInverse);else{const dn=Tt+Wt,Ve=hn+Wt,Se=Gt-Gn,bt=on+(ot-Gn),Nt=en*hn/Ve*dn,jt=an*hn/Ve*dn;He.projectionMatrix.makePerspective(Se,bt,Nt,jt,dn,Ve),He.projectionMatrixInverse.copy(He.projectionMatrix).invert()}}function Ue(He,pt){pt===null?He.matrixWorld.copy(He.matrix):He.matrixWorld.multiplyMatrices(pt.matrixWorld,He.matrix),He.matrixWorldInverse.copy(He.matrixWorld).invert()}this.updateCamera=function(He){if(a===null)return;let pt=He.near,_t=He.far;z.texture!==null&&(z.depthNear>0&&(pt=z.depthNear),z.depthFar>0&&(_t=z.depthFar)),H.near=ue.near=J.near=pt,H.far=ue.far=J.far=_t,(de!==H.near||Ee!==H.far)&&(a.updateRenderState({depthNear:H.near,depthFar:H.far}),de=H.near,Ee=H.far),J.layers.mask=He.layers.mask|2,ue.layers.mask=He.layers.mask|4,H.layers.mask=J.layers.mask|ue.layers.mask;const ot=He.parent,et=H.cameras;Ue(H,ot);for(let Mt=0;Mt<et.length;Mt++)Ue(et[Mt],ot);et.length===2?Ce(H,J,ue):H.projectionMatrix.copy(J.projectionMatrix),nt(He,H,ot)};function nt(He,pt,_t){_t===null?He.matrix.copy(pt.matrixWorld):(He.matrix.copy(_t.matrixWorld),He.matrix.invert(),He.matrix.multiply(pt.matrixWorld)),He.matrix.decompose(He.position,He.quaternion,He.scale),He.updateMatrixWorld(!0),He.projectionMatrix.copy(pt.projectionMatrix),He.projectionMatrixInverse.copy(pt.projectionMatrixInverse),He.isPerspectiveCamera&&(He.fov=ux*2*Math.atan(1/He.projectionMatrix.elements[5]),He.zoom=1)}this.getCamera=function(){return H},this.getFoveation=function(){if(!(C===null&&A===null))return m},this.setFoveation=function(He){m=He,C!==null&&(C.fixedFoveation=He),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=He)},this.hasDepthSensing=function(){return z.texture!==null},this.getDepthSensingMesh=function(){return z.getMesh(H)};let Le=null;function lt(He,pt){if(b=pt.getViewerPose(_||u),k=pt,b!==null){const _t=b.views;A!==null&&(e.setRenderTargetFramebuffer(j,A.framebuffer),e.setRenderTarget(j));let ot=!1;_t.length!==H.cameras.length&&(H.cameras.length=0,ot=!0);for(let Tt=0;Tt<_t.length;Tt++){const hn=_t[Tt];let en=null;if(A!==null)en=A.getViewport(hn);else{const Ke=M.getViewSubImage(C,hn);en=Ke.viewport,Tt===0&&(e.setRenderTargetTextures(j,Ke.colorTexture,Ke.depthStencilTexture),e.setRenderTarget(j))}let an=ne[Tt];an===void 0&&(an=new ac,an.layers.enable(Tt),an.viewport=new $o,ne[Tt]=an),an.matrix.fromArray(hn.transform.matrix),an.matrix.decompose(an.position,an.quaternion,an.scale),an.projectionMatrix.fromArray(hn.projectionMatrix),an.projectionMatrixInverse.copy(an.projectionMatrix).invert(),an.viewport.set(en.x,en.y,en.width,en.height),Tt===0&&(H.matrix.copy(an.matrix),H.matrix.decompose(H.position,H.quaternion,H.scale)),ot===!0&&H.cameras.push(an)}const et=a.enabledFeatures;if(et&&et.includes("depth-sensing")&&a.depthUsage=="gpu-optimized"&&M){const Tt=M.getDepthInformation(_t[0]);Tt&&Tt.isValid&&Tt.texture&&z.init(e,Tt,a.renderState)}}for(let _t=0;_t<U.length;_t++){const ot=X[_t],et=U[_t];ot!==null&&et!==void 0&&et.update(ot,pt,_||u)}Le&&Le(He,pt),pt.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:pt}),k=null}const Ht=new L8;Ht.setAnimationLoop(lt),this.setAnimationLoop=function(He){Le=He},this.dispose=function(){}}}const fg=new ud,O_e=new ki;function F_e(t,e){function n(P,O){P.matrixAutoUpdate===!0&&P.updateMatrix(),O.value.copy(P.matrix)}function r(P,O){O.color.getRGB(P.fogColor.value,A8(t)),O.isFog?(P.fogNear.value=O.near,P.fogFar.value=O.far):O.isFogExp2&&(P.fogDensity.value=O.density)}function a(P,O,j,U,X){O.isMeshBasicMaterial||O.isMeshLambertMaterial?l(P,O):O.isMeshToonMaterial?(l(P,O),M(P,O)):O.isMeshPhongMaterial?(l(P,O),b(P,O)):O.isMeshStandardMaterial?(l(P,O),C(P,O),O.isMeshPhysicalMaterial&&A(P,O,X)):O.isMeshMatcapMaterial?(l(P,O),k(P,O)):O.isMeshDepthMaterial?l(P,O):O.isMeshDistanceMaterial?(l(P,O),z(P,O)):O.isMeshNormalMaterial?l(P,O):O.isLineBasicMaterial?(u(P,O),O.isLineDashedMaterial&&s(P,O)):O.isPointsMaterial?m(P,O,j,U):O.isSpriteMaterial?_(P,O):O.isShadowMaterial?(P.color.value.copy(O.color),P.opacity.value=O.opacity):O.isShaderMaterial&&(O.uniformsNeedUpdate=!1)}function l(P,O){P.opacity.value=O.opacity,O.color&&P.diffuse.value.copy(O.color),O.emissive&&P.emissive.value.copy(O.emissive).multiplyScalar(O.emissiveIntensity),O.map&&(P.map.value=O.map,n(O.map,P.mapTransform)),O.alphaMap&&(P.alphaMap.value=O.alphaMap,n(O.alphaMap,P.alphaMapTransform)),O.bumpMap&&(P.bumpMap.value=O.bumpMap,n(O.bumpMap,P.bumpMapTransform),P.bumpScale.value=O.bumpScale,O.side===El&&(P.bumpScale.value*=-1)),O.normalMap&&(P.normalMap.value=O.normalMap,n(O.normalMap,P.normalMapTransform),P.normalScale.value.copy(O.normalScale),O.side===El&&P.normalScale.value.negate()),O.displacementMap&&(P.displacementMap.value=O.displacementMap,n(O.displacementMap,P.displacementMapTransform),P.displacementScale.value=O.displacementScale,P.displacementBias.value=O.displacementBias),O.emissiveMap&&(P.emissiveMap.value=O.emissiveMap,n(O.emissiveMap,P.emissiveMapTransform)),O.specularMap&&(P.specularMap.value=O.specularMap,n(O.specularMap,P.specularMapTransform)),O.alphaTest>0&&(P.alphaTest.value=O.alphaTest);const j=e.get(O),U=j.envMap,X=j.envMapRotation;U&&(P.envMap.value=U,fg.copy(X),fg.x*=-1,fg.y*=-1,fg.z*=-1,U.isCubeTexture&&U.isRenderTargetTexture===!1&&(fg.y*=-1,fg.z*=-1),P.envMapRotation.value.setFromMatrix4(O_e.makeRotationFromEuler(fg)),P.flipEnvMap.value=U.isCubeTexture&&U.isRenderTargetTexture===!1?-1:1,P.reflectivity.value=O.reflectivity,P.ior.value=O.ior,P.refractionRatio.value=O.refractionRatio),O.lightMap&&(P.lightMap.value=O.lightMap,P.lightMapIntensity.value=O.lightMapIntensity,n(O.lightMap,P.lightMapTransform)),O.aoMap&&(P.aoMap.value=O.aoMap,P.aoMapIntensity.value=O.aoMapIntensity,n(O.aoMap,P.aoMapTransform))}function u(P,O){P.diffuse.value.copy(O.color),P.opacity.value=O.opacity,O.map&&(P.map.value=O.map,n(O.map,P.mapTransform))}function s(P,O){P.dashSize.value=O.dashSize,P.totalSize.value=O.dashSize+O.gapSize,P.scale.value=O.scale}function m(P,O,j,U){P.diffuse.value.copy(O.color),P.opacity.value=O.opacity,P.size.value=O.size*j,P.scale.value=U*.5,O.map&&(P.map.value=O.map,n(O.map,P.uvTransform)),O.alphaMap&&(P.alphaMap.value=O.alphaMap,n(O.alphaMap,P.alphaMapTransform)),O.alphaTest>0&&(P.alphaTest.value=O.alphaTest)}function _(P,O){P.diffuse.value.copy(O.color),P.opacity.value=O.opacity,P.rotation.value=O.rotation,O.map&&(P.map.value=O.map,n(O.map,P.mapTransform)),O.alphaMap&&(P.alphaMap.value=O.alphaMap,n(O.alphaMap,P.alphaMapTransform)),O.alphaTest>0&&(P.alphaTest.value=O.alphaTest)}function b(P,O){P.specular.value.copy(O.specular),P.shininess.value=Math.max(O.shininess,1e-4)}function M(P,O){O.gradientMap&&(P.gradientMap.value=O.gradientMap)}function C(P,O){P.metalness.value=O.metalness,O.metalnessMap&&(P.metalnessMap.value=O.metalnessMap,n(O.metalnessMap,P.metalnessMapTransform)),P.roughness.value=O.roughness,O.roughnessMap&&(P.roughnessMap.value=O.roughnessMap,n(O.roughnessMap,P.roughnessMapTransform)),O.envMap&&(P.envMapIntensity.value=O.envMapIntensity)}function A(P,O,j){P.ior.value=O.ior,O.sheen>0&&(P.sheenColor.value.copy(O.sheenColor).multiplyScalar(O.sheen),P.sheenRoughness.value=O.sheenRoughness,O.sheenColorMap&&(P.sheenColorMap.value=O.sheenColorMap,n(O.sheenColorMap,P.sheenColorMapTransform)),O.sheenRoughnessMap&&(P.sheenRoughnessMap.value=O.sheenRoughnessMap,n(O.sheenRoughnessMap,P.sheenRoughnessMapTransform))),O.clearcoat>0&&(P.clearcoat.value=O.clearcoat,P.clearcoatRoughness.value=O.clearcoatRoughness,O.clearcoatMap&&(P.clearcoatMap.value=O.clearcoatMap,n(O.clearcoatMap,P.clearcoatMapTransform)),O.clearcoatRoughnessMap&&(P.clearcoatRoughnessMap.value=O.clearcoatRoughnessMap,n(O.clearcoatRoughnessMap,P.clearcoatRoughnessMapTransform)),O.clearcoatNormalMap&&(P.clearcoatNormalMap.value=O.clearcoatNormalMap,n(O.clearcoatNormalMap,P.clearcoatNormalMapTransform),P.clearcoatNormalScale.value.copy(O.clearcoatNormalScale),O.side===El&&P.clearcoatNormalScale.value.negate())),O.dispersion>0&&(P.dispersion.value=O.dispersion),O.iridescence>0&&(P.iridescence.value=O.iridescence,P.iridescenceIOR.value=O.iridescenceIOR,P.iridescenceThicknessMinimum.value=O.iridescenceThicknessRange[0],P.iridescenceThicknessMaximum.value=O.iridescenceThicknessRange[1],O.iridescenceMap&&(P.iridescenceMap.value=O.iridescenceMap,n(O.iridescenceMap,P.iridescenceMapTransform)),O.iridescenceThicknessMap&&(P.iridescenceThicknessMap.value=O.iridescenceThicknessMap,n(O.iridescenceThicknessMap,P.iridescenceThicknessMapTransform))),O.transmission>0&&(P.transmission.value=O.transmission,P.transmissionSamplerMap.value=j.texture,P.transmissionSamplerSize.value.set(j.width,j.height),O.transmissionMap&&(P.transmissionMap.value=O.transmissionMap,n(O.transmissionMap,P.transmissionMapTransform)),P.thickness.value=O.thickness,O.thicknessMap&&(P.thicknessMap.value=O.thicknessMap,n(O.thicknessMap,P.thicknessMapTransform)),P.attenuationDistance.value=O.attenuationDistance,P.attenuationColor.value.copy(O.attenuationColor)),O.anisotropy>0&&(P.anisotropyVector.value.set(O.anisotropy*Math.cos(O.anisotropyRotation),O.anisotropy*Math.sin(O.anisotropyRotation)),O.anisotropyMap&&(P.anisotropyMap.value=O.anisotropyMap,n(O.anisotropyMap,P.anisotropyMapTransform))),P.specularIntensity.value=O.specularIntensity,P.specularColor.value.copy(O.specularColor),O.specularColorMap&&(P.specularColorMap.value=O.specularColorMap,n(O.specularColorMap,P.specularColorMapTransform)),O.specularIntensityMap&&(P.specularIntensityMap.value=O.specularIntensityMap,n(O.specularIntensityMap,P.specularIntensityMapTransform))}function k(P,O){O.matcap&&(P.matcap.value=O.matcap)}function z(P,O){const j=e.get(O).light;P.referencePosition.value.setFromMatrixPosition(j.matrixWorld),P.nearDistance.value=j.shadow.camera.near,P.farDistance.value=j.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:a}}function N_e(t,e,n,r){let a={},l={},u=[];const s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function m(j,U){const X=U.program;r.uniformBlockBinding(j,X)}function _(j,U){let X=a[j.id];X===void 0&&(k(j),X=b(j),a[j.id]=X,j.addEventListener("dispose",P));const K=U.program;r.updateUBOMapping(j,K);const se=e.render.frame;l[j.id]!==se&&(C(j),l[j.id]=se)}function b(j){const U=M();j.__bindingPointIndex=U;const X=t.createBuffer(),K=j.__size,se=j.usage;return t.bindBuffer(t.UNIFORM_BUFFER,X),t.bufferData(t.UNIFORM_BUFFER,K,se),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,U,X),X}function M(){for(let j=0;j<s;j++)if(u.indexOf(j)===-1)return u.push(j),j;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function C(j){const U=a[j.id],X=j.uniforms,K=j.__cache;t.bindBuffer(t.UNIFORM_BUFFER,U);for(let se=0,J=X.length;se<J;se++){const ue=Array.isArray(X[se])?X[se]:[X[se]];for(let ne=0,H=ue.length;ne<H;ne++){const de=ue[ne];if(A(de,se,ne,K)===!0){const Ee=de.__offset,Pe=Array.isArray(de.value)?de.value:[de.value];let Ze=0;for(let ke=0;ke<Pe.length;ke++){const Te=Pe[ke],Ie=z(Te);typeof Te=="number"||typeof Te=="boolean"?(de.__data[0]=Te,t.bufferSubData(t.UNIFORM_BUFFER,Ee+Ze,de.__data)):Te.isMatrix3?(de.__data[0]=Te.elements[0],de.__data[1]=Te.elements[1],de.__data[2]=Te.elements[2],de.__data[3]=0,de.__data[4]=Te.elements[3],de.__data[5]=Te.elements[4],de.__data[6]=Te.elements[5],de.__data[7]=0,de.__data[8]=Te.elements[6],de.__data[9]=Te.elements[7],de.__data[10]=Te.elements[8],de.__data[11]=0):(Te.toArray(de.__data,Ze),Ze+=Ie.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,Ee,de.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function A(j,U,X,K){const se=j.value,J=U+"_"+X;if(K[J]===void 0)return typeof se=="number"||typeof se=="boolean"?K[J]=se:K[J]=se.clone(),!0;{const ue=K[J];if(typeof se=="number"||typeof se=="boolean"){if(ue!==se)return K[J]=se,!0}else if(ue.equals(se)===!1)return ue.copy(se),!0}return!1}function k(j){const U=j.uniforms;let X=0;const K=16;for(let J=0,ue=U.length;J<ue;J++){const ne=Array.isArray(U[J])?U[J]:[U[J]];for(let H=0,de=ne.length;H<de;H++){const Ee=ne[H],Pe=Array.isArray(Ee.value)?Ee.value:[Ee.value];for(let Ze=0,ke=Pe.length;Ze<ke;Ze++){const Te=Pe[Ze],Ie=z(Te),Ce=X%K,Ue=Ce%Ie.boundary,nt=Ce+Ue;X+=Ue,nt!==0&&K-nt<Ie.storage&&(X+=K-nt),Ee.__data=new Float32Array(Ie.storage/Float32Array.BYTES_PER_ELEMENT),Ee.__offset=X,X+=Ie.storage}}}const se=X%K;return se>0&&(X+=K-se),j.__size=X,j.__cache={},this}function z(j){const U={boundary:0,storage:0};return typeof j=="number"||typeof j=="boolean"?(U.boundary=4,U.storage=4):j.isVector2?(U.boundary=8,U.storage=8):j.isVector3||j.isColor?(U.boundary=16,U.storage=12):j.isVector4?(U.boundary=16,U.storage=16):j.isMatrix3?(U.boundary=48,U.storage=48):j.isMatrix4?(U.boundary=64,U.storage=64):j.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",j),U}function P(j){const U=j.target;U.removeEventListener("dispose",P);const X=u.indexOf(U.__bindingPointIndex);u.splice(X,1),t.deleteBuffer(a[U.id]),delete a[U.id],delete l[U.id]}function O(){for(const j in a)t.deleteBuffer(a[j]);u=[],a={},l={}}return{bind:m,update:_,dispose:O}}class B_e{constructor(e={}){const{canvas:n=mme(),context:r=null,depth:a=!0,stencil:l=!1,alpha:u=!1,antialias:s=!1,premultipliedAlpha:m=!0,preserveDrawingBuffer:_=!1,powerPreference:b="default",failIfMajorPerformanceCaveat:M=!1,reverseDepthBuffer:C=!1}=e;this.isWebGLRenderer=!0;let A;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");A=r.getContextAttributes().alpha}else A=u;const k=new Uint32Array(4),z=new Int32Array(4);let P=null,O=null;const j=[],U=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Wp,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const X=this;let K=!1;this._outputColorSpace=Kc;let se=0,J=0,ue=null,ne=-1,H=null;const de=new $o,Ee=new $o;let Pe=null;const Ze=new Ti(0);let ke=0,Te=n.width,Ie=n.height,Ce=1,Ue=null,nt=null;const Le=new $o(0,0,Te,Ie),lt=new $o(0,0,Te,Ie);let Ht=!1;const He=new RR;let pt=!1,_t=!1;const ot=new ki,et=new ki,Mt=new At,Tt=new $o,hn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let en=!1;function an(){return ue===null?Ce:1}let Ke=r;function An(Re,mt){return n.getContext(Re,mt)}try{const Re={alpha:!0,depth:a,stencil:l,antialias:s,premultipliedAlpha:m,preserveDrawingBuffer:_,powerPreference:b,failIfMajorPerformanceCaveat:M};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${xR}`),n.addEventListener("webglcontextlost",je,!1),n.addEventListener("webglcontextrestored",De,!1),n.addEventListener("webglcontextcreationerror",zt,!1),Ke===null){const mt="webgl2";if(Ke=An(mt,Re),Ke===null)throw An(mt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Re){throw console.error("THREE.WebGLRenderer: "+Re.message),Re}let Gt,on,Wt,Gn,dn,Ve,Se,bt,Nt,jt,Ut,yn,Zt,qt,Fn,Be,ee,oe,fe,he,xe,Ye,st,_e;function Fe(){Gt=new Zye(Ke),Gt.init(),Ye=new R_e(Ke,Gt),on=new Vye(Ke,Gt,e,Ye),Wt=new A_e(Ke,Gt),on.reverseDepthBuffer&&C&&Wt.buffers.depth.setReversed(!0),Gn=new Jye(Ke),dn=new g_e,Ve=new I_e(Ke,Gt,Wt,dn,on,Ye,Gn),Se=new Hye(X),bt=new Xye(X),Nt=new ige(Ke),st=new Uye(Ke,Nt),jt=new Yye(Ke,Nt,Gn,st),Ut=new e0e(Ke,jt,Nt,Gn),fe=new Qye(Ke,on,Ve),Be=new jye(dn),yn=new m_e(X,Se,bt,Gt,on,st,Be),Zt=new F_e(X,dn),qt=new y_e,Fn=new M_e(Gt),oe=new Bye(X,Se,bt,Wt,Ut,A,m),ee=new T_e(X,Ut,on),_e=new N_e(Ke,Gn,on,Wt),he=new $ye(Ke,Gt,Gn),xe=new Kye(Ke,Gt,Gn),Gn.programs=yn.programs,X.capabilities=on,X.extensions=Gt,X.properties=dn,X.renderLists=qt,X.shadowMap=ee,X.state=Wt,X.info=Gn}Fe();const Ge=new z_e(X,Ke);this.xr=Ge,this.getContext=function(){return Ke},this.getContextAttributes=function(){return Ke.getContextAttributes()},this.forceContextLoss=function(){const Re=Gt.get("WEBGL_lose_context");Re&&Re.loseContext()},this.forceContextRestore=function(){const Re=Gt.get("WEBGL_lose_context");Re&&Re.restoreContext()},this.getPixelRatio=function(){return Ce},this.setPixelRatio=function(Re){Re!==void 0&&(Ce=Re,this.setSize(Te,Ie,!1))},this.getSize=function(Re){return Re.set(Te,Ie)},this.setSize=function(Re,mt,Lt=!0){if(Ge.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Te=Re,Ie=mt,n.width=Math.floor(Re*Ce),n.height=Math.floor(mt*Ce),Lt===!0&&(n.style.width=Re+"px",n.style.height=mt+"px"),this.setViewport(0,0,Re,mt)},this.getDrawingBufferSize=function(Re){return Re.set(Te*Ce,Ie*Ce).floor()},this.setDrawingBufferSize=function(Re,mt,Lt){Te=Re,Ie=mt,Ce=Lt,n.width=Math.floor(Re*Lt),n.height=Math.floor(mt*Lt),this.setViewport(0,0,Re,mt)},this.getCurrentViewport=function(Re){return Re.copy(de)},this.getViewport=function(Re){return Re.copy(Le)},this.setViewport=function(Re,mt,Lt,Et){Re.isVector4?Le.set(Re.x,Re.y,Re.z,Re.w):Le.set(Re,mt,Lt,Et),Wt.viewport(de.copy(Le).multiplyScalar(Ce).round())},this.getScissor=function(Re){return Re.copy(lt)},this.setScissor=function(Re,mt,Lt,Et){Re.isVector4?lt.set(Re.x,Re.y,Re.z,Re.w):lt.set(Re,mt,Lt,Et),Wt.scissor(Ee.copy(lt).multiplyScalar(Ce).round())},this.getScissorTest=function(){return Ht},this.setScissorTest=function(Re){Wt.setScissorTest(Ht=Re)},this.setOpaqueSort=function(Re){Ue=Re},this.setTransparentSort=function(Re){nt=Re},this.getClearColor=function(Re){return Re.copy(oe.getClearColor())},this.setClearColor=function(){oe.setClearColor(...arguments)},this.getClearAlpha=function(){return oe.getClearAlpha()},this.setClearAlpha=function(){oe.setClearAlpha(...arguments)},this.clear=function(Re=!0,mt=!0,Lt=!0){let Et=0;if(Re){let wt=!1;if(ue!==null){const un=ue.texture.format;wt=un===CR||un===ER||un===MR}if(wt){const un=ue.texture.type,_n=un===vf||un===kg||un===sx||un===ax||un===wR||un===SR,pn=oe.getClearColor(),jn=oe.getClearAlpha(),mn=pn.r,Wn=pn.g,Pn=pn.b;_n?(k[0]=mn,k[1]=Wn,k[2]=Pn,k[3]=jn,Ke.clearBufferuiv(Ke.COLOR,0,k)):(z[0]=mn,z[1]=Wn,z[2]=Pn,z[3]=jn,Ke.clearBufferiv(Ke.COLOR,0,z))}else Et|=Ke.COLOR_BUFFER_BIT}mt&&(Et|=Ke.DEPTH_BUFFER_BIT),Lt&&(Et|=Ke.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ke.clear(Et)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",je,!1),n.removeEventListener("webglcontextrestored",De,!1),n.removeEventListener("webglcontextcreationerror",zt,!1),oe.dispose(),qt.dispose(),Fn.dispose(),dn.dispose(),Se.dispose(),bt.dispose(),Ut.dispose(),st.dispose(),_e.dispose(),yn.dispose(),Ge.dispose(),Ge.removeEventListener("sessionstart",Ar),Ge.removeEventListener("sessionend",Je),gt.stop()};function je(Re){Re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),K=!0}function De(){console.log("THREE.WebGLRenderer: Context Restored."),K=!1;const Re=Gn.autoReset,mt=ee.enabled,Lt=ee.autoUpdate,Et=ee.needsUpdate,wt=ee.type;Fe(),Gn.autoReset=Re,ee.enabled=mt,ee.autoUpdate=Lt,ee.needsUpdate=Et,ee.type=wt}function zt(Re){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Re.statusMessage)}function fn(Re){const mt=Re.target;mt.removeEventListener("dispose",fn),sn(mt)}function sn(Re){Jt(Re),dn.remove(Re)}function Jt(Re){const mt=dn.get(Re).programs;mt!==void 0&&(mt.forEach(function(Lt){yn.releaseProgram(Lt)}),Re.isShaderMaterial&&yn.releaseShaderCache(Re))}this.renderBufferDirect=function(Re,mt,Lt,Et,wt,un){mt===null&&(mt=hn);const _n=wt.isMesh&&wt.matrixWorld.determinant()<0,pn=ut(Re,mt,Lt,Et,wt);Wt.setMaterial(Et,_n);let jn=Lt.index,mn=1;if(Et.wireframe===!0){if(jn=jt.getWireframeAttribute(Lt),jn===void 0)return;mn=2}const Wn=Lt.drawRange,Pn=Lt.attributes.position;let Rn=Wn.start*mn,Qn=(Wn.start+Wn.count)*mn;un!==null&&(Rn=Math.max(Rn,un.start*mn),Qn=Math.min(Qn,(un.start+un.count)*mn)),jn!==null?(Rn=Math.max(Rn,0),Qn=Math.min(Qn,jn.count)):Pn!=null&&(Rn=Math.max(Rn,0),Qn=Math.min(Qn,Pn.count));const Ir=Qn-Rn;if(Ir<0||Ir===1/0)return;st.setup(wt,Et,pn,Lt,jn);let wr,On=he;if(jn!==null&&(wr=Nt.get(jn),On=xe,On.setIndex(wr)),wt.isMesh)Et.wireframe===!0?(Wt.setLineWidth(Et.wireframeLinewidth*an()),On.setMode(Ke.LINES)):On.setMode(Ke.TRIANGLES);else if(wt.isLine){let or=Et.linewidth;or===void 0&&(or=1),Wt.setLineWidth(or*an()),wt.isLineSegments?On.setMode(Ke.LINES):wt.isLineLoop?On.setMode(Ke.LINE_LOOP):On.setMode(Ke.LINE_STRIP)}else wt.isPoints?On.setMode(Ke.POINTS):wt.isSprite&&On.setMode(Ke.TRIANGLES);if(wt.isBatchedMesh)if(wt._multiDrawInstances!==null)uw("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),On.renderMultiDrawInstances(wt._multiDrawStarts,wt._multiDrawCounts,wt._multiDrawCount,wt._multiDrawInstances);else if(Gt.get("WEBGL_multi_draw"))On.renderMultiDraw(wt._multiDrawStarts,wt._multiDrawCounts,wt._multiDrawCount);else{const or=wt._multiDrawStarts,gi=wt._multiDrawCounts,Cr=wt._multiDrawCount,zo=jn?Nt.get(jn).bytesPerElement:1,Ll=dn.get(Et).currentProgram.getUniforms();for(let Go=0;Go<Cr;Go++)Ll.setValue(Ke,"_gl_DrawID",Go),On.render(or[Go]/zo,gi[Go])}else if(wt.isInstancedMesh)On.renderInstances(Rn,Ir,wt.count);else if(Lt.isInstancedBufferGeometry){const or=Lt._maxInstanceCount!==void 0?Lt._maxInstanceCount:1/0,gi=Math.min(Lt.instanceCount,or);On.renderInstances(Rn,Ir,gi)}else On.render(Rn,Ir)};function cn(Re,mt,Lt){Re.transparent===!0&&Re.side===af&&Re.forceSinglePass===!1?(Re.side=El,Re.needsUpdate=!0,kn(Re,mt,Lt),Re.side=tm,Re.needsUpdate=!0,kn(Re,mt,Lt),Re.side=af):kn(Re,mt,Lt)}this.compile=function(Re,mt,Lt=null){Lt===null&&(Lt=Re),O=Fn.get(Lt),O.init(mt),U.push(O),Lt.traverseVisible(function(wt){wt.isLight&&wt.layers.test(mt.layers)&&(O.pushLight(wt),wt.castShadow&&O.pushShadow(wt))}),Re!==Lt&&Re.traverseVisible(function(wt){wt.isLight&&wt.layers.test(mt.layers)&&(O.pushLight(wt),wt.castShadow&&O.pushShadow(wt))}),O.setupLights();const Et=new Set;return Re.traverse(function(wt){if(!(wt.isMesh||wt.isPoints||wt.isLine||wt.isSprite))return;const un=wt.material;if(un)if(Array.isArray(un))for(let _n=0;_n<un.length;_n++){const pn=un[_n];cn(pn,Lt,wt),Et.add(pn)}else cn(un,Lt,wt),Et.add(un)}),O=U.pop(),Et},this.compileAsync=function(Re,mt,Lt=null){const Et=this.compile(Re,mt,Lt);return new Promise(wt=>{function un(){if(Et.forEach(function(_n){dn.get(_n).currentProgram.isReady()&&Et.delete(_n)}),Et.size===0){wt(Re);return}setTimeout(un,10)}Gt.get("KHR_parallel_shader_compile")!==null?un():setTimeout(un,10)})};let Zn=null;function yr(Re){Zn&&Zn(Re)}function Ar(){gt.stop()}function Je(){gt.start()}const gt=new L8;gt.setAnimationLoop(yr),typeof self<"u"&&gt.setContext(self),this.setAnimationLoop=function(Re){Zn=Re,Ge.setAnimationLoop(Re),Re===null?gt.stop():gt.start()},Ge.addEventListener("sessionstart",Ar),Ge.addEventListener("sessionend",Je),this.render=function(Re,mt){if(mt!==void 0&&mt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(K===!0)return;if(Re.matrixWorldAutoUpdate===!0&&Re.updateMatrixWorld(),mt.parent===null&&mt.matrixWorldAutoUpdate===!0&&mt.updateMatrixWorld(),Ge.enabled===!0&&Ge.isPresenting===!0&&(Ge.cameraAutoUpdate===!0&&Ge.updateCamera(mt),mt=Ge.getCamera()),Re.isScene===!0&&Re.onBeforeRender(X,Re,mt,ue),O=Fn.get(Re,U.length),O.init(mt),U.push(O),et.multiplyMatrices(mt.projectionMatrix,mt.matrixWorldInverse),He.setFromProjectionMatrix(et),_t=this.localClippingEnabled,pt=Be.init(this.clippingPlanes,_t),P=qt.get(Re,j.length),P.init(),j.push(P),Ge.enabled===!0&&Ge.isPresenting===!0){const un=X.xr.getDepthSensingMesh();un!==null&&St(un,mt,-1/0,X.sortObjects)}St(Re,mt,0,X.sortObjects),P.finish(),X.sortObjects===!0&&P.sort(Ue,nt),en=Ge.enabled===!1||Ge.isPresenting===!1||Ge.hasDepthSensing()===!1,en&&oe.addToRenderList(P,Re),this.info.render.frame++,pt===!0&&Be.beginShadows();const Lt=O.state.shadowsArray;ee.render(Lt,Re,mt),pt===!0&&Be.endShadows(),this.info.autoReset===!0&&this.info.reset();const Et=P.opaque,wt=P.transmissive;if(O.setupLights(),mt.isArrayCamera){const un=mt.cameras;if(wt.length>0)for(let _n=0,pn=un.length;_n<pn;_n++){const jn=un[_n];Qt(Et,wt,Re,jn)}en&&oe.render(Re);for(let _n=0,pn=un.length;_n<pn;_n++){const jn=un[_n];ft(P,Re,jn,jn.viewport)}}else wt.length>0&&Qt(Et,wt,Re,mt),en&&oe.render(Re),ft(P,Re,mt);ue!==null&&J===0&&(Ve.updateMultisampleRenderTarget(ue),Ve.updateRenderTargetMipmap(ue)),Re.isScene===!0&&Re.onAfterRender(X,Re,mt),st.resetDefaultState(),ne=-1,H=null,U.pop(),U.length>0?(O=U[U.length-1],pt===!0&&Be.setGlobalState(X.clippingPlanes,O.state.camera)):O=null,j.pop(),j.length>0?P=j[j.length-1]:P=null};function St(Re,mt,Lt,Et){if(Re.visible===!1)return;if(Re.layers.test(mt.layers)){if(Re.isGroup)Lt=Re.renderOrder;else if(Re.isLOD)Re.autoUpdate===!0&&Re.update(mt);else if(Re.isLight)O.pushLight(Re),Re.castShadow&&O.pushShadow(Re);else if(Re.isSprite){if(!Re.frustumCulled||He.intersectsSprite(Re)){Et&&Tt.setFromMatrixPosition(Re.matrixWorld).applyMatrix4(et);const _n=Ut.update(Re),pn=Re.material;pn.visible&&P.push(Re,_n,pn,Lt,Tt.z,null)}}else if((Re.isMesh||Re.isLine||Re.isPoints)&&(!Re.frustumCulled||He.intersectsObject(Re))){const _n=Ut.update(Re),pn=Re.material;if(Et&&(Re.boundingSphere!==void 0?(Re.boundingSphere===null&&Re.computeBoundingSphere(),Tt.copy(Re.boundingSphere.center)):(_n.boundingSphere===null&&_n.computeBoundingSphere(),Tt.copy(_n.boundingSphere.center)),Tt.applyMatrix4(Re.matrixWorld).applyMatrix4(et)),Array.isArray(pn)){const jn=_n.groups;for(let mn=0,Wn=jn.length;mn<Wn;mn++){const Pn=jn[mn],Rn=pn[Pn.materialIndex];Rn&&Rn.visible&&P.push(Re,_n,Rn,Lt,Tt.z,Pn)}}else pn.visible&&P.push(Re,_n,pn,Lt,Tt.z,null)}}const un=Re.children;for(let _n=0,pn=un.length;_n<pn;_n++)St(un[_n],mt,Lt,Et)}function ft(Re,mt,Lt,Et){const wt=Re.opaque,un=Re.transmissive,_n=Re.transparent;O.setupLightsView(Lt),pt===!0&&Be.setGlobalState(X.clippingPlanes,Lt),Et&&Wt.viewport(de.copy(Et)),wt.length>0&&Sn(wt,mt,Lt),un.length>0&&Sn(un,mt,Lt),_n.length>0&&Sn(_n,mt,Lt),Wt.buffers.depth.setTest(!0),Wt.buffers.depth.setMask(!0),Wt.buffers.color.setMask(!0),Wt.setPolygonOffset(!1)}function Qt(Re,mt,Lt,Et){if((Lt.isScene===!0?Lt.overrideMaterial:null)!==null)return;O.state.transmissionRenderTarget[Et.id]===void 0&&(O.state.transmissionRenderTarget[Et.id]=new nm(1,1,{generateMipmaps:!0,type:Gt.has("EXT_color_buffer_half_float")||Gt.has("EXT_color_buffer_float")?Yx:vf,minFilter:Vp,samples:4,stencilBuffer:l,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:oi.workingColorSpace}));const un=O.state.transmissionRenderTarget[Et.id],_n=Et.viewport||de;un.setSize(_n.z*X.transmissionResolutionScale,_n.w*X.transmissionResolutionScale);const pn=X.getRenderTarget();X.setRenderTarget(un),X.getClearColor(Ze),ke=X.getClearAlpha(),ke<1&&X.setClearColor(16777215,.5),X.clear(),en&&oe.render(Lt);const jn=X.toneMapping;X.toneMapping=Wp;const mn=Et.viewport;if(Et.viewport!==void 0&&(Et.viewport=void 0),O.setupLightsView(Et),pt===!0&&Be.setGlobalState(X.clippingPlanes,Et),Sn(Re,Lt,Et),Ve.updateMultisampleRenderTarget(un),Ve.updateRenderTargetMipmap(un),Gt.has("WEBGL_multisampled_render_to_texture")===!1){let Wn=!1;for(let Pn=0,Rn=mt.length;Pn<Rn;Pn++){const Qn=mt[Pn],Ir=Qn.object,wr=Qn.geometry,On=Qn.material,or=Qn.group;if(On.side===af&&Ir.layers.test(Et.layers)){const gi=On.side;On.side=El,On.needsUpdate=!0,Un(Ir,Lt,Et,wr,On,or),On.side=gi,On.needsUpdate=!0,Wn=!0}}Wn===!0&&(Ve.updateMultisampleRenderTarget(un),Ve.updateRenderTargetMipmap(un))}X.setRenderTarget(pn),X.setClearColor(Ze,ke),mn!==void 0&&(Et.viewport=mn),X.toneMapping=jn}function Sn(Re,mt,Lt){const Et=mt.isScene===!0?mt.overrideMaterial:null;for(let wt=0,un=Re.length;wt<un;wt++){const _n=Re[wt],pn=_n.object,jn=_n.geometry,mn=_n.group;let Wn=_n.material;Wn.allowOverride===!0&&Et!==null&&(Wn=Et),pn.layers.test(Lt.layers)&&Un(pn,mt,Lt,jn,Wn,mn)}}function Un(Re,mt,Lt,Et,wt,un){Re.onBeforeRender(X,mt,Lt,Et,wt,un),Re.modelViewMatrix.multiplyMatrices(Lt.matrixWorldInverse,Re.matrixWorld),Re.normalMatrix.getNormalMatrix(Re.modelViewMatrix),wt.onBeforeRender(X,mt,Lt,Et,Re,un),wt.transparent===!0&&wt.side===af&&wt.forceSinglePass===!1?(wt.side=El,wt.needsUpdate=!0,X.renderBufferDirect(Lt,mt,Et,wt,Re,un),wt.side=tm,wt.needsUpdate=!0,X.renderBufferDirect(Lt,mt,Et,wt,Re,un),wt.side=af):X.renderBufferDirect(Lt,mt,Et,wt,Re,un),Re.onAfterRender(X,mt,Lt,Et,wt,un)}function kn(Re,mt,Lt){mt.isScene!==!0&&(mt=hn);const Et=dn.get(Re),wt=O.state.lights,un=O.state.shadowsArray,_n=wt.state.version,pn=yn.getParameters(Re,wt.state,un,mt,Lt),jn=yn.getProgramCacheKey(pn);let mn=Et.programs;Et.environment=Re.isMeshStandardMaterial?mt.environment:null,Et.fog=mt.fog,Et.envMap=(Re.isMeshStandardMaterial?bt:Se).get(Re.envMap||Et.environment),Et.envMapRotation=Et.environment!==null&&Re.envMap===null?mt.environmentRotation:Re.envMapRotation,mn===void 0&&(Re.addEventListener("dispose",fn),mn=new Map,Et.programs=mn);let Wn=mn.get(jn);if(Wn!==void 0){if(Et.currentProgram===Wn&&Et.lightsStateVersion===_n)return ct(Re,pn),Wn}else pn.uniforms=yn.getUniforms(Re),Re.onBeforeCompile(pn,X),Wn=yn.acquireProgram(pn,jn),mn.set(jn,Wn),Et.uniforms=pn.uniforms;const Pn=Et.uniforms;return(!Re.isShaderMaterial&&!Re.isRawShaderMaterial||Re.clipping===!0)&&(Pn.clippingPlanes=Be.uniform),ct(Re,pn),Et.needsLights=En(Re),Et.lightsStateVersion=_n,Et.needsLights&&(Pn.ambientLightColor.value=wt.state.ambient,Pn.lightProbe.value=wt.state.probe,Pn.directionalLights.value=wt.state.directional,Pn.directionalLightShadows.value=wt.state.directionalShadow,Pn.spotLights.value=wt.state.spot,Pn.spotLightShadows.value=wt.state.spotShadow,Pn.rectAreaLights.value=wt.state.rectArea,Pn.ltc_1.value=wt.state.rectAreaLTC1,Pn.ltc_2.value=wt.state.rectAreaLTC2,Pn.pointLights.value=wt.state.point,Pn.pointLightShadows.value=wt.state.pointShadow,Pn.hemisphereLights.value=wt.state.hemi,Pn.directionalShadowMap.value=wt.state.directionalShadowMap,Pn.directionalShadowMatrix.value=wt.state.directionalShadowMatrix,Pn.spotShadowMap.value=wt.state.spotShadowMap,Pn.spotLightMatrix.value=wt.state.spotLightMatrix,Pn.spotLightMap.value=wt.state.spotLightMap,Pn.pointShadowMap.value=wt.state.pointShadowMap,Pn.pointShadowMatrix.value=wt.state.pointShadowMatrix),Et.currentProgram=Wn,Et.uniformsList=null,Wn}function Rt(Re){if(Re.uniformsList===null){const mt=Re.currentProgram.getUniforms();Re.uniformsList=hw.seqWithValue(mt.seq,Re.uniforms)}return Re.uniformsList}function ct(Re,mt){const Lt=dn.get(Re);Lt.outputColorSpace=mt.outputColorSpace,Lt.batching=mt.batching,Lt.batchingColor=mt.batchingColor,Lt.instancing=mt.instancing,Lt.instancingColor=mt.instancingColor,Lt.instancingMorph=mt.instancingMorph,Lt.skinning=mt.skinning,Lt.morphTargets=mt.morphTargets,Lt.morphNormals=mt.morphNormals,Lt.morphColors=mt.morphColors,Lt.morphTargetsCount=mt.morphTargetsCount,Lt.numClippingPlanes=mt.numClippingPlanes,Lt.numIntersection=mt.numClipIntersection,Lt.vertexAlphas=mt.vertexAlphas,Lt.vertexTangents=mt.vertexTangents,Lt.toneMapping=mt.toneMapping}function ut(Re,mt,Lt,Et,wt){mt.isScene!==!0&&(mt=hn),Ve.resetTextureUnits();const un=mt.fog,_n=Et.isMeshStandardMaterial?mt.environment:null,pn=ue===null?X.outputColorSpace:ue.isXRRenderTarget===!0?ue.texture.colorSpace:zg,jn=(Et.isMeshStandardMaterial?bt:Se).get(Et.envMap||_n),mn=Et.vertexColors===!0&&!!Lt.attributes.color&&Lt.attributes.color.itemSize===4,Wn=!!Lt.attributes.tangent&&(!!Et.normalMap||Et.anisotropy>0),Pn=!!Lt.morphAttributes.position,Rn=!!Lt.morphAttributes.normal,Qn=!!Lt.morphAttributes.color;let Ir=Wp;Et.toneMapped&&(ue===null||ue.isXRRenderTarget===!0)&&(Ir=X.toneMapping);const wr=Lt.morphAttributes.position||Lt.morphAttributes.normal||Lt.morphAttributes.color,On=wr!==void 0?wr.length:0,or=dn.get(Et),gi=O.state.lights;if(pt===!0&&(_t===!0||Re!==H)){const uo=Re===H&&Et.id===ne;Be.setState(Et,Re,uo)}let Cr=!1;Et.version===or.__version?(or.needsLights&&or.lightsStateVersion!==gi.state.version||or.outputColorSpace!==pn||wt.isBatchedMesh&&or.batching===!1||!wt.isBatchedMesh&&or.batching===!0||wt.isBatchedMesh&&or.batchingColor===!0&&wt.colorTexture===null||wt.isBatchedMesh&&or.batchingColor===!1&&wt.colorTexture!==null||wt.isInstancedMesh&&or.instancing===!1||!wt.isInstancedMesh&&or.instancing===!0||wt.isSkinnedMesh&&or.skinning===!1||!wt.isSkinnedMesh&&or.skinning===!0||wt.isInstancedMesh&&or.instancingColor===!0&&wt.instanceColor===null||wt.isInstancedMesh&&or.instancingColor===!1&&wt.instanceColor!==null||wt.isInstancedMesh&&or.instancingMorph===!0&&wt.morphTexture===null||wt.isInstancedMesh&&or.instancingMorph===!1&&wt.morphTexture!==null||or.envMap!==jn||Et.fog===!0&&or.fog!==un||or.numClippingPlanes!==void 0&&(or.numClippingPlanes!==Be.numPlanes||or.numIntersection!==Be.numIntersection)||or.vertexAlphas!==mn||or.vertexTangents!==Wn||or.morphTargets!==Pn||or.morphNormals!==Rn||or.morphColors!==Qn||or.toneMapping!==Ir||or.morphTargetsCount!==On)&&(Cr=!0):(Cr=!0,or.__version=Et.version);let zo=or.currentProgram;Cr===!0&&(zo=kn(Et,mt,wt));let Ll=!1,Go=!1,ea=!1;const ei=zo.getUniforms(),_o=or.uniforms;if(Wt.useProgram(zo.program)&&(Ll=!0,Go=!0,ea=!0),Et.id!==ne&&(ne=Et.id,Go=!0),Ll||H!==Re){Wt.buffers.depth.getReversed()?(ot.copy(Re.projectionMatrix),vme(ot),yme(ot),ei.setValue(Ke,"projectionMatrix",ot)):ei.setValue(Ke,"projectionMatrix",Re.projectionMatrix),ei.setValue(Ke,"viewMatrix",Re.matrixWorldInverse);const xo=ei.map.cameraPosition;xo!==void 0&&xo.setValue(Ke,Mt.setFromMatrixPosition(Re.matrixWorld)),on.logarithmicDepthBuffer&&ei.setValue(Ke,"logDepthBufFC",2/(Math.log(Re.far+1)/Math.LN2)),(Et.isMeshPhongMaterial||Et.isMeshToonMaterial||Et.isMeshLambertMaterial||Et.isMeshBasicMaterial||Et.isMeshStandardMaterial||Et.isShaderMaterial)&&ei.setValue(Ke,"isOrthographic",Re.isOrthographicCamera===!0),H!==Re&&(H=Re,Go=!0,ea=!0)}if(wt.isSkinnedMesh){ei.setOptional(Ke,wt,"bindMatrix"),ei.setOptional(Ke,wt,"bindMatrixInverse");const uo=wt.skeleton;uo&&(uo.boneTexture===null&&uo.computeBoneTexture(),ei.setValue(Ke,"boneTexture",uo.boneTexture,Ve))}wt.isBatchedMesh&&(ei.setOptional(Ke,wt,"batchingTexture"),ei.setValue(Ke,"batchingTexture",wt._matricesTexture,Ve),ei.setOptional(Ke,wt,"batchingIdTexture"),ei.setValue(Ke,"batchingIdTexture",wt._indirectTexture,Ve),ei.setOptional(Ke,wt,"batchingColorTexture"),wt._colorsTexture!==null&&ei.setValue(Ke,"batchingColorTexture",wt._colorsTexture,Ve));const eo=Lt.morphAttributes;if((eo.position!==void 0||eo.normal!==void 0||eo.color!==void 0)&&fe.update(wt,Lt,zo),(Go||or.receiveShadow!==wt.receiveShadow)&&(or.receiveShadow=wt.receiveShadow,ei.setValue(Ke,"receiveShadow",wt.receiveShadow)),Et.isMeshGouraudMaterial&&Et.envMap!==null&&(_o.envMap.value=jn,_o.flipEnvMap.value=jn.isCubeTexture&&jn.isRenderTargetTexture===!1?-1:1),Et.isMeshStandardMaterial&&Et.envMap===null&&mt.environment!==null&&(_o.envMapIntensity.value=mt.environmentIntensity),Go&&(ei.setValue(Ke,"toneMappingExposure",X.toneMappingExposure),or.needsLights&&Vt(_o,ea),un&&Et.fog===!0&&Zt.refreshFogUniforms(_o,un),Zt.refreshMaterialUniforms(_o,Et,Ce,Ie,O.state.transmissionRenderTarget[Re.id]),hw.upload(Ke,Rt(or),_o,Ve)),Et.isShaderMaterial&&Et.uniformsNeedUpdate===!0&&(hw.upload(Ke,Rt(or),_o,Ve),Et.uniformsNeedUpdate=!1),Et.isSpriteMaterial&&ei.setValue(Ke,"center",wt.center),ei.setValue(Ke,"modelViewMatrix",wt.modelViewMatrix),ei.setValue(Ke,"normalMatrix",wt.normalMatrix),ei.setValue(Ke,"modelMatrix",wt.matrixWorld),Et.isShaderMaterial||Et.isRawShaderMaterial){const uo=Et.uniformsGroups;for(let xo=0,kr=uo.length;xo<kr;xo++){const Us=uo[xo];_e.update(Us,zo),_e.bind(Us,zo)}}return zo}function Vt(Re,mt){Re.ambientLightColor.needsUpdate=mt,Re.lightProbe.needsUpdate=mt,Re.directionalLights.needsUpdate=mt,Re.directionalLightShadows.needsUpdate=mt,Re.pointLights.needsUpdate=mt,Re.pointLightShadows.needsUpdate=mt,Re.spotLights.needsUpdate=mt,Re.spotLightShadows.needsUpdate=mt,Re.rectAreaLights.needsUpdate=mt,Re.hemisphereLights.needsUpdate=mt}function En(Re){return Re.isMeshLambertMaterial||Re.isMeshToonMaterial||Re.isMeshPhongMaterial||Re.isMeshStandardMaterial||Re.isShadowMaterial||Re.isShaderMaterial&&Re.lights===!0}this.getActiveCubeFace=function(){return se},this.getActiveMipmapLevel=function(){return J},this.getRenderTarget=function(){return ue},this.setRenderTargetTextures=function(Re,mt,Lt){const Et=dn.get(Re);Et.__autoAllocateDepthBuffer=Re.resolveDepthBuffer===!1,Et.__autoAllocateDepthBuffer===!1&&(Et.__useRenderToTexture=!1),dn.get(Re.texture).__webglTexture=mt,dn.get(Re.depthTexture).__webglTexture=Et.__autoAllocateDepthBuffer?void 0:Lt,Et.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(Re,mt){const Lt=dn.get(Re);Lt.__webglFramebuffer=mt,Lt.__useDefaultFramebuffer=mt===void 0};const Bn=Ke.createFramebuffer();this.setRenderTarget=function(Re,mt=0,Lt=0){ue=Re,se=mt,J=Lt;let Et=!0,wt=null,un=!1,_n=!1;if(Re){const jn=dn.get(Re);if(jn.__useDefaultFramebuffer!==void 0)Wt.bindFramebuffer(Ke.FRAMEBUFFER,null),Et=!1;else if(jn.__webglFramebuffer===void 0)Ve.setupRenderTarget(Re);else if(jn.__hasExternalTextures)Ve.rebindTextures(Re,dn.get(Re.texture).__webglTexture,dn.get(Re.depthTexture).__webglTexture);else if(Re.depthBuffer){const Pn=Re.depthTexture;if(jn.__boundDepthTexture!==Pn){if(Pn!==null&&dn.has(Pn)&&(Re.width!==Pn.image.width||Re.height!==Pn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Ve.setupDepthRenderbuffer(Re)}}const mn=Re.texture;(mn.isData3DTexture||mn.isDataArrayTexture||mn.isCompressedArrayTexture)&&(_n=!0);const Wn=dn.get(Re).__webglFramebuffer;Re.isWebGLCubeRenderTarget?(Array.isArray(Wn[mt])?wt=Wn[mt][Lt]:wt=Wn[mt],un=!0):Re.samples>0&&Ve.useMultisampledRTT(Re)===!1?wt=dn.get(Re).__webglMultisampledFramebuffer:Array.isArray(Wn)?wt=Wn[Lt]:wt=Wn,de.copy(Re.viewport),Ee.copy(Re.scissor),Pe=Re.scissorTest}else de.copy(Le).multiplyScalar(Ce).floor(),Ee.copy(lt).multiplyScalar(Ce).floor(),Pe=Ht;if(Lt!==0&&(wt=Bn),Wt.bindFramebuffer(Ke.FRAMEBUFFER,wt)&&Et&&Wt.drawBuffers(Re,wt),Wt.viewport(de),Wt.scissor(Ee),Wt.setScissorTest(Pe),un){const jn=dn.get(Re.texture);Ke.framebufferTexture2D(Ke.FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,Ke.TEXTURE_CUBE_MAP_POSITIVE_X+mt,jn.__webglTexture,Lt)}else if(_n){const jn=dn.get(Re.texture),mn=mt;Ke.framebufferTextureLayer(Ke.FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,jn.__webglTexture,Lt,mn)}else if(Re!==null&&Lt!==0){const jn=dn.get(Re.texture);Ke.framebufferTexture2D(Ke.FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,Ke.TEXTURE_2D,jn.__webglTexture,Lt)}ne=-1},this.readRenderTargetPixels=function(Re,mt,Lt,Et,wt,un,_n){if(!(Re&&Re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let pn=dn.get(Re).__webglFramebuffer;if(Re.isWebGLCubeRenderTarget&&_n!==void 0&&(pn=pn[_n]),pn){Wt.bindFramebuffer(Ke.FRAMEBUFFER,pn);try{const jn=Re.texture,mn=jn.format,Wn=jn.type;if(!on.textureFormatReadable(mn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!on.textureTypeReadable(Wn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}mt>=0&&mt<=Re.width-Et&&Lt>=0&&Lt<=Re.height-wt&&Ke.readPixels(mt,Lt,Et,wt,Ye.convert(mn),Ye.convert(Wn),un)}finally{const jn=ue!==null?dn.get(ue).__webglFramebuffer:null;Wt.bindFramebuffer(Ke.FRAMEBUFFER,jn)}}},this.readRenderTargetPixelsAsync=async function(Re,mt,Lt,Et,wt,un,_n){if(!(Re&&Re.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let pn=dn.get(Re).__webglFramebuffer;if(Re.isWebGLCubeRenderTarget&&_n!==void 0&&(pn=pn[_n]),pn)if(mt>=0&&mt<=Re.width-Et&&Lt>=0&&Lt<=Re.height-wt){Wt.bindFramebuffer(Ke.FRAMEBUFFER,pn);const jn=Re.texture,mn=jn.format,Wn=jn.type;if(!on.textureFormatReadable(mn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!on.textureTypeReadable(Wn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Pn=Ke.createBuffer();Ke.bindBuffer(Ke.PIXEL_PACK_BUFFER,Pn),Ke.bufferData(Ke.PIXEL_PACK_BUFFER,un.byteLength,Ke.STREAM_READ),Ke.readPixels(mt,Lt,Et,wt,Ye.convert(mn),Ye.convert(Wn),0);const Rn=ue!==null?dn.get(ue).__webglFramebuffer:null;Wt.bindFramebuffer(Ke.FRAMEBUFFER,Rn);const Qn=Ke.fenceSync(Ke.SYNC_GPU_COMMANDS_COMPLETE,0);return Ke.flush(),await gme(Ke,Qn,4),Ke.bindBuffer(Ke.PIXEL_PACK_BUFFER,Pn),Ke.getBufferSubData(Ke.PIXEL_PACK_BUFFER,0,un),Ke.deleteBuffer(Pn),Ke.deleteSync(Qn),un}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(Re,mt=null,Lt=0){const Et=Math.pow(2,-Lt),wt=Math.floor(Re.image.width*Et),un=Math.floor(Re.image.height*Et),_n=mt!==null?mt.x:0,pn=mt!==null?mt.y:0;Ve.setTexture2D(Re,0),Ke.copyTexSubImage2D(Ke.TEXTURE_2D,Lt,0,0,_n,pn,wt,un),Wt.unbindTexture()};const In=Ke.createFramebuffer(),fr=Ke.createFramebuffer();this.copyTextureToTexture=function(Re,mt,Lt=null,Et=null,wt=0,un=null){un===null&&(wt!==0?(uw("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),un=wt,wt=0):un=0);let _n,pn,jn,mn,Wn,Pn,Rn,Qn,Ir;const wr=Re.isCompressedTexture?Re.mipmaps[un]:Re.image;if(Lt!==null)_n=Lt.max.x-Lt.min.x,pn=Lt.max.y-Lt.min.y,jn=Lt.isBox3?Lt.max.z-Lt.min.z:1,mn=Lt.min.x,Wn=Lt.min.y,Pn=Lt.isBox3?Lt.min.z:0;else{const eo=Math.pow(2,-wt);_n=Math.floor(wr.width*eo),pn=Math.floor(wr.height*eo),Re.isDataArrayTexture?jn=wr.depth:Re.isData3DTexture?jn=Math.floor(wr.depth*eo):jn=1,mn=0,Wn=0,Pn=0}Et!==null?(Rn=Et.x,Qn=Et.y,Ir=Et.z):(Rn=0,Qn=0,Ir=0);const On=Ye.convert(mt.format),or=Ye.convert(mt.type);let gi;mt.isData3DTexture?(Ve.setTexture3D(mt,0),gi=Ke.TEXTURE_3D):mt.isDataArrayTexture||mt.isCompressedArrayTexture?(Ve.setTexture2DArray(mt,0),gi=Ke.TEXTURE_2D_ARRAY):(Ve.setTexture2D(mt,0),gi=Ke.TEXTURE_2D),Ke.pixelStorei(Ke.UNPACK_FLIP_Y_WEBGL,mt.flipY),Ke.pixelStorei(Ke.UNPACK_PREMULTIPLY_ALPHA_WEBGL,mt.premultiplyAlpha),Ke.pixelStorei(Ke.UNPACK_ALIGNMENT,mt.unpackAlignment);const Cr=Ke.getParameter(Ke.UNPACK_ROW_LENGTH),zo=Ke.getParameter(Ke.UNPACK_IMAGE_HEIGHT),Ll=Ke.getParameter(Ke.UNPACK_SKIP_PIXELS),Go=Ke.getParameter(Ke.UNPACK_SKIP_ROWS),ea=Ke.getParameter(Ke.UNPACK_SKIP_IMAGES);Ke.pixelStorei(Ke.UNPACK_ROW_LENGTH,wr.width),Ke.pixelStorei(Ke.UNPACK_IMAGE_HEIGHT,wr.height),Ke.pixelStorei(Ke.UNPACK_SKIP_PIXELS,mn),Ke.pixelStorei(Ke.UNPACK_SKIP_ROWS,Wn),Ke.pixelStorei(Ke.UNPACK_SKIP_IMAGES,Pn);const ei=Re.isDataArrayTexture||Re.isData3DTexture,_o=mt.isDataArrayTexture||mt.isData3DTexture;if(Re.isDepthTexture){const eo=dn.get(Re),uo=dn.get(mt),xo=dn.get(eo.__renderTarget),kr=dn.get(uo.__renderTarget);Wt.bindFramebuffer(Ke.READ_FRAMEBUFFER,xo.__webglFramebuffer),Wt.bindFramebuffer(Ke.DRAW_FRAMEBUFFER,kr.__webglFramebuffer);for(let Us=0;Us<jn;Us++)ei&&(Ke.framebufferTextureLayer(Ke.READ_FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,dn.get(Re).__webglTexture,wt,Pn+Us),Ke.framebufferTextureLayer(Ke.DRAW_FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,dn.get(mt).__webglTexture,un,Ir+Us)),Ke.blitFramebuffer(mn,Wn,_n,pn,Rn,Qn,_n,pn,Ke.DEPTH_BUFFER_BIT,Ke.NEAREST);Wt.bindFramebuffer(Ke.READ_FRAMEBUFFER,null),Wt.bindFramebuffer(Ke.DRAW_FRAMEBUFFER,null)}else if(wt!==0||Re.isRenderTargetTexture||dn.has(Re)){const eo=dn.get(Re),uo=dn.get(mt);Wt.bindFramebuffer(Ke.READ_FRAMEBUFFER,In),Wt.bindFramebuffer(Ke.DRAW_FRAMEBUFFER,fr);for(let xo=0;xo<jn;xo++)ei?Ke.framebufferTextureLayer(Ke.READ_FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,eo.__webglTexture,wt,Pn+xo):Ke.framebufferTexture2D(Ke.READ_FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,Ke.TEXTURE_2D,eo.__webglTexture,wt),_o?Ke.framebufferTextureLayer(Ke.DRAW_FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,uo.__webglTexture,un,Ir+xo):Ke.framebufferTexture2D(Ke.DRAW_FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,Ke.TEXTURE_2D,uo.__webglTexture,un),wt!==0?Ke.blitFramebuffer(mn,Wn,_n,pn,Rn,Qn,_n,pn,Ke.COLOR_BUFFER_BIT,Ke.NEAREST):_o?Ke.copyTexSubImage3D(gi,un,Rn,Qn,Ir+xo,mn,Wn,_n,pn):Ke.copyTexSubImage2D(gi,un,Rn,Qn,mn,Wn,_n,pn);Wt.bindFramebuffer(Ke.READ_FRAMEBUFFER,null),Wt.bindFramebuffer(Ke.DRAW_FRAMEBUFFER,null)}else _o?Re.isDataTexture||Re.isData3DTexture?Ke.texSubImage3D(gi,un,Rn,Qn,Ir,_n,pn,jn,On,or,wr.data):mt.isCompressedArrayTexture?Ke.compressedTexSubImage3D(gi,un,Rn,Qn,Ir,_n,pn,jn,On,wr.data):Ke.texSubImage3D(gi,un,Rn,Qn,Ir,_n,pn,jn,On,or,wr):Re.isDataTexture?Ke.texSubImage2D(Ke.TEXTURE_2D,un,Rn,Qn,_n,pn,On,or,wr.data):Re.isCompressedTexture?Ke.compressedTexSubImage2D(Ke.TEXTURE_2D,un,Rn,Qn,wr.width,wr.height,On,wr.data):Ke.texSubImage2D(Ke.TEXTURE_2D,un,Rn,Qn,_n,pn,On,or,wr);Ke.pixelStorei(Ke.UNPACK_ROW_LENGTH,Cr),Ke.pixelStorei(Ke.UNPACK_IMAGE_HEIGHT,zo),Ke.pixelStorei(Ke.UNPACK_SKIP_PIXELS,Ll),Ke.pixelStorei(Ke.UNPACK_SKIP_ROWS,Go),Ke.pixelStorei(Ke.UNPACK_SKIP_IMAGES,ea),un===0&&mt.generateMipmaps&&Ke.generateMipmap(gi),Wt.unbindTexture()},this.copyTextureToTexture3D=function(Re,mt,Lt=null,Et=null,wt=0){return uw('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(Re,mt,Lt,Et,wt)},this.initRenderTarget=function(Re){dn.get(Re).__webglFramebuffer===void 0&&Ve.setupRenderTarget(Re)},this.initTexture=function(Re){Re.isCubeTexture?Ve.setTextureCube(Re,0):Re.isData3DTexture?Ve.setTexture3D(Re,0):Re.isDataArrayTexture||Re.isCompressedArrayTexture?Ve.setTexture2DArray(Re,0):Ve.setTexture2D(Re,0),Wt.unbindTexture()},this.resetState=function(){se=0,J=0,ue=null,Wt.reset(),st.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return cf}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=oi._getDrawingBufferColorSpace(e),n.unpackColorSpace=oi._getUnpackColorSpace()}}var U_e=Object.defineProperty,kR=(t,e)=>{for(var n in e)U_e(t,n,{get:e[n],enumerable:!0})},Wy={};kR(Wy,{ACTIONS:()=>j8,ANIMATION_MIN_DURATION:()=>gA,CAPTURE_EVENTS_CLASS:()=>e1,CTRLZOOM_TIMEOUT:()=>V8,DBLCLICK_DELAY:()=>B8,EASINGS:()=>dw,ICONS:()=>lh,IDS:()=>Ys,KEY_CODES:()=>Os,LONGTOUCH_DELAY:()=>U8,MOVE_THRESHOLD:()=>N8,SPHERE_RADIUS:()=>Og,TWOFINGERSOVERLAY_DELAY:()=>$8,VIEWER_DATA:()=>im});var $_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,V_e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',j_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,H_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,G_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,W_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,q_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kunk from the Noun Project--></svg>
`,X_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,Z_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,gA=500,N8=4,B8=300,U8=500,$8=100,V8=2e3,Og=10,im="photoSphereViewer",e1="psv--capture-event",j8=(t=>(t.ROTATE_UP="ROTATE_UP",t.ROTATE_DOWN="ROTATE_DOWN",t.ROTATE_RIGHT="ROTATE_RIGHT",t.ROTATE_LEFT="ROTATE_LEFT",t.ZOOM_IN="ZOOM_IN",t.ZOOM_OUT="ZOOM_OUT",t))(j8||{}),Ys={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},Os={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},lh={arrow:$_e,close:V_e,download:j_e,fullscreenIn:H_e,fullscreenOut:G_e,info:W_e,menu:q_e,zoomIn:X_e,zoomOut:Z_e},dw={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inSine:t=>1-Math.cos(t*(Math.PI/2)),outSine:t=>Math.sin(t*(Math.PI/2)),inOutSine:t=>.5-.5*Math.cos(Math.PI*t),inExpo:t=>Math.pow(2,10*(t-1)),outExpo:t=>1-Math.pow(2,-10*t),inOutExpo:t=>(t=t*2-1)<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t),inCirc:t=>1-Math.sqrt(1-t*t),outCirc:t=>Math.sqrt(1-(t-1)*(t-1)),inOutCirc:t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)},nr={};kR(nr,{Animation:()=>Kw,Dynamic:()=>f_,MultiDynamic:()=>d$,PressHandler:()=>u2,Slider:()=>p$,SliderDirection:()=>f$,addClasses:()=>zR,angle:()=>G8,applyEulerInverse:()=>bA,checkClosedShadowDom:()=>u$,checkStylesheet:()=>c$,checkVersion:()=>UR,cleanCssPosition:()=>a$,clone:()=>a2,createTexture:()=>xA,cssPositionIsOrdered:()=>BR,dasherize:()=>exe,deepEqual:()=>i$,deepmerge:()=>n$,distance:()=>H8,exitFullscreen:()=>e$,firstNonNull:()=>kp,getAbortError:()=>yA,getAngle:()=>q8,getClosest:()=>Z8,getConfigParser:()=>c2,getElement:()=>X8,getEventTarget:()=>qw,getMatchingTarget:()=>Y8,getPosition:()=>K8,getShortestArc:()=>W8,getStyleProperty:()=>Qh,getTouchData:()=>vA,getXMPValue:()=>rc,greatArcDistance:()=>K_e,hasParent:()=>Q_e,invertResolvableBoolean:()=>l2,isAbortError:()=>s$,isEmpty:()=>r$,isExtendedPosition:()=>NR,isFullscreenEnabled:()=>J8,isNil:()=>Fs,isPlainObject:()=>OR,logWarn:()=>Ks,mergePanoData:()=>h$,parseAngle:()=>qh,parsePoint:()=>txe,parseSpeed:()=>l$,removeClasses:()=>J_e,requestFullscreen:()=>Q8,resolveBoolean:()=>FR,speedToDuration:()=>_A,sum:()=>Y_e,throttle:()=>t$,toggleClass:()=>s2,wrap:()=>I_});function I_(t,e){let n=t%e;return n<0&&(n+=e),n}function Y_e(t){return t.reduce((e,n)=>e+n,0)}function H8(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function G8(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function W8(t,e){return[0,Math.PI*2,-Math.PI*2].reduce((r,a)=>{const l=e-t+a;return Math.abs(l)<Math.abs(r)?l:r},1/0)}function q8(t,e){return Math.acos(Math.cos(t.pitch)*Math.cos(e.pitch)*Math.cos(t.yaw-e.yaw)+Math.sin(t.pitch)*Math.sin(e.pitch))}function K_e([t,e],[n,r]){t-n>Math.PI?t-=2*Math.PI:t-n<-Math.PI&&(t+=2*Math.PI);const a=(n-t)*Math.cos((e+r)/2),l=r-e;return Math.sqrt(a*a+l*l)}function X8(t){return typeof t=="string"?t.match(/^[a-z]/i)?document.getElementById(t):document.querySelector(t):t}function s2(t,e,n){n===void 0?t.classList.toggle(e):n?t.classList.add(e):n||t.classList.remove(e)}function zR(t,e){t.classList.add(...e.split(" ").filter(n=>!!n))}function J_e(t,e){t.classList.remove(...e.split(" ").filter(n=>!!n))}function Q_e(t,e){let n=t;do{if(n===e)return!0;n=n.parentElement}while(n);return!1}function Z8(t,e){if(!t?.matches)return null;let n=t;do{if(n.matches(e))return n;n=n.parentElement}while(n);return null}function qw(t){return t?.composedPath()[0]||null}function Y8(t,e){return t?t.composedPath().find(n=>!(n instanceof HTMLElement)&&!(n instanceof SVGElement)?!1:n.matches(e)):null}function K8(t){let e=0,n=0,r=t;for(;r;)e+=r.offsetLeft-r.scrollLeft+r.clientLeft,n+=r.offsetTop-r.scrollTop+r.clientTop,r=r.offsetParent;return e-=window.scrollX,n-=window.scrollY,{x:e,y:n}}function Qh(t,e){return window.getComputedStyle(t).getPropertyValue(e)}function vA(t){if(t.touches.length<2)return null;const e={x:t.touches[0].clientX,y:t.touches[0].clientY},n={x:t.touches[1].clientX,y:t.touches[1].clientY};return{distance:H8(e,n),angle:G8(e,n),center:{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}}var Xw;function J8(t,e=!1){return e?t===Xw:document.fullscreenElement===t}function Q8(t,e=!1){e?(Xw=t,t.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):t.requestFullscreen()}function e$(t=!1){t?(Xw.classList.remove("psv-fullscreen-emulation"),Xw=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function exe(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(e,n)=>(n>0?"-":"")+e.toLowerCase())}function t$(t,e){let n=!1;return function(...r){n||(n=!0,setTimeout(()=>{t.apply(this,r),n=!1},e))}}function OR(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function n$(t,e){const n=e;return function r(a,l){return Array.isArray(l)?(!a||!Array.isArray(a)?a=[]:a.length=0,l.forEach((u,s)=>{a[s]=r(null,u)})):typeof l=="object"?((!a||Array.isArray(a))&&(a={}),Object.keys(l).forEach(u=>{u!=="__proto__"&&(typeof l[u]!="object"||!l[u]||!OR(l[u])?a[u]=l[u]:l[u]!==n&&(a[u]?r(a[u],l[u]):a[u]=r(null,l[u])))})):a=l,a}(t,e)}function a2(t){return n$(null,t)}function r$(t){return!t||Object.keys(t).length===0&&t.constructor===Object}function Fs(t){return t==null}function kp(...t){for(const e of t)if(!Fs(e))return e;return null}function i$(t,e){if(t===e)return!0;if(r4(t)&&r4(e)){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n of Object.keys(t))if(!i$(t[n],e[n]))return!1;return!0}else return!1}function r4(t){return typeof t=="object"&&t!==null}var qn=class o$ extends Error{constructor(e,n){super(n&&n instanceof Error?`${e}: ${n.message}`:e),this.name="PSVError",Error.captureStackTrace?.(this,o$)}};function FR(t,e){OR(t)?(e(t.initial,!0),t.promise.then(n=>e(n,!1))):e(t,!0)}function l2(t){return{initial:!t.initial,promise:t.promise.then(e=>!e)}}function yA(){const t=new Error("Loading was aborted.");return t.name="AbortError",t}function s$(t){return t?.name==="AbortError"}function Ks(t){console.warn(`PhotoSphereViewer: ${t}`)}function NR(t){return!t||Array.isArray(t)?!1:[["textureX","textureY"],["yaw","pitch"]].some(([e,n])=>t[e]!==void 0&&t[n]!==void 0)}function rc(t,e,n=!0){let r=t.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(r!==null){const a=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(a)?null:a}if(r=t.match("GPano:"+e+'="(.*?)"'),r!==null){const a=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(a)?null:a}return null}var i4={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Zw=["left","center","right"],Yw=["top","center","bottom"],o4=[...Zw,...Yw],Xc="center";function txe(t){if(!t)return{x:.5,y:.5};if(typeof t=="object")return t;let e=t.toLocaleLowerCase().split(" ").slice(0,2);e.length===1&&(i4[e[0]]?e=[e[0],Xc]:e=[e[0],e[0]]);const n=e[1]!=="left"&&e[1]!=="right"&&e[0]!=="top"&&e[0]!=="bottom";e=e.map(a=>i4[a]||a),n||e.reverse();const r=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return r?{x:parseFloat(r[1])/100,y:parseFloat(r[2])/100}:{x:.5,y:.5}}function a$(t,{allowCenter:e,cssOrder:n}={allowCenter:!0,cssOrder:!0}){return t?(typeof t=="string"&&(t=t.split(" ")),t.length===1&&(t[0]===Xc?t=[Xc,Xc]:Zw.indexOf(t[0])!==-1?t=[Xc,t[0]]:Yw.indexOf(t[0])!==-1&&(t=[t[0],Xc])),t.length!==2||o4.indexOf(t[0])===-1||o4.indexOf(t[1])===-1?(Ks(`Unparsable position ${t}`),null):!e&&t[0]===Xc&&t[1]===Xc?(Ks("Invalid position center center"),null):(n&&!BR(t)&&(t=[t[1],t[0]]),t[1]===Xc&&Zw.indexOf(t[0])!==-1&&(t=[Xc,t[0]]),t[0]===Xc&&Yw.indexOf(t[1])!==-1&&(t=[t[1],Xc]),t)):null}function BR(t){return Yw.indexOf(t[0])!==-1&&Zw.indexOf(t[1])!==-1}function l$(t){let e;if(typeof t=="string"){const n=t.toString().trim();let r=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const a=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(a.match(/(pm|per minute)$/)&&(r/=60),a){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=jr.degToRad(r);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=r;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=r*Math.PI*2;break;default:throw new qn(`Unknown speed unit "${a}"`)}}else e=t;return e}function _A(t,e){if(typeof t!="number"){const n=l$(t);return e/Math.abs(n)*1e3}else return Math.abs(t)}function qh(t,e=!1,n=e){let r;if(typeof t=="string"){const a=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!a)throw new qn(`Unknown angle "${t}"`);const l=parseFloat(a[1]),u=a[2];if(u)switch(u){case"deg":case"degs":r=jr.degToRad(l);break;case"rad":case"rads":r=l;break;default:throw new qn(`Unknown angle unit "${u}"`)}else r=l}else if(typeof t=="number"&&!isNaN(t))r=t;else throw new qn(`Unknown angle "${t}"`);return r=I_(e?r+Math.PI:r,Math.PI*2),e?jr.clamp(r-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):r}function xA(t,e=!1){const n=new Js(t);return n.needsUpdate=!0,n.minFilter=e?Vp:hc,n.generateMipmaps=e,n.anisotropy=e?2:1,n}var s4=new pm;function bA(t,e){s4.setFromEuler(e).invert(),t.applyQuaternion(s4)}function c2(t,e){const n=function(r){const a=a2({...t,...r}),l={};for(let[u,s]of Object.entries(a)){if(e&&u in e)s=e[u](s,{rawConfig:a,defValue:t[u]});else if(!(u in t)){Ks(`Unknown option ${u}`);continue}l[u]=s}return l};return n.defaults=t,n.parsers=e||{},n}function c$(t,e){Qh(t,`--psv-${e}-loaded`)!=="true"&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${e}/index.css" is not loaded`)}function UR(t,e,n){e&&e!==n&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${t} is in version ${e} but @photo-sphere-viewer/core is in version ${n}`)}function u$(t){do{if(t instanceof ShadowRoot&&t.mode==="closed"){console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");return}t=t.parentNode}while(t)}function h$(t,e,n,r){const a={isEquirectangular:!0,fullWidth:kp(n?.fullWidth,r?.fullWidth),fullHeight:kp(n?.fullHeight,r?.fullHeight),croppedWidth:t,croppedHeight:e,croppedX:kp(n?.croppedX,r?.croppedX),croppedY:kp(n?.croppedY,r?.croppedY),poseHeading:kp(n?.poseHeading,r?.poseHeading,0),posePitch:kp(n?.posePitch,r?.posePitch,0),poseRoll:kp(n?.poseRoll,r?.poseRoll,0),initialHeading:r?.initialHeading,initialPitch:r?.initialPitch,initialFov:r?.initialFov};return!a.fullWidth&&!a.fullHeight&&(a.fullWidth=Math.max(t,e*2),a.fullHeight=Math.round(a.fullWidth/2)),a.fullWidth||(a.fullWidth=a.fullHeight*2),a.fullHeight||(a.fullHeight=Math.round(a.fullWidth/2)),a.croppedX===null&&(a.croppedX=Math.round((a.fullWidth-t)/2)),a.croppedY===null&&(a.croppedY=Math.round((a.fullHeight-e)/2)),Math.abs(a.fullWidth-a.fullHeight*2)>1&&(Ks("Invalid panoData, fullWidth should be twice fullHeight"),a.fullHeight=Math.round(a.fullWidth/2)),a.croppedX+a.croppedWidth>a.fullWidth&&(Ks("Invalid panoData, croppedX + croppedWidth > fullWidth"),a.croppedX=a.fullWidth-a.croppedWidth),a.croppedY+a.croppedHeight>a.fullHeight&&(Ks("Invalid panoData, croppedY + croppedHeight > fullHeight"),a.croppedY=a.fullHeight-a.croppedHeight),a.croppedX<0&&(Ks("Invalid panoData, croppedX < 0"),a.croppedX=0),a.croppedY<0&&(Ks("Invalid panoData, croppedY < 0"),a.croppedY=0),a}var Kw=class{constructor(t){this.easing=dw.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing=typeof t.easing=="function"?t.easing:dw[t.easing]||dw.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(e=>this.__run(e))},t.delay||0)):this.resolved=!0}__run(t){if(this.cancelled)return;this.start||(this.start=t);const e=(t-this.start)/this.options.duration,n={};if(e<1){for(const[r,a]of Object.entries(this.options.properties))if(a){const l=a.start+(a.end-a.start)*this.easing(e);n[r]=l}this.options.onTick(n,e),this.animationFrame=window.requestAnimationFrame(r=>this.__run(r))}else{for(const[r,a]of Object.entries(this.options.properties))a&&(n[r]=a.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(t){t?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(e=>e(t)),this.callbacks.length=0}then(t){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(t):new Promise(e=>{this.callbacks.push(e)}).then(t)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},f_=class{constructor(t,e){if(this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&this.min!==0)throw new qn("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(t){this.__current=t}setSpeed(t){this.speed=t}goto(t,e=1){this.mode=2,this.target=this.wrap?I_(t,this.max):jr.clamp(t,this.min,this.max),this.speedMult=e}step(t,e=1){e===0?this.setValue(this.current+t):(this.mode!==2&&(this.target=this.current),this.goto(this.target+t,e))}roll(t=!1,e=1){this.mode=1,this.target=t?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(t){return this.target=this.wrap?I_(t,this.max):jr.clamp(t,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(t){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const r=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=r&&(this.mode=0)}let e=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+t/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-t/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*t/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*t/1e3)),n!==null&&(n=this.wrap?I_(n,this.max):jr.clamp(n,this.min,this.max),n!==this.current)?(this.current=n,this.fn&&this.fn(this.current),!0):!1}},d$=class{constructor(t,e){this.fn=t,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((t,[e,n])=>(t[e]=n.current,t),{})}setSpeed(t){for(const e of Object.values(this.dynamics))e.setSpeed(t)}goto(t,e=1){for(const[n,r]of Object.entries(t))this.dynamics[n].goto(r,e)}step(t,e=1){if(e===0)this.setValue(Object.keys(t).reduce((n,r)=>(n[r]=t[r]+this.dynamics[r].current,n),{}));else for(const[n,r]of Object.entries(t))this.dynamics[n].step(r,e)}roll(t,e=1){for(const[n,r]of Object.entries(t))this.dynamics[n].roll(r,e)}stop(){for(const t of Object.values(this.dynamics))t.stop()}setValue(t){let e=!1;for(const[n,r]of Object.entries(t))e=this.dynamics[n].setValue(r)||e;return e&&this.fn&&this.fn(this.current),e}update(t){let e=!1;for(const n of Object.values(this.dynamics))e=n.update(t)||e;return e&&this.fn&&this.fn(this.current),e}},u2=class{constructor(t=200){this.delay=t,this.time=0,this.delay=t}get pending(){return this.time!==0}down(t){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime(),this.data=t}up(t){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{t(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(t(this.data),this.time=0,this.data=void 0)}},f$=(t=>(t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t))(f$||{}),p$=class{constructor(t,e,n){this.container=t,this.direction=e,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(t){switch(t.type){case"click":t.stopPropagation();break;case"mousedown":this.__onMouseDown(t);break;case"mouseenter":this.__onMouseEnter(t);break;case"mouseleave":this.__onMouseLeave(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break}}__onMouseDown(t){this.mousedown=!0,this.__update(t.clientX,t.clientY,!0)}__onMouseEnter(t){this.mouseover=!0,this.__update(t.clientX,t.clientY,!0)}__onTouchStart(t){this.mouseover=!0,this.mousedown=!0;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(t){(this.mousedown||this.mouseover)&&(t.stopPropagation(),this.__update(t.clientX,t.clientY,!0))}__onTouchMove(t){if(this.mousedown||this.mouseover){t.stopPropagation();const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(t){this.mousedown&&(this.mousedown=!1,this.__update(t.clientX,t.clientY,!1))}__onMouseLeave(t){this.mouseover&&(this.mouseover=!1,this.__update(t.clientX,t.clientY,!0))}__onTouchEnd(t){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(t,e,n){const r=this.container.getBoundingClientRect();let a;this.isVertical?a=jr.clamp((r.bottom-e)/r.height,0,1):a=jr.clamp((t-r.left)/r.width,0,1),this.listener({value:a,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:t,clientY:e}})}},ar={};kR(ar,{BeforeAnimateEvent:()=>$R,BeforeRenderEvent:()=>R_,BeforeRotateEvent:()=>w$,ClickEvent:()=>E$,ConfigChangedEvent:()=>Cl,DoubleClickEvent:()=>I$,FullscreenEvent:()=>D_,HideNotificationEvent:()=>L_,HideOverlayEvent:()=>F$,HidePanelEvent:()=>qp,HideTooltipEvent:()=>V$,KeypressEvent:()=>Xp,LoadProgressEvent:()=>q$,ObjectEnterEvent:()=>DV,ObjectEvent:()=>h2,ObjectHoverEvent:()=>FV,ObjectLeaveEvent:()=>wA,PanoramaErrorEvent:()=>tV,PanoramaLoadEvent:()=>Y$,PanoramaLoadedEvent:()=>Ty,PositionUpdatedEvent:()=>k_,ReadyEvent:()=>O_,RenderEvent:()=>fV,RollUpdatedEvent:()=>z_,ShowNotificationEvent:()=>F_,ShowOverlayEvent:()=>yV,ShowPanelEvent:()=>Zp,ShowTooltipEvent:()=>SV,SizeUpdatedEvent:()=>N_,StopAllEvent:()=>B_,TransitionDoneEvent:()=>iV,ViewerEvent:()=>Pi,ZoomUpdatedEvent:()=>hf});var t1=class extends Event{constructor(t,e=!1){super(t,{cancelable:e})}},m$=class extends EventTarget{dispatchEvent(t){return super.dispatchEvent(t)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e,n){super.removeEventListener(t,e,n)}},Pi=class extends t1{},g$=class v$ extends Pi{constructor(e,n){super(v$.type,!0),this.position=e,this.zoomLevel=n}};g$.type="before-animate";var $R=g$,y$=class _$ extends Pi{constructor(e,n){super(_$.type),this.timestamp=e,this.elapsed=n}};y$.type="before-render";var R_=y$,x$=class b$ extends Pi{constructor(e){super(b$.type,!0),this.position=e}};x$.type="before-rotate";var w$=x$,S$=class M$ extends Pi{constructor(e){super(M$.type),this.data=e}};S$.type="click";var E$=S$,C$=class T$ extends Pi{constructor(e){super(T$.type),this.options=e}containsOptions(...e){return e.some(n=>this.options.includes(n))}};C$.type="config-changed";var Cl=C$,P$=class A$ extends Pi{constructor(e){super(A$.type),this.data=e}};P$.type="dblclick";var I$=P$,R$=class D$ extends Pi{constructor(e){super(D$.type),this.fullscreenEnabled=e}};R$.type="fullscreen";var D_=R$,L$=class k$ extends Pi{constructor(e){super(k$.type),this.notificationId=e}};L$.type="hide-notification";var L_=L$,z$=class O$ extends Pi{constructor(e){super(O$.type),this.overlayId=e}};z$.type="hide-overlay";var F$=z$,N$=class B$ extends Pi{constructor(e){super(B$.type),this.panelId=e}};N$.type="hide-panel";var qp=N$,U$=class $$ extends Pi{constructor(e){super($$.type),this.tooltipData=e}};U$.type="hide-tooltip";var V$=U$,j$=class H$ extends Pi{constructor(e,n){super(H$.type,!0),this.key=e,this.originalEvent=n}};j$.type="key-press";var Xp=j$,G$=class W$ extends Pi{constructor(e){super(W$.type),this.progress=e}};G$.type="load-progress";var q$=G$,X$=class Z$ extends Pi{constructor(e){super(Z$.type),this.panorama=e}};X$.type="panorama-load";var Y$=X$,K$=class J$ extends Pi{constructor(e){super(J$.type),this.data=e}};K$.type="panorama-loaded";var Ty=K$,Q$=class eV extends Pi{constructor(e,n){super(eV.type),this.panorama=e,this.error=n}};Q$.type="panorama-error";var tV=Q$,nV=class rV extends Pi{constructor(e){super(rV.type),this.completed=e}};nV.type="transition-done";var iV=nV,oV=class sV extends Pi{constructor(e){super(sV.type),this.position=e}};oV.type="position-updated";var k_=oV,aV=class lV extends Pi{constructor(e){super(lV.type),this.roll=e}};aV.type="roll-updated";var z_=aV,cV=class uV extends Pi{constructor(){super(uV.type)}};cV.type="ready";var O_=cV,hV=class dV extends Pi{constructor(){super(dV.type)}};hV.type="render";var fV=hV,pV=class mV extends Pi{constructor(e){super(mV.type),this.notificationId=e}};pV.type="show-notification";var F_=pV,gV=class vV extends Pi{constructor(e){super(vV.type),this.overlayId=e}};gV.type="show-overlay";var yV=gV,_V=class xV extends Pi{constructor(e){super(xV.type),this.panelId=e}};_V.type="show-panel";var Zp=_V,bV=class wV extends Pi{constructor(e,n){super(wV.type),this.tooltip=e,this.tooltipData=n}};bV.type="show-tooltip";var SV=bV,MV=class EV extends Pi{constructor(e){super(EV.type),this.size=e}};MV.type="size-updated";var N_=MV,CV=class TV extends Pi{constructor(){super(TV.type)}};CV.type="stop-all";var B_=CV,PV=class AV extends Pi{constructor(e){super(AV.type),this.zoomLevel=e}};PV.type="zoom-updated";var hf=PV,h2=class extends Pi{constructor(t,e,n,r,a){super(t),this.originalEvent=e,this.object=n,this.viewerPoint=r,this.userDataKey=a}},IV=class RV extends h2{constructor(e,n,r,a){super(RV.type,e,n,r,a)}};IV.type="enter-object";var DV=IV,LV=class kV extends h2{constructor(e,n,r,a){super(kV.type,e,n,r,a)}};LV.type="leave-object";var wA=LV,zV=class OV extends h2{constructor(e,n,r,a){super(OV.type,e,n,r,a)}};zV.type="hover-object";var FV=zV,d2=class{constructor(t){this.viewer=t}init(){}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}textureCoordsToSphericalCoords(t,e){throw new qn("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(t,e){throw new qn("Current adapter does not support texture coordinates.")}};d2.supportsDownload=!1;function a4(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof d2)return UR(e.id,e.VERSION,"5.13.4"),e}return null}var J0=`${im}_touchSupport`,Ga={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=ixe(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const t=nxe();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!t,this.maxTextureWidth=t?t.getParameter(t.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=rxe(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!Ga.isWebGLSupported)throw new qn("WebGL 2 is not supported.");if(Ga.maxTextureWidth===0)throw new qn("Unable to detect system capabilities")}};function nxe(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}function rxe(){let t="ontouchstart"in window||navigator.maxTouchPoints>0;J0 in localStorage&&(t=localStorage[J0]==="true");const e=new Promise(n=>{const r=()=>{window.removeEventListener("mousedown",a),window.removeEventListener("touchstart",l),clearTimeout(s)},a=()=>{r(),localStorage[J0]=!1,n(!1)},l=()=>{r(),localStorage[J0]=!0,n(!0)},u=()=>{r(),localStorage[J0]=t,n(t)};window.addEventListener("mousedown",a,!1),window.addEventListener("touchstart",l,!1);const s=setTimeout(u,1e4)});return{initial:t,promise:e}}function ixe(t){let e=t,n=!1;const r=document.createElement("canvas"),a=r.getContext("2d");for(r.width=1,r.height=1;e>1024&&!n;){const l=document.createElement("canvas"),u=l.getContext("2d");l.width=e,l.height=e/2;try{u.fillStyle="white",u.fillRect(e-1,e/2-1,1,1),a.drawImage(l,e-1,e/2-1,1,1,0,0,1,1),a.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch{}l.width=0,l.height=0,n||(e/=2)}if(n)return e;throw new qn("Unable to detect system capabilities")}var oxe=c2({resolution:64,useXmpData:!0,blur:!1},{resolution:t=>{if(!t||!jr.isPowerOfTwo(t))throw new qn("EquirectangularAdapter resolution must be power of two.");return t}}),f2=class NV extends d2{static withConfig(e){return[NV,e]}constructor(e,n){super(e),this.config=oxe(n),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(e,n){if(Fs(e.textureX)||Fs(e.textureY))throw new qn("Texture position is missing 'textureX' or 'textureY'");const r=(e.textureX+n.croppedX)/n.fullWidth*Math.PI*2,a=(e.textureY+n.croppedY)/n.fullHeight*Math.PI;return{yaw:r>=Math.PI?r-Math.PI:r+Math.PI,pitch:Math.PI/2-a}}sphericalCoordsToTextureCoords(e,n){const r=e.yaw/Math.PI/2*n.fullWidth,a=e.pitch/Math.PI*n.fullHeight;let l=Math.round(e.yaw<Math.PI?r+n.fullWidth/2:r-n.fullWidth/2)-n.croppedX,u=Math.round(n.fullHeight/2-a)-n.croppedY;return(l<0||l>n.croppedWidth||u<0||u>n.croppedHeight)&&(l=u=void 0),{textureX:l,textureY:u}}async loadTexture(e,n=!0,r,a=this.config.useXmpData){if(typeof e!="string"&&(typeof e!="object"||!e.path))return Promise.reject(new qn("Invalid panorama url, are you using the right adapter?"));let l;typeof e=="string"?l={path:e,data:r}:l={data:r,...e};const u=await this.viewer.textureLoader.loadFile(l.path,n?M=>this.viewer.textureLoader.dispatchProgress(M):null,l.path),s=a?await this.loadXMP(u):null,m=await this.viewer.textureLoader.blobToImage(u);typeof l.data=="function"&&(l.data=l.data(m,s));const _=h$(m.width,m.height,l.data,s),b=this.createEquirectangularTexture(m);return{panorama:e,texture:b,panoData:_,cacheKey:l.path}}async loadXMP(e){const n=await this.loadBlobAsString(e),r=n.indexOf("<x:xmpmeta");if(r===-1)return null;const a=n.indexOf("</x:xmpmeta>",r);if(a===-1)return null;const l=n.substring(r,a);return l.includes("GPano:")?{fullWidth:rc(l,"FullPanoWidthPixels"),fullHeight:rc(l,"FullPanoHeightPixels"),croppedWidth:rc(l,"CroppedAreaImageWidthPixels"),croppedHeight:rc(l,"CroppedAreaImageHeightPixels"),croppedX:rc(l,"CroppedAreaLeftPixels"),croppedY:rc(l,"CroppedAreaTopPixels"),poseHeading:rc(l,"PoseHeadingDegrees",!1),posePitch:rc(l,"PosePitchDegrees",!1),poseRoll:rc(l,"PoseRollDegrees",!1),initialHeading:rc(l,"InitialViewHeadingDegrees",!1),initialPitch:rc(l,"InitialViewPitchDegrees",!1),initialFov:rc(l,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(e){return new Promise((n,r)=>{const a=new FileReader;a.onload=()=>n(a.result),a.onerror=r,a.readAsText(e)})}createEquirectangularTexture(e){if(this.config.blur||e.width>Ga.maxTextureWidth){const n=Math.min(1,Ga.maxCanvasWidth/e.width),r=new OffscreenCanvas(Math.floor(e.width*n),Math.floor(e.height*n)),a=r.getContext("2d");return this.config.blur&&(a.filter=`blur(${r.width/2048}px)`),a.drawImage(e,0,0,r.width,r.height),xA(r)}return xA(e)}createMesh(e){const n=e.croppedX/e.fullWidth*2*Math.PI,r=e.croppedWidth/e.fullWidth*2*Math.PI,a=e.croppedY/e.fullHeight*Math.PI,l=e.croppedHeight/e.fullHeight*Math.PI,u=new n0(Og,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*r),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*l),-Math.PI/2+n,r,a,l).scale(-1,1,1),s=new rm({depthTest:!1,depthWrite:!1});return new wl(u,s)}setTexture(e,n){e.material.map=n.texture}setTextureOpacity(e,n){e.material.opacity=n,e.material.transparent=n<1}disposeTexture({texture:e}){e.dispose()}disposeMesh(e){e.geometry.dispose(),e.material.dispose()}};f2.id="equirectangular";f2.VERSION="5.13.4";f2.supportsDownload=!0;var VR=f2,BV=class UV extends VR{static withConfig(e){return[UV,e]}constructor(e,n){super(e,{resolution:n?.resolution??64,useXmpData:!1})}async loadTexture(e,n){const r=await super.loadTexture(e,n,null,!1);return r.panoData=null,r}createMesh(){const e=new n0(Og,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),n=e.getAttribute("uv"),r=e.getAttribute("normal");for(let l=0;l<n.count;l++)for(let u=0;u<3;u++){const s=l*3+u,m=r.getX(s),_=r.getY(s),b=r.getZ(s),M=.947;if(l<n.count/6){const C=m===0&&b===0?1:Math.acos(_)/Math.sqrt(m*m+b*b)*(2/Math.PI);n.setXY(s,m*(M/4)*C+1/4,b*(M/2)*C+1/2)}else{const C=m===0&&b===0?1:Math.acos(-_)/Math.sqrt(m*m+b*b)*(2/Math.PI);n.setXY(s,-m*(M/4)*C+3/4,b*(M/2)*C+1/2)}}e.rotateX(-Math.PI/2),e.rotateY(Math.PI);const a=new rm({depthTest:!1,depthWrite:!1});return new wl(e,a)}};BV.id="dual-fisheye";BV.VERSION="5.13.4";var mm=class $V{constructor(e,n){this.parent=e,this.children=[],this.state={visible:!0},this.viewer=e instanceof $V?e.viewer:e,this.container=document.createElement(n.tagName??"div"),this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const e=this.parent.children.indexOf(this);e!==-1&&this.parent.children.splice(e,1),this.children.slice().forEach(n=>n.destroy()),this.children.length=0}toggle(e=!this.isVisible()){e?this.show():this.hide()}hide(e){this.container.style.display="none",this.state.visible=!1}show(e){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},sxe=c2({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),qa=class extends mm{constructor(t,e){super(t,{tagName:e.tagName,className:`psv-button ${e.hoverScale?"psv-button--hover-scale":""} ${e.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=sxe(e),e.id||(this.config.id=this.constructor.id),e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.viewer.config.lang[this.config.title]??this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",n=>{this.state.enabled&&this.onClick(),n.stopPropagation()}),this.container.addEventListener("keydown",n=>{n.key===Os.Enter&&this.state.enabled&&(this.onClick(),n.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(t=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),t&&this.viewer.navbar.autoSize())}hide(t=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",t&&this.viewer.navbar.autoSize())}checkSupported(){FR(this.isSupported(),(t,e)=>{this.state&&(this.state.supported=t,e?t||this.hide():this.toggle(t))})}autoSize(){}isSupported(){return!0}toggleActive(t=!this.state.active){t!==this.state.active&&(this.state.active=t,s2(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(t){this.container.innerHTML=t,zR(this.container.querySelector("svg"),"psv-button-svg")}},axe=class extends qa{constructor(t,e){super(t,{id:e.id??`psvButton-${Math.random().toString(36).substring(2)}`,className:`psv-custom-button ${e.className||""}`,hoverScale:!1,collapsable:e.collapsable!==!1,tabbable:e.tabbable!==!1,title:e.title}),this.customOnClick=e.onClick,e.content&&(typeof e.content=="string"?this.container.innerHTML=e.content:(this.container.classList.add("psv-custom-button--no-padding"),e.content.style.height="100%",e.content.attachViewer?.(this.viewer),this.container.appendChild(e.content))),this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),e.visible===!1&&this.hide()}onClick(){this.customOnClick?.(this.viewer)}},hx=class extends qa{constructor(t){super(t,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:lh.info}),this.mode=0,this.viewer.addEventListener(L_.type,this),this.viewer.addEventListener(F_.type,this),this.viewer.addEventListener(qp.type,this),this.viewer.addEventListener(Zp.type,this),this.viewer.addEventListener(Cl.type,this)}destroy(){this.viewer.removeEventListener(L_.type,this),this.viewer.removeEventListener(F_.type,this),this.viewer.removeEventListener(qp.type,this),this.viewer.removeEventListener(Zp.type,this),this.viewer.removeEventListener(Cl.type,this),super.destroy()}handleEvent(t){if(t instanceof Cl){t.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let e=!1;t instanceof L_?e=this.mode===1:t instanceof F_?e=this.mode===1&&t.notificationId!==Ys.DESCRIPTION:t instanceof qp?e=this.mode===2:t instanceof Zp&&(e=this.mode===2&&t.panelId!==Ys.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(t){super.hide(t),this.mode&&this.__close()}autoSize(t=!1){if(t){const e=this.viewer.navbar.getButton("caption",!1),n=e&&!e.isVisible(),r=!!this.viewer.config.description;n||r?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(Ys.DESCRIPTION);break;case 2:this.viewer.panel.hide(Ys.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:Ys.DESCRIPTION,content:`${this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:""}${this.viewer.config.description}`})):(this.mode=1,this.viewer.notification.show({id:Ys.DESCRIPTION,content:this.viewer.config.caption}))}};hx.id="description";var VV=class extends qa{constructor(t){super(t,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:lh.download}),this.viewer.addEventListener(Cl.type,this),this.viewer.addEventListener(Ty.type,this)}destroy(){this.viewer.removeEventListener(Cl.type,this),this.viewer.removeEventListener(Ty.type,this),super.destroy()}handleEvent(t){t instanceof Cl?(t.containsOptions("downloadUrl")&&this.checkSupported(),t.containsOptions("downloadUrl","downloadName")&&this.__update()):t instanceof Ty&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const t=this.container;t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.target="_blank",t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop()}};VV.id="download";var jV=class extends qa{constructor(t){super(t,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:lh.fullscreenIn,iconActive:lh.fullscreenOut}),this.viewer.addEventListener(D_.type,this)}destroy(){this.viewer.removeEventListener(D_.type,this),super.destroy()}handleEvent(t){t instanceof D_&&this.toggleActive(t.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};jV.id="fullscreen";var lxe="psvButton",cxe=(t,e)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${lh.menu} ${e}</h1>
  <ul class="psv-panel-menu-list">
    ${t.map(n=>`
    <li data-psv-button="${n.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${n.content}</span>
      <span class="psv-panel-menu-item-label">${n.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,fw=class extends qa{constructor(t){super(t,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:lh.menu}),this.viewer.addEventListener(Zp.type,this),this.viewer.addEventListener(qp.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Zp.type,this),this.viewer.removeEventListener(qp.type,this),super.destroy()}handleEvent(t){t instanceof Zp?this.toggleActive(t.panelId===Ys.MENU):t instanceof qp&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(t){super.hide(t),this.__hideMenu()}show(t){super.show(t),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:Ys.MENU,content:cxe(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:t=>{const e=t?Z8(t,".psv-panel-menu-item"):void 0,n=e?e.dataset[lxe]:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(Ys.MENU)}};fw.id="menu";function uxe(t){let e=0;switch(t){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0;break}return lh.arrow.replace("rotate(0",`rotate(${e}`)}var n1=class extends qa{constructor(t,e){super(t,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:uxe(e)}),this.direction=e,this.handler=new u2,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===Os.Enter&&this.__onMouseDown();break;case"keyup":t.key===Os.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return l2(Ga.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const t={};switch(this.direction){case 0:t.pitch=!1;break;case 1:t.pitch=!0;break;case 3:t.yaw=!1;break;default:t.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(t),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};n1.groupId="move";var HV=class extends n1{constructor(t){super(t,1)}};HV.id="moveDown";var GV=class extends n1{constructor(t){super(t,2)}};GV.id="moveLeft";var WV=class extends n1{constructor(t){super(t,3)}};WV.id="moveRight";var qV=class extends n1{constructor(t){super(t,0)}};qV.id="moveUp";var jR=class extends qa{constructor(t,e,n){super(t,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=n,this.handler=new u2,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===Os.Enter&&this.__onMouseDown();break;case"keyup":t.key===Os.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return l2(Ga.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};jR.groupId="zoom";var XV=class extends jR{constructor(t){super(t,lh.zoomIn,0)}};XV.id="zoomIn";var ZV=class extends jR{constructor(t){super(t,lh.zoomOut,1)}};ZV.id="zoomOut";var HR=class extends qa{constructor(t){super(t,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new p$(this.container,"HORIZONTAL",e=>this.__onSliderUpdate(e)),this.mediaMinWidth=parseInt(Qh(this.container,"max-width"),10),this.viewer.addEventListener(hf.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(O_.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(hf.type,this),this.viewer.removeEventListener(O_.type,this),super.destroy()}handleEvent(t){t instanceof hf?this.__moveZoomValue(t.zoomLevel):t instanceof O_&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return l2(Ga.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(t){this.zoomValue.style.left=t/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(t){t.mousedown&&this.viewer.zoom(t.value*100)}};HR.id="zoomRange";HR.groupId="zoom";var YV=class extends m${constructor(t){super(),this.viewer=t}init(){}destroy(){}},GR=class extends YV{constructor(t,e){super(t),this.config=this.constructor.configParser(e)}setOption(t,e){this.setOptions({[t]:e})}setOptions(t){const e={...this.config,...t},n=this.constructor,r=n.configParser,a=n.readonlyOptions,l=n.id;for(let[u,s]of Object.entries(t)){if(!(u in r.defaults)){Ks(`${l}: Unknown option "${u}"`);continue}if(a.includes(u)){Ks(`${l}: Option "${u}" cannot be updated`);continue}u in r.parsers&&(s=r.parsers[u](s,{rawConfig:e,defValue:r.defaults[u]})),this.config[u]=s}}};GR.readonlyOptions=[];function SA(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof YV)return UR(e.id,e.VERSION,"5.13.4"),e}return null}var _f={panorama:null,container:null,adapter:[VR,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[Os.ArrowUp]:"ROTATE_UP",[Os.ArrowDown]:"ROTATE_DOWN",[Os.ArrowRight]:"ROTATE_RIGHT",[Os.ArrowLeft]:"ROTATE_LEFT",[Os.PageUp]:"ZOOM_IN",[Os.PageDown]:"ZOOM_OUT",[Os.Plus]:"ZOOM_IN",[Os.Minus]:"ZOOM_OUT"}},l4={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},MA={container:t=>{if(!t)throw new qn("No value given for container.");return t},adapter:(t,{defValue:e})=>{if(t?Array.isArray(t)?t=[a4(t[0]),t[1]]:t=[a4(t),null]:t=e,!t[0])throw new qn("An undefined value was given for adapter.");if(!t[0].id)throw new qn("Adapter has no id.");return t},defaultYaw:t=>qh(t),defaultPitch:t=>qh(t,!0),defaultZoomLvl:t=>jr.clamp(t,0,100),minFov:(t,{rawConfig:e})=>(e.maxFov<t&&(Ks("maxFov cannot be lower than minFov"),t=e.maxFov),jr.clamp(t,1,179)),maxFov:(t,{rawConfig:e})=>(t<e.minFov&&(t=e.minFov),jr.clamp(t,1,179)),moveInertia:(t,{defValue:e})=>t===!0?e:t===!1?0:t,lang:t=>({..._f.lang,...t}),keyboardActions:(t,{rawConfig:e})=>e.keyboard&&typeof e.keyboard=="object"?e.keyboard:t,fisheye:t=>t===!0?1:t===!1?0:t,requestHeaders:t=>t&&typeof t=="object"?()=>t:typeof t=="function"?t:null,withCredentials:t=>typeof t=="boolean"?()=>t:typeof t=="function"?t:()=>!1,defaultTransition:(t,{defValue:e})=>t===null||t.speed===0?null:{...e,...t},rendererParameters:(t,{defValue:e})=>({...t,...e}),plugins:t=>t.map((e,n)=>{if(Array.isArray(e)?e=[SA(e[0]),e[1]]:e=[SA(e),null],!e[0])throw new qn(`An undefined value was given for plugin ${n}.`);if(!e[0].id)throw new qn(`Plugin ${n} has no id.`);return e}),navbar:t=>t===!1?null:t===!0?a2(_f.navbar):typeof t=="string"?t.split(/[ ,]/):t},hxe=c2(_f,MA),py=class extends qa{constructor(t){super(t,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(t){this.show(),this.contentElt.innerHTML=t??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){this.viewer.navbar.getButton(hx.id,!1)?.autoSize(!0)}};py.id="caption";var EA={},Jw={};function WR(t,e){if(!t.id)throw new qn("Button id is required");if(EA[t.id]=t,t.groupId&&(Jw[t.groupId]=Jw[t.groupId]||[]).push(t),e){const n=_f.navbar;switch(e){case"start":n.unshift(t.id);break;case"end":n.push(t.id);break;default:{const[r,a]=e.split(":"),l=n.indexOf(r);if(!r||!a||l===-1)throw new qn(`Invalid defaultPosition ${e}`);n.splice(l+(a==="right"?1:0),0,t.id)}}}}[ZV,HR,XV,hx,py,VV,jV,GV,WV,qV,HV].forEach(t=>WR(t));var dxe=class extends mm{constructor(t){super(t,{className:`psv-navbar ${e1}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(t){this.children.slice().forEach(e=>e.destroy()),this.children.length=0,t.indexOf(py.id)!==-1&&t.indexOf(hx.id)===-1&&t.splice(t.indexOf(py.id),0,hx.id),t.forEach(e=>{typeof e=="object"?new axe(this,e):EA[e]?new EA[e](this):Jw[e]?Jw[e].forEach(n=>{new n(this)}):Ks(`Unknown button ${e}`)}),new fw(this),this.children.forEach(e=>{e instanceof qa&&e.checkSupported()}),this.autoSize()}setCaption(t){this.children.some(e=>e instanceof py?(e.setCaption(t),!0):!1)}getButton(t,e=!0){const n=this.children.find(r=>r instanceof qa&&r.id===t);return!n&&e&&Ks(`button "${t}" not found in the navbar`),n}focusButton(t){this.isVisible()&&(this.getButton(t,!1)?.container||this.container.firstElementChild)?.focus()}autoSize(){this.children.forEach(r=>{r instanceof qa&&r.autoSize()});const t=this.container.offsetWidth;let e=0;const n=[];this.children.forEach(r=>{r.isVisible()&&r instanceof qa&&(e+=r.width,r.collapsable&&n.push(r))}),e!==0&&(t<e&&n.length>0?(n.forEach(r=>r.collapse()),this.collapsed=n,this.getButton(fw.id).show(!1)):t>=e&&this.collapsed.length>0&&(this.collapsed.forEach(r=>r.uncollapse()),this.collapsed=[],this.getButton(fw.id).hide(!1)),this.getButton(py.id,!1)?.autoSize())}};fA.enabled=!1;var ty={enabled:!0,maxItems:10,ttl:10*60,items:{},purgeInterval:null,init(){fA.enabled&&(Ks("ThreeJS cache should be disabled"),fA.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),60*1e3))},add(t,e,n){this.enabled&&e&&(this.items[e]=this.items[e]??{files:{},lastAccess:null},this.items[e].files[t]=n,this.items[e].lastAccess=Date.now())},get(t,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[t]},remove(t,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[t],Object.keys(this.items[e].files).length===0&&delete this.items[e])},purge(){Object.entries(this.items).sort(([,t],[,e])=>e.lastAccess-t.lastAccess).forEach(([t,{lastAccess:e}],n)=>{n>0&&(Date.now()-e>=this.ttl*1e3||n>=this.maxItems)&&delete this.items[t]})}},fxe=class extends mm{constructor(t){super(t,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=Qh(this.loader,"color"),this.color=Qh(this.canvas,"color"),this.border=parseInt(Qh(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(Qh(this.loader,"--psv-loader-tickness"),10);const e=this.size/2;this.canvas.innerHTML=`
            <circle cx="${e}" cy="${e}" r="${e}" fill="${this.color}"/>
            <path d="" fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>
        `,this.viewer.addEventListener(Cl.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(Cl.type,this),super.destroy()}handleEvent(t){t instanceof Cl&&t.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(t){this.container.classList.remove("psv-loader--undefined");const e=jr.clamp(t,0,99.999)/100*Math.PI*2,n=this.size/2,r=n,a=this.thickness/2+this.border,l=(this.size-this.thickness)/2-this.border,u=Math.sin(e)*l+n,s=-Math.cos(e)*l+n,m=t>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d",`M ${r} ${a} A ${l} ${l} 0 ${m} 1 ${u} ${s}`)}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const t=this.loader.querySelector(".psv-loader-image, .psv-loader-text");t&&this.loader.removeChild(t);let e;if(this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt!==null&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),e){const n=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=n+"px",e.style.maxHeight=n+"px",this.loader.appendChild(e)}}},pxe=class extends mm{constructor(t){super(t,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qn("Notification cannot be toggled")}show(t){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),typeof t=="string"&&(t={content:t}),this.state.contentId=t.id||null,this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new F_(this.state.contentId)),t.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),t.timeout))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new L_(e))}}},mxe=class extends mm{constructor(t){super(t,{className:`psv-overlay ${e1}`}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(Xp.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Xp.type,this),super.destroy()}handleEvent(t){t.type==="click"?this.isVisible()&&this.state.dismissible&&(this.hide(),t.stopPropagation()):t instanceof Xp&&this.isVisible()&&this.state.dismissible&&t.key===Os.Escape&&(this.hide(),t.preventDefault())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qn("Overlay cannot be toggled")}show(t){typeof t=="string"&&(t={title:t}),this.state.contentId=t.id||null,this.state.dismissible=t.dismissible!==!1,this.image.innerHTML=t.image||"",this.title.innerHTML=t.title||"",this.text.innerHTML=t.text||"",super.show(),this.viewer.dispatchEvent(new yV(this.state.contentId))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new F$(e))}}},gxe=200,$T="psv-panel-content--no-interaction",vxe=class extends mm{constructor(t){super(t,{className:`psv-panel ${e1}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const e=document.createElement("div");e.className="psv-panel-resizer",this.container.appendChild(e);const n=document.createElement("div");n.className="psv-panel-close-button",n.innerHTML=lh.close,n.title=t.config.lang.close,this.container.appendChild(n),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),n.addEventListener("click",()=>this.hide()),e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(Xp.type,this)}destroy(){this.viewer.removeEventListener(Xp.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break;case Xp.type:this.__onKeyPress(t);break}}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qn("Panel cannot be toggled")}show(t){typeof t=="string"&&(t={content:t});const e=this.isVisible(t.id);this.state.contentId=t.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),t.id&&this.state.width[t.id]?this.container.style.width=this.state.width[t.id]:t.width?this.container.style.width=t.width:this.container.style.width=null,this.content.innerHTML=t.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),s2(this.content,"psv-panel-content--no-margin",t.noMargin===!0),t.clickHandler&&(this.state.clickHandler=n=>{t.clickHandler(qw(n))},this.state.keyHandler=n=>{n.key===Os.Enter&&t.clickHandler(qw(n))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),e||setTimeout(()=>{this.content.querySelector("a,button,[tabindex]")?.focus()},300)),this.viewer.dispatchEvent(new Zp(this.state.contentId))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new qp(e))}}__onMouseDown(t){t.stopPropagation(),this.__startResize(t.clientX,t.clientY)}__onTouchStart(t){if(t.stopPropagation(),t.touches.length===1){const e=t.touches[0];this.__startResize(e.clientX,e.clientY)}}__onMouseUp(t){this.state.mousedown&&(t.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove($T))}__onTouchEnd(t){this.state.mousedown&&(t.stopPropagation(),t.touches.length===0&&(this.state.mousedown=!1,this.content.classList.remove($T)))}__onMouseMove(t){this.state.mousedown&&(t.stopPropagation(),this.__resize(t.clientX,t.clientY))}__onTouchMove(t){if(this.state.mousedown){const e=t.touches[0];this.__resize(e.clientX,e.clientY)}}__onKeyPress(t){this.isVisible()&&t.key===Os.Escape&&(this.hide(),t.preventDefault())}__startResize(t,e){this.state.mouseX=t,this.state.mouseY=e,this.state.mousedown=!0,this.content.classList.add($T)}__resize(t,e){const n=t,r=e,a=Math.max(gxe,this.container.offsetWidth-(n-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=a),this.container.style.width=a,this.state.mouseX=n,this.state.mouseY=r}},yxe=class extends mm{constructor(t,e){super(t,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",n=>n.stopPropagation()),this.container.addEventListener("mousedown",n=>n.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(t){t.type==="transitionend"&&this.__onTransitionEnd(t)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new qn("Tooltip cannot be toggled")}show(t){if(this.state.state!==0)throw new qn("Initialized tooltip cannot be re-initialized");t.className&&zR(this.container,t.className),t.style&&Object.assign(this.container.style,t.style),this.state.state=3,this.update(t.content,t),this.state.data=t.data,this.state.state=1,this.viewer.dispatchEvent(new SV(this,this.state.data)),this.__waitImages()}update(t,e){this.content.innerHTML=t;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(Qh(this.arrow,"border-top-width"),10),this.state.border=parseInt(Qh(this.container,"border-top-left-radius"),10),this.move(e??this.state.config),this.__waitImages()}move(t){if(this.state.state!==1&&this.state.state!==3)throw new qn("Uninitialized tooltip cannot be moved");t.box=t.box??this.state.config?.box??{width:0,height:0},this.state.config=t;const e=this.container,n=this.arrow,r={posClass:a$(t.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(r,t);let a=null,l=null;if(r.top<0?a="bottom":r.top+r.height>this.viewer.state.size.height&&(a="top"),r.left<0?l="right":r.left+r.width>this.viewer.state.size.width&&(l="left"),l||a){const s=BR(r.posClass);a&&(r.posClass[s?0:1]=a),l&&(r.posClass[s?1:0]=l),this.__computeTooltipPosition(r,t)}e.style.top=r.top+"px",e.style.left=r.left+"px",n.style.top=r.arrowTop+"px",n.style.left=r.arrowLeft+"px";const u=r.posClass.join("-");u!==this.state.pos&&(e.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=u,e.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new V$(this.state.data));const t=parseFloat(Qh(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},t*2)}__onTransitionEnd(t){if(t.propertyName==="transform")switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy();break}}__computeTooltipPosition(t,e){const n=this.state.arrow,r=e.top,a=t.height,l=e.left,u=t.width,s=n+this.state.border,m=e.box.width/2+n*2,_=e.box.height/2+n*2;switch(t.posClass.join("-")){case"top-left":t.top=r-_-a,t.left=l+s-u,t.arrowTop=a,t.arrowLeft=u-s-n;break;case"top-center":t.top=r-_-a,t.left=l-u/2,t.arrowTop=a,t.arrowLeft=u/2-n;break;case"top-right":t.top=r-_-a,t.left=l-s,t.arrowTop=a,t.arrowLeft=n;break;case"bottom-left":t.top=r+_,t.left=l+s-u,t.arrowTop=-n*2,t.arrowLeft=u-s-n;break;case"bottom-center":t.top=r+_,t.left=l-u/2,t.arrowTop=-n*2,t.arrowLeft=u/2-n;break;case"bottom-right":t.top=r+_,t.left=l-s,t.arrowTop=-n*2,t.arrowLeft=n;break;case"left-top":t.top=r+s-a,t.left=l-m-u,t.arrowTop=a-s-n,t.arrowLeft=u;break;case"center-left":t.top=r-a/2,t.left=l-m-u,t.arrowTop=a/2-n,t.arrowLeft=u;break;case"left-bottom":t.top=r-s,t.left=l-m-u,t.arrowTop=n,t.arrowLeft=u;break;case"right-top":t.top=r+s-a,t.left=l+m,t.arrowTop=a-s-n,t.arrowLeft=-n*2;break;case"center-right":t.top=r-a/2,t.left=l+m,t.arrowTop=a/2-n,t.arrowLeft=-n*2;break;case"right-bottom":t.top=r-s,t.left=l+m,t.arrowTop=n,t.arrowLeft=-n*2;break}}__waitImages(){const t=this.content.querySelectorAll("img");if(t.length>0){const e=[];t.forEach(n=>{n.complete||e.push(new Promise(r=>{n.onload=r,n.onerror=r}))}),e.length&&Promise.all(e).then(()=>{if(this.state.state===1||this.state.state===3){const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.move(this.state.config)}})}}},_xe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/><!--Created by Shastry from the Noun Project--></svg>
`,r1=class{constructor(t){this.viewer=t,this.config=t.config,this.state=t.state}destroy(){}},Qu=new At,kb=new ud(0,0,0,"ZXY"),xxe=class extends r1{constructor(t){super(t)}fovToZoomLevel(t){const e=Math.round((t-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return jr.clamp(e-2*(e-50),0,100)}zoomLevelToFov(t){return this.config.maxFov+t/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(t){return jr.radToDeg(2*Math.atan(Math.tan(jr.degToRad(t)/2)*this.state.aspect))}hFovToVFov(t){return jr.radToDeg(2*Math.atan(Math.tan(jr.degToRad(t)/2)/this.state.aspect))}getAnimationProperties(t,e,n){const r=!Fs(e),a=!Fs(n),l={};let u=null;if(r){const s=this.viewer.getPosition(),m=W8(s.yaw,e.yaw);l.yaw={start:s.yaw,end:s.yaw+m},l.pitch={start:s.pitch,end:e.pitch},u=_A(t,q8(s,e))}if(a){const s=this.viewer.getZoomLevel(),m=Math.abs(n-s);l.zoom={start:s,end:n},u===null&&(u=_A(t,Math.PI/4*m/100))}return u===null?typeof t=="number"?u=t:u=gA:u=Math.max(gA,u),{duration:u,properties:l}}getTransitionOptions(t){let e;const n=this.config.defaultTransition??_f.defaultTransition;return t.transition===!1||t.transition===null?e=null:t.transition===!0?e={...n}:typeof t.transition=="object"?e={...n,...t.transition}:e=this.config.defaultTransition,e}textureCoordsToSphericalCoords(t){if(!this.state.textureData?.panoData)throw new qn("Current adapter does not support texture coordinates or no texture has been loaded");const e=this.viewer.adapter.textureCoordsToSphericalCoords(t,this.state.textureData.panoData);return!kb.equals(this.viewer.renderer.panoramaPose)||!kb.equals(this.viewer.renderer.sphereCorrection)?(this.sphericalCoordsToVector3(e,Qu),Qu.applyEuler(this.viewer.renderer.panoramaPose),Qu.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(Qu)):e}sphericalCoordsToTextureCoords(t){if(!this.state.textureData?.panoData)throw new qn("Current adapter does not support texture coordinates or no texture has been loaded");return(!kb.equals(this.viewer.renderer.panoramaPose)||!kb.equals(this.viewer.renderer.sphereCorrection))&&(this.sphericalCoordsToVector3(t,Qu),bA(Qu,this.viewer.renderer.sphereCorrection),bA(Qu,this.viewer.renderer.panoramaPose),t=this.vector3ToSphericalCoords(Qu)),this.viewer.adapter.sphericalCoordsToTextureCoords(t,this.state.textureData.panoData)}sphericalCoordsToVector3(t,e,n=Og){return e||(e=new At),e.x=n*-Math.cos(t.pitch)*Math.sin(t.yaw),e.y=n*Math.sin(t.pitch),e.z=n*Math.cos(t.pitch)*Math.cos(t.yaw),e}vector3ToSphericalCoords(t){const e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),n=Math.atan2(t.x,t.z);return{yaw:n<0?-n:Math.PI*2-n,pitch:Math.PI/2-e}}viewerCoordsToVector3(t){const e=this.viewer.renderer.getIntersections(t).filter(n=>n.object.userData[im]);return e.length?e[0].point:null}viewerCoordsToSphericalCoords(t){const e=this.viewerCoordsToVector3(t);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(t){const e=t.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(t){return this.sphericalCoordsToVector3(t,Qu),this.vector3ToViewerCoords(Qu)}isPointVisible(t){let e,n;if(t instanceof At)e=t,n=this.vector3ToViewerCoords(t);else if(NR(t))e=this.sphericalCoordsToVector3(t,Qu),n=this.vector3ToViewerCoords(e);else return!1;return e.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(t){if("yaw"in t||"pitch"in t){if(!("yaw"in t)||!("pitch"in t))throw new qn("Position is missing 'yaw' or 'pitch'");return{yaw:qh(t.yaw),pitch:qh(t.pitch,!0)}}else return this.textureCoordsToSphericalCoords(t)}cleanSphereCorrection(t){return{pan:qh(t?.pan||0),tilt:qh(t?.tilt||0,!0),roll:qh(t?.roll||0,!0,!1)}}cleanPanoramaPose(t){return{pan:jr.degToRad(t?.poseHeading||0),tilt:jr.degToRad(t?.posePitch||0),roll:jr.degToRad(t?.poseRoll||0)}}cleanPanoramaOptions(t,e){return e?.isEquirectangular&&(Fs(t.zoom)&&!Fs(e.initialFov)&&(t={...t,zoom:this.fovToZoomLevel(this.hFovToVFov(e.initialFov))}),Fs(t.position)&&!Fs(e.initialHeading)&&!Fs(e.initialPitch)&&(t={...t,position:{yaw:qh(e.initialHeading),pitch:qh(e.initialPitch,!0)}})),t}},bxe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/><!--Created by AomAm from the Noun Project--></svg>
`,wxe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/><!-- Created by Icon Island from the Noun Project --></svg>
`,p2=class KV{constructor(){this.$=KV.IDLE}is(...e){return e.some(n=>this.$&n)}set(e){this.$=e}add(e){this.$|=e}remove(e){this.$&=~e}};p2.IDLE=0;p2.CLICK=1;p2.MOVING=2;var ns=p2,Sxe=class extends r1{constructor(t){super(t),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new ns,this.keyHandler=new u2,this.resizeObserver=new ResizeObserver(t$(()=>this.viewer.autoSize(),50)),this.moveThreshold=N8*Ga.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(R_.type,this),this.viewer.addEventListener(B_.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(R_.type,this),this.viewer.removeEventListener(B_.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(t){switch(t.type){case"keydown":this.__onKeyDown(t);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchmove":this.__onTouchMove(t);break;case"touchend":this.__onTouchEnd(t);break;case"fullscreenchange":this.__onFullscreenChange();break;case R_.type:this.__applyMoveDelta();break;case B_.type:this.__clearMoveDelta();break}if(!Y8(t,"."+e1))switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"wheel":this.__onMouseWheel(t);break}}__onKeyDown(t){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=t.key===Os.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(Ys.CTRL_ZOOM))),!this.viewer.dispatchEvent(new Xp(t.key,t))||!this.state.keyboardEnabled)return;const e=this.config.keyboardActions?.[t.key];if(typeof e=="function"){e(this.viewer,t),t.preventDefault();return}if(!(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)&&e&&!this.keyHandler.pending){switch(e!=="ZOOM_IN"&&e!=="ZOOM_OUT"&&this.viewer.stopAll(),e){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0);break}this.keyHandler.down(e),t.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(t=>{t==="ZOOM_IN"||t==="ZOOM_OUT"?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(t){this.step.add(ns.CLICK),this.data.startMouseX=t.clientX,this.data.startMouseY=t.clientY,this.config.mousemove&&t.preventDefault()}__onMouseUp(t){this.step.is(ns.CLICK,ns.MOVING)&&this.__stopMove(t.clientX,t.clientY,t,t.button===2)}__onMouseMove(t){this.config.mousemove&&this.step.is(ns.CLICK,ns.MOVING)&&(t.preventDefault(),this.__doMove(t.clientX,t.clientY)),this.__handleObjectsEvents(t)}__onTouchStart(t){t.touches.length===1?(this.step.add(ns.CLICK),this.data.startMouseX=t.touches[0].clientX,this.data.startMouseY=t.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const e=t.touches[0];this.__stopMove(e.clientX,e.clientY,t,!0),this.data.longtouchTimeout=null},U8))):t.touches.length===2&&(this.step.set(ns.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(t),t.preventDefault()))}__onTouchEnd(t){if(this.__cancelLongTouch(),this.step.is(ns.CLICK,ns.MOVING)){if(t.preventDefault(),this.__cancelTwoFingersOverlay(),t.touches.length===1)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(t.touches.length===0){const e=t.changedTouches[0];this.__stopMove(e.clientX,e.clientY,t)}}}__onTouchMove(t){if(this.__cancelLongTouch(),!!this.config.mousemove)if(t.touches.length===1){if(this.config.touchmoveTwoFingers)this.step.is(ns.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:Ys.TWO_FINGERS,image:bxe,title:this.config.lang.twoFingers})},$8));else if(this.step.is(ns.CLICK,ns.MOVING)){t.preventDefault();const e=t.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(t),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(Ys.TWO_FINGERS))}__onMouseWheel(t){if(!this.config.mousewheel||!t.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown){this.viewer.overlay.show({id:Ys.CTRL_ZOOM,image:wxe,title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(Ys.CTRL_ZOOM),V8);return}t.preventDefault(),t.stopPropagation();const e=t.deltaY/Math.abs(t.deltaY)*5*this.config.zoomSpeed;e!==0&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){const t=this.viewer.isFullscreenEnabled();this.config.keyboard==="fullscreen"&&(t?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new D_(t))}__resetMove(){this.step.set(ns.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(t){this.viewer.stopAll(),this.__resetMove();const e=vA(t);this.step.set(ns.MOVING),this.data.accumulatorFactor=this.config.moveInertia,{distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e}__stopMove(t,e,n,r=!1){this.step.is(ns.CLICK)&&!this.__moveThresholdReached(t,e)&&this.__doClick(t,e,n,r),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(t,e,n,r=!1){const a=this.viewer.container.getBoundingClientRect(),l=t-a.left,u=e-a.top,s=this.viewer.renderer.getIntersections({x:l,y:u}),m=s.find(_=>_.object.userData[im]);if(m){const _=this.viewer.dataHelper.vector3ToSphericalCoords(m.point),b={rightclick:r,originalEvent:n,target:qw(n),clientX:t,clientY:e,viewerX:l,viewerY:u,yaw:_.yaw,pitch:_.pitch,objects:s.map(M=>M.object).filter(M=>!M.userData[im])};try{const M=this.viewer.dataHelper.sphericalCoordsToTextureCoords(b);Object.assign(b,M)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-b.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-b.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new I$(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new E$(b)),this.data.dblclickData=a2(b),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},B8))}}__handleObjectsEvents(t){if(!r$(this.state.objectsObservers)&&t.composedPath().includes(this.viewer.container)){const e=K8(this.viewer.container),n={x:t.clientX-e.x,y:t.clientY-e.y},r=this.viewer.renderer.getIntersections(n),a=(l,u,s)=>{this.viewer.dispatchEvent(new s(t,l,n,u))};for(const[l,u]of Object.entries(this.state.objectsObservers)){const s=r.find(m=>m.object.userData[l]);s?(u&&s.object!==u&&(a(u,l,wA),this.state.objectsObservers[l]=null),u?a(s.object,l,FV):(this.state.objectsObservers[l]=s.object,a(s.object,l,DV))):u&&(a(u,l,wA),this.state.objectsObservers[l]=null)}}}__doMove(t,e){if(this.step.is(ns.CLICK)&&this.__moveThresholdReached(t,e))this.viewer.stopAll(),this.__resetMove(),this.step.set(ns.MOVING),this.data.mouseX=t,this.data.mouseY=e,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(ns.MOVING)){const n=(t-this.data.mouseX)*Math.cos(this.state.roll)-(e-this.data.mouseY)*Math.sin(this.state.roll),r=(e-this.data.mouseY)*Math.cos(this.state.roll)+(t-this.data.mouseX)*Math.sin(this.state.roll),a={yaw:this.config.moveSpeed*(n/this.state.size.width)*jr.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(r/this.state.size.height)*jr.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=a.yaw,this.data.moveDelta.pitch+=a.pitch,this.data.mouseX=t,this.data.mouseY=e}}__moveThresholdReached(t,e){return Math.abs(t-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(t){if(this.step.is(ns.MOVING)){t.preventDefault();const e=vA(t);this.__doMove(e.center.x,e.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((e.distance-this.data.pinchDist)/Ga.pixelRatio),this.data.pinchDist=e.distance}}__applyMoveDelta(){if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const e=this.viewer.getPosition();this.viewer.rotate({yaw:e.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:e.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=.001&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=.001&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const e=this.viewer.getZoomLevel();this.viewer.zoom(e+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=.001&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};oi.enabled=!1;var zb=new mi,c4=new ki,u4=new t0,Mxe=class extends r1{constructor(t){super(t),this.frustumNeedsUpdate=!0,this.renderer=new B_e(this.config.rendererParameters),this.renderer.setPixelRatio(Ga.pixelRatio),this.renderer.outputColorSpace=zg,this.renderer.toneMapping=h8,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new Hw,this.camera=new ac(50,16/9,.1,2*Og),this.camera.matrixAutoUpdate=!1;const e=new wl(new n0(Og).scale(-1,1,1),new rm({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));e.userData={[im]:!0},this.scene.add(e),this.raycaster=new nge,this.frustum=new RR,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",n=>n.preventDefault()),this.viewer.addEventListener(N_.type,this),this.viewer.addEventListener(hf.type,this),this.viewer.addEventListener(k_.type,this),this.viewer.addEventListener(z_.type,this),this.viewer.addEventListener(Cl.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(t=>this.__renderLoop(t))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(N_.type,this),this.viewer.removeEventListener(hf.type,this),this.viewer.removeEventListener(k_.type,this),this.viewer.removeEventListener(z_.type,this),this.viewer.removeEventListener(Cl.type,this),super.destroy()}handleEvent(t){switch(t.type){case N_.type:this.__onSizeUpdated();break;case hf.type:this.__onZoomUpdated();break;case k_.type:this.__onPositionUpdated();break;case z_.type:this.__onPositionUpdated();break;case Cl.type:t.containsOptions("fisheye")&&this.__onPositionUpdated(),t.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground);break}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(t){t?this.customRenderer=t(this.renderer):this.customRenderer=null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(t){const e=this.timestamp?t-this.timestamp:0;this.timestamp=t,this.viewer.dispatchEvent(new R_(t,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new fV))}setTexture(t){this.meshContainer||(this.meshContainer=new jp,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(t.panoData),this.viewer.adapter.setTexture(this.mesh,t,!1),this.meshContainer.add(this.mesh),this.state.textureData=t,this.viewer.needsUpdate()}setPanoramaPose(t,e=this.mesh){const n=this.viewer.dataHelper.cleanPanoramaPose(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}setSphereCorrection(t,e=this.meshContainer){const n=this.viewer.dataHelper.cleanSphereCorrection(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}transition(t,e,n){const r=n.effect==="fade"||n.rotation,a=!Fs(e.position),l=!Fs(e.zoom),u=new $R(a?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(u);const s=new jp,m=this.viewer.adapter.createMesh(t.panoData);if(this.viewer.adapter.setTexture(m,t,!0),this.viewer.adapter.setTextureOpacity(m,0),this.setPanoramaPose(t.panoData,m),this.setSphereCorrection(e.sphereCorrection,s),a&&!n.rotation){const C=this.viewer.getPosition(),A=new At(0,1,0);s.rotateOnWorldAxis(A,u.position.yaw-C.yaw);const k=new At(0,1,0).cross(this.camera.getWorldDirection(new At)).normalize();s.rotateOnWorldAxis(k,u.position.pitch-C.pitch)}s.add(m),this.scene.add(s),this.renderer.setRenderTarget(new nm),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:_,properties:b}=this.viewer.dataHelper.getAnimationProperties(n.speed,n.rotation?u.position:null,r?u.zoomLevel:null),M=new Kw({properties:{...b,opacity:{start:0,end:1}},duration:_,easing:"inOutCubic",onTick:C=>{switch(n.effect){case"fade":this.viewer.adapter.setTextureOpacity(m,C.opacity);break;case"black":case"white":C.opacity<.5?this.renderer.toneMappingExposure=n.effect==="black"?jr.mapLinear(C.opacity,0,.5,1,0):jr.mapLinear(C.opacity,0,.5,1,4):(this.renderer.toneMappingExposure=n.effect==="black"?jr.mapLinear(C.opacity,.5,1,0,1):jr.mapLinear(C.opacity,.5,1,4,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(m,1),l&&!r&&this.viewer.dynamics.zoom.setValue(u.zoomLevel));break}a&&n.rotation&&this.viewer.dynamics.position.setValue({yaw:C.yaw,pitch:C.pitch}),l&&r&&this.viewer.dynamics.zoom.setValue(C.zoom),this.viewer.needsUpdate()}});return M.then(C=>{s.remove(m),this.scene.remove(s),C?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=m,this.meshContainer.add(m),this.state.textureData=t,this.setPanoramaPose(t.panoData),this.setSphereCorrection(e.sphereCorrection),a&&!n.rotation&&this.viewer.rotate(e.position)):(this.viewer.adapter.disposeTexture(t),this.viewer.adapter.disposeMesh(m))}),M}getIntersections(t){zb.x=2*t.x/this.state.size.width-1,zb.y=-2*t.y/this.state.size.height+1,this.raycaster.setFromCamera(zb,this.camera);const e=this.raycaster.intersectObjects(this.scene.children,!0).filter(n=>n.object.visible).filter(n=>n.object.isMesh&&!!n.object.userData);return this.customRenderer?.getIntersections&&e.push(...this.customRenderer.getIntersections(this.raycaster,zb)),e}isObjectVisible(t){if(!t)return!1;if(this.frustumNeedsUpdate&&(c4.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(c4),this.frustumNeedsUpdate=!1),t.isVector3)return this.frustum.containsPoint(t);if(t.isMesh&&t.geometry){const e=t;return e.geometry.boundingBox||e.geometry.computeBoundingBox(),u4.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),this.frustum.intersectsBox(u4)}else return t.isObject3D?this.frustum.intersectsObject(t):!1}addObject(t){this.scene.add(t)}removeObject(t){this.scene.remove(t)}cleanScene(t){const e=n=>{n.map?.dispose(),n.uniforms&&Object.values(n.uniforms).forEach(r=>{r.value?.dispose?.()}),n.dispose()};t.traverse(n=>{n.geometry?.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(r=>{e(r)}):e(n.material)),n instanceof Hw||n.dispose?.(),n!==t&&this.cleanScene(n)})}},Exe=class extends DR{load(t,e,n,r,a){const l=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(l,{signal:a}).then(u=>{if(u.status===200||u.status===0){const s=u.body.getReader(),m=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),_=m?parseInt(m):0,b=_!==0;let M=0;const C=new ReadableStream({start(A){k();function k(){s.read().then(({done:z,value:P})=>{if(z)A.close();else{M+=P.byteLength;const O=new ProgressEvent("progress",{lengthComputable:b,loaded:M,total:_});n(O),A.enqueue(P),k()}}).catch(z=>{r(z)})}}});return new Response(C)}else throw new Error(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`)}).then(u=>u.blob()).then(u=>{e(u)}).catch(u=>{r(u)})}},Cxe=class extends DR{load(t,e,n,r){const a=document.createElement("img");function l(){m(),e(this)}function u(_){if(m(),r?.aborted){const b=new Error;b.name="AbortError",b.message="The operation was aborted.",n(b)}else n(_)}function s(){a.src=""}function m(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1),r?.removeEventListener("abort",s,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),r?.addEventListener("abort",s,!1),t.startsWith("data:")||(a.crossOrigin=this.withCredentials?"use-credentials":"anonymous"),a.src=t,a}},Txe=class extends r1{constructor(t){super(t),this.abortCtrl={},this.fileLoader=new Exe,this.imageLoader=new Cxe}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach(t=>t.abort()),this.abortCtrl={}}loadFile(t,e,n){const r=ty.get(t,n);if(r){if(r instanceof Blob)return e?.(100),Promise.resolve(r);ty.remove(t,n)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(t)),this.fileLoader.setWithCredentials(this.config.withCredentials(t)),new Promise((a,l)=>{let u=0;e?.(u),this.fileLoader.load(t,s=>{u=100,e?.(u),ty.add(t,n,s),a(s)},s=>{if(s.lengthComputable){const m=s.loaded/s.total*100;m>u&&(u=m,e?.(u))}},s=>{l(s)},this.__getAbortSignal(n))})}loadImage(t,e,n){const r=ty.get(t,n);return r?(e?.(100),r instanceof Blob?this.blobToImage(r):Promise.resolve(r)):!e&&!this.config.requestHeaders?(this.imageLoader.setWithCredentials(this.config.withCredentials(t)),new Promise((a,l)=>{this.imageLoader.load(t,u=>{ty.add(t,n,u),a(u)},u=>{l(u)},this.__getAbortSignal(n))})):this.loadFile(t,e,n).then(a=>this.blobToImage(a))}blobToImage(t){return new Promise((e,n)=>{const r=document.createElement("img");r.onload=()=>{URL.revokeObjectURL(r.src),e(r)},r.onerror=n,r.src=URL.createObjectURL(t)})}preloadPanorama(t){return this.viewer.adapter.supportsPreload(t)?this.viewer.adapter.loadTexture(t,!1):Promise.reject(new qn("Current adapter does not support preload"))}dispatchProgress(t){this.viewer.loader.setProgress(t),this.viewer.dispatchEvent(new q$(Math.round(t)))}__getAbortSignal(t){return t?(this.abortCtrl[t]?.signal.aborted&&delete this.abortCtrl[t],this.abortCtrl[t]||(this.abortCtrl[t]=new AbortController),this.abortCtrl[t].signal):null}},Pxe=class extends r1{constructor(t){super(t),this.zoom=new f_(e=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(e),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new hf(e))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new d$(e=>{this.viewer.dataHelper.sphericalCoordsToVector3(e,this.viewer.state.direction),this.viewer.dispatchEvent(new k_(e))},{yaw:new f_(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new f_(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new f_(e=>{this.viewer.state.roll=e,this.viewer.dispatchEvent(new z_(e))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(this.config.zoomSpeed*50),this.position.setSpeed(jr.degToRad(this.config.moveSpeed*50)),this.roll.setSpeed(jr.degToRad(this.config.moveSpeed*50))}update(t){this.zoom.update(t),this.position.update(t),this.roll.update(t)}},Axe=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new At(0,0,Og),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},Ixe=class extends m${constructor(t){if(super(),this.plugins={},this.children=[],this.parent=X8(t.container),!this.parent)throw new qn('"container" element not found.');this.parent[im]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),u$(this.parent),c$(this.container,"core"),this.state=new Axe,this.config=hxe(t),this.__setSize(this.config.size),this.overlay=new mxe(this);try{Ga.load()}catch(e){console.error(e),this.showError(this.config.lang.webglError);return}ty.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new Mxe(this),this.textureLoader=new Txe(this),this.eventsHandler=new Sxe(this),this.dataHelper=new xxe(this),this.dynamics=new Pxe(this),this.adapter.init?.(),this.loader=new fxe(this),this.navbar=new dxe(this),this.panel=new vxe(this),this.notification=new pxe(this),this.autoSize(),this.setCursor(null),FR(Ga.isTouchEnabled,e=>{s2(this.container,"psv--is-touch",e)}),this.config.plugins.forEach(([e,n])=>{this.plugins[e.id]=new e(this,n)});for(const e of Object.values(this.plugins))e.init?.();this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[t,e]of Object.entries(this.plugins))e.destroy(),delete this.plugins[t];this.children.slice().forEach(t=>t.destroy()),this.children.length=0,this.eventsHandler?.destroy(),this.renderer?.destroy(),this.textureLoader?.destroy(),this.dataHelper?.destroy(),this.adapter?.destroy(),this.dynamics?.destroy(),this.parent.removeChild(this.container),delete this.parent[im]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),this.config.keyboard==="always"&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new O_)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(t){if(typeof t=="string")return this.plugins[t];{const e=SA(t);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return J8(this.parent,Ga.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(t){t?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new N_(this.getSize())),this.navbar.autoSize())}setPanorama(t,e={}){this.textureLoader.abortLoading(),this.state.transitionAnimation?.cancel();const n=this.dataHelper.getTransitionOptions(e);e.showLoader===void 0&&(e.showLoader=!0),e.caption===void 0&&(e.caption=this.config.caption),e.description===void 0&&(e.description=this.config.description),!e.panoData&&typeof this.config.panoData=="function"&&(e.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=t,this.config.caption=e.caption,this.config.description=e.description,this.config.sphereCorrection=e.sphereCorrection;const r=l=>{if(s$(l))return!1;if(this.loader.hide(),this.state.loadingPromise=null,l)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(l),this.dispatchEvent(new tV(t,l)),l;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),(e.showLoader||!this.state.ready)&&this.loader.show(),this.dispatchEvent(new Y$(t));const a=this.adapter.loadTexture(this.config.panorama,!0,e.panoData).then(l=>{if(l.panorama!==this.config.panorama)throw this.adapter.disposeTexture(l),yA();const u=this.dataHelper.cleanPanoramaOptions(e,l.panoData);return(!Fs(u.zoom)||!Fs(u.position))&&this.stopAll(),{textureData:l,cleanOptions:u}});return!n||!this.state.ready||!this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=a.then(({textureData:l,cleanOptions:u})=>{this.renderer.show(),this.renderer.setTexture(l),this.renderer.setPanoramaPose(l.panoData),this.renderer.setSphereCorrection(e.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new Ty(l)),Fs(u.zoom)||this.zoom(u.zoom),Fs(u.position)||this.rotate(u.position)}).then(()=>r(),l=>r(l)):this.state.loadingPromise=a.then(({textureData:l,cleanOptions:u})=>(this.loader.hide(),this.dispatchEvent(new Ty(l)),this.state.transitionAnimation=this.renderer.transition(l,u,n),this.state.transitionAnimation)).then(l=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new iV(l)),!l)throw yA()}).then(()=>r(),l=>r(l)),this.state.loadingPromise}setOptions(t){const e={...this.config,...t};for(let[n,r]of Object.entries(t)){if(!(n in _f)){Ks(`Unknown option ${n}`);continue}if(n in l4){Ks(l4[n]);continue}switch(n in MA&&(r=MA[n](r,{rawConfig:e,defValue:_f[n]})),this.config[n]=r,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new hf(this.getZoomLevel()));break;case"keyboard":this.config.keyboard==="always"?this.startKeyboardControl():this.stopKeyboardControl();break}}this.needsUpdate(),this.dispatchEvent(new Cl(Object.keys(t)))}setOption(t,e){this.setOptions({[t]:e})}showError(t){this.overlay.show({id:Ys.ERROR,image:_xe,title:t,dismissible:!1})}hideError(){this.overlay.hide(Ys.ERROR)}rotate(t){const e=new w$(this.dataHelper.cleanPosition(t));this.dispatchEvent(e),!e.defaultPrevented&&this.dynamics.position.setValue(e.position)}zoom(t){this.dynamics.zoom.setValue(t)}zoomIn(t=1){this.dynamics.zoom.step(t)}zoomOut(t=1){this.dynamics.zoom.step(-t)}animate(t){const e=NR(t),n=!Fs(t.zoom),r=new $R(e?this.dataHelper.cleanPosition(t):void 0,t.zoom);if(this.dispatchEvent(r),r.defaultPrevented)return;this.stopAll();const{duration:a,properties:l}=this.dataHelper.getAnimationProperties(t.speed,r.position,r.zoomLevel);return a?(this.state.animation=new Kw({properties:l,duration:a,easing:t.easing||"inOutSine",onTick:u=>{e&&this.dynamics.position.setValue({yaw:u.yaw,pitch:u.pitch}),n&&this.dynamics.zoom.setValue(u.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(e&&this.rotate(r.position),n&&this.zoom(r.zoomLevel),new Kw(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(t){this.__setSize(t),this.autoSize()}__setSize(t){["width","height"].forEach(e=>{t?.[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])})}enterFullscreen(){this.isFullscreenEnabled()||Q8(this.parent,Ga.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&e$(Ga.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(t){return new yxe(this,t)}setCursor(t){this.state.cursorOverride=t,t?this.container.style.cursor=t:this.container.style.cursor=this.config.mousemove?"move":"default"}observeObjects(t){this.state.objectsObservers[t]||(this.state.objectsObservers[t]=null)}unobserveObjects(t){delete this.state.objectsObservers[t]}stopAll(){return this.dispatchEvent(new B_),this.disableIdleTimer(),this.stopAnimation()}};var Rxe=class{constructor(t,e,n){this.id=t,this.priority=e,this.fn=n,this.status=1}start(){return this.status=2,this.fn(this).then(()=>{this.status=4},()=>{this.status=5})}cancel(){this.status=3}isCancelled(){return this.status===3}},Dxe=class{constructor(e=8){this.concurency=e,this.runningTasks={},this.tasks={}}enqueue(e){this.tasks[e.id]=e}clear(){Object.values(this.tasks).forEach(e=>e.cancel()),this.tasks={},this.runningTasks={}}setPriority(e,n){const r=this.tasks[e];r&&(r.priority=n,r.status===0&&(r.status=1))}disableAllTasks(){Object.values(this.tasks).forEach(e=>{e.status=0})}start(){if(Object.keys(this.runningTasks).length>=this.concurency)return;const e=Object.values(this.tasks).filter(n=>n.status===1).sort((n,r)=>r.priority-n.priority).pop();e&&(this.runningTasks[e.id]=!0,e.start().then(()=>{e.isCancelled()||(delete this.tasks[e.id],delete this.runningTasks[e.id],this.start())}),this.start())}};function Lxe(t){let e=0;t.forEach((n,r)=>{if(!n.zoomRange||n.zoomRange.length!==2)throw new qn(`Tiles level ${r} is missing "zoomRange" property`);if(n.zoomRange[0]>=n.zoomRange[1]||n.zoomRange[0]!==e||r===0&&n.zoomRange[0]!==0||r===t.length-1&&n.zoomRange[1]!==100)throw new qn(`Tiles levels' "zoomRange" are not orderer or are not covering the whole 0-100 range`);e=n.zoomRange[1]})}function kxe(t,e){return t.findIndex(n=>e>=n.zoomRange[0]&&e<=n.zoomRange[1])}function zxe(){const t=new OffscreenCanvas(512,512),e=t.getContext("2d");return e.fillStyle="#333",e.fillRect(0,0,t.width,t.height),e.font=`${t.width/5}px serif`,e.fillStyle="#a22",e.textAlign="center",e.textBaseline="middle",e.fillText("",t.width/2,t.height/2),new rm({map:nr.createTexture(t)})}function Oxe(t){const e=new Zme(t),n=new qme(e);return n.material.depthTest=!1,n.material.depthWrite=!1,n.material.opacity=.25,n.material.transparent=!0,n}var h4=["dodgerblue","limegreen","indianred"];function Fxe(t,e,n){const r=document.createElement("canvas");r.width=t.width,r.height=t.height;const a=r.getContext("2d");a.fillStyle=h4[e%h4.length],a.fillRect(0,0,r.width,r.height),a.globalCompositeOperation="multiply",a.drawImage(t,0,0);const l=t.width/7;return a.globalCompositeOperation="source-over",a.fillStyle="white",a.font=`${l}px monospace`,a.textAlign="center",n.split(`
`).forEach((u,s)=>{a.fillText(u,t.width/2,t.height/2+l*(.3+s))}),r}function qR(t){return!!t.levels}function JV(t,e,n){return{...t,level:e,colSize:t.width/t.cols,rowSize:t.width/2/t.rows,facesByCol:n.SPHERE_SEGMENTS/t.cols,facesByRow:n.SPHERE_HORIZONTAL_SEGMENTS/t.rows}}function d4(t,e,n){let r,a;return qR(t)?(a=kxe(t.levels,e),r=t.levels[a]):(a=0,r={...t,zoomRange:[0,100]}),JV(r,a,n)}function Nxe(t,e,n){return!qR(t)||!t.levels[e]?null:JV(t.levels[e],e,n)}function Bxe(t,e){if(typeof t!="object"||!t.tileUrl)throw new qn("Invalid panorama configuration, are you using the right adapter?");qR(t)?(t.levels.forEach(n=>f4(n,e)),Lxe(t.levels)):f4(t,e)}function f4(t,e){if(!t.width||!t.cols||!t.rows)throw new qn("Invalid panorama configuration, are you using the right adapter?");if(t.cols>e.SPHERE_SEGMENTS)throw new qn(`Panorama cols must not be greater than ${e.SPHERE_SEGMENTS}.`);if(t.rows>e.SPHERE_HORIZONTAL_SEGMENTS)throw new qn(`Panorama rows must not be greater than ${e.SPHERE_HORIZONTAL_SEGMENTS}.`);if(!jr.isPowerOfTwo(t.cols)||!jr.isPowerOfTwo(t.rows))throw new qn("Panorama cols and rows must be powers of 2.")}function Uxe(t,e){for(let n=0;n<e.cols;n++){const r=t.tileUrl(n,e.rows/2,e.level);if(r)return r}return t.tileUrl.toString()}var Q0=6,vl=3,$xe="uv",Vxe="position",p4=-1;function VT(t){return`${t.col}x${t.row}/${t.config.level}`}function Ob(t){return t.children}var jxe=nr.getConfigParser({resolution:64,showErrorTile:!0,baseBlur:!0,antialias:!0,debug:!1,useXmpData:!1}),Fb=new At,m2=class QV extends d2{constructor(e,n){super(e),this.state={tileConfig:null,tiles:{},faces:{},geom:null,materials:[],errorMaterial:null,inTransition:!1},this.queue=new Dxe,this.config=jxe(n),this.adapter=new VR(this.viewer,{resolution:this.config.resolution,blur:this.config.baseBlur}),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2,this.NB_VERTICES=2*this.SPHERE_SEGMENTS*vl+(this.SPHERE_HORIZONTAL_SEGMENTS-2)*this.SPHERE_SEGMENTS*Q0,this.NB_GROUPS=this.SPHERE_SEGMENTS*this.SPHERE_HORIZONTAL_SEGMENTS,this.viewer.config.requestHeaders&&nr.logWarn('EquirectangularTilesAdapter fallbacks to file loader because "requestHeaders" where provided. Consider removing "requestHeaders" if you experience performances issues.')}static withConfig(e){return[QV,e]}init(){super.init(),this.viewer.addEventListener(ar.TransitionDoneEvent.type,this),this.viewer.addEventListener(ar.PositionUpdatedEvent.type,this),this.viewer.addEventListener(ar.ZoomUpdatedEvent.type,this)}destroy(){this.viewer.removeEventListener(ar.TransitionDoneEvent.type,this),this.viewer.removeEventListener(ar.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(ar.ZoomUpdatedEvent.type,this),this.__cleanup(),this.state.errorMaterial?.map?.dispose(),this.state.errorMaterial?.dispose(),this.adapter.destroy(),delete this.adapter,delete this.state.geom,delete this.state.errorMaterial,super.destroy()}handleEvent(e){switch(e.type){case ar.PositionUpdatedEvent.type:case ar.ZoomUpdatedEvent.type:this.__refresh();break;case ar.TransitionDoneEvent.type:this.state.inTransition=!1,e.completed&&this.__switchMesh(this.viewer.renderer.mesh);break}}supportsTransition(e){return!!e.baseUrl}supportsPreload(e){return!!e.baseUrl}textureCoordsToSphericalCoords(e,n){return this.adapter.textureCoordsToSphericalCoords(e,n)}sphericalCoordsToTextureCoords(e,n){return this.adapter.sphericalCoordsToTextureCoords(e,n)}async loadTexture(e,n=!0){Bxe(e,this);const r=d4(e,0,this),a={isEquirectangular:!0,fullWidth:r.width,fullHeight:r.width/2,croppedWidth:r.width,croppedHeight:r.width/2,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0};if(e.baseUrl){const l=await this.adapter.loadTexture(e.baseUrl,n,e.basePanoData,!0);return{panorama:e,panoData:{...a,baseData:l.panoData},cacheKey:l.cacheKey,texture:l.texture}}else return{panorama:e,panoData:{...a,baseData:null},cacheKey:Uxe(e,r),texture:null}}createMesh(e){const n=this.adapter.createMesh(e.baseData??e),r=new n0(Wy.SPHERE_RADIUS,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1).toNonIndexed();r.clearGroups();let a=0,l=0;for(;a<this.SPHERE_SEGMENTS*vl;a+=vl)r.addGroup(a,vl,l++);for(;a<this.NB_VERTICES-this.SPHERE_SEGMENTS*vl;a+=Q0)r.addGroup(a,Q0,l++);for(;a<this.NB_VERTICES;a+=vl)r.addGroup(a,vl,l++);const u=[],s=new rm({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1});for(let b=0;b<this.NB_GROUPS;b++)u.push(s);const m=new wl(r,u);m.renderOrder=1;const _=new jp;return _.add(n),_.add(m),_}setTexture(e,n,r){const[a]=Ob(e);n.texture?this.adapter.setTexture(a,{panorama:n.panorama.baseUrl,texture:n.texture,panoData:n.panoData.baseData}):a.visible=!1,r?this.state.inTransition=!0:this.__switchMesh(e)}setTextureOpacity(e,n){const[r]=Ob(e);this.adapter.setTextureOpacity(r,n)}disposeTexture({texture:e}){e?.dispose()}disposeMesh(e){const[n,r]=Ob(e);n.geometry.dispose(),n.material.dispose(),r.geometry.dispose(),r.material.forEach(a=>{a.map?.dispose(),a.dispose()})}__refresh(){if(!this.state.geom||this.state.inTransition)return;const e=this.viewer.config.panorama,n=this.viewer.getZoomLevel(),r=d4(e,n,this),a=this.state.geom.getAttribute(Vxe),l={};for(let u=0;u<this.NB_VERTICES;u+=1)if(Fb.fromBufferAttribute(a,u),Fb.applyEuler(this.viewer.renderer.sphereCorrection),this.viewer.renderer.isObjectVisible(Fb)){let s;u<this.SPHERE_SEGMENTS*vl?s=Math.floor(u/3):u<this.NB_VERTICES-this.SPHERE_SEGMENTS*vl?s=Math.floor((u/3-this.SPHERE_SEGMENTS)/2)+this.SPHERE_SEGMENTS:s=Math.floor((u-this.NB_VERTICES-this.SPHERE_SEGMENTS*vl)/3)+this.SPHERE_HORIZONTAL_SEGMENTS*(this.SPHERE_SEGMENTS-1);const m=Math.floor(s/this.SPHERE_SEGMENTS),_=s-m*this.SPHERE_SEGMENTS;let b=r;for(;b;){const M=Math.floor(m/b.facesByRow),C=Math.floor(_/b.facesByCol);let A=Fb.angleTo(this.viewer.state.direction);(M===0||M===b.rows-1)&&(A*=2);const k={row:M,col:C,angle:A,config:b,url:null},z=VT(k);if(l[z]){l[z].angle=Math.min(l[z].angle,A);break}else if(k.url=e.tileUrl(C,M,b.level),k.url){l[z]=k;break}else b=Nxe(e,b.level-1,this)}}this.state.tileConfig=r,this.__loadTiles(Object.values(l))}__loadTiles(e){this.queue.disableAllTasks(),e.forEach(n=>{const r=VT(n);this.state.tiles[r]?this.queue.setPriority(r,n.angle):(this.state.tiles[r]=!0,this.queue.enqueue(new Rxe(r,n.angle,a=>this.__loadTile(n,a))))}),this.queue.start()}__loadTile(e,n){return this.viewer.textureLoader.loadImage(e.url,null,this.viewer.state.textureData.cacheKey).then(r=>{if(!n.isCancelled()){this.config.debug&&(r=Fxe(r,e.config.level,VT(e)));const a=this.config.antialias&&e.config.level>0,l=new rm({map:nr.createTexture(r,a)});this.__swapMaterial(e,l,!1),this.viewer.needsUpdate()}}).catch(r=>{!nr.isAbortError(r)&&!n.isCancelled()&&this.config.showErrorTile&&(this.state.errorMaterial||(this.state.errorMaterial=zxe()),this.__swapMaterial(e,this.state.errorMaterial,!0),this.viewer.needsUpdate())})}__swapMaterial(e,n,r){const a=this.state.geom.getAttribute($xe);for(let l=0;l<e.config.facesByCol;l++)for(let u=0;u<e.config.facesByRow;u++){const s=e.col*e.config.facesByCol+l,m=e.row*e.config.facesByRow+u,_=m===0,b=m===this.SPHERE_HORIZONTAL_SEGMENTS-1;let M;if(_?M=s*vl:b?M=this.NB_VERTICES-this.SPHERE_SEGMENTS*vl+s*vl:M=this.SPHERE_SEGMENTS*vl+(m-1)*this.SPHERE_SEGMENTS*Q0+s*Q0,r&&this.state.faces[M]>p4||this.state.faces[M]>e.config.level)continue;this.state.faces[M]=r?p4:e.config.level;const C=this.state.geom.groups.find(O=>O.start===M).materialIndex;this.state.materials[C]=n;const A=1-u/e.config.facesByRow,k=1-(u+1)/e.config.facesByRow,z=l/e.config.facesByCol,P=(l+1)/e.config.facesByCol;_?(a.setXY(M,(z+P)/2,A),a.setXY(M+1,z,k),a.setXY(M+2,P,k)):b?(a.setXY(M,P,A),a.setXY(M+1,z,A),a.setXY(M+2,(z+P)/2,k)):(a.setXY(M,P,A),a.setXY(M+1,z,A),a.setXY(M+2,P,k),a.setXY(M+3,z,A),a.setXY(M+4,z,k),a.setXY(M+5,P,k))}a.needsUpdate=!0}__switchMesh(e){const[,n]=Ob(e);if(this.__cleanup(),this.state.materials=n.material,this.state.geom=n.geometry,this.config.debug){const r=Oxe(this.state.geom);this.viewer.renderer.addObject(r),this.viewer.renderer.setSphereCorrection(this.viewer.config.sphereCorrection,r)}setTimeout(()=>this.__refresh())}__cleanup(){this.queue.clear(),this.state.tiles={},this.state.faces={},this.state.materials=[],this.state.inTransition=!1}};m2.id="equirectangular-tiles";m2.VERSION="5.13.4";m2.supportsDownload=!1;var ej=m2;var Hxe=Object.defineProperty,Gxe=(t,e)=>{for(var n in e)Hxe(t,n,{get:e[n],enumerable:!0})},Wxe={};Gxe(Wxe,{EnterArrowEvent:()=>sj,LeaveArrowEvent:()=>cj,NodeChangedEvent:()=>rj});var tj=class nj extends t1{constructor(e,n){super(nj.type),this.node=e,this.data=n}};tj.type="node-changed";var rj=tj,ij=class oj extends t1{constructor(e,n){super(oj.type),this.link=e,this.node=n}};ij.type="enter-arrow";var sj=ij,aj=class lj extends t1{constructor(e,n){super(lj.type),this.link=e,this.node=n}};aj.type="leave-arrow";var cj=aj,qxe=class extends Qs{constructor(t=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new mi(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&e.element.parentNode!==null&&e.element.remove()})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this.center=t.center,this}},qv=new At,m4=new ki,g4=new ki,v4=new At,y4=new At,Xxe=class{constructor(t={}){const e=this;let n,r,a,l;const u={objects:new WeakMap},s=t.element!==void 0?t.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s,this.getSize=function(){return{width:n,height:r}},this.render=function(A,k){A.matrixWorldAutoUpdate===!0&&A.updateMatrixWorld(),k.parent===null&&k.matrixWorldAutoUpdate===!0&&k.updateMatrixWorld(),m4.copy(k.matrixWorldInverse),g4.multiplyMatrices(k.projectionMatrix,m4),_(A,A,k),C(A)},this.setSize=function(A,k){n=A,r=k,a=n/2,l=r/2,s.style.width=A+"px",s.style.height=k+"px"};function m(A){A.isCSS2DObject&&(A.element.style.display="none");for(let k=0,z=A.children.length;k<z;k++)m(A.children[k])}function _(A,k,z){if(A.visible===!1){m(A);return}if(A.isCSS2DObject){qv.setFromMatrixPosition(A.matrixWorld),qv.applyMatrix4(g4);const P=qv.z>=-1&&qv.z<=1&&A.layers.test(z.layers)===!0,O=A.element;O.style.display=P===!0?"":"none",P===!0&&(A.onBeforeRender(e,k,z),O.style.transform="translate("+-100*A.center.x+"%,"+-100*A.center.y+"%)translate("+(qv.x*a+a)+"px,"+(-qv.y*l+l)+"px)",O.parentNode!==s&&s.appendChild(O),A.onAfterRender(e,k,z));const j={distanceToCameraSquared:b(z,A)};u.objects.set(A,j)}for(let P=0,O=A.children.length;P<O;P++)_(A.children[P],k,z)}function b(A,k){return v4.setFromMatrixPosition(A.matrixWorld),y4.setFromMatrixPosition(k.matrixWorld),v4.distanceToSquared(y4)}function M(A){const k=[];return A.traverseVisible(function(z){z.isCSS2DObject&&k.push(z)}),k}function C(A){const k=M(A).sort(function(P,O){if(P.renderOrder!==O.renderOrder)return O.renderOrder-P.renderOrder;const j=u.objects.get(P).distanceToCameraSquared,U=u.objects.get(O).distanceToCameraSquared;return j-U}),z=k.length;for(let P=0,O=k.length;P<O;P++)k[P].element.style.zIndex=z-P}}},_4=new At,Zxe=new pm,x4=new At,Yxe=class extends Qs{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof n.element.ownerDocument.defaultView.Element&&n.element.parentNode!==null&&n.element.remove()})})}copy(e,n){return super.copy(e,n),this.element=e.element.cloneNode(!0),this}},Hh=new ki,Kxe=new ki,Jxe=class{constructor(e={}){const n=this;let r,a,l,u;const s={camera:{style:""},objects:new WeakMap},m=e.element!==void 0?e.element:document.createElement("div");m.style.overflow="hidden",this.domElement=m;const _=document.createElement("div");_.style.transformOrigin="0 0",_.style.pointerEvents="none",m.appendChild(_);const b=document.createElement("div");b.style.transformStyle="preserve-3d",_.appendChild(b),this.getSize=function(){return{width:r,height:a}},this.render=function(P,O){const j=O.projectionMatrix.elements[5]*u;O.view&&O.view.enabled?(_.style.transform=`translate( ${-O.view.offsetX*(r/O.view.width)}px, ${-O.view.offsetY*(a/O.view.height)}px )`,_.style.transform+=`scale( ${O.view.fullWidth/O.view.width}, ${O.view.fullHeight/O.view.height} )`):_.style.transform="",P.matrixWorldAutoUpdate===!0&&P.updateMatrixWorld(),O.parent===null&&O.matrixWorldAutoUpdate===!0&&O.updateMatrixWorld();let U,X;O.isOrthographicCamera&&(U=-(O.right+O.left)/2,X=(O.top+O.bottom)/2);const K=O.view&&O.view.enabled?O.view.height/O.view.fullHeight:1,se=O.isOrthographicCamera?`scale( ${K} )scale(`+j+")translate("+M(U)+"px,"+M(X)+"px)"+C(O.matrixWorldInverse):`scale( ${K} )translateZ(`+j+"px)"+C(O.matrixWorldInverse),ue=(O.isPerspectiveCamera?"perspective("+j+"px) ":"")+se+"translate("+l+"px,"+u+"px)";s.camera.style!==ue&&(b.style.transform=ue,s.camera.style=ue),z(P,P,O)},this.setSize=function(P,O){r=P,a=O,l=r/2,u=a/2,m.style.width=P+"px",m.style.height=O+"px",_.style.width=P+"px",_.style.height=O+"px",b.style.width=P+"px",b.style.height=O+"px"};function M(P){return Math.abs(P)<1e-10?0:P}function C(P){const O=P.elements;return"matrix3d("+M(O[0])+","+M(-O[1])+","+M(O[2])+","+M(O[3])+","+M(O[4])+","+M(-O[5])+","+M(O[6])+","+M(O[7])+","+M(O[8])+","+M(-O[9])+","+M(O[10])+","+M(O[11])+","+M(O[12])+","+M(-O[13])+","+M(O[14])+","+M(O[15])+")"}function A(P){const O=P.elements;return"translate(-50%,-50%)"+("matrix3d("+M(O[0])+","+M(O[1])+","+M(O[2])+","+M(O[3])+","+M(-O[4])+","+M(-O[5])+","+M(-O[6])+","+M(-O[7])+","+M(O[8])+","+M(O[9])+","+M(O[10])+","+M(O[11])+","+M(O[12])+","+M(O[13])+","+M(O[14])+","+M(O[15])+")")}function k(P){P.isCSS3DObject&&(P.element.style.display="none");for(let O=0,j=P.children.length;O<j;O++)k(P.children[O])}function z(P,O,j,U){if(P.visible===!1){k(P);return}if(P.isCSS3DObject){const X=P.layers.test(j.layers)===!0,K=P.element;if(K.style.display=X===!0?"":"none",X===!0){P.onBeforeRender(n,O,j);let se;P.isCSS3DSprite?(Hh.copy(j.matrixWorldInverse),Hh.transpose(),P.rotation2D!==0&&Hh.multiply(Kxe.makeRotationZ(P.rotation2D)),P.matrixWorld.decompose(_4,Zxe,x4),Hh.setPosition(_4),Hh.scale(x4),Hh.elements[3]=0,Hh.elements[7]=0,Hh.elements[11]=0,Hh.elements[15]=1,se=A(Hh)):se=A(P.matrixWorld);const J=s.objects.get(P);if(J===void 0||J.style!==se){K.style.transform=se;const ue={style:se};s.objects.set(P,ue)}K.parentNode!==b&&b.appendChild(K),P.onAfterRender(n,O,j)}}for(let X=0,K=P.children.length;X<K;X++)z(P.children[X],O,j)}}},Qxe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
    <path fill-rule="even-odd" fill="currentColor" d="
        M50,50 m45,0
        a45,45 0 1,0 -90,0
        a45,45 0 1,0  90,0

        M50,50 m38,0
        a38,38 0 0,1 -76,0
        a38,38 0 0,1  76,0

        M50,50 m30,0
        a30,30 0 1,0 -60,0
        a30,30 0 1,0  60,0
        
        M50,40 m2.5,-2.5
        l17.5,17.5
        a 2.5,2.5 0 0 1 -5,5
        l-15,-15
        l-15,15
        a 2.5,2.5 0 0 1 -5,-5
        l17.5,-17.5
        a 3.5,3.5 0 0 1 5,0
    "/>
</svg>`,Qw="tourLink",Xv="__tour-link__",e1e={className:"psv-virtual-tour-tooltip",content:'<div class="psv-virtual-tour-loader"><div></div><div></div><div></div></div>'},t1e={element:()=>{const t=document.createElement("button");return t.className="psv-virtual-tour-arrow",t.innerHTML=Qxe,t},size:{width:80,height:80}},jT="arrow",n1e=class extends mm{constructor(t,e){super(t,{className:"psv-virtual-tour-arrows"}),this.plugin=e,this.renderer=this.is3D?new Jxe({element:this.container}):new Xxe({element:this.container}),this.camera=this.is3D?new ac(30,1):null,this.scene=new Hw,this.viewer.addEventListener(ar.ReadyEvent.type,this,{once:!0}),this.viewer.addEventListener(ar.PositionUpdatedEvent.type,this),this.viewer.addEventListener(ar.SizeUpdatedEvent.type,this),this.viewer.addEventListener(ar.RenderEvent.type,this),this.viewer.addEventListener(ar.ClickEvent.type,this),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("contextmenu",n=>n.preventDefault())}get is3D(){return this.plugin.is3D}get arrowsPosition(){return this.plugin.config.arrowsPosition}get arrowStyle(){return this.plugin.config.arrowStyle}init(){this.is3D&&(this.gallery=this.viewer.getPlugin("gallery"),this.gallery?.addEventListener("show-gallery",this),this.gallery?.addEventListener("hide-gallery",this))}destroy(){this.viewer.removeEventListener(ar.ReadyEvent.type,this),this.viewer.removeEventListener(ar.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(ar.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(ar.RenderEvent.type,this),this.viewer.removeEventListener(ar.ClickEvent.type,this),this.gallery?.removeEventListener("show-gallery",this),this.gallery?.removeEventListener("hide-gallery",this),super.destroy()}handleEvent(t){switch(t.type){case ar.ReadyEvent.type:case ar.SizeUpdatedEvent.type:case ar.PositionUpdatedEvent.type:this.__updateCamera();break;case ar.RenderEvent.type:this.render();break;case ar.ClickEvent.type:{if(t.data.rightclick)break;const e=this.__getTargetLink(t.data.target,!0);e&&this.plugin.setCurrentNode(e.nodeId,null,e);break}case"mouseenter":{const e=this.__getTargetLink(nr.getEventTarget(t));e&&this.plugin.__onEnterArrow(e,t);break}case"mouseleave":{const e=this.__getTargetLink(nr.getEventTarget(t));e&&this.plugin.__onLeaveArrow(e);break}case"mousemove":{this.__getTargetLink(nr.getEventTarget(t),!0)&&this.plugin.__onHoverArrow(t);break}case"hide-gallery":this.__onToggleGallery(!1);break;case"show-gallery":t.fullscreen||this.__onToggleGallery(!0);break}}__updateCamera(){const t=this.viewer.getSize();if(this.renderer.setSize(t.width,t.height),this.is3D){const e=this.viewer.getPosition();e.pitch=jr.clamp(e.pitch,-this.arrowsPosition.maxPitch,-this.arrowsPosition.minPitch),this.viewer.dataHelper.sphericalCoordsToVector3(e,this.camera.position,t.height*2).negate(),this.camera.lookAt(0,0,0),this.camera.translateY(t.height/3),this.camera.updateProjectionMatrix()}}render(){if(this.is3D){const t=this.viewer.getPosition(),e=[];let n=Number.MAX_SAFE_INTEGER;this.scene.children.forEach(r=>{const a=r.userData[jT];if(a.conflict){const l=Math.abs(nr.getShortestArc(t.yaw,a.yaw));n=Math.min(n,l),e.push([r,l])}}),e.forEach(([r,a])=>{const l=a!==n;r.element.style.opacity=l?"0.5":null,r.element.style.zIndex=l?"-1":null}),this.renderer.render(this.scene,this.camera)}else this.renderer.render(this.scene,this.viewer.renderer.camera)}clear(){this.scene.clear()}__buildArrowElement(t,e){if(e?.image){const n=document.createElement("img");return n.src=e.image,n}else if(e?.element)return typeof e.element=="function"?e.element(t):e.element}addLinkArrow(t,e,n=1){let r=this.__buildArrowElement(t,t.arrowStyle);r||(r=this.__buildArrowElement(t,this.arrowStyle)),r[Qw]=t;const a={...this.arrowStyle,...t.arrowStyle};if(r.classList.add("psv-virtual-tour-link"),a.className&&nr.addClasses(r,a.className),a.style&&Object.assign(r.style,a.style),this.is3D){r.style.width=a.size.width*1.5+"px",r.style.height=a.size.height*1.5+"px";let l=!1;this.scene.children.forEach(s=>{const m=s.userData[jT];Math.abs(nr.getShortestArc(m.yaw,e.yaw))<this.arrowsPosition.linkOverlapAngle&&(m.conflict=!0,l=!0)});const u=new Yxe(r);u.userData[jT]={yaw:e.yaw,conflict:l},u.rotation.set(-Math.PI/2,0,Math.PI-e.yaw),this.viewer.dataHelper.sphericalCoordsToVector3({yaw:e.yaw,pitch:0},u.position,n*100),this.scene.add(u)}else{r.style.width=a.size.width+"px",r.style.height=a.size.height+"px",r.style.pointerEvents="auto";const l=new qxe(r);this.viewer.dataHelper.sphericalCoordsToVector3(e,l.position),this.scene.add(l)}}__getTargetLink(t,e=!1){const n=e?nr.getClosest(t,".psv-virtual-tour-link"):t;return n?n[Qw]:void 0}__onToggleGallery(t){t?this.container.style.marginBottom=this.viewer.container.querySelector(".psv-gallery").offsetHeight+"px":this.container.style.marginBottom=""}},uj=class{constructor(t,e){this.plugin=t,this.viewer=e,this.nodes={}}destroy(){}checkNode(t){if(!t.id)throw new qn("No id given for node");if(!t.panorama)throw new qn(`No panorama provided for node ${t.id}`);if(this.plugin.isGps&&!(t.gps?.length>=2))throw new qn(`No GPS position provided for node ${t.id}`);if(!this.plugin.isGps&&t.markers?.some(e=>e.gps&&!e.position))throw new qn("Cannot use GPS positioning for markers in manual mode");t.links||(nr.logWarn(`Node ${t.id} has no links`),t.links=[])}checkLink(t,e){if(!e.nodeId)throw new qn(`Link of node ${t.id} has no target id`);if(e.nodeId===t.id)throw new qn(`Node ${t.id} links to itself`);if(!this.plugin.isGps&&!nr.isExtendedPosition(e.position))throw new qn(`No position provided for link ${e.nodeId} of node ${t.id}`);if(this.plugin.isGps&&!e.gps)throw new qn(`No GPS position provided for link ${e.nodeId} of node ${t.id}`)}},r1e=class extends uj{async loadNode(t){if(this.nodes[t])return this.nodes[t];throw new qn(`Node ${t} not found`)}setNodes(t){if(!t?.length)throw new qn("No nodes provided");const e={},n={};t.forEach(r=>{if(this.checkNode(r),e[r.id])throw new qn(`Duplicate node ${r.id}`);e[r.id]=r}),t.forEach(r=>{this.__checkLinks(r,e),r.links.forEach(a=>{n[a.nodeId]=!0})}),t.forEach(r=>{n[r.id]||nr.logWarn(`Node ${r.id} is never linked to`)}),this.nodes=e}updateNode(t){if(!t.id)throw new qn("No id given for node");const e=this.nodes[t.id];if(!e)throw new qn(`Node ${t.id} does not exist`);return Object.assign(e,t),this.checkNode(e),this.__checkLinks(e,this.nodes),e}__checkLinks(t,e){t.links.forEach(n=>{if(!e[n.nodeId])throw new qn(`Target node ${n.nodeId} of node ${t.id} does not exists`);n.gps=n.gps||e[n.nodeId].gps,this.checkLink(t,n)})}},i1e=class extends uj{constructor(t,e){if(super(t,e),!t.config.getNode)throw new qn("Missing getNode() option.");this.nodeResolver=t.config.getNode}async loadNode(t){if(this.nodes[t])return this.nodes[t];{const e=await this.nodeResolver(t);return this.checkNode(e),e.links.forEach(n=>{this.checkLink(e,n)}),this.nodes[t]=e,e}}clearCache(){this.nodes={}}};function b4(t,e){const n=w4(t),r=w4(e),a=t[2]??0,l=e[2]??0;let u=0;return a!==l&&(u=Math.atan((l-a)/o1e(n,r))),{yaw:s1e(n,r),pitch:u}}function w4(t){return[jr.degToRad(t[0]),jr.degToRad(t[1])]}function o1e(t,e){return nr.greatArcDistance(t,e)*6371e3}function s1e(t,e){const[n,r]=t,[a,l]=e,u=Math.sin(a-n)*Math.cos(l),s=Math.cos(r)*Math.sin(l)-Math.sin(r)*Math.cos(l)*Math.cos(a-n);return Math.atan2(u,s)}var XR=nr.getConfigParser({dataMode:"client",positionMode:"manual",renderMode:"3d",nodes:null,getNode:null,startNodeId:null,preload:!1,transitionOptions:{showLoader:!0,speed:"20rpm",effect:"fade",rotation:!0},linksOnCompass:!0,showLinkTooltip:!0,getLinkTooltip:null,arrowStyle:t1e,arrowsPosition:{minPitch:.3,maxPitch:Math.PI/2,linkOverlapAngle:Math.PI/4,linkPitchOffset:-.1},map:null},{dataMode(t){if(t!=="client"&&t!=="server")throw new qn("VirtualTourPlugin: invalid dataMode");return t},positionMode(t){if(t!=="gps"&&t!=="manual")throw new qn("VirtualTourPlugin: invalid positionMode");return t},renderMode(t){if(t!=="3d"&&t!=="2d")throw new qn("VirtualTourPlugin: invalid renderMode");return t},arrowsPosition(t,{defValue:e}){return{...e,...t}},arrowStyle(t,{defValue:e}){return{...e,...t}},map(t,{rawConfig:e}){if(t){if(e.dataMode==="server")return nr.logWarn("VirtualTourPlugin: The map cannot be used in server side mode"),null;if(!t.imageUrl)return nr.logWarn('VirtualTourPlugin: configuring the map requires at least "imageUrl"'),null}return t}}),i1=class hj extends GR{constructor(e,n){super(e,n),this.state={currentNode:null,currentTooltip:null,loadingNode:null,preload:{}},this.arrowsRenderer=new n1e(this.viewer,this)}get is3D(){return this.config.renderMode==="3d"}get isServerSide(){return this.config.dataMode==="server"}get isGps(){return this.config.positionMode==="gps"}static withConfig(e){return[hj,e]}init(){super.init(),this.arrowsRenderer.init(),nr.checkStylesheet(this.viewer.container,"virtual-tour-plugin"),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),this.markers?.config.markers&&(nr.logWarn("No default markers can be configured on the MarkersPlugin when using the VirtualTourPlugin. Consider defining `markers` on each tour node."),delete this.markers.config.markers),this.isGps&&(this.plan=this.viewer.getPlugin("plan")),this.isServerSide||(this.gallery=this.viewer.getPlugin("gallery"),this.map=this.viewer.getPlugin("map"),this.config.map&&!this.map&&nr.logWarn("The map is configured on the VirtualTourPlugin but the MapPlugin is not loaded.")),this.datasource=this.isServerSide?new i1e(this,this.viewer):new r1e(this,this.viewer),this.map&&(this.map.addEventListener("select-hotspot",this),this.map.setImage(this.config.map.imageUrl)),this.plan?.addEventListener("select-hotspot",this),this.isServerSide?this.config.startNodeId&&this.setCurrentNode(this.config.startNodeId):this.config.nodes&&(this.setNodes(this.config.nodes,this.config.startNodeId),delete this.config.nodes)}destroy(){this.map?.removeEventListener("select-hotspot",this),this.plan?.removeEventListener("select-hotspot",this),this.datasource.destroy(),this.arrowsRenderer.destroy(),delete this.datasource,delete this.markers,delete this.compass,delete this.gallery,delete this.arrowsRenderer,super.destroy()}handleEvent(e){if(e instanceof ar.ClickEvent){const n=e.data.objects.find(r=>r.userData[Qw])?.userData[Qw];n&&this.setCurrentNode(n.nodeId,null,n)}else if(e.type==="select-hotspot"){const n=e.hotspotId;n.startsWith(Xv)&&this.setCurrentNode(n.substring(Xv.length))}}getCurrentNode(){return this.state.currentNode}setNodes(e,n){if(this.isServerSide)throw new qn("Cannot set nodes in server side mode");this.__hideTooltip(),this.state.currentNode=null,this.datasource.setNodes(e),n?this.datasource.nodes[n]||(n=e[0].id,nr.logWarn(`startNodeId not found is provided nodes, resetted to ${n}`)):n=e[0].id,this.setCurrentNode(n),this.__setGalleryItems(),this.__setMapHotspots(),this.__setPlanHotspots()}setCurrentNode(e,n,r){if(e===this.state.currentNode?.id&&!n?.forceUpdate)return Promise.resolve(!0);n?.forceUpdate&&this.isServerSide&&this.datasource.clearCache(),this.viewer.hideError(),this.state.loadingNode=e;const a=this.state.currentNode,l=a&&r?this.__getLinkPosition(a,r):null;return Promise.resolve(this.state.preload[e]).then(()=>{if(this.state.loadingNode!==e)throw nr.getAbortError();return this.datasource.loadNode(e)}).then(u=>{if(this.state.loadingNode!==e)throw nr.getAbortError();const s={...XR.defaults.transitionOptions,rotateTo:l,zoomTo:l?this.viewer.getZoomLevel():null,...typeof this.config.transitionOptions=="function"?this.config.transitionOptions(u,a,r):this.config.transitionOptions,...n};return s.effect||(s.effect="none"),this.viewer.panel.hide("description"),this.__hideTooltip(),this.arrowsRenderer.clear(),this.gallery?.config.hideOnClick&&this.gallery.hide(),this.map?.config.minimizeOnHotspotClick&&this.map.minimize(),this.plan?.config.minimizeOnHotspotClick&&this.plan.minimize(),s.rotation&&s.effect==="none"?this.viewer.animate({...s.rotateTo,zoom:s.zoomTo,speed:s.speed}).then(()=>[u,s]):Promise.resolve([u,s])}).then(([u,s])=>{if(this.state.loadingNode!==e)throw nr.getAbortError();return this.markers?.clearMarkers(),this.config.linksOnCompass&&this.compass?.clearHotspots(),this.viewer.setPanorama(u.panorama,{caption:u.caption,description:u.description,panoData:u.panoData,sphereCorrection:u.sphereCorrection,showLoader:s.showLoader,position:s.rotateTo,zoom:s.zoomTo,transition:s.effect==="none"?!1:{effect:s.effect,rotation:s.rotation,speed:s.speed}}).then(m=>{if(!m)throw nr.getAbortError();return u})}).then(u=>{if(this.state.loadingNode!==e)throw nr.getAbortError();return this.state.currentNode=u,this.map&&this.map.setCenter(this.__getNodeMapPosition(u)??this.map.config.center),this.plan?.setCoordinates(u.gps),this.__addNodeMarkers(u),this.__renderLinks(u),this.__preload(u),this.state.loadingNode=null,this.dispatchEvent(new rj(u,{fromNode:a,fromLink:r,fromLinkPosition:l})),this.viewer.resetIdleTimer(),!0}).catch(u=>{if(nr.isAbortError(u))return!1;throw this.viewer.showError(this.viewer.config.lang.loadError),this.viewer.loader.hide(),this.viewer.navbar.setCaption(""),this.state.loadingNode=null,u})}async gotoLink(e,n="8rpm"){const r=this.getLinkPosition(e);n?await this.viewer.animate({...r,speed:n}):this.viewer.rotate(r)}getLinkPosition(e){const n=this.state.currentNode?.links.find(r=>r.nodeId===e);if(!n)throw new qn(`Cannot find link "${e}"`);return this.__getLinkPosition(this.state.currentNode,n)}updateNode(e){if(this.isServerSide)throw new qn("Cannot update node in server side mode");const n=this.datasource.updateNode(e);if((e.name||e.thumbnail||e.panorama)&&this.__setGalleryItems(),(e.name||e.gps||e.map)&&this.__setMapHotspots(),(e.name||e.gps||e.plan)&&this.__setPlanHotspots(),this.state.currentNode?.id===n.id){if(this.__hideTooltip(),e.panorama||e.panoData||e.sphereCorrection){this.setCurrentNode(n.id,{forceUpdate:!0});return}e.caption&&this.viewer.setOption("caption",n.caption),e.description&&this.viewer.setOption("description",n.description),(e.links||e.gps)&&this.__renderLinks(n),e.gps&&this.plan?.setCoordinates(n.gps),(e.map||e.gps)&&this.map?.setCenter(this.__getNodeMapPosition(n)),(e.markers||e.gps)&&this.__addNodeMarkers(n)}}__setGalleryItems(){this.gallery&&this.gallery.setItems(Object.values(this.datasource.nodes).filter(e=>e.showInGallery!==!1).map(e=>({id:e.id,panorama:e.panorama,name:e.name,thumbnail:e.thumbnail})),e=>{this.setCurrentNode(e)})}__setMapHotspots(){this.map&&this.map.setHotspots(Object.values(this.datasource.nodes).filter(e=>e.map!==!1).map(e=>({tooltip:e.name,...e.map||{},...this.__getNodeMapPosition(e),id:Xv+e.id})))}__setPlanHotspots(){this.plan&&this.plan.setHotspots(Object.values(this.datasource.nodes).filter(e=>e.plan!==!1).map(e=>({tooltip:e.name,...e.plan||{},coordinates:e.gps,id:Xv+e.id})))}__renderLinks(e){this.arrowsRenderer.clear();const n=[];e.links.forEach(r=>{const a=this.__getLinkPosition(e,r);a.yaw+=r.linkOffset?.yaw??0,a.pitch+=r.linkOffset?.pitch??0,this.isGps&&!this.is3D&&(a.pitch+=this.config.arrowsPosition.linkPitchOffset),n.push(a),this.arrowsRenderer.addLinkArrow(r,a,r.linkOffset?.depth)}),this.arrowsRenderer.render(),this.config.linksOnCompass&&this.compass?.setHotspots(n)}__getLinkPosition(e,n){return this.isGps?b4(e.gps,n.gps):this.viewer.dataHelper.cleanPosition(n.position)}async __getTooltipContent(e){const n=await this.datasource.loadNode(e.nodeId),r=[];(n.name||n.thumbnail||n.caption)&&(n.name&&r.push(`<h3>${n.name}</h3>`),n.thumbnail&&r.push(`<img src="${n.thumbnail}">`),n.caption&&r.push(`<p>${n.caption}</p>`));let a=r.join("");return this.config.getLinkTooltip&&(a=this.config.getLinkTooltip(a,e,n)),a}__onEnterArrow(e,n){const r=nr.getPosition(this.viewer.container),a={x:n.clientX-r.x,y:n.clientY-r.y};this.config.showLinkTooltip&&(this.state.currentTooltip=this.viewer.createTooltip({...e1e,left:a.x,top:a.y,box:{width:20,height:20}}),this.__getTooltipContent(e).then(l=>{l?this.state.currentTooltip.update(l):this.__hideTooltip()})),this.map?.setActiveHotspot(Xv+e.nodeId),this.plan?.setActiveHotspot(Xv+e.nodeId),this.dispatchEvent(new sj(e,this.state.currentNode))}__onHoverArrow(e){const n=nr.getPosition(this.viewer.container),r={x:e.clientX-n.x,y:e.clientY-n.y};this.state.currentTooltip?.move({left:r.x,top:r.y})}__onLeaveArrow(e){this.__hideTooltip(),this.map?.setActiveHotspot(null),this.plan?.setActiveHotspot(null),this.dispatchEvent(new cj(e,this.state.currentNode))}__hideTooltip(){this.state.currentTooltip?.hide(),this.state.currentTooltip=null}__preload(e){this.config.preload&&(this.state.preload[e.id]=!0,this.state.currentNode.links.filter(n=>!this.state.preload[n.nodeId]).filter(n=>typeof this.config.preload=="function"?this.config.preload(this.state.currentNode,n):!0).forEach(n=>{this.state.preload[n.nodeId]=this.datasource.loadNode(n.nodeId).then(r=>this.viewer.textureLoader.preloadPanorama(r.panorama)).then(()=>{this.state.preload[n.nodeId]=!0}).catch(()=>{delete this.state.preload[n.nodeId]})}))}__addNodeMarkers(e){e.markers&&(this.markers?this.markers.setMarkers(e.markers.map(n=>(n.gps&&this.isGps&&(n.position=b4(e.gps,n.gps),n.data?.map&&Object.assign(n.data.map,this.__getGpsMapPosition(n.gps)),n.data?.plan&&(n.data.plan.coordinates=n.gps)),n))):nr.logWarn(`Node ${e.id} markers ignored because the plugin is not loaded.`))}__getNodeMapPosition(e){const n=this.__getGpsMapPosition(e.gps);return n||(e.map?{x:e.map.x,y:e.map.y}:null)}__getGpsMapPosition(e){const n=this.config.map;return this.isGps&&n&&n.extent&&n.size?{x:jr.mapLinear(e[0],n.extent[0],n.extent[2],0,n.size.width),y:jr.mapLinear(e[1],n.extent[1],n.extent[3],0,n.size.height)}:null}};i1.id="virtual-tour";i1.VERSION="5.13.4";i1.configParser=XR;i1.readonlyOptions=Object.keys(XR.defaults);var U_=i1;const a1e=(t,e)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>{t(...r)},e)}};function S4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function l1e(t){if(Array.isArray(t))return t}function c1e(t,e,n){return(e=f1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u1e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,l,u,s=[],m=!0,_=!1;try{if(l=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;m=!1}else for(;!(m=(r=l.call(n)).done)&&(s.push(r.value),s.length!==e);m=!0);}catch(b){_=!0,a=b}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(_)throw a}}return s}}function h1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function CA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?M4(Object(n),!0).forEach(function(r){c1e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ny(t,e){return l1e(t)||u1e(t,e)||p1e(t,e)||h1e()}function d1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f1e(t){var e=d1e(t,"string");return typeof e=="symbol"?e:e+""}function eS(t){"@babel/helpers - typeof";return eS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eS(t)}function p1e(t,e){if(t){if(typeof t=="string")return S4(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S4(t,e):void 0}}function m1e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dj={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(m,_,b){this.fn=m,this.context=_,this.once=b||!1}function l(m,_,b,M,C){if(typeof b!="function")throw new TypeError("The listener must be a function");var A=new a(b,M||m,C),k=n?n+_:_;return m._events[k]?m._events[k].fn?m._events[k]=[m._events[k],A]:m._events[k].push(A):(m._events[k]=A,m._eventsCount++),m}function u(m,_){--m._eventsCount===0?m._events=new r:delete m._events[_]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var _=[],b,M;if(this._eventsCount===0)return _;for(M in b=this._events)e.call(b,M)&&_.push(n?M.slice(1):M);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(b)):_},s.prototype.listeners=function(_){var b=n?n+_:_,M=this._events[b];if(!M)return[];if(M.fn)return[M.fn];for(var C=0,A=M.length,k=new Array(A);C<A;C++)k[C]=M[C].fn;return k},s.prototype.listenerCount=function(_){var b=n?n+_:_,M=this._events[b];return M?M.fn?1:M.length:0},s.prototype.emit=function(_,b,M,C,A,k){var z=n?n+_:_;if(!this._events[z])return!1;var P=this._events[z],O=arguments.length,j,U;if(P.fn){switch(P.once&&this.removeListener(_,P.fn,void 0,!0),O){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,b),!0;case 3:return P.fn.call(P.context,b,M),!0;case 4:return P.fn.call(P.context,b,M,C),!0;case 5:return P.fn.call(P.context,b,M,C,A),!0;case 6:return P.fn.call(P.context,b,M,C,A,k),!0}for(U=1,j=new Array(O-1);U<O;U++)j[U-1]=arguments[U];P.fn.apply(P.context,j)}else{var X=P.length,K;for(U=0;U<X;U++)switch(P[U].once&&this.removeListener(_,P[U].fn,void 0,!0),O){case 1:P[U].fn.call(P[U].context);break;case 2:P[U].fn.call(P[U].context,b);break;case 3:P[U].fn.call(P[U].context,b,M);break;case 4:P[U].fn.call(P[U].context,b,M,C);break;default:if(!j)for(K=1,j=new Array(O-1);K<O;K++)j[K-1]=arguments[K];P[U].fn.apply(P[U].context,j)}}return!0},s.prototype.on=function(_,b,M){return l(this,_,b,M,!1)},s.prototype.once=function(_,b,M){return l(this,_,b,M,!0)},s.prototype.removeListener=function(_,b,M,C){var A=n?n+_:_;if(!this._events[A])return this;if(!b)return u(this,A),this;var k=this._events[A];if(k.fn)k.fn===b&&(!C||k.once)&&(!M||k.context===M)&&u(this,A);else{for(var z=0,P=[],O=k.length;z<O;z++)(k[z].fn!==b||C&&!k[z].once||M&&k[z].context!==M)&&P.push(k[z]);P.length?this._events[A]=P.length===1?P[0]:P:u(this,A)}return this},s.prototype.removeAllListeners=function(_){var b;return _?(b=n?n+_:_,this._events[b]&&u(this,b)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})(dj);var g1e=dj.exports,v1e=m1e(g1e),Nb=new v1e,yl={on:function(e,n){return Nb.on(e,n)},once:function(e,n){return Nb.once(e,n)},off:function(e,n){return Nb.off(e,n)},emit:function(e,n){return Nb.emit(e,n)}};Object.freeze(yl);var y1e=["src","height","width","hideNavbarButton","containerClass","littlePlanet","onPositionChange","onZoomChange","onClick","onDblclick","onReady"],TA=["zoom","fullscreen"];function _1e(t){var e=CA({},t);for(var n in e)y1e.includes(n)&&delete e[n];return e}function x1e(t,e,n,r,a){return(t-e)*(a-r)/(n-e)+r}function E4(t){return t==null?TA:Array.isArray(t)?t:typeof t=="string"?t===""?!1:[t]:t?TA:!1}function b1e(){var t=q.useState(),e=ny(t,2),n=e[0],r=e[1],a=q.useCallback(function(l){l&&l!==n&&r(l)},[n]);return[n,a]}var ZR=q.forwardRef(function(t,e){var n=b1e(),r=ny(n,2),a=r[0],l=r[1],u=q.useMemo(function(){return t},[t.panorama,t.src,t.size,t.canvasBackground,t.navbar,t.height,t.width,t.containerClass,t.hideNavbarButton||!0,t.littlePlanet,t.fishEye,t.lang,t.onPositionChange,t.onZoomChange,t.onClick,t.onDblclick,t.onReady,t.moveSpeed,t.zoomSpeed,t.moveInertia,t.mousewheel,t.mousemove,t.mousewheelCtrlKey,t.touchmoveTwoFingers,t.panoData,t.requestHeaders,t.withCredentials,t.keyboard,t.keyboardActions,t.plugins,t.adapter,t.sphereCorrection,t.minFov,t.maxFov,t.defaultZoomLvl,t.defaultYaw,t.defaultPitch,t.caption,t.description,t.downloadUrl,t.downloadName,t.loadingImg,t.loadingTxt,t.rendererParameters,t.defaultTransition]),s=q.useRef(null),m=130,_=q.useState(-90),b=ny(_,1),M=b[0],C=q.useState(2),A=ny(C,1),k=A[0],z=q.useState(0),P=ny(z,1),O=P[0],j=q.useState(TA),U=ny(j,2),X=U[0],K=U[1],se=q.useRef(!0);q.useEffect(function(){function ue(){var ne=window.innerWidth/window.innerHeight;m=Math.floor(x1e(ne,.5,1.8,140,115))}return window.addEventListener("resize",ue),ue(),function(){return window.removeEventListener("resize",ue)}},[]),q.useEffect(function(){if(a&&!s.current){var ue,ne,H,de,Ee,Pe,Ze,ke,Te,Ie=new Ixe(CA(CA({},_1e(u)),{},{container:a,panorama:u.panorama||u.src,size:{height:u.height,width:u.width||"100px"},fisheye:u.littlePlanet?k:u.fisheye||!1,minFov:(ue=u.minFov)!==null&&ue!==void 0?ue:30,maxFov:u.littlePlanet?m:(ne=u.maxFov)!==null&&ne!==void 0?ne:90,defaultZoomLvl:u.littlePlanet?O:(H=u.defaultZoomLvl)!==null&&H!==void 0?H:50,defaultYaw:(de=u.defaultYaw)!==null&&de!==void 0?de:0,defaultPitch:u.littlePlanet?M:(Ee=u.defaultPitch)!==null&&Ee!==void 0?Ee:0,sphereCorrection:u.sphereCorrection||{pan:0,tilt:0,roll:0},moveSpeed:u.moveSpeed||1,zoomSpeed:u.zoomSpeed||1,moveInertia:(Pe=u.moveInertia)!==null&&Pe!==void 0?Pe:!0,mousewheel:u.littlePlanet?!1:(Ze=u.mousewheel)!==null&&Ze!==void 0?Ze:!0,mousemove:(ke=u.mousemove)!==null&&ke!==void 0?ke:!0,mousewheelCtrlKey:u.mousewheelCtrlKey||!1,touchmoveTwoFingers:u.touchmoveTwoFingers||!1,panoData:u.panoData||void 0,requestHeaders:u.requestHeaders||void 0,withCredentials:u.withCredentials||!1,navbar:E4(u.navbar),lang:u.lang||{},keyboard:u.keyboard||"fullscreen",plugins:(Te=u.plugins)!==null&&Te!==void 0?Te:[]}));Ie.addEventListener("ready",function(){u.onReady&&u.onReady(Ie)},{once:!0}),Ie.addEventListener("click",function(He){u.onClick&&u.onClick(He,Ie),u.littlePlanet&&se.current&&(se.current=!1,Ie.animate({yaw:0,pitch:M,zoom:75,speed:"3rpm"}).then(function(){Ie.animate({yaw:0,pitch:0,zoom:90,speed:"10rpm"}).then(function(){var pt;Ie.setOption("maxFov",u.maxFov||70),Ie.setOption("mousewheel",(pt=u.mousewheel)!==null&&pt!==void 0?pt:!0)})}))}),Ie.addEventListener("dblclick",function(He){u.onDblclick&&u.onDblclick(He,Ie)}),Ie.addEventListener("zoom-updated",function(He){u.onZoomChange&&u.onZoomChange(He,Ie)}),Ie.addEventListener("position-updated",function(He){u.onPositionChange&&u.onPositionChange(He.position.pitch,He.position.yaw,Ie)});var Ce=E4(u.navbar);if(u.littlePlanet){var Ue,nt,Le=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 11.8805 19.9974 11.7615 19.9922 11.6433C20.2479 11.4141 20.4882 11.1864 20.7118 10.9611C21.0037 10.6672 21.002 10.1923 20.708 9.90049C20.4336 9.628 20.0014 9.61143 19.7077 9.84972C19.4023 8.75248 18.8688 7.75024 18.1616 6.89725C18.4607 6.84611 18.7436 6.8084 19.0087 6.784C19.4212 6.74604 19.7247 6.38089 19.6868 5.96842C19.6488 5.55595 19.2837 5.25235 18.8712 5.29032C18.4474 5.32932 17.9972 5.39638 17.5262 5.48921C17.3267 5.52851 17.1614 5.64353 17.0543 5.79852C15.6765 4.67424 13.917 4 12 4C7.58172 4 4 7.58172 4 12C4 12.2776 4.01414 12.552 4.04175 12.8223C3.78987 12.7532 3.50899 12.8177 3.31137 13.0159C2.97651 13.3517 2.67596 13.6846 2.415 14.0113C2.15647 14.3349 2.20924 14.8069 2.53287 15.0654C2.8565 15.3239 3.32843 15.2711 3.58696 14.9475C3.78866 14.695 4.02466 14.4302 4.2938 14.1557C4.60754 15.2796 5.16056 16.3037 5.8945 17.1697C5.66824 17.3368 5.54578 17.6248 5.60398 17.919C5.68437 18.3253 6.07894 18.5896 6.48528 18.5092C6.7024 18.4662 6.92455 18.4177 7.15125 18.3637C8.49656 19.3903 10.1771 20 12 20ZM7.15125 18.3637C6.69042 18.012 6.26891 17.6114 5.8945 17.1697C5.98073 17.106 6.08204 17.0599 6.19417 17.0377C7.19089 16.8405 8.33112 16.5084 9.55581 16.0486C9.94359 15.903 10.376 16.0994 10.5216 16.4872C10.6671 16.8749 10.4708 17.3073 10.083 17.4529C9.05325 17.8395 8.0653 18.1459 7.15125 18.3637ZM19.7077 9.84972C19.6869 9.86663 19.6667 9.88483 19.6474 9.90431C18.9609 10.5957 18.0797 11.3337 17.0388 12.0753C16.7014 12.3157 16.6228 12.784 16.8631 13.1213C17.1035 13.4587 17.5718 13.5373 17.9091 13.297C18.6809 12.7471 19.3806 12.1912 19.9922 11.6433C19.965 11.0246 19.8676 10.4241 19.7077 9.84972ZM20.9366 5.37924C20.5336 5.28378 20.1294 5.53313 20.034 5.93619C19.9385 6.33925 20.1879 6.74339 20.5909 6.83886C20.985 6.93219 21.1368 7.07125 21.1932 7.16142C21.2565 7.26269 21.3262 7.52732 21.0363 8.10938C20.8516 8.48014 21.0025 8.93042 21.3732 9.1151C21.744 9.29979 22.1943 9.14894 22.379 8.77818C22.7566 8.02003 22.9422 7.12886 22.4648 6.36582C22.1206 5.81574 21.5416 5.52252 20.9366 5.37924ZM2.81481 16.2501C2.94057 15.8555 2.72259 15.4336 2.32793 15.3078C1.93327 15.1821 1.51138 15.4 1.38562 15.7947C1.19392 16.3963 1.17354 17.0573 1.53488 17.6349C1.98775 18.3587 2.84153 18.6413 3.68907 18.7224C4.1014 18.7619 4.46765 18.4596 4.50712 18.0473C4.54658 17.635 4.24432 17.2687 3.83199 17.2293C3.13763 17.1628 2.88355 16.9624 2.80651 16.8393C2.75679 16.7598 2.70479 16.5954 2.81481 16.2501ZM15.7504 14.704C16.106 14.4915 16.2218 14.0309 16.0093 13.6754C15.7967 13.3199 15.3362 13.204 14.9807 13.4166C14.4991 13.7045 13.9974 13.9881 13.4781 14.2648C12.9445 14.5491 12.4132 14.8149 11.8883 15.0615C11.5134 15.2376 11.3522 15.6843 11.5283 16.0592C11.7044 16.4341 12.1511 16.5953 12.526 16.4192C13.0739 16.1618 13.6277 15.8847 14.1834 15.5887C14.7242 15.3005 15.2474 15.0048 15.7504 14.704Z" fill="rgba(255,255,255,.7)"/>
                </svg>`,lt={id:"resetLittlePlanetButton",content:((Ue=t.lang)===null||Ue===void 0?void 0:Ue.littlePlanetIcon)||Le,title:((nt=t.lang)===null||nt===void 0?void 0:nt.littlePlanetButton)||"Reset Little Planet",className:"resetLittlePlanetButton",onClick:function(){se.current=!0,Ie.setOption("maxFov",m),Ie.setOption("mousewheel",!1),Ie.animate({yaw:0,pitch:M,zoom:O,speed:"10rpm"})}};Ce!==!1&&!Ce.find(function(He){return eS(He)==="object"&&He?.id==="resetLittlePlanetButton"})&&Ce.splice(1,0,lt)}if(u.hideNavbarButton){var Ht={id:"hideNavbarButton",content:`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                            <g clip-path="url(#clip0_429_11083)">
                            <path d="M7 7.00006L17 17.0001M7 17.0001L17 7.00006" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                            <clipPath id="clip0_429_11083">
                            <rect width="24" height="24" fill="white"/>
                            </clipPath>
                            </defs>
                            </svg>`,title:"Hide Navbar",className:"hideNavbarButton",onClick:function(){Ie.navbar.hide();var pt=document.createElement("a");pt.className="showNavbarButton",pt.innerHTML=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 26 26" style="enable-background:new 0 0 26 26;" xml:space="preserve" class="icon icon-back-to-top">
                                        <g>
                                        <path d="M13.8,1.3L21.6,9c0.1,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.1,0.3,0.1,0.4s0,0.3-0.1,0.4c-0.1,0.1-0.1,0.3-0.3,0.4
                                            c-0.1,0.1-0.2,0.2-0.4,0.3c-0.2,0.1-0.3,0.1-0.4,0.1c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.3-0.2-0.4-0.3L14.2,5l0,19.1
                                            c0,0.2-0.1,0.3-0.1,0.5c0,0.1-0.1,0.3-0.3,0.4c-0.1,0.1-0.2,0.2-0.4,0.3c-0.1,0.1-0.3,0.1-0.5,0.1c-0.1,0-0.3,0-0.4-0.1
                                            c-0.1-0.1-0.3-0.1-0.4-0.3c-0.1-0.1-0.2-0.2-0.3-0.4c-0.1-0.1-0.1-0.3-0.1-0.5l0-19.1l-5.7,5.7C6,10.8,5.8,10.9,5.7,11
                                            c-0.1,0.1-0.3,0.1-0.4,0.1c-0.2,0-0.3,0-0.4-0.1c-0.1-0.1-0.3-0.2-0.4-0.3c-0.1-0.1-0.1-0.2-0.2-0.4C4.1,10.2,4,10.1,4.1,9.9
                                            c0-0.1,0-0.3,0.1-0.4c0-0.1,0.1-0.3,0.3-0.4l7.7-7.8c0.1,0,0.2-0.1,0.2-0.1c0,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.2-0.1
                                            c0.1,0,0.1,0,0.2,0c0,0,0.1,0,0.2,0c0.1,0,0.2,0,0.2,0.1c0.1,0,0.1,0.1,0.2,0.1C13.7,1.2,13.8,1.2,13.8,1.3z"></path>
                                        </g>
                                        </svg>`,pt.title="Show Navbar",pt.onclick=function(_t){_t.preventDefault(),Ie.navbar.show(),pt.remove()},document.body.appendChild(pt)}};Ce!==!1&&!Ce.find(function(He){return eS(He)==="object"&&He?.id==="hideNavbarButton"})&&Ce.push(Ht)}Ce!==!1?(Ie.setOption("navbar",Ce),K(Ce)):Ie.navbar.hide(),yl.on("animate",function(He){Ie.animate(He)}).on("stop-animation",function(){Ie.stopAnimation()}).on("destroy",function(){Ie.destroy()}).on("rotate",function(He){Ie.rotate(He)}).on("setOption",function(He){var pt=He.option,_t=He.value;Ie.setOption(pt,_t)}).on("setOptions",function(He){Ie.setOptions(He)}).on("zoom",function(He){Ie.zoom(He)}).on("zoomIn",function(He){Ie.zoomIn(He)}).on("zoomOut",function(He){Ie.zoomOut(He)}).on("resize",function(He){Ie.resize(He)}).on("enterFullscreen",function(){Ie.enterFullscreen()}).on("exitFullscreen",function(){Ie.exitFullscreen()}).on("toggleFullscreen",function(){Ie.toggleFullscreen()}).on("needsContinuousUpdate",function(He){Ie.needsContinuousUpdate(He)}).on("observeObjects",function(He){Ie.observeObjects(He)}).on("unobserveObjects",function(He){Ie.unobserveObjects(He)}).on("setCursor",function(He){Ie.setCursor(He)}).on("setPanorama",function(He){Ie.setPanorama(He.path,He.options)}).on("showError",function(He){Ie.showError(He)}).on("hideError",function(){Ie.hideError()}).on("startKeyboardControl",function(){Ie.startKeyboardControl()}).on("stopKeyboardControl",function(){Ie.stopKeyboardControl()}),s.current=Ie}},[a,u]),q.useEffect(function(){var ue=s.current;if(ue&&ue.container&&ue.container.parentNode&&ue&&ue.container&&ue.container.parentNode){var ne,H,de,Ee;(ne=ue.renderer)===null||ne===void 0||(H=ne.renderer)===null||H===void 0||H.dispose(),(de=ue.renderer)===null||de===void 0||(Ee=de.renderer)===null||Ee===void 0||Ee.forceContextLoss(),ue.destroy()}},[s]),q.useEffect(function(){var ue,ne=(ue=u.panorama)!==null&&ue!==void 0?ue:u.src;s.current&&ne&&s.current.setPanorama(ne,{})},[u.src,u.panorama]);var J=function(){return{animate:function(H){yl.emit("animate",H)},destroy:function(){yl.emit("destroy",{})},createTooltip:function(H){var de;return(de=s.current)===null||de===void 0?void 0:de.createTooltip(H)},needsContinuousUpdate:function(H){yl.emit("needsContinuousUpdate",H)},observeObjects:function(H){yl.emit("observeObjects",H)},unobserveObjects:function(H){yl.emit("unobserveObjects",H)},setCursor:function(H){yl.emit("setCursor",H)},stopAnimation:function(){yl.emit("stop-animation",{})},rotate:function(H){yl.emit("rotate",H)},setOption:function(H,de){yl.emit("setOption",{option:H,value:de})},setOptions:function(H){var de;return(de=s.current)===null||de===void 0?void 0:de.setOptions(H)},getCurrentNavbar:function(){return X},zoom:function(H){yl.emit("zoom",H)},zoomIn:function(H){yl.emit("zoomIn",{step:H})},zoomOut:function(H){yl.emit("zoomOut",{step:H})},resize:function(H){var de;return(de=s.current)===null||de===void 0?void 0:de.resize(H)},enterFullscreen:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.enterFullscreen()},exitFullscreen:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.exitFullscreen()},toggleFullscreen:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.toggleFullscreen()},isFullscreenEnabled:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.isFullscreenEnabled()},getPlugin:function(H){var de;return(de=s.current)===null||de===void 0?void 0:de.getPlugin(H)},getPosition:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.getPosition()},getZoomLevel:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.getZoomLevel()},getSize:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.getSize()},needsUpdate:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.needsUpdate()},autoSize:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.autoSize()},setPanorama:function(H,de){var Ee;return(Ee=s.current)===null||Ee===void 0?void 0:Ee.setPanorama(H,de)},showError:function(H){var de;return(de=s.current)===null||de===void 0?void 0:de.showError(H)},hideError:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.hideError()},startKeyboardControl:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.startKeyboardControl()},stopKeyboardControl:function(){var H;return(H=s.current)===null||H===void 0?void 0:H.stopKeyboardControl()}}};return q.useImperativeHandle(e,J,[s.current,a,u,e]),p_.createElement("div",{className:u.containerClass||"view-container",ref:l})});ZR.displayName="ReactPhotoSphereViewer";const fj=t=>{const e=t.getCenter(),n=t.getBearing(),r=t.getPitch(),a=n||r?[n,r]:[];return"#"+[t.getZoom(),e.lat,e.lng,...a].map(u=>Number(u.toFixed(3))).join("/")},tS=[15,90],pj=tS[1]-tS[0],w1e=t=>{const[e,n,r,a="0",l="0"]=t.slice(1).split("/");return{zoom:Number(e),lngLat:[Number(r),Number(n)],bearing:Number(a),pitch:Number(l)}},C4=(t,e)=>{const[n]=e.split("!");if(!n||n===fj(t))return;const r=w1e(n);t.setZoom(r.zoom),t.setCenter(r.lngLat),t.setBearing(r.bearing),t.setPitch(r.pitch)},S1e=(t,e)=>{const{yaw:n,pitch:r}=t.getPosition(),a=t.getZoomLevel(),l=Number(Tk(n).toFixed(2)),u=Number(Tk(r).toFixed(2)),s=Number(((1-a/100)*pj+tS[0]).toFixed(2));return"!"+[e,l,u,s].join("/")},M1e=t=>{ld.checkArgument(t.startsWith("!"));const[e,n,r,a]=t.slice(1).split("/");return{id:e,yaw:Number(Pw(Number(n??0)).toFixed(3)),pitch:Number(Pw(Number(r??0)).toFixed(3)),zoom:Math.round((1-(Number(a??0)-tS[0])/pj)*100)}},E1e=[{name:"Trucker Mudgeon",avatarUrl:"https://avatars.githubusercontent.com/u/121829201?v=4"},{name:"San_Sany4",avatarUrl:"https://avatars.githubusercontent.com/u/3860505?v=4"}],C1e=(t,e)=>({width:8192,cols:16,rows:8,baseUrl:`${t}/${e}_thumb.jpg`,tileUrl:(n,r)=>`${t}/${e}_${n}_${r}.jpg`}),T1e=t=>e=>({baseUrl:`${t}/${e}/thumb.jpg`,tileUrl:function(n,r,a=0){return`${t}/${e}/${a}/${n}_${r}.jpg`},width:15520,cols:32,rows:16,levels:[{width:15520/2,cols:32/2,rows:16/2,zoomRange:[0,60]},{width:15520,cols:32,rows:16,zoomRange:[60,100]}]}),P1e=q.memo(t=>{const{panorama:e,tileRootUrl:n,pixelRootUrl:r,mode:a="light"}=t,[l,u]=q.useState(e.find(ne=>ne.active)??e[0]),[s,m]=q.useState(((e.find(ne=>ne.active)??e[0]).yaw??0)/Math.PI*180),_=q.useRef(null),b=q.useRef(null),M=q.useRef(null),C=()=>{const ne=b.current;if(!ne)return;const de=pr(ne.getPlugin(U_)).getCurrentNode()??J.nodes?.find(ke=>ke.id===J.startNodeId);if(!de){console.warn("StreetView hashUpdater: could not find node");return}const Ee=de.id,Pe=S1e(ne,Ee),[Ze]=window.location.hash.split("!");u(pr(e.find(ke=>ke.id===Ee))),window.history.replaceState(window.history.state,"",Ze+Pe)},A=a1e(C,300),k=(ne,H)=>{m(H/Math.PI*180),A()},z=()=>{A()},P=({node:ne})=>{const[H,de]=pr(ne.gps),Ee=[H,de];_.current?.panTo(Ee),M.current?.setLngLat(Ee),u(pr(e.find(Pe=>Pe.id===ne.id)))},O=()=>{const ne=pr(b.current);pr(ne.getPlugin(U_)).addEventListener("node-changed",P),C()},{yaw:j,pitch:U,zoom:X}=e[0],K=ne=>C1e(r,ne),se=T1e(r),J=q.useMemo(()=>{const ne={positionMode:"gps",nodes:e.map((H,de)=>({id:H.id,panorama:H.driverId===0?K(H.id):se(H.id),gps:H.point,links:[{nodeId:e[de-1]?.id},{nodeId:e[de+1]?.id}].filter(Ee=>Ee.nodeId!=null)})),startNodeId:e.find(H=>H.active)?.id};if(e.length>=3&&e.some(H=>H.loop)){const H=ne.nodes.at(0),de=ne.nodes.at(-1);H.links.push({nodeId:de.id}),de.links.push({nodeId:H.id})}return ne},[e]),ue=J.nodes.at(0).panorama;return ae.jsxs(ae.Fragment,{children:[ae.jsx(ZR,{ref:b,adapter:ej,minFov:15,plugins:[U_.withConfig(J)],src:ue,height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:k,onZoomChange:z,defaultYaw:j,defaultPitch:U,defaultZoomLvl:X,onReady:O}),ae.jsx(eP,{sx:{position:"absolute",m:2.5,top:0,left:0,background:"#000a"},color:"neutral",invertedColors:!0,variant:"solid",children:ae.jsxs(Sa,{direction:"row",gap:2,alignItems:"flex-start",children:[ae.jsx(sd,{onClick:t.onClose,children:ae.jsx(Rse,{htmlColor:"#fff8"})}),ae.jsx(A1e,{pano:l})]})}),ae.jsx("div",{className:"credits",children:"Game data and images  SCS Software."}),ae.jsxs(Bx,{ref:_,style:{position:"absolute",left:20,bottom:20,width:"200px",height:"200px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:9,maxZoom:14,maxBounds:[l.point.map(ne=>ne-1),l.point.map(ne=>ne+1)],mapStyle:JS,attributionControl:!1,initialViewState:{longitude:l.point[0],latitude:l.point[1],zoom:10},children:[ae.jsx(BI,{ref:M,longitude:l.point[0],latitude:l.point[1],rotation:s,rotationAlignment:"map",children:ae.jsx("div",{className:"street-view-marker"})}),ae.jsx(KS,{tileRootUrl:n,mode:a}),ae.jsx(By,{tileRootUrl:n,game:"ats",mode:a,enableIconAutoHide:!0,visibleIcons:Ny,dlcs:Rg})]})]})},(t,e)=>{const n=JSON.stringify(t.panorama.map(a=>a.id)),r=JSON.stringify(e.panorama.map(a=>a.id));return n===r}),A1e=({pano:t})=>{const{name:e,avatarUrl:n}=E1e[t.driverId];return ae.jsxs(zS,{sx:{display:"flex",flexDirection:"column",gap:1},children:[ae.jsxs(Ci,{level:"title-lg",sx:{lineHeight:1},children:[t.label,ae.jsxs(Ci,{level:"body-xs",sx:{opacity:.8},children:[ae.jsx("br",{}),t.location]})]}),ae.jsxs(Sa,{direction:"row",alignItems:"center",gap:1,sx:{transformOrigin:"left",transform:"scale(0.8)",mt:-.5},children:[ae.jsx(eK,{src:n,size:"sm"}),ae.jsx(Ci,{level:"title-sm",children:e})]}),ae.jsx(Ax,{}),ae.jsx(Sa,{direction:"row",gap:2,children:ae.jsx(Ci,{level:"body-xs",children:t.captureDate})})]})},mj=8192,ry=512,I1e=mj/360,T4=mj/ry,Zv=100,R1e=t=>{const{pixelRootUrl:e,panorama:n}=t,r=NI(n.yaw??0)*180/Math.PI+180,a=Math.floor(I1e*r);let l,u;return a%ry<ry/2?(u=Math.floor(a/ry),l=u===0?T4-1:u-1):(l=Math.floor(a/ry),u=l===T4-1?0:l+1),ae.jsx("div",{style:{overflow:"hidden",width:Zv},children:ae.jsxs("div",{style:{display:"flex",position:"relative",left:-r*Zv/ry},children:[ae.jsx("img",{width:Zv,height:Zv,src:`${e}/${n.id}_${l}_3.jpg`}),ae.jsx("img",{width:Zv,height:Zv,src:`${e}/${n.id}_${u}_3.jpg`})]})})},P4=(t,[e,n])=>!isNaN(t)&&e<=t&&t<=n,D1e=t=>{const{tileRootUrl:e,pixelRootUrl:n,specialEvent:r}=t,{mode:a,systemMode:l}=xS(),u=a==="system"?l:a,[s,m]=q.useState(localStorage.getItem("tm-map")==="europe"?"europe":"usa"),[_,b]=q.useState(L1e(localStorage.getItem("tm-secrets"))),{longitude:M,latitude:C}=iw[k1e(localStorage.getItem("tm-map"))];window.location.hash||window.history.replaceState(window.history.state,"","#"+[4,Number(C.toFixed(3)),Number(M.toFixed(3))].join("/"));const[A]=sne(),k=Number(A.get("mlat")??void 0),z=Number(A.get("mlon")??void 0),P=P4(k,[-90,90])&&P4(z,[-180,180])?{lat:k,lon:z}:void 0,O=s==="usa"?Ny:J6,j=new Set([...O].filter(_t=>!Q6.includes(_t))),[U,X]=q.useState(!0),[K,se]=q.useState(j),[J,ue]=q.useState(new Set(Rg)),ne=l8(J),H=Fw(K,se,O),de=Fw(J,ue,Rg),[Ee,Pe]=q.useState(!1),Ze=q.useRef(null),[ke,Te]=q.useState(!1),[Ie,Ce]=q.useState(null),[Ue,nt]=q.useState(null),Le=q.useCallback(()=>Ce(null),[]),[lt,Ht]=q.useState(null);q.useEffect(()=>{if(!Ze.current||!lt)return;const _t=Ze.current;C4(_t,window.location.hash),He(window.location.hash.split("!")[1]);const ot=()=>window.history.replaceState(window.history.state,"",fj(_t)),et=()=>m(localStorage.getItem("tm-map")==="europe"?"europe":"usa");_t.on("moveend",ot),_t.on("moveend",et);const Mt=()=>{const[Tt,hn]=window.location.hash.split("!");C4(_t,Tt),He(hn)};return window.addEventListener("hashchange",Mt),()=>{window.removeEventListener("hashchange",Mt),_t.off("moveend",ot),_t.off("moveend",et)}},[Ze.current,lt]);const He=q.useCallback(_t=>{if(lt==null||_t==null)return;const{id:ot,yaw:et,pitch:Mt,zoom:Tt}=M1e("!"+_t);if(Ie?.some(an=>an.id===ot))return;const hn=lt.features.find(an=>an.properties.id===ot&&an.geometry.type==="Point");if(hn){ke||Te(!0),Ce([{...hn.properties,point:hn.geometry.coordinates,active:!0,yaw:et,pitch:Mt,zoom:Tt}]);return}const en=lt.features.find(an=>an.geometry.type==="LineString"&&an.properties.panos.some(Ke=>Ke.id===ot));if(en){ke||Te(!0),Ce(en.properties.panos.map((an,Ke)=>({...A4(an,Ke,en,an.id===ot),yaw:et,pitch:Mt,zoom:Tt})));return}},[lt,Ie,ke]);q.useEffect(()=>{fetch("/street-view.geojson").then(_t=>_t.json()).then(_t=>Ht(_t)).catch(_t=>console.error(_t))},[]),q.useEffect(()=>{if(!Ze.current||!ke||!lt)return;const _t=Ze.current,ot=Tt=>{const hn=_t.queryRenderedFeatures(Tt.point,{layers:["photo-spheres"]})[0],en=_t.queryRenderedFeatures(Tt.point,{layers:["sv-streets"]})[0];if(_t.getCanvas().style.cursor=hn||en?"pointer":"",hn){if(Ue?.id!==hn.properties.id){const an=hn;nt({...an.properties,point:an.geometry.coordinates,active:!0})}}else Ue&&nt(null)},et=Tt=>{const hn=_t.queryRenderedFeatures(Tt.point,{layers:["photo-spheres"]})[0];if(hn&&hn.properties.cluster!==!0){nt(null),Ce(Ue==null?null:[Ue]);return}const en=_t.queryRenderedFeatures(Tt.point,{layers:["sv-streets"]})[0];if(en){nt(null);const an=en.properties.id,Ke=pr(lt.features.find(dn=>dn.properties.id===an)),An=Tt.lngLat.toArray(),Gt=Ise(Ke,An).properties.index,on=Tw(Ke.geometry.coordinates[Gt],An),Wt=Tw(Ke.geometry.coordinates[Gt+1],An),Gn=on<Wt?Gt:Gt<Ke.properties.panos.length?Gt+1:0;Ce(Ke.properties.panos.map((dn,Ve)=>A4(dn,Ve,Ke,Ve===Gn)))}},Mt=Tt=>{Ie!=null&&Tt.key==="Escape"&&Ce(null)};return Ie&&document.addEventListener("keydown",Mt),_t.on("mousemove",ot),_t.on("click",et),()=>{_t.off("mousemove",ot),_t.off("click",et),document.removeEventListener("keydown",Mt)}},[Ze.current,ke,Ie,Ue,lt]);const pt=ae.jsxs(Bx,{ref:Ze,style:{width:"100svw",height:"100svh",display:Ie?"none":void 0},minZoom:4,maxZoom:15,mapStyle:JS,attributionControl:!1,initialViewState:{longitude:M,latitude:C,zoom:4},children:[P&&ae.jsx(BI,{longitude:P.lon,latitude:P.lat}),ae.jsxs(KS,{tileRootUrl:e,mode:u,children:[ae.jsx(pP,{tileRootUrl:e,game:"ats",showContours:Ee}),ae.jsx(pP,{tileRootUrl:e,game:"ets2",showContours:Ee})]}),ae.jsx(By,{tileRootUrl:e,game:"ats",mode:u,enableIconAutoHide:U,visibleIcons:K,showSecrets:_,dlcs:J,children:ae.jsxs(ae.Fragment,{children:[K.has(go.CityNames)&&ae.jsx(gP,{game:"ats",mode:u,enableAutoHide:U,enabledStates:ne}),ke&&ae.jsxs(Jp,{id:"street-view",type:"geojson",data:"/street-view.geojson",cluster:!1,clusterMaxZoom:7,clusterRadius:10,children:[ae.jsx(Dr,{id:"photo-spheres-halo",type:"circle",paint:{"circle-radius":10,"circle-color":u==="light"?"#fff8":"#8884","circle-blur":.75},filter:["in","$type","Point"]}),ae.jsx(Dr,{id:"photo-spheres",type:"circle",paint:{"circle-radius":5,"circle-color":"#48f2","circle-stroke-width":2,"circle-stroke-color":"#48f"},filter:["in","$type","Point"]}),ae.jsx(Dr,{id:"sv-streets-case",type:"line",paint:{"line-color":"#aef","line-width":2,"line-gap-width":4},filter:["in","$type","LineString"]}),ae.jsx(Dr,{id:"sv-streets",type:"line",paint:{"line-color":"#2ab","line-width":4},filter:["in","$type","LineString"]})]})]})}),ae.jsx(By,{tileRootUrl:e,game:"ets2",mode:u,enableIconAutoHide:U,visibleIcons:K,showSecrets:_,children:K.has(go.CityNames)&&ae.jsx(gP,{game:"ets2",mode:u,enableAutoHide:U})}),ae.jsxs(Jp,{id:"measure",type:"geojson",data:{type:"FeatureCollection",features:[]},children:[ae.jsx(Dr,{id:"measure-lines",type:"line",paint:{"line-color":"#f00","line-width":3,"line-opacity":1},filter:["in","$type","LineString"]}),ae.jsx(Dr,{id:"measure-points",type:"circle",paint:{"circle-radius":5,"circle-color":"#fff","circle-stroke-width":3,"circle-stroke-color":"#f00"},filter:["in","$type","Point"]})]}),ae.jsx($I,{visualizePitch:!0}),ae.jsx(lpe,{visible:s==="usa",active:ke,onToggle:Te}),ae.jsx(UI,{containerId:"fsElem"}),ae.jsx(cpe,{}),ae.jsx(iR,{}),ae.jsx(upe,{specialEvent:r}),ae.jsx(T6,{compact:!0,style:{marginLeft:54},customAttribution:" Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a> and <a href='https://forum.scssoft.com/viewtopic.php?p=1946956#p1946956'>krmarci</a>."}),ae.jsx(ope,{reserveRoomForSpecialEventButton:r!=null,visibleStates:ne,visibleStateDlcs:J}),ae.jsx(PU,{icons:{...H,enableAutoHiding:U,onAutoHidingToggle:X},advanced:{showSecrets:_,onSecretsChange:_t=>{b(_t),localStorage.setItem("tm-secrets",_t)},showContours:Ee,onContoursToggle:Pe},atsDlcs:de}),Ue&&ae.jsx(Xie,{className:"pano-preview-popup",closeButton:!1,closeOnClick:!1,closeOnMove:!0,longitude:Ue.point[0],latitude:Ue.point[1],children:ae.jsx(R1e,{panorama:Ue,pixelRootUrl:n})}),ae.jsx(Uhe,{}),ae.jsx(mI,{open:s==="usa"&&ke,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",children:ae.jsxs(Sa,{direction:"column",gap:1,width:"100%",children:[ae.jsx(Ci,{level:"title-md",children:"Images"}),ae.jsxs(Sa,{direction:"row",justifyContent:"space-around",children:[ae.jsxs(Ci,{level:"body-sm",children:[ae.jsx("span",{style:{display:"inline-block",width:"1.25em",height:"1em",marginRight:"1ex",position:"relative"},children:ae.jsx("span",{style:{position:"absolute",top:"50%",width:"100%",height:1,border:"2px solid #2ab",outline:"1px solid #aef"}})}),"Street View"]}),ae.jsxs(Ci,{level:"body-sm",sx:{position:"relative"},children:[ae.jsx("span",{style:{display:"inline-block",position:"relative",top:2,width:"1em",height:"1em",marginRight:"1ex",borderRadius:"50%",background:"#48f2",border:"2px solid #48f"}}),"Photo Sphere"]})]}),ae.jsx(Ci,{level:"body-xs",children:"Click highlighted areas to see images."})]})})]});return ae.jsxs(ae.Fragment,{children:[pt,Ie&&ae.jsxs(ae.Fragment,{children:[ae.jsx(P1e,{tileRootUrl:e,pixelRootUrl:n,panorama:Ie,mode:u,onClose:Le}),ae.jsx(sd,{sx:{background:"#000a",position:"absolute",borderRadius:"50%",m:2.5,top:0,right:0},size:"lg",variant:"solid",onClick:Le,children:ae.jsx(FI,{})})]})]})};function A4(t,e,n,r){return{...t,location:n.properties.location,point:n.geometry.coordinates[e],active:r,dlcGuard:0}}function L1e(t){return t==="showAsNormal"||t==="showAsDashed"||t==="hide"?t:"showAsNormal"}function k1e(t){return t==="europe"?t:"usa"}var z1e=Object.defineProperty,O1e=(t,e,n)=>e in t?z1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,F1e=(t,e,n)=>(O1e(t,e+"",n),n);class N1e{constructor(e){F1e(this,"_kind"),this._kind=e}}function B1e(t,e){const n=t.toString(),r=e.toString();return n>r?1:n<r?-1:0}const U1e=B1e;var $1e=Object.defineProperty,V1e=(t,e,n)=>e in t?$1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,I4=(t,e,n)=>(V1e(t,typeof e!="symbol"?e+"":e,n),n);function j1e(t,e,n){const r=e*2,a=e*2+1;let l=e;return r<t.length&&n(t[l],t[r])<0&&(l=r),a<t.length&&n(t[l],t[a])<0&&(l=a),l}function YR(t,e,n){const r=j1e(t,e,n);if(r!==e){const a=t[e];t[e]=t[r],t[r]=a,YR(t,r,n)}}function R4(t){for(let e=Math.floor(t.collection.length/2)-1;e>=0;--e)YR(t.collection,e,t.comparator)}class nS extends N1e{constructor({comparator:e=U1e}={}){super("BinaryHeap"),I4(this,"comparator"),I4(this,"collection",[]),this.comparator=e}static from(e,n={}){const r=new nS(n);return r.collection=Array.from(e),R4(r),r}clear(){this.collection.length=0}toArray(){return[...this.collection].sort(this.comparator)}get length(){return this.collection.length}top(){if(this.length===0)throw new Error("invalid operation: top() called for empty BinaryHeap");return this.collection[0]}pop(){if(this.length===0)throw new Error("invalid operation: pop() called for empty BinaryHeap");const e=this.collection[0];return this.collection.length>1?(this.collection[0]=this.collection.pop(),YR(this.collection,0,this.comparator)):this.collection.pop(),e}push(e){this.collection.push(e);const n=this.collection;for(let r=n.length-1,a=Math.floor(r/2);r>0&&this.comparator(n[a],n[r])<0;r=a,a=Math.floor(a/2)){const l=n[r];n[r]=n[a],n[a]=l}}merge(e){e instanceof nS?this.collection=this.collection.concat(e.collection):this.collection=this.collection.concat(e.toArray()),R4(this),e.clear()}isEmpty(){return!this.collection.length}}function H1e(t,e,n,r){return`${t.toString(16)}-${e.toString(16)}-${n}-${r}`}function G1e(t,e,n,r,a){ld.checkArgument(a.graph.has(t),`cannot find route from unknown node ${t.toString(16)}`),ld.checkArgument(a.graph.has(e),`cannot find route to unknown node ${e.toString(16)}`);const l=H1e(t,e,n,r),{nodeLUT:u,graph:s}=a,m=pr(u.get(t)),_=pr(u.get(e)),b=new q1e({comparator:(j,U)=>{const X=P.get(j)??1/0;return(P.get(U)??1/0)-X}}),M={nodeUid:t,distance:0,duration:0,direction:n,dlcGuard:-1};b.push(M);const C=new Map,A=new Map;A.set(M,0);const k=j=>r==="fastest"?0:Tw(j,_),z=(j,U)=>{switch(r){case"shortest":return U.distance;case"smallRoads":return U.isOneLaneRoad?U.distance:U.distance*10;case"fastest":return U.duration;default:throw new ah(r)}},P=new Map;P.set(M,k(m));let O=0;for(;!b.isEmpty();){O++;const j=b.pop();if(j.nodeUid===e)return{success:!0,key:l,mode:r,score:pr(A.get(j)),...W1e(C,j)};const U=s.get(j.nodeUid);if(!U)continue;const X=j.direction==="forward"?U.forward:U.backward;for(const K of X){if(!a.enabledDlcGuards.has(K.dlcGuard))continue;const se=(A.get(j)??1/0)+z(j,K);se<(A.get(K)??1/0)&&(C.set(K,j),A.set(K,se),P.set(K,se+k(pr(u.get(K.nodeUid)))),b.has(K)||b.push(K))}}return{success:!1,key:l,mode:r,numIters:O}}function W1e(t,e){let n=0,r=0;const a=[e];for(;t.has(e);)e=t.get(e),a.unshift(e),n+=e.distance,r+=e.duration;return a.length===1&&a.push(a[0]),{route:a,distance:n,duration:r}}class q1e extends nS{items=new Set;constructor(e){super(e)}has(e){return this.items.has(e)}push(e){ld.checkState(!this.items.has(e)),super.push(e),this.items.add(e)}pop(){const e=super.pop();return ld.checkState(this.items.has(e)),this.items.delete(e),e}clear(){super.clear(),this.items.clear()}merge(e){super.merge(e);for(const n of this.collection)this.items.add(n)}}const X1e=t=>{const{tileRootUrl:e}=t,{mode:n,systemMode:r}=xS(),a=n==="system"?r:n,[l,u]=q.useState(!0),[s,m]=q.useState(new Set(Ny)),[_,b]=q.useState(new Set(Rg)),M=l8(_),C=Fw(s,m,Ny),A=Fw(_,b,Rg),[k,z]=q.useState("showAsNormal"),[P,O]=q.useState(!1);return ae.jsxs(Bx,{style:{width:"100vw",height:"100vh"},minZoom:4,maxZoom:15,maxBounds:[[-135,21],[-84,54]],mapStyle:JS,attributionControl:!1,initialViewState:{longitude:-115,latitude:36,zoom:9},children:[ae.jsx(KS,{tileRootUrl:e,mode:a,children:ae.jsx(pP,{tileRootUrl:e,game:"ats",showContours:P})}),ae.jsx(By,{tileRootUrl:e,game:"ats",mode:a,enableIconAutoHide:l,visibleIcons:s,dlcs:_,showSecrets:k,children:ae.jsxs(ae.Fragment,{children:[ae.jsx(gP,{game:"ats",mode:a,enableAutoHide:l,enabledStates:M}),ae.jsx(Jp,{id:"route1",type:"geojson",data:{type:"FeatureCollection",features:[]},children:ae.jsx(Dr,{type:"line",paint:{"line-color":["match",["get","mode"],"shortest","#f00","smallRoads","#0f0","#f0f"],"line-width":3,"line-opacity":.7}})})]})}),ae.jsx($I,{visualizePitch:!0}),ae.jsx(UI,{}),ae.jsx(iR,{}),ae.jsx(T6,{compact:!0,customAttribution:" Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a>."}),ae.jsx(Z1e,{dlcs:_}),ae.jsx(PU,{icons:{...C,enableAutoHiding:l,onAutoHidingToggle:u},advanced:{showSecrets:k,onSecretsChange:z,showContours:P,onContoursToggle:O},atsDlcs:A})]})},Z1e=t=>{const{current:e}=Nx(),n=Fx(t.dlcs),[r,a]=q.useState(void 0),[l,u]=q.useState(void 0),[s,m]=q.useState([]),[_,b]=q.useState([]);q.useEffect(()=>{fetch("usa-graph-demo.json").then(J=>J.json()).then(J=>{m(J.demoCompanies.map(k4)),u(Y1e(J)),a(J)},()=>console.error("could not load usa-graph-demo.json"))},[]);const[M,C]=q.useState(void 0),[A,k]=q.useState(void 0),z=q.useCallback(J=>{J=pr(J),C(J.value);let ue;if(r!=null){ue=pr(r.demoCompanies.find(de=>de.n===J.value));const ne=pr(r.demoCompanyDefs.find(de=>de.t===ue.t)),H=new Set(ne.d);b(r.demoCompanies.filter(de=>H.has(de.t)).map(k4))}if(!(e==null||l==null)&&(A!=null&&(pr(e.getSource("route1")).setData({type:"FeatureCollection",features:[]}),k(void 0)),ue)){const ne=pr(l.nodeLUT.get(BigInt(parseInt(ue.n,36))));e.flyTo({curve:1,zoom:9,center:[ne.x,ne.y]})}},[e,A,l,r]),P=q.useCallback(J=>{J=pr(J),k(J.value),!(e==null||l==null)&&O(pr(M),J.value,e,{...l,enabledDlcGuards:n})},[e,M,l,t.dlcs]),O=(J,ue,ne,H)=>{Promise.all([z4(J,ue,"shortest",H),z4(J,ue,"smallRoads",H)]).then(de=>{const Ee=pr(ne.getSource("route1"));if(de.some(Ze=>Ze==null)){alert("Cannot calculate a route "),Ee.setData({type:"FeatureCollection",features:[]});return}const Pe=de;Ee.setData({type:"FeatureCollection",features:Pe}),ne.fitBounds(b6(Pe.flatMap(Ze=>Ze.geometry.coordinates)),{padding:150,curve:1,duration:2500})},de=>{console.error("error finding route",de)})},j=new Map;if(r)for(const[,J]of r.demoGraph)for(const ue of[...J.b??[],...J.f??[]]){const ne=j.get(ue.n)??0;j.set(ue.n,ne||ue.g)}const U=J=>{if(l==null)return!0;const ue=pr(j.get(J.value));return n.has(ue)},X=(J,ue)=>J.city!==ue.city?J.city.localeCompare(ue.city):J.label.localeCompare(ue.label),K=s.filter(U).sort(X),se=_.filter(U).sort(X);return ae.jsxs("div",{style:{width:300,margin:20,display:"grid",position:"relative",gridTemplateColumns:"100px auto",alignItems:"center"},children:[ae.jsx("h2",{children:"Start"}),ae.jsx(Mw,{options:K,onChange:(J,ue)=>ue&&z(ue),groupBy:J=>J.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,renderGroup:D4}),ae.jsx("h2",{children:"End"}),ae.jsx(Mw,{options:se,onChange:(J,ue)=>ue&&P(ue),groupBy:J=>J.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,disabled:M==null,renderGroup:D4},M)]})};function D4(t){return ae.jsxs(ae.Fragment,{children:[ae.jsx(Ci,{m:1,level:"body-xs",textTransform:"uppercase",children:t.group}),ae.jsx(RS,{children:t.children}),ae.jsx(tP,{})]})}function Y1e(t){const e=new Map,n=new Map;for(const[r,a]of t.demoGraph)e.set(BigInt(parseInt(r,36)),{forward:(a.f??[]).map(L4),backward:(a.b??[]).map(L4)});for(const[r,a]of t.demoNodes)n.set(BigInt(parseInt(r,36)),{x:a[0],y:a[1]});return{graph:e,nodeLUT:n}}function L4(t){return{nodeUid:BigInt(parseInt(t.n,36)),distance:t.l,duration:t.m,isOneLaneRoad:t.o,direction:t.d==="f"?"forward":"backward",dlcGuard:t.g}}function k4(t){return{label:t.t,city:t.c,value:t.n}}function z4(t,e,n,r){return new Promise(a=>{const l=G1e(BigInt(parseInt(t,36)),BigInt(parseInt(e,36)),"forward",n,r);if(!l.success){a(void 0);return}a({type:"Feature",geometry:{type:"LineString",coordinates:l.route.map(u=>{const s=pr(r.nodeLUT.get(u.nodeUid));return[s.x,s.y]})},properties:{distance:l.distance,mode:n}})})}const K1e=t=>{const{tileRootUrl:e,specialEvent:n}=t,{mode:r="light",systemMode:a="light"}=xS(),l=r==="system"?a:r,s=Q1e(localStorage.getItem("tm-map"))==="usa"?"":"",m=XS[l],_=_R[n],[b,M]=_.centerLngLat;return ae.jsxs(Bx,{style:{width:"100svw",height:"100svh"},minZoom:_.minZoom,maxZoom:15,mapStyle:_.mapStyle,attributionControl:!1,initialViewState:{longitude:b,latitude:M,zoom:_.minZoom+.5},maxBounds:[[b-_.boundsDelta,M-_.boundsDelta],[b+_.boundsDelta,M+_.boundsDelta]],children:[ae.jsx(Dr,{id:"background",type:"background",paint:{"background-color":Y6(m.land).darken(.2).toString()}}),ae.jsx(By,{tileRootUrl:e,game:"ats",specialEvent:n,mode:l,showSecrets:"showAsNormal",enableIconAutoHide:!1}),ae.jsx($I,{visualizePitch:!0}),ae.jsx(UI,{containerId:"fsElem"}),ae.jsx(iR,{}),ae.jsx(J1e,{emoji:s,onClick:()=>window.location.href="/"})]})},J1e=t=>{const e=q.useRef(null);return Il(()=>({onAdd:()=>pr(e.current),onRemove:()=>pr(e.current).remove()})),ae.jsx("div",{ref:e,style:{position:"absolute",top:0,right:44},children:ae.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:ae.jsx(bB,{component:"button",underline:"none",title:"Switch to ATS/ETS2 Map",justifyContent:"center",onClick:()=>window.location.href="/",sx:{fontSize:"1.75em"},children:ae.jsx(zS,{children:t.emoji})})})})};function Q1e(t){return t==="europe"?t:"usa"}var ebe=Object.defineProperty,tbe=(t,e)=>{for(var n in e)ebe(t,n,{get:e[n],enumerable:!0})},nbe={};tbe(nbe,{EnterMarkerEvent:()=>Cj,GotoMarkerDoneEvent:()=>PA,HideMarkersEvent:()=>$_,LeaveMarkerEvent:()=>Sj,MarkerVisibilityEvent:()=>yj,MarkersPluginEvent:()=>au,RenderMarkersListEvent:()=>Gj,SelectMarkerEvent:()=>Aj,SelectMarkerListEvent:()=>Dj,SetMarkersEvent:()=>Uj,ShowMarkersEvent:()=>V_,UnselectMarkerEvent:()=>zj});var au=class extends t1{},gj=class vj extends au{constructor(e,n){super(vj.type),this.marker=e,this.visible=n}};gj.type="marker-visibility";var yj=gj,_j=class xj extends au{constructor(e){super(xj.type),this.marker=e}};_j.type="goto-marker-done";var PA=_j,bj=class wj extends au{constructor(e){super(wj.type),this.marker=e}};bj.type="leave-marker";var Sj=bj,Mj=class Ej extends au{constructor(e){super(Ej.type),this.marker=e}};Mj.type="enter-marker";var Cj=Mj,Tj=class Pj extends au{constructor(e,n,r){super(Pj.type),this.marker=e,this.doubleClick=n,this.rightClick=r}};Tj.type="select-marker";var Aj=Tj,Ij=class Rj extends au{constructor(e){super(Rj.type),this.marker=e}};Ij.type="select-marker-list";var Dj=Ij,Lj=class kj extends au{constructor(e){super(kj.type),this.marker=e}};Lj.type="unselect-marker";var zj=Lj,Oj=class Fj extends au{constructor(){super(Fj.type)}};Oj.type="hide-markers";var $_=Oj,Nj=class Bj extends au{constructor(e){super(Bj.type),this.markers=e}};Nj.type="set-markers";var Uj=Nj,$j=class Vj extends au{constructor(){super(Vj.type)}};$j.type="show-markers";var V_=$j,jj=class Hj extends au{constructor(e){super(Hj.type),this.markers=e}};jj.type="render-markers-list";var Gj=jj,rbe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,dx=class extends qa{constructor(t){super(t,{className:"psv-markers-button",icon:rbe,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(V_.type,this),this.plugin.addEventListener($_.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(V_.type,this),this.plugin.removeEventListener($_.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof V_?this.toggleActive(!0):t instanceof $_&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};dx.id="markers";var Wj=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,rS="http://www.w3.org/2000/svg",co="psvMarker",ibe=nr.dasherize(co),e_="marker",iy="markersList",AA={amount:2,duration:100,easing:"linear"},obe=(t,e)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
    <h1 class="psv-panel-menu-title">${Wj} ${e}</h1>
    <ul class="psv-panel-menu-list">
    ${t.map(n=>`
        <li data-${ibe}="${n.id}" class="psv-panel-menu-item" tabindex="0">
          ${n.type==="image"?`<span class="psv-panel-menu-item-icon"><img src="${n.definition}"/></span>`:""}
          <span class="psv-panel-menu-item-label">${n.getListContent()}</span>
        </li>
    `).join("")}
    </ul>
</div>
`,g2=class extends qa{constructor(t){super(t,{className:" psv-markers-list-button",icon:Wj,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(ar.ShowPanelEvent.type,this),this.viewer.addEventListener(ar.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(ar.ShowPanelEvent.type,this),this.viewer.removeEventListener(ar.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof ar.ShowPanelEvent?this.toggleActive(t.panelId===iy):t instanceof ar.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};g2.id="markersList";var O4=new At,sbe=new pm,F4=new At,abe=class extends Qs{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&e.element.parentNode!==null&&e.element.remove()})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this}},Gh=new ki,lbe=new ki,cbe=class{constructor(t={}){const e=this;let n,r,a,l;const u={camera:{style:""},objects:new WeakMap},s=t.element!==void 0?t.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s;const m=document.createElement("div");m.style.transformOrigin="0 0",m.style.pointerEvents="none",s.appendChild(m);const _=document.createElement("div");_.style.transformStyle="preserve-3d",m.appendChild(_),this.getSize=function(){return{width:n,height:r}},this.render=function(z,P){const O=P.projectionMatrix.elements[5]*l;P.view&&P.view.enabled?(m.style.transform=`translate( ${-P.view.offsetX*(n/P.view.width)}px, ${-P.view.offsetY*(r/P.view.height)}px )`,m.style.transform+=`scale( ${P.view.fullWidth/P.view.width}, ${P.view.fullHeight/P.view.height} )`):m.style.transform="",z.matrixWorldAutoUpdate===!0&&z.updateMatrixWorld(),P.parent===null&&P.matrixWorldAutoUpdate===!0&&P.updateMatrixWorld();let j,U;P.isOrthographicCamera&&(j=-(P.right+P.left)/2,U=(P.top+P.bottom)/2);const X=P.view&&P.view.enabled?P.view.height/P.view.fullHeight:1,K=P.isOrthographicCamera?`scale( ${X} )scale(`+O+")translate("+b(j)+"px,"+b(U)+"px)"+M(P.matrixWorldInverse):`scale( ${X} )translateZ(`+O+"px)"+M(P.matrixWorldInverse),J=(P.isPerspectiveCamera?"perspective("+O+"px) ":"")+K+"translate("+a+"px,"+l+"px)";u.camera.style!==J&&(_.style.transform=J,u.camera.style=J),k(z,z,P)},this.setSize=function(z,P){n=z,r=P,a=n/2,l=r/2,s.style.width=z+"px",s.style.height=P+"px",m.style.width=z+"px",m.style.height=P+"px",_.style.width=z+"px",_.style.height=P+"px"};function b(z){return Math.abs(z)<1e-10?0:z}function M(z){const P=z.elements;return"matrix3d("+b(P[0])+","+b(-P[1])+","+b(P[2])+","+b(P[3])+","+b(P[4])+","+b(-P[5])+","+b(P[6])+","+b(P[7])+","+b(P[8])+","+b(-P[9])+","+b(P[10])+","+b(P[11])+","+b(P[12])+","+b(-P[13])+","+b(P[14])+","+b(P[15])+")"}function C(z){const P=z.elements;return"translate(-50%,-50%)"+("matrix3d("+b(P[0])+","+b(P[1])+","+b(P[2])+","+b(P[3])+","+b(-P[4])+","+b(-P[5])+","+b(-P[6])+","+b(-P[7])+","+b(P[8])+","+b(P[9])+","+b(P[10])+","+b(P[11])+","+b(P[12])+","+b(P[13])+","+b(P[14])+","+b(P[15])+")")}function A(z){z.isCSS3DObject&&(z.element.style.display="none");for(let P=0,O=z.children.length;P<O;P++)A(z.children[P])}function k(z,P,O,j){if(z.visible===!1){A(z);return}if(z.isCSS3DObject){const U=z.layers.test(O.layers)===!0,X=z.element;if(X.style.display=U===!0?"":"none",U===!0){z.onBeforeRender(e,P,O);let K;z.isCSS3DSprite?(Gh.copy(O.matrixWorldInverse),Gh.transpose(),z.rotation2D!==0&&Gh.multiply(lbe.makeRotationZ(z.rotation2D)),z.matrixWorld.decompose(O4,sbe,F4),Gh.setPosition(O4),Gh.scale(F4),Gh.elements[3]=0,Gh.elements[7]=0,Gh.elements[11]=0,Gh.elements[15]=1,K=C(Gh)):K=C(z.matrixWorld);const se=u.objects.get(z);if(se===void 0||se.style!==K){X.style.transform=K;const J={style:K};u.objects.set(z,J)}X.parentNode!==_&&_.appendChild(X),z.onAfterRender(e,P,O)}}for(let U=0,X=z.children.length;U<X;U++)k(z.children[U],P,O)}}},ube=class{constructor(t){this.viewer=t,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new cbe({element:this.element}),this.scene=new Hw,this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(n=>{const r=n.target[co];r.config.visible&&(r.viewportIntersection=n.isIntersecting)})},{root:this.element}),t.addEventListener(ar.ReadyEvent.type,this,{once:!0}),t.addEventListener(ar.SizeUpdatedEvent.type,this),t.addEventListener(ar.RenderEvent.type,this)}handleEvent(t){switch(t.type){case ar.ReadyEvent.type:case ar.SizeUpdatedEvent.type:this.updateSize();break;case ar.RenderEvent.type:this.render();break}}destroy(){this.viewer.removeEventListener(ar.ReadyEvent.type,this),this.viewer.removeEventListener(ar.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(ar.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const t=this.viewer.getSize();this.renderer.setSize(t.width,t.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(t){this.scene.add(t.threeElement),this.intersectionObserver.observe(t.domElement)}removeObject(t){this.scene.remove(t.threeElement),this.intersectionObserver.unobserve(t.domElement)}},pw=(t=>(t.image="image",t.html="html",t.element="element",t.imageLayer="imageLayer",t.videoLayer="videoLayer",t.elementLayer="elementLayer",t.polygon="polygon",t.polygonPixels="polygonPixels",t.polyline="polyline",t.polylinePixels="polylinePixels",t.square="square",t.rect="rect",t.circle="circle",t.ellipse="ellipse",t.path="path",t))(pw||{});function IA(t,e=!1){const n=[];if(Object.keys(pw).forEach(r=>{t[r]&&n.push(r)}),n.length===0&&!e)throw new qn(`missing marker content, either ${Object.keys(pw).join(", ")}`);if(n.length>1)throw new qn(`multiple marker content, either ${Object.keys(pw).join(", ")}`);return n[0]}var qj=class{constructor(t,e,n){if(this.viewer=t,this.plugin=e,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!n.id)throw new qn("missing marker id");this.type=IA(n),this.createElement(),this.update(n)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(t){const e=IA(t,!0);if(e!==void 0&&e!==this.type)throw new qn(`cannot change marker ${t.id} type`);if(this.config=nr.deepmerge(this.config,t),typeof this.config.tooltip=="string"&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),nr.isNil(this.config.visible)&&(this.config.visible=!0),nr.isNil(this.config.zIndex)&&(this.config.zIndex=1),nr.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const n=this.config.rotation;typeof n=="object"?this.config.rotation={yaw:n.yaw?nr.parseAngle(n.yaw,!0,!1):0,pitch:n.pitch?nr.parseAngle(n.pitch,!0,!1):0,roll:n.roll?nr.parseAngle(n.roll,!0,!1):0}:this.config.rotation={yaw:0,pitch:0,roll:nr.parseAngle(n,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=nr.parsePoint(this.config.anchor)}getListContent(){return this.config.listContent?this.config.listContent:this.config.tooltip?.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(t,e,n=!1){if(this.state.visible&&this.config.tooltip?.content&&this.state.position2D){const r={...this.config.tooltip,style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0};if(this.isPoly()||this.is3d()||this.isCss3d())if(t||e){const a=nr.getPosition(this.viewer.container);r.top=e-a.y+10,r.left=t-a.x,r.box={width:20,height:20}}else r.top=this.state.position2D.y,r.left=this.state.position2D.x;else{const a=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let l=this.state.size.width,u=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(l*=this.config.hoverScale.amount,u*=this.config.hoverScale.amount),r.top=a.y-u*this.state.anchor.y+u/2,r.left=a.x-l*this.state.anchor.x+l/2,r.box={width:l,height:u}}this.tooltip?n?this.tooltip.update(this.config.tooltip.content,r):this.tooltip.move(r):this.tooltip=this.viewer.createTooltip(r)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},KR=class extends qj{get domElement(){return this.element}constructor(t,e,n){super(t,e,n)}afterCreateElement(){this.element[co]=this}destroy(){delete this.element[co],super.destroy()}update(t){super.update(t);const e=this.domElement;e.id=`psv-marker-${this.config.id}`,e.setAttribute("class","psv-marker"),this.state.visible&&e.classList.add("psv-marker--visible"),this.config.tooltip&&e.classList.add("psv-marker--has-tooltip"),this.config.content&&e.classList.add("psv-marker--has-content"),this.config.className&&nr.addClasses(e,this.config.className),e.style.opacity=`${this.config.opacity}`,e.style.zIndex=`${30+this.config.zIndex}`,this.config.style&&Object.assign(e.style,this.config.style)}},iS=class extends KR{constructor(t,e,n){super(t,e,n)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",()=>{this.domElement.style.transition=""})}render({viewerPosition:t,zoomLevel:e,hoveringMarker:n}){this.__updateSize();const r=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);return r.x-=this.state.size.width*this.state.anchor.x,r.y-=this.state.size.height*this.state.anchor.y,this.state.positions3D[0].dot(this.viewer.state.direction)>0&&r.x+this.state.size.width>=0&&r.x-this.state.size.width<=this.viewer.state.size.width&&r.y+this.state.size.height>=0&&r.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate=`${r.x}px ${r.y}px 0px`,this.applyScale({zoomLevel:e,viewerPosition:t,mouseover:this===n}),r):null}update(t){if(super.update(t),!nr.isExtendedPosition(this.config.position))throw new qn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(n){throw new qn(`invalid marker ${this.id} position`,n)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.domElement;e.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),typeof this.config.hoverScale=="boolean"?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||AA:null:typeof this.config.hoverScale=="number"?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale={...this.plugin.config.defaultHoverScale,...this.config.hoverScale}),e.style.rotate=this.config.rotation.roll!==0?jr.radToDeg(this.config.rotation.roll)+"deg":null,e.style.transformOrigin=`${this.state.anchor.x*100}% ${this.state.anchor.y*100}%`}__updateSize(){if(!this.needsUpdateSize)return;const t=this.domElement,e=!this.state.visible||!this.state.size;if(e&&t.classList.add("psv-marker--transparent"),this.isSvg()){const n=t.firstElementChild.getBoundingClientRect();this.state.size={width:n.width,height:n.height}}else this.state.size={width:t.offsetWidth,height:t.offsetHeight};e&&t.classList.remove("psv-marker--transparent"),this.isSvg()&&(t.style.width=this.state.size.width+"px",t.style.height=this.state.size.height+"px"),this.type!=="element"&&(this.needsUpdateSize=!1)}applyScale({zoomLevel:t,viewerPosition:e,mouseover:n}){n!==null&&this.config.hoverScale&&(this.domElement.style.transition=`scale ${this.config.hoverScale.duration}ms ${this.config.hoverScale.easing}`);let r=1;if(typeof this.config.scale=="function")r=this.config.scale(t,e);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[a,l]=this.config.scale.zoom;r*=a+(l-a)*Wy.EASINGS.inQuad(t/100)}if(Array.isArray(this.config.scale.yaw)){const[a,l]=this.config.scale.yaw,u=jr.degToRad(this.viewer.state.hFov)/2,s=Math.abs(nr.getShortestArc(this.state.position.yaw,e.yaw));r*=l+(a-l)*Wy.EASINGS.outQuad(Math.max(0,(u-s)/u))}}n&&this.config.hoverScale&&(r*=this.config.hoverScale.amount),this.domElement.style.scale=`${r}`}},hbe=`// https://www.8thwall.com/playground/chromakey-threejs

uniform sampler2D map;
uniform float alpha;
uniform bool keying;
uniform vec3 color;
uniform float similarity;
uniform float smoothness;
uniform float spill;

varying vec2 vUv;

vec2 RGBtoUV(vec3 rgb) {
    return vec2(
        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,
        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5
    );
}

void main(void) {
    gl_FragColor = texture2D(map, vUv);

    if (keying) {
        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));

        float baseMask = chromaDist - similarity;
        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);
        gl_FragColor.a *= fullMask * alpha;

        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);
        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);
        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);
    } else {
        gl_FragColor.a *= alpha;
    }
}
`,dbe=`varying vec2 vUv;
uniform vec2 repeat;
uniform vec2 offset;

void main() {
    vUv = uv * repeat + offset;
    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );
}
`,fbe=class extends yf{get map(){return this.uniforms.map.value}set map(t){this.uniforms.map.value=t}set alpha(t){this.uniforms.alpha.value=t}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(t){this.uniforms.keying.value=t?.enabled===!0,t?.enabled&&(typeof t.color=="object"&&"r"in t.color?this.uniforms.color.value.set(t.color.r/255,t.color.g/255,t.color.b/255):this.uniforms.color.value.set(t.color??65280),this.uniforms.similarity.value=t.similarity??.2,this.uniforms.smoothness.value=t.smoothness??.2)}constructor(t){super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:t?.map},repeat:{value:new mi(1,1)},offset:{value:new mi(0,0)},alpha:{value:t?.alpha??1},keying:{value:!1},color:{value:new Ti(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:dbe,fragmentShader:hbe}),this.chromaKey=t?.chromaKey}};function pbe({src:t,withCredentials:e,muted:n,autoplay:r}){const a=document.createElement("video");return a.crossOrigin=e?"use-credentials":"anonymous",a.loop=!0,a.playsInline=!0,a.autoplay=r,a.muted=n,a.preload="metadata",t instanceof MediaStream?a.srcObject=t:a.src=t,a}function mbe(t,e,n){const[r,a]=t,[l,u]=e,s=nr.greatArcDistance(t,e),m=Math.sin((1-n)*s)/Math.sin(s),_=Math.sin(n*s)/Math.sin(s),b=m*Math.cos(a)*Math.cos(r)+_*Math.cos(u)*Math.cos(l),M=m*Math.cos(a)*Math.sin(r)+_*Math.cos(u)*Math.sin(l),C=m*Math.sin(a)+_*Math.sin(u);return[Math.atan2(M,b),Math.atan2(C,Math.sqrt(b*b+M*M))]}function gbe(t){const e=[t[0]];let n=0;for(let r=1;r<t.length;r++){const a=t[r-1][0]-t[r][0];a>Math.PI?n+=1:a<-Math.PI&&(n-=1),e.push([t[r][0]+n*2*Math.PI,t[r][1]])}return e}function Xj(t){return t.reduce((e,n)=>e.add(n),new At).normalize()}function vbe(t){const e=gbe(t);let n=0;const r=[];for(let l=0;l<e.length-1;l++){const u=nr.greatArcDistance(e[l],e[l+1])*Wy.SPHERE_RADIUS;r.push(u),n+=u}let a=0;for(let l=0;l<e.length-1;l++){if(a+r[l]>n/2){const u=(n/2-a)/r[l];return mbe(e[l],e[l+1],u)}a+=r[l]}return e[Math.round(e.length/2)]}var Bb=new At,N4=new At,HT=new At,B4=new At,U4=new At,$4=new At;function ybe(t,e,n){Bb.copy(n).normalize(),N4.crossVectors(t,e).normalize(),HT.crossVectors(N4,t).normalize(),B4.copy(t).multiplyScalar(-Bb.dot(HT)),U4.copy(HT).multiplyScalar(Bb.dot(t));const r=new At().addVectors(B4,U4).normalize();return $4.crossVectors(r,Bb),r.applyAxisAngle($4,.01).multiplyScalar(Wy.SPHERE_RADIUS)}var _be=class extends qj{get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return this.type==="videoLayer"?this.threeMesh.material.map.image:null}constructor(t,e,n){super(t,e,n)}is3d(){return!0}createElement(){const t=new fbe({alpha:0}),e=new Qx(1,1),n=new wl(e,t);n.userData={[co]:this},Object.defineProperty(n,"visible",{enumerable:!0,get:function(){return this.userData[co].config.visible},set:function(r){this.userData[co].config.visible=r}}),this.element=new jp().add(n),this.type==="videoLayer"&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[co],this.type==="videoLayer"&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(t){super.update(t);const e=this.threeMesh,n=e.parent,r=e.material;if(nr.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(l){throw new qn(`invalid marker ${this.id} position`,l)}if(!this.config.size)throw new qn(`missing marker ${this.id} size`);this.state.size=this.config.size,e.scale.set(this.config.size.width/100,this.config.size.height/100,1),e.position.set(e.scale.x*(.5-this.state.anchor.x),e.scale.y*(this.state.anchor.y-.5),0),e.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,n.position),n.lookAt(0,n.position.y,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll);const a=e.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map(l=>{const u=new At;return u.fromBufferAttribute(a,l),e.localToWorld(u)})}else{if(this.config.position?.length!==4)throw new qn(`missing marker ${this.id} position`);let a;try{a=this.config.position.map(m=>this.viewer.dataHelper.cleanPosition(m))}catch(m){throw new qn(`invalid marker ${this.id} position`,m)}const l=a.map(m=>this.viewer.dataHelper.sphericalCoordsToVector3(m)),u=Xj(l);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(u),this.state.positions3D=l;const s=e.geometry.getAttribute("position");[l[0],l[1],l[3],l[2]].forEach((m,_)=>{s.setX(_,m.x),s.setY(_,m.y),s.setZ(_,m.z)}),s.needsUpdate=!0,this.__setTextureWrap(r)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){r.map?.dispose();const a=pbe({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials(this.config.videoLayer),muted:!0,autoplay:this.config.autoplay??!0}),l=new Xme(a);r.map=l,r.alpha=0,a.addEventListener("loadedmetadata",()=>{this.viewer&&(r.alpha=this.config.opacity,nr.isExtendedPosition(this.config.position)||(e.material.userData[co]={width:a.videoWidth,height:a.videoHeight},this.__setTextureWrap(r)))},{once:!0}),a.autoplay&&a.play(),this.definition=this.config.videoLayer}else r.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){r.map?.dispose();const a=new Js;r.map=a,r.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then(l=>{this.viewer&&(nr.isExtendedPosition(this.config.position)||(e.material.userData[co]={width:l.width,height:l.height},this.__setTextureWrap(r)),a.image=l,a.anisotropy=4,a.needsUpdate=!0,r.alpha=this.config.opacity,this.viewer.needsUpdate())}),this.definition=this.config.imageLayer}else r.alpha=this.config.opacity;break}r.chromaKey=this.config.chromaKey,e.renderOrder=1e3+this.config.zIndex,e.geometry.boundingBox=null}__setTextureWrap(t){const e=t.userData[co];if(!e||!e.height||!e.width){t.repeat.set(1,1),t.offset.set(0,0);return}const n=this.config.position.map(M=>this.viewer.dataHelper.cleanPosition(M)),r=nr.greatArcDistance([n[0].yaw,n[0].pitch],[n[1].yaw,n[1].pitch]),a=nr.greatArcDistance([n[3].yaw,n[3].pitch],[n[2].yaw,n[2].pitch]),l=nr.greatArcDistance([n[1].yaw,n[1].pitch],[n[2].yaw,n[2].pitch]),u=nr.greatArcDistance([n[0].yaw,n[0].pitch],[n[3].yaw,n[3].pitch]),s=(r+a)/(l+u),m=e.width/e.height;let _=0,b=0;s<m?_=m-s:b=1/m-1/s,t.repeat.set(1-_,1-b),t.offset.set(_/2,b/2)}},xbe=class extends KR{constructor(t,e,n){super(t,e,n),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new abe(this.element),this.object.userData={[co]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[co].config.visible},set:function(t){this.userData[co].config.visible=t}}),this.afterCreateElement()}destroy(){delete this.object.userData[co],delete this.object,super.destroy()}render({viewerPosition:t,zoomLevel:e}){const n=this.domElement;if(this.state.size={width:n.offsetWidth,height:n.offsetHeight},this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){const a=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return this.config.elementLayer.updateMarker?.({marker:this,position:a,viewerPosition:t,zoomLevel:e,viewerSize:this.viewer.state.size}),a}else return null}update(t){if(super.update(t),!nr.isExtendedPosition(this.config.position))throw new qn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(r){throw new qn(`invalid marker ${this.id} position`,r)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.threeElement,n=this.domElement;n.classList.add("psv-marker--css3d"),n.childNodes.forEach(r=>r.remove()),n.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",e.position.copy(this.state.positions3D[0]).multiplyScalar(100),e.lookAt(0,this.state.positions3D[0].y*100,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll)}},bbe=class extends iS{constructor(t,e,n){super(t,e,n)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(t){const e=super.render(t);return e&&this.type==="element"&&this.config.element.updateMarker?.({marker:this,position:e,viewerPosition:t.viewerPosition,zoomLevel:t.zoomLevel,viewerSize:this.viewer.state.size}),e}update(t){super.update(t);const e=this.domElement;if(this.config.image&&!this.config.size)throw new qn(`missing marker ${this.id} size`);switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,e.style.width=this.config.size.width+"px",e.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,e.style.backgroundImage=`url("${this.config.image}")`;break;case"html":this.definition=this.config.html,e.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,e.childNodes.forEach(n=>n.remove()),e.appendChild(this.config.element),this.config.element.style.display="block");break}}},wbe=class extends KR{constructor(t,e,n){super(t,e,n)}createElement(){this.element=document.createElementNS(rS,"path"),this.element[co]=this}isPoly(){return!0}get isPixels(){return this.type==="polygonPixels"||this.type==="polylinePixels"}get isPolygon(){return this.type==="polygon"||this.type==="polygonPixels"}get isPolyline(){return this.type==="polyline"||this.type==="polylinePixels"}get coords(){return this.definition}render(){const t=this.__getAllPolyPositions();if(t[0].length>(this.isPolygon?2:1)){const n=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),r=t.filter(a=>a.length>0).map(a=>{let l="M";return l+=a.map(u=>`${u.x-n.x},${u.y-n.y}`).join("L"),this.isPolygon&&(l+="Z"),l}).join(" ");return this.domElement.setAttributeNS(null,"d",r),this.domElement.setAttributeNS(null,"transform",`translate(${n.x} ${n.y})`),n}else return null}update(t){super.update(t);const e=this.domElement;e.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(([n,r])=>{e.setAttributeNS(null,nr.dasherize(n),r)}),this.isPolyline&&!this.config.svgStyle.fill&&e.setAttributeNS(null,"fill","none")):this.isPolygon?e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let n=this.config[this.type];if(!Array.isArray(n[0])&&typeof n[0]!="object")for(let r=0;r<n.length;r++)n.splice(r,2,[n[r],n[r+1]]);if(!Array.isArray(n[0][0])&&typeof n[0][0]!="object"&&(n=[n]),this.isPolyline&&n.length>1)throw new qn("polylines cannot have holes");this.isPixels?this.definition=n.map(r=>r.map(a=>{let l;return nr.isExtendedPosition(a)?l=this.viewer.dataHelper.cleanPosition(a):l=this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:a[0],textureY:a[1]}),[l.yaw,l.pitch]})):this.definition=n.map(r=>r.map(a=>{let l;return nr.isExtendedPosition(a)?l=this.viewer.dataHelper.cleanPosition(a):l=this.viewer.dataHelper.cleanPosition({yaw:a[0],pitch:a[1]}),[l.yaw,l.pitch]}))}catch(n){throw new qn(`invalid marker ${this.id} position`,n)}if(this.positions3D=this.coords.map(n=>n.map(r=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:r[0],pitch:r[1]}))),this.isPolygon){const n=Xj(this.positions3D[0]);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(n)}else{const n=vbe(this.coords[0]);this.state.position={yaw:n[0],pitch:n[1]}}this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map(t=>this.__getPolyPositions(t))}__getPolyPositions(t){const e=t.length,n=t.map(a=>({vector:a,visible:a.dot(this.viewer.state.direction)>0})),r=[];return n.forEach((a,l)=>{a.visible||[l===0?n[e-1]:n[l-1],l===e-1?n[0]:n[l+1]].forEach(s=>{s.visible&&r.push({visible:s.vector,invisible:a.vector,index:l})})}),r.reverse().forEach(a=>{n.splice(a.index,0,{vector:ybe(a.visible,a.invisible,this.viewer.state.direction),visible:!0})}),n.filter(a=>a.visible).map(a=>this.viewer.dataHelper.vector3ToViewerCoords(a.vector))}},Sbe=class extends iS{get svgElement(){return this.domElement.firstElementChild}constructor(t,e,n){super(t,e,n)}isSvg(){return!0}createElement(){const t=this.type==="square"?"rect":this.type,e=document.createElementNS(rS,t);this.element=document.createElementNS(rS,"svg"),this.element.appendChild(e),this.afterCreateElement()}update(t){super.update(t);const e=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path};break}Object.entries(this.definition).forEach(([n,r])=>{e.setAttributeNS(null,n,r)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(([n,r])=>{e.setAttributeNS(null,nr.dasherize(n),r)}):e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},Mbe=nr.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale(t){return t?(t===!0&&(t=AA),typeof t=="number"&&(t={amount:t}),{...AA,...t}):null}});function Ebe(t){switch(IA(t,!1)){case"image":case"html":case"element":return bbe;case"imageLayer":case"videoLayer":return _be;case"elementLayer":return xbe;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return wbe;case"square":case"rect":case"circle":case"ellipse":case"path":return Sbe;default:throw new qn("invalid marker type")}}var o1=class Zj extends GR{constructor(e,n){super(e,n),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",r=>r.preventDefault()),this.svgContainer=document.createElementNS(rS,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new ube(e),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}static withConfig(e){return[Zj,e]}init(){super.init(),nr.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(ar.ClickEvent.type,this),this.viewer.addEventListener(ar.DoubleClickEvent.type,this),this.viewer.addEventListener(ar.RenderEvent.type,this),this.viewer.addEventListener(ar.ConfigChangedEvent.type,this),this.viewer.addEventListener(ar.ObjectEnterEvent.type,this),this.viewer.addEventListener(ar.ObjectHoverEvent.type,this),this.viewer.addEventListener(ar.ObjectLeaveEvent.type,this),this.viewer.addEventListener(ar.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(co),this.viewer.removeEventListener(ar.ClickEvent.type,this),this.viewer.removeEventListener(ar.DoubleClickEvent.type,this),this.viewer.removeEventListener(ar.RenderEvent.type,this),this.viewer.removeEventListener(ar.ObjectEnterEvent.type,this),this.viewer.removeEventListener(ar.ObjectHoverEvent.type,this),this.viewer.removeEventListener(ar.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(ar.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(e){switch(e.type){case ar.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case ar.RenderEvent.type:this.renderMarkers();break;case ar.ClickEvent.type:this.__onClick(e,!1);break;case ar.DoubleClickEvent.type:this.__onClick(e,!0);break;case ar.ObjectEnterEvent.type:case ar.ObjectLeaveEvent.type:case ar.ObjectHoverEvent.type:if(e.userDataKey===co){const n=e.originalEvent,r=e.object.userData[co];switch(e.type){case ar.ObjectEnterEvent.type:r.config.style?.cursor?this.viewer.setCursor(r.config.style.cursor):(r.config.tooltip||r.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(n,r);break;case ar.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(r);break;case ar.ObjectHoverEvent.type:this.__onHoverMarker(n,r);break}}break;case"mouseenter":{const n=this.__getTargetMarker(nr.getEventTarget(e));this.__onEnterMarker(e,n);break}case"mouseleave":{const n=this.__getTargetMarker(nr.getEventTarget(e));this.__onLeaveMarker(n);break}case"mousemove":{const n=this.__getTargetMarker(nr.getEventTarget(e),!0);this.__onHoverMarker(e,n);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach(e=>{e.config.visible=!0}),this.renderMarkers(),this.dispatchEvent(new V_)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach(e=>{e.config.visible=!1}),this.renderMarkers(),this.dispatchEvent(new $_)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!0,e.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!1,e.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(e,n=!0){if(this.markers[e.id])throw new qn(`marker "${e.id}" already exists`);const r=new(Ebe(e))(this.viewer,this,e);r.isPoly()?this.svgContainer.appendChild(r.domElement):r.isCss3d()?this.css3DContainer.addObject(r):r.is3d()?this.viewer.renderer.addObject(r.threeElement):this.container.appendChild(r.domElement),this.markers[r.id]=r,this.state.showAllTooltips&&(r.state.staticTooltip=!0),n&&this.__afterChangeMarkers()}getMarker(e){const n=typeof e=="object"?e.id:e;if(!this.markers[n])throw new qn(`cannot find marker "${n}"`);return this.markers[n]}getCurrentMarker(){return this.state.currentMarker}updateMarker(e,n=!0){const r=this.getMarker(e.id);r.update(e),n&&(this.__afterChangeMarkers(),(r===this.state.hoveringMarker&&r.config.tooltip?.trigger==="hover"||r.state.staticTooltip)&&r.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(e,n=!0){const r=this.getMarker(e);r.isPoly()?this.svgContainer.removeChild(r.domElement):r.isCss3d()?this.css3DContainer.removeObject(r):r.is3d()?this.viewer.renderer.removeObject(r.threeElement):this.container.removeChild(r.domElement),this.state.hoveringMarker===r&&(this.state.hoveringMarker=null),this.state.currentMarker===r&&(this.state.currentMarker=null),r.destroy(),delete this.markers[r.id],n&&this.__afterChangeMarkers()}removeMarkers(e,n=!0){e.forEach(r=>this.removeMarker(r,!1)),n&&this.__afterChangeMarkers()}setMarkers(e,n=!0){this.clearMarkers(!1),e?.forEach(r=>{this.addMarker(r,!1)}),n&&this.__afterChangeMarkers()}clearMarkers(e=!0){Object.keys(this.markers).forEach(n=>{this.removeMarker(n,!1)}),e&&this.__afterChangeMarkers()}gotoMarker(e,n=this.config.gotoMarkerSpeed){const r=this.getMarker(e);return n?this.viewer.animate({...r.state.position,zoom:r.config.zoomLvl,speed:n}).then(()=>{this.dispatchEvent(new PA(r))}):(this.viewer.rotate(r.state.position),nr.isNil(r.config.zoomLvl)||this.viewer.zoom(r.config.zoomLvl),this.dispatchEvent(new PA(r)),Promise.resolve())}hideMarker(e){this.toggleMarker(e,!1)}showMarker(e){this.toggleMarker(e,!0)}showMarkerTooltip(e){const n=this.getMarker(e);n.state.staticTooltip=!0,n.showTooltip()}hideMarkerTooltip(e){const n=this.getMarker(e);n.state.staticTooltip=!1,n.hideTooltip()}toggleMarker(e,n){const r=this.getMarker(e);r.config.visible=nr.isNil(n)?!r.config.visible:n,this.renderMarkers()}showMarkerPanel(e){const n=this.getMarker(e);n.config.content?this.viewer.panel.show({id:e_,content:n.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(e_)}toggleMarkersList(){this.viewer.panel.isVisible(iy)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let e=[];Object.values(this.markers).forEach(r=>{r.config.visible&&!r.config.hideList&&e.push(r)});const n=new Gj(e);this.dispatchEvent(n),e=n.markers,this.viewer.panel.show({id:iy,content:obe(e,this.viewer.config.lang[dx.id]),noMargin:!0,clickHandler:r=>{const a=nr.getClosest(r,".psv-panel-menu-item"),l=a?a.dataset[co]:void 0;if(l){const u=this.getMarker(l);this.dispatchEvent(new Dj(u)),this.gotoMarker(u.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(iy)}renderMarkers(){if(this.state.needsReRender){this.state.needsReRender=!1;return}const e=this.viewer.getZoomLevel(),n=this.viewer.getPosition(),r=this.state.hoveringMarker;Object.values(this.markers).forEach(a=>{let l=a.config.visible,u=!1,s=null;l&&(s=a.render({viewerPosition:n,zoomLevel:e,hoveringMarker:r}),l=!!s),u=a.state.visible!==l,a.state.visible=l,a.state.position2D=s,a.domElement&&nr.toggleClass(a.domElement,"psv-marker--visible",l),l?a.state.staticTooltip?a.showTooltip():a!==this.state.hoveringMarker&&a.hideTooltip():a.hideTooltip(),u&&(this.dispatchEvent(new yj(a,l)),(a.is3d()||a.isCss3d())&&(this.state.needsReRender=!0))}),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(e,n=!1){if(e instanceof Node){const r=n?nr.getClosest(e,".psv-marker"):e;return r?r[co]:void 0}else return Array.isArray(e)?e.map(r=>r.userData[co]).filter(r=>!!r).sort((r,a)=>a.config.zIndex-r.config.zIndex)[0]:null}__onEnterMarker(e,n){n&&(this.state.hoveringMarker=n,this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,this.dispatchEvent(new Cj(n)),n instanceof iS&&n.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),!n.state.staticTooltip&&n.config.tooltip?.trigger==="hover"&&n.showTooltip(e.clientX,e.clientY))}__onLeaveMarker(e){e&&(this.dispatchEvent(new Sj(e)),e instanceof iS&&e.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,!e.state.staticTooltip&&e.config.tooltip?.trigger==="hover"?e.hideTooltip():e.state.staticTooltip&&e.showTooltip())}__onHoverMarker(e,n){n&&(this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,(n.isPoly()||n.is3d()||n.isCss3d())&&n.config.tooltip?.trigger==="hover"&&n.showTooltip(e.clientX,e.clientY))}__onClick(e,n){const r=this.__getTargetMarker(e.data.objects),l=this.__getTargetMarker(e.data.target,!0)||r;this.state.currentMarker&&this.state.currentMarker!==l&&(this.dispatchEvent(new zj(this.state.currentMarker)),this.viewer.panel.hide(e_),!this.state.showAllTooltips&&this.state.currentMarker.config.tooltip?.trigger==="click"&&this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null),l&&(this.state.currentMarker=l,this.dispatchEvent(new Aj(l,n,e.data.rightclick)),this.config.clickEventOnMarker?e.data.marker=l:e.stopImmediatePropagation(),this.markers[l.id]&&!e.data.rightclick&&(l.config.tooltip?.trigger==="click"?l.tooltip?this.hideMarkerTooltip(l.id):this.showMarkerTooltip(l.id):this.showMarkerPanel(l.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new Uj(this.getMarkers()))}__refreshUi(){const e=Object.values(this.markers).filter(n=>!n.config.hideList).length;e===0?(this.viewer.panel.hide(e_),this.viewer.panel.hide(iy)):this.viewer.panel.isVisible(iy)?this.showMarkersList():this.viewer.panel.isVisible(e_)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),this.viewer.navbar.getButton(dx.id,!1)?.toggle(e>0),this.viewer.navbar.getButton(g2.id,!1)?.toggle(e>0)}__checkObjectsObserver(){Object.values(this.markers).some(n=>n.is3d())?this.viewer.observeObjects(co):this.viewer.unobserveObjects(co)}};o1.id="markers";o1.VERSION="5.13.4";o1.configParser=Mbe;o1.readonlyOptions=["markers"];var Cbe=o1;_f.lang[dx.id]="Markers";_f.lang[g2.id]="Markers list";WR(dx,"caption:left");WR(g2,"caption:left");const vg=[{id:"0",point:[-92.12572989672026,38.53421432713342]},{id:"1",point:[-92.12304341293509,38.53672723512331]},{id:"2",point:[-92.11945284530871,38.54133496582979]},{id:"3",point:[-92.11576785749503,38.54478606247235]},{id:"4",point:[-92.10778464530942,38.544770729312454]},{id:"5",point:[-92.10258732764407,38.541357585467786]},{id:"6",point:[-92.09670854574377,38.53854148846571]},{id:"7",point:[-92.09328790813723,38.53629576427041]},{id:"8",point:[-92.11176575050796,38.5479069429093]}],Tbe={id:"marker-viewpoint",image:"map-icons/viewpoint.png",gps:[-92.102043,38.54042],size:{width:32,height:32}},Pbe={id:"marker-photo-trophy",image:"map-icons/photo_sight_captured.png",gps:[-92.157874,38.578638],size:{width:32,height:32}},t_=[Tbe,Pbe],Abe=t=>e=>({width:8192,cols:16,rows:8,baseUrl:`${t}/${e}_thumb.jpg`,tileUrl:(n,r)=>`${t}/${e}_${n}_${r}.jpg`}),Ibe=t=>{const e=a=>({id:`node-${a}`,panorama:t(a),gps:vg[a].point}),n=(...a)=>a.map(l=>({nodeId:`node-${l}`}));return{positionMode:"gps",nodes:[{...e(0),links:n(1)},{...e(1),links:n(0,2)},{...e(2),links:n(1,3)},{...e(3),links:n(2,8)},{...e(4),links:n(8,5),markers:t_},{...e(5),links:n(4,6),markers:t_},{...e(6),links:n(5,7),markers:t_},{...e(7),links:n(6),markers:t_},{...e(8),links:n(3,4),markers:t_}]}},Rbe=t=>{const e=q.useRef(null),n=q.useRef(null),r=q.useRef(null),a=Abe(t.pixelRootUrl),l=Ibe(a),u=(_,b)=>pr(r.current).setRotation(b/Math.PI*180),s=({node:_})=>{const[b,M]=pr(_.gps),C=[b,M];pr(e.current).panTo(C),pr(r.current).setLngLat(C)},m=()=>{const _=pr(n.current);pr(_.getPlugin(U_)).addEventListener("node-changed",s)};return q.useEffect(()=>{document.title="ATS Street View Proof of Concept"}),ae.jsxs(ae.Fragment,{children:[ae.jsx(ZR,{ref:n,adapter:ej,plugins:[U_.withConfig(l),Cbe],src:a(0),height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:u,onReady:m}),ae.jsx("div",{className:"credits",children:"Game data and images  SCS Software. Images captured by Trucker Mudgeon."}),ae.jsxs(Bx,{ref:e,style:{position:"absolute",left:20,bottom:20,width:"250px",height:"125px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:4,maxZoom:15,maxBounds:[vg[0].point.map(_=>_-1),vg[0].point.map(_=>_+1)],mapStyle:JS,attributionControl:!1,initialViewState:{longitude:vg[0].point[0],latitude:vg[0].point[1],zoom:12},children:[ae.jsx(BI,{ref:r,longitude:vg[0].point[0],latitude:vg[0].point[1],rotationAlignment:"map",children:ae.jsx("div",{className:"street-view-marker"})}),ae.jsx(KS,{tileRootUrl:t.tileRootUrl,mode:"light"}),ae.jsx(By,{tileRootUrl:t.tileRootUrl,game:"ats",mode:"light",enableIconAutoHide:!0,visibleIcons:Ny,dlcs:Rg})]})]})},Ub=".",V4="panos",Dbe=void 0,Lbe=Qte(Pte([ae.jsx(o_,{path:"/",element:ae.jsx(D1e,{tileRootUrl:Ub,pixelRootUrl:V4,specialEvent:Dbe})}),ae.jsx(o_,{path:"routes",element:ae.jsx(X1e,{tileRootUrl:Ub})}),ae.jsx(o_,{path:"street-view",element:ae.jsx(Rbe,{tileRootUrl:Ub,pixelRootUrl:V4})})].concat(Object.entries(_R).map(([t,e])=>ae.jsx(o_,{path:e.url,element:ae.jsx(K1e,{tileRootUrl:Ub,specialEvent:t})})))),{basename:"/ats-map/"}),kbe=PN({components:{JoyIconButton:{styleOverrides:{root:{backgroundColor:"var(--joy-palette-background-surface)"}}}}}),zbe=document.getElementById("root"),Obe=UQ.createRoot(zbe);Obe.render(ae.jsx(q.StrictMode,{children:ae.jsxs(uW,{defaultMode:"system",modeStorageKey:"tm-mode",theme:kbe,children:[ae.jsx(zK,{}),ae.jsx(dne,{router:Lbe})]})}))});export default Fbe();
